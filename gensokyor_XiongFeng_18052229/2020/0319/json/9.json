[{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35494", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35494/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35494/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35494/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35494", "id": 543843600, "node_id": "MDU6SXNzdWU1NDM4NDM2MDA=", "number": 35494, "title": "distribut data io problem and I want to know way", "user": {"login": "datemoon", "id": 27192682, "node_id": "MDQ6VXNlcjI3MTkyNjgy", "avatar_url": "https://avatars3.githubusercontent.com/u/27192682?v=4", "gravatar_id": "", "url": "https://api.github.com/users/datemoon", "html_url": "https://github.com/datemoon", "followers_url": "https://api.github.com/users/datemoon/followers", "following_url": "https://api.github.com/users/datemoon/following{/other_user}", "gists_url": "https://api.github.com/users/datemoon/gists{/gist_id}", "starred_url": "https://api.github.com/users/datemoon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/datemoon/subscriptions", "organizations_url": "https://api.github.com/users/datemoon/orgs", "repos_url": "https://api.github.com/users/datemoon/repos", "events_url": "https://api.github.com/users/datemoon/events{/privacy}", "received_events_url": "https://api.github.com/users/datemoon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-12-30T11:16:09Z", "updated_at": "2020-01-04T02:28:45Z", "closed_at": null, "author_association": "NONE", "body": "hi, I find some bug. Code is\r\n\r\nimport tensorflow as tf\r\n\r\n\r\nif __name__ == '__main__':\r\n    def Gen():\r\n        for i in range(10):\r\n            yield(i,2,3,4,5,6,7,8)\r\n\r\n    dataset = tf.data.Dataset.from_generator(Gen, output_types=(tf.float32,tf.float32,tf.int32,tf.int32,tf.int32,tf.float32,tf.int32,tf.int32),output_shapes=None,args=None)\r\n    for one_batch in dataset:\r\n        print('one batch',one_batch)\r\n\r\n    print(\"******end**********\")\r\n\r\n    num_gpu=1\r\n    devices = ['/device:GPU:{}'.format(i) for i in range(num_gpu)]\r\n    strategy = tf.distribute.MirroredStrategy(devices)\r\n\r\n    input_context = tf.distribute.InputContext(num_input_pipelines=1,\r\n            input_pipeline_id=0,\r\n            num_replicas_in_sync=1)\r\n\r\n    with strategy.scope():\r\n        def dataset_fn(input_context):\r\n            dataset = tf.data.Dataset.from_generator(Gen, output_types=(tf.float32,tf.float32,tf.int32,tf.int32,tf.int32,tf.float32,tf.int32,tf.int32),output_shapes=None,args=None)\r\n            return dataset.shard(\r\n                    input_context.num_input_pipelines, input_context.input_pipeline_id)\r\n\r\n        train_dist_dataset = strategy.experimental_distribute_datasets_from_function(dataset_fn)\r\n\r\n        for one_batch  in train_dist_dataset:\r\n            print('****one batch*******',one_batch)\r\n\r\nThe code can be run, but in distribut \"for one_batch  in train_dist_dataset:\" at the end batch will be error.\r\nTraceback (most recent call last):\r\n  File \"/usr/local/python35/lib/python3.5/pdb.py\", line 1665, in main\r\n    pdb._runscript(mainpyfile)\r\n  File \"/usr/local/python35/lib/python3.5/pdb.py\", line 1546, in _runscript\r\n    self.run(statement)\r\n  File \"/usr/local/python35/lib/python3.5/bdb.py\", line 431, in run\r\n    exec(cmd, globals, locals)\r\n  File \"<string>\", line 1, in <module>\r\n  File \"/search/speech/hubo/git/tf-code-acoustics/tf2.0-model/io_test.py\", line 45, in <module>\r\n    for one_batch  in train_dist_dataset:\r\n  File \"/usr/local/python35/lib/python3.5/site-packages/tensorflow_core/python/distribute/input_lib.py\", line 275, in __next__\r\n    return self.get_next()\r\n  File \"/usr/local/python35/lib/python3.5/site-packages/tensorflow_core/python/distribute/input_lib.py\", line 304, in get_next\r\n    global_has_value, replicas = _get_next_as_optional(self, self._strategy)\r\n  File \"/usr/local/python35/lib/python3.5/site-packages/tensorflow_core/python/distribute/input_lib.py\", line 200, in _get_next_as_optional\r\n    iterator._iterators[i].get_next_as_list(new_name))  # pylint: disable=protected-access\r\n  File \"/usr/local/python35/lib/python3.5/site-packages/tensorflow_core/python/distribute/input_lib.py\", line 878, in get_next_as_list\r\n    lambda: _dummy_tensor_fn(data.value_structure))\r\n  File \"/usr/local/python35/lib/python3.5/site-packages/tensorflow_core/python/util/deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/usr/local/python35/lib/python3.5/site-packages/tensorflow_core/python/ops/control_flow_ops.py\", line 1204, in cond\r\n    result = false_fn()\r\n  File \"/usr/local/python35/lib/python3.5/site-packages/tensorflow_core/python/distribute/input_lib.py\", line 878, in <lambda>\r\n    lambda: _dummy_tensor_fn(data.value_structure))\r\n  File \"/usr/local/python35/lib/python3.5/site-packages/tensorflow_core/python/distribute/input_lib.py\", line 801, in _dummy_tensor_fn\r\n    result.append(create_dummy_tensor(feature_shape, feature_type))\r\n  File \"/usr/local/python35/lib/python3.5/site-packages/tensorflow_core/python/distribute/input_lib.py\", line 784, in create_dummy_tensor\r\n    for dim in feature_shape.dims:\r\nTypeError: 'NoneType' object is not iterable\r\nUncaught exception. Entering post mortem debugging\r\nRunning 'cont' or 'step' will restart the program\r\n\r\nI want to know why."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35493", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35493/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35493/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35493/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35493", "id": 543813484, "node_id": "MDU6SXNzdWU1NDM4MTM0ODQ=", "number": 35493, "title": "tf.recompute_grad() throws dimension mismatched error when concatenating tensors with different number of channels ", "user": {"login": "ChunHsinWang", "id": 20900499, "node_id": "MDQ6VXNlcjIwOTAwNDk5", "avatar_url": "https://avatars3.githubusercontent.com/u/20900499?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ChunHsinWang", "html_url": "https://github.com/ChunHsinWang", "followers_url": "https://api.github.com/users/ChunHsinWang/followers", "following_url": "https://api.github.com/users/ChunHsinWang/following{/other_user}", "gists_url": "https://api.github.com/users/ChunHsinWang/gists{/gist_id}", "starred_url": "https://api.github.com/users/ChunHsinWang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ChunHsinWang/subscriptions", "organizations_url": "https://api.github.com/users/ChunHsinWang/orgs", "repos_url": "https://api.github.com/users/ChunHsinWang/repos", "events_url": "https://api.github.com/users/ChunHsinWang/events{/privacy}", "received_events_url": "https://api.github.com/users/ChunHsinWang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-12-30T09:38:05Z", "updated_at": "2020-02-20T20:09:26Z", "closed_at": null, "author_association": "NONE", "body": "\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 2.0\r\n- Python version: 3.6\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: 10.0 / 7.6\r\n- GPU model and memory: GTX 1080 / 8GB\r\n\r\n**Describe the current behavior**\r\n\r\nMy model is a segmentation model with DenseNet like structure. There are many concatenate operations between the encoder and decoder tensors. I want to recompute the gradients on these concatenate layers during backpropagation to limit the amount of GPU memory usage. A similar approach can be found here : https://github.com/joeyearsley/efficient_densenet_tensorflow.  I tried to use tf.recompute_grad() on a wrapper function which has a concatenate layer inside but it would raise an error when the channel dimensions of input tensors are not matched.\r\n\r\n**Describe the expected behavior**\r\nThe concatenate layer should not raise an error when concatenating inputs with different number of channels.\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\nhttps://colab.research.google.com/drive/1d7zSGbYmocnupUpDIJLnlXt-3vH5bi83#scrollTo=xcPT-MWZAuvK&uniqifier=1\r\n\r\n**Other info / logs**\r\n---------------------------------------------------------------------------\r\nInvalidArgumentError                      Traceback (most recent call last)\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/ops.py in _create_c_op(graph, node_def, inputs, control_inputs)\r\n   1609   try:\r\n-> 1610     c_op = c_api.TF_FinishOperation(op_desc)\r\n   1611   except errors.InvalidArgumentError as e:\r\n\r\nInvalidArgumentError: Dimension 3 in both shapes must be equal, but are 16 and 32. Shapes are [?,30,30,16] and [?,30,30,32].\r\n\tFrom merging shape 0 with other shapes. for 'packed_7' (op: 'Pack') with input shapes: [?,30,30,16], [?,30,30,32].\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nValueError                                Traceback (most recent call last)\r\n16 frames\r\n<ipython-input-24-689917ca63e3> in <module>()\r\n----> 1 model = test_model()\r\n      2 history = model.fit(train_images, train_labels, epochs=10, \r\n      3                     validation_data=(test_images, test_labels))\r\n\r\n<ipython-input-23-caa5b725d514> in test_model()\r\n      4     x_list.append(layers.Conv2D(16, (3,3), activation='relu')(x_in))\r\n      5     x_list.append(layers.Conv2D(32, (3,3), activation='relu')(x_in))\r\n----> 6     x = efficient_concat(x_list)\r\n      7     x = layers.Flatten()(x)\r\n      8     x = layers.Dense(10, activation='softmax')(x)\r\n\r\n<ipython-input-3-fa43d4abcee2> in efficient_concat(input_list)\r\n      4         return x\r\n      5     wraper = tf.recompute_grad(wraper)\r\n----> 6     return wraper(input_list)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/ops/custom_gradient.py in decorated(*args, **kwargs)\r\n    164     \"\"\"Decorated function with custom gradient.\"\"\"\r\n    165     if context.executing_eagerly():\r\n--> 166       return _eager_mode_decorator(f, *args, **kwargs)\r\n    167     else:\r\n    168       return _graph_mode_decorator(f, *args, **kwargs)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/ops/custom_gradient.py in _eager_mode_decorator(f, *args, **kwargs)\r\n    333 \r\n    334   input_tensors = [ops.convert_to_tensor(x) for x\r\n--> 335                    in list(args) + list(variables)]\r\n    336   arg_count = len(args)\r\n    337   def actual_grad_fn(*result_grads):\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/ops/custom_gradient.py in <listcomp>(.0)\r\n    332   flat_result = [gen_array_ops.identity(x) for x in flat_result]\r\n    333 \r\n--> 334   input_tensors = [ops.convert_to_tensor(x) for x\r\n    335                    in list(args) + list(variables)]\r\n    336   arg_count = len(args)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/ops.py in convert_to_tensor(value, dtype, name, preferred_dtype, dtype_hint)\r\n   1182   preferred_dtype = deprecation.deprecated_argument_lookup(\r\n   1183       \"dtype_hint\", dtype_hint, \"preferred_dtype\", preferred_dtype)\r\n-> 1184   return convert_to_tensor_v2(value, dtype, preferred_dtype, name)\r\n   1185 \r\n   1186 \r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/ops.py in convert_to_tensor_v2(value, dtype, dtype_hint, name)\r\n   1240       name=name,\r\n   1241       preferred_dtype=dtype_hint,\r\n-> 1242       as_ref=False)\r\n   1243 \r\n   1244 \r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/ops.py in internal_convert_to_tensor(value, dtype, name, as_ref, preferred_dtype, ctx, accept_composite_tensors)\r\n   1294 \r\n   1295     if ret is None:\r\n-> 1296       ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\r\n   1297 \r\n   1298     if ret is NotImplemented:\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/ops/array_ops.py in _autopacking_conversion_function(v, dtype, name, as_ref)\r\n   1276   elif dtype != inferred_dtype:\r\n   1277     v = nest.map_structure(_cast_nested_seqs_to_dtype(dtype), v)\r\n-> 1278   return _autopacking_helper(v, dtype, name or \"packed\")\r\n   1279 \r\n   1280 \r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/ops/array_ops.py in _autopacking_helper(list_or_tuple, dtype, name)\r\n   1182     # checking.\r\n   1183     if all(ops.is_dense_tensor_like(elem) for elem in list_or_tuple):\r\n-> 1184       return gen_array_ops.pack(list_or_tuple, name=name)\r\n   1185   must_pack = False\r\n   1186   converted_elems = []\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/ops/gen_array_ops.py in pack(values, axis, name)\r\n   6302   axis = _execute.make_int(axis, \"axis\")\r\n   6303   _, _, _op = _op_def_lib._apply_op_helper(\r\n-> 6304         \"Pack\", values=values, axis=axis, name=name)\r\n   6305   _result = _op.outputs[:]\r\n   6306   _inputs_flat = _op.inputs\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/op_def_library.py in _apply_op_helper(self, op_type_name, name, **keywords)\r\n    791         op = g.create_op(op_type_name, inputs, dtypes=None, name=scope,\r\n    792                          input_types=input_types, attrs=attr_protos,\r\n--> 793                          op_def=op_def)\r\n    794       return output_structure, op_def.is_stateful, op\r\n    795 \r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/func_graph.py in create_op(***failed resolving arguments***)\r\n    546     return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access\r\n    547         op_type, inputs, dtypes, input_types, name, attrs, op_def,\r\n--> 548         compute_device)\r\n    549 \r\n    550   def capture(self, tensor, name=None):\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/ops.py in _create_op_internal(self, op_type, inputs, dtypes, input_types, name, attrs, op_def, compute_device)\r\n   3427           input_types=input_types,\r\n   3428           original_op=self._default_original_op,\r\n-> 3429           op_def=op_def)\r\n   3430       self._create_op_helper(ret, compute_device=compute_device)\r\n   3431     return ret\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/ops.py in __init__(self, node_def, g, inputs, output_types, control_inputs, input_types, original_op, op_def)\r\n   1771           op_def, inputs, node_def.attr)\r\n   1772       self._c_op = _create_c_op(self._graph, node_def, grouped_inputs,\r\n-> 1773                                 control_input_ops)\r\n   1774     # pylint: enable=protected-access\r\n   1775 \r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/ops.py in _create_c_op(graph, node_def, inputs, control_inputs)\r\n   1611   except errors.InvalidArgumentError as e:\r\n   1612     # Convert to ValueError for backwards compatibility.\r\n-> 1613     raise ValueError(str(e))\r\n   1614 \r\n   1615   return c_op\r\n\r\nValueError: Dimension 3 in both shapes must be equal, but are 16 and 32. Shapes are [?,30,30,16] and [?,30,30,32].\r\n\tFrom merging shape 0 with other shapes. for 'packed_7' (op: 'Pack') with input shapes: [?,30,30,16], [?,30,30,32]."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35491", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35491/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35491/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35491/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35491", "id": 543771566, "node_id": "MDU6SXNzdWU1NDM3NzE1NjY=", "number": 35491, "title": "Error: Not in GZIP format", "user": {"login": "rajputashu", "id": 4385881, "node_id": "MDQ6VXNlcjQzODU4ODE=", "avatar_url": "https://avatars0.githubusercontent.com/u/4385881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rajputashu", "html_url": "https://github.com/rajputashu", "followers_url": "https://api.github.com/users/rajputashu/followers", "following_url": "https://api.github.com/users/rajputashu/following{/other_user}", "gists_url": "https://api.github.com/users/rajputashu/gists{/gist_id}", "starred_url": "https://api.github.com/users/rajputashu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rajputashu/subscriptions", "organizations_url": "https://api.github.com/users/rajputashu/orgs", "repos_url": "https://api.github.com/users/rajputashu/repos", "events_url": "https://api.github.com/users/rajputashu/events{/privacy}", "received_events_url": "https://api.github.com/users/rajputashu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "lintian06", "id": 8652095, "node_id": "MDQ6VXNlcjg2NTIwOTU=", "avatar_url": "https://avatars3.githubusercontent.com/u/8652095?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lintian06", "html_url": "https://github.com/lintian06", "followers_url": "https://api.github.com/users/lintian06/followers", "following_url": "https://api.github.com/users/lintian06/following{/other_user}", "gists_url": "https://api.github.com/users/lintian06/gists{/gist_id}", "starred_url": "https://api.github.com/users/lintian06/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lintian06/subscriptions", "organizations_url": "https://api.github.com/users/lintian06/orgs", "repos_url": "https://api.github.com/users/lintian06/repos", "events_url": "https://api.github.com/users/lintian06/events{/privacy}", "received_events_url": "https://api.github.com/users/lintian06/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "lintian06", "id": 8652095, "node_id": "MDQ6VXNlcjg2NTIwOTU=", "avatar_url": "https://avatars3.githubusercontent.com/u/8652095?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lintian06", "html_url": "https://github.com/lintian06", "followers_url": "https://api.github.com/users/lintian06/followers", "following_url": "https://api.github.com/users/lintian06/following{/other_user}", "gists_url": "https://api.github.com/users/lintian06/gists{/gist_id}", "starred_url": "https://api.github.com/users/lintian06/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lintian06/subscriptions", "organizations_url": "https://api.github.com/users/lintian06/orgs", "repos_url": "https://api.github.com/users/lintian06/repos", "events_url": "https://api.github.com/users/lintian06/events{/privacy}", "received_events_url": "https://api.github.com/users/lintian06/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-12-30T07:03:50Z", "updated_at": "2020-01-03T00:40:14Z", "closed_at": null, "author_association": "NONE", "body": "Getting below exception while following \"https://github.com/tensorflow/examples/tree/master/lite/examples/image_classification/android\"\r\n\r\n\r\norg.gradle.api.InvalidUserDataException: Cannot expand TAR 'D:\\WorkSpaces\\ML_WorkSpace\\TF_Android\\app\\build\\intermediates\\mobilenet_v1_1.0_224.tgz'.\r\n\tat org.gradle.api.internal.file.archive.TarFileTree.cannotExpand(TarFileTree.java:133)\r\n\t... 56 more\r\nCaused by: org.gradle.api.resources.ResourceException: Could not read D:\\WorkSpaces\\TF_Android\\app\\build\\intermediates\\mobilenet_v1_1.0_224.tgz.\r\n\tat org.gradle.internal.resource.ResourceExceptions.readFailed(ResourceExceptions.java:36)\r\n\tat org.gradle.api.internal.file.archive.compression.GzipArchiver.read(GzipArchiver.java:64)\r\n\tat org.gradle.api.internal.file.MaybeCompressedFileResource.read(MaybeCompressedFileResource.java:55)\r\n\tat org.gradle.api.internal.file.archive.TarFileTree.visit(TarFileTree.java:78)\r\n\t... 107 more\r\nCaused by: java.util.zip.ZipException: Not in GZIP format\r\n\tat java.util.zip.GZIPInputStream.readHeader(GZIPInputStream.java:165)\r\n\tat org.gradle.api.internal.file.archive.compression.GzipArchiver.read(GzipArchiver.java:61)\r\n\t... 109 more\r\n\r\n**Don't know, what could be the problem?**"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35489", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35489/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35489/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35489/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35489", "id": 543722535, "node_id": "MDU6SXNzdWU1NDM3MjI1MzU=", "number": 35489, "title": "`files_io.get_matching_files` fails for valid filenames that contain globs", "user": {"login": "silky", "id": 129525, "node_id": "MDQ6VXNlcjEyOTUyNQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/129525?v=4", "gravatar_id": "", "url": "https://api.github.com/users/silky", "html_url": "https://github.com/silky", "followers_url": "https://api.github.com/users/silky/followers", "following_url": "https://api.github.com/users/silky/following{/other_user}", "gists_url": "https://api.github.com/users/silky/gists{/gist_id}", "starred_url": "https://api.github.com/users/silky/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/silky/subscriptions", "organizations_url": "https://api.github.com/users/silky/orgs", "repos_url": "https://api.github.com/users/silky/repos", "events_url": "https://api.github.com/users/silky/events{/privacy}", "received_events_url": "https://api.github.com/users/silky/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2019-12-30T04:18:44Z", "updated_at": "2020-01-23T00:03:14Z", "closed_at": null, "author_association": "NONE", "body": "the function `files_io.get_matching_files` says it takes a \"filepath\", but actually it takes a glob\r\n\r\nthis means that if you save your checkpoints to a folder like `x=[abc]`, then you can't load the previous checkpoint using something like:\r\n\r\n```\r\ndef load_checkpoint(sess, checkpoint_path):\r\n  saver = tf.train.Saver(tf.global_variables())\r\n  ckpt = tf.train.get_checkpoint_state(checkpoint_path)\r\n  tf.logging.info('Loading model %s.', ckpt.model_checkpoint_path)\r\n  saver.restore(sess, ckpt.model_checkpoint_path)\r\n```\r\n\r\nwhere `checkpoint_path=\"./logs/x=[abc]\"`."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35482", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35482/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35482/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35482/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35482", "id": 543517130, "node_id": "MDU6SXNzdWU1NDM1MTcxMzA=", "number": 35482, "title": "non_max_suppression is full of bugs!", "user": {"login": "MoussaMM", "id": 57710171, "node_id": "MDQ6VXNlcjU3NzEwMTcx", "avatar_url": "https://avatars1.githubusercontent.com/u/57710171?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MoussaMM", "html_url": "https://github.com/MoussaMM", "followers_url": "https://api.github.com/users/MoussaMM/followers", "following_url": "https://api.github.com/users/MoussaMM/following{/other_user}", "gists_url": "https://api.github.com/users/MoussaMM/gists{/gist_id}", "starred_url": "https://api.github.com/users/MoussaMM/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MoussaMM/subscriptions", "organizations_url": "https://api.github.com/users/MoussaMM/orgs", "repos_url": "https://api.github.com/users/MoussaMM/repos", "events_url": "https://api.github.com/users/MoussaMM/events{/privacy}", "received_events_url": "https://api.github.com/users/MoussaMM/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, {"login": "samikama", "id": 10539540, "node_id": "MDQ6VXNlcjEwNTM5NTQw", "avatar_url": "https://avatars0.githubusercontent.com/u/10539540?v=4", "gravatar_id": "", "url": "https://api.github.com/users/samikama", "html_url": "https://github.com/samikama", "followers_url": "https://api.github.com/users/samikama/followers", "following_url": "https://api.github.com/users/samikama/following{/other_user}", "gists_url": "https://api.github.com/users/samikama/gists{/gist_id}", "starred_url": "https://api.github.com/users/samikama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/samikama/subscriptions", "organizations_url": "https://api.github.com/users/samikama/orgs", "repos_url": "https://api.github.com/users/samikama/repos", "events_url": "https://api.github.com/users/samikama/events{/privacy}", "received_events_url": "https://api.github.com/users/samikama/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-12-29T18:43:36Z", "updated_at": "2020-01-10T22:03:37Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\nThe bugs are not related to my system informations. They are caused by a bad coding style in the https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/kernels/non_max_suppression_op.cu.cc and https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/kernels/non_max_suppression_op.cc. Just to be sure those bugs could be easily reproduced on google colab. \r\n\r\n**Describe the current behavior**\r\nI ll mention two major bugs.\r\nThe first one is a garbage output when the boxes coordinates are not logical. In fact given a box(y1,x1,y2,x2)  coordinates with y1 = y2 or x1 = x2 (the coordinates of a line) or even worst the coordinates of a point ( x1 = x2 = y1 = y2) the algorithme will only output the line when reaching it. \r\n**Code to reproduce the issue**\r\nHere is the code to reproduce the behaviour on google colab: \r\n\r\n```\r\nimport numpy as np\r\n%tensorflow_version 2.x\r\nimport tensorflow as tf\r\ntf.__version__\r\nboxes = np.array([[0.1,0.1,0.2,0.2], [0.3,0.3,0.3,0.4], [0.5,0.5,0.6,0.6], [0.7,0.7,0.8,0.8]], dtype= np.float32)\r\nscores = np.array([0.9,0.8,0.7,0.6], dtype = np.float32)\r\n(tf.image.non_max_suppression(boxes, scores, 8))\r\n```\r\n\r\noutput:\r\n```\r\n'2.1.0-rc1'\r\n<tf.Tensor: shape=(8,), dtype=int32, numpy=array([0, 1, 1, 1, 1, 1, 1, 1], dtype=int32)>\r\n```\r\n\r\nNow I ll explain brievely how the algorithm is coded in tensorflow. Given a list of candidate boxes containing in the beginning all the user boxes and a list of chosen boxes empty, if the box is chosen it will not immediately delete it from the candidate box. In fact, this box will be again processed as a candidate box in the next iteration. But because it is already in the chosen boxes it wont be chosen again . The reason for that is that the IOU of a box with himself is 1 which is always above the threshold. Unfortunately, the IOU of a line or a point with any box is 0. This is applied even when the IOU is calculated of the line with iteself. This will result in adding the line to the chosen boxes again and again. This behaviour is mentioned in this issue but wasn't clearly explained. https://github.com/tensorflow/tensorflow/issues/29628\r\n\r\n**Describe the expected behavior**\r\nThe expected behaviour must be decided by the tensorflow programer. He can chose between putting it only once in the result : \r\n-<tf.Tensor: shape=(8,), dtype=int32, numpy=array([0, 1, 2, 3], dtype=int32)> \r\nor deleting the line box\r\n -<tf.Tensor: shape=(8,), dtype=int32, numpy=array([0, 2, 3], dtype=int32)>\r\n\r\n- The second bug is really inexplainable. Why there is only the gpu specialisation of non_max_suppression_v2 ? Did the developer forgot about it? This was mentioned in several issues under the name : non max suppression work only on cpu. This is completely understandable because the default version of non_max_suppression is v3 which dosent have a gpu specialisation. \r\n\r\n**Code to reproduce the issue**\r\non colab u can just copy this code:\r\n\r\n```\r\nimport numpy as np\r\n%tensorflow_version 2.x\r\nimport tensorflow as tf\r\ntf.debugging.set_log_device_placement(True)\r\nboxes = np.array([[0.1,0.1,0.2,0.2], [0.3,0.3,0.3,0.4], [0.5,0.5,0.6,0.6], [0.7,0.7,0.8,0.8]], dtype= np.float32)\r\nscores = np.array([0.9,0.8,0.7,0.6], dtype = np.float32)\r\nwith tf.device('/GPU:0'):\r\n  print(tf.image.non_max_suppression(boxes, scores, 8))\r\n```\r\n\r\noutput:\r\n\r\n> Executing op NonMaxSuppressionV3 in device /job:localhost/replica:0/task:0/device:CPU:0\r\n> tf.Tensor([0 1 1 1 1 1 1 1], shape=(8,), dtype=int32)\r\n\r\n**Describe the expected behavior**\r\n\r\n> Executing op NonMaxSuppressionV3 in device /job:localhost/replica:0/task:0/device:GPU:0\r\n\r\nCorrecting this issue is quite simple and straightforward. Gpu specialisation must be made for non_max_suppression_v3 at least."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35466", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35466/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35466/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35466/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35466", "id": 543267635, "node_id": "MDU6SXNzdWU1NDMyNjc2MzU=", "number": 35466, "title": "convolutional_recurrent.py:get_initial_state type mismatch", "user": {"login": "dancaselden", "id": 578786, "node_id": "MDQ6VXNlcjU3ODc4Ng==", "avatar_url": "https://avatars0.githubusercontent.com/u/578786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dancaselden", "html_url": "https://github.com/dancaselden", "followers_url": "https://api.github.com/users/dancaselden/followers", "following_url": "https://api.github.com/users/dancaselden/following{/other_user}", "gists_url": "https://api.github.com/users/dancaselden/gists{/gist_id}", "starred_url": "https://api.github.com/users/dancaselden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dancaselden/subscriptions", "organizations_url": "https://api.github.com/users/dancaselden/orgs", "repos_url": "https://api.github.com/users/dancaselden/repos", "events_url": "https://api.github.com/users/dancaselden/events{/privacy}", "received_events_url": "https://api.github.com/users/dancaselden/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-12-28T18:46:19Z", "updated_at": "2020-02-21T18:51:12Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary (pip, tf-nightly-gpu)\r\n- TensorFlow version (use command below): 2.1.0-dev20191228\r\n- Python version: 2.7\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: 10.0\r\n- GPU model and memory: Tesla M60 7618MiB\r\n\r\nTraining a model with a ConvLSTM2D layer and float16 (K.set_floatx('float16')) results in a type mismatch. convolutional_recurrent.py:get_initial_state initializes zeros without specifying a type, defaulting to float32.\r\n\r\nFor me, specifying the dtype as that of the function inputs resolved the issue:\r\n```\r\n    initial_state = self.cell.input_conv(initial_state,\r\n                                         array_ops.zeros(tuple(shape)),\r\n                                         padding=self.cell.padding)\r\n```\r\nbecomes\r\n```\r\n    initial_state = self.cell.input_conv(initial_state,\r\n                                         array_ops.zeros(tuple(shape),dtype=inputs.dtype),\r\n                                         padding=self.cell.padding)```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35462", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35462/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35462/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35462/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35462", "id": 543149482, "node_id": "MDU6SXNzdWU1NDMxNDk0ODI=", "number": 35462, "title": "tensorflow installation in raspberry pi : HadoopFileSystem load error", "user": {"login": "prudhvirajboddu", "id": 32446707, "node_id": "MDQ6VXNlcjMyNDQ2NzA3", "avatar_url": "https://avatars2.githubusercontent.com/u/32446707?v=4", "gravatar_id": "", "url": "https://api.github.com/users/prudhvirajboddu", "html_url": "https://github.com/prudhvirajboddu", "followers_url": "https://api.github.com/users/prudhvirajboddu/followers", "following_url": "https://api.github.com/users/prudhvirajboddu/following{/other_user}", "gists_url": "https://api.github.com/users/prudhvirajboddu/gists{/gist_id}", "starred_url": "https://api.github.com/users/prudhvirajboddu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/prudhvirajboddu/subscriptions", "organizations_url": "https://api.github.com/users/prudhvirajboddu/orgs", "repos_url": "https://api.github.com/users/prudhvirajboddu/repos", "events_url": "https://api.github.com/users/prudhvirajboddu/events{/privacy}", "received_events_url": "https://api.github.com/users/prudhvirajboddu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1194756584, "node_id": "MDU6TGFiZWwxMTk0NzU2NTg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20raspberry%20pi", "name": "subtype: raspberry pi", "color": "b619ea", "default": false, "description": "Raspberry Pi Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-12-28T12:45:24Z", "updated_at": "2020-02-19T04:10:27Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Raspberry pi 4\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: No\r\n- TensorFlow installed from (source or binary): binary in pip\r\n- TensorFlow version: 1.14\r\n- Python version: 3.7\r\n- Installed using  pip\r\n- Bazel version (if compiling from source): No\r\n- GCC/Compiler version (if compiling from source): No\r\n- CUDA/cuDNN version: No\r\n- GPU model and memory: No\r\n\r\n\r\n\r\n**Describe the problem**\r\n****\r\npi@raspberrypi:~/examples/lite/examples/object_detection/raspberry_pi $ python3 detect_picamera.py   --model /tmp/detect.tflite   --labels /tmp/coco_labels.txt\r\n2019-12-28 17:43:12.464130: E tensorflow/core/platform/hadoop/hadoop_file_system.cc:132] HadoopFileSystem load error: libhdfs.so: cannot open shared object file: No such file or directory\r\nTraceback (most recent call last):\r\n  File \"detect_picamera.py\", line 34, in <module>\r\n    from tf.lite.interpreter import Interpreter\r\nModuleNotFoundError: No module named 'tf'\r\n***\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n***\r\n Tensorflow model running issue replaced the code with in original source code\r\n\r\n> from_ tflite_runtime.interpreter import Interpreter\r\n\r\n***\r\n**WIth**\r\n***\r\n> from tf.lite import Interpreter\r\n***\r\n\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35461", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35461/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35461/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35461/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/35461", "id": 543134899, "node_id": "MDExOlB1bGxSZXF1ZXN0MzU3NDUxNTcy", "number": 35461, "title": "added int8 support for negate kernel", "user": {"login": "lamarrr", "id": 26050398, "node_id": "MDQ6VXNlcjI2MDUwMzk4", "avatar_url": "https://avatars3.githubusercontent.com/u/26050398?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lamarrr", "html_url": "https://github.com/lamarrr", "followers_url": "https://api.github.com/users/lamarrr/followers", "following_url": "https://api.github.com/users/lamarrr/following{/other_user}", "gists_url": "https://api.github.com/users/lamarrr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lamarrr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lamarrr/subscriptions", "organizations_url": "https://api.github.com/users/lamarrr/orgs", "repos_url": "https://api.github.com/users/lamarrr/repos", "events_url": "https://api.github.com/users/lamarrr/events{/privacy}", "received_events_url": "https://api.github.com/users/lamarrr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 987666414, "node_id": "MDU6TGFiZWw5ODc2NjY0MTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/ready%20to%20pull", "name": "ready to pull", "color": "2cd643", "default": false, "description": ""}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 24, "created_at": "2019-12-28T11:57:23Z", "updated_at": "2020-03-19T12:09:39Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/35461", "html_url": "https://github.com/tensorflow/tensorflow/pull/35461", "diff_url": "https://github.com/tensorflow/tensorflow/pull/35461.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/35461.patch"}, "body": "removed the todo message, and plugged in the default **reference_ops**'s negate."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35451", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35451/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35451/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35451/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35451", "id": 543001432, "node_id": "MDU6SXNzdWU1NDMwMDE0MzI=", "number": 35451, "title": "Error while trying to serilize Image Captioning keras model '_UserObject' object is not callable'", "user": {"login": "veonua", "id": 1540142, "node_id": "MDQ6VXNlcjE1NDAxNDI=", "avatar_url": "https://avatars1.githubusercontent.com/u/1540142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/veonua", "html_url": "https://github.com/veonua", "followers_url": "https://api.github.com/users/veonua/followers", "following_url": "https://api.github.com/users/veonua/following{/other_user}", "gists_url": "https://api.github.com/users/veonua/gists{/gist_id}", "starred_url": "https://api.github.com/users/veonua/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/veonua/subscriptions", "organizations_url": "https://api.github.com/users/veonua/orgs", "repos_url": "https://api.github.com/users/veonua/repos", "events_url": "https://api.github.com/users/veonua/events{/privacy}", "received_events_url": "https://api.github.com/users/veonua/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2019-12-27T21:53:43Z", "updated_at": "2020-03-13T00:37:34Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\nexample from https://www.tensorflow.org/tutorials/text/image_captioning\r\n\r\n- OS Platform and Distribution:Linux Ubuntu 18\r\n- TensorFlow installed from (source or binary): bin\r\n- TensorFlow version (use command below): v2.0.0-rc2-26-g64c3d38 2.0.0 \r\n- Python version: 3.6.8\r\n\r\n**Describe the current behavior**\r\n> tf.saved_model.save(encoder, \"./models/1/encoder\")\r\n\r\nmodel get serialized with errors \r\n\r\n**Describe the expected behavior**\r\nencoder can be loaded without errors\r\n\r\n**Code to reproduce the issue**\r\n- train the model from https://www.tensorflow.org/tutorials/text/image_captioning example \r\n\r\n```\r\ntf.saved_model.save(encoder, \"./models/1/encoder\")\r\nencoder = tf.saved_model.load(\"./models/1/encoder\")\r\nencoder(img_tensor_val)\r\n\r\n```\r\nraises the error > \r\n'_UserObject' object is not callable\r\n\r\n\r\n`encoder.fc(img_tensor_val) \r\n`\r\nValueError: Could not find matching function to call loaded from the SavedModel. Got:\r\n  Positional arguments (1 total):\r\n    * Tensor(\"inputs:0\", shape=(1, 120, 64), dtype=float32)\r\n  Keyword arguments: {}\r\n\r\nExpected these arguments to match one of the following 0 option(s):\r\n\r\n**Other info / logs**\r\nW1227 00:41:32.831883 139767989909312 save_impl.py:77] Skipping full serialization of Keras model <__main__.CNN_Encoder object at 0x7f1daf5354e0>, because its inputs are not defined.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35447", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35447/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35447/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35447/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35447", "id": 542847761, "node_id": "MDU6SXNzdWU1NDI4NDc3NjE=", "number": 35447, "title": "Chain multiple estimators to create a single SavedModel ", "user": {"login": "tejaslodaya", "id": 10500049, "node_id": "MDQ6VXNlcjEwNTAwMDQ5", "avatar_url": "https://avatars0.githubusercontent.com/u/10500049?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tejaslodaya", "html_url": "https://github.com/tejaslodaya", "followers_url": "https://api.github.com/users/tejaslodaya/followers", "following_url": "https://api.github.com/users/tejaslodaya/following{/other_user}", "gists_url": "https://api.github.com/users/tejaslodaya/gists{/gist_id}", "starred_url": "https://api.github.com/users/tejaslodaya/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tejaslodaya/subscriptions", "organizations_url": "https://api.github.com/users/tejaslodaya/orgs", "repos_url": "https://api.github.com/users/tejaslodaya/repos", "events_url": "https://api.github.com/users/tejaslodaya/events{/privacy}", "received_events_url": "https://api.github.com/users/tejaslodaya/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-12-27T11:42:23Z", "updated_at": "2020-01-30T12:22:56Z", "closed_at": null, "author_association": "NONE", "body": "Chain multiple estimators to create a single SavedModel with a single serving file/output.\r\n\r\nSuppose I have 3 estimators with me, first is BoostedTrees, who's output I want to use as input into DNNClassifier, and the output of which I want to use in my custom Estimator.\r\n\r\nIs there a way to chain output/input of each other to create a **mega** estimator of sorts.\r\n\r\nPlease help me out here."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35445", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35445/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35445/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35445/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35445", "id": 542821199, "node_id": "MDU6SXNzdWU1NDI4MjExOTk=", "number": 35445, "title": "TfLiteGpuDelegate Init: FULLY_CONNECTED: Amount of input data should match weights width", "user": {"login": "Kuloud", "id": 2024271, "node_id": "MDQ6VXNlcjIwMjQyNzE=", "avatar_url": "https://avatars3.githubusercontent.com/u/2024271?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Kuloud", "html_url": "https://github.com/Kuloud", "followers_url": "https://api.github.com/users/Kuloud/followers", "following_url": "https://api.github.com/users/Kuloud/following{/other_user}", "gists_url": "https://api.github.com/users/Kuloud/gists{/gist_id}", "starred_url": "https://api.github.com/users/Kuloud/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Kuloud/subscriptions", "organizations_url": "https://api.github.com/users/Kuloud/orgs", "repos_url": "https://api.github.com/users/Kuloud/repos", "events_url": "https://api.github.com/users/Kuloud/events{/privacy}", "received_events_url": "https://api.github.com/users/Kuloud/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-12-27T10:04:09Z", "updated_at": "2019-12-30T05:35:40Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code :\r\n```java\r\nprivate List<Delegate> mDelegates = new ArrayList<>();\r\nmDelegates.add(new GpuDelegate());\r\n```\r\n\r\n```java\r\n            Interpreter.Options options = null;\r\n            if (interpreterOptions != null) {\r\n                options = new Interpreter.Options().setNumThreads(interpreterOptions.getNumThreads());\r\n            }\r\n            if (!mDelegates.isEmpty()) {\r\n                Iterator<Delegate> it = mDelegates.iterator();\r\n                while (it.hasNext()) {\r\n                    Delegate delegate = it.next();\r\n                    mLogger.debug(\"addDelegate: \" + delegate);\r\n                    options.addDelegate(delegate);\r\n                }\r\n            }\r\n            mInterpreter = new Interpreter(bb, options);\r\n```\r\n\r\n- Mobile device :\r\nMI 8 / MIUI 11.0.4\r\n\r\n- TensorFlow installed from (source or binary):\r\nimplementation 'org.tensorflow:tensorflow-lite:2.0.0'\r\nimplementation 'org.tensorflow:tensorflow-lite-gpu:2.0.0'\r\n\r\n**Describe the current behavior**\r\ncrashed when load the attached file with 'GpuDelegate'\r\n\r\n**Describe the expected behavior**\r\nload the attached file correct\r\n\r\n**Code to reproduce the issue**\r\nN/A\r\n\r\n**Other info / logs**\r\n```text\r\n    java.lang.IllegalStateException: Internal error: Unexpected failure when preparing tensor allocations: TfLiteGpuDelegate Init: FULLY_CONNECTED: Amount of input data should match weights width\r\n    TfLiteGpuDelegate Prepare: delegate is not initialized\r\n    Node number 3 (TfLiteGpuDelegateV2) failed to prepare.\r\n    \r\n    Restored previous execution plan after delegate application failure.\r\n        at org.tensorflow.lite.NativeInterpreterWrapper.allocateTensors(Native Method)\r\n        at org.tensorflow.lite.NativeInterpreterWrapper.run(NativeInterpreterWrapper.java:162)\r\n        at org.tensorflow.lite.Interpreter.runForMultipleInputsOutputs(Interpreter.java:275)\r\n        at com.didi.aoe.runtime.tensorflow.lite.TensorFlowMultipleInputsOutputsInterpreter.run(TensorFlowMultipleInputsOutputsInterpreter.java:159)\r\n        at com.didi.aoe.library.core.NativeProcessorWrapper.run(NativeProcessorWrapper.java:40)\r\n```\r\n\r\n[mnist_cnn_keras.tflite.zip](https://github.com/tensorflow/tensorflow/files/4004963/mnist_cnn_keras.tflite.zip)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35433", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35433/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35433/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35433/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35433", "id": 542674594, "node_id": "MDU6SXNzdWU1NDI2NzQ1OTQ=", "number": 35433, "title": "Flag --incompatible_no_implicit_file_export will break TensorFlow in a future Bazel release", "user": {"login": "bazel-flag-bot", "id": 58891217, "node_id": "MDQ6VXNlcjU4ODkxMjE3", "avatar_url": "https://avatars0.githubusercontent.com/u/58891217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bazel-flag-bot", "html_url": "https://github.com/bazel-flag-bot", "followers_url": "https://api.github.com/users/bazel-flag-bot/followers", "following_url": "https://api.github.com/users/bazel-flag-bot/following{/other_user}", "gists_url": "https://api.github.com/users/bazel-flag-bot/gists{/gist_id}", "starred_url": "https://api.github.com/users/bazel-flag-bot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bazel-flag-bot/subscriptions", "organizations_url": "https://api.github.com/users/bazel-flag-bot/orgs", "repos_url": "https://api.github.com/users/bazel-flag-bot/repos", "events_url": "https://api.github.com/users/bazel-flag-bot/events{/privacy}", "received_events_url": "https://api.github.com/users/bazel-flag-bot/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-12-26T21:28:18Z", "updated_at": "2019-12-26T21:28:18Z", "closed_at": null, "author_association": "NONE", "body": "Incompatible flag --incompatible_no_implicit_file_export will be enabled by default in a future Bazel release [1], thus breaking TensorFlow.\n\nThe flag is documented here: https://github.com/bazelbuild/bazel/issues/10225\n\nPlease check the following CI builds for build and test results:\n\n* <a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/361#3e0dba20-d84a-4394-bbe8-4155855f8aa5\" target=\"_blank\"><img src=\"https://raw.githubusercontent.com/buildkite/emojis/master/img-buildkite-64/mac.png\" height=\"16\"/>macOS, OpenJDK 8</a>\n* <a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/361#8067be5e-7d21-4333-a4e1-6e2817d456d4\" target=\"_blank\"><img src=\"https://raw.githubusercontent.com/buildkite/emojis/master/img-buildkite-64/ubuntu.png\" height=\"16\"/>Ubuntu 18.04, OpenJDK 11</a>\n* <a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/361#5664296d-5125-45bc-a16b-80fb8b5b94f1\" target=\"_blank\"><img src=\"https://raw.githubusercontent.com/buildkite/emojis/master/img-buildkite-64/windows.png\" height=\"16\"/>Windows, OpenJDK 8</a>\n\nNever heard of incompatible flags before? We have [documentation](https://docs.bazel.build/versions/master/backward-compatibility.html) that explains everything.\n\nIf you don't want to receive any future issues for TensorFlow or if you have any questions,\nplease file an issue in https://github.com/bazelbuild/continuous-integration\n\n**Important**: Please do NOT modify the issue title since that might break our tools.\n\n[1] The target release hasn't been determined yet. Our tool will update the issue title once the flag flip has been scheduled.\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35431", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35431/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35431/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35431/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35431", "id": 542618336, "node_id": "MDU6SXNzdWU1NDI2MTgzMzY=", "number": 35431, "title": "Unable to build", "user": {"login": "JesterOrNot", "id": 50386709, "node_id": "MDQ6VXNlcjUwMzg2NzA5", "avatar_url": "https://avatars3.githubusercontent.com/u/50386709?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JesterOrNot", "html_url": "https://github.com/JesterOrNot", "followers_url": "https://api.github.com/users/JesterOrNot/followers", "following_url": "https://api.github.com/users/JesterOrNot/following{/other_user}", "gists_url": "https://api.github.com/users/JesterOrNot/gists{/gist_id}", "starred_url": "https://api.github.com/users/JesterOrNot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JesterOrNot/subscriptions", "organizations_url": "https://api.github.com/users/JesterOrNot/orgs", "repos_url": "https://api.github.com/users/JesterOrNot/repos", "events_url": "https://api.github.com/users/JesterOrNot/events{/privacy}", "received_events_url": "https://api.github.com/users/JesterOrNot/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-12-26T17:43:43Z", "updated_at": "2020-03-18T22:50:58Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 19.0\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): Source\r\n- TensorFlow version: 2.0\r\n- Python version: 3.7.4\r\n- Installed using virtualenv? pip? conda?: pip\r\n- Bazel version (if compiling from source): 1.1.0\r\n- GCC/Compiler version (if compiling from source): 8.3.0\r\n- CUDA/cuDNN version: n/a\r\n- GPU model and memory: n/a\r\n\r\n\r\n\r\n**Describe the problem**\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\nAfter about 20+ minutes of watching the code build the build stopped abruptly\r\n\r\n**Any other info / logs**\r\nHere is a link to an enviorment where you can run my exact dev-env in the cloud\r\nhttps://gitpod.io/#https://github.com/JesterOrNot/tensorflow/tree/JesterOrNot/gitpod-setup\r\n\r\n```\r\n./tensorflow/python/lib/core/pybind11_proto.h:40:44: warning: 'pybind11::str pybind11::detail::object_api<Derived>::str() const [wi\r\nth Derived = pybind11::handle]' is deprecated: Use py::str(obj) instead [-Wdeprecated-declarations]\r\n       std::string(py_object.get_type().str()), \" is not a valid proto.\"));\r\n                                            ^\r\nIn file included from external/pybind11/include/pybind11/cast.h:13,\r\n                 from external/pybind11/include/pybind11/attr.h:13,\r\n                 from external/pybind11/include/pybind11/pybind11.h:49,\r\n                 from tensorflow/python/client/device_lib_wrapper.cc:18:\r\nexternal/pybind11/include/pybind11/pytypes.h:147:19: note: declared here\r\n     pybind11::str str() const;\r\n                   ^~~\r\nINFO: From Compiling tensorflow/stream_executor/stream_executor_pimpl.cc [for host]:\r\ntensorflow/stream_executor/stream_executor_pimpl.cc: In member function 'stream_executor::DeviceMemoryBase stream_executor::StreamE\r\nxecutor::Allocate(tensorflow::uint64, tensorflow::int64)':\r\ntensorflow/stream_executor/stream_executor_pimpl.cc:462:31: warning: comparison of integer expressions of different signedness: 'lo\r\nng long unsigned int' and 'tensorflow::int64' {aka 'long long int'} [-Wsign-compare]\r\n       mem_alloc_bytes_ + size > memory_limit_bytes_) {\r\n       ~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~\r\nIn file included from ./tensorflow/core/platform/default/logging.h:29,\r\n                 from ./tensorflow/core/platform/logging.h:27,\r\n                 from ./tensorflow/core/platform/status.h:24,\r\n                 from ./tensorflow/core/platform/errors.h:22,\r\n                 from ./tensorflow/core/lib/core/errors.h:19,\r\n                 from ./tensorflow/stream_executor/device_memory_allocator.h:23,\r\n                 from ./tensorflow/stream_executor/stream_executor_pimpl.h:28,\r\n                 from tensorflow/stream_executor/stream_executor_pimpl.cc:20:\r\n./tensorflow/core/platform/default/logging.h: In instantiation of 'std::__cxx11::string* tensorflow::internal::Check_EQImpl(const T1&, const T2&, const char*) [with T1 = int; T2 = long long unsigned int; std::__cxx11::string = std::__cxx11::basic_string<char>]':\r\ntensorflow/stream_executor/stream_executor_pimpl.cc:700:3:   required from here\r\n./tensorflow/core/platform/default/logging.h:386:25: warning: comparison of integer expressions of different signedness: 'const int' and 'const long long unsigned int' [-Wsign-compare]\r\n                         ==)  // Compilation error with CHECK_EQ(NULL, x)?\r\n./tensorflow/core/platform/macros.h:88:49: note: in definition of macro 'TF_PREDICT_TRUE'\r\n #define TF_PREDICT_TRUE(x) (__builtin_expect(!!(x), 1))\r\n                                                 ^\r\n./tensorflow/core/platform/default/logging.h:385:1: note: in expansion of macro 'TF_DEFINE_CHECK_OP_IMPL'\r\n TF_DEFINE_CHECK_OP_IMPL(Check_EQ,\r\n ^~~~~~~~~~~~~~~~~~~~~~~\r\nINFO: From Compiling tensorflow/compiler/mlir/tensorflow/utils/tpu_rewrite_device_util.cc [for host]:\r\ntensorflow/compiler/mlir/tensorflow/utils/tpu_rewrite_device_util.cc: In function 'tensorflow::Status tensorflow::{anonymous}::GetT\r\nPUDevices(tensorflow::Devices, llvm::ArrayRef<tensorflow::DeviceNameUtils::ParsedName>, llvm::SmallVectorImpl<llvm::SmallVector<ten\r\nsorflow::DeviceNameUtils::ParsedName, 8> >*)':\r\ntensorflow/compiler/mlir/tensorflow/utils/tpu_rewrite_device_util.cc:129:27: warning: comparison of integer expressions of differen\r\nt signedness: 'int' and 'size_t' {aka 'long unsigned int'} [-Wsign-compare]\r\n     if (num_tpus_per_host != host_tpu_devices.size())\r\n         ~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~\r\nINFO: From Compiling tensorflow/core/kernels/quantization_utils.cc [for host]:\r\nIn file included from external/gemmlowp/public/../internal/dispatch_gemm_shape.h:23,\r\n                 from external/gemmlowp/public/gemmlowp.h:19,\r\n                 from ./tensorflow/core/kernels/quantization_utils.h:37,\r\n                 from tensorflow/core/kernels/quantization_utils.cc:16:\r\nexternal/gemmlowp/public/../internal/multi_thread_gemm.h: In member function 'void gemmlowp::WorkersPool::LegacyExecuteAndDestroyTa\r\nsks(const std::vector<gemmlowp::Task*>&)':\r\nexternal/gemmlowp/public/../internal/multi_thread_gemm.h:405:23: warning: comparison of integer expressions of different signedness\r\n: 'int' and 'std::size_t' {aka 'long unsigned int'} [-Wsign-compare]\r\n     for (int i = 0; i < tasks_count - 1; i++) {\r\n                     ~~^~~~~~~~~~~~~~~~~\r\nIn file included from tensorflow/core/kernels/quantization_utils.cc:16:\r\n./tensorflow/core/kernels/quantization_utils.h: In function 'void tensorflow::RequantizeManyInNewRangeReference(const qint32*, tensorflow::int64, float, float, float, float, tensorflow::quint8*)':\r\n./tensorflow/core/kernels/quantization_utils.h:271:32: warning: comparison of integer expressions of different signedness: 'size_t' {aka 'long unsigned int'} and 'tensorflow::int64' {aka 'long long int'} [-Wsign-compare]\r\n   for (size_t index = 0; index < count; ++index) {\r\n                          ~~~~~~^~~~~~~\r\n[6,434 / 12,032] 16 actions running\r\n    Compiling tensorflow/python/tfe_wrapper.cc [for host]; 77s local\r\n    Compiling tensorflow/core/kernels/rnn/lstm_ops.cc [for host]; 44s local\r\n    Compiling tensorflow/core/kernels/rnn/gru_ops.cc [for host]; 43s local\r\n    Compiling tensorflow/stream_executor/stream.cc [for host]; 41s local\r\n    Compiling tensorflow/core/kernels/split_lib_cpu.cc [for host]; 28s local\r\n    Compiling .../core/kernels/serialize_sparse_op.cc [for host]; 24s local\r\n    //tensorflow/core/kernels:deserialize_sparse_string_op; 22s local\r\n    Compiling .../core/kernels/sparse_reorder_op.cc [for host]; 22s local ...\r\n\r\nServer terminated abruptly (error code: 14, error message: 'Socket closed', log file: '/home/gitpod/.cache/bazel/_bazel_gitpod/2c92b5569ddded7b3a6bd5e139451b60/server/jvm.out'\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35419", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35419/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35419/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35419/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35419", "id": 542469918, "node_id": "MDU6SXNzdWU1NDI0Njk5MTg=", "number": 35419, "title": "Cannot use fine-tuned ssd_mobilenet_v2 model with TF Lite on Android", "user": {"login": "MichaelW17", "id": 44422524, "node_id": "MDQ6VXNlcjQ0NDIyNTI0", "avatar_url": "https://avatars0.githubusercontent.com/u/44422524?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MichaelW17", "html_url": "https://github.com/MichaelW17", "followers_url": "https://api.github.com/users/MichaelW17/followers", "following_url": "https://api.github.com/users/MichaelW17/following{/other_user}", "gists_url": "https://api.github.com/users/MichaelW17/gists{/gist_id}", "starred_url": "https://api.github.com/users/MichaelW17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MichaelW17/subscriptions", "organizations_url": "https://api.github.com/users/MichaelW17/orgs", "repos_url": "https://api.github.com/users/MichaelW17/repos", "events_url": "https://api.github.com/users/MichaelW17/events{/privacy}", "received_events_url": "https://api.github.com/users/MichaelW17/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1162044565, "node_id": "MDU6TGFiZWwxMTYyMDQ0NTY1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.12", "name": "TF 1.12", "color": "c2e0c6", "default": false, "description": "Issues related to TF 1.12"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "srjoglekar246", "id": 2099293, "node_id": "MDQ6VXNlcjIwOTkyOTM=", "avatar_url": "https://avatars3.githubusercontent.com/u/2099293?v=4", "gravatar_id": "", "url": "https://api.github.com/users/srjoglekar246", "html_url": "https://github.com/srjoglekar246", "followers_url": "https://api.github.com/users/srjoglekar246/followers", "following_url": "https://api.github.com/users/srjoglekar246/following{/other_user}", "gists_url": "https://api.github.com/users/srjoglekar246/gists{/gist_id}", "starred_url": "https://api.github.com/users/srjoglekar246/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/srjoglekar246/subscriptions", "organizations_url": "https://api.github.com/users/srjoglekar246/orgs", "repos_url": "https://api.github.com/users/srjoglekar246/repos", "events_url": "https://api.github.com/users/srjoglekar246/events{/privacy}", "received_events_url": "https://api.github.com/users/srjoglekar246/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "srjoglekar246", "id": 2099293, "node_id": "MDQ6VXNlcjIwOTkyOTM=", "avatar_url": "https://avatars3.githubusercontent.com/u/2099293?v=4", "gravatar_id": "", "url": "https://api.github.com/users/srjoglekar246", "html_url": "https://github.com/srjoglekar246", "followers_url": "https://api.github.com/users/srjoglekar246/followers", "following_url": "https://api.github.com/users/srjoglekar246/following{/other_user}", "gists_url": "https://api.github.com/users/srjoglekar246/gists{/gist_id}", "starred_url": "https://api.github.com/users/srjoglekar246/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/srjoglekar246/subscriptions", "organizations_url": "https://api.github.com/users/srjoglekar246/orgs", "repos_url": "https://api.github.com/users/srjoglekar246/repos", "events_url": "https://api.github.com/users/srjoglekar246/events{/privacy}", "received_events_url": "https://api.github.com/users/srjoglekar246/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2019-12-26T07:48:12Z", "updated_at": "2020-01-10T22:06:39Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Win10\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: Pixel 2 Simulator in Android Studio with Android 7.1.1\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version (use command below): 1.12.2\r\n- Python version: 3.6.9\r\n- Bazel version (if compiling from source): 0.15.0\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: 9.0/7.5\r\n- GPU model and memory: 1070 max-q 8 GB\r\n\r\n\r\n**Describe the current behavior**\r\nI fine-tuned the ssd_mobilenet_v2 pretrained model from Tensorflow model zoo to detect two classes. Training was done with TF OD API. After converting the model to detect.tflite and put it in the \"assets\" folder of the [official Android demo](https://github.com/tensorflow/examples/tree/master/lite/examples/object_detection/android) and modified labelmap.txt, upon running I got the following error:\r\n```java\r\nE/AndroidRuntime: FATAL EXCEPTION: inference\r\n    Process: org.tensorflow.lite.examples.detection, PID: 4609\r\n    java.lang.IllegalArgumentException: Internal error: Failed to run on the given Interpreter: tensorflow/lite/kernels/detection_postprocess.cc:404 ValidateBoxes(decoded_boxes, num_boxes) was not true.\r\n    Node number 102 (TFLite_Detection_PostProcess) failed to invoke.\r\n    \r\n        at org.tensorflow.lite.NativeInterpreterWrapper.run(Native Method)\r\n        at org.tensorflow.lite.NativeInterpreterWrapper.run(NativeInterpreterWrapper.java:152)\r\n        at org.tensorflow.lite.Interpreter.runForMultipleInputsOutputs(Interpreter.java:296)\r\n        at org.tensorflow.lite.examples.detection.tflite.TFLiteObjectDetectionAPIModel.recognizeImage(TFLiteObjectDetectionAPIModel.java:193)\r\n        at org.tensorflow.lite.examples.detection.DetectorActivity$2.run(DetectorActivity.java:183)\r\n        at android.os.Handler.handleCallback(Handler.java:751)\r\n        at android.os.Handler.dispatchMessage(Handler.java:95)\r\n        at android.os.Looper.loop(Looper.java:154)\r\n        at android.os.HandlerThread.run(HandlerThread.java:61)\r\n```\r\nHowever, if I use model.ckpt-0 which is the initial checkpoint, the converted .tflite works fine. So I assume that the convertion is OK. Is it due to the training process?\r\nPlease help me figure this out.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35416", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35416/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35416/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35416/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35416", "id": 542421561, "node_id": "MDU6SXNzdWU1NDI0MjE1NjE=", "number": 35416, "title": "Bijectors crash tf2.1 autograph in distributed mirrored multi-gpu mode", "user": {"login": "olegmyrk", "id": 884233, "node_id": "MDQ6VXNlcjg4NDIzMw==", "avatar_url": "https://avatars2.githubusercontent.com/u/884233?v=4", "gravatar_id": "", "url": "https://api.github.com/users/olegmyrk", "html_url": "https://github.com/olegmyrk", "followers_url": "https://api.github.com/users/olegmyrk/followers", "following_url": "https://api.github.com/users/olegmyrk/following{/other_user}", "gists_url": "https://api.github.com/users/olegmyrk/gists{/gist_id}", "starred_url": "https://api.github.com/users/olegmyrk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/olegmyrk/subscriptions", "organizations_url": "https://api.github.com/users/olegmyrk/orgs", "repos_url": "https://api.github.com/users/olegmyrk/repos", "events_url": "https://api.github.com/users/olegmyrk/events{/privacy}", "received_events_url": "https://api.github.com/users/olegmyrk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-12-26T03:42:00Z", "updated_at": "2020-01-01T18:57:24Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n* Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n* OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04.3 LTS\r\n* TensorFlow installed from (source or binary): binary\r\n* TensorFlow version (use command below): v2.1.0-rc1-58-g9837ece 2.1.0-rc2 (python3 -c \"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\")\r\n* Python version: Python 3.6.8\r\n* CUDA/cuDNN version: Driver Version: 440.33.01, CUDA Version: 10.2, cuDNN 7.6.2\r\n* GPU model and memory: Tesla V100-SXM2-16GB\r\n\r\n**Describe the current behavior**\r\nI'm using Bijectors as a flexible prior for a VAE. \r\n\r\nIn tf2.1 autograph distributed mirrored mode \r\nhttps://github.com/olegmyrk/SPADE-Tensorflow/blob/85b5fd7943296561dc3d54557fec5346c2adea58/SPADE.py#L1152\r\nI am getting\r\n```\r\ngoogle.protobuf.message.DecodeError: Error parsing message\r\n```\r\nwhen running with multiple GPUs (but not when running with single GPU):\r\n```\r\nbijectors = []\r\nfor i in range(16):\r\n    bijectors.append(tfb.MaskedAutoregressiveFlow(\r\n      shift_and_log_scale_fn=tfb.masked_autoregressive_default_template(\r\n          code, hidden_layers=[1024, 1024], name=scope + \"/maf_\" + str(i))))\r\n\r\n    bijectors.append(tfb.BatchNormalization(\r\n        batchnorm_layer=tf.layers.BatchNormalization(\r\n                            name=scope + '/batch_norm_' + str(i)),\r\n        name=scope + '/batch_norm_bijector' + str(i)))\r\n\r\n    permutation=tf.get_variable('permutation_'+str(i), initializer=np.random.permutation(out_channel).astype(\"int32\"), trainable=False)\r\n    bijectors.append(tfb.Permute(permutation))\r\n    \r\nflow_bijector = tfb.Chain(list(reversed(bijectors[:-1])))\r\n```\r\nhttps://github.com/olegmyrk/SPADE-Tensorflow/blob/85b5fd7943296561dc3d54557fec5346c2adea58/SPADE.py#L190\r\n\r\n**Describe the expected behavior**\r\nShould not crash\r\n\r\n**Code to reproduce the issue**\r\nTF2.x code:\r\nhttps://github.com/olegmyrk/SPADE-Tensorflow/blob/85b5fd7943296561dc3d54557fec5346c2adea58/SPADE.py#L190\r\n\r\n**Other info / logs**\r\n```\r\nTraceback (most recent call last):\r\n  File \"main.py\", line 134, in <module>\r\n    main()\r\n  File \"main.py\", line 121, in main\r\n    gan.train()\r\n  File \"/app/home/ubuntu/SPADE-Tensorflow.tf2/SPADE.py\", line 1379, in train\r\n    train_loop()\r\n  File \"/app/home/ubuntu/SPADE-Tensorflow.tf2/SPADE.py\", line 1336, in train_loop\r\n    counter, result_inputs, result_losses_det, result_outputs_det, result_outputs_resample_det, result_outputs_random_det, result_outputs_random_gen_det = train_det_grad_both(global_step, self.train_main, *inputs)\r\n  File \"/home/ubuntu/.local/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py\", line 568, in __call__\r\n    result = self._call(*args, **kwds)\r\n  File \"/home/ubuntu/.local/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py\", line 615, in _call\r\n    self._initialize(args, kwds, add_initializers_to=initializers)\r\n  File \"/home/ubuntu/.local/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py\", line 497, in _initialize\r\n    *args, **kwds))\r\n  File \"/home/ubuntu/.local/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 2389, in _get_concrete_function_internal_garbage_collected\r\n    graph_function, _, _ = self._maybe_define_function(args, kwargs)\r\n  File \"/home/ubuntu/.local/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 2703, in _maybe_define_function\r\n    graph_function = self._create_graph_function(args, kwargs)\r\n  File \"/home/ubuntu/.local/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 2599, in _create_graph_function\r\n    shared_func_graph=False)\r\n  File \"/home/ubuntu/.local/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 1511, in __init__\r\n    func_graph, self._attrs, self._garbage_collector)\r\n  File \"/home/ubuntu/.local/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 601, in __init__\r\n    self._func_graph.inputs, self._func_graph.outputs, attrs)\r\n  File \"/home/ubuntu/.local/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 466, in __init__\r\n    function_def.ParseFromString(compat.as_bytes(proto_data))\r\ngoogle.protobuf.message.DecodeError: Error parsing message\r\n```\r\n[train.CelebAMask-HQ.tf21.4xgpu.maf.log](https://github.com/tensorflow/tensorflow/files/4001259/train.CelebAMask-HQ.tf21.4xgpu.maf.log)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35415", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35415/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35415/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35415/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35415", "id": 542418468, "node_id": "MDU6SXNzdWU1NDI0MTg0Njg=", "number": 35415, "title": "Bijectors are orders of magnitude slower in tf2.1 autograph distributed mirrored single-gpu mode", "user": {"login": "olegmyrk", "id": 884233, "node_id": "MDQ6VXNlcjg4NDIzMw==", "avatar_url": "https://avatars2.githubusercontent.com/u/884233?v=4", "gravatar_id": "", "url": "https://api.github.com/users/olegmyrk", "html_url": "https://github.com/olegmyrk", "followers_url": "https://api.github.com/users/olegmyrk/followers", "following_url": "https://api.github.com/users/olegmyrk/following{/other_user}", "gists_url": "https://api.github.com/users/olegmyrk/gists{/gist_id}", "starred_url": "https://api.github.com/users/olegmyrk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/olegmyrk/subscriptions", "organizations_url": "https://api.github.com/users/olegmyrk/orgs", "repos_url": "https://api.github.com/users/olegmyrk/repos", "events_url": "https://api.github.com/users/olegmyrk/events{/privacy}", "received_events_url": "https://api.github.com/users/olegmyrk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-12-26T03:21:17Z", "updated_at": "2020-01-01T23:14:19Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n* Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n* OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04.3 LTS\r\n* TensorFlow installed from (source or binary): binary\r\n* TensorFlow version (use command below): v2.1.0-rc1-58-g9837ece 2.1.0-rc2 (python3 -c \"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\")\r\n* Python version: Python 3.6.8\r\n* CUDA/cuDNN version: Driver Version: 440.33.01, CUDA Version: 10.2, cuDNN 7.6.2\r\n *GPU model and memory: Tesla V100-SXM2-16GB\r\n\r\n**Describe the current behavior**\r\nI'm using Bijectors as a flexible prior for a VAE. \r\n\r\nThis code has negligible overhead in tf1.x (for input batch size 18x256x256x3). In tf2.1 autograph distributed mirrored mode \r\nhttps://github.com/olegmyrk/SPADE-Tensorflow/blob/85b5fd7943296561dc3d54557fec5346c2adea58/SPADE.py#L1152\r\nwith single GPU it increases training step duration 1 second (tf1.x) -> 1.9 seconds (tf2.1):\r\n```\r\nbijectors = []\r\nfor i in range(16):\r\n    bijectors.append(tfb.MaskedAutoregressiveFlow(\r\n      shift_and_log_scale_fn=tfb.masked_autoregressive_default_template(\r\n          code, hidden_layers=[1024, 1024], name=scope + \"/maf_\" + str(i))))\r\n\r\n    bijectors.append(tfb.BatchNormalization(\r\n        batchnorm_layer=tf.layers.BatchNormalization(\r\n                            name=scope + '/batch_norm_' + str(i)),\r\n        name=scope + '/batch_norm_bijector' + str(i)))\r\n\r\n    permutation=tf.get_variable('permutation_'+str(i), initializer=np.random.permutation(out_channel).astype(\"int32\"), trainable=False)\r\n    bijectors.append(tfb.Permute(permutation))\r\n    \r\nflow_bijector = tfb.Chain(list(reversed(bijectors[:-1])))\r\n```\r\nhttps://github.com/olegmyrk/SPADE-Tensorflow/blob/85b5fd7943296561dc3d54557fec5346c2adea58/SPADE.py#L190\r\n\r\nI'm using custom masked autoregressive template\r\nhttps://github.com/olegmyrk/SPADE-Tensorflow/blob/85b5fd7943296561dc3d54557fec5346c2adea58/masked_autoregressive.py\r\nbut it is as slow with the default one:\r\nhttps://www.tensorflow.org/probability/api_docs/python/tfp/bijectors/masked_autoregressive_default_template\r\n\r\nPossible suspects:\r\n```\r\ntfb.masked_dense\r\n```\r\nhttps://github.com/olegmyrk/SPADE-Tensorflow/blob/85b5fd7943296561dc3d54557fec5346c2adea58/masked_autoregressive.py#L44\r\n\r\n```\r\ntf1.make_template()\r\n```\r\nhttps://github.com/olegmyrk/SPADE-Tensorflow/blob/85b5fd7943296561dc3d54557fec5346c2adea58/masked_autoregressive.py#L115\r\n\r\n**Describe the expected behavior**\r\nPerformance in tf2.1 and tf1.x should be comparable.\r\n\r\n**Code to reproduce the issue**\r\nTF2.x code:\r\nhttps://github.com/olegmyrk/SPADE-Tensorflow/blob/85b5fd7943296561dc3d54557fec5346c2adea58/SPADE.py#L190\r\n\r\nTF1.x code:\r\nhttps://github.com/olegmyrk/SPADE-Tensorflow/blob/develop/SPADE.py#L190\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35414", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35414/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35414/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35414/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35414", "id": 542416831, "node_id": "MDU6SXNzdWU1NDI0MTY4MzE=", "number": 35414, "title": "no such package '@com_google_protobuf error while running bazel build", "user": {"login": "4dcity", "id": 3881550, "node_id": "MDQ6VXNlcjM4ODE1NTA=", "avatar_url": "https://avatars0.githubusercontent.com/u/3881550?v=4", "gravatar_id": "", "url": "https://api.github.com/users/4dcity", "html_url": "https://github.com/4dcity", "followers_url": "https://api.github.com/users/4dcity/followers", "following_url": "https://api.github.com/users/4dcity/following{/other_user}", "gists_url": "https://api.github.com/users/4dcity/gists{/gist_id}", "starred_url": "https://api.github.com/users/4dcity/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/4dcity/subscriptions", "organizations_url": "https://api.github.com/users/4dcity/orgs", "repos_url": "https://api.github.com/users/4dcity/repos", "events_url": "https://api.github.com/users/4dcity/events{/privacy}", "received_events_url": "https://api.github.com/users/4dcity/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1188421838, "node_id": "MDU6TGFiZWwxMTg4NDIxODM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:windows", "name": "subtype:windows", "color": "b619ea", "default": false, "description": "Windows Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-12-26T03:10:00Z", "updated_at": "2020-03-19T04:01:10Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution: Windows10 x64\r\n- TensorFlow installed from: binary\r\n- TensorFlow version: 1.15.0\r\n- Python version: 3.7\r\n- Installed using: conda\r\n- Bazel version (if compiling from source): 1.1/2.0\r\n- CUDA/cuDNN version: 10.0\r\n\r\nI was trying to inspect a model following the guide [here](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/tools/graph_transforms/README.md#inspecting-graphs)\r\nWhen running the command\r\n```bash\r\nbazel build tensorflow/tools/graph_transforms:summarize_graph\r\n```\r\nit failed with these logs\r\n```\r\nINFO: Writing tracer profile to 'C:/users/yy/_bazel_yy/zxtlmlwl/command.profile.gz'\r\nINFO: Options provided by the client:\r\n  Inherited 'common' options: --isatty=1 --terminal_columns=120\r\nINFO: Options provided by the client:\r\n  'build' options: --python_path=C:/Users/YY/Anaconda3/python.exe\r\nINFO: Reading rc options for 'build' from e:\\tensorflow\\tensorflow\\.bazelrc:\r\n  'build' options: --apple_platform_type=macos --define framework_shared_object=true --define open_source_build=true --java_toolchain=//third_party/toolchains/java:tf_java_toolchain --host_java_toolchain=//third_party/toolchains/java:tf_java_toolchain --define=use_fast_cpp_protos=true --define=allow_oversize_protos=true --spawn_strategy=standalone -c opt --announce_rc --define=grpc_no_ares=true --noincompatible_remove_legacy_whole_archive --enable_platform_specific_config --config=v2\r\nINFO: Found applicable config definition build:v2 in file e:\\tensorflow\\tensorflow\\.bazelrc: --define=tf_api_version=2 --action_env=TF2_BEHAVIOR=1\r\nINFO: Found applicable config definition build:windows in file e:\\tensorflow\\tensorflow\\.bazelrc: --copt=/w --copt=/D_USE_MATH_DEFINES --cxxopt=/std:c++14 --host_cxxopt=/std:c++14 --config=monolithic --copt=-DWIN32_LEAN_AND_MEAN --host_copt=-DWIN32_LEAN_AND_MEAN --copt=-DNOGDI --host_copt=-DNOGDI --linkopt=/DEBUG --host_linkopt=/DEBUG --linkopt=/OPT:REF --host_linkopt=/OPT:REF --linkopt=/OPT:ICF --host_linkopt=/OPT:ICF --experimental_strict_action_env=true --incompatible_windows_native_test_wrapper --verbose_failures --distinct_host_configuration=false\r\nINFO: Found applicable config definition build:monolithic in file e:\\tensorflow\\tensorflow\\.bazelrc: --define framework_shared_object=false\r\nINFO: Call stack for the definition of repository 'com_google_protobuf' which is a tf_http_archive (rule definition at E:/tensorflow/tensorflow/third_party/repo.bzl:121:19):\r\n - E:/tensorflow/tensorflow/tensorflow/workspace.bzl:457:5\r\n - E:/tensorflow/tensorflow/WORKSPACE:19:1\r\nINFO: Repository 'com_google_protobuf' used the following cache hits instead of downloading the corresponding file.\r\n * Hash 'b9e92f9af8819bbbc514e2902aec860415b70209f31dfc8c4fa72515a5df9d59' for https://storage.googleapis.com/mirror.tensorflow.org/github.com/protocolbuffers/protobuf/archive/310ba5ee72661c081129eb878c1bbcec936b20f0.tar.gz\r\nIf the definition of 'com_google_protobuf' was updated, verify that the hashes were also updated.\r\nERROR: An error occurred during the fetch of repository 'com_google_protobuf':\r\n   Traceback (most recent call last):\r\n        File \"E:/tensorflow/tensorflow/third_party/repo.bzl\", line 101\r\n                _apply_patch(ctx, <1 more arguments>)\r\n        File \"E:/tensorflow/tensorflow/third_party/repo.bzl\", line 68, in _apply_patch\r\n                _execute_and_check_ret_code(ctx, <1 more arguments>)\r\n        File \"E:/tensorflow/tensorflow/third_party/repo.bzl\", line 52, in _execute_and_check_ret_code\r\n                fail(<1 more arguments>)\r\nNon-zero return code(2) when executing 'C:\\Windows\\system32\\bash.exe -l -c \"patch\" \"-p1\" \"-d\" \"C:/users/yy/_bazel_yy/zxtlmlwl/external/com_google_protobuf\" \"-i\" \"E:/tensorflow/tensorflow/third_party/protobuf/protobuf.patch\"':\r\nStdout:\r\nStderr: patch: **** Can't change to directory C:/users/yy/_bazel_yy/zxtlmlwl/external/com_google_protobuf : No such file or directory\r\nERROR: Analysis of target '//tensorflow/tools/graph_transforms:summarize_graph' failed; build aborted: no such package '@com_google_protobuf//': Traceback (most recent call last):\r\n        File \"E:/tensorflow/tensorflow/third_party/repo.bzl\", line 101\r\n                _apply_patch(ctx, <1 more arguments>)\r\n        File \"E:/tensorflow/tensorflow/third_party/repo.bzl\", line 68, in _apply_patch\r\n                _execute_and_check_ret_code(ctx, <1 more arguments>)\r\n        File \"E:/tensorflow/tensorflow/third_party/repo.bzl\", line 52, in _execute_and_check_ret_code\r\n                fail(<1 more arguments>)\r\nNon-zero return code(2) when executing 'C:\\Windows\\system32\\bash.exe -l -c \"patch\" \"-p1\" \"-d\" \"C:/users/yy/_bazel_yy/zxtlmlwl/external/com_google_protobuf\" \"-i\" \"E:/tensorflow/tensorflow/third_party/protobuf/protobuf.patch\"':\r\nStdout:\r\nStderr: patch: **** Can't change to directory C:/users/yy/_bazel_yy/zxtlmlwl/external/com_google_protobuf : No such file or directory\r\nINFO: Elapsed time: 3.975s\r\nINFO: 0 processes.\r\nFAILED: Build did NOT complete successfully (0 packages loaded, 0 targets configured)\r\n    currently loading: tensorflow\r\n```\r\n\r\nI've tried diferent versions of bazel, 0.20, 1.1.0, and 2.0.0\uff0cand ```bazel clean```, the error is still there.\r\nWhat makes me confused is that the \" Can't change to directory C:/users/yy/_bazel_yy/zxtlmlwl/external/com_google_protobuf : No such file or directory\", which in fact I can find the dir at that path\r\n\r\nI've checked other similar issue, but none can fix this error\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35408", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35408/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35408/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35408/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35408", "id": 542348933, "node_id": "MDU6SXNzdWU1NDIzNDg5MzM=", "number": 35408, "title": "Cannot build gl_delegate of android", "user": {"login": "stereomatchingkiss", "id": 1801914, "node_id": "MDQ6VXNlcjE4MDE5MTQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/1801914?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stereomatchingkiss", "html_url": "https://github.com/stereomatchingkiss", "followers_url": "https://api.github.com/users/stereomatchingkiss/followers", "following_url": "https://api.github.com/users/stereomatchingkiss/following{/other_user}", "gists_url": "https://api.github.com/users/stereomatchingkiss/gists{/gist_id}", "starred_url": "https://api.github.com/users/stereomatchingkiss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stereomatchingkiss/subscriptions", "organizations_url": "https://api.github.com/users/stereomatchingkiss/orgs", "repos_url": "https://api.github.com/users/stereomatchingkiss/repos", "events_url": "https://api.github.com/users/stereomatchingkiss/events{/privacy}", "received_events_url": "https://api.github.com/users/stereomatchingkiss/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2019-12-25T14:18:31Z", "updated_at": "2020-01-02T18:16:22Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu18.04.3 LTS, 64bits\r\n- TensorFlow installed from: https://github.com/tensorflow/tensorflow, \r\n- TensorFlow version: 8e8fabfee3\r\n- Python version: Python 3.6.9 :: Anaconda, Inc.\r\n- Installed using virtualenv? pip? conda?: conda\r\n- Bazel version (if compiling from source): 1.1.0\r\n- GCC/Compiler version (if compiling from source): Not compiled from source\r\n- CUDA/cuDNN version: None\r\n- GPU model and memory: None\r\n\r\n\r\n\r\n**Describe the problem**\r\n\r\nI can build the libtensorflow-lite.a. by \r\n\r\n`./tensorflow/lite/tools/make/build_aarch64_lib.sh`\r\n\r\nBut cannot build the gl_delegate by\r\n\r\n`bazel build -c opt --config android_arm64 tensorflow/lite/delegates/gpu:gl_delegate`\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n\r\n1. Install tensorflow and build the libtensorflow-lite.a by the instructions from [here](https://www.tensorflow.org/lite/guide/build_arm64)\r\n2. Install bazel by the instructions from [here](https://docs.bazel.build/versions/master/install-ubuntu.html) \r\n3. Install anaconda, create environment\r\n`conta create --name tensorflow python=3.6`\r\n4. Install tensorflow and others tools by conda\r\n5. Build gl_delegate by `bazel build -c opt --config android_arm64 tensorflow/lite/delegates/gpu:gl_delegate`\r\n\r\n**Any other info / logs**\r\n\r\n> NFO: Writing tracer profile to '/home/yyyy/.cache/bazel/_bazel_yyyy/9f4180a9f81bdaca56a8020b37cc35bc/command.profile.gz'\r\n> INFO: Options provided by the client:\r\n>   Inherited 'common' options: --isatty=1 --terminal_columns=111\r\n> INFO: Reading rc options for 'build' from /home/yyyy/Qt/3rdLibs/tensorflow/.bazelrc:\r\n>   'build' options: --apple_platform_type=macos --define framework_shared_object=true --define open_source_build=true --java_toolchain=//third_party/toolchains/java:tf_java_toolchain --host_java_toolchain=//third_party/toolchains/java:tf_java_toolchain --define=use_fast_cpp_protos=true --define=allow_oversize_protos=true --spawn_strategy=standalone -c opt --announce_rc --define=grpc_no_ares=true --noincompatible_remove_legacy_whole_archive --enable_platform_specific_config --config=v2\r\n> INFO: Found applicable config definition build:v2 in file /home/yyyy/Qt/3rdLibs/tensorflow/.bazelrc: --define=tf_api_version=2 --action_env=TF2_BEHAVIOR=1\r\n> INFO: Found applicable config definition build:android_arm64 in file /home/yyyy/Qt/3rdLibs/tensorflow/.bazelrc: --config=android --cpu=arm64-v8a --fat_apk_cpu=arm64-v8a\r\n> INFO: Found applicable config definition build:android in file /home/yyyy/Qt/3rdLibs/tensorflow/.bazelrc: --crosstool_top=//external:android/crosstool --host_crosstool_top=@bazel_tools//tools/cpp:toolchain\r\n> INFO: Found applicable config definition build:linux in file /home/yyyy/Qt/3rdLibs/tensorflow/.bazelrc: --copt=-w --define=PREFIX=/usr --define=LIBDIR=$(PREFIX)/lib --define=INCLUDEDIR=$(PREFIX)/include --cxxopt=-std=c++14 --host_cxxopt=-std=c++14 --config=dynamic_kernels\r\n> INFO: Found applicable config definition build:dynamic_kernels in file /home/yyyy/Qt/3rdLibs/tensorflow/.bazelrc: --define=dynamic_loaded_kernels=true --copt=-DAUTOLOAD_DYNAMIC_KERNELS\r\n> DEBUG: Rule 'io_bazel_rules_docker' indicated that a canonical reproducible form can be obtained by modifying arguments shallow_since = \"1556410077 -0400\"\r\n> DEBUG: Call stack for the definition of repository 'io_bazel_rules_docker' which is a git_repository (rule definition at /home/yyyy/.cache/bazel/_bazel_yyyy/9f4180a9f81bdaca56a8020b37cc35bc/external/bazel_tools/tools/build_defs/repo/git.bzl:195:18):\r\n>  - /home/yyyy/.cache/bazel/_bazel_yyyy/9f4180a9f81bdaca56a8020b37cc35bc/external/bazel_toolchains/repositories/repositories.bzl:37:9\r\n>  - /home/yyyy/Qt/3rdLibs/tensorflow/WORKSPACE:37:1\r\n> ERROR: /home/yyyy/.cache/bazel/_bazel_yyyy/9f4180a9f81bdaca56a8020b37cc35bc/external/local_config_cc/BUILD:47:1: in cc_toolchain_suite rule @local_config_cc//:toolchain: cc_toolchain_suite '@local_config_cc//:toolchain' does not contain a toolchain for cpu 'arm64-v8a'\r\n> ERROR: Analysis of target '//tensorflow/lite/delegates/gpu:libtensorflowlite_gpu_gl.so' failed; build aborted: Analysis of target '@local_config_cc//:toolchain' failed; build aborted\r\n> INFO: Elapsed time: 0.450s\r\n> INFO: 0 processes.\r\n> FAILED: Build did NOT complete successfully (1 packages loaded, 1 target configured)"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35405", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35405/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35405/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35405/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35405", "id": 542317799, "node_id": "MDU6SXNzdWU1NDIzMTc3OTk=", "number": 35405, "title": "tensorflowlib for 2.0", "user": {"login": "Dave-Stein", "id": 59223977, "node_id": "MDQ6VXNlcjU5MjIzOTc3", "avatar_url": "https://avatars2.githubusercontent.com/u/59223977?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dave-Stein", "html_url": "https://github.com/Dave-Stein", "followers_url": "https://api.github.com/users/Dave-Stein/followers", "following_url": "https://api.github.com/users/Dave-Stein/following{/other_user}", "gists_url": "https://api.github.com/users/Dave-Stein/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dave-Stein/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dave-Stein/subscriptions", "organizations_url": "https://api.github.com/users/Dave-Stein/orgs", "repos_url": "https://api.github.com/users/Dave-Stein/repos", "events_url": "https://api.github.com/users/Dave-Stein/events{/privacy}", "received_events_url": "https://api.github.com/users/Dave-Stein/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1188421838, "node_id": "MDU6TGFiZWwxMTg4NDIxODM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:windows", "name": "subtype:windows", "color": "b619ea", "default": false, "description": "Windows Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-12-25T10:38:18Z", "updated_at": "2020-03-05T17:12:11Z", "closed_at": null, "author_association": "NONE", "body": "I can see many users over the last 2 weeks struggling with getting the build to work with Windows 10. I also see a few **recent commits** to improve the build in response to the above feedback.\r\n\r\nAs [stated here](https://www.tensorflow.org/install/source_windows) that the Windows tensorflow 2.0 builds with following configurations are successful.\r\n\r\n![image](https://user-images.githubusercontent.com/59223977/71443261-34f74d00-270a-11ea-8cc5-ee2902f336b8.png)\r\n![image](https://user-images.githubusercontent.com/59223977/71443269-44769600-270a-11ea-8857-750f7f3598ee.png)\r\n\r\nPlease **update** [the links](https://www.tensorflow.org/install/lang_c) here with the successful windows tensorflow 2.0 builds provided above \r\n\r\nFor example: we need\r\nhttps://storage.googleapis.com/tensorflow/libtensorflow/libtensorflow-cpu-windows-x86_64-2.0.0.zip\r\nhttps://storage.googleapis.com/tensorflow/libtensorflow/libtensorflow-gpu-windows-x86_64-2.0.0.zip\r\n\r\n_Although these tentative builds are old_, but it will provide a starting point **to start TESTING the Tensorflow 2.0 features through bindings.**"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35404", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35404/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35404/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35404/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35404", "id": 542291800, "node_id": "MDU6SXNzdWU1NDIyOTE4MDA=", "number": 35404, "title": "ValueError: Flattening a PerReplica to components is not supported in replica context.", "user": {"login": "x7night", "id": 38029731, "node_id": "MDQ6VXNlcjM4MDI5NzMx", "avatar_url": "https://avatars0.githubusercontent.com/u/38029731?v=4", "gravatar_id": "", "url": "https://api.github.com/users/x7night", "html_url": "https://github.com/x7night", "followers_url": "https://api.github.com/users/x7night/followers", "following_url": "https://api.github.com/users/x7night/following{/other_user}", "gists_url": "https://api.github.com/users/x7night/gists{/gist_id}", "starred_url": "https://api.github.com/users/x7night/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/x7night/subscriptions", "organizations_url": "https://api.github.com/users/x7night/orgs", "repos_url": "https://api.github.com/users/x7night/repos", "events_url": "https://api.github.com/users/x7night/events{/privacy}", "received_events_url": "https://api.github.com/users/x7night/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-12-25T08:29:13Z", "updated_at": "2020-02-03T10:00:30Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- windows\r\n- TensorFlow installed from conda\r\n- TensorFlow version:2.0\r\n- Python version:3.7.4\r\n- CUDA/cuDNN version: 10.2/7.6\r\n- GPU model and memory: 2 nvidia rtx 2070s 8GB\r\n\r\n**Describe the current behavior**\r\ni follow the distributed training tutorials to change my code(custom model) for cumtom training loop. but when i run the script, it shows mistake \"ValueError: Flattening a PerReplica to components is not supported in replica context.\". i don't understande why it is happens.  it can run in the train step,  but it can't run in the test step\r\n**Describe the expected behavior**\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n```\r\n# i use this strategy before,but it make the same mistake\r\n# strategy = tf.distribute.MirroredStrategy(\r\n#     cross_device_ops=tf.distribute.HierarchicalCopyAllReduce())\r\n\r\nstrategy = tf.distribute.MirroredStrategy(\r\n        cross_device_ops=tf.distribute.ReductionToOneDevice(\"/device:CPU:0\"))\r\n\r\ndef train_step_fn(rgb, spec):\r\n            with tf.GradientTape() as tape:\r\n                fake_spec = model(rgb, training=True)\r\n                loss = compute_loss(spec, fake_spec)\r\n\r\n            gradients = tape.gradient(loss, model.trainable_variables)\r\n            opt.apply_gradients(zip(gradients, model.trainable_variables))\r\n            # update metrics\r\n            rmse1.update_state(spec, fake_spec)\r\n            rmse2.update_state(spec, fake_spec)\r\n            rrmse1.update_state(spec, fake_spec)\r\n            rrmse2.update_state(spec, fake_spec)\r\n            sam.update_state(spec, fake_spec)\r\n            return loss\r\n\r\ndef test_step_fn(rgb, sepc):\r\n            fake_spec = model(rgb, training=False)\r\n            loss = loss_object(spec, fake_spec)\r\n            # update metrics\r\n            rmse1.update_state(spec, fake_spec)\r\n            rmse2.update_state(spec, fake_spec)\r\n            rrmse1.update_state(spec, fake_spec)\r\n            rrmse2.update_state(spec, fake_spec)\r\n            sam.update_state(spec, fake_spec)\r\n            return loss\r\n\r\n@tf.function\r\ndef distributed_train_step(rgb, spec):\r\n            per_replica_losses = strategy.experimental_run_v2(train_step_fn,\r\n                                                              args=(rgb, spec))\r\n            return strategy.reduce(tf.distribute.ReduceOp.SUM,\r\n                                   per_replica_losses,\r\n                                   axis=None)\r\n\r\n@tf.function\r\ndef distributed_test_step(rgb, spec):\r\n            return strategy.experimental_run_v2(test_step_fn, args=(rgb, spec))\r\n\r\nfor epoch in range(parser.epochs):\r\n            # train\r\n            for step, (rgb, spec) in enumerate(datas[0]):\r\n                train_mean_loss = distributed_train_step(rgb, spec)\r\n                steps += 1\r\n                ckpt.steps.assign(steps)\r\n                if step == 50:\r\n                    break\r\n            # val\r\n             rmse1.reset_state()\r\n             rmse2.reset_state()\r\n             rrmse1.reset_state()\r\n             rrmse2.reset_state()\r\n             sam.reset_state()\r\n            for step, (rgb, spec) in enumerate(datas[1]):\r\n\r\n                test_mean_loss = distributed_test_step(rgb, spec)\r\n```\r\n**Other info / logs**\r\n```\r\nValueError: in converted code:\r\n    mytrainT.py:163 distributed_test_step  *\r\n        return strategy.experimental_run_v2(test_step_fn, args=(rgb, spec))\r\n    C:\\Users\\zhangstation\\Anaconda3\\envs\\tf\\lib\\site-packages\\tensorflow_core\\python\\distribute\\distribute_lib.py:760 experimental_run_v2\r\n        return self._extended.call_for_each_replica(fn, args=args, kwargs=kwargs)\r\n    mytrainT.py:144 test_step_fn  *\r\n        loss = loss_object(spec, fake_spec)\r\n    C:\\Users\\zhangstation\\Anaconda3\\envs\\tf\\lib\\site-packages\\tensorflow_core\\python\\keras\\losses.py:125 __call__\r\n        with K.name_scope(scope_name or self.__class__.__name__), graph_ctx:\r\n    C:\\Users\\zhangstation\\Anaconda3\\envs\\tf\\lib\\contextlib.py:112 __enter__\r\n        return next(self.gen)\r\n    C:\\Users\\zhangstation\\Anaconda3\\envs\\tf\\lib\\site-packages\\tensorflow_core\\python\\keras\\utils\\tf_utils.py:435 graph_context_for_symbolic_tensors\r\n        if any(is_symbolic_tensor(v) for v in list(args) + list(kwargs.values())):\r\n    C:\\Users\\zhangstation\\Anaconda3\\envs\\tf\\lib\\site-packages\\tensorflow_core\\python\\keras\\utils\\tf_utils.py:435 <genexpr>\r\n        if any(is_symbolic_tensor(v) for v in list(args) + list(kwargs.values())):\r\n    C:\\Users\\zhangstation\\Anaconda3\\envs\\tf\\lib\\site-packages\\tensorflow_core\\python\\keras\\utils\\tf_utils.py:345 is_symbolic_tensor\r\n        return tensor._is_graph_tensor  # pylint: disable=protected-access\r\n    C:\\Users\\zhangstation\\Anaconda3\\envs\\tf\\lib\\site-packages\\tensorflow_core\\python\\framework\\composite_tensor.py:119 _is_graph_tensor\r\n        components = self._type_spec._to_components(self)  # pylint: disable=protected-access\r\n    C:\\Users\\zhangstation\\Anaconda3\\envs\\tf\\lib\\site-packages\\tensorflow_core\\python\\distribute\\values.py:500 _to_components\r\n        \"Flattening a PerReplica to components is not supported in replica \"\r\n\r\n    ValueError: Flattening a PerReplica to components is not supported in replica context.\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35383", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35383/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35383/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35383/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35383", "id": 542086476, "node_id": "MDU6SXNzdWU1NDIwODY0NzY=", "number": 35383, "title": "Enable SO_REUSEPORT option in tensorflow training server", "user": {"login": "jdlesage", "id": 658597, "node_id": "MDQ6VXNlcjY1ODU5Nw==", "avatar_url": "https://avatars1.githubusercontent.com/u/658597?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdlesage", "html_url": "https://github.com/jdlesage", "followers_url": "https://api.github.com/users/jdlesage/followers", "following_url": "https://api.github.com/users/jdlesage/following{/other_user}", "gists_url": "https://api.github.com/users/jdlesage/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdlesage/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdlesage/subscriptions", "organizations_url": "https://api.github.com/users/jdlesage/orgs", "repos_url": "https://api.github.com/users/jdlesage/repos", "events_url": "https://api.github.com/users/jdlesage/events{/privacy}", "received_events_url": "https://api.github.com/users/jdlesage/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-12-24T10:45:53Z", "updated_at": "2020-01-07T23:52:00Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- TensorFlow version (you are using): 1.15 and >=2.0\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n**Describe the feature and the current behavior/state.**\r\nAdd SO_REUSEPORT option when starting tensorflow training server. It will enable to scan ports to build TF_CONFIG env variable. It is necessary to use distributed tensorflow with resource managers that do not reserve ports (such as Yarn).\r\n\r\nIt already has been discussed in ticket https://github.com/tensorflow/tensorflow/issues/21492. It is unclear why the option has been disabled in https://github.com/tensorflow/tensorflow/commit/8cf38e81e638db173238a8f95d6ea613c24d3d9f\r\n\r\n**Will this change the current api? How?**\r\nNo\r\n\r\n**Who will benefit with this feature?**\r\n\r\nProjects like https://github.com/criteo/tf-yarn (tensorflow on yarn) will use it to implement the recommended way to create the cluster configuration. (from https://www.tensorflow.org/guide/distributed_training): The procedure will be: \r\n* Launch on all executors a process that will scan ports and reserve a free one\r\n* A master gathers ports numbers. \r\n* Master creates configuration and broadcasts TF_CONFIG variable to all executors\r\n* Launch tensorflow servers\r\n\r\n**Any Other info.**\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35380", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35380/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35380/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35380/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35380", "id": 542020523, "node_id": "MDU6SXNzdWU1NDIwMjA1MjM=", "number": 35380, "title": "tensorflow lite performance slower than regular tensorflow model", "user": {"login": "Red025", "id": 43609655, "node_id": "MDQ6VXNlcjQzNjA5NjU1", "avatar_url": "https://avatars3.githubusercontent.com/u/43609655?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Red025", "html_url": "https://github.com/Red025", "followers_url": "https://api.github.com/users/Red025/followers", "following_url": "https://api.github.com/users/Red025/following{/other_user}", "gists_url": "https://api.github.com/users/Red025/gists{/gist_id}", "starred_url": "https://api.github.com/users/Red025/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Red025/subscriptions", "organizations_url": "https://api.github.com/users/Red025/orgs", "repos_url": "https://api.github.com/users/Red025/repos", "events_url": "https://api.github.com/users/Red025/events{/privacy}", "received_events_url": "https://api.github.com/users/Red025/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1162044565, "node_id": "MDU6TGFiZWwxMTYyMDQ0NTY1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.12", "name": "TF 1.12", "color": "c2e0c6", "default": false, "description": "Issues related to TF 1.12"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "talumbau", "id": 1891418, "node_id": "MDQ6VXNlcjE4OTE0MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/1891418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/talumbau", "html_url": "https://github.com/talumbau", "followers_url": "https://api.github.com/users/talumbau/followers", "following_url": "https://api.github.com/users/talumbau/following{/other_user}", "gists_url": "https://api.github.com/users/talumbau/gists{/gist_id}", "starred_url": "https://api.github.com/users/talumbau/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/talumbau/subscriptions", "organizations_url": "https://api.github.com/users/talumbau/orgs", "repos_url": "https://api.github.com/users/talumbau/repos", "events_url": "https://api.github.com/users/talumbau/events{/privacy}", "received_events_url": "https://api.github.com/users/talumbau/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "talumbau", "id": 1891418, "node_id": "MDQ6VXNlcjE4OTE0MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/1891418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/talumbau", "html_url": "https://github.com/talumbau", "followers_url": "https://api.github.com/users/talumbau/followers", "following_url": "https://api.github.com/users/talumbau/following{/other_user}", "gists_url": "https://api.github.com/users/talumbau/gists{/gist_id}", "starred_url": "https://api.github.com/users/talumbau/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/talumbau/subscriptions", "organizations_url": "https://api.github.com/users/talumbau/orgs", "repos_url": "https://api.github.com/users/talumbau/repos", "events_url": "https://api.github.com/users/talumbau/events{/privacy}", "received_events_url": "https://api.github.com/users/talumbau/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2019-12-24T07:07:39Z", "updated_at": "2020-03-02T15:25:24Z", "closed_at": null, "author_association": "NONE", "body": "i converted object detection model into tensorflow lite and i am trying to run it in raspberry pi but the performance of tensorflow lite is slower in desktop. How can i increase the performance speed of the tensorflow lite? "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35378", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35378/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35378/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35378/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35378", "id": 542007109, "node_id": "MDU6SXNzdWU1NDIwMDcxMDk=", "number": 35378, "title": "TensorflowLite gives wrong results when use GPU delegate", "user": {"login": "wangyiwei0306", "id": 19260578, "node_id": "MDQ6VXNlcjE5MjYwNTc4", "avatar_url": "https://avatars3.githubusercontent.com/u/19260578?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wangyiwei0306", "html_url": "https://github.com/wangyiwei0306", "followers_url": "https://api.github.com/users/wangyiwei0306/followers", "following_url": "https://api.github.com/users/wangyiwei0306/following{/other_user}", "gists_url": "https://api.github.com/users/wangyiwei0306/gists{/gist_id}", "starred_url": "https://api.github.com/users/wangyiwei0306/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wangyiwei0306/subscriptions", "organizations_url": "https://api.github.com/users/wangyiwei0306/orgs", "repos_url": "https://api.github.com/users/wangyiwei0306/repos", "events_url": "https://api.github.com/users/wangyiwei0306/events{/privacy}", "received_events_url": "https://api.github.com/users/wangyiwei0306/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-12-24T06:15:47Z", "updated_at": "2020-01-22T03:12:14Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):Yes\r\n- OS Platform and Distribution (Android7.1 Snapdragon 625):\r\n- Mobile device (HUAWEI Nova CAZ-AL 10) if the issue happens on mobile device:\r\n- TensorFlow installed from (source):\r\n- TensorFlow version (org.tensorflow:tensorflow-lite-gpu:0.0.0-nightly):\r\n\r\n\r\n**Describe the current behavior**\r\nI use **yolov3** model on android platform to do object detection. When I did object detection on CPU the results are right but when I add GPU module the results are totally different.\r\n\r\n**Code to reproduce the issue**\r\n\r\n\r\n/**\r\n * Wrapper for frozen detection models trained using the Tensorflow Object Detection API:\r\n * github.com/tensorflow/models/tree/master/research/object_detection\r\n */\r\npublic class TFLitePanoObjectDetectionAPIModel implements Classifier {\r\n  private static final Logger LOGGER = new Logger();\r\n\r\n  private static final int NUM_of_classes = 19;\r\n  private static final int NUM_THREADS = 4;\r\n  private boolean isModelQuantized;\r\n  private int inputSize;\r\n  private Vector<String> labels = new Vector<String>();\r\n  private int[] intValues;\r\n  private float[][][][] output_1;\r\n  private float[][][][] output_2;\r\n  private float[][][][] output_3;\r\n  private ByteBuffer imgData;\r\n  private Interpreter tflite;\r\n  private MappedByteBuffer tfliteModel;\r\n  private final Interpreter.Options tfliteOptions = new Interpreter.Options();\r\n  private GpuDelegate gpuDelegate = null;\r\n  private NnApiDelegate nnapiDelegate = null;\r\n  private int gridNum;\r\n\r\n  private int BoxNum_each_gird=3;\r\n  private float[][][][] floatValues;\r\n\r\n\r\n  private TFLitePanoObjectDetectionAPIModel() {}\r\n  private float scoreThreshold = 0.3f;\r\n  private int blockSize=32;\r\n\r\n  public static Classifier create(\r\n      final AssetManager assetManager,\r\n      final String modelFilename,\r\n      final String labelFilename,\r\n      final int inputSize,\r\n      final boolean isQuantized)\r\n      throws IOException {\r\n    final TFLitePanoObjectDetectionAPIModel d = new TFLitePanoObjectDetectionAPIModel();\r\n    try {\r\n\r\n      d.tfliteModel=loadModelFile(assetManager, modelFilename);\r\n      if (d.gpuDelegate == null)\r\n      {\r\n        d.gpuDelegate = new GpuDelegate();\r\n        d.tfliteOptions.addDelegate(d.gpuDelegate);\r\n      }\r\n      d.tflite = new Interpreter(d.tfliteModel,d.tfliteOptions);\r\n    } catch (Exception e) {\r\n      throw new RuntimeException(e);\r\n    }\r\n\r\n    d.isModelQuantized = isQuantized;\r\n    // Pre-allocate buffers.\r\n    int numBytesPerChannel;\r\n    if (isQuantized) {\r\n      numBytesPerChannel = 1; // Quantized\r\n    } else {\r\n      numBytesPerChannel = 4; // Floating point\r\n    }\r\n    d.imgData = ByteBuffer.allocateDirect(1 * d.inputSize * 2*d.inputSize * 3 * numBytesPerChannel);//\r\n    d.imgData.order(ByteOrder.nativeOrder());\r\n    d.intValues = new int[d.inputSize * 2*d.inputSize];\r\n\r\n    d.gridNum=d.inputSize/32;\r\n    d.floatValues=new float[1][d.inputSize][2 * d.inputSize ][3];\r\n    d.output_1 = new float[1][][][];\r\n    d.output_2 = new float[1][][][];\r\n    d.output_3 = new float[1][][][];\r\n\r\n\r\n    return d;\r\n  }\r\n  }\r\n\r\n  @Override\r\n  public List<Recognition> recognizeImage(final Bitmap bitmap) {\r\n\r\n    bitmap.getPixels(intValues, 0, bitmap.getWidth(), 0, 0, bitmap.getWidth(), bitmap.getHeight());\r\n    imgData.rewind();\r\n\r\n    for (int i = 0; i < inputSize; ++i)\r\n    {\r\n      for (int j = 0; j < 2*inputSize; ++j)\r\n      {\r\n        int pixelValue = intValues[i * 2*inputSize + j];\r\n          // Float model\r\n          floatValues[0][i][j][0]=((pixelValue >> 16) & 0xFF)/255.0f ;\r\n          floatValues[0][i][j][1]=((pixelValue >> 8) & 0xFF)/255.0f ;\r\n          floatValues[0][i][j][2]=(pixelValue& 0xFF) /255.0f;\r\n      }\r\n    }\r\n\r\n     int channelNum=BoxNum_each_gird*(NUM_of_classes+5);\r\n\r\n    output_1 = new float[1][gridNum][2*gridNum][channelNum];\r\n    output_2 = new float[1][2*gridNum][4*gridNum][channelNum];\r\n    output_3 = new float[1][4*gridNum][8*gridNum][channelNum];\r\n\r\n    Object[] inputArray = {floatValues};\r\n    Map<Integer, Object> outputMap = new HashMap<>();\r\n    outputMap.put(0, output_1);\r\n    outputMap.put(1, output_2);\r\n    outputMap.put(2, output_3);\r\n    Trace.endSection();\r\n\r\n    // Run the inference call.\r\n    Trace.beginSection(\"run\");\r\n    long startTime = SystemClock.uptimeMillis();\r\n    tflite.runForMultipleInputsOutputs(inputArray, outputMap);\r\n    long lastingTime=SystemClock.uptimeMillis()-startTime;\r\n\r\n    LOGGER.i(\"runForMultipleInputsOutputs time of each image: \" + lastingTime + \"ms\");\r\n    Trace.endSection(); \r\n    }\r\n\r\n}`\r\n**Describe the expected behavior**\r\n\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35369", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35369/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35369/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35369/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35369", "id": 541940764, "node_id": "MDU6SXNzdWU1NDE5NDA3NjQ=", "number": 35369, "title": "Tensorflow Python modules import the same module under multiple different names", "user": {"login": "chrisjbillington", "id": 1044087, "node_id": "MDQ6VXNlcjEwNDQwODc=", "avatar_url": "https://avatars0.githubusercontent.com/u/1044087?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chrisjbillington", "html_url": "https://github.com/chrisjbillington", "followers_url": "https://api.github.com/users/chrisjbillington/followers", "following_url": "https://api.github.com/users/chrisjbillington/following{/other_user}", "gists_url": "https://api.github.com/users/chrisjbillington/gists{/gist_id}", "starred_url": "https://api.github.com/users/chrisjbillington/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chrisjbillington/subscriptions", "organizations_url": "https://api.github.com/users/chrisjbillington/orgs", "repos_url": "https://api.github.com/users/chrisjbillington/repos", "events_url": "https://api.github.com/users/chrisjbillington/events{/privacy}", "received_events_url": "https://api.github.com/users/chrisjbillington/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-12-24T00:12:06Z", "updated_at": "2019-12-26T19:09:00Z", "closed_at": null, "author_association": "NONE", "body": "I am using tensorflow 2.1.0rc1-2 on Arch Linux.\r\n\r\nA Python project I work with contains some machinery to detect if the same .py file is imported under multiple different names, resulting in different module objects. This [can lead to subtle breakage](http://python-notes.curiousefficiency.org/en/latest/python_concepts/import_traps.html#the-double-import-trap) as classes defined in the two copies of the module are officially different classes, so instances of one of them return False when using `isinstance()` with the class from the other copy of the module. Basically, it's a bad idea, so the project I work with raises a big error to tell us when we've accidentally done it.\r\n\r\nTensorflow has a large number of modules imported twice under different names, which causes my project to raise an error about it. Of course I can just whitelist tensorflow in my project, but I think this is a bad idea for tensorflow to do. If it is going to have the same module under multiple names, the import machinery hacks in tensorflow should ensure the multiple names at least point to the same module object, rather than there being multiple module objects in the interpreter object corresponding to the same .py file.\r\n\r\nThe issue can be demonstrated with the following:\r\n\r\n```python\r\nimport sys\r\nimport tensorflow\r\n\r\nfor name1, module1 in sys.modules.copy().items():\r\n    for name2, module2 in sys.modules.copy().items():\r\n        file1 = getattr(module1, '__file__', None)\r\n        file2 = getattr(module2, '__file__', None)\r\n        if file1 is not None and file2 is not None:\r\n            if file1 == file2 and name1 != name2 and module1 is not module2:\r\n                print(name1, name2)\r\n```\r\nThis prints\r\n```\r\ntensorflow._api tensorflow_core._api\r\ntensorflow.python tensorflow_core.python\r\ntensorflow.tools tensorflow_core.tools\r\ntensorflow.core tensorflow_core.core\r\ntensorflow.compiler tensorflow_core.compiler\r\ntensorflow.lite tensorflow_core.lite\r\ntensorflow.keras tensorflow.python.keras.api._v2.keras\r\ntensorflow.keras tensorflow_core.python.keras.api._v2.keras\r\ntensorflow.keras tensorflow_core.keras\r\ntensorflow.compat tensorflow._api.v2.compat\r\ntensorflow.compat tensorflow_core._api.v2.compat\r\n\r\n<snip>\r\n```\r\n\r\nBasically there are copies of many modules imported both as `tensorflow.<blah>` and `tensorflow_core.<blah>`.\r\n\r\nTensorflow should consider changing its import machinery to avoid this, for the reasons outlined in the above linked post on the double import gotcha in Python."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35359", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35359/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35359/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35359/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/35359", "id": 541812282, "node_id": "MDExOlB1bGxSZXF1ZXN0MzU2Mzc2NjUy", "number": 35359, "title": "Add Edge Board Support in Arduino Library Build for TFLu (micro)", "user": {"login": "oclyke", "id": 13486034, "node_id": "MDQ6VXNlcjEzNDg2MDM0", "avatar_url": "https://avatars1.githubusercontent.com/u/13486034?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oclyke", "html_url": "https://github.com/oclyke", "followers_url": "https://api.github.com/users/oclyke/followers", "following_url": "https://api.github.com/users/oclyke/following{/other_user}", "gists_url": "https://api.github.com/users/oclyke/gists{/gist_id}", "starred_url": "https://api.github.com/users/oclyke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oclyke/subscriptions", "organizations_url": "https://api.github.com/users/oclyke/orgs", "repos_url": "https://api.github.com/users/oclyke/repos", "events_url": "https://api.github.com/users/oclyke/events{/privacy}", "received_events_url": "https://api.github.com/users/oclyke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 987666414, "node_id": "MDU6TGFiZWw5ODc2NjY0MTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/ready%20to%20pull", "name": "ready to pull", "color": "2cd643", "default": false, "description": ""}, {"id": 1173072136, "node_id": "MDU6TGFiZWwxMTczMDcyMTM2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:XL", "name": "size:XL", "color": "adafea", "default": false, "description": "CL Change Size:Extra Large"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2019-12-23T16:02:18Z", "updated_at": "2020-03-11T05:36:41Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/35359", "html_url": "https://github.com/tensorflow/tensorflow/pull/35359", "diff_url": "https://github.com/tensorflow/tensorflow/pull/35359.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/35359.patch"}, "body": "Add support for the SparkFun Edge board in the Arduino library build. Allows individuals who are less comfortable with command line tools to get started with TFLu examples. \r\n\r\n**dependencies**\r\n[Update TFLu (micro) to use AmbiqSuite SDK Release 2.2.0 for Apollo3](https://github.com/tensorflow/tensorflow/pull/35236)\r\n[Upgrade Edge Board Support Package in TFLu (micro)](https://github.com/tensorflow/tensorflow/pull/35290)"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35354", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35354/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35354/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35354/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35354", "id": 541675264, "node_id": "MDU6SXNzdWU1NDE2NzUyNjQ=", "number": 35354, "title": "Contributing a multistep optimizer for training big NNs/batches", "user": {"login": "hoangcuong2011", "id": 8759715, "node_id": "MDQ6VXNlcjg3NTk3MTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/8759715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hoangcuong2011", "html_url": "https://github.com/hoangcuong2011", "followers_url": "https://api.github.com/users/hoangcuong2011/followers", "following_url": "https://api.github.com/users/hoangcuong2011/following{/other_user}", "gists_url": "https://api.github.com/users/hoangcuong2011/gists{/gist_id}", "starred_url": "https://api.github.com/users/hoangcuong2011/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hoangcuong2011/subscriptions", "organizations_url": "https://api.github.com/users/hoangcuong2011/orgs", "repos_url": "https://api.github.com/users/hoangcuong2011/repos", "events_url": "https://api.github.com/users/hoangcuong2011/events{/privacy}", "received_events_url": "https://api.github.com/users/hoangcuong2011/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-12-23T09:53:42Z", "updated_at": "2019-12-27T00:06:11Z", "closed_at": null, "author_association": "NONE", "body": "I noticed a high demand in training big NNs/batches is to create a multistep optimizer. This means the optimizer accumulates gradients from batches until it reaches a desire batch and update model parameters. \r\n\r\nThis is similar to [this](https://github.com/tensorflow/tensor2tensor/blob/master/tensor2tensor/utils/multistep_optimizer.py), but for file [keras.optimizer_v2](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/keras/optimizer_v2/optimizer_v2.py) instead.\r\n\r\nI can contribute to this. However, I noticed by doing this, the code optimizer_v2.py will need to change a lot. I can create a new similar python file (say, multistep_optimizer_v2.py) to avoid changing in optimizer_v2.py, but the optimizer_v2.py code it self is indeed very long.\r\n\r\nI thus create a discussion here to see whether you (Tensorflow Team and community) feel it is worthy to do so, as well as how to do that, or any better solution for doing that, if there is.\r\n\r\nBest,"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35353", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35353/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35353/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35353/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35353", "id": 541644916, "node_id": "MDU6SXNzdWU1NDE2NDQ5MTY=", "number": 35353, "title": "You tried to call `count_params` on z_input, but the layer isn't built. You can build it manually via: `z_input.build(batch_input_shape", "user": {"login": "JonLeeCSDN", "id": 40761785, "node_id": "MDQ6VXNlcjQwNzYxNzg1", "avatar_url": "https://avatars1.githubusercontent.com/u/40761785?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JonLeeCSDN", "html_url": "https://github.com/JonLeeCSDN", "followers_url": "https://api.github.com/users/JonLeeCSDN/followers", "following_url": "https://api.github.com/users/JonLeeCSDN/following{/other_user}", "gists_url": "https://api.github.com/users/JonLeeCSDN/gists{/gist_id}", "starred_url": "https://api.github.com/users/JonLeeCSDN/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JonLeeCSDN/subscriptions", "organizations_url": "https://api.github.com/users/JonLeeCSDN/orgs", "repos_url": "https://api.github.com/users/JonLeeCSDN/repos", "events_url": "https://api.github.com/users/JonLeeCSDN/events{/privacy}", "received_events_url": "https://api.github.com/users/JonLeeCSDN/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-12-23T08:37:17Z", "updated_at": "2020-01-09T21:28:57Z", "closed_at": null, "author_association": "NONE", "body": "when saved the model as tf by api  **tf.keras.models.save_model(testmodel, \"./1/\",save_format='tf')**\r\nthen,I load it by tf.keras.models.load_model('1'),however\uff0cI got the issue as title.\r\nIt is worth mentioning that it succed if I saved as .h5\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):centos7.4\r\n- TensorFlow version (use command below):tensorflow 2.0\r\n- Python version:3.7\r\n-NVIDIA-SMI 418.88\r\n-Driver Version: 418.88\r\n-CUDA Version: 10.1 \r\n- GPU model and memory:12\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35346", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35346/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35346/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35346/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35346", "id": 541503834, "node_id": "MDU6SXNzdWU1NDE1MDM4MzQ=", "number": 35346, "title": "AutoGraph is compiled 5x slower in TF2.x Multi-GPU Distributed Mirrored Strategy", "user": {"login": "olegmyrk", "id": 884233, "node_id": "MDQ6VXNlcjg4NDIzMw==", "avatar_url": "https://avatars2.githubusercontent.com/u/884233?v=4", "gravatar_id": "", "url": "https://api.github.com/users/olegmyrk", "html_url": "https://github.com/olegmyrk", "followers_url": "https://api.github.com/users/olegmyrk/followers", "following_url": "https://api.github.com/users/olegmyrk/following{/other_user}", "gists_url": "https://api.github.com/users/olegmyrk/gists{/gist_id}", "starred_url": "https://api.github.com/users/olegmyrk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/olegmyrk/subscriptions", "organizations_url": "https://api.github.com/users/olegmyrk/orgs", "repos_url": "https://api.github.com/users/olegmyrk/repos", "events_url": "https://api.github.com/users/olegmyrk/events{/privacy}", "received_events_url": "https://api.github.com/users/olegmyrk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-12-22T21:34:55Z", "updated_at": "2020-02-01T04:02:55Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n* Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n* OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04.3 LTS\r\n* TensorFlow installed from (source or binary): binary\r\n* TensorFlow version (use command below): v2.1.0-rc0-47-g064e153 2.1.0-rc1 (`python3 -c \"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`)\r\n* Python version: Python 3.6.8\r\n* CUDA/cuDNN version: Driver Version: 440.33.01, CUDA Version: 10.2, cuDNN 7.6.2\r\n* GPU model and memory: Tesla V100-SXM2-16GB\r\n\r\n**Describe the current behavior**\r\nCompiling autograph function is 4-5x slower in Distributed Mirrored Strategy:\r\n* Single-GPU Distributed Mirrored Strategy: under 5 minutes\r\n* Multi-GPU Distributed Mirrored Strategy: about 30 minutes\r\nThe tensorflow code is identical in both setups.\r\n\r\n**Describe the expected behavior**\r\nAutograph compilation should take roughly the same time in single and multi-GPU Distributed Mode with Mirrored Strategy.\r\n\r\n**Code to reproduce the issue**\r\nTraining loop (hierarchical VAE in the current configuration):\r\nhttps://github.com/olegmyrk/SPADE-Tensorflow/blob/4681ac60f2078144d55178f23fa885d3ed191450/SPADE.py#L1151\r\n\r\nThe code is adapted from TF1.x repository:\r\nhttps://github.com/olegmyrk/SPADE-Tensorflow/blob/8866a0b1457cbd4be5d6f549f9bf4075d49b2486/SPADE.py#L1045\r\nand is compiled using TF2.x @tf.function annotation.\r\n\r\nIt uses a dry-run of the model to pre-create variables using tf.compat.v1.variable_scope(scope, reuse=tf.compat.v1.AUTO_REUSE):\r\nhttps://github.com/olegmyrk/SPADE-Tensorflow/blob/4681ac60f2078144d55178f23fa885d3ed191450/SPADE.py#L1174\r\n(it takes about 10 minutes to compile and run it in multi-gpu mode)\r\n\r\nThen it runs the actual training step(s)\r\nhttps://github.com/olegmyrk/SPADE-Tensorflow/blob/4681ac60f2078144d55178f23fa885d3ed191450/SPADE.py#L1257\r\n(it takes about 20 minutes to compile and run it for the first time in multi-gpu mode)\r\n\r\nIt looks that just disabling lines with 'optim.apply_gradients'\r\nhttps://github.com/olegmyrk/SPADE-Tensorflow/blob/4681ac60f2078144d55178f23fa885d3ed191450/SPADE.py#L1229\r\nhttps://github.com/olegmyrk/SPADE-Tensorflow/blob/4681ac60f2078144d55178f23fa885d3ed191450/SPADE.py#L1231\r\nhttps://github.com/olegmyrk/SPADE-Tensorflow/blob/4681ac60f2078144d55178f23fa885d3ed191450/SPADE.py#L1233\r\nslashes about 10 out 20 minutes needed for initial run in multi-gpu mode. Which is essentially compiling back-propagation?\r\n\r\nAfter the first training step that takes 20 minutes the following training steps run at normal speed.\r\n\r\nThe total number of mirrored parameters is around 500MB.\r\n\r\nWith 4 V100 GPUs training step is around 5x slower than with single V100 GPU.\r\n\r\nCommand:\r\nNCCL_DEBUG=INFO NCCL_DEBUG_SUBSYS=ALL nohup python3 main.py --dataset CelebAMask-HQ --img_height 256 --img_width 256 --ch 16 --img_ch 3 --phase train --save_freq 10000 --batch_size 12 --gan_type hinge --code_gan_type gan --n_critic 1 --code_num_layers=4 --code_dist_num_layers=0 --augment_flag false --sn=False --train_main=true --train_nondet=true --lr 0.0002 --epoch=50 --decay_epoch=25 --print_freq 100 &> train.CelebAMask-HQ.log&\r\n\r\n**Other info / logs**\r\n[train.CelebAMask-HQ.slow_compile.log](https://github.com/tensorflow/tensorflow/files/3993026/train.CelebAMask-HQ.slow_compile.log)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35342", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35342/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35342/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35342/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35342", "id": 541475007, "node_id": "MDU6SXNzdWU1NDE0NzUwMDc=", "number": 35342, "title": "Support other types of Tensors in tf.data.Dataset.from_generator", "user": {"login": "konopik", "id": 11410722, "node_id": "MDQ6VXNlcjExNDEwNzIy", "avatar_url": "https://avatars3.githubusercontent.com/u/11410722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/konopik", "html_url": "https://github.com/konopik", "followers_url": "https://api.github.com/users/konopik/followers", "following_url": "https://api.github.com/users/konopik/following{/other_user}", "gists_url": "https://api.github.com/users/konopik/gists{/gist_id}", "starred_url": "https://api.github.com/users/konopik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/konopik/subscriptions", "organizations_url": "https://api.github.com/users/konopik/orgs", "repos_url": "https://api.github.com/users/konopik/repos", "events_url": "https://api.github.com/users/konopik/events{/privacy}", "received_events_url": "https://api.github.com/users/konopik/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-12-22T16:45:46Z", "updated_at": "2020-02-13T22:58:16Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: YES\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: macOS 10.15.2 (19C57)\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**:v2.0.0-rc2-26-g64c3d382ca 2.0.0\r\n- **Python version**:3.7.5 (default, Oct 25 2019, 18:18:54) \\n[Clang 11.0.0 (clang-1100.0.33.8)]\r\n\r\n### Describe the problem\r\n\r\n`tf.data.Dataset` supports RaggedTensor and SparseTensor but `tf.data.Dataset.from_generator` is limited to Tensors only. Please support other types of Tensors. \r\n\r\n### Source code / logs\r\n\r\n```\r\n    def data_get():\r\n        for i in range(5):\r\n            yield tf.ragged.constant([[i, i], [i]])\r\n\r\n    ds = tf.data.Dataset.from_generator(data_get, tf.int32)\r\n\r\n    for sample in ds:\r\n        print(sample)\r\n```\r\n\r\nproduces:\r\n\r\nTraceback (most recent call last):\r\n\r\n```\r\n  File \"/Users/peak/IdeaProjects/TFmodels/venv-tf2/lib/python3.7/site-packages/tensorflow_core/python/ops/script_ops.py\", line 221, in __call__\r\n    ret = func(*args)\r\n\r\n  File \"/Users/peak/IdeaProjects/TFmodels/venv-tf2/lib/python3.7/site-packages/tensorflow_core/python/data/ops/dataset_ops.py\", line 606, in generator_py_func\r\n    \"element was %s.\" % (dtype.name, ret))\r\n\r\nTypeError: `generator` yielded an element that could not be converted to the expected type. The expected type was int32, but the yielded element was <tf.RaggedTensor [[0, 0], [0]]>.\r\n```\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35339", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35339/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35339/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35339/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35339", "id": 541429555, "node_id": "MDU6SXNzdWU1NDE0Mjk1NTU=", "number": 35339, "title": "Tensorflow-lite gpu output is corrupted when using opencl backend", "user": {"login": "anilsathyan7", "id": 1130185, "node_id": "MDQ6VXNlcjExMzAxODU=", "avatar_url": "https://avatars1.githubusercontent.com/u/1130185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anilsathyan7", "html_url": "https://github.com/anilsathyan7", "followers_url": "https://api.github.com/users/anilsathyan7/followers", "following_url": "https://api.github.com/users/anilsathyan7/following{/other_user}", "gists_url": "https://api.github.com/users/anilsathyan7/gists{/gist_id}", "starred_url": "https://api.github.com/users/anilsathyan7/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anilsathyan7/subscriptions", "organizations_url": "https://api.github.com/users/anilsathyan7/orgs", "repos_url": "https://api.github.com/users/anilsathyan7/repos", "events_url": "https://api.github.com/users/anilsathyan7/events{/privacy}", "received_events_url": "https://api.github.com/users/anilsathyan7/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-12-22T09:44:57Z", "updated_at": "2020-01-03T08:55:35Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Android version:9, Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: OnePlus3, GPU:Adreno 530\r\n- TensorFlow installed from (source or binary): tensorflow-lite-gpu 1.15, tensorflow-lite-gpu:0.0.0-nightly from 'https://mvnrepository.com'\r\n- TensorFlow version (use command below): 1.14, 1.15\r\n\r\n\r\n**Describe the current behavior**\r\nI'm using tflite-gpu in my android application for semantic segmentation. Using my tflite model(all gpu supported ops) i'am able to get proper output with CPU version and tensorflow-lite-gpu 1.14 ;but when i use nightly or 1.15 it loads up opencl backend and gives corrupted output. This backend seems to take longer time to start up(5-10s); however it seems to be faster than corresponding opengl version. When i run the model to get a image output (float:0-1) there seems to be random rectangular blanks within the output. The input is 256x256x3(float) and output os 256x256x1(float). However.  i 'am not facing this issue using a different model with input size 128; even though i use the same back-end.\r\n**Describe the expected behavior**\r\nThe tflite model should produce correct output with opencl backend like the  opengl version, regardless of input size.\r\n\r\n**Other info / logs**\r\nI'am getting correct output for model with 128 input size regardless of backends and devices; but for the model with 256 output size i'am not getting proper output with opencl backend (gpu-nightly and gpu-1.15)\r\n[Models.zip](https://github.com/tensorflow/tensorflow/files/3992313/Models.zip)\r\n\r\nOnly the '**opencl gpu delegate with this 256 input sized-model**' produces this corrupted output; other versions (CPU, Opengl-GPU, 128 input-model with Opencl etc.) seems to produce correct result without the rectangular blanks.\r\n![tmap54](https://user-images.githubusercontent.com/1130185/71320296-57515680-24cf-11ea-8c26-66f62c948e94.PNG)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35337", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35337/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35337/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35337/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35337", "id": 541424246, "node_id": "MDU6SXNzdWU1NDE0MjQyNDY=", "number": 35337, "title": "ValueError: name for name_scope must be a string when Building up a Custom Model", "user": {"login": "yourtheron", "id": 51472988, "node_id": "MDQ6VXNlcjUxNDcyOTg4", "avatar_url": "https://avatars1.githubusercontent.com/u/51472988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yourtheron", "html_url": "https://github.com/yourtheron", "followers_url": "https://api.github.com/users/yourtheron/followers", "following_url": "https://api.github.com/users/yourtheron/following{/other_user}", "gists_url": "https://api.github.com/users/yourtheron/gists{/gist_id}", "starred_url": "https://api.github.com/users/yourtheron/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yourtheron/subscriptions", "organizations_url": "https://api.github.com/users/yourtheron/orgs", "repos_url": "https://api.github.com/users/yourtheron/repos", "events_url": "https://api.github.com/users/yourtheron/events{/privacy}", "received_events_url": "https://api.github.com/users/yourtheron/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-12-22T08:44:47Z", "updated_at": "2020-01-10T23:14:16Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 7\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): \r\n- TensorFlow version (use command below): 2.0.0\r\n- Python version: 3.7\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: 10.1\r\n- GPU model and memory: \r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\nHi,\r\n\r\nI tried to follow tf's doc to build up a model as follows:\r\nhttps://www.tensorflow.org/guide/keras/custom_layers_and_models\r\n\r\n`\r\n\t\t\t\t\t\r\n\tclass CBR(layers.Layer):\r\n\t\t'''\r\n\t\tConvolution + Batch normalisation + Relu\r\n\t\t'''\r\n\t\tdef __int__(self, filterNum, kSize, strSize, padMode, name='cbr', **kwargs):\r\n\t\t\tsuper(CBR, self).__init__(name=name, **kwargs)\r\n\t\t\tself.conv3D = layers.Conv3D(filters=filterNum, kernel_size=kSize, strides=strSize, padding=padMode, data_format='channels_first')\r\n\t\t\tself.BN = layers.BatchNormalization(axis=1)\r\n\t\tdef call(self, inputs):\r\n\t\t\tx = self.conv3D(inputs)\r\n\t\t\tx=self.BN(x)\r\n\t\t\treturn layers.Relu(x)\r\n\t\t\t\r\n\tclass SimpleUNet(tf.keras.Model, layers.Layer):\r\n\t\t'''\r\n\t\tSerialise basic units so as to build up a double-layered encoder-decoder U-Net\r\n\t\tInput:\r\n\t\t\tinDim: [mbSize, modaility/channel, tensor dimensions]\r\n\t\t\tclassNum: background included\r\n\t\t\tname: name for the net\r\n\t\t\tinputs: 5D tf tensor of [mbSize, modaility/channel, tensor dimensions]. Inputs must be organised into channel first\r\n\t\tReturns:\r\n\t\t\toutputs: 5D tf tensor of [mbSize, classNum, tensor dimensions]\r\n\t\t'''\r\n\t\tdef __init__(self, inDim, classNum, name='SimpleUNet', **kwargs):\r\n\t\t\tsuper(SimpleUNet, self).__init__(name=name, **kwargs)\r\n\t\t\tself.inDim = inDim\r\n\t\t\tself.classNum = classNum\r\n\t\t\tdimEnSt1End = np.array(inDim[1:])-2-2\r\n\t\t\tdimEnSt2Ed = dimEnSt1End/2-2-2\r\n\t\t\tdimBridgeEnd = (dimEnSt2Ed/2-2-2)*2\r\n\t\t\tdimDEStd1End = (dimBridgeEnd-2-2)*2\r\n\t\t\toutDim = dimDEStd1End-2-2-2\r\n\t\t\ttemp = ((dimEnSt2Ed - dimBridgeEnd)/2).astype('int32')\r\n\t\t\tcrop3d1 = tuple(np.tile(temp, (2, 1)).T)\r\n\t\t\ttemp = ((dimEnSt1End - dimDEStd1End)/2).astype('int32')\r\n\t\t\tcrop3d2 = tuple(np.tile(temp, (2, 1)).T)\r\n\t\t\t# list of basic units used in the model\r\n\t\t\tself.en_st1_cbr1 = CBR(32, 3, 1, 'valid')\r\n\t\t\tself.en_st1_cbr2 = CBR(64, 3, 1, 'valid')\r\n\t\t\tself.en_st2_mp = layers.MaxPooling3D(pool_size=(2, 2, 2), strides=(2, 2, 2), padding='valid', data_format='channels_first')\r\n\t\t\tself.en_st2_cbr1 = CBR(64, 3, 1, 'valid')\r\n\t\t\tself.en_st2_cbr2 = CBR(128, 3, 1, 'valid')\r\n\t\t\tself.bridge_mp = layers.MaxPooling3D(pool_size=(2, 2, 2), strides=(2, 2, 2), padding='valid', data_format='channels_first')\r\n\t\t\tself.bridge_cbr1 = CBR(128, 3, 1, 'valid')\r\n\t\t\tself.bridge_cbr2 = CBR(256, 3, 1, 'valid')    \r\n\t\t\tself.bridge_tconv1 = layers.Conv3DTranspose(256, 2, strides=2, padding='valid', data_format='channels_first')\r\n\t\t\tself.de_3dcrop1 = layers.Cropping3D(crop3d1, data_format='channels_first')\r\n\t\t\tself.de_st1_cbr1 = CBR(256, 3, 1, 'valid')\r\n\t\t\tself.de_st1_cbr2 = CBR(128, 3, 1, 'valid')    \r\n\t\t\tself.de_st1_tconv1 = layers.Conv3DTranspose(128, 2, strides=2, padding='valid', data_format='channels_first')\r\n\t\t\tself.de_3dcrop2 = layers.Cropping3D(crop3d2, data_format='channels_first')\r\n\t\t\tself.de_st2_cbr1 = CBR(64, 3, 1, 'valid')\r\n\t\t\tself.de_st2_cbr2 = CBR(64, 3, 1, 'valid') \r\n\t\t\tself.final_conv3D = layers.Conv3D(filters=self.classNum, kernel_size=3, strides=1, padding='valid', data_format='channels_first')\r\n\t\t\t\t\t\r\n\t\tdef call(self, inputs):\r\n\t\t\tx = self.en_st1_cbr1(inputs)\r\n\t\t\txEnSt1End = self.en_st1_cbr2(x)\r\n\t\t\tx= self.en_st2_mp(xEnSt1End)\r\n\t\t\tx= self.en_st2_cbr1(x)\r\n\t\t\txEnSt2Ed = self.en_st2_cbr2(x)\r\n\t\t\tx = self.bridge_mp(xEnSt2Ed)\r\n\t\t\tx = self.bridge_cbr1(x)\r\n\t\t\tx = self.bridge_cbr2(x)\r\n\t\t\txBridgeEnd = self.bridge_tconv1(x)\r\n\t\t\txCrop1 = self.de_3dcrop1(xEnSt2Ed)\r\n\t\t\tx = layers.Concatenate([xBridgeEnd, xCrop1], axis=1)\r\n\t\t\tx = self.de_st1_cbr1(x)\r\n\t\t\tx = self.de_st1_cbr2(x)\r\n\t\t\txDeSt1End = self.de_st1_tconv1(x)\r\n\t\t\txCrop2 = self.de_3dcrop2(xEnSt1End)\r\n\t\t\tx = layers.Concatenate([xDeSt1End, xCrop2], axis=1)\r\n\t\t\tx = self.de_st2_cbr1(x)\r\n\t\t\tx = self.de_st2_cbr2(x)\r\n\t\t\tx = self.final_conv3D(x)\r\n\t\t\toutputs = activations.softmax(x, axis=1)\r\n\t\t\t\r\n\t\t\treturn outputs\r\n\r\n`\r\n\r\nThen I initialised it, and tried to build it by calling SUNet.build\r\n`\r\n\tclassNum = 3 \r\n\tmbSize = 16 \r\n\tinDim = [4, 64, 64, 64] \r\n\tSUNet = SimpleUNet(inDim, classNum) \r\n\tSUNet.build(input_shape=inDim)\r\n`\r\nI strictly followed the example given in tf's doc, but an error was raised when building up it\r\nValueError: name for name_scope must be a string.\r\nIt occurred here when CBR is called for the first time:\r\n\r\n`\r\ndef __int__(self, filterNum, kSize, strSize, padMode, name='cbr', **kwargs): \r\n\tsuper(CBR, self).__init__(name=name, **kwargs)\r\n`\r\n\r\nI cannot figure out any syntactic mistake. Could anyone give me a hand? Thanks a lot.\r\nOr, is the model cannot be built at this moment until it is actually used when being called in the training?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35336", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35336/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35336/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35336/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35336", "id": 541409412, "node_id": "MDU6SXNzdWU1NDE0MDk0MTI=", "number": 35336, "title": "No clear document explains how to use pre-trained model", "user": {"login": "CNOCycle", "id": 24318472, "node_id": "MDQ6VXNlcjI0MzE4NDcy", "avatar_url": "https://avatars3.githubusercontent.com/u/24318472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CNOCycle", "html_url": "https://github.com/CNOCycle", "followers_url": "https://api.github.com/users/CNOCycle/followers", "following_url": "https://api.github.com/users/CNOCycle/following{/other_user}", "gists_url": "https://api.github.com/users/CNOCycle/gists{/gist_id}", "starred_url": "https://api.github.com/users/CNOCycle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CNOCycle/subscriptions", "organizations_url": "https://api.github.com/users/CNOCycle/orgs", "repos_url": "https://api.github.com/users/CNOCycle/repos", "events_url": "https://api.github.com/users/CNOCycle/events{/privacy}", "received_events_url": "https://api.github.com/users/CNOCycle/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-12-22T05:19:30Z", "updated_at": "2020-01-30T02:32:14Z", "closed_at": null, "author_association": "NONE", "body": "## URL(s) with the issue:\r\n\r\nPlease provide a link to the documentation entry, for example:\r\nhttps://www.tensorflow.org/versions/r1.14/api_docs/python/tf/keras/applications\r\n\r\n## Description of issue (what needs changing):\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04 in Docker\r\n- TensorFlow installed from (source or binary): pip install\r\n- TensorFlow version (use command below): v2.0.0-rc2-26-g64c3d38\r\n- Python version: 3.5\r\n- CUDA/cuDNN version: 10.0 / 7\r\n- GPU model and memory: GTX 1080Ti / 11175MiB\r\n\r\n\r\n**Describe the current behavior**\r\n\r\nHi authors and developers,\r\n\r\nI noticed that tensorflow doesn't provide a clear document explain how to use pre-trained model.\r\n\r\nSo, I wrote a benchmark which showed the accuracy of pre-trained model with applying imageNet' validation set.\r\n\r\nThe following is the result:\r\n\r\n```\r\n[Testing][pixel vales are from (0,255)][model:ResNet50] - loss: 2.711 - accuracy: 0.457\r\n[Testing][pixel vales are from (0,255)][model:DenseNet121] - loss: 39.000 - accuracy: 0.006\r\n[Testing][pixel vales are from (0,255)][model:MobileNetV2] - loss: 9.979 - accuracy: 0.003\r\n\r\n[Testing][pixel vales are from (0,1)][model:ResNet50] - loss: 8.535 - accuracy: 0.001\r\n[Testing][pixel vales are from (0,1)][model:DenseNet121] - loss: 1.895 - acc: 0.599\r\n[Testing][pixel vales are from (0,1)][model:MobileNetV2] - loss: 2.283 - accuracy: 0.523\r\n\r\n[Testing][pixel vales are normalized from (-1,1)][model:ResNet50] - loss: 8.313 - acc: 0.001\r\n[Testing][pixel vales are normalized from (-1,1)][model:DenseNet121] - loss: 1.896 - acc: 0.599\r\n[Testing][pixel vales are normalized from (-1,1)][model:MobileNetV2] - loss: 2.287 - acc: 0.524\r\n\r\n```\r\n\r\nFirst, we can see the accuracy is not comparable with the original result(Top-1 accuracy is 70% up).\r\n\r\nI thought that this issue is I'm not sure which crop and pad method is applied in the original result.\r\n\r\nTherefore, I defined a custom function `CenterCrop` to fit the model's input size.\r\n\r\nBut, we can skip this issues there.\r\n\r\nWhat I want to mention is normalization issue.\r\n\r\nIf I don't apply any normalization(run_aug=1 in code), pixel's values are defined in **(0, 255)**.\r\n\r\nAll models' accuracy are near 0.001, except for resNet50 which achieves a meaningful accuracy.\r\n\r\nIf I do normalization(run_aug=2 in code), pixel's values are defined in **(0, 1)**.\r\n\r\nThis time, DenseNet121 and MobileNetV2 have a meaningful accuracy.\r\n\r\nIf I do standard normalization(run_aug=3 in code), pixel's values are defined in **(-1, 1)**.\r\n\r\nThe results are similar to previous case. But I'm sure why those two cases have same accuracy.\r\n\r\nThose behavior let me confused.\r\n\r\nBefore applying pre-trained model, I have to which normalization method should be applied.\r\n\r\nAfter reading the source code, I found that those applications are import from `keras_application` in `tensorflow`.\r\n\r\n[keras-applications](https://github.com/keras-team/keras-applications)\r\n\r\n[weight download](https://github.com/fchollet/deep-learning-models)\r\n\r\n---\r\n\r\nI didn't test other models, such as `ResNet50V2`, `InceptionV3` and `Xception` because their input size are `299` instead of `244` and this is a time consuming task.\r\n\r\nHowever, anyone can modify the test case and do the benchmark.\r\n\r\n---\r\n\r\nBecause of licence issue for ImageNet, I can't provide imagenet in public.\r\n\r\nBut the following is the minimal test case:\r\n\r\n```python\r\n# pip install tensorflow-gpu==1.14.0\r\n# pip pandas\r\n#%%\r\nimport time\r\nimport numpy as np\r\nimport pandas as pd\r\nimport tensorflow as tf\r\n\r\nfrom glob import glob\r\n\r\n#%%\r\n# input image dimensions\r\nimg_h = 224\r\nimg_w = 224\r\nchannels = 3\r\n\r\n# information for dataset\r\ndataset_path = \"dataset-imagenet/\"\r\nnum_classes = 1000\r\nnum_testing = 50000\r\n\r\n#%%\r\nclass DataGenerator:\r\n\r\n    def __init__(self, dataframe, batch_size, run_aug = True):\r\n\r\n        self.total_len  = len(dataframe.index)\r\n        self.batch_size = batch_size\r\n        self.run_aug = run_aug\r\n        self.dataframe  = dataframe\r\n        self.on_epoch_end()\r\n\r\n    def __build_pipeline(self, file_path, labelY):\r\n\r\n        # mapping function in tf\r\n        def preprocess_fn(file_path, labelY):\r\n\r\n            def fn_x(img_array):\r\n\r\n                img_array = img_array.numpy()\r\n\r\n                if self.run_aug == 1:\r\n                    # image's range is [0,255]\r\n                    image = img_array\r\n\r\n                if self.run_aug >= 2:\r\n                    # image's range is [0,1]\r\n                    image = img_array / 255.0\r\n\r\n                if self.run_aug == 3:\r\n                    # std normalization\r\n                    image[0,:,:] -= 0.485\r\n                    image[1,:,:] -= 0.456\r\n                    image[2,:,:] -= 0.406\r\n                    image[0,:,:] /= 0.229\r\n                    image[1,:,:] /= 0.224\r\n                    image[2,:,:] /= 0.225\r\n\r\n                return image\r\n\r\n            def fn_y(label):\r\n                return tf.keras.utils.to_categorical(label , num_classes)\r\n\r\n            # read image from files\r\n            image = tf.io.read_file(file_path)\r\n            image = tf.image.decode_image(image, channels=channels)\r\n            aug_size = 256\r\n            imageX = tf.compat.v1.image.resize_image_with_pad(image, aug_size, aug_size)\r\n            imageX = tf.image.resize_with_crop_or_pad(image, img_h, img_w)\r\n\r\n            # do normalizarion\r\n            [imageX] = tf.py_function(fn_x, [imageX], [tf.float32])\r\n            imageX.set_shape([img_h, img_w, channels])\r\n            imageX = tf.image.random_flip_left_right(imageX)\r\n\r\n            [labelY] = tf.py_function(fn_y, [labelY], [tf.float32])\r\n            labelY.set_shape([num_classes])\r\n\r\n            return imageX, labelY\r\n\r\n        dataset = tf.data.Dataset.from_tensor_slices( (file_path, labelY) )\r\n        dataset = dataset.shuffle(batch_size * 8)\r\n        dataset = dataset.repeat()\r\n        dataset = dataset.map(preprocess_fn, num_parallel_calls=tf.data.experimental.AUTOTUNE)\r\n        dataset = dataset.batch(self.batch_size)\r\n        dataset = dataset.prefetch(tf.data.experimental.AUTOTUNE)\r\n\r\n        self.dataset   = dataset\r\n\r\n    def  __len__(self):\r\n\r\n        return self.total_len // self.batch_size\r\n\r\n    def on_epoch_end(self):\r\n\r\n        cleanX = np.array(self.dataframe[\"File\"])\r\n        totalY = np.array(self.dataframe[\"One-hot\"])\r\n\r\n        # run permutation\r\n        rand_idx = np.random.permutation(self.total_len)\r\n        cleanX = cleanX[rand_idx]\r\n        totalY = totalY[rand_idx]\r\n\r\n        self.__build_pipeline(cleanX, totalY)\r\n\r\n#%%\r\ndef build_clf(model_name):\r\n\r\n    if model_name == \"ResNet50\":\r\n        clf_model = tf.keras.applications.ResNet50(include_top=True, pooling='max', weights='imagenet')\r\n\r\n    if model_name == \"DenseNet121\":\r\n        clf_model = tf.keras.applications.DenseNet121(include_top=True, pooling='max', weights='imagenet')\r\n\r\n    if model_name == \"MobileNetV2\":\r\n        clf_model = tf.keras.applications.MobileNetV2(include_top=True, pooling='max', weights='imagenet')\r\n\r\n    if model_name == \"InceptionV3\":\r\n        clf_model = tf.keras.applications.InceptionV3(include_top=True, weights='imagenet')\r\n\r\n\r\n    clf_model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])\r\n\r\n    return clf_model\r\n\r\n#%%\r\ndef list_testing_data(classes, file_path, onehot_map):\r\n\r\n    try:\r\n        testing_data = pd.read_pickle('imagenet_test_list.pkl')\r\n        print('[Successful] Testing_data loaded from pickle ...')\r\n    except:\r\n        testing_image_info = []\r\n        for iter_class in classes:\r\n            files = glob(os.path.join(file_path, iter_class, '*.JPEG'))\r\n            for iter_img in files:\r\n                data_info = [iter_img, iter_class]\r\n                testing_image_info.append(data_info)\r\n\r\n        testing_data = pd.DataFrame(testing_image_info, columns=['File', 'Class'])\r\n        testing_data[\"One-hot\"] = testing_data[\"Class\"].replace(onehot_map, inplace=False)\r\n\r\n        testing_data.to_pickle('imagenet_test_list.pkl')\r\n\r\n    assert(testing_data.shape[0] == num_testing, \"[Fatal] Mismatched total length of testing data\")\r\n    return testing_data\r\n\r\n#%%\r\nif __name__ == '__main__':\r\n\r\n    # set GPU\r\n    import os\r\n    if os.environ.get(\"CUDA_VISIBLE_DEVICES\") is None:\r\n        os.environ[\"CUDA_VISIBLE_DEVICES\"] = \"0\"\r\n\r\n    # Hyperparameters\r\n    batch_size = 100\r\n    epochs = 5\r\n\r\n    # load one-hot labels\r\n    file_path = dataset_path + 'val'\r\n    classes = os.listdir(file_path)\r\n    list_class = sorted( list( set(classes) ) )\r\n    onehot_map = dict( zip( list_class, list(range(0, num_classes)) ))\r\n\r\n    # load list of validation data, those data should be considered as testing data\r\n    testing_data = list_testing_data(classes, file_path, onehot_map)\r\n\r\n    # build data generator\r\n    gen_type1 = DataGenerator(testing_data, batch_size, run_aug=1)\r\n    gen_type2 = DataGenerator(testing_data, batch_size, run_aug=2)\r\n    gen_type3 = DataGenerator(testing_data, batch_size, run_aug=3)\r\n    gen_list = [gen_type1, gen_type2, gen_type3]\r\n\r\n    # build model\r\n    model_list = [\"ResNet50\", \"DenseNet121\", \"MobileNetV2\"]\r\n    \r\n    # print result for type1\r\n    test_gen = gen_type1\r\n    for model_name in model_list:\r\n        model = build_clf(model_name)\r\n        meta_string = '[Testing][pixel vales are from (0,255)][model:{:s}] '.format(model_name)\r\n        prefix_string = ''\r\n        output = model.evaluate(test_gen.dataset, steps = test_gen.__len__())\r\n        for ii in range( len( model.metrics_names) ):\r\n            meta_string = meta_string + '- {:s}{:s}: {:.3f} '.format(prefix_string, model.metrics_names[ii], output[ii])\r\n\r\n        print(meta_string)\r\n\r\n    # print result for type2\r\n    test_gen = gen_type2\r\n    for model_name in model_list:\r\n        model = build_clf(model_name)\r\n        meta_string = '[Testing][pixel vales are from (0,1)][model:{:s}] '.format(model_name)\r\n        prefix_string = ''\r\n        output = model.evaluate(test_gen.dataset, steps = test_gen.__len__())\r\n        for ii in range( len( model.metrics_names) ):\r\n            meta_string = meta_string + '- {:s}{:s}: {:.3f} '.format(prefix_string, model.metrics_names[ii], output[ii])\r\n\r\n        print(meta_string)\r\n\r\n    # print result for type3\r\n    test_gen = gen_type3\r\n    for model_name in model_list:\r\n        model = build_clf(model_name)\r\n        meta_string = '[Testing][pixel vales are normalized from (-1,1)][model:{:s}] '.format(model_name)\r\n        prefix_string = ''\r\n        output = model.evaluate(test_gen.dataset, steps = test_gen.__len__())\r\n        for ii in range( len( model.metrics_names) ):\r\n            meta_string = meta_string + '- {:s}{:s}: {:.3f} '.format(prefix_string, model.metrics_names[ii], output[ii])\r\n\r\n        print(meta_string)\r\n```\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35333", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35333/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35333/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35333/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35333", "id": 541383357, "node_id": "MDU6SXNzdWU1NDEzODMzNTc=", "number": 35333, "title": "Optimizer within Estimator computes incorrectly small gradient when used with MirroredStrategy", "user": {"login": "lightvector", "id": 11942395, "node_id": "MDQ6VXNlcjExOTQyMzk1", "avatar_url": "https://avatars1.githubusercontent.com/u/11942395?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lightvector", "html_url": "https://github.com/lightvector", "followers_url": "https://api.github.com/users/lightvector/followers", "following_url": "https://api.github.com/users/lightvector/following{/other_user}", "gists_url": "https://api.github.com/users/lightvector/gists{/gist_id}", "starred_url": "https://api.github.com/users/lightvector/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lightvector/subscriptions", "organizations_url": "https://api.github.com/users/lightvector/orgs", "repos_url": "https://api.github.com/users/lightvector/repos", "events_url": "https://api.github.com/users/lightvector/events{/privacy}", "received_events_url": "https://api.github.com/users/lightvector/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-12-21T23:05:07Z", "updated_at": "2019-12-28T06:36:12Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes.\r\n- OS Platform and Distribution: Linux Ubuntu 18.04\r\n- TensorFlow installed from: Anaconda, clean install: `conda create -n tf2 tensorflow-gpu=2.0.0`\r\n- TensorFlow version: 2.0.0\r\n- Python version: 3.7.5\r\n- CUDA/cuDNN version: 10.0.130, 7.6.4\r\n- GPU model and memory: Tesla V100, 16GB\r\n\r\n**Describe the current behavior**\r\nA gradient is reported that is only half of the expected gradient when using distributed training with Estimator. See example code below.\r\n**Describe the expected behavior**\r\nThe gradient should be twice as large. If somehow this behavior is actually intended, then this needs to be much more loudly documented since it is quite unexpected - right now I cannot find any place where it is documented at all. For example, https://www.tensorflow.org/guide/distributed_training#using_tfdistributestrategy_with_estimator_limited_support and https://www.tensorflow.org/api_docs/python/tf/compat/v1/train/Optimizer#compute_gradients both have no mention of it.\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport sys\r\nimport os\r\nimport tensorflow as tf\r\nos.environ['TF_CPP_MIN_LOG_LEVEL'] = '1'\r\n\r\ndef model_fn(features,labels,mode,params):\r\n  if mode == tf.estimator.ModeKeys.PREDICT:\r\n    raise NotImplementedError()\r\n  if mode == tf.estimator.ModeKeys.EVAL:\r\n    raise NotImplementedError()\r\n  if mode == tf.estimator.ModeKeys.TRAIN:\r\n    w = tf.compat.v1.get_variable(initializer=tf.zeros([2]),name=\"w\")\r\n    losses = tf.square(w - labels)\r\n    loss = tf.reduce_sum(losses)\r\n    optimizer = tf.compat.v1.train.GradientDescentOptimizer(learning_rate=0.01)\r\n    gradients = optimizer.compute_gradients(tf.reduce_sum(loss))\r\n    global_step=tf.compat.v1.train.get_global_step()\r\n    train_op = optimizer.apply_gradients(gradients,global_step=global_step)\r\n    print_op = tf.print(\r\n      w,\r\n      losses,\r\n      [(grad,var.name) for (grad,var) in gradients],\r\n    )\r\n    return tf.estimator.EstimatorSpec(\r\n      mode,\r\n      loss=loss,\r\n      train_op=tf.group(train_op,print_op)\r\n    )\r\n\r\ndef input_fn():\r\n  dataset = tf.data.Dataset.from_tensors(({}, [1.,2.]))\r\n  return dataset.repeat(1)\r\n\r\nprint(\"SINGLE GPU\")\r\nestimator = tf.estimator.Estimator(\r\n  model_fn=model_fn,\r\n  model_dir=\"test_single_gpu/\",\r\n  params={}\r\n)\r\nestimator.train(input_fn)\r\n\r\ndef input_fn():\r\n  dataset = tf.data.Dataset.from_tensors(({}, [1.,2.]))\r\n  return dataset.repeat(2)\r\n\r\nprint(\"MULTI GPU\")\r\nstrategy = tf.distribute.MirroredStrategy(devices=[\"/GPU:0\",\"/GPU:1\"])\r\nestimator = tf.estimator.Estimator(\r\n  model_fn=model_fn,\r\n  model_dir=\"test_multi_gpu/\",\r\n  params={},\r\n  config=tf.estimator.RunConfig(train_distribute = strategy)\r\n)\r\nestimator.train(input_fn)\r\n```\r\n\r\n**Other info / logs**\r\nThe relevant portion of the output of the above test case is:\r\n```\r\nSINGLE GPU\r\n[0 0] [1 4] [([-2 -4], 'w:0')]\r\nMULTI GPU\r\n[0 0] [1 4] [([-1 -2], 'w:0')]\r\n[0 0] [1 4] [([-1 -2], 'w:0')]\r\n```\r\nThe model is attempting to fit two weights to be equal to 1 and 2, respectively, penalizing them by the squared error. The weights are initialized to 0.\r\n* Single GPU case: We can see it reads one data element from the dataset, and correctly computes the loss as as \"1\" and \"4\", which are the squared differences. The gradients are correctly computed as \"-2\" and \"-4\", which indeed the mathematical derivatives of (x-1)^2 and (x-2)^2 at x = 0, respectively. So this is all correct.\r\n* Multi GPU case: We can see each GPU independently and in parallel reads an element from the dataset, reading two elements in total. Each one correctly computes the loss as \"1\" and \"4\" as before on its own element. However, each one separately only computes \"-1\" and \"-2\" as the gradient. This is wrong, each one is a factor of 2 too small.\r\n\r\n(edit: corrected linux version, some grammar edits)"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35332", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35332/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35332/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35332/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/35332", "id": 541369222, "node_id": "MDExOlB1bGxSZXF1ZXN0MzU2MDI5MTk1", "number": 35332, "title": "Update math_ops.py with additional usage examples", "user": {"login": "anigasan", "id": 29756847, "node_id": "MDQ6VXNlcjI5NzU2ODQ3", "avatar_url": "https://avatars2.githubusercontent.com/u/29756847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anigasan", "html_url": "https://github.com/anigasan", "followers_url": "https://api.github.com/users/anigasan/followers", "following_url": "https://api.github.com/users/anigasan/following{/other_user}", "gists_url": "https://api.github.com/users/anigasan/gists{/gist_id}", "starred_url": "https://api.github.com/users/anigasan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anigasan/subscriptions", "organizations_url": "https://api.github.com/users/anigasan/orgs", "repos_url": "https://api.github.com/users/anigasan/repos", "events_url": "https://api.github.com/users/anigasan/events{/privacy}", "received_events_url": "https://api.github.com/users/anigasan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 1169365494, "node_id": "MDU6TGFiZWwxMTY5MzY1NDk0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:M", "name": "size:M", "color": "adafea", "default": false, "description": "CL Change Size: Medium"}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2019-12-21T20:37:36Z", "updated_at": "2020-03-19T01:15:53Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/35332", "html_url": "https://github.com/tensorflow/tensorflow/pull/35332", "diff_url": "https://github.com/tensorflow/tensorflow/pull/35332.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/35332.patch"}, "body": "Added usage examples for tf.math (subtract, scalar_mul, truediv, divide_no_nan, multiply_no_nan, floordiv, reduce_prod, reduce_min, reduce_max, sigmoid, log_sigmoid, unsorted_segmentation, unsorted_segment_sqrt_n, polyval)"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35330", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35330/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35330/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35330/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35330", "id": 541342739, "node_id": "MDU6SXNzdWU1NDEzNDI3Mzk=", "number": 35330, "title": "Keras backend functions not working as intended?", "user": {"login": "korr4k", "id": 26173483, "node_id": "MDQ6VXNlcjI2MTczNDgz", "avatar_url": "https://avatars2.githubusercontent.com/u/26173483?v=4", "gravatar_id": "", "url": "https://api.github.com/users/korr4k", "html_url": "https://github.com/korr4k", "followers_url": "https://api.github.com/users/korr4k/followers", "following_url": "https://api.github.com/users/korr4k/following{/other_user}", "gists_url": "https://api.github.com/users/korr4k/gists{/gist_id}", "starred_url": "https://api.github.com/users/korr4k/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/korr4k/subscriptions", "organizations_url": "https://api.github.com/users/korr4k/orgs", "repos_url": "https://api.github.com/users/korr4k/repos", "events_url": "https://api.github.com/users/korr4k/events{/privacy}", "received_events_url": "https://api.github.com/users/korr4k/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-12-21T16:10:22Z", "updated_at": "2020-01-16T23:29:43Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code: Yes\r\n- OS Platform and Distribution: 4.4.0-18362-Microsoft\r\n- TensorFlow installed from: Anaconda default source\r\n- TensorFlow version: 1.15\r\n- Python version: 3.7.5\r\n- CUDA/cuDNN version: 10.0\r\n- GPU model and memory: GeForce RTX 2060\r\n\r\n**Describe the current behavior**\r\n\r\nI'm trying to implement a custom loss function based on a custom accuracy function that I'm already using to evaluate my model predictions on the test dataset. The conversion can't be 1:1 because I use numpy \"greater\" and \"equal\" functions that are not differentiable. I created thefore custom functions that approximate the latters but their behavior has some problems\r\n\r\n**Describe the expected behavior**\r\n\r\nIn particular I can test if everything is fine by comparing the results obtained by my original custom accuracy f. and the new loss f. given the same input (my input are tensorflow predictions, I just inglobe them inside K.constant to convert them in tensors). What I noticed is that this line of code\r\n\r\n```\r\neps = sys.float_info.epsilon\r\nreturn 0.5*(y + 5 + K.sqrt(K.pow(y-5,2) + eps))\r\n```\r\n\r\nis problematic. In particular y is an array of float32 values in [1:10] range and the returned array, let's call it 'ret', should have ret[i]=max(5,y[i]) but sometimes the value of **5** becomes **4.9999995** instead. The next portion of my code is based on how many **5** are present and therefore I can't ignore this problem.\r\n\r\nThe fact is that, let's say a problematic index is 'w' so that ret[w]=4.9999995 instead of 5, if I use the same code with y now equal to only y[w] the returned array is correctly 5. This means that somehow if y is a batch of predictions and not just one something isn't working. This should not be the case because both K.sqrt and K.pow works element wise, it should not matter if y is an array of 1 or multiple values \r\n\r\nOut of almost 20k predictions, around 1k have this same problem and it is deterministic (always the same are problematic). I also tried to use:\r\n\r\n```\r\neps = sys.float_info.epsilon\r\nreturn 0.5*(y + 5 + np.sqrt(np.pow(y-5,2) + eps))\r\n```\r\n\r\nand the problem is gone thefore it is related to Keras backend.\r\n\r\nLast info, I tried to use also:\r\n\r\n```\r\neps = sys.float_info.epsilon\r\nreturn tf.math.ceil(0.5*(y + 5 + K.sqrt(K.pow(y-5,2) + eps)))\r\n```\r\n\r\nbut this completely ruins the returned value, sometimes real numbers such as 4.5 are rounded to 6 instead of 5\r\n\r\nIf more informations are needed I can provide them"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35329", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35329/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35329/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35329/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35329", "id": 541299111, "node_id": "MDU6SXNzdWU1NDEyOTkxMTE=", "number": 35329, "title": "Error: Cannot convert 'auto' to EagerTensor of dtype float", "user": {"login": "yourtheron", "id": 51472988, "node_id": "MDQ6VXNlcjUxNDcyOTg4", "avatar_url": "https://avatars1.githubusercontent.com/u/51472988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yourtheron", "html_url": "https://github.com/yourtheron", "followers_url": "https://api.github.com/users/yourtheron/followers", "following_url": "https://api.github.com/users/yourtheron/following{/other_user}", "gists_url": "https://api.github.com/users/yourtheron/gists{/gist_id}", "starred_url": "https://api.github.com/users/yourtheron/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yourtheron/subscriptions", "organizations_url": "https://api.github.com/users/yourtheron/orgs", "repos_url": "https://api.github.com/users/yourtheron/repos", "events_url": "https://api.github.com/users/yourtheron/events{/privacy}", "received_events_url": "https://api.github.com/users/yourtheron/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-12-21T08:05:32Z", "updated_at": "2020-01-10T09:19:34Z", "closed_at": null, "author_association": "NONE", "body": "Thank you for submitting a TensorFlow documentation issue. Per our GitHub\r\npolicy, we only address code/doc bugs, performance issues, feature requests, and\r\nbuild/installation issues on GitHub.\r\n\r\nThe TensorFlow docs are open source! To get involved, read the documentation\r\ncontributor guide: https://www.tensorflow.org/community/contribute/docs\r\n\r\n## URL(s) with the issue:\r\n\r\nPlease provide a link to the documentation entry, for example:\r\nhttps://www.tensorflow.org/api_docs/python/tf/keras/losses/Reduction?version=stable\r\n\r\n## Description of issue (what needs changing):\r\n\r\nI intend to build up a custom loss function as follows:\r\n\r\n\r\n`\tfrom __future__ import absolute_import, division, print_function, unicode_literals\r\n\timport functools\r\n\r\n\timport numpy as np\r\n\timport tensorflow as tf\r\n\r\n\r\n\tclass GeneralDiceLoss(tf.keras.losses.Loss):\r\n\t\tdef __init__(self, reduction=tf.keras.losses.Reduction.AUTO, name='GeneralDiceLoss'):\r\n\t\t\tsuper().__init__(reduction=reduction, name=name)\r\n\t\t\tself.epsilon = 1e-16 \r\n\t\t\r\n\t\t\r\n\t\tdef get_config(self):\r\n\t\t\tconfig = super(GeneralDiceLoss, self).get_config()\r\n\t\t\treturn config\r\n\t\t\r\n\t\tdef call(self, yPred, yTrue):\r\n\t\t\t#yTrue =tf.dtypes.cast(yTrue, dtype=yPred.dtype)\r\n\t\t\t# Dot product yPred and yTrue and sum them up for each datum and class\r\n\t\t\tcrossProd=tf.multiply(yPred, yTrue)\r\n\t\t\tcrossProdSum=tf.math.reduce_sum(crossProd, axis=np.arange(2, yTrue.ndim))\r\n\t\t\t# Calculate weight for each datum and class \r\n\t\t\tweight = tf.math.reduce_sum(yTrue, axis=np.arange(2, yTrue.ndim))\r\n\t\t\tweight = tf.math.divide(1, tf.math.square(weight)+self.epsilon)\r\n\t\t\t# Weighted sum over classes\r\n\t\t\tnumerator = 2*tf.math.reduce_sum(tf.multiply(crossProdSum, weight), axis=1)\r\n\t\t\t# Saquared summation \r\n\t\t\tyySum = tf.math.reduce_sum(tf.math.square(yPred) + tf.math.square(yTrue), axis=np.arange(2, yTrue.ndim))\r\n\t\t\t# Weighted sum over classes\r\n\t\t\tdenominator = tf.math.reduce_sum(tf.multiply(weight, yySum), axis=1)\r\n\t\t\tloss = 1 - tf.math.divide(numerator, denominator+self.epsilon)\r\n\t\t\t#loss = tf.math.reduce_mean(1 - tf.math.divide(numerator, denominator+self.epsilon))\r\n\t\t\t\r\n\t\t\treturn loss\r\n`\r\n\r\nThen I create variables to have it test\r\n`\r\n\r\n\tGeneralDiceLoss()\r\n\tyPred = tf.random.uniform(shape=(16, 3, 4, 4, 4))\r\n\tyTrue = tf.round(tf.random.uniform(shape=(16, 3, 4, 4, 4)))\r\n\r\n\tloss=GeneralDiceLoss(yPred, yTrue)\r\n`\r\nBut I got an error\r\n`\r\n\r\n\t  File \"...\\keras-gpu\\lib\\site-packages\\tensorflow_core\\python\\framework\\constant_op.py\", line 96, in convert_to_eager_tensor\r\n\t\treturn ops.EagerTensor(value, ctx.device_name, dtype)\r\n\r\n\tTypeError: Cannot convert 'auto' to EagerTensor of dtype float\r\n`\r\n\r\nIn the doc above, \r\n1) there is NO clear indication or warning about conversion issue, not to mention there is NO dtype conversion in my code at all. \r\n2) there is NO clear example indicating which option, AUTO or SUM_OVER_BATCH_SIZE, should be adopted in one's minbatch size is greater than 1. In my case, assume my batch is 16 as exhibted in yPred and yTrue above, shall I use\r\n\r\n`\r\n\t\t\tloss = 1 - tf.math.divide(numerator, denominator+self.epsilon)\r\n`\r\nor \r\n`\r\n\t\t\tloss = tf.math.reduce_mean(1 - tf.math.divide(numerator, denominator+self.epsilon))\r\n`\r\nAnd for which option?\r\n\r\nBuilding up a custom layer/loss function is already a tough task for many practitioners, so could the doc provide more detailed explanations and examples so as to make users' life a little bit easier? Many thanks."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35319", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35319/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35319/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35319/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35319", "id": 541235428, "node_id": "MDU6SXNzdWU1NDEyMzU0Mjg=", "number": 35319, "title": "TF2.0 fails post-training uint8 quantization", "user": {"login": "dojipkim", "id": 57776540, "node_id": "MDQ6VXNlcjU3Nzc2NTQw", "avatar_url": "https://avatars1.githubusercontent.com/u/57776540?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dojipkim", "html_url": "https://github.com/dojipkim", "followers_url": "https://api.github.com/users/dojipkim/followers", "following_url": "https://api.github.com/users/dojipkim/following{/other_user}", "gists_url": "https://api.github.com/users/dojipkim/gists{/gist_id}", "starred_url": "https://api.github.com/users/dojipkim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dojipkim/subscriptions", "organizations_url": "https://api.github.com/users/dojipkim/orgs", "repos_url": "https://api.github.com/users/dojipkim/repos", "events_url": "https://api.github.com/users/dojipkim/events{/privacy}", "received_events_url": "https://api.github.com/users/dojipkim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jianlijianli", "id": 43797323, "node_id": "MDQ6VXNlcjQzNzk3MzIz", "avatar_url": "https://avatars3.githubusercontent.com/u/43797323?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jianlijianli", "html_url": "https://github.com/jianlijianli", "followers_url": "https://api.github.com/users/jianlijianli/followers", "following_url": "https://api.github.com/users/jianlijianli/following{/other_user}", "gists_url": "https://api.github.com/users/jianlijianli/gists{/gist_id}", "starred_url": "https://api.github.com/users/jianlijianli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jianlijianli/subscriptions", "organizations_url": "https://api.github.com/users/jianlijianli/orgs", "repos_url": "https://api.github.com/users/jianlijianli/repos", "events_url": "https://api.github.com/users/jianlijianli/events{/privacy}", "received_events_url": "https://api.github.com/users/jianlijianli/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jianlijianli", "id": 43797323, "node_id": "MDQ6VXNlcjQzNzk3MzIz", "avatar_url": "https://avatars3.githubusercontent.com/u/43797323?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jianlijianli", "html_url": "https://github.com/jianlijianli", "followers_url": "https://api.github.com/users/jianlijianli/followers", "following_url": "https://api.github.com/users/jianlijianli/following{/other_user}", "gists_url": "https://api.github.com/users/jianlijianli/gists{/gist_id}", "starred_url": "https://api.github.com/users/jianlijianli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jianlijianli/subscriptions", "organizations_url": "https://api.github.com/users/jianlijianli/orgs", "repos_url": "https://api.github.com/users/jianlijianli/repos", "events_url": "https://api.github.com/users/jianlijianli/events{/privacy}", "received_events_url": "https://api.github.com/users/jianlijianli/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-12-20T22:55:58Z", "updated_at": "2019-12-24T06:33:13Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10\r\n- TensorFlow installed from (source or binary): installed TF binary 2.0 with Conda\r\n- TensorFlow version (or github SHA if from source): TF 2.0\r\n\r\n\r\n**Command used to run the converter or code if you\u2019re using the Python API**\r\n\r\n```\r\nconverter = tf.lite.TFLiteConverter.from_saved_model('model_mnist.hd5')\r\nconverter.optimizations = [tf.lite.Optimize.DEFAULT]\r\nconverter.target_spec.supported_ops = [tf.lite.OpsSet.TFLITE_BUILTINS_INT8]\r\nconverter.inference_input_type = tf.uint8\r\nconverter.inference_output_type = tf.uint8\r\n\r\nimages = tf.cast(X_train, tf.float32)\r\nmnist_ds = tf.data.Dataset.from_tensor_slices((images)).batch(1)\r\ndef representative_data_gen():\r\n    for input_value in mnist_ds.take(100):\r\n        yield[input_value]\r\nconverter.representative_dataset = representative_data_gen\r\n\r\ntflite_quant_model = converter.convert()\r\nwith open('model_mnist_quant_uint8.tflite', 'wb') as f:\r\n    f.write(tflite_quant_model)\r\n\r\n\r\ninterpreter = tf.lite.Interpreter(model_path='model_mnist_quant_uint8.tflite')\r\ninterpreter.allocate_tensors()\r\n\r\nimg = X_train[0] * 255\r\nimg = img.astype('uint8')\r\nprint(interpreter.get_input_details())\r\ninterpreter.set_tensor(interpreter.get_input_details()[0]['index'], np.expand_dims(img, axis=0))\r\n```\r\n\r\n**The output from the converter invocation**\r\n\r\n```\r\n[{'name': 'flatten_input', 'index': 11, 'shape': array([ 1, 28, 28]), 'dtype': <class 'numpy.float32'>, 'quantization': (0.0, 0)}]\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-12-5a2fa86c9de2> in <module>\r\n      5 img = img.astype('uint8')\r\n      6 print(interpreter.get_input_details())\r\n----> 7 interpreter.set_tensor(interpreter.get_input_details()[0]['index'], np.expand_dims(img, axis=0))\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\tensorflow2\\lib\\site-packages\\tensorflow_core\\lite\\python\\interpreter.py in set_tensor(self, tensor_index, value)\r\n    344       ValueError: If the interpreter could not set the tensor.\r\n    345     \"\"\"\r\n--> 346     self._interpreter.SetTensor(tensor_index, value)\r\n    347 \r\n    348   def resize_tensor_input(self, input_index, tensor_size):\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\tensorflow2\\lib\\site-packages\\tensorflow_core\\lite\\python\\interpreter_wrapper\\tensorflow_wrap_interpreter_wrapper.py in SetTensor(self, i, value)\r\n    134 \r\n    135     def SetTensor(self, i, value):\r\n--> 136         return _tensorflow_wrap_interpreter_wrapper.InterpreterWrapper_SetTensor(self, i, value)\r\n    137 \r\n    138     def GetTensor(self, i):\r\n\r\nValueError: Cannot set tensor: Got tensor of type UINT8 but expected type FLOAT32 for input 11, name: flatten_input \r\n```\r\n\r\n**Also, please include a link to the saved model or GraphDef**\r\n\r\n```\r\n# Put link here or attach to the issue.\r\n```\r\n\r\n**Failure details**\r\nThe conversion is successful, but the generated model is wrong. The input tensor dtype should be uint8, but is still float32.\r\n\r\nI tried the same thing with TF 1.15.0. In this case, every things works as expected. Here is the result with TF 1.15.0\r\n```\r\n[{'name': 'flatten_input', 'index': 11, 'shape': array([ 1, 28, 28], dtype=int32), 'dtype': <class 'numpy.uint8'>, 'quantization': (0.003921568859368563, 0)}]\r\n```\r\n\r\n\r\n**Any other info / logs**\r\n\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35318", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35318/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35318/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35318/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35318", "id": 541233523, "node_id": "MDU6SXNzdWU1NDEyMzM1MjM=", "number": 35318, "title": "TensorFlow Lite Micro fully connected int8 test passes illegal filter offset", "user": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rockyrhodes", "id": 7253968, "node_id": "MDQ6VXNlcjcyNTM5Njg=", "avatar_url": "https://avatars2.githubusercontent.com/u/7253968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rockyrhodes", "html_url": "https://github.com/rockyrhodes", "followers_url": "https://api.github.com/users/rockyrhodes/followers", "following_url": "https://api.github.com/users/rockyrhodes/following{/other_user}", "gists_url": "https://api.github.com/users/rockyrhodes/gists{/gist_id}", "starred_url": "https://api.github.com/users/rockyrhodes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rockyrhodes/subscriptions", "organizations_url": "https://api.github.com/users/rockyrhodes/orgs", "repos_url": "https://api.github.com/users/rockyrhodes/repos", "events_url": "https://api.github.com/users/rockyrhodes/events{/privacy}", "received_events_url": "https://api.github.com/users/rockyrhodes/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rockyrhodes", "id": 7253968, "node_id": "MDQ6VXNlcjcyNTM5Njg=", "avatar_url": "https://avatars2.githubusercontent.com/u/7253968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rockyrhodes", "html_url": "https://github.com/rockyrhodes", "followers_url": "https://api.github.com/users/rockyrhodes/followers", "following_url": "https://api.github.com/users/rockyrhodes/following{/other_user}", "gists_url": "https://api.github.com/users/rockyrhodes/gists{/gist_id}", "starred_url": "https://api.github.com/users/rockyrhodes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rockyrhodes/subscriptions", "organizations_url": "https://api.github.com/users/rockyrhodes/orgs", "repos_url": "https://api.github.com/users/rockyrhodes/repos", "events_url": "https://api.github.com/users/rockyrhodes/events{/privacy}", "received_events_url": "https://api.github.com/users/rockyrhodes/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-12-20T22:47:52Z", "updated_at": "2020-03-09T17:38:19Z", "closed_at": null, "author_association": "MEMBER", "body": "An external developer pointed out that the test for the quantized fully connected operation passes in a non-zero weight offset to the kernel for int8 tests:\r\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/lite/micro/kernels/fully_connected_test.cc#L118-L119\r\n\r\nThe quantization specification promises that int8 kernels will always receive zero weight offsets:\r\nhttps://www.tensorflow.org/lite/performance/quantization_spec\r\n\r\nThis failing test is preventing an optimized kernel for a hardware platform from being accepted."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35317", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35317/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35317/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35317/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35317", "id": 541223221, "node_id": "MDU6SXNzdWU1NDEyMjMyMjE=", "number": 35317, "title": "Slicing tensor within a keras.utils.Sequence with multiprocessing=True hangs fit_generator", "user": {"login": "theGOTOguy", "id": 1411050, "node_id": "MDQ6VXNlcjE0MTEwNTA=", "avatar_url": "https://avatars3.githubusercontent.com/u/1411050?v=4", "gravatar_id": "", "url": "https://api.github.com/users/theGOTOguy", "html_url": "https://github.com/theGOTOguy", "followers_url": "https://api.github.com/users/theGOTOguy/followers", "following_url": "https://api.github.com/users/theGOTOguy/following{/other_user}", "gists_url": "https://api.github.com/users/theGOTOguy/gists{/gist_id}", "starred_url": "https://api.github.com/users/theGOTOguy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/theGOTOguy/subscriptions", "organizations_url": "https://api.github.com/users/theGOTOguy/orgs", "repos_url": "https://api.github.com/users/theGOTOguy/repos", "events_url": "https://api.github.com/users/theGOTOguy/events{/privacy}", "received_events_url": "https://api.github.com/users/theGOTOguy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-12-20T22:11:02Z", "updated_at": "2020-02-09T06:45:53Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):  Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):  Ubuntu 18.04\r\n- TensorFlow installed from (source or binary):  binary\r\n- TensorFlow version (use command below):  2.0.0\r\n- Python version:  3.6.8\r\n- CUDA/cuDNN version:  10.2 / 7.6.5.32-1+cuda10.2\r\n- GPU model and memory:  NVidia Titan RTX 24218 MiB\r\n\r\n**Describe the current behavior**\r\n\r\nWhen I attempt to slice a tensor inside a keras.util.Sequence from model.fit_generator with multiprocessing=True, TensorFlow hangs forever without reporting any error or using any CPU or GPU cycles.  It works as expected when multiprocessing=False.\r\n\r\n**Describe the expected behavior**\r\n\r\nTensorFlow should correctly fit the model just as it does with multiprocessing=False\r\n\r\n**Code to reproduce the issue**\r\n\r\nIn order to reproduce, substitute my_jpeg for some jpeg on your computer (hopefully with dimension greater than 224px).  Note that if you set use_multiprocessing=False in the example below, then this will correctly train the model.\r\n\r\n```\r\nfrom __future__ import absolute_import, division, print_function, unicode_literals\r\n\r\nimport tensorflow as tf\r\nfrom tensorflow import keras\r\n\r\n# In order to reproduce, just use whatever random JPEG you have handy here.\r\n# It should be larger than my_crop in the x and y dimension.\r\nmy_jpeg = \"/home/ben/my_jpeg.jpg\"\r\nmy_crop = 224\r\n\r\n# Generates a single crop for TensorFlow.\r\nclass DataGenerator(keras.utils.Sequence):\r\n  def __init__(\r\n      self,\r\n      image_location,\r\n      crop_size=224):\r\n    self._image_location = image_location\r\n    self._crop_size = crop_size\r\n\r\n  # Just one single batch will be returned, of just one single image.\r\n  def __len__(self):\r\n    return 1\r\n\r\n  # Generate one batch of data.\r\n  def __getitem__(self, index):\r\n    # Where the tensors will be stored.\r\n    X = []\r\n    y = [1]\r\n\r\n    # Read it.\r\n    image = tf.io.read_file(self._image_location)\r\n\r\n    # Load it.\r\n    image = tf.image.decode_jpeg(image, channels=3)\r\n\r\n    assert image.shape[2] == 3  # MUST be RGB.\r\n    height = image.shape[0]\r\n    width = image.shape[1]\r\n\r\n    # Just take a trivial crop of the image.\r\n    # This is the offending line operation which hangs forever.\r\n    image = image[0:self._crop_size, 0:self._crop_size, :]\r\n\r\n    # This line is equivalent to above, and it also hangs with multiprocessing enabled.\r\n    # image = tf.slice(image, [0, 0, 0], [self._crop_size, self._crop_size, 3])\r\n\r\n    X.append(tf.dtypes.cast(image, tf.float32))\r\n\r\n    # Tensors are not generally assignable, but we can create them from a number of existing ones.\r\n    X = tf.stack(X)\r\n    y = tf.stack(y)\r\n\r\n    # Preprocess it.\r\n    X /= 255.0  # Normalize to [0, 1] range.\r\n\r\n    return X, y\r\n\r\ngenerator = DataGenerator(my_jpeg, my_crop)\r\n\r\nmodel = tf.keras.applications.ResNet50(input_shape=(my_crop, my_crop, 3))\r\n\r\nmodel.compile(loss='mse')\r\n\r\n# use_multiprocessing=False works.\r\n# use_multiprocessing=True hangs.\r\nmodel.fit_generator(generator, use_multiprocessing=True, workers=2)\r\n```\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35308", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35308/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35308/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35308/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35308", "id": 541012574, "node_id": "MDU6SXNzdWU1NDEwMTI1NzQ=", "number": 35308, "title": "Why does the cpu bias_op support only up to five dims?", "user": {"login": "idofr", "id": 2036083, "node_id": "MDQ6VXNlcjIwMzYwODM=", "avatar_url": "https://avatars1.githubusercontent.com/u/2036083?v=4", "gravatar_id": "", "url": "https://api.github.com/users/idofr", "html_url": "https://github.com/idofr", "followers_url": "https://api.github.com/users/idofr/followers", "following_url": "https://api.github.com/users/idofr/following{/other_user}", "gists_url": "https://api.github.com/users/idofr/gists{/gist_id}", "starred_url": "https://api.github.com/users/idofr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/idofr/subscriptions", "organizations_url": "https://api.github.com/users/idofr/orgs", "repos_url": "https://api.github.com/users/idofr/repos", "events_url": "https://api.github.com/users/idofr/events{/privacy}", "received_events_url": "https://api.github.com/users/idofr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ezhulenev", "id": 1174378, "node_id": "MDQ6VXNlcjExNzQzNzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/1174378?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezhulenev", "html_url": "https://github.com/ezhulenev", "followers_url": "https://api.github.com/users/ezhulenev/followers", "following_url": "https://api.github.com/users/ezhulenev/following{/other_user}", "gists_url": "https://api.github.com/users/ezhulenev/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezhulenev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezhulenev/subscriptions", "organizations_url": "https://api.github.com/users/ezhulenev/orgs", "repos_url": "https://api.github.com/users/ezhulenev/repos", "events_url": "https://api.github.com/users/ezhulenev/events{/privacy}", "received_events_url": "https://api.github.com/users/ezhulenev/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ezhulenev", "id": 1174378, "node_id": "MDQ6VXNlcjExNzQzNzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/1174378?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezhulenev", "html_url": "https://github.com/ezhulenev", "followers_url": "https://api.github.com/users/ezhulenev/followers", "following_url": "https://api.github.com/users/ezhulenev/following{/other_user}", "gists_url": "https://api.github.com/users/ezhulenev/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezhulenev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezhulenev/subscriptions", "organizations_url": "https://api.github.com/users/ezhulenev/orgs", "repos_url": "https://api.github.com/users/ezhulenev/repos", "events_url": "https://api.github.com/users/ezhulenev/events{/privacy}", "received_events_url": "https://api.github.com/users/ezhulenev/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-12-20T14:07:25Z", "updated_at": "2020-02-20T02:19:51Z", "closed_at": null, "author_association": "NONE", "body": "I'm currently using tf.1.14 on Windows 10, but it doesn't seem to matter too much.\r\n\r\nI have a high-dimensional tensor object which I try to process with a Keras Dense layer. On the GPU everything works perfectly fine, but if I want to run the network on the CPU I get the following error \"Only ranks up to 5 supported:.... \".  A quick look into the C code shows that the dimensionality handling is, indeed, hardcoded:\r\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/kernels/bias_op.cc#L102\r\n\r\nMy question is only why? It seems like it might have something to do with the way `GetBiasValueDims()` is written, but not necessarily."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35305", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35305/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35305/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35305/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35305", "id": 540922846, "node_id": "MDU6SXNzdWU1NDA5MjI4NDY=", "number": 35305, "title": "runnin magic_wand on efr/efm32 microcontroller", "user": {"login": "KarimelQ", "id": 30404815, "node_id": "MDQ6VXNlcjMwNDA0ODE1", "avatar_url": "https://avatars2.githubusercontent.com/u/30404815?v=4", "gravatar_id": "", "url": "https://api.github.com/users/KarimelQ", "html_url": "https://github.com/KarimelQ", "followers_url": "https://api.github.com/users/KarimelQ/followers", "following_url": "https://api.github.com/users/KarimelQ/following{/other_user}", "gists_url": "https://api.github.com/users/KarimelQ/gists{/gist_id}", "starred_url": "https://api.github.com/users/KarimelQ/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/KarimelQ/subscriptions", "organizations_url": "https://api.github.com/users/KarimelQ/orgs", "repos_url": "https://api.github.com/users/KarimelQ/repos", "events_url": "https://api.github.com/users/KarimelQ/events{/privacy}", "received_events_url": "https://api.github.com/users/KarimelQ/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, {"login": "wangtz", "id": 34290063, "node_id": "MDQ6VXNlcjM0MjkwMDYz", "avatar_url": "https://avatars1.githubusercontent.com/u/34290063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wangtz", "html_url": "https://github.com/wangtz", "followers_url": "https://api.github.com/users/wangtz/followers", "following_url": "https://api.github.com/users/wangtz/following{/other_user}", "gists_url": "https://api.github.com/users/wangtz/gists{/gist_id}", "starred_url": "https://api.github.com/users/wangtz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wangtz/subscriptions", "organizations_url": "https://api.github.com/users/wangtz/orgs", "repos_url": "https://api.github.com/users/wangtz/repos", "events_url": "https://api.github.com/users/wangtz/events{/privacy}", "received_events_url": "https://api.github.com/users/wangtz/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-12-20T10:31:19Z", "updated_at": "2020-02-06T16:28:12Z", "closed_at": null, "author_association": "NONE", "body": "@tensorflow/micro\r\n\r\n**System information**\r\n- Host OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04 ( Windows SL)\r\n- TensorFlow installed from (source or binary): source\r\n- Tensorflow version (commit SHA if source):\r\n- Target platform (e.g. Arm Mbed OS, Arduino Nano 33 etc.): target : efr32/efm32 (tried to compile with mbed) \r\n\r\n**Describe the problem**\r\nI'm trying to run one of the provided projects on efr/efm32 microcontroller, (i choose magic_wanda example because i have an accelero & it seem's good example to start with). \r\nI wanted just to generate a binary file first, then make changes to adapt code with external accelerometer, itried this command:  _make -f tensorflow/lite/micro/tools/make/Makefile TARGET=mbed TAGS=\"CMSIS efm32pg_stk3401\" magic_wand_bin_ but errors appear.\r\nShould i do some big modifications on project to run it on efr32/efm32 micro ?\r\nThank's for your answers\r\n\r\n**Please provide the exact sequence of commands/steps when you ran into the problem**\r\n\r\n _make -f tensorflow/lite/micro/tools/make/Makefile TARGET=mbed TAGS=\"CMSIS efm32pg_stk3401\" magic_wand_bin\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35292", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35292/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35292/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35292/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35292", "id": 540673554, "node_id": "MDU6SXNzdWU1NDA2NzM1NTQ=", "number": 35292, "title": "unbounded memory leak in tf.io.gfile.isdir()", "user": {"login": "nfelt", "id": 710113, "node_id": "MDQ6VXNlcjcxMDExMw==", "avatar_url": "https://avatars0.githubusercontent.com/u/710113?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nfelt", "html_url": "https://github.com/nfelt", "followers_url": "https://api.github.com/users/nfelt/followers", "following_url": "https://api.github.com/users/nfelt/following{/other_user}", "gists_url": "https://api.github.com/users/nfelt/gists{/gist_id}", "starred_url": "https://api.github.com/users/nfelt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nfelt/subscriptions", "organizations_url": "https://api.github.com/users/nfelt/orgs", "repos_url": "https://api.github.com/users/nfelt/repos", "events_url": "https://api.github.com/users/nfelt/events{/privacy}", "received_events_url": "https://api.github.com/users/nfelt/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-12-20T00:55:44Z", "updated_at": "2019-12-20T19:07:02Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "This was discovered in debugging of https://github.com/tensorflow/tensorboard/issues/766 by a combination of @psybuzz, @wchargin, and myself.  From empirical evidence from TensorBoard users it appears that this grows without bound, so in practical usage it only takes a day or so to consume dozens of GB of memory.\r\n\r\nCalling `tf.io.gfile.isdir()` leaks memory at a rate of approximately 1 MB per 20,000 calls, and this is reproducible at TF 2.0.0 and latest tf-nightly (`tf-nightly-2.1.0.dev20191219`), on macOS, Ubuntu 16.04, and Linux Debian (a Google workstation), and with python 2.7, 3.5, and 3.7.\r\n\r\nHere's our repro script:\r\n```python\r\nimport gc\r\nimport os\r\nimport resource\r\nimport time\r\n\r\nimport tensorflow as tf\r\n\r\nprint(\"PID: %d\\n\" % (os.getpid(),))\r\nprev = 0\r\nwhile True:\r\n  peak = resource.getrusage(resource.RUSAGE_SELF).ru_maxrss\r\n  print(\"peak memory = %d (+%d) in kb (Linux) or b (macOS)\" % (peak, peak-prev))\r\n  prev = peak\r\n  for _ in range(20000):\r\n    tf.io.gfile.isdir(b\"/tmp/nonexistent-file-for-tf-memory-leak\")\r\n  gc.collect()\r\n  time.sleep(1.0)\r\n```\r\n\r\nSample output of `python repro.py`:\r\n```\r\nPID: 153611\r\n\r\npeak memory = 226796 (+226796) in kb (Linux) or b (macOS)\r\npeak memory = 228108 (+1312) in kb (Linux) or b (macOS)\r\npeak memory = 229132 (+1024) in kb (Linux) or b (macOS)\r\npeak memory = 229900 (+768) in kb (Linux) or b (macOS)\r\npeak memory = 230924 (+1024) in kb (Linux) or b (macOS)\r\npeak memory = 231948 (+1024) in kb (Linux) or b (macOS)\r\npeak memory = 232716 (+768) in kb (Linux) or b (macOS)\r\npeak memory = 233740 (+1024) in kb (Linux) or b (macOS)\r\npeak memory = 234764 (+1024) in kb (Linux) or b (macOS)\r\npeak memory = 235788 (+1024) in kb (Linux) or b (macOS)\r\npeak memory = 236556 (+768) in kb (Linux) or b (macOS)\r\npeak memory = 237580 (+1024) in kb (Linux) or b (macOS)\r\n...\r\n```\r\n\r\nOur initial attempt to find a root cause led us to suspect the fact that `is_directory_v2` uses ScopedTFStatus while the rest of the `gfile` API does not (we spot-checked a few other APIs, including `tf.io.gfile.stat()`, and did not see the same issue).\r\n\r\nHere's the code from v2.0.0 (file_io.py was just converted to PyBind11 today so it's possible this actually fixes the issue, but there is not yet a nightly with the change to check):\r\nhttps://github.com/tensorflow/tensorflow/blob/v2.0.0/tensorflow/python/lib/io/file_io.py#L585-L596\r\n\r\nWe attempted to debug further by deconstructing the calls to `isdir()` into the two lines, one that creates `ScopedTFStatus` and one that calls `pywrap_tensorflow.IsDirectory()`, and it seemed to be the case that the memory leak is proportional to the number of times `IsDirectory()` is called with a *distinct* `ScopedTFStatus` pointer (calling it over and over with the same status doesn't seem to leak at a proportional rate; reusing the status here seemed fine for testing this because `IsDirectory()` does not actually touch the status in the codepath for a nonexistent file).  So we suspect maybe there's a weird interaction at the SWIG boundary that results in the leak.\r\n\r\nFurthermore, it also seems to leak when the argument is an existing filename; the repro uses a nonexistent one for simplicity and because that makes the codepath slightly simpler (since then `IsDirectory()` exits early on file nonexistence via the `access()` syscall and never even calls `stat()`).  Also, the leak still occurs when the `gc.collect()` is omitted; it's also just there to isolate possible causes of the leak."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35286", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35286/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35286/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35286/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/35286", "id": 540600821, "node_id": "MDExOlB1bGxSZXF1ZXN0MzU1Mzg4NDc4", "number": 35286, "title": "NFC - minor spelling tweaks under lite directory", "user": {"login": "kiszk", "id": 1315079, "node_id": "MDQ6VXNlcjEzMTUwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1315079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kiszk", "html_url": "https://github.com/kiszk", "followers_url": "https://api.github.com/users/kiszk/followers", "following_url": "https://api.github.com/users/kiszk/following{/other_user}", "gists_url": "https://api.github.com/users/kiszk/gists{/gist_id}", "starred_url": "https://api.github.com/users/kiszk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kiszk/subscriptions", "organizations_url": "https://api.github.com/users/kiszk/orgs", "repos_url": "https://api.github.com/users/kiszk/repos", "events_url": "https://api.github.com/users/kiszk/events{/privacy}", "received_events_url": "https://api.github.com/users/kiszk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1169365682, "node_id": "MDU6TGFiZWwxMTY5MzY1Njgy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:L", "name": "size:L", "color": "adafea", "default": false, "description": "CL Change Size: Large"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 25, "created_at": "2019-12-19T22:07:11Z", "updated_at": "2020-03-18T17:40:44Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/35286", "html_url": "https://github.com/tensorflow/tensorflow/pull/35286", "diff_url": "https://github.com/tensorflow/tensorflow/pull/35286.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/35286.patch"}, "body": "This PR addresses minor spelling tweaks under `tensorflow/lite` directory.\r\nfollow-on of #34958"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35283", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35283/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35283/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35283/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35283", "id": 540582874, "node_id": "MDU6SXNzdWU1NDA1ODI4NzQ=", "number": 35283, "title": "Android TFlite inconsistent performance when app is not in focus.", "user": {"login": "Artaches", "id": 3443179, "node_id": "MDQ6VXNlcjM0NDMxNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/3443179?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Artaches", "html_url": "https://github.com/Artaches", "followers_url": "https://api.github.com/users/Artaches/followers", "following_url": "https://api.github.com/users/Artaches/following{/other_user}", "gists_url": "https://api.github.com/users/Artaches/gists{/gist_id}", "starred_url": "https://api.github.com/users/Artaches/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Artaches/subscriptions", "organizations_url": "https://api.github.com/users/Artaches/orgs", "repos_url": "https://api.github.com/users/Artaches/repos", "events_url": "https://api.github.com/users/Artaches/events{/privacy}", "received_events_url": "https://api.github.com/users/Artaches/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, {"login": "talumbau", "id": 1891418, "node_id": "MDQ6VXNlcjE4OTE0MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/1891418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/talumbau", "html_url": "https://github.com/talumbau", "followers_url": "https://api.github.com/users/talumbau/followers", "following_url": "https://api.github.com/users/talumbau/following{/other_user}", "gists_url": "https://api.github.com/users/talumbau/gists{/gist_id}", "starred_url": "https://api.github.com/users/talumbau/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/talumbau/subscriptions", "organizations_url": "https://api.github.com/users/talumbau/orgs", "repos_url": "https://api.github.com/users/talumbau/repos", "events_url": "https://api.github.com/users/talumbau/events{/privacy}", "received_events_url": "https://api.github.com/users/talumbau/received_events", "type": "User", "site_admin": false}, {"login": "multiverse-tf", "id": 48348070, "node_id": "MDQ6VXNlcjQ4MzQ4MDcw", "avatar_url": "https://avatars0.githubusercontent.com/u/48348070?v=4", "gravatar_id": "", "url": "https://api.github.com/users/multiverse-tf", "html_url": "https://github.com/multiverse-tf", "followers_url": "https://api.github.com/users/multiverse-tf/followers", "following_url": "https://api.github.com/users/multiverse-tf/following{/other_user}", "gists_url": "https://api.github.com/users/multiverse-tf/gists{/gist_id}", "starred_url": "https://api.github.com/users/multiverse-tf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/multiverse-tf/subscriptions", "organizations_url": "https://api.github.com/users/multiverse-tf/orgs", "repos_url": "https://api.github.com/users/multiverse-tf/repos", "events_url": "https://api.github.com/users/multiverse-tf/events{/privacy}", "received_events_url": "https://api.github.com/users/multiverse-tf/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2019-12-19T21:37:37Z", "updated_at": "2020-02-05T16:15:57Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Android 9.0 and 10.0\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: Pixel 3a (Android 10), tested on Android 9 as well with same bad behaviour\r\n- TensorFlow installed from (source or binary):  tflite .so built from source\r\n- TensorFlow version (use command below): 1.13, 1.14, 1.15, 2.0, 2.1\r\n- Bazel version (if compiling from source): various; 0.21 to 0.29\r\n\r\nProblem:\r\nWe have an audio processing application that runs in real time, including when the phone's screen is off. Using the built shared objects (tensorflowlite.so) from r1.13 and r1.14 branches, our processing time stays consistent. Locking the phone or minimizing the app does not affect the tflite inference times. Our app also uses a foreground service to make Android give us optimal process scheduling.\r\n\r\nHowever, when using newer tflite shared objects (.so) built from r1.15, r2.0, and r2.1 the inference performance drops when the app is not in focus (either screen was locked, or our app minimized). The behaviour is especially bad when using more threads, e.g: `interpreter->SetNumThreads(2);`\r\n\r\n**Describe the current behavior**\r\nAndroid tflite model inference times are lower when app is not in focus with tflite versions r1.15, r2.0, r2.1. \r\n**Describe the expected behavior**\r\nExactly the same inference processing performance when the app is in focus or not.\r\n\r\nIs there something in the API of newer tflite versions (r1.15 and newer) that I could play around with to fix this? Any help is greatly appreciated, thank you!\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35277", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35277/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35277/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35277/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35277", "id": 540495884, "node_id": "MDU6SXNzdWU1NDA0OTU4ODQ=", "number": 35277, "title": "TF-Lite Micro: Selectively omit data types at compile-time", "user": {"login": "driedler", "id": 2460221, "node_id": "MDQ6VXNlcjI0NjAyMjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/2460221?v=4", "gravatar_id": "", "url": "https://api.github.com/users/driedler", "html_url": "https://github.com/driedler", "followers_url": "https://api.github.com/users/driedler/followers", "following_url": "https://api.github.com/users/driedler/following{/other_user}", "gists_url": "https://api.github.com/users/driedler/gists{/gist_id}", "starred_url": "https://api.github.com/users/driedler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/driedler/subscriptions", "organizations_url": "https://api.github.com/users/driedler/orgs", "repos_url": "https://api.github.com/users/driedler/repos", "events_url": "https://api.github.com/users/driedler/events{/privacy}", "received_events_url": "https://api.github.com/users/driedler/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-12-19T18:49:23Z", "updated_at": "2020-02-06T16:28:41Z", "closed_at": null, "author_association": "NONE", "body": "My application only requires kTfLiteInt8 kernels.\r\nHowever, kTfLiteFloat32 and kTfLiteUInt8 kernels are also built into the application.\r\n\r\nIt would save a considerable amount of code space if there was a way to disable building in the unused data types, e.g.:\r\n```\r\n  switch (input->type) {  // Already know in/out types are same.\r\n#ifndef TFLITE_FLOAT32_DISABLED\r\n    case kTfLiteFloat32:\r\n      return EvalFloat(context, node, params, &data, input, filter, bias,\r\n                       nullptr, nullptr, output);\r\n      break;\r\n#endif \r\n#infdef TFLITE_INT8_DISABLED\r\n    case kTfLiteInt8:\r\n      return EvalQuantizedPerChannel(context, node, params, &data, input,\r\n                                     filter, bias, output, nullptr);\r\n      break; \r\n#endif \r\n#ifndef TFLITE_UINT8_DISABLED\r\n    case kTfLiteUInt8:\r\n      return EvalQuantized(context, node, params, &data, input, filter, bias,\r\n                           nullptr, nullptr, output);\r\n      break;\r\n#endif\r\n    default:\r\n      context->ReportError(context, \"Type %s (%d) not supported.\",\r\n                           TfLiteTypeGetName(input->type), input->type);\r\n      return kTfLiteError\r\n```\r\n\r\nOr something more elegant ;) \r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35267", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35267/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35267/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35267/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35267", "id": 540417192, "node_id": "MDU6SXNzdWU1NDA0MTcxOTI=", "number": 35267, "title": "Training fails when a multi-output Keras model has one output without a loss function", "user": {"login": "tomwphillips", "id": 715334, "node_id": "MDQ6VXNlcjcxNTMzNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/715334?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tomwphillips", "html_url": "https://github.com/tomwphillips", "followers_url": "https://api.github.com/users/tomwphillips/followers", "following_url": "https://api.github.com/users/tomwphillips/following{/other_user}", "gists_url": "https://api.github.com/users/tomwphillips/gists{/gist_id}", "starred_url": "https://api.github.com/users/tomwphillips/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tomwphillips/subscriptions", "organizations_url": "https://api.github.com/users/tomwphillips/orgs", "repos_url": "https://api.github.com/users/tomwphillips/repos", "events_url": "https://api.github.com/users/tomwphillips/events{/privacy}", "received_events_url": "https://api.github.com/users/tomwphillips/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2019-12-19T16:21:25Z", "updated_at": "2020-02-08T22:27:08Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes, see minimal example.\r\n- OS Platform and Distribution: Ubuntu 18.04.3 LTS\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:  N/A\r\n- TensorFlow installed from (source or binary): binary (specifically, `tensorflow/tensorflow:nightly-py3` Docker image)\r\n- TensorFlow version (use command below): 2.1.0-dev20191216\r\n- Python version: 3.6.9\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source): N/A\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: N/A\r\n\r\n**Describe the current behavior**\r\n\r\nA multi-output Keras model compiled so that one output doesn't have a loss function raises an exception when calling `.fit`.\r\n\r\n**Describe the expected behavior**\r\n\r\nTraining should minimise the losses defined for the other output(s).\r\n\r\n**Code to reproduce the issue**\r\n\r\n```\r\nimport numpy as np\r\nimport tensorflow as tf\r\nimport tensorflow.keras as keras\r\n\r\ninput_a = keras.layers.Input(shape=(10,), name=\"input_a\")\r\ninput_b = keras.layers.Input(shape=(20,), name=\"input_b\")\r\noutput_a = keras.layers.Dense(1, name=\"output_a\")(input_a)\r\noutput_b = keras.layers.Dense(1, name=\"output_b\")(input_b)\r\nmodel = keras.Model(inputs=[input_a, input_b], outputs=[output_a, output_b])\r\nmodel.compile(optimizer=\"sgd\", loss={\"output_a\": None, \"output_b\": \"mse\"})\r\n\r\nn = 128\r\ninput_a = np.ones((n, 10))\r\ninput_b = np.ones((n, 20))\r\noutput_a = np.ones((n, 1))\r\noutput_b = np.ones((n, 1))\r\n\r\ndataset = tf.data.Dataset.from_tensor_slices(\r\n    ((input_a, input_b), (output_a, output_b))\r\n).batch(64)\r\n\r\nmodel.fit(dataset)\r\n```\r\n\r\nRaises:\r\n\r\n```\r\nValueError: Error when checking model target: the list of Numpy arrays that you are passing to your model is not the size the model expected. Expected to see 1 array(s), for inputs ['output_b'] but instead got the following list of 2 arrays: [<tf.Tensor 'args_2:0' shape=(None, 1) dtype=float64>, <tf.Tensor 'args_3:0' shape=(None, 1) dtype=float64>]...\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35261", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35261/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35261/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35261/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/35261", "id": 540348092, "node_id": "MDExOlB1bGxSZXF1ZXN0MzU1MTczNjUx", "number": 35261, "title": "Add legalization for missing ops from LHLO to LinAlg.", "user": {"login": "dfki-ehna", "id": 40604387, "node_id": "MDQ6VXNlcjQwNjA0Mzg3", "avatar_url": "https://avatars2.githubusercontent.com/u/40604387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dfki-ehna", "html_url": "https://github.com/dfki-ehna", "followers_url": "https://api.github.com/users/dfki-ehna/followers", "following_url": "https://api.github.com/users/dfki-ehna/following{/other_user}", "gists_url": "https://api.github.com/users/dfki-ehna/gists{/gist_id}", "starred_url": "https://api.github.com/users/dfki-ehna/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dfki-ehna/subscriptions", "organizations_url": "https://api.github.com/users/dfki-ehna/orgs", "repos_url": "https://api.github.com/users/dfki-ehna/repos", "events_url": "https://api.github.com/users/dfki-ehna/events{/privacy}", "received_events_url": "https://api.github.com/users/dfki-ehna/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1169365682, "node_id": "MDU6TGFiZWwxMTY5MzY1Njgy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:L", "name": "size:L", "color": "adafea", "default": false, "description": "CL Change Size: Large"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-12-19T14:29:29Z", "updated_at": "2020-02-25T06:22:08Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/35261", "html_url": "https://github.com/tensorflow/tensorflow/pull/35261", "diff_url": "https://github.com/tensorflow/tensorflow/pull/35261.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/35261.patch"}, "body": ""}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35257", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35257/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35257/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35257/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35257", "id": 540232067, "node_id": "MDU6SXNzdWU1NDAyMzIwNjc=", "number": 35257, "title": "tensorflow 2.0 tf.linalg.normalize yields nan", "user": {"login": "hyperji", "id": 10097511, "node_id": "MDQ6VXNlcjEwMDk3NTEx", "avatar_url": "https://avatars3.githubusercontent.com/u/10097511?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hyperji", "html_url": "https://github.com/hyperji", "followers_url": "https://api.github.com/users/hyperji/followers", "following_url": "https://api.github.com/users/hyperji/following{/other_user}", "gists_url": "https://api.github.com/users/hyperji/gists{/gist_id}", "starred_url": "https://api.github.com/users/hyperji/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hyperji/subscriptions", "organizations_url": "https://api.github.com/users/hyperji/orgs", "repos_url": "https://api.github.com/users/hyperji/repos", "events_url": "https://api.github.com/users/hyperji/events{/privacy}", "received_events_url": "https://api.github.com/users/hyperji/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}, {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-12-19T10:44:32Z", "updated_at": "2020-03-05T18:18:42Z", "closed_at": null, "author_association": "NONE", "body": "### tf.linalg.normalize(np.zeros([10, 4]), ord=1, axis=-1) yields nan as below\r\n\r\n(<tf.Tensor: id=58, shape=(10, 4), dtype=float64, numpy=\r\n array([[nan, nan, nan, nan],\r\n        [nan, nan, nan, nan],\r\n        [nan, nan, nan, nan],\r\n        [nan, nan, nan, nan],\r\n        [nan, nan, nan, nan],\r\n        [nan, nan, nan, nan],\r\n        [nan, nan, nan, nan],\r\n        [nan, nan, nan, nan],\r\n        [nan, nan, nan, nan],\r\n        [nan, nan, nan, nan]])>,\r\n <tf.Tensor: id=57, shape=(10, 1), dtype=float64, numpy=\r\n array([[0.],\r\n        [0.],\r\n        [0.],\r\n        [0.],\r\n        [0.],\r\n        [0.],\r\n        [0.],\r\n        [0.],\r\n        [0.],\r\n        [0.]])>)\r\n\r\n\r\n* I know this is caused by divide by 0, so in the future tensorflow should make this operation more numerically stable. "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35253", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35253/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35253/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35253/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35253", "id": 540123662, "node_id": "MDU6SXNzdWU1NDAxMjM2NjI=", "number": 35253, "title": "tensorflow build fails", "user": {"login": "FranzBl", "id": 44602645, "node_id": "MDQ6VXNlcjQ0NjAyNjQ1", "avatar_url": "https://avatars3.githubusercontent.com/u/44602645?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FranzBl", "html_url": "https://github.com/FranzBl", "followers_url": "https://api.github.com/users/FranzBl/followers", "following_url": "https://api.github.com/users/FranzBl/following{/other_user}", "gists_url": "https://api.github.com/users/FranzBl/gists{/gist_id}", "starred_url": "https://api.github.com/users/FranzBl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FranzBl/subscriptions", "organizations_url": "https://api.github.com/users/FranzBl/orgs", "repos_url": "https://api.github.com/users/FranzBl/repos", "events_url": "https://api.github.com/users/FranzBl/events{/privacy}", "received_events_url": "https://api.github.com/users/FranzBl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1188421838, "node_id": "MDU6TGFiZWwxMTg4NDIxODM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:windows", "name": "subtype:windows", "color": "b619ea", "default": false, "description": "Windows Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-12-19T07:10:04Z", "updated_at": "2020-02-06T13:31:02Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform Windows 10 Pro\r\n- desktop computer:\r\n- TensorFlow installed from source\r\n- TensorFlow version: 2.0\r\n- Python version: 3.7\r\n- Installed using virtualenv? pip? conda?: installed via command line / git clone etc.\r\n- Bazel version (if compiling from source): 1.1.0\r\n- GCC/Compiler version (if compiling from source): Visual Studio 2017 Redistributables\r\n- CUDA/cuDNN version: --- (ROCm selected)\r\n- GPU model and memory:  AMD FX-8800P R7\r\n\r\nBuild fails, see listing below.\r\n\r\nC:\\Users\\Bludorf\\tensorflow>python ./configure.py\r\nWARNING: Running Bazel server needs to be killed, because the startup options are different.\r\nWARNING: Waiting for server process to terminate (waited 5 seconds, waiting at most 60)\r\nWARNING: Waiting for server process to terminate (waited 10 seconds, waiting at most 60)\r\nWARNING: --batch mode is deprecated. Please instead explicitly shut down your Bazel server using the command \"bazel shutdown\".\r\nYou have bazel 1.1.0 installed.\r\nPlease specify the location of python. [Default is C:\\Users\\Bludorf\\AppData\\Local\\Programs\\Python\\Python37\\python.exe]: \r\n\r\n\r\nFound possible Python library paths:\r\n  C:\\Users\\Bludorf\\AppData\\Local\\Programs\\Python\\Python37\\lib\\site-packages\r\nPlease input the desired Python library path to use.  Default is [C:\\Users\\Bludorf\\AppData\\Local\\Programs\\Python\\Python37\\lib\\site-packages]\r\n\r\nDo you wish to build TensorFlow with XLA JIT support? [y/N]: y\r\nXLA JIT support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with ROCm support? [y/N]: y\r\nROCm support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with CUDA support? [y/N]: N\r\nNo CUDA support will be enabled for TensorFlow.\r\n\r\nPlease specify optimization flags to use during compilation when bazel option \"--config=opt\" is specified [Default is /arch:AVX]:\r\n\r\n\r\nWould you like to override eigen strong inline for some C++ compilation to reduce the compilation time? [Y/n]: Y\r\nEigen strong inline overridden.\r\n\r\nPreconfigured Bazel build configs. You can use any of the below by adding \"--config=<>\" to your build command. See .bazelrc for more details.\r\n        --config=mkl            # Build with MKL support.\r\n        --config=monolithic     # Config for mostly static monolithic build.\r\n        --config=ngraph         # Build with Intel nGraph support.\r\n        --config=numa           # Build with NUMA support.\r\n        --config=dynamic_kernels        # (Experimental) Build kernels into separate shared objects.\r\n        --config=v2             # Build TensorFlow 2.x instead of 1.x.\r\nPreconfigured Bazel build configs to DISABLE default on features:\r\n        --config=noaws          # Disable AWS S3 filesystem support.\r\n        --config=nogcp          # Disable GCP support.\r\n        --config=nohdfs         # Disable HDFS support.\r\n        --config=nonccl         # Disable NVIDIA NCCL support.\r\n\r\nC:\\Users\\Bludorf\\tensorflow>bazel build --config=v2 //tensorflow/tools/pip_package:build_pip_package\r\nStarting local Bazel server and connecting to it...\r\nWARNING: The following configs were expanded more than once: [v2]. For repeatable flags, repeats are counted twice and may lead to unexpected behavior.\r\nINFO: Writing tracer profile to 'C:/users/bludorf/_bazel_bludorf/jkbqqwso/command.profile.gz'\r\nINFO: Options provided by the client:\r\n  Inherited 'common' options: --isatty=1 --terminal_columns=120\r\nINFO: Options provided by the client:\r\n  'build' options: --python_path=C:/Users/Bludorf/AppData/Local/Programs/Python/Python37/python.exe\r\nINFO: Reading rc options for 'build' from c:\\users\\bludorf\\tensorflow\\.bazelrc:\r\n  'build' options: --apple_platform_type=macos --define framework_shared_object=true --define open_source_build=true --java_toolchain=//third_party/toolchains/java:tf_java_toolchain --host_java_toolchain=//third_party/toolchains/java:tf_java_toolchain --define=use_fast_cpp_protos=true --define=allow_oversize_protos=true --spawn_strategy=standalone -c opt --announce_rc --define=grpc_no_ares=true --noincompatible_remove_legacy_whole_archive --enable_platform_specific_config --config=v2\r\nINFO: Reading rc options for 'build' from c:\\users\\bludorf\\tensorflow\\.tf_configure.bazelrc:\r\n  'build' options: --action_env PYTHON_BIN_PATH=C:/Users/Bludorf/AppData/Local/Programs/Python/Python37/python.exe --action_env PYTHON_LIB_PATH=C:/Users/Bludorf/AppData/Local/Programs/Python/Python37/lib/site-packages --python_path=C:/Users/Bludorf/AppData/Local/Programs/Python/Python37/python.exe --config=xla --config=rocm --define=override_eigen_strong_inline=true --action_env TF_CONFIGURE_IOS=0\r\nINFO: Found applicable config definition build:v2 in file c:\\users\\bludorf\\tensorflow\\.bazelrc: --define=tf_api_version=2 --action_env=TF2_BEHAVIOR=1\r\nINFO: Found applicable config definition build:xla in file c:\\users\\bludorf\\tensorflow\\.bazelrc: --action_env=TF_ENABLE_XLA=1 --define=with_xla_support=true\r\nINFO: Found applicable config definition build:xla in file c:\\users\\bludorf\\tensorflow\\.tf_configure.bazelrc: --define with_xla_support=true\r\nINFO: Found applicable config definition build:rocm in file c:\\users\\bludorf\\tensorflow\\.bazelrc: --crosstool_top=@local_config_rocm//crosstool:toolchain --define=using_rocm=true --define=using_rocm_hipcc=true --action_env TF_NEED_ROCM=1\r\nINFO: Found applicable config definition build:v2 in file c:\\users\\bludorf\\tensorflow\\.bazelrc: --define=tf_api_version=2 --action_env=TF2_BEHAVIOR=1\r\nINFO: Found applicable config definition build:windows in file c:\\users\\bludorf\\tensorflow\\.bazelrc: --copt=/w --cxxopt=/std:c++14 --host_cxxopt=/std:c++14 --config=monolithic --copt=-DWIN32_LEAN_AND_MEAN --host_copt=-DWIN32_LEAN_AND_MEAN --copt=-DNOGDI --host_copt=-DNOGDI --linkopt=/DEBUG --host_linkopt=/DEBUG --linkopt=/OPT:REF --host_linkopt=/OPT:REF --linkopt=/OPT:ICF --host_linkopt=/OPT:ICF --experimental_strict_action_env=true --incompatible_windows_native_test_wrapper --verbose_failures --distinct_host_configuration=false\r\nINFO: Found applicable config definition build:monolithic in file c:\\users\\bludorf\\tensorflow\\.bazelrc: --define framework_shared_object=false\r\nINFO: Call stack for the definition of repository 'io_bazel_rules_docker' which is a git_repository (rule definition at C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_tools/tools/build_defs/repo/git.bzl:195:18):\r\n - C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_toolchains/repositories/repositories.bzl:37:9\r\n - C:/users/bludorf/tensorflow/WORKSPACE:37:1\r\nERROR: An error occurred during the fetch of repository 'io_bazel_rules_docker':\r\n   Traceback (most recent call last):\r\n        File \"C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_tools/tools/build_defs/repo/git.bzl\", line 177\r\n                _clone_or_update(ctx)\r\n        File \"C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_tools/tools/build_defs/repo/git.bzl\", line 36, in _clone_or_update\r\n                git_repo(ctx, directory)\r\n        File \"C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_tools/tools/build_defs/repo/git_worker.bzl\", line 91, in git_repo\r\n                _update(ctx, git_repo)\r\n        File \"C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_tools/tools/build_defs/repo/git_worker.bzl\", line 101, in _update\r\n                init(ctx, git_repo)\r\n        File \"C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_tools/tools/build_defs/repo/git_worker.bzl\", line 115, in init\r\n                _error(ctx.name, cl, st.stderr)\r\n        File \"C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_tools/tools/build_defs/repo/git_worker.bzl\", line 181, in _error\r\n                fail(<1 more arguments>)\r\nerror running 'git init C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/io_bazel_rules_docker' while working with @io_bazel_rules_docker:\r\njava.io.IOException: ERROR: src/main/native/windows/process.cc(199): CreateProcessW(\"git\" init C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/io_bazel_rules_docker): Das System kann die angegebene Datei nicht finden.\r\n (error: 2)\r\nERROR: no such package '@io_bazel_rules_docker//repositories': Traceback (most recent call last):\r\n        File \"C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_tools/tools/build_defs/repo/git.bzl\", line 177\r\n                _clone_or_update(ctx)\r\n        File \"C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_tools/tools/build_defs/repo/git.bzl\", line 36, in _clone_or_update\r\n                git_repo(ctx, directory)\r\n        File \"C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_tools/tools/build_defs/repo/git_worker.bzl\", line 91, in git_repo\r\n                _update(ctx, git_repo)\r\n        File \"C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_tools/tools/build_defs/repo/git_worker.bzl\", line 101, in _update\r\n                init(ctx, git_repo)\r\n        File \"C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_tools/tools/build_defs/repo/git_worker.bzl\", line 115, in init\r\n                _error(ctx.name, cl, st.stderr)\r\n        File \"C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_tools/tools/build_defs/repo/git_worker.bzl\", line 181, in _error\r\n                fail(<1 more arguments>)\r\nerror running 'git init C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/io_bazel_rules_docker' while working with @io_bazel_rules_docker:\r\njava.io.IOException: ERROR: src/main/native/windows/process.cc(199): CreateProcessW(\"git\" init C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/io_bazel_rules_docker): Das System kann die angegebene Datei nicht finden.\r\n (error: 2)\r\nERROR: no such package '@io_bazel_rules_docker//repositories': Traceback (most recent call last):\r\n        File \"C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_tools/tools/build_defs/repo/git.bzl\", line 177\r\n                _clone_or_update(ctx)\r\n        File \"C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_tools/tools/build_defs/repo/git.bzl\", line 36, in _clone_or_update\r\n                git_repo(ctx, directory)\r\n        File \"C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_tools/tools/build_defs/repo/git_worker.bzl\", line 91, in git_repo\r\n                _update(ctx, git_repo)\r\n        File \"C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_tools/tools/build_defs/repo/git_worker.bzl\", line 101, in _update\r\n                init(ctx, git_repo)\r\n        File \"C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_tools/tools/build_defs/repo/git_worker.bzl\", line 115, in init\r\n                _error(ctx.name, cl, st.stderr)\r\n        File \"C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/bazel_tools/tools/build_defs/repo/git_worker.bzl\", line 181, in _error\r\n                fail(<1 more arguments>)\r\nerror running 'git init C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/io_bazel_rules_docker' while working with @io_bazel_rules_docker:\r\njava.io.IOException: ERROR: src/main/native/windows/process.cc(199): CreateProcessW(\"git\" init C:/users/bludorf/_bazel_bludorf/jkbqqwso/external/io_bazel_rules_docker): Das System kann die angegebene Datei nicht finden.\r\n (error: 2)\r\nINFO: Elapsed time: 7.563s\r\nINFO: 0 processes.\r\nFAILED: Build did NOT complete successfully (0 packages loaded)\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35250", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35250/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35250/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35250/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35250", "id": 540077862, "node_id": "MDU6SXNzdWU1NDAwNzc4NjI=", "number": 35250, "title": "Converting to TFLite: Invalid quantization params for op MAXIMUM at index 4 in subgraph 0", "user": {"login": "gasgallo", "id": 36033044, "node_id": "MDQ6VXNlcjM2MDMzMDQ0", "avatar_url": "https://avatars3.githubusercontent.com/u/36033044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gasgallo", "html_url": "https://github.com/gasgallo", "followers_url": "https://api.github.com/users/gasgallo/followers", "following_url": "https://api.github.com/users/gasgallo/following{/other_user}", "gists_url": "https://api.github.com/users/gasgallo/gists{/gist_id}", "starred_url": "https://api.github.com/users/gasgallo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gasgallo/subscriptions", "organizations_url": "https://api.github.com/users/gasgallo/orgs", "repos_url": "https://api.github.com/users/gasgallo/repos", "events_url": "https://api.github.com/users/gasgallo/events{/privacy}", "received_events_url": "https://api.github.com/users/gasgallo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-12-19T04:57:35Z", "updated_at": "2019-12-19T11:36:53Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (or github SHA if from source): 1.15.0-gpu\r\n\r\n\r\n**Command used to run the converter or code if you\u2019re using the Python API**\r\n\r\n```\r\nimport os\r\n\r\nimport tensorflow as tf\r\nimport numpy as np\r\nfrom PIL import Image\r\n\r\n\r\ndataset = []\r\ndirectory_images = './data_test'\r\ndirectory_saved = './models'\r\nfor img in os.listdir(directory_images):\r\n\tdata = Image.open(os.path.join(directory_images,img)))\r\n\tdata = np.asarray(data, dtype=np.float32)[np.newaxis, :]\r\n\tdataset.append(data)\r\n\r\ndef representative_dataset_gen():\r\n    for input_value in dataset:\r\n        yield [input_value]\r\n\r\nconverter = tf.lite.TFLiteConverter.from_saved_model(directory_saved + \"/saved\")\r\nconverter.optimizations = [tf.lite.Optimize.DEFAULT]\r\nconverter.representative_dataset = representative_dataset_gen\r\nconverter.target_spec.supported_ops = [tf.lite.OpsSet.TFLITE_BUILTINS_INT8]\r\nconverter.inference_input_type = tf.uint8\r\nconverter.inference_output_type = tf.uint8\r\n\r\ntflite_model = converter.convert()\r\n\r\nname = directory_saved + \"/tflite_model\"\r\nopen(name + \".tflite\", \"wb\").write(tflite_model)\r\n```\r\n\r\n**The output from the converter invocation**\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"saved2lite.py\", line 34, in <module>\r\n    tflite_model = converter.convert()\r\n  File \"/home/ds017/.pyenv/versions/takehome/lib/python3.6/site-packages/tensorflow_core/lite/python/lite.py\", line 993, in convert\r\n    inference_output_type)\r\n  File \"/home/ds017/.pyenv/versions/takehome/lib/python3.6/site-packages/tensorflow_core/lite/python/lite.py\", line 239, in _calibrate_quantize_model\r\n    inference_output_type, allow_float)\r\n  File \"/home/ds017/.pyenv/versions/takehome/lib/python3.6/site-packages/tensorflow_core/lite/python/optimize/calibrator.py\", line 78, in calibrate_and_quantize\r\n    np.dtype(output_type.as_numpy_dtype()).num, allow_float)\r\n  File \"/home/ds017/.pyenv/versions/takehome/lib/python3.6/site-packages/tensorflow_core/lite/python/optimize/tensorflow_lite_wrap_calibration_wrapper.py\", line 115, in QuantizeModel\r\n    return _tensorflow_lite_wrap_calibration_wrapper.CalibrationWrapper_QuantizeModel(self, input_py_type, output_py_type, allow_float)\r\nRuntimeError: Invalid quantization params for op MAXIMUM at index 4 in subgraph 0\r\n```\r\n\r\n**Also, please include a link to the saved model or GraphDef**\r\n\r\n```\r\nhttps://www.dropbox.com/s/tj96fsm6t6rq8ye/model-r100-arcface-ms1m-refine-v2.zip?dl=0\r\n```\r\n\r\n**Failure details**\r\nConversion fails.\r\n\r\n\r\n**Any other info / logs**\r\nFull log:\r\n```\r\n2019-12-19 11:49:10.789835: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1\r\n2019-12-19 11:49:10.810583: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:10.811068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: \r\nname: GeForce GTX 1050 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.392\r\npciBusID: 0000:01:00.0\r\n2019-12-19 11:49:10.811245: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0\r\n2019-12-19 11:49:10.812226: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0\r\n2019-12-19 11:49:10.813094: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0\r\n2019-12-19 11:49:10.813351: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0\r\n2019-12-19 11:49:10.814559: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0\r\n2019-12-19 11:49:10.815596: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0\r\n2019-12-19 11:49:10.817880: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7\r\n2019-12-19 11:49:10.818002: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:10.818618: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:10.819072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0\r\n2019-12-19 11:49:10.819465: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2019-12-19 11:49:10.843162: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3408000000 Hz\r\n2019-12-19 11:49:10.843971: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55724cd4c080 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n2019-12-19 11:49:10.844031: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\n2019-12-19 11:49:10.926515: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:10.927095: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55724cdae1a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:\r\n2019-12-19 11:49:10.927112: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce GTX 1050 Ti, Compute Capability 6.1\r\n2019-12-19 11:49:10.927282: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:10.927748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: \r\nname: GeForce GTX 1050 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.392\r\npciBusID: 0000:01:00.0\r\n2019-12-19 11:49:10.927774: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0\r\n2019-12-19 11:49:10.927782: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0\r\n2019-12-19 11:49:10.927790: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0\r\n2019-12-19 11:49:10.927797: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0\r\n2019-12-19 11:49:10.927804: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0\r\n2019-12-19 11:49:10.927811: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0\r\n2019-12-19 11:49:10.927819: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7\r\n2019-12-19 11:49:10.927857: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:10.928283: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:10.928683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0\r\n2019-12-19 11:49:10.928703: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0\r\n2019-12-19 11:49:10.929442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2019-12-19 11:49:10.929452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 \r\n2019-12-19 11:49:10.929458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N \r\n2019-12-19 11:49:10.929674: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:10.930285: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:10.930708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2934 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1050 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\nWARNING:tensorflow:From /home/ds017/.pyenv/versions/takehome/lib/python3.6/site-packages/tensorflow_core/lite/python/convert_saved_model.py:60: load (from tensorflow.python.saved_model.loader_impl) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nThis function will only be available through the v1 compatibility library as tf.compat.v1.saved_model.loader.load or tf.compat.v1.saved_model.load. There will be a new function for importing SavedModels in Tensorflow 2.0.\r\n2019-12-19 11:49:13.849255: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:13.849669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: \r\nname: GeForce GTX 1050 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.392\r\npciBusID: 0000:01:00.0\r\n2019-12-19 11:49:13.849711: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0\r\n2019-12-19 11:49:13.849721: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0\r\n2019-12-19 11:49:13.849729: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0\r\n2019-12-19 11:49:13.849737: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0\r\n2019-12-19 11:49:13.849744: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0\r\n2019-12-19 11:49:13.849752: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0\r\n2019-12-19 11:49:13.849759: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7\r\n2019-12-19 11:49:13.849796: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:13.850140: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:13.850456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0\r\n2019-12-19 11:49:13.850478: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2019-12-19 11:49:13.850484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 \r\n2019-12-19 11:49:13.850488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N \r\n2019-12-19 11:49:13.850595: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:13.850985: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:13.851332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2934 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1050 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n2019-12-19 11:49:16.749682: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:16.750076: I tensorflow/core/grappler/devices.cc:55] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0\r\n2019-12-19 11:49:16.750135: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2019-12-19 11:49:16.750521: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:16.750902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: \r\nname: GeForce GTX 1050 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.392\r\npciBusID: 0000:01:00.0\r\n2019-12-19 11:49:16.750927: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0\r\n2019-12-19 11:49:16.750936: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0\r\n2019-12-19 11:49:16.750945: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0\r\n2019-12-19 11:49:16.750952: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0\r\n2019-12-19 11:49:16.750959: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0\r\n2019-12-19 11:49:16.750966: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0\r\n2019-12-19 11:49:16.750974: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7\r\n2019-12-19 11:49:16.751007: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:16.751348: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:16.751663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0\r\n2019-12-19 11:49:16.751682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2019-12-19 11:49:16.751688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 \r\n2019-12-19 11:49:16.751692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N \r\n2019-12-19 11:49:16.751831: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:16.752173: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:16.752495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2934 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1050 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n2019-12-19 11:49:17.182263: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:786] Optimization results for grappler item: graph_to_optimize\r\n2019-12-19 11:49:17.182289: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:788]   function_optimizer: function_optimizer did nothing. time = 0.003ms.\r\n2019-12-19 11:49:17.182737: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:788]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\nWARNING:tensorflow:From /home/ds017/.pyenv/versions/takehome/lib/python3.6/site-packages/tensorflow_core/lite/python/util.py:249: convert_variables_to_constants (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse `tf.compat.v1.graph_util.convert_variables_to_constants`\r\nWARNING:tensorflow:From /home/ds017/.pyenv/versions/takehome/lib/python3.6/site-packages/tensorflow_core/python/framework/graph_util_impl.py:277: extract_sub_graph (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse `tf.compat.v1.graph_util.extract_sub_graph`\r\n2019-12-19 11:49:18.713005: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:18.713562: I tensorflow/core/grappler/devices.cc:55] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0\r\n2019-12-19 11:49:18.713618: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2019-12-19 11:49:18.714027: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:18.714386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: \r\nname: GeForce GTX 1050 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.392\r\npciBusID: 0000:01:00.0\r\n2019-12-19 11:49:18.714424: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0\r\n2019-12-19 11:49:18.714433: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0\r\n2019-12-19 11:49:18.714441: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0\r\n2019-12-19 11:49:18.714448: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0\r\n2019-12-19 11:49:18.714455: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0\r\n2019-12-19 11:49:18.714462: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0\r\n2019-12-19 11:49:18.714470: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7\r\n2019-12-19 11:49:18.714501: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:18.714882: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:18.715214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0\r\n2019-12-19 11:49:18.715235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2019-12-19 11:49:18.715242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 \r\n2019-12-19 11:49:18.715261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N \r\n2019-12-19 11:49:18.715411: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:18.715760: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2019-12-19 11:49:18.716119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2934 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1050 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n2019-12-19 11:49:20.750755: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:786] Optimization results for grappler item: graph_to_optimize\r\n2019-12-19 11:49:20.750831: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:788]   constant_folding: Graph size after: 1230 nodes (-2206), 1329 edges (-2360), time = 1332.40198ms.\r\n2019-12-19 11:49:20.750850: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:788]   constant_folding: Graph size after: 1230 nodes (0), 1329 edges (0), time = 370.552ms.\r\nTraceback (most recent call last):\r\n  File \"saved2lite.py\", line 34, in <module>\r\n    tflite_model = converter.convert()\r\n  File \"/home/ds017/.pyenv/versions/takehome/lib/python3.6/site-packages/tensorflow_core/lite/python/lite.py\", line 993, in convert\r\n    inference_output_type)\r\n  File \"/home/ds017/.pyenv/versions/takehome/lib/python3.6/site-packages/tensorflow_core/lite/python/lite.py\", line 239, in _calibrate_quantize_model\r\n    inference_output_type, allow_float)\r\n  File \"/home/ds017/.pyenv/versions/takehome/lib/python3.6/site-packages/tensorflow_core/lite/python/optimize/calibrator.py\", line 78, in calibrate_and_quantize\r\n    np.dtype(output_type.as_numpy_dtype()).num, allow_float)\r\n  File \"/home/ds017/.pyenv/versions/takehome/lib/python3.6/site-packages/tensorflow_core/lite/python/optimize/tensorflow_lite_wrap_calibration_wrapper.py\", line 115, in QuantizeModel\r\n    return _tensorflow_lite_wrap_calibration_wrapper.CalibrationWrapper_QuantizeModel(self, input_py_type, output_py_type, allow_float)\r\nRuntimeError: Invalid quantization params for op MAXIMUM at index 4 in subgraph 0\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35248", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35248/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35248/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35248/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35248", "id": 540070763, "node_id": "MDU6SXNzdWU1NDAwNzA3NjM=", "number": 35248, "title": "Flag --incompatible_restrict_string_escapes will break TensorFlow in Bazel 1.2.1", "user": {"login": "bazel-flag-bot", "id": 58891217, "node_id": "MDQ6VXNlcjU4ODkxMjE3", "avatar_url": "https://avatars0.githubusercontent.com/u/58891217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bazel-flag-bot", "html_url": "https://github.com/bazel-flag-bot", "followers_url": "https://api.github.com/users/bazel-flag-bot/followers", "following_url": "https://api.github.com/users/bazel-flag-bot/following{/other_user}", "gists_url": "https://api.github.com/users/bazel-flag-bot/gists{/gist_id}", "starred_url": "https://api.github.com/users/bazel-flag-bot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bazel-flag-bot/subscriptions", "organizations_url": "https://api.github.com/users/bazel-flag-bot/orgs", "repos_url": "https://api.github.com/users/bazel-flag-bot/repos", "events_url": "https://api.github.com/users/bazel-flag-bot/events{/privacy}", "received_events_url": "https://api.github.com/users/bazel-flag-bot/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-12-19T04:33:55Z", "updated_at": "2019-12-19T04:33:55Z", "closed_at": null, "author_association": "NONE", "body": "Incompatible flag --incompatible_restrict_string_escapes will break TensorFlow once Bazel 1.2.1 is released.\n\nPlease see the following CI builds for more information:\n\n* [:darwin: (OpenJDK 8)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#042f4c72-2a23-4d7b-9d3b-d78619ea3fc7\" target=\"_blank\">:darwin: (OpenJDK 8)</a>)\n* [:windows: (OpenJDK 8)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#65246ccf-c676-40de-b693-3e1408052faa\" target=\"_blank\">:windows: (OpenJDK 8)</a>)\n* [:ubuntu: 18.04 (OpenJDK 11)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#42574ec2-097a-4fa6-9c82-5de0093a2ed1\" target=\"_blank\">:ubuntu: 18.04 (OpenJDK 11)</a>)\n\nQuestions? Please file an issue in https://github.com/bazelbuild/continuous-integration\n\n**Important**: Please do NOT modify the issue title since that might break our tools.\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35247", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35247/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35247/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35247/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35247", "id": 540070542, "node_id": "MDU6SXNzdWU1NDAwNzA1NDI=", "number": 35247, "title": "Flag --incompatible_use_platforms_repo_for_constraints will break TensorFlow in Bazel 1.2.1", "user": {"login": "bazel-flag-bot", "id": 58891217, "node_id": "MDQ6VXNlcjU4ODkxMjE3", "avatar_url": "https://avatars0.githubusercontent.com/u/58891217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bazel-flag-bot", "html_url": "https://github.com/bazel-flag-bot", "followers_url": "https://api.github.com/users/bazel-flag-bot/followers", "following_url": "https://api.github.com/users/bazel-flag-bot/following{/other_user}", "gists_url": "https://api.github.com/users/bazel-flag-bot/gists{/gist_id}", "starred_url": "https://api.github.com/users/bazel-flag-bot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bazel-flag-bot/subscriptions", "organizations_url": "https://api.github.com/users/bazel-flag-bot/orgs", "repos_url": "https://api.github.com/users/bazel-flag-bot/repos", "events_url": "https://api.github.com/users/bazel-flag-bot/events{/privacy}", "received_events_url": "https://api.github.com/users/bazel-flag-bot/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-12-19T04:33:19Z", "updated_at": "2019-12-19T04:33:19Z", "closed_at": null, "author_association": "NONE", "body": "Incompatible flag --incompatible_use_platforms_repo_for_constraints will break TensorFlow once Bazel 1.2.1 is released.\n\nPlease see the following CI builds for more information:\n\n* [:darwin: (OpenJDK 8)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#042f4c72-2a23-4d7b-9d3b-d78619ea3fc7\" target=\"_blank\">:darwin: (OpenJDK 8)</a>)\n* [:windows: (OpenJDK 8)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#65246ccf-c676-40de-b693-3e1408052faa\" target=\"_blank\">:windows: (OpenJDK 8)</a>)\n* [:ubuntu: 18.04 (OpenJDK 11)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#42574ec2-097a-4fa6-9c82-5de0093a2ed1\" target=\"_blank\">:ubuntu: 18.04 (OpenJDK 11)</a>)\n\nQuestions? Please file an issue in https://github.com/bazelbuild/continuous-integration\n\n**Important**: Please do NOT modify the issue title since that might break our tools.\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35246", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35246/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35246/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35246/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35246", "id": 540070232, "node_id": "MDU6SXNzdWU1NDAwNzAyMzI=", "number": 35246, "title": "Flag --incompatible_load_cc_rules_from_bzl will break TensorFlow in Bazel 1.2.1", "user": {"login": "bazel-flag-bot", "id": 58891217, "node_id": "MDQ6VXNlcjU4ODkxMjE3", "avatar_url": "https://avatars0.githubusercontent.com/u/58891217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bazel-flag-bot", "html_url": "https://github.com/bazel-flag-bot", "followers_url": "https://api.github.com/users/bazel-flag-bot/followers", "following_url": "https://api.github.com/users/bazel-flag-bot/following{/other_user}", "gists_url": "https://api.github.com/users/bazel-flag-bot/gists{/gist_id}", "starred_url": "https://api.github.com/users/bazel-flag-bot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bazel-flag-bot/subscriptions", "organizations_url": "https://api.github.com/users/bazel-flag-bot/orgs", "repos_url": "https://api.github.com/users/bazel-flag-bot/repos", "events_url": "https://api.github.com/users/bazel-flag-bot/events{/privacy}", "received_events_url": "https://api.github.com/users/bazel-flag-bot/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-12-19T04:32:29Z", "updated_at": "2019-12-19T04:32:29Z", "closed_at": null, "author_association": "NONE", "body": "Incompatible flag --incompatible_load_cc_rules_from_bzl will break TensorFlow once Bazel 1.2.1 is released.\n\nPlease see the following CI builds for more information:\n\n* [:darwin: (OpenJDK 8)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#042f4c72-2a23-4d7b-9d3b-d78619ea3fc7\" target=\"_blank\">:darwin: (OpenJDK 8)</a>)\n* [:windows: (OpenJDK 8)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#65246ccf-c676-40de-b693-3e1408052faa\" target=\"_blank\">:windows: (OpenJDK 8)</a>)\n* [:ubuntu: 18.04 (OpenJDK 11)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#42574ec2-097a-4fa6-9c82-5de0093a2ed1\" target=\"_blank\">:ubuntu: 18.04 (OpenJDK 11)</a>)\n\nQuestions? Please file an issue in https://github.com/bazelbuild/continuous-integration\n\n**Important**: Please do NOT modify the issue title since that might break our tools.\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35245", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35245/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35245/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35245/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35245", "id": 540070026, "node_id": "MDU6SXNzdWU1NDAwNzAwMjY=", "number": 35245, "title": "Flag --incompatible_disable_target_provider_fields will break TensorFlow in Bazel 1.2.1", "user": {"login": "bazel-flag-bot", "id": 58891217, "node_id": "MDQ6VXNlcjU4ODkxMjE3", "avatar_url": "https://avatars0.githubusercontent.com/u/58891217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bazel-flag-bot", "html_url": "https://github.com/bazel-flag-bot", "followers_url": "https://api.github.com/users/bazel-flag-bot/followers", "following_url": "https://api.github.com/users/bazel-flag-bot/following{/other_user}", "gists_url": "https://api.github.com/users/bazel-flag-bot/gists{/gist_id}", "starred_url": "https://api.github.com/users/bazel-flag-bot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bazel-flag-bot/subscriptions", "organizations_url": "https://api.github.com/users/bazel-flag-bot/orgs", "repos_url": "https://api.github.com/users/bazel-flag-bot/repos", "events_url": "https://api.github.com/users/bazel-flag-bot/events{/privacy}", "received_events_url": "https://api.github.com/users/bazel-flag-bot/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-12-19T04:31:56Z", "updated_at": "2019-12-19T04:31:56Z", "closed_at": null, "author_association": "NONE", "body": "Incompatible flag --incompatible_disable_target_provider_fields will break TensorFlow once Bazel 1.2.1 is released.\n\nPlease see the following CI builds for more information:\n\n* [:darwin: (OpenJDK 8)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#042f4c72-2a23-4d7b-9d3b-d78619ea3fc7\" target=\"_blank\">:darwin: (OpenJDK 8)</a>)\n* [:windows: (OpenJDK 8)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#65246ccf-c676-40de-b693-3e1408052faa\" target=\"_blank\">:windows: (OpenJDK 8)</a>)\n* [:ubuntu: 18.04 (OpenJDK 11)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#42574ec2-097a-4fa6-9c82-5de0093a2ed1\" target=\"_blank\">:ubuntu: 18.04 (OpenJDK 11)</a>)\n\nQuestions? Please file an issue in https://github.com/bazelbuild/continuous-integration\n\n**Important**: Please do NOT modify the issue title since that might break our tools.\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35244", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35244/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35244/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35244/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35244", "id": 540069845, "node_id": "MDU6SXNzdWU1NDAwNjk4NDU=", "number": 35244, "title": "Flag --incompatible_no_implicit_file_export will break TensorFlow in Bazel 1.2.1", "user": {"login": "bazel-flag-bot", "id": 58891217, "node_id": "MDQ6VXNlcjU4ODkxMjE3", "avatar_url": "https://avatars0.githubusercontent.com/u/58891217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bazel-flag-bot", "html_url": "https://github.com/bazel-flag-bot", "followers_url": "https://api.github.com/users/bazel-flag-bot/followers", "following_url": "https://api.github.com/users/bazel-flag-bot/following{/other_user}", "gists_url": "https://api.github.com/users/bazel-flag-bot/gists{/gist_id}", "starred_url": "https://api.github.com/users/bazel-flag-bot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bazel-flag-bot/subscriptions", "organizations_url": "https://api.github.com/users/bazel-flag-bot/orgs", "repos_url": "https://api.github.com/users/bazel-flag-bot/repos", "events_url": "https://api.github.com/users/bazel-flag-bot/events{/privacy}", "received_events_url": "https://api.github.com/users/bazel-flag-bot/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-12-19T04:31:27Z", "updated_at": "2019-12-19T04:31:27Z", "closed_at": null, "author_association": "NONE", "body": "Incompatible flag --incompatible_no_implicit_file_export will break TensorFlow once Bazel 1.2.1 is released.\n\nPlease see the following CI builds for more information:\n\n* [:darwin: (OpenJDK 8)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#042f4c72-2a23-4d7b-9d3b-d78619ea3fc7\" target=\"_blank\">:darwin: (OpenJDK 8)</a>)\n* [:windows: (OpenJDK 8)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#65246ccf-c676-40de-b693-3e1408052faa\" target=\"_blank\">:windows: (OpenJDK 8)</a>)\n* [:ubuntu: 18.04 (OpenJDK 11)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#42574ec2-097a-4fa6-9c82-5de0093a2ed1\" target=\"_blank\">:ubuntu: 18.04 (OpenJDK 11)</a>)\n\nQuestions? Please file an issue in https://github.com/bazelbuild/continuous-integration\n\n**Important**: Please do NOT modify the issue title since that might break our tools.\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35243", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35243/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35243/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35243/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35243", "id": 540069614, "node_id": "MDU6SXNzdWU1NDAwNjk2MTQ=", "number": 35243, "title": "Flag --incompatible_load_python_rules_from_bzl will break TensorFlow in Bazel 1.2.1", "user": {"login": "bazel-flag-bot", "id": 58891217, "node_id": "MDQ6VXNlcjU4ODkxMjE3", "avatar_url": "https://avatars0.githubusercontent.com/u/58891217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bazel-flag-bot", "html_url": "https://github.com/bazel-flag-bot", "followers_url": "https://api.github.com/users/bazel-flag-bot/followers", "following_url": "https://api.github.com/users/bazel-flag-bot/following{/other_user}", "gists_url": "https://api.github.com/users/bazel-flag-bot/gists{/gist_id}", "starred_url": "https://api.github.com/users/bazel-flag-bot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bazel-flag-bot/subscriptions", "organizations_url": "https://api.github.com/users/bazel-flag-bot/orgs", "repos_url": "https://api.github.com/users/bazel-flag-bot/repos", "events_url": "https://api.github.com/users/bazel-flag-bot/events{/privacy}", "received_events_url": "https://api.github.com/users/bazel-flag-bot/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-12-19T04:30:47Z", "updated_at": "2019-12-19T04:30:47Z", "closed_at": null, "author_association": "NONE", "body": "Incompatible flag --incompatible_load_python_rules_from_bzl will break TensorFlow once Bazel 1.2.1 is released.\n\nPlease see the following CI builds for more information:\n\n* [:darwin: (OpenJDK 8)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#042f4c72-2a23-4d7b-9d3b-d78619ea3fc7\" target=\"_blank\">:darwin: (OpenJDK 8)</a>)\n* [:windows: (OpenJDK 8)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#65246ccf-c676-40de-b693-3e1408052faa\" target=\"_blank\">:windows: (OpenJDK 8)</a>)\n* [:ubuntu: 18.04 (OpenJDK 11)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#42574ec2-097a-4fa6-9c82-5de0093a2ed1\" target=\"_blank\">:ubuntu: 18.04 (OpenJDK 11)</a>)\n\nQuestions? Please file an issue in https://github.com/bazelbuild/continuous-integration\n\n**Important**: Please do NOT modify the issue title since that might break our tools.\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35242", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35242/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35242/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35242/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35242", "id": 540069286, "node_id": "MDU6SXNzdWU1NDAwNjkyODY=", "number": 35242, "title": "Flag --incompatible_disallow_empty_glob will break TensorFlow in Bazel 1.2.1", "user": {"login": "bazel-flag-bot", "id": 58891217, "node_id": "MDQ6VXNlcjU4ODkxMjE3", "avatar_url": "https://avatars0.githubusercontent.com/u/58891217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bazel-flag-bot", "html_url": "https://github.com/bazel-flag-bot", "followers_url": "https://api.github.com/users/bazel-flag-bot/followers", "following_url": "https://api.github.com/users/bazel-flag-bot/following{/other_user}", "gists_url": "https://api.github.com/users/bazel-flag-bot/gists{/gist_id}", "starred_url": "https://api.github.com/users/bazel-flag-bot/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bazel-flag-bot/subscriptions", "organizations_url": "https://api.github.com/users/bazel-flag-bot/orgs", "repos_url": "https://api.github.com/users/bazel-flag-bot/repos", "events_url": "https://api.github.com/users/bazel-flag-bot/events{/privacy}", "received_events_url": "https://api.github.com/users/bazel-flag-bot/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-12-19T04:29:51Z", "updated_at": "2019-12-19T04:29:51Z", "closed_at": null, "author_association": "NONE", "body": "Incompatible flag --incompatible_disallow_empty_glob will break TensorFlow once Bazel 1.2.1 is released.\n\nPlease see the following CI builds for more information:\n\n* [:darwin: (OpenJDK 8)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#042f4c72-2a23-4d7b-9d3b-d78619ea3fc7\" target=\"_blank\">:darwin: (OpenJDK 8)</a>)\n* [:windows: (OpenJDK 8)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#65246ccf-c676-40de-b693-3e1408052faa\" target=\"_blank\">:windows: (OpenJDK 8)</a>)\n* [:ubuntu: 18.04 (OpenJDK 11)](<a href=\"https://buildkite.com/bazel/bazelisk-plus-incompatible-flags/builds/342#42574ec2-097a-4fa6-9c82-5de0093a2ed1\" target=\"_blank\">:ubuntu: 18.04 (OpenJDK 11)</a>)\n\nQuestions? Please file an issue in https://github.com/bazelbuild/continuous-integration\n\n**Important**: Please do NOT modify the issue title since that might break our tools.\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35241", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35241/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35241/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35241/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35241", "id": 540057085, "node_id": "MDU6SXNzdWU1NDAwNTcwODU=", "number": 35241, "title": "add_weight with None name generate a graph that it's not possible to save by checkpoint manager", "user": {"login": "andompesta", "id": 6725612, "node_id": "MDQ6VXNlcjY3MjU2MTI=", "avatar_url": "https://avatars0.githubusercontent.com/u/6725612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andompesta", "html_url": "https://github.com/andompesta", "followers_url": "https://api.github.com/users/andompesta/followers", "following_url": "https://api.github.com/users/andompesta/following{/other_user}", "gists_url": "https://api.github.com/users/andompesta/gists{/gist_id}", "starred_url": "https://api.github.com/users/andompesta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andompesta/subscriptions", "organizations_url": "https://api.github.com/users/andompesta/orgs", "repos_url": "https://api.github.com/users/andompesta/repos", "events_url": "https://api.github.com/users/andompesta/events{/privacy}", "received_events_url": "https://api.github.com/users/andompesta/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-12-19T03:44:00Z", "updated_at": "2020-01-13T12:38:58Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): pip install\r\n- TensorFlow version (use command below): 2.0.0\r\n- Python version: 3.7.5\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: 10.0\r\n- GPU model and memory: Tesla V100-SXM2-16GB\r\n\r\n**Describe the current behavior**\r\nWhen creating a custom keras.layers.Layer, it is possible to add weight in a lazy fashion through the add_weight() API. One of the possible arguments is the variable name.\r\n\r\nAccording the documentation the name can be omitted, however if we have a Variable with None name and we try to save the model using the CheckpointManager API we can't generate a proper graph taxonomy. Specifically, it is impossible to obtain the path prefix for the custom variable since the ``_escape_local_name()`` function in graph_view.py line 51 would rise a NoneType error.\r\n \r\n**Describe the expected behavior**\r\nThe expected behaviour would rise an error when the custom layer is build. In my opinion I would make the Variable name a mandatory field instead of having a None value by default.\r\n\r\n**Code to reproduce the issue**\r\n```\r\nclass CustomEmbedding(tf.keras.layers.Layer):\r\n    \"\"\"Construct the embeddings from word, position and token_type embeddings.\r\n    \"\"\"\r\n\r\n    def __init__(self, vocab_size, hidden_size,  max_position_embeddings, **kwargs):\r\n        super(CustomEmbedding, self).__init__(**kwargs)\r\n        self.vocab_size = vocab_size\r\n        self.hidden_size = hidden_size\r\n        self.max_position_embeddings = max_position_embeddings\r\n        self.pad_idx = 0\r\n        self.max_position_embeddings += 1\r\n\r\n\r\n    def build(self, input_shape):\r\n        \"\"\"Build shared word embedding layer \"\"\"\r\n        with tf.name_scope(\"position_embeddings\"):\r\n            self.position_embeddings = self.add_weight(\r\n                # Note that the name is missing\r\n                shape=(self.max_position_embeddings, self.hidden_size),\r\n                initializer=positional_encoding,\r\n                trainable=False,\r\n                dtype=self.dtype)\r\n\r\n        with tf.name_scope(\"word_embeddings\"):\r\n            # Create and initialize weights. The random normal initializer was chosen\r\n            # arbitrarily, and works well.\r\n            self.word_embeddings = self.add_weight(\r\n                \"weight\",\r\n                shape=[self.vocab_size, self.hidden_size],\r\n                initializer=get_initializer(self.initializer_range),\r\n                trainable=True,\r\n                dtype=self.dtype\r\n            )\r\n        super(CustomEmbedding, self).build(input_shape)\r\n\r\n    def call(self, inputs):\r\n        input_ids, position_ids = inputs\r\n\r\n        inputs_embeds = tf.nn.embedding_lookup(self.word_embeddings, input_ids)\r\n        position_embeddings = tf.nn.embedding_lookup(self.position_embeddings, position_ids)\r\n\r\n        embeddings = inputs_embeds + position_embeddings\r\n        return embeddings\r\n```\r\nAssuming to have a model with the over-defined CustomLayer. If we try to save the model after some training epochs\r\n```\r\nckpt = tf.train.Checkpoint(model=model, optimizer=optim)\r\nckpt_manager = tf.train.CheckpointManager(ckpt,\r\n    directory=path.join(args.ckpt_path, args.version),\r\n    max_to_keep=args.max_ckp_to_keep)\r\n\r\nif ckpt_manager.latest_checkpoint:\r\n    ckpt.restore(ckpt_manager.latest_checkpoint)\r\n    print('Latest checkpoint restored!!')\r\n\r\n# training code\r\n\r\nif self.val_accuracy.result() > best_model:\r\n    best_model = self.test_accuracy.result()\r\n    ckpt_save_path = ckpt_manager.save() # expected errors\r\n    print('Saving checkpoint for epoch {} at {}'.format(epoch + 1, ckpt_save_path))\r\n``` \r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35239", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35239/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35239/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35239/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35239", "id": 540047498, "node_id": "MDU6SXNzdWU1NDAwNDc0OTg=", "number": 35239, "title": "Return some sort of verifying data structure for load_weights for tf.keras models", "user": {"login": "ashutoshbsathe", "id": 22210756, "node_id": "MDQ6VXNlcjIyMjEwNzU2", "avatar_url": "https://avatars1.githubusercontent.com/u/22210756?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ashutoshbsathe", "html_url": "https://github.com/ashutoshbsathe", "followers_url": "https://api.github.com/users/ashutoshbsathe/followers", "following_url": "https://api.github.com/users/ashutoshbsathe/following{/other_user}", "gists_url": "https://api.github.com/users/ashutoshbsathe/gists{/gist_id}", "starred_url": "https://api.github.com/users/ashutoshbsathe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ashutoshbsathe/subscriptions", "organizations_url": "https://api.github.com/users/ashutoshbsathe/orgs", "repos_url": "https://api.github.com/users/ashutoshbsathe/repos", "events_url": "https://api.github.com/users/ashutoshbsathe/events{/privacy}", "received_events_url": "https://api.github.com/users/ashutoshbsathe/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-12-19T03:11:51Z", "updated_at": "2019-12-27T03:55:52Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): 2.0.0\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nCurrently, whenever user loads keras models using HDF5, user gets no confirmation that models were loaded successfully ([\\[1\\]](https://www.tensorflow.org/api_docs/python/tf/keras/Sequential#load_weights), [\\[2\\]](https://www.tensorflow.org/api_docs/python/tf/keras/Model?version=stable#load_weights) return nothing). This confirmation could be useful for verifying that weights are properly loaded. In case of transfer learning, users typically only want to load specific weights from the HDF5file. This can be currently achieved by using `load_weights(by_name=True)`, however, users don't get any confirmation about which layers were actually loaded.\r\n\r\nAlso, in case there are no matching layers in between the original model and source model, the `model.load_weights(by_name=True)` fails without raising any exception so there is no way to actually debug what went wrong with the model loading. (Note here that I'm talking about name mismatch not weight mismatch) This significantly affects the ability to write unit tests for models since the tester code cannot actually verify what layers were loaded from HDF5 file.\r\n\r\n**Will this change the current api? How?**\r\nYes, this changes the current API for [\\[1\\]](https://www.tensorflow.org/api_docs/python/tf/keras/Model?version=stable#load_weights) and [\\[2\\]](https://www.tensorflow.org/api_docs/python/tf/keras/Sequential#load_weights) by adding a return type to them. Specifically, we will be returning a particular data structure when loading HDF5 files [here](https://github.com/tensorflow/tensorflow/blob/c49396cf71dacc32195033507b3bbd985b12c255/tensorflow/python/keras/engine/network.py#L1131). My current idea is to return the list of layers that were loaded from HDF5 although I'm open to discussion about the return type.\r\n\r\n**Who will benefit with this feature?**\r\nUsers who are loading their weights from h5py files and want to verify/check what layers were loaded from HDF5. \r\n\r\n**Any Other info.**\r\nN/A\r\n\r\n\r\nLet me know if any more clarification/information is needed. I'm willing to contribute by working on this issue."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35229", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35229/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35229/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35229/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/35229", "id": 539877268, "node_id": "MDExOlB1bGxSZXF1ZXN0MzU0Nzc3Njkz", "number": 35229, "title": "Update math_ops.py", "user": {"login": "anigasan", "id": 29756847, "node_id": "MDQ6VXNlcjI5NzU2ODQ3", "avatar_url": "https://avatars2.githubusercontent.com/u/29756847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anigasan", "html_url": "https://github.com/anigasan", "followers_url": "https://api.github.com/users/anigasan/followers", "following_url": "https://api.github.com/users/anigasan/following{/other_user}", "gists_url": "https://api.github.com/users/anigasan/gists{/gist_id}", "starred_url": "https://api.github.com/users/anigasan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anigasan/subscriptions", "organizations_url": "https://api.github.com/users/anigasan/orgs", "repos_url": "https://api.github.com/users/anigasan/repos", "events_url": "https://api.github.com/users/anigasan/events{/privacy}", "received_events_url": "https://api.github.com/users/anigasan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 16, "created_at": "2019-12-18T19:34:28Z", "updated_at": "2020-02-19T11:06:10Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/35229", "html_url": "https://github.com/tensorflow/tensorflow/pull/35229", "diff_url": "https://github.com/tensorflow/tensorflow/pull/35229.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/35229.patch"}, "body": "Updating tf.multiply with usage example, and description"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35227", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35227/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35227/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35227/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35227", "id": 539700466, "node_id": "MDU6SXNzdWU1Mzk3MDA0NjY=", "number": 35227, "title": "Tensorflow build unsuccessful using bazel build", "user": {"login": "spurani", "id": 28580888, "node_id": "MDQ6VXNlcjI4NTgwODg4", "avatar_url": "https://avatars1.githubusercontent.com/u/28580888?v=4", "gravatar_id": "", "url": "https://api.github.com/users/spurani", "html_url": "https://github.com/spurani", "followers_url": "https://api.github.com/users/spurani/followers", "following_url": "https://api.github.com/users/spurani/following{/other_user}", "gists_url": "https://api.github.com/users/spurani/gists{/gist_id}", "starred_url": "https://api.github.com/users/spurani/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/spurani/subscriptions", "organizations_url": "https://api.github.com/users/spurani/orgs", "repos_url": "https://api.github.com/users/spurani/repos", "events_url": "https://api.github.com/users/spurani/events{/privacy}", "received_events_url": "https://api.github.com/users/spurani/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1162044565, "node_id": "MDU6TGFiZWwxMTYyMDQ0NTY1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.12", "name": "TF 1.12", "color": "c2e0c6", "default": false, "description": "Issues related to TF 1.12"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2019-12-18T14:02:57Z", "updated_at": "2020-01-19T02:42:05Z", "closed_at": null, "author_association": "NONE", "body": "So I have been following to this guide https://www.tensorflow.org/install/source and https://www.tensorflow.org/install/gpu. My system configuration is\r\n\r\n\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 440.33.01    Driver Version: 440.33.01    CUDA Version: 10.2     |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce GTX 1050    Off  | 00000000:01:00.0  On |                  N/A |\r\n| 45%   27C    P8    N/A /  75W |    258MiB /  1997MiB |     10%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                              \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|    0      1022      G   /usr/lib/xorg/Xorg                           151MiB |\r\n|    0      2686      G   compiz                                       102MiB |\r\n|    0      5660      G   /usr/lib/firefox/firefox                       1MiB |\r\n+-----------------------------------------------------------------------------+\r\n\r\n./deviceQuery Starting...\r\n\r\n CUDA Device Query (Runtime API) version (CUDART static linking)\r\n\r\nDetected 1 CUDA Capable device(s)\r\n\r\nDevice 0: \"GeForce GTX 1050\"\r\n  CUDA Driver Version / Runtime Version          10.2 / 9.0\r\n  CUDA Capability Major/Minor version number:    6.1\r\n  Total amount of global memory:                 1998 MBytes (2094989312 bytes)\r\n  ( 5) Multiprocessors, (128) CUDA Cores/MP:     640 CUDA Cores\r\n  GPU Max Clock rate:                            1455 MHz (1.46 GHz)\r\n  Memory Clock rate:                             3504 Mhz\r\n  Memory Bus Width:                              128-bit\r\n  L2 Cache Size:                                 1048576 bytes\r\n  Maximum Texture Dimension Size (x,y,z)         1D=(131072), 2D=(131072, 65536), 3D=(16384, 16384, 16384)\r\n  Maximum Layered 1D Texture Size, (num) layers  1D=(32768), 2048 layers\r\n  Maximum Layered 2D Texture Size, (num) layers  2D=(32768, 32768), 2048 layers\r\n  Total amount of constant memory:               65536 bytes\r\n  Total amount of shared memory per block:       49152 bytes\r\n  Total number of registers available per block: 65536\r\n  Warp size:                                     32\r\n  Maximum number of threads per multiprocessor:  2048\r\n  Maximum number of threads per block:           1024\r\n  Max dimension size of a thread block (x,y,z): (1024, 1024, 64)\r\n  Max dimension size of a grid size    (x,y,z): (2147483647, 65535, 65535)\r\n  Maximum memory pitch:                          2147483647 bytes\r\n  Texture alignment:                             512 bytes\r\n  Concurrent copy and kernel execution:          Yes with 2 copy engine(s)\r\n  Run time limit on kernels:                     Yes\r\n  Integrated GPU sharing Host Memory:            No\r\n  Support host page-locked memory mapping:       Yes\r\n  Alignment requirement for Surfaces:            Yes\r\n  Device has ECC support:                        Disabled\r\n  Device supports Unified Addressing (UVA):      Yes\r\n  Supports Cooperative Kernel Launch:            Yes\r\n  Supports MultiDevice Co-op Kernel Launch:      Yes\r\n  Device PCI Domain ID / Bus ID / location ID:   0 / 1 / 0\r\n  Compute Mode:\r\n     < Default (multiple host threads can use ::cudaSetDevice() with device simultaneously) >\r\n\r\ndeviceQuery, CUDA Driver = CUDART, CUDA Driver Version = 10.2, CUDA Runtime Version = 9.0, NumDevs = 1\r\n\r\nnvcc: NVIDIA (R) Cuda compiler driver\r\nCopyright (c) 2005-2017 NVIDIA Corporation\r\nBuilt on Fri_Sep__1_21:08:03_CDT_2017\r\nCuda compilation tools, release 9.0, V9.0.176\r\n\r\nlibcudnn => 7.6.0\r\n#define CUDNN_MAJOR 7\r\n#define CUDNN_MINOR 6\r\n#define CUDNN_PATCHLEVEL 0\r\n--\r\n#define CUDNN_VERSION (CUDNN_MAJOR * 1000 + CUDNN_MINOR * 100 + CUDNN_PATCHLEVEL)\r\n\r\n#include \"driver_types.h\"\r\n\r\nNCCL version => 2.4.7\r\ngcc => 5.4.0\r\npyhton => 2.7.0\r\n\r\ndpkg -l | grep TensorRT\r\nii  graphsurgeon-tf                                            5.1.5-1+cuda9.0                                 amd64        GraphSurgeon for TensorRT package\r\nii  libnvinfer-dev                                             5.1.5-1+cuda9.0                                 amd64        TensorRT development libraries and headers\r\nii  libnvinfer-samples                                         5.1.5-1+cuda9.0                                 all          TensorRT samples and documentation\r\nii  libnvinfer5                                                5.1.5-1+cuda9.0                                 amd64        TensorRT runtime libraries\r\nii  python-libnvinfer                                          5.1.5-1+cuda9.0                                 amd64        Python bindings for TensorRT\r\nii  python-libnvinfer-dev                                      5.1.5-1+cuda9.0                                 amd64        Python development package for TensorRT\r\nii  tensorrt                                                   5.1.5.0-1+cuda9.0                               amd64        Meta package of TensorRT\r\nii  uff-converter-tf                                           5.1.5-1+cuda9.0                                 amd64        UFF converter for TensorRT package\r\n\r\n\r\n\r\nafter running this command\r\n**bazel build --config=opt --config=cuda --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" //tensorflow/tools/pip_package:build_pip_package\r\nand\r\nbazel build --config=opt  --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" //tensorflow/tools/pip_package:build_pip_package**\r\n\r\nI got the same error both time mentioned at bottom\r\n\r\n**ERROR: /home/user/tensorflow/tensorflow/core/kernels/BUILD:2951:1: output 'tensorflow/core/kernels/_objs/cwise_op_gpu/tensorflow/core/kernels/cwise_op_gpu_mul.cu.pic.o' was not created\r\nERROR: /home/user/tensorflow/tensorflow/core/kernels/BUILD:2951:1: not all outputs were created or valid\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nFAILED: Build did NOT complete successfully**\r\n\r\nAny help would be appreciated I am still learning and trying to understand tensorflow and its conepts. It would be great and exciting if anyone could give any suggestions or advice where I am going wrong. Though I am referring to couple of references will keep you guys posted if I come across anything relevant. Let me know if more info is required. Thanks\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35214", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35214/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35214/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35214/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35214", "id": 539462407, "node_id": "MDU6SXNzdWU1Mzk0NjI0MDc=", "number": 35214, "title": "tflite.load_delegate() failed when running Demo API on Google Coral mini PCIe", "user": {"login": "batulrangwala", "id": 57891266, "node_id": "MDQ6VXNlcjU3ODkxMjY2", "avatar_url": "https://avatars2.githubusercontent.com/u/57891266?v=4", "gravatar_id": "", "url": "https://api.github.com/users/batulrangwala", "html_url": "https://github.com/batulrangwala", "followers_url": "https://api.github.com/users/batulrangwala/followers", "following_url": "https://api.github.com/users/batulrangwala/following{/other_user}", "gists_url": "https://api.github.com/users/batulrangwala/gists{/gist_id}", "starred_url": "https://api.github.com/users/batulrangwala/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/batulrangwala/subscriptions", "organizations_url": "https://api.github.com/users/batulrangwala/orgs", "repos_url": "https://api.github.com/users/batulrangwala/repos", "events_url": "https://api.github.com/users/batulrangwala/events{/privacy}", "received_events_url": "https://api.github.com/users/batulrangwala/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "terryheo", "id": 2908505, "node_id": "MDQ6VXNlcjI5MDg1MDU=", "avatar_url": "https://avatars2.githubusercontent.com/u/2908505?v=4", "gravatar_id": "", "url": "https://api.github.com/users/terryheo", "html_url": "https://github.com/terryheo", "followers_url": "https://api.github.com/users/terryheo/followers", "following_url": "https://api.github.com/users/terryheo/following{/other_user}", "gists_url": "https://api.github.com/users/terryheo/gists{/gist_id}", "starred_url": "https://api.github.com/users/terryheo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/terryheo/subscriptions", "organizations_url": "https://api.github.com/users/terryheo/orgs", "repos_url": "https://api.github.com/users/terryheo/repos", "events_url": "https://api.github.com/users/terryheo/events{/privacy}", "received_events_url": "https://api.github.com/users/terryheo/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "terryheo", "id": 2908505, "node_id": "MDQ6VXNlcjI5MDg1MDU=", "avatar_url": "https://avatars2.githubusercontent.com/u/2908505?v=4", "gravatar_id": "", "url": "https://api.github.com/users/terryheo", "html_url": "https://github.com/terryheo", "followers_url": "https://api.github.com/users/terryheo/followers", "following_url": "https://api.github.com/users/terryheo/following{/other_user}", "gists_url": "https://api.github.com/users/terryheo/gists{/gist_id}", "starred_url": "https://api.github.com/users/terryheo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/terryheo/subscriptions", "organizations_url": "https://api.github.com/users/terryheo/orgs", "repos_url": "https://api.github.com/users/terryheo/repos", "events_url": "https://api.github.com/users/terryheo/events{/privacy}", "received_events_url": "https://api.github.com/users/terryheo/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-12-18T05:37:06Z", "updated_at": "2019-12-19T05:53:22Z", "closed_at": null, "author_association": "NONE", "body": "I am also facing a similar issue.\r\nThe demo API gives error at tflite.load_delegate.\r\n\r\n```\r\npi@bpi-iot-ros-ai:~/coral/tflite/python/examples/classification$ python3 classify_image.py --model models/mobilenet_v2_1.0_224_inat_bird_quant_edgetpu.tflite --labels models/inat_bird_labels.txt --input images/parrot.jpg\r\nE :248] HIB Error. hib_error_status = 0000000000000001, hib_first_error_status = 0000000000000001\r\nE :248] HIB Error. hib_error_status = 0000000000000001, hib_first_error_status = 0000000000000001\r\nINFO: Initialized TensorFlow Lite runtime.\r\n----INFERENCE TIME----\r\nNote: The first inference on Edge TPU is slow because it includes loading the model into Edge TPU memory.\r\n\r\n\r\n\r\npi@bpi-iot-ros-ai:~$ uname -a\r\nLinux bpi-iot-ros-ai 5.4.0-bpi-r64 #1 SMP PREEMPT Mon Dec 16 16:00:08 IST 2019 aarch64 aarch64 aarch64 GNU/Linux\r\npi@bpi-iot-ros-ai:~$ lscpu\r\nArchitecture:          aarch64\r\nByte Order:            Little Endian\r\nCPU(s):                2\r\nOn-line CPU(s) list:   0,1\r\nThread(s) per core:    1\r\nCore(s) per socket:    2\r\nSocket(s):             1\r\nCPU max MHz:           1350.0000\r\nCPU min MHz:           30.0000\r\npi@bpi-iot-ros-ai:~$ ls -l /usr/lib/aarch64-linux-gnu/libedge*\r\nlrwxrwxrwx 1 root root     17 Sep 17 04:27 /usr/lib/aarch64-linux-gnu/libedgetpu.so.1 -> libedgetpu.so.1.0\r\n-rwxrwxrwx 1 root root 792376 Sep 17 04:27 /usr/lib/aarch64-linux-gnu/libedgetpu.so.1.0\r\npi@bpi-iot-ros-ai:~$ lspci\r\n00:00.0 PCI bridge: MEDIATEK Corp. Device 3258\r\n01:00.0 System peripheral: Device 1ac1:089a\r\npi@bpi-iot-ros-ai:~$ ls /dev/apex_0 \r\n/dev/apex_0\r\npi@bpi-iot-ros-ai:~$ sudo sh -c \"echo 'SUBSYSTEM==\\\"apex\\\", MODE=\\\"0660\\\", GROUP=\\\"apex\\\"' >> /etc/udev/rules.d/65-apex.rules\"\r\npi@bpi-iot-ros-ai:~$ sudo groupadd apex\r\ngroupadd: group 'apex' already exists\r\npi@bpi-iot-ros-ai:~$ sudo adduser $USER apex\r\nThe user `pi' is already a member of `apex'.\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35213", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35213/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35213/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35213/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35213", "id": 539445186, "node_id": "MDU6SXNzdWU1Mzk0NDUxODY=", "number": 35213, "title": "macOS compiling: hidden symbol `__dso_handle' isn't defined and undefined reference to `operator delete(void*)'", "user": {"login": "pinxue", "id": 958237, "node_id": "MDQ6VXNlcjk1ODIzNw==", "avatar_url": "https://avatars0.githubusercontent.com/u/958237?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pinxue", "html_url": "https://github.com/pinxue", "followers_url": "https://api.github.com/users/pinxue/followers", "following_url": "https://api.github.com/users/pinxue/following{/other_user}", "gists_url": "https://api.github.com/users/pinxue/gists{/gist_id}", "starred_url": "https://api.github.com/users/pinxue/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pinxue/subscriptions", "organizations_url": "https://api.github.com/users/pinxue/orgs", "repos_url": "https://api.github.com/users/pinxue/repos", "events_url": "https://api.github.com/users/pinxue/events{/privacy}", "received_events_url": "https://api.github.com/users/pinxue/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2019-12-18T04:32:28Z", "updated_at": "2020-02-06T16:30:23Z", "closed_at": null, "author_association": "NONE", "body": "@tensorflow/micro\r\n\r\n**System information**\r\n- macOS 10.15 Catalina\r\n- TensorFlow installed from source \r\n- Tensorflow version (commit SHA if source):2ba0b2ef68d4259e8b02fa8be77a9372020b81b7 (Dec. 16)\r\n- Target platform (e.g. Arm Mbed OS, Arduino Nano 33 etc.): bluepill\r\n\r\n**Describe the problem**\r\n```\r\narm-none-eabi-g++ -O3 -DNDEBUG -std=c++11 -g -DTF_LITE_STATIC_MEMORY -fno-rtti -DGEMMLOWP_ALLOW_SLOW_SCALAR_FALLBACK -DTF_LITE_STATIC_MEMORY -DTF_LITE_MCU_DEBUG_LOG -fno-rtti -fmessage-length=0 -fno-exceptions -fno-unwind-tables -fno-builtin -ffunction-sections -fdata-sections -funsigned-char -MMD -mcpu=cortex-m3 -mthumb -std=gnu++11 -Wvla -Wall -Wextra -Wno-unused-parameter -Wno-missing-field-initializers -Wno-write-strings -Wno-sign-compare -fno-delete-null-pointer-checks -fomit-frame-pointer -fpermissive -nostdlib -g -Os -I. -Itensorflow/lite/micro/tools/make/downloads/ -Itensorflow/lite/micro/tools/make/downloads/gemmlowp -Itensorflow/lite/micro/tools/make/downloads/flatbuffers/include -isystemtensorflow/lite/micro/tools/make/downloads/cmsis/CMSIS/Core/Include/ -Itensorflow/lite/micro/tools/make/downloads/stm32_bare_lib/include -Itensorflow/lite/micro/tools/make/downloads/kissfft -o tensorflow/lite/micro/tools/make/gen/bluepill_cortex-m3/bin/hello_world tensorflow/lite/micro/tools/make/gen/bluepill_cortex-m3/obj/tensorflow/lite/micro/examples/hello_world/main.o tensorflow/lite/micro/tools/make/gen/bluepill_cortex-m3/obj/tensorflow/lite/micro/examples/hello_world/main_functions.o tensorflow/lite/micro/tools/make/gen/bluepill_cortex-m3/obj/tensorflow/lite/micro/examples/hello_world/sine_model_data.o tensorflow/lite/micro/tools/make/gen/bluepill_cortex-m3/obj/tensorflow/lite/micro/examples/hello_world/output_handler.o tensorflow/lite/micro/tools/make/gen/bluepill_cortex-m3/obj/tensorflow/lite/micro/examples/hello_world/constants.o  tensorflow/lite/micro/tools/make/gen/bluepill_cortex-m3/lib/libtensorflow-microlite.a -T tensorflow/lite/micro/tools/make/targets/bluepill/bluepill.lds -Wl,-Map=tensorflow/lite/micro/tools/make/gen/bluepill.map,--cref -Wl,--gc-sections -lm\r\ntensorflow/lite/micro/tools/make/gen/bluepill_cortex-m3/obj/tensorflow/lite/micro/examples/hello_world/main_functions.o: In function `setup()':\r\n/Users/pinxue/projects/rt-thread/ai/tensorflow/tensorflow/lite/micro/examples/hello_world/main_functions.cc:47: undefined reference to `__cxa_guard_acquire'\r\n/Users/pinxue/projects/rt-thread/ai/tensorflow/tensorflow/lite/micro/examples/hello_world/main_functions.cc:47: undefined reference to `__cxa_guard_release'\r\n/Users/pinxue/projects/rt-thread/ai/tensorflow/tensorflow/lite/micro/examples/hello_world/main_functions.cc:63: undefined reference to `__cxa_guard_acquire'\r\n/Users/pinxue/projects/rt-thread/ai/tensorflow/tensorflow/lite/micro/examples/hello_world/main_functions.cc:63: undefined reference to `__cxa_guard_release'\r\n/Users/pinxue/projects/rt-thread/ai/tensorflow/tensorflow/lite/micro/examples/hello_world/main_functions.cc:67: undefined reference to `__cxa_guard_acquire'\r\n/Users/pinxue/projects/rt-thread/ai/tensorflow/tensorflow/lite/micro/examples/hello_world/main_functions.cc:67: undefined reference to `__cxa_guard_release'\r\n/Users/pinxue/projects/rt-thread/ai/tensorflow/tensorflow/lite/micro/examples/hello_world/main_functions.cc:83: undefined reference to `__dso_handle'\r\ntensorflow/lite/micro/tools/make/gen/bluepill_cortex-m3/lib/libtensorflow-microlite.a(greedy_memory_planner.o): In function `tflite::GreedyMemoryPlanner::~GreedyMemoryPlanner()':\r\n/Users/pinxue/projects/rt-thread/ai/tensorflow/tensorflow/lite/micro/memory_planner/greedy_memory_planner.cc:70: undefined reference to `operator delete(void*)'\r\n`__lock___atexit_recursive_mutex' referenced in section `.data.__atexit_recursive_mutex' of /Users/pinxue/projects/rt-thread/ai/tensorflow/tensorflow/lite/micro/tools/make/downloads/gcc_embedded/bin/../lib/gcc/arm-none-eabi/7.3.1/../../../../arm-none-eabi/lib/thumb/v7-m/libc.a(lib_a-__call_atexit.o): defined in discarded section `COMMON' of /Users/pinxue/projects/rt-thread/ai/tensorflow/tensorflow/lite/micro/tools/make/downloads/gcc_embedded/bin/../lib/gcc/arm-none-eabi/7.3.1/../../../../arm-none-eabi/lib/thumb/v7-m/libc.a(lib_a-lock.o)\r\n/Users/pinxue/projects/rt-thread/ai/tensorflow/tensorflow/lite/micro/tools/make/downloads/gcc_embedded/bin/../lib/gcc/arm-none-eabi/7.3.1/../../../../arm-none-eabi/bin/ld: tensorflow/lite/micro/tools/make/gen/bluepill_cortex-m3/bin/hello_world: hidden symbol `__dso_handle' isn't defined\r\n/Users/pinxue/projects/rt-thread/ai/tensorflow/tensorflow/lite/micro/tools/make/downloads/gcc_embedded/bin/../lib/gcc/arm-none-eabi/7.3.1/../../../../arm-none-eabi/bin/ld: final link failed: Bad value\r\ncollect2: error: ld returned 1 exit status\r\ngmake: *** [tensorflow/lite/micro/examples/hello_world/Makefile.inc:42: tensorflow/lite/micro/tools/make/gen/bluepill_cortex-m3/bin/hello_world] Error 1\r\n```\r\n\r\n**Please provide the exact sequence of commands/steps when you ran into the problem**\r\n\r\n```\r\n$ /opt/local/bin/gmake -j1 -f tensorflow/lite/micro/tools/make/Makefile TARGET=bluepill hello_world\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35212", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35212/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35212/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35212/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35212", "id": 539438810, "node_id": "MDU6SXNzdWU1Mzk0Mzg4MTA=", "number": 35212, "title": "tf.load_op_library bug", "user": {"login": "northeastsquare", "id": 3086078, "node_id": "MDQ6VXNlcjMwODYwNzg=", "avatar_url": "https://avatars0.githubusercontent.com/u/3086078?v=4", "gravatar_id": "", "url": "https://api.github.com/users/northeastsquare", "html_url": "https://github.com/northeastsquare", "followers_url": "https://api.github.com/users/northeastsquare/followers", "following_url": "https://api.github.com/users/northeastsquare/following{/other_user}", "gists_url": "https://api.github.com/users/northeastsquare/gists{/gist_id}", "starred_url": "https://api.github.com/users/northeastsquare/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/northeastsquare/subscriptions", "organizations_url": "https://api.github.com/users/northeastsquare/orgs", "repos_url": "https://api.github.com/users/northeastsquare/repos", "events_url": "https://api.github.com/users/northeastsquare/events{/privacy}", "received_events_url": "https://api.github.com/users/northeastsquare/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-12-18T04:05:01Z", "updated_at": "2020-03-18T21:24:56Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): https://github.com/cogaplex-bts/bts\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): ubuntu 1604\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): pip\r\n- TensorFlow version (use command below):1.13.2\r\n- Python version: 3.7\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source): pip \r\n- CUDA/cuDNN version: 10.0 \r\n- GPU model and memory: 1060, 6G\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nin a process, use full path , twice load:\r\ntf.load_op_library(os.path.join(dname, 'build/libcompute_depth.so'))\r\nthe second time, OP_LIST is empty, \r\nbut with relative path, twice  tf.load_op_library not empty\r\n**Describe the expected behavior**\r\nuse full path, twice  tf.load_op_library, OP_LIST should not empty\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\nI compile https://github.com/cogaplex-bts/bts, met this problem. But I think this is a general problem, reproduce: just in a python file, load the library twice, with full path and relative path   \r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\n```\r\ncompute_depth_grad_module dict: {'__name__': 'a11935c229913616b7b14d8da52f01ac', '__doc__': 'Python wrappers around TensorFlow ops.\\n\\nThis file is MACHINE GENERATED! Do not edit.\\n', ...  , 'LIB_HANDLE': <Swig Object of type 'TF_Library *' at 0x7ff4ad011f60>, 'OP_LIST': op {\r\n  name: \"ComputeDepth\"\r\n  input_arg {\r\n    name: \"input\"\r\n    type: DT_FLOAT\r\n  }\r\n  input_arg {\r\n    name: \"focal\"\r\n    type: DT_FLOAT\r\n  }\r\n  output_arg {\r\n    name: \"depth\"\r\n    type: DT_FLOAT\r\n  }\r\n  attr {\r\n    name: \"upratio\"\r\n    type: \"int\"\r\n  }\r\n}\r\nop {\r\n  name: \"ComputeDepthGrad\"\r\n  input_arg {\r\n    name: \"depth_grad\"\r\n    type: DT_FLOAT\r\n  }\r\n  input_arg {\r\n    name: \"input\"\r\n    type: DT_FLOAT\r\n  }\r\n  input_arg {\r\n    name: \"focal\"\r\n    type: DT_FLOAT\r\n  }\r\n  output_arg {\r\n    name: \"grad_input\"\r\n    type: DT_FLOAT\r\n  }\r\n  output_arg {\r\n    name: \"grad_focal\"\r\n    type: DT_FLOAT\r\n  }\r\n}\r\n}\r\n{'__name__': 'a11935c229913616b7b14d8da52f01ac', '__doc__': 'Python wrappers around TensorFlow ops.\\n\\nThis file is MACHINE GENERATED! Do not edit.\\n', '__package__': None,  ... , 'LIB_HANDLE': <Swig Object of type 'TF_Library *' at 0x7ff4ad011f60>, 'OP_LIST': op {\r\n  name: \"ComputeDepth\"\r\n  input_arg {\r\n    name: \"input\"\r\n    type: DT_FLOAT\r\n  }\r\n  input_arg {\r\n    name: \"focal\"\r\n    type: DT_FLOAT\r\n  }\r\n  output_arg {\r\n    name: \"depth\"\r\n    type: DT_FLOAT\r\n  }\r\n  attr {\r\n    name: \"upratio\"\r\n    type: \"int\"\r\n  }\r\n}\r\nop {\r\n  name: \"ComputeDepthGrad\"\r\n  input_arg {\r\n    name: \"depth_grad\"\r\n    type: DT_FLOAT\r\n  }\r\n  input_arg {\r\n    name: \"input\"\r\n    type: DT_FLOAT\r\n  }\r\n  input_arg {\r\n    name: \"focal\"\r\n    type: DT_FLOAT\r\n  }\r\n  output_arg {\r\n    name: \"grad_input\"\r\n    type: DT_FLOAT\r\n  }\r\n  output_arg {\r\n    name: \"grad_focal\"\r\n    type: DT_FLOAT\r\n  }\r\n}\r\n}\r\n```\r\n\r\nbut with full name, second will print:\r\n```\r\ncompute_depth_grad_module dict: {'__name__': '670cc8cfec5b6d3b8635f39bd583d769', '__doc__': 'Python wrappers around TensorFlow ops.\\n\\nThis file is MACHINE GENERATED! Do not edit.\\n', '__package__': None, ... , 'LIB_HANDLE': <Swig Object of type 'TF_Library *' at 0x7f6b2a8f3e70>, 'OP_LIST': }\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35211", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35211/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35211/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35211/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35211", "id": 539438039, "node_id": "MDU6SXNzdWU1Mzk0MzgwMzk=", "number": 35211, "title": "TensorImage grayscale (single channel) image support ", "user": {"login": "hvico", "id": 7103453, "node_id": "MDQ6VXNlcjcxMDM0NTM=", "avatar_url": "https://avatars1.githubusercontent.com/u/7103453?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hvico", "html_url": "https://github.com/hvico", "followers_url": "https://api.github.com/users/hvico/followers", "following_url": "https://api.github.com/users/hvico/following{/other_user}", "gists_url": "https://api.github.com/users/hvico/gists{/gist_id}", "starred_url": "https://api.github.com/users/hvico/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hvico/subscriptions", "organizations_url": "https://api.github.com/users/hvico/orgs", "repos_url": "https://api.github.com/users/hvico/repos", "events_url": "https://api.github.com/users/hvico/events{/privacy}", "received_events_url": "https://api.github.com/users/hvico/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "lu-wang-g", "id": 47436172, "node_id": "MDQ6VXNlcjQ3NDM2MTcy", "avatar_url": "https://avatars0.githubusercontent.com/u/47436172?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lu-wang-g", "html_url": "https://github.com/lu-wang-g", "followers_url": "https://api.github.com/users/lu-wang-g/followers", "following_url": "https://api.github.com/users/lu-wang-g/following{/other_user}", "gists_url": "https://api.github.com/users/lu-wang-g/gists{/gist_id}", "starred_url": "https://api.github.com/users/lu-wang-g/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lu-wang-g/subscriptions", "organizations_url": "https://api.github.com/users/lu-wang-g/orgs", "repos_url": "https://api.github.com/users/lu-wang-g/repos", "events_url": "https://api.github.com/users/lu-wang-g/events{/privacy}", "received_events_url": "https://api.github.com/users/lu-wang-g/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "lu-wang-g", "id": 47436172, "node_id": "MDQ6VXNlcjQ3NDM2MTcy", "avatar_url": "https://avatars0.githubusercontent.com/u/47436172?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lu-wang-g", "html_url": "https://github.com/lu-wang-g", "followers_url": "https://api.github.com/users/lu-wang-g/followers", "following_url": "https://api.github.com/users/lu-wang-g/following{/other_user}", "gists_url": "https://api.github.com/users/lu-wang-g/gists{/gist_id}", "starred_url": "https://api.github.com/users/lu-wang-g/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lu-wang-g/subscriptions", "organizations_url": "https://api.github.com/users/lu-wang-g/orgs", "repos_url": "https://api.github.com/users/lu-wang-g/repos", "events_url": "https://api.github.com/users/lu-wang-g/events{/privacy}", "received_events_url": "https://api.github.com/users/lu-wang-g/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-12-18T04:01:38Z", "updated_at": "2020-02-10T12:17:16Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 18.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: Huawei\r\n- **TensorFlow installed from (source or binary)**: Source\r\n- **TensorFlow version (use command below)**: 2.0\r\n- **Python version**: 3.6\r\n- **Bazel version (if compiling from source)**: \r\n- **GCC/Compiler version (if compiling from source)**: \r\n- **CUDA/cuDNN version**: 10.2\r\n- **GPU model and memory**: GTX2080TI\r\n- **Exact command to reproduce**:\r\n\r\n### Describe the problem\r\nThis is a feature request. I am struggling to make a TFLITE model that works perfectly in Python to  also work in and Android apk. It seems I have problems related with the conversion from Bitmap to a bytebuffer, std, mean and that stuff (I've been using old Android examples that made the conversion Bitmap -> Bytebuffer manually). \r\n\r\nNow I've seen this new TensorImage feature in tensorflow-lite-support and tried it, but it seems it only supports loading RGB images. My model is MNIST-based, so the input shape of the images are (28, 28, 1). I don't see how I can use TensorImage to feed my model in this scenario.\r\n\r\nCan you please support grayscale (1 channel) images also please? \r\n\r\nThanks,\r\n\r\n### Source code / logs\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35205", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35205/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35205/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35205/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35205", "id": 539382617, "node_id": "MDU6SXNzdWU1MzkzODI2MTc=", "number": 35205, "title": "Object detection producing incorrect results on mobile (ios)", "user": {"login": "Lhogeshwaran", "id": 42288624, "node_id": "MDQ6VXNlcjQyMjg4NjI0", "avatar_url": "https://avatars3.githubusercontent.com/u/42288624?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Lhogeshwaran", "html_url": "https://github.com/Lhogeshwaran", "followers_url": "https://api.github.com/users/Lhogeshwaran/followers", "following_url": "https://api.github.com/users/Lhogeshwaran/following{/other_user}", "gists_url": "https://api.github.com/users/Lhogeshwaran/gists{/gist_id}", "starred_url": "https://api.github.com/users/Lhogeshwaran/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Lhogeshwaran/subscriptions", "organizations_url": "https://api.github.com/users/Lhogeshwaran/orgs", "repos_url": "https://api.github.com/users/Lhogeshwaran/repos", "events_url": "https://api.github.com/users/Lhogeshwaran/events{/privacy}", "received_events_url": "https://api.github.com/users/Lhogeshwaran/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "yyoon", "id": 1309817, "node_id": "MDQ6VXNlcjEzMDk4MTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1309817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yyoon", "html_url": "https://github.com/yyoon", "followers_url": "https://api.github.com/users/yyoon/followers", "following_url": "https://api.github.com/users/yyoon/following{/other_user}", "gists_url": "https://api.github.com/users/yyoon/gists{/gist_id}", "starred_url": "https://api.github.com/users/yyoon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yyoon/subscriptions", "organizations_url": "https://api.github.com/users/yyoon/orgs", "repos_url": "https://api.github.com/users/yyoon/repos", "events_url": "https://api.github.com/users/yyoon/events{/privacy}", "received_events_url": "https://api.github.com/users/yyoon/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "yyoon", "id": 1309817, "node_id": "MDQ6VXNlcjEzMDk4MTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1309817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yyoon", "html_url": "https://github.com/yyoon", "followers_url": "https://api.github.com/users/yyoon/followers", "following_url": "https://api.github.com/users/yyoon/following{/other_user}", "gists_url": "https://api.github.com/users/yyoon/gists{/gist_id}", "starred_url": "https://api.github.com/users/yyoon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yyoon/subscriptions", "organizations_url": "https://api.github.com/users/yyoon/orgs", "repos_url": "https://api.github.com/users/yyoon/repos", "events_url": "https://api.github.com/users/yyoon/events{/privacy}", "received_events_url": "https://api.github.com/users/yyoon/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-12-18T00:24:55Z", "updated_at": "2019-12-19T22:13:27Z", "closed_at": null, "author_association": "NONE", "body": "Object detection SSD trained and tested to produce expected results in PC. \r\nhttp://download.tensorflow.org/models/object_detection/ssd_inception_v2_coco_2018_01_28.tar.gz\r\nhttps://github.com/tensorflow/models/blob/master/research/object_detection/samples/configs/ssd_inception_v2_pets.config\r\n\r\nModel works well and produces accurate results on PC. \r\nAfter converting to tflite and loading in mobile, the camera view shows incorrect detection (several detection of same class and in fixed place even when moving the camera)."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35199", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35199/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35199/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35199/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35199", "id": 539249218, "node_id": "MDU6SXNzdWU1MzkyNDkyMTg=", "number": 35199, "title": "Softmax activations don't get converted to Softmax TFLite operator if ndim > 2", "user": {"login": "ghop02", "id": 1422280, "node_id": "MDQ6VXNlcjE0MjIyODA=", "avatar_url": "https://avatars2.githubusercontent.com/u/1422280?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghop02", "html_url": "https://github.com/ghop02", "followers_url": "https://api.github.com/users/ghop02/followers", "following_url": "https://api.github.com/users/ghop02/following{/other_user}", "gists_url": "https://api.github.com/users/ghop02/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghop02/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghop02/subscriptions", "organizations_url": "https://api.github.com/users/ghop02/orgs", "repos_url": "https://api.github.com/users/ghop02/repos", "events_url": "https://api.github.com/users/ghop02/events{/privacy}", "received_events_url": "https://api.github.com/users/ghop02/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-12-17T18:53:51Z", "updated_at": "2020-01-30T17:59:17Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): MacOS 10.15.1\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (or github SHA if from source): tf-nightly==2.1.0.dev20191203\r\n\r\n**Command used to run the converter or code if you\u2019re using the Python API**\r\n\r\n```\r\nimport pathlib\r\n\r\ninpt = tf.keras.layers.Input(shape=[256, 256, 3])\r\nout = tf.keras.layers.Lambda(lambda x: tf.keras.activations.softmax(x))(inpt)\r\nout = tf.keras.layers.Lambda(lambda x: tf.nn.softmax(x))(out)\r\nmodel = tf.keras.Model(inpt, out)\r\n\r\nconverter = tf.lite.TFLiteConverter.from_keras_model(model)\r\ntflite_model = converter.convert()\r\npathlib.Path('out.tflite').write_bytes(tflite_model)\r\n```\r\n\r\n**Failure details**\r\n![image](https://user-images.githubusercontent.com/1422280/71025023-3904e880-20d4-11ea-95fb-29cfea49a44d.png)\r\nThis graph shows the difference between the different softmax methods.  When using `tf.keras.activations.softmax`, there is [code](https://github.com/tensorflow/tensorflow/blob/v2.1.0-rc1/tensorflow/python/keras/activations.py#L43-L79) with a workaround for multiple dimensions.  It looks like this was written before the tensorflow op had multi-dimension support. "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35196", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35196/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35196/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35196/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/35196", "id": 539221153, "node_id": "MDExOlB1bGxSZXF1ZXN0MzU0MjM1MDM3", "number": 35196, "title": "Update boringssl to 80ca9f9", "user": {"login": "yongtang", "id": 6932348, "node_id": "MDQ6VXNlcjY5MzIzNDg=", "avatar_url": "https://avatars0.githubusercontent.com/u/6932348?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yongtang", "html_url": "https://github.com/yongtang", "followers_url": "https://api.github.com/users/yongtang/followers", "following_url": "https://api.github.com/users/yongtang/following{/other_user}", "gists_url": "https://api.github.com/users/yongtang/gists{/gist_id}", "starred_url": "https://api.github.com/users/yongtang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yongtang/subscriptions", "organizations_url": "https://api.github.com/users/yongtang/orgs", "repos_url": "https://api.github.com/users/yongtang/repos", "events_url": "https://api.github.com/users/yongtang/events{/privacy}", "received_events_url": "https://api.github.com/users/yongtang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1178505529, "node_id": "MDU6TGFiZWwxMTc4NTA1NTI5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/prtype:bugfix", "name": "prtype:bugfix", "color": "159b2e", "default": false, "description": "PR to fix a bug"}, {"id": 987666414, "node_id": "MDU6TGFiZWw5ODc2NjY0MTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/ready%20to%20pull", "name": "ready to pull", "color": "2cd643", "default": false, "description": ""}, {"id": 1169364259, "node_id": "MDU6TGFiZWwxMTY5MzY0MjU5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:XS", "name": "size:XS", "color": "adafea", "default": false, "description": "CL Change Size: Extra Small"}], "state": "open", "locked": false, "assignee": {"login": "perfinion", "id": 363227, "node_id": "MDQ6VXNlcjM2MzIyNw==", "avatar_url": "https://avatars3.githubusercontent.com/u/363227?v=4", "gravatar_id": "", "url": "https://api.github.com/users/perfinion", "html_url": "https://github.com/perfinion", "followers_url": "https://api.github.com/users/perfinion/followers", "following_url": "https://api.github.com/users/perfinion/following{/other_user}", "gists_url": "https://api.github.com/users/perfinion/gists{/gist_id}", "starred_url": "https://api.github.com/users/perfinion/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/perfinion/subscriptions", "organizations_url": "https://api.github.com/users/perfinion/orgs", "repos_url": "https://api.github.com/users/perfinion/repos", "events_url": "https://api.github.com/users/perfinion/events{/privacy}", "received_events_url": "https://api.github.com/users/perfinion/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "perfinion", "id": 363227, "node_id": "MDQ6VXNlcjM2MzIyNw==", "avatar_url": "https://avatars3.githubusercontent.com/u/363227?v=4", "gravatar_id": "", "url": "https://api.github.com/users/perfinion", "html_url": "https://github.com/perfinion", "followers_url": "https://api.github.com/users/perfinion/followers", "following_url": "https://api.github.com/users/perfinion/following{/other_user}", "gists_url": "https://api.github.com/users/perfinion/gists{/gist_id}", "starred_url": "https://api.github.com/users/perfinion/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/perfinion/subscriptions", "organizations_url": "https://api.github.com/users/perfinion/orgs", "repos_url": "https://api.github.com/users/perfinion/repos", "events_url": "https://api.github.com/users/perfinion/events{/privacy}", "received_events_url": "https://api.github.com/users/perfinion/received_events", "type": "User", "site_admin": false}, {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-12-17T17:54:38Z", "updated_at": "2020-03-17T17:58:25Z", "closed_at": null, "author_association": "MEMBER", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/35196", "html_url": "https://github.com/tensorflow/tensorflow/pull/35196", "diff_url": "https://github.com/tensorflow/tensorflow/pull/35196.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/35196.patch"}, "body": "This PR is trying to resolve the issue in #35179\r\nwhere boringssl was not the latest version. The old version\r\n7f63442 was released one and half year ago so it is time to update.\r\n\r\nThis PR updates boringssl to the latest 80ca9f9.\r\n\r\nThis PR fixes #35179.\r\n\r\nSigned-off-by: Yong Tang <yong.tang.github@outlook.com>"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35194", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35194/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35194/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35194/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35194", "id": 539203494, "node_id": "MDU6SXNzdWU1MzkyMDM0OTQ=", "number": 35194, "title": "Failed to convert weights to 8 bit precision: \"Quantize weights tool only supports tflite models with one subgraph\" ", "user": {"login": "rutrilla", "id": 9933039, "node_id": "MDQ6VXNlcjk5MzMwMzk=", "avatar_url": "https://avatars1.githubusercontent.com/u/9933039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rutrilla", "html_url": "https://github.com/rutrilla", "followers_url": "https://api.github.com/users/rutrilla/followers", "following_url": "https://api.github.com/users/rutrilla/following{/other_user}", "gists_url": "https://api.github.com/users/rutrilla/gists{/gist_id}", "starred_url": "https://api.github.com/users/rutrilla/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rutrilla/subscriptions", "organizations_url": "https://api.github.com/users/rutrilla/orgs", "repos_url": "https://api.github.com/users/rutrilla/repos", "events_url": "https://api.github.com/users/rutrilla/events{/privacy}", "received_events_url": "https://api.github.com/users/rutrilla/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "daverim", "id": 2448933, "node_id": "MDQ6VXNlcjI0NDg5MzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/2448933?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daverim", "html_url": "https://github.com/daverim", "followers_url": "https://api.github.com/users/daverim/followers", "following_url": "https://api.github.com/users/daverim/following{/other_user}", "gists_url": "https://api.github.com/users/daverim/gists{/gist_id}", "starred_url": "https://api.github.com/users/daverim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daverim/subscriptions", "organizations_url": "https://api.github.com/users/daverim/orgs", "repos_url": "https://api.github.com/users/daverim/repos", "events_url": "https://api.github.com/users/daverim/events{/privacy}", "received_events_url": "https://api.github.com/users/daverim/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "daverim", "id": 2448933, "node_id": "MDQ6VXNlcjI0NDg5MzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/2448933?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daverim", "html_url": "https://github.com/daverim", "followers_url": "https://api.github.com/users/daverim/followers", "following_url": "https://api.github.com/users/daverim/following{/other_user}", "gists_url": "https://api.github.com/users/daverim/gists{/gist_id}", "starred_url": "https://api.github.com/users/daverim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daverim/subscriptions", "organizations_url": "https://api.github.com/users/daverim/orgs", "repos_url": "https://api.github.com/users/daverim/repos", "events_url": "https://api.github.com/users/daverim/events{/privacy}", "received_events_url": "https://api.github.com/users/daverim/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-12-17T17:17:21Z", "updated_at": "2020-03-09T16:52:34Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Google Colab (GPU)\r\n- **TensorFlow installed from (source or binary)**: Binary\r\n- **TensorFlow version (use command below)**: 2.1.0-dev20191217 \r\n- **Python version**: 3\r\n- **Exact command to reproduce**:\r\n\r\n```bash\r\n!pip install tf-nightly\r\nimport tensorflow as tf\r\nfrom tensorflow.keras import Sequential\r\nfrom tensorflow.keras.layers import GRU, Dense, Dropout\r\n\r\nmodel = Sequential()\r\nmodel.add(GRU(100, activation='relu', return_sequences=False, input_shape=(128,2)))\r\nmodel.add(Dropout(0.2))\r\nmodel.add(Dense(11, activation='softmax'))\r\n\r\nconverter = tf.lite.TFLiteConverter.from_keras_model(model)\r\nconverter.experimental_new_converter = True\r\ntflite_model = converter.convert()\r\nconverter.optimizations = [tf.lite.Optimize.OPTIMIZE_FOR_SIZE]\r\ntflite_model_quant = converter.convert()\r\n```\r\n\r\n### Error message\r\n```bash\r\nE tensorflow/lite/tools/optimize/quantize_weights.cc:351] Quantize weights tool only supports tflite models with one subgraph.\r\n```\r\n\r\n### Describe the problem\r\nFirst, I used the new converter (with the experimental flag converter.experimental_new_converter = True) to convert an RNN model from TensorFlow to TensorFlow Lite's flat buffer format, as suggested in the issue #32608.\r\n\r\nThis works correctly, but then when I try to perform a post-training weight quantization, I got an error saying that the quantize weights tool only supports tflite models with one subgraph. \r\n\r\nIs there a problem with my procedure? Or is that feature not yet supported? In that case, I would like to request this feature.\r\n\r\nThanks in advance for your help.\r\n\r\n### Source code / logs\r\nThe attached file can be used to reproduce the error with a trained model (.h5). \r\n[GRU_1L.zip](https://github.com/tensorflow/tensorflow/files/3974453/GRU_1L.zip)\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35189", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35189/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35189/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35189/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/35189", "id": 539109488, "node_id": "MDExOlB1bGxSZXF1ZXN0MzU0MTQxNDAx", "number": 35189, "title": "Add TfLite micro ExpandDims reference kernel", "user": {"login": "sicong-li-arm", "id": 58341114, "node_id": "MDQ6VXNlcjU4MzQxMTE0", "avatar_url": "https://avatars1.githubusercontent.com/u/58341114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sicong-li-arm", "html_url": "https://github.com/sicong-li-arm", "followers_url": "https://api.github.com/users/sicong-li-arm/followers", "following_url": "https://api.github.com/users/sicong-li-arm/following{/other_user}", "gists_url": "https://api.github.com/users/sicong-li-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/sicong-li-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sicong-li-arm/subscriptions", "organizations_url": "https://api.github.com/users/sicong-li-arm/orgs", "repos_url": "https://api.github.com/users/sicong-li-arm/repos", "events_url": "https://api.github.com/users/sicong-li-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/sicong-li-arm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 1169365682, "node_id": "MDU6TGFiZWwxMTY5MzY1Njgy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:L", "name": "size:L", "color": "adafea", "default": false, "description": "CL Change Size: Large"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-12-17T14:40:53Z", "updated_at": "2020-02-28T11:05:50Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/35189", "html_url": "https://github.com/tensorflow/tensorflow/pull/35189", "diff_url": "https://github.com/tensorflow/tensorflow/pull/35189.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/35189.patch"}, "body": "Add TfLite micro ExpandDims reference kernel and tests (int8, uint8, float32)\r\n\r\nSigned-off-by: SiCongLi <sicong.li@arm.com>"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35186", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35186/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35186/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35186/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/35186", "id": 539093052, "node_id": "MDExOlB1bGxSZXF1ZXN0MzU0MTI3NDA3", "number": 35186, "title": "Add TfLite micro Squeeze reference kernel", "user": {"login": "sicong-li-arm", "id": 58341114, "node_id": "MDQ6VXNlcjU4MzQxMTE0", "avatar_url": "https://avatars1.githubusercontent.com/u/58341114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sicong-li-arm", "html_url": "https://github.com/sicong-li-arm", "followers_url": "https://api.github.com/users/sicong-li-arm/followers", "following_url": "https://api.github.com/users/sicong-li-arm/following{/other_user}", "gists_url": "https://api.github.com/users/sicong-li-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/sicong-li-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sicong-li-arm/subscriptions", "organizations_url": "https://api.github.com/users/sicong-li-arm/orgs", "repos_url": "https://api.github.com/users/sicong-li-arm/repos", "events_url": "https://api.github.com/users/sicong-li-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/sicong-li-arm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 1169365682, "node_id": "MDU6TGFiZWwxMTY5MzY1Njgy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:L", "name": "size:L", "color": "adafea", "default": false, "description": "CL Change Size: Large"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2019-12-17T14:14:57Z", "updated_at": "2020-03-11T08:55:37Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/35186", "html_url": "https://github.com/tensorflow/tensorflow/pull/35186", "diff_url": "https://github.com/tensorflow/tensorflow/pull/35186.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/35186.patch"}, "body": "Add TfLite micro Squeeze reference kernel and tests (uint8, int8, float32).\r\n\r\nSigned-off-by: SiCongLi <sicong.li@arm.com>"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35181", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35181/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35181/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35181/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35181", "id": 538985531, "node_id": "MDU6SXNzdWU1Mzg5ODU1MzE=", "number": 35181, "title": "DropoutWrapper and Exploding gradient behaviour for Recurrent Neural Network", "user": {"login": "tanodino", "id": 25769141, "node_id": "MDQ6VXNlcjI1NzY5MTQx", "avatar_url": "https://avatars3.githubusercontent.com/u/25769141?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanodino", "html_url": "https://github.com/tanodino", "followers_url": "https://api.github.com/users/tanodino/followers", "following_url": "https://api.github.com/users/tanodino/following{/other_user}", "gists_url": "https://api.github.com/users/tanodino/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanodino/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanodino/subscriptions", "organizations_url": "https://api.github.com/users/tanodino/orgs", "repos_url": "https://api.github.com/users/tanodino/repos", "events_url": "https://api.github.com/users/tanodino/events{/privacy}", "received_events_url": "https://api.github.com/users/tanodino/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 1166103538, "node_id": "MDU6TGFiZWwxMTY2MTAzNTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/contrib", "name": "contrib", "color": "5319e7", "default": false, "description": "Anything that comes under contrib directory"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "qlzh727", "id": 5118881, "node_id": "MDQ6VXNlcjUxMTg4ODE=", "avatar_url": "https://avatars3.githubusercontent.com/u/5118881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qlzh727", "html_url": "https://github.com/qlzh727", "followers_url": "https://api.github.com/users/qlzh727/followers", "following_url": "https://api.github.com/users/qlzh727/following{/other_user}", "gists_url": "https://api.github.com/users/qlzh727/gists{/gist_id}", "starred_url": "https://api.github.com/users/qlzh727/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qlzh727/subscriptions", "organizations_url": "https://api.github.com/users/qlzh727/orgs", "repos_url": "https://api.github.com/users/qlzh727/repos", "events_url": "https://api.github.com/users/qlzh727/events{/privacy}", "received_events_url": "https://api.github.com/users/qlzh727/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "qlzh727", "id": 5118881, "node_id": "MDQ6VXNlcjUxMTg4ODE=", "avatar_url": "https://avatars3.githubusercontent.com/u/5118881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qlzh727", "html_url": "https://github.com/qlzh727", "followers_url": "https://api.github.com/users/qlzh727/followers", "following_url": "https://api.github.com/users/qlzh727/following{/other_user}", "gists_url": "https://api.github.com/users/qlzh727/gists{/gist_id}", "starred_url": "https://api.github.com/users/qlzh727/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qlzh727/subscriptions", "organizations_url": "https://api.github.com/users/qlzh727/orgs", "repos_url": "https://api.github.com/users/qlzh727/repos", "events_url": "https://api.github.com/users/qlzh727/events{/privacy}", "received_events_url": "https://api.github.com/users/qlzh727/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-12-17T10:46:15Z", "updated_at": "2019-12-23T23:36:38Z", "closed_at": null, "author_association": "NONE", "body": "Dear all,\r\n I have a point about DropoutWrapper and its use with Recurrent Neural Networks.\r\n\r\nDue to the possibility that the dropout can be applied to the state or the output (state_keep_prob and output_keep_prob), I found that, during the recurrent process, the state propagated through the time can take values not bounded in the interval [-1, 1]. This is probably due to the way in which the dropout is implemented (at training time with a scaling instead of testing time with expectation). Since the dropout is applied after the activation (i.e. tanh), the feature values will range between -inf and +inf. This point is a bit strange for me since the current implementation can induce exploding gradient issues in the GRU/LSTM process while such cells were introduced to deal with vanishing as well as exploding gradients.\r\n\r\nPlease, could you supply me some feedback about my issue since, practically, it can impact people that commonly employ such Wrapper that induces behaviours that are divergent w.r.t. the theoretical behaviour of RNN (GRU/LSTM).\r\n\r\nAll the best\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35180", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35180/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35180/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35180/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35180", "id": 538902009, "node_id": "MDU6SXNzdWU1Mzg5MDIwMDk=", "number": 35180, "title": "Windows build failed - Internal compiler error Visual Studio 2017 - FAILED: Build did NOT complete successfully", "user": {"login": "giaxxi", "id": 4654167, "node_id": "MDQ6VXNlcjQ2NTQxNjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/4654167?v=4", "gravatar_id": "", "url": "https://api.github.com/users/giaxxi", "html_url": "https://github.com/giaxxi", "followers_url": "https://api.github.com/users/giaxxi/followers", "following_url": "https://api.github.com/users/giaxxi/following{/other_user}", "gists_url": "https://api.github.com/users/giaxxi/gists{/gist_id}", "starred_url": "https://api.github.com/users/giaxxi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/giaxxi/subscriptions", "organizations_url": "https://api.github.com/users/giaxxi/orgs", "repos_url": "https://api.github.com/users/giaxxi/repos", "events_url": "https://api.github.com/users/giaxxi/events{/privacy}", "received_events_url": "https://api.github.com/users/giaxxi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1188421838, "node_id": "MDU6TGFiZWwxMTg4NDIxODM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:windows", "name": "subtype:windows", "color": "b619ea", "default": false, "description": "Windows Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-12-17T08:02:53Z", "updated_at": "2019-12-20T00:36:16Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution: Windows 7 Professional SP1 64 bit\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version: tensorflow-master (downloaded 18/12/2019)\r\n- Python version: 3.7\r\n- Installed using virtualenv? pip? conda?: YES, conda\r\n- Bazel version (if compiling from source): 1.1.0\r\n- GCC/Compiler version (if compiling from source): MSVC 14.16.27023 (Visual Studio 2017)\r\n- CUDA/cuDNN version: build for CPU\r\n- GPU model and memory: (Quadro K200M)\r\n\r\n**Describe the problem**\r\nFollowed this guide: https://www.tensorflow.org/install/source_windows and just build failed.\r\nI tested different combinations (https://www.tensorflow.org/install/source_windows#cpu) and I was just able to compile just the **r1.14 successfully**, by the way.\r\n**r2.0** failed with the same message as master.\r\nBut back to master release.\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n\r\n- Donwloaded the `tensorflow-master.zip` from github\r\n- Installed Bazel version 1.1.0\r\n- cmd to folder `\\tensorflow-master`\r\n- `activate python37 environment` (conda)\r\n- Set env var for bazel: `set BAZEL_VC=C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\VC`\r\n- Check Bazel version\r\n```\r\n(python37) C:\\Users\\username\\bin\\tensorflow-master>bazel --version\r\nbazel 1.1.0\r\n```\r\n- Configure\r\n```\r\n(python37) C:\\Users\\ username\\bin\\tensorflow-master>python ./configure.py\r\nYou have bazel 1.1.0 installed.\r\nPlease specify the location of python. [Default is C:\\Users\\ username\\Anaconda3\\envs\\python37\\python.exe]:\r\n\r\nFound possible Python library paths:\r\n  C:\\Users\\ username\\Anaconda3\\envs\\python37\\lib\\site-packages\r\nPlease input the desired Python library path to use.  Default is [C:\\Users\\ username\\Anaconda3\\envs\\python37\\lib\\site-packages]\r\n\r\nDo you wish to build TensorFlow with XLA JIT support? [y/N]: n\r\nNo XLA JIT support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with ROCm support? [y/N]: n\r\nNo ROCm support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with CUDA support? [y/N]: n\r\nNo CUDA support will be enabled for TensorFlow.\r\n\r\nPlease specify optimization flags to use during compilation when bazel option \"--config=opt\" is specified [Default is /arch:AVX]:\r\n\r\nWould you like to override eigen strong inline for some C++ compilation to reduce the compilation time? [Y/n]: y\r\nEigen strong inline overridden.\r\n```\r\n- Launch the compilation: `bazel build //tensorflow:tensorflow_cc.lib`\r\n- After time elapsed the process ended with: `FAILED: Build did NOT complete successfully`\r\n\r\n**Any other info / logs**\r\nJust attaching the last rows of the terminal messages\r\n\r\nMessage has Italian chunks of which I'm trying to provide a translation here:\r\n```\r\nnote: vedere il riferimento all'istanza '<Sconosciuto>' della funzione <Sconosciuto> di cui \u00e8 in corso la compilazione\r\nnote: check the reference to instance '<Unknown>' of the function <Unknown> which is compiling\r\n```\r\n\r\n```\r\nErrore interno del compilatore in C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\VC\\Tools\\MSVC\\14.16.27023\\bin\\HostX64\\x64\\cl.exe. Verr\u00e0 richiesto di inviare una segnalazione errori a Microsoft in un momento successivo.\r\nInternal error of the compiler in C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\VC\\Tools\\MSVC\\14.16.27023\\bin\\HostX64\\x64\\cl.exe. It will be required to send an error report to Microsoft next.\r\n```\r\n\r\n```\r\nERRORE INTERNO DEL COMPILATORE in 'C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\VC\\Tools\\MSVC\\14.16.27023\\bin\\HostX64\\x64\\cl.exe' Per altre informazioni, scegliere Supporto tecnico dal menu ? di Visual C++ o aprire il file della Guida relativo al supporto tecnico\r\nINTERNAL ERROR OF THE COMPILER in 'C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\VC\\Tools\\MSVC\\14.16.27023\\bin\\HostX64\\x64\\cl.exe' For more information, choose Technical support from ? menu of Visual C++ or open the file from the guide related with technical support\r\n```\r\n\r\n[tensorflow-master-build-fail-log.txt](https://github.com/tensorflow/tensorflow/files/3971998/tensorflow-master-build-fail-log.txt)\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35178", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35178/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35178/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35178/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35178", "id": 538885627, "node_id": "MDU6SXNzdWU1Mzg4ODU2Mjc=", "number": 35178, "title": "missing symbols from c++ API", "user": {"login": "robosina", "id": 14973524, "node_id": "MDQ6VXNlcjE0OTczNTI0", "avatar_url": "https://avatars1.githubusercontent.com/u/14973524?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robosina", "html_url": "https://github.com/robosina", "followers_url": "https://api.github.com/users/robosina/followers", "following_url": "https://api.github.com/users/robosina/following{/other_user}", "gists_url": "https://api.github.com/users/robosina/gists{/gist_id}", "starred_url": "https://api.github.com/users/robosina/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robosina/subscriptions", "organizations_url": "https://api.github.com/users/robosina/orgs", "repos_url": "https://api.github.com/users/robosina/repos", "events_url": "https://api.github.com/users/robosina/events{/privacy}", "received_events_url": "https://api.github.com/users/robosina/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 1104829434, "node_id": "MDU6TGFiZWwxMTA0ODI5NDM0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:mkl", "name": "comp:mkl", "color": "0052cc", "default": false, "description": ""}, {"id": 1188421838, "node_id": "MDU6TGFiZWwxMTg4NDIxODM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:windows", "name": "subtype:windows", "color": "b619ea", "default": false, "description": "Windows Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "TensorFlow-MKL", "id": 44416303, "node_id": "MDQ6VXNlcjQ0NDE2MzAz", "avatar_url": "https://avatars2.githubusercontent.com/u/44416303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TensorFlow-MKL", "html_url": "https://github.com/TensorFlow-MKL", "followers_url": "https://api.github.com/users/TensorFlow-MKL/followers", "following_url": "https://api.github.com/users/TensorFlow-MKL/following{/other_user}", "gists_url": "https://api.github.com/users/TensorFlow-MKL/gists{/gist_id}", "starred_url": "https://api.github.com/users/TensorFlow-MKL/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TensorFlow-MKL/subscriptions", "organizations_url": "https://api.github.com/users/TensorFlow-MKL/orgs", "repos_url": "https://api.github.com/users/TensorFlow-MKL/repos", "events_url": "https://api.github.com/users/TensorFlow-MKL/events{/privacy}", "received_events_url": "https://api.github.com/users/TensorFlow-MKL/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "TensorFlow-MKL", "id": 44416303, "node_id": "MDQ6VXNlcjQ0NDE2MzAz", "avatar_url": "https://avatars2.githubusercontent.com/u/44416303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TensorFlow-MKL", "html_url": "https://github.com/TensorFlow-MKL", "followers_url": "https://api.github.com/users/TensorFlow-MKL/followers", "following_url": "https://api.github.com/users/TensorFlow-MKL/following{/other_user}", "gists_url": "https://api.github.com/users/TensorFlow-MKL/gists{/gist_id}", "starred_url": "https://api.github.com/users/TensorFlow-MKL/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TensorFlow-MKL/subscriptions", "organizations_url": "https://api.github.com/users/TensorFlow-MKL/orgs", "repos_url": "https://api.github.com/users/TensorFlow-MKL/repos", "events_url": "https://api.github.com/users/TensorFlow-MKL/events{/privacy}", "received_events_url": "https://api.github.com/users/TensorFlow-MKL/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-12-17T07:23:05Z", "updated_at": "2020-03-02T15:21:25Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform: Windows10\r\n- TensorFlow installed from:source\r\n- TensorFlow version:1.13.0\r\n- Python version: NO\r\n- Bazel version (if compiling from source):0.19\r\n- GCC/Compiler version: msvc14\r\n\r\n\r\n\r\n**Describe the problem**\r\nI want to build tensorflow from the source using the below command \r\n`bazel build -c opt  --config=mkl --config=monolithic --linkopt=\"/FORCE:MULTIPLE\" --define=no_tensorflow_py_deps=true //tensorflow:libtensorflow_cc.so //tensorflow:install_headers   //tensorflow/tools/lib_package:libtensorflow --verbose_failures`\r\n\r\nHowever after the dll file generated, some symbol is not inside of the dll, I will paste some of this error in here(As far as I know this problem is accured because number of symbol is limited in windows, So all functions in tensorflow source can't be exported( I _check the exported function using dumpbin.exe /EXPORT and it's weird because only 3000 symbols is exported )_\r\n`tfwrapper.obj : error LNK2001: unresolved external symbol \"class tensorflow::Output __cdecl tensorflow::ops::Const(class tensorflow::Scope const &,struct tensorflow::Input::Initializer const &)\" (?Const@ops@tensorflow@@YA?AVOutput@2@AEBVScope@2@AEBUInitializer@Input@2@@Z)`\r\n\r\n\r\n`tfwrapper.obj : error LNK2001: unresolved external symbol \"public: __cdecl tensorflow::ops::DecodePng::DecodePng(class tensorflow::Scope const &,class tensorflow::Input,struct tensorflow::ops::DecodePng::Attrs const &)\" (??0DecodePng@ops@tensorflow@@QEAA@AEBVScope@2@VInput@2@AEBUAttrs@012@@Z)`\r\n\r\n\r\n`tfwrapper.obj : error LNK2001: unresolved external symbol \"public: __cdecl tensorflow::ops::Placeholder::Placeholder(class tensorflow::Scope const &,enum tensorflow::DataType)\" (??0Placeholder@ops@tensorflow@@QEAA@AEBVScope@2@W4DataType@2@@Z)`\r\n\r\nand for solving this issue I work on two idea\r\n **first one** is using `def_file_filter.py.tpl`, as may you know in this file I have to add missed symbol to it like below(I just paste some of them in here) and reconfigure & recompile the source(I guess). But this solution can't export any of this missing symbol for me\r\n\r\n     # Header for the def file.\r\n     def_fp.write(\"LIBRARY \" + args.target + \"\\n\")\r\n    def_fp.write(\"EXPORTS\\n\")\r\n    def_fp.write(\"\\t ??1OpDef@tensorflow@@UEAA@XZ\\n\")\r\n\tdef_fp.write(\"\\t ??0DecodePng@ops@tensorflow@@QEAA@AEBVScope@2@VInput@2@AEBUAttrs@012@@Z\\n\")\r\n\tdef_fp.write(\"\\t ??6tensorflow@@YAAEAV?$basic_ostream@DU?$char_traits@D@std@@@std@@AEAV12@AEBVStatus@0@@Z\\n\")`\r\n\r\n\r\nSo, I can't solve my problem using this method. So I use another Idea that I got this Idea from `ashley tharp` (you can see her great work in this[ link](https://github.com/robosina/stuff/tree/master/ai/tensorflow/build_tensorflow_1.14_source_for_Windows)) and this workaround solve 8 of this problems. Main idea of her is to add `TF_EXPORT` macro to the function names to force symbol to include in the dll file. but my problem is raised in the DecodePng file, there is a function in tensorflow source ->`tensorflow/core/kernels/decode_image_op.cc` the function signature is \r\n     \r\n     void DecodePng(OpKernelContext* context, StringPiece input)\r\n I can't find any other. But in examples of the tensorflow we will see this way to read png files\r\n\r\n    image_reader = DecodePng(root.WithOpName(\"png_reader\"), file_reader,\r\n                             DecodePng::Channels(wanted_channels));\r\nthis two function is not same and I couldn't find this function in the tensorflow source code so I can't add `TF_EXPORT` macro to it, but how it is possible to use a function that is not present in source code?? So I look in the bazel genereated files and this function is in there.(it is in `bazel-source/bazel-out/x64_windows-opt/genfiles/tensorflow/cc/ops/image_ops.h`)\r\n\r\n     DecodePng(const ::tensorflow::Scope& scope, ::tensorflow::Input contents);\r\n     DecodePng(const ::tensorflow::Scope& scope, ::tensorflow::Input contents, const\r\n          DecodePng::Attrs& attrs);\r\n\r\n I don't know exactly how bazel created it and how to add `TF_EXPORT` macro to it(because this files is machine generated files and you can't add TF_EXPORT to it, because it will be overwritten in compile time)"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35177", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35177/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35177/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35177/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35177", "id": 538880253, "node_id": "MDU6SXNzdWU1Mzg4ODAyNTM=", "number": 35177, "title": "tensorflow c++ Not found: Op type not registered 'ImageProjectiveTransformV2'", "user": {"login": "anhtu812", "id": 24753367, "node_id": "MDQ6VXNlcjI0NzUzMzY3", "avatar_url": "https://avatars0.githubusercontent.com/u/24753367?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anhtu812", "html_url": "https://github.com/anhtu812", "followers_url": "https://api.github.com/users/anhtu812/followers", "following_url": "https://api.github.com/users/anhtu812/following{/other_user}", "gists_url": "https://api.github.com/users/anhtu812/gists{/gist_id}", "starred_url": "https://api.github.com/users/anhtu812/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anhtu812/subscriptions", "organizations_url": "https://api.github.com/users/anhtu812/orgs", "repos_url": "https://api.github.com/users/anhtu812/repos", "events_url": "https://api.github.com/users/anhtu812/events{/privacy}", "received_events_url": "https://api.github.com/users/anhtu812/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-12-17T07:09:46Z", "updated_at": "2020-01-02T07:03:55Z", "closed_at": null, "author_association": "NONE", "body": "I run my c++ code, it load file .pb have op tf.contrib.image.transform() and out error:\r\n```\r\nNot found: Op type not registered 'ImageProjectiveTransformV2' in binary running on mendel. Make sure the Op and Kernel are registered in the binary running in this process. Note that if you are loading a saved graph which used ops from tf.contrib, accessing (e.g.) `tf.contrib.resampler` should be done before importing the graph, as contrib ops are lazily registered when the module is first accessed.\r\n```\r\n\r\nI use tensorflow 1.14 build from source on ubuntu16.04.\r\nHow to build to use op ImageProjectiveTransformV2 ?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35170", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35170/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35170/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35170/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35170", "id": 538789839, "node_id": "MDU6SXNzdWU1Mzg3ODk4Mzk=", "number": 35170, "title": "tensorflow-lite-gpu.aar built from source is much slower than downloaded prebuilt library", "user": {"login": "gimgane", "id": 56623844, "node_id": "MDQ6VXNlcjU2NjIzODQ0", "avatar_url": "https://avatars0.githubusercontent.com/u/56623844?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gimgane", "html_url": "https://github.com/gimgane", "followers_url": "https://api.github.com/users/gimgane/followers", "following_url": "https://api.github.com/users/gimgane/following{/other_user}", "gists_url": "https://api.github.com/users/gimgane/gists{/gist_id}", "starred_url": "https://api.github.com/users/gimgane/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gimgane/subscriptions", "organizations_url": "https://api.github.com/users/gimgane/orgs", "repos_url": "https://api.github.com/users/gimgane/repos", "events_url": "https://api.github.com/users/gimgane/events{/privacy}", "received_events_url": "https://api.github.com/users/gimgane/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2019-12-17T02:10:46Z", "updated_at": "2019-12-20T06:39:06Z", "closed_at": null, "author_association": "NONE", "body": "### **System information**\r\n- OS Platform and Distribution: Linux Ubuntu 16.04\r\n- Mobile device: LG G7\r\n- TensorFlow installed from (source or binary): Source\r\n- TensorFlow version: r2.0\r\n- Python version: 3.5\r\n- Bazel version: 0.24.1\r\n- Android NDK version: r17c\r\n- GCC/Compiler version (if compiling from source): GCC 4.8\r\n\r\n\r\n\r\n### **Describe the problem**\r\nBuilt Tensorflow lite from source, but the inference is about 3 times slower than original.\r\n(What I mean by 'original' is the prebuilt tensorflow-lite downloaded from Maven repository.)\r\nFor example, the model which originally costs 20 ms on GPU takes 50 ms.\r\nI tried different versions of Tensorflow and Android NDK but resulted all same.\r\n\r\nBelow is the process I've done to build tensorflow lite libraries.\r\n\r\n\r\n**1. Download Tensorflow source code from github**\r\n```shell\r\n$ git clone https://github.com/tensorflow/tensorflow.git\r\n$ git checkout r2.0\r\n```\r\n\r\n**2. Download Android NDK and install standalone toolchains**\r\nDownload NDK r17c from [here](https://developer.android.com/ndk/downloads/older_releases.html).\r\nExtract files and move to Android Sdk directory.\r\n```shell\r\n$ cd Android/Sdk/android-ndk-r17c\r\n$ python build/tools/make_standalone_toolchain.py --arch arm64 --api 21\r\n$ export ANDROID_NDK=/path/to/ndk\r\n$ export ANDROID_NDK_HOME=$ANDROID_NDK\r\n```\r\n\r\n**3. Download and install Bazel**\r\nDownload installer script from [here](https://github.com/bazelbuild/bazel/releases/0.24.1).\r\n```shell\r\n$ cd /path/to/download\r\n$ chmod +x bazel-0.24.1-installer-linux-x86_64.sh\r\n$ ./bazel-0.24.1-installer-linux-x86_64.sh --user\r\n```\r\n\r\n**4. Build tensorflow-lite.aar and tensorflow-lite-gpu.aar**\r\n```shell\r\n$ cd tensorflow\r\n$ ./configure\r\n$ bazel build --cxxopt='--std=c++11' -c opt --fat_apk_cpu=arm64-v8a,armeabi-v7a tensorflow/lite/java:tensorflow-lite\r\n$ bazel build --cxxopt='--std=c++11' -c opt --fat_apk_cpu=arm64-v8a,armeabi-v7a tensorflow/lite/java:tensorflow-lite-gpu\r\n```\r\nOn `./configure`, set all 'n' for support question and leave others on default.\r\n\r\n| Configuration | Value |\r\n| --- | --- |\r\n| XLA JIT support | No |\r\n| OpenCL SYCL support | No |\r\n| ROCm support | No |\r\n| CUDA support | No |\r\n| Fresh released clang | No |\r\n| MPI support | No |\r\n| Bazel comilation option | Default |\r\n| Android ./WORKSPACE configuration | Yes |\r\n| Android NDK API level | 22 |\r\n| Android SDK path | Default |\r\n| Android SDK API level | Default (29) |\r\n| Android build tools version | Default (29.0.2) |\r\n\r\n**5. Import libraries to Android project**\r\nCopy the generated `.aar` files into Android project, and change `build.gradle` file:\r\n\r\n```gradle\r\ndependencies {\r\n    ...\r\n    implementation files('libs/tensorflow-lite.aar')\r\n    implementation files('libs/tensorflow-lite-gpu.aar')\r\n\r\n    // implementation 'org.tensorflow:tensorflow-lite:2.0.0'\r\n    // implementation 'org.tensorflow:tensorflow-lite-gpu:2.0.0'\r\n}\r\n```\r\n\r\n\r\n\r\nAny suggestion or help will be appreciated.\r\nThanks in advance."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35168", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35168/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35168/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35168/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35168", "id": 538731432, "node_id": "MDU6SXNzdWU1Mzg3MzE0MzI=", "number": 35168, "title": "Provided LSTM example doesn't work.", "user": {"login": "mpariente", "id": 18496796, "node_id": "MDQ6VXNlcjE4NDk2Nzk2", "avatar_url": "https://avatars2.githubusercontent.com/u/18496796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpariente", "html_url": "https://github.com/mpariente", "followers_url": "https://api.github.com/users/mpariente/followers", "following_url": "https://api.github.com/users/mpariente/following{/other_user}", "gists_url": "https://api.github.com/users/mpariente/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpariente/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpariente/subscriptions", "organizations_url": "https://api.github.com/users/mpariente/orgs", "repos_url": "https://api.github.com/users/mpariente/repos", "events_url": "https://api.github.com/users/mpariente/events{/privacy}", "received_events_url": "https://api.github.com/users/mpariente/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "renjie-liu", "id": 36247193, "node_id": "MDQ6VXNlcjM2MjQ3MTkz", "avatar_url": "https://avatars3.githubusercontent.com/u/36247193?v=4", "gravatar_id": "", "url": "https://api.github.com/users/renjie-liu", "html_url": "https://github.com/renjie-liu", "followers_url": "https://api.github.com/users/renjie-liu/followers", "following_url": "https://api.github.com/users/renjie-liu/following{/other_user}", "gists_url": "https://api.github.com/users/renjie-liu/gists{/gist_id}", "starred_url": "https://api.github.com/users/renjie-liu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/renjie-liu/subscriptions", "organizations_url": "https://api.github.com/users/renjie-liu/orgs", "repos_url": "https://api.github.com/users/renjie-liu/repos", "events_url": "https://api.github.com/users/renjie-liu/events{/privacy}", "received_events_url": "https://api.github.com/users/renjie-liu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "renjie-liu", "id": 36247193, "node_id": "MDQ6VXNlcjM2MjQ3MTkz", "avatar_url": "https://avatars3.githubusercontent.com/u/36247193?v=4", "gravatar_id": "", "url": "https://api.github.com/users/renjie-liu", "html_url": "https://github.com/renjie-liu", "followers_url": "https://api.github.com/users/renjie-liu/followers", "following_url": "https://api.github.com/users/renjie-liu/following{/other_user}", "gists_url": "https://api.github.com/users/renjie-liu/gists{/gist_id}", "starred_url": "https://api.github.com/users/renjie-liu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/renjie-liu/subscriptions", "organizations_url": "https://api.github.com/users/renjie-liu/orgs", "repos_url": "https://api.github.com/users/renjie-liu/repos", "events_url": "https://api.github.com/users/renjie-liu/events{/privacy}", "received_events_url": "https://api.github.com/users/renjie-liu/received_events", "type": "User", "site_admin": false}, {"login": "jianlijianli", "id": 43797323, "node_id": "MDQ6VXNlcjQzNzk3MzIz", "avatar_url": "https://avatars3.githubusercontent.com/u/43797323?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jianlijianli", "html_url": "https://github.com/jianlijianli", "followers_url": "https://api.github.com/users/jianlijianli/followers", "following_url": "https://api.github.com/users/jianlijianli/following{/other_user}", "gists_url": "https://api.github.com/users/jianlijianli/gists{/gist_id}", "starred_url": "https://api.github.com/users/jianlijianli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jianlijianli/subscriptions", "organizations_url": "https://api.github.com/users/jianlijianli/orgs", "repos_url": "https://api.github.com/users/jianlijianli/repos", "events_url": "https://api.github.com/users/jianlijianli/events{/privacy}", "received_events_url": "https://api.github.com/users/jianlijianli/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-12-16T23:08:02Z", "updated_at": "2020-01-27T21:01:42Z", "closed_at": null, "author_association": "NONE", "body": "@tensorflow/micro\r\n\r\n**System information**\r\n- Host OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04\r\n- TensorFlow installed from (source or binary): `pip install tensorflow`\r\n- Tensorflow version (commit SHA if source): 1.15.0\r\n\r\n**Describe the problem**\r\nThe example provided [here](https://github.com/tensorflow/tensorflow/tree/master/tensorflow/lite/experimental/examples/lstm/g3doc) doesn't work.\r\n**Please provide the exact sequence of commands/steps when you ran into the problem**\r\nIf I put together the example, it gives this : \r\n```\r\n# Note this needs to happen before import tensorflow.\r\nimport os\r\nos.environ['TF_ENABLE_CONTROL_FLOW_V2'] = '1'\r\nimport sys\r\nfrom absl import app\r\nimport argparse\r\nimport tensorflow as tf\r\n\r\n\r\nclass MnistLstmModel(object):\r\n  \"\"\"Build a simple LSTM based MNIST model.\r\n\r\n  Attributes:\r\n    time_steps: The maximum length of the time_steps, but since we're just using\r\n      the 'width' dimension as time_steps, it's actually a fixed number.\r\n    input_size: The LSTM layer input size.\r\n    num_lstm_layer: Number of LSTM layers for the stacked LSTM cell case.\r\n    num_lstm_units: Number of units in the LSTM cell.\r\n    units: The units for the last layer.\r\n    num_class: Number of classes to predict.\r\n  \"\"\"\r\n\r\n  def __init__(self, time_steps, input_size, num_lstm_layer, num_lstm_units,\r\n               units, num_class):\r\n    self.time_steps = time_steps\r\n    self.input_size = input_size\r\n    self.num_lstm_layer = num_lstm_layer\r\n    self.num_lstm_units = num_lstm_units\r\n    self.units = units\r\n    self.num_class = num_class\r\n\r\n  def build_model(self):\r\n    \"\"\"Build the model using the given configs.\r\n\r\n    Returns:\r\n      x: The input placehoder tensor.\r\n      logits: The logits of the output.\r\n      output_class: The prediction.\r\n    \"\"\"\r\n    x = tf.placeholder(\r\n        'float32', [None, self.time_steps, self.input_size], name='INPUT')\r\n    lstm_layers = []\r\n    for _ in range(self.num_lstm_layer):\r\n      lstm_layers.append(\r\n          # Important:\r\n          #\r\n          # Note here, we use `tf.lite.experimental.nn.TFLiteLSTMCell`\r\n          # (OpHinted LSTMCell).\r\n          tf.lite.experimental.nn.TFLiteLSTMCell(\r\n              self.num_lstm_units, forget_bias=0))\r\n    # Weights and biases for output softmax layer.\r\n    out_weights = tf.Variable(tf.random.normal([self.units, self.num_class]))\r\n    out_bias = tf.Variable(tf.zeros([self.num_class]))\r\n\r\n    # Transpose input x to make it time major.\r\n    lstm_inputs = tf.transpose(x, perm=[1, 0, 2])\r\n    lstm_cells = tf.keras.layers.StackedRNNCells(lstm_layers)\r\n    # Important:\r\n    #\r\n    # Note here, we use `tf.lite.experimental.nn.dynamic_rnn` and `time_major`\r\n    # is set to True.\r\n    outputs, _ = tf.lite.experimental.nn.dynamic_rnn(\r\n        lstm_cells, lstm_inputs, dtype='float32', time_major=True)\r\n\r\n    # Transpose the outputs back to [batch, time, output]\r\n    outputs = tf.transpose(outputs, perm=[1, 0, 2])\r\n    outputs = tf.unstack(outputs, axis=1)\r\n    logits = tf.matmul(outputs[-1], out_weights) + out_bias\r\n    output_class = tf.nn.softmax(logits, name='OUTPUT_CLASS')\r\n\r\n    return x, logits, output_class\r\n\r\ndef train(model,\r\n          model_dir,\r\n          batch_size=20,\r\n          learning_rate=0.001,\r\n          train_steps=200,\r\n          eval_steps=50,\r\n          save_every_n_steps=100):\r\n  \"\"\"Train & save the MNIST recognition model.\"\"\"\r\n  # Train & test dataset.\r\n  (x_train, y_train), (x_test, y_test) = tf.keras.datasets.mnist.load_data()\r\n  train_dataset = tf.data.Dataset.from_tensor_slices((x_train, y_train))\r\n  train_iterator = train_dataset.shuffle(\r\n      buffer_size=1000).batch(batch_size).repeat().make_one_shot_iterator()\r\n  x, logits, output_class = model.build_model()\r\n  test_dataset = tf.data.Dataset.from_tensor_slices((x_test, y_test))\r\n  test_iterator = test_dataset.batch(\r\n      batch_size).repeat().make_one_shot_iterator()\r\n  # input label placeholder\r\n  y = tf.placeholder(tf.int32, [\r\n      None,\r\n  ])\r\n  one_hot_labels = tf.one_hot(y, depth=model.num_class)\r\n  # Loss function\r\n  loss = tf.reduce_mean(\r\n      tf.nn.softmax_cross_entropy_with_logits(\r\n          logits=logits, labels=one_hot_labels))\r\n  correct = tf.nn.in_top_k(output_class, y, 1)\r\n  accuracy = tf.reduce_mean(tf.cast(correct, tf.float32))\r\n  # Optimization\r\n  opt = tf.train.AdamOptimizer(learning_rate=learning_rate).minimize(loss)\r\n\r\n  # Initialize variables\r\n  init = tf.global_variables_initializer()\r\n  saver = tf.train.Saver()\r\n  batch_x, batch_y = train_iterator.get_next()\r\n  batch_test_x, batch_test_y = test_iterator.get_next()\r\n  with tf.Session() as sess:\r\n    sess.run([init])\r\n    for i in range(train_steps):\r\n      batch_x_value, batch_y_value = sess.run([batch_x, batch_y])\r\n      _, loss_value = sess.run([opt, loss],\r\n                               feed_dict={\r\n                                   x: batch_x_value,\r\n                                   y: batch_y_value\r\n                               })\r\n      if i % 100 == 0:\r\n        tf.logging.info('Training step %d, loss is %f' % (i, loss_value))\r\n      if i > 0 and i % save_every_n_steps == 0:\r\n        accuracy_sum = 0.0\r\n        for _ in range(eval_steps):\r\n          test_x_value, test_y_value = sess.run([batch_test_x, batch_test_y])\r\n          accuracy_value = sess.run(\r\n              accuracy, feed_dict={\r\n                  x: test_x_value,\r\n                  y: test_y_value\r\n              })\r\n          accuracy_sum += accuracy_value\r\n        tf.logging.info('Training step %d, accuracy is %f' %\r\n                        (i, accuracy_sum / (eval_steps * 1.0)))\r\n        saver.save(sess, model_dir)\r\n\r\ndef export(model, model_dir, tflite_model_file,\r\n           use_post_training_quantize=True):\r\n  \"\"\"Export trained model to tflite model.\"\"\"\r\n  tf.reset_default_graph()\r\n  x, _, output_class = model.build_model()\r\n  saver = tf.train.Saver()\r\n  sess = tf.Session()\r\n  saver.restore(sess, model_dir)\r\n  # Convert to Tflite model.\r\n  converter = tf.lite.TFLiteConverter.from_session(sess, [x], [output_class])\r\n  converter.post_training_quantize = use_post_training_quantize\r\n  tflite = converter.convert()\r\n  with open(tflite_model_file, 'w') as f:\r\n    f.write(tflite)\r\n\r\ndef train_and_export(parsed_flags):\r\n  \"\"\"Train the MNIST LSTM model and export to TfLite.\"\"\"\r\n  model = MnistLstmModel(\r\n      time_steps=28,\r\n      input_size=28,\r\n      num_lstm_layer=2,\r\n      num_lstm_units=64,\r\n      units=64,\r\n      num_class=10)\r\n  tf.logging.info('Starts training...')\r\n  train(model, parsed_flags.model_dir)\r\n  tf.logging.info('Finished training, starts exporting to tflite to %s ...' %\r\n                  parsed_flags.tflite_model_file)\r\n  export(model, parsed_flags.model_dir, parsed_flags.tflite_model_file,\r\n         parsed_flags.use_post_training_quantize)\r\n  tf.logging.info(\r\n      'Finished exporting, model is %s' % parsed_flags.tflite_model_file)\r\n\r\n\r\ndef run_main(_):\r\n  \"\"\"Main in the TfLite LSTM tutorial.\"\"\"\r\n  parser = argparse.ArgumentParser(\r\n      description=('Train a MNIST recognition model then export to TfLite.'))\r\n  parser.add_argument(\r\n      '--model_dir',\r\n      type=str,\r\n      help='Directory where the models will store.',\r\n      required=True)\r\n  parser.add_argument(\r\n      '--tflite_model_file',\r\n      type=str,\r\n      help='Full filepath to the exported tflite model file.',\r\n      required=True)\r\n  parser.add_argument(\r\n      '--use_post_training_quantize',\r\n      action='store_true',\r\n      default=True,\r\n      help='Whether or not to use post_training_quantize.')\r\n  parsed_flags, _ = parser.parse_known_args()\r\n  train_and_export(parsed_flags)\r\n\r\n\r\ndef main():\r\n  app.run(main=run_main, argv=sys.argv[:1])\r\n\r\nif __name__ == '__main__':\r\n  main()\r\n```\r\n\r\nWhen ran simply like `python example.py --model_dir lstms/ --tflite_model_file lstms/model.tflite`, I get the following error message : \r\n```\r\nINFO:tensorflow:Starts training...\r\nI1216 23:55:41.555022 140529868711744 doc_example.py:159] Starts training...\r\nINFO:tensorflow:Training step 0, loss is 2.657418\r\nI1216 23:55:45.383375 140529868711744 doc_example.py:120] Training step 0, loss is 2.657418\r\nINFO:tensorflow:Training step 100, loss is 0.867711\r\nI1216 23:55:47.319205 140529868711744 doc_example.py:120] Training step 100, loss is 0.867711\r\nINFO:tensorflow:Training step 100, accuracy is 0.540000\r\nI1216 23:55:47.966933 140529868711744 doc_example.py:132] Training step 100, accuracy is 0.540000\r\nINFO:tensorflow:Finished training, starts exporting to tflite to lstm_doc/model.tflite ...\r\nI1216 23:55:50.603394 140529868711744 doc_example.py:162] Finished training, starts exporting to tflite to lstm_doc/model.tflite ...\r\nINFO:tensorflow:Restoring parameters from lstm_doc/\r\nI1216 23:55:50.832539 140529868711744 saver.py:1284] Restoring parameters from lstm_doc/\r\n2019-12-16 23:55:50.880481: I tensorflow/core/grappler/devices.cc:55] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0\r\n2019-12-16 23:55:50.880555: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2019-12-16 23:55:50.900838: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:786] Optimization results for grappler item: graph_to_optimize\r\n2019-12-16 23:55:50.900867: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:788]   function_optimizer: Graph size after: 412 nodes (0), 507 edges (0), time = 3.325ms.\r\n2019-12-16 23:55:50.900872: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:788]   function_optimizer: Graph size after: 412 nodes (0), 507 edges (0), time = 5.794ms.\r\n2019-12-16 23:55:50.900875: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:786] Optimization results for grappler item: hey_rnn_while_body_8743\r\n2019-12-16 23:55:50.900878: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:788]   function_optimizer: function_optimizer did nothing. time = 0.002ms.\r\n2019-12-16 23:55:50.900882: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:788]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2019-12-16 23:55:50.900884: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:786] Optimization results for grappler item: hey_rnn_while_cond_8742\r\n2019-12-16 23:55:50.900888: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:788]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2019-12-16 23:55:50.900891: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:788]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\nINFO:tensorflow:Froze 26 variables.\r\nI1216 23:55:50.942811 140529868711744 graph_util_impl.py:334] Froze 26 variables.\r\nINFO:tensorflow:Converted 26 variables to const ops.\r\nI1216 23:55:50.946878 140529868711744 graph_util_impl.py:394] Converted 26 variables to const ops.\r\n/home/mparient/.virtualenvs/decibel/lib/python3.6/site-packages/tensorflow_core/lite/python/lite.py:846: UserWarning: Property post_training_quantize is deprecated, please use optimizations=[Optimize.DEFAULT] instead.\r\n  \" instead.\" % name)\r\n---------------------------------------------------------------------------\r\nConverterError                            Traceback (most recent call last)\r\n~/code_perso/decibel-light/prod/doc_example.py in <module>\r\n    195 \r\n    196 if __name__ == '__main__':\r\n--> 197   main()\r\n\r\n~/code_perso/decibel-light/prod/doc_example.py in main()\r\n    191 \r\n    192 def main():\r\n--> 193   app.run(main=run_main, argv=sys.argv[:1])\r\n    194 \r\n    195 \r\n\r\n~/.virtualenvs/decibel/lib/python3.6/site-packages/absl/app.py in run(main, argv, flags_parser)\r\n    297       callback()\r\n    298     try:\r\n--> 299       _run_main(main, args)\r\n    300     except UsageError as error:\r\n    301       usage(shorthelp=True, detailed_error=error, exitcode=error.exitcode)\r\n\r\n~/.virtualenvs/decibel/lib/python3.6/site-packages/absl/app.py in _run_main(main, argv)\r\n    248     sys.exit(retval)\r\n    249   else:\r\n--> 250     sys.exit(main(argv))\r\n    251 \r\n    252 \r\n\r\n~/code_perso/decibel-light/prod/doc_example.py in run_main(_)\r\n    187       help='Whether or not to use post_training_quantize.')\r\n    188   parsed_flags, _ = parser.parse_known_args()\r\n--> 189   train_and_export(parsed_flags)\r\n    190 \r\n    191 \r\n\r\n~/code_perso/decibel-light/prod/doc_example.py in train_and_export(parsed_flags)\r\n    162                   parsed_flags.tflite_model_file)\r\n    163   export(model, parsed_flags.model_dir, parsed_flags.tflite_model_file,\r\n--> 164          parsed_flags.use_post_training_quantize)\r\n    165   tf.logging.info(\r\n    166       'Finished exporting, model is %s' % parsed_flags.tflite_model_file)\r\n\r\n~/code_perso/decibel-light/prod/doc_example.py in export(model, model_dir, tflite_model_file, use_post_training_quantize)\r\n    144   converter = tf.lite.TFLiteConverter.from_session(sess, [x], [output_class])\r\n    145   converter.post_training_quantize = use_post_training_quantize\r\n--> 146   tflite = converter.convert()\r\n    147   with open(tflite_model_file, 'w') as f:\r\n    148     f.write(tflite)\r\n\r\n~/.virtualenvs/decibel/lib/python3.6/site-packages/tensorflow_core/lite/python/lite.py in convert(self)\r\n    981           input_tensors=self._input_tensors,\r\n    982           output_tensors=self._output_tensors,\r\n--> 983           **converter_kwargs)\r\n    984     else:\r\n    985       result = _toco_convert_graph_def(\r\n\r\n~/.virtualenvs/decibel/lib/python3.6/site-packages/tensorflow_core/lite/python/convert.py in toco_convert_impl(input_data, input_tensors, output_tensors, enable_mlir_converter, *args, **kwargs)\r\n    447       input_data.SerializeToString(),\r\n    448       debug_info_str=debug_info_str,\r\n--> 449       enable_mlir_converter=enable_mlir_converter)\r\n    450   return data\r\n    451 \r\n\r\n~/.virtualenvs/decibel/lib/python3.6/site-packages/tensorflow_core/lite/python/convert.py in toco_convert_protos(model_flags_str, toco_flags_str, input_data_str, debug_info_str, enable_mlir_converter)\r\n    198       stdout = _try_convert_to_unicode(stdout)\r\n    199       stderr = _try_convert_to_unicode(stderr)\r\n--> 200       raise ConverterError(\"See console for info.\\n%s\\n%s\\n\" % (stdout, stderr))\r\n    201   finally:\r\n    202     # Must manually cleanup files.\r\n\r\nConverterError: See console for info.\r\n2019-12-16 23:55:52.418001: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418032: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418038: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418043: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418047: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418051: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418056: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418061: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418066: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418071: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418076: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418081: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418146: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418153: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418158: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418162: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418166: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418171: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418175: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418179: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418184: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418188: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418193: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418199: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: ReadVariableOp\r\n2019-12-16 23:55:52.418227: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: TensorListReserve\r\n2019-12-16 23:55:52.418236: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-12-16 23:55:52.418479: F tensorflow/lite/toco/tooling_util.cc:1074] Check failed: name.substr(colon_pos + 1).find_first_not_of(\"0123456789\") == string::npos (0 vs. 18446744073709551615)Array 'stacked_rnn_cells/InputHint-UnidirectionalSequenceLstm-34aa74ee205711ea831bad6e4148a879-12-None-input_bias/ReadVariableOp:value' has non-digit characters after colon.\r\nFatal Python error: Aborted\r\n\r\nCurrent thread 0x00007f7ffc1c8740 (most recent call first):\r\n  File \"/home/mparient/.virtualenvs/decibel/lib/python3.6/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 52 in execute\r\n  File \"/home/mparient/.virtualenvs/decibel/lib/python3.6/site-packages/absl/app.py\", line 250 in _run_main\r\n  File \"/home/mparient/.virtualenvs/decibel/lib/python3.6/site-packages/absl/app.py\", line 299 in run\r\n  File \"/home/mparient/.virtualenvs/decibel/lib/python3.6/site-packages/tensorflow_core/python/platform/app.py\", line 40 in run\r\n  File \"/home/mparient/.virtualenvs/decibel/lib/python3.6/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 89 in main\r\n  File \"/home/mparient/.virtualenvs/decibel/bin/toco_from_protos\", line 8 in <module>\r\nAborted\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35161", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35161/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35161/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35161/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35161", "id": 538537948, "node_id": "MDU6SXNzdWU1Mzg1Mzc5NDg=", "number": 35161, "title": "why TF2.0+TRT6 (keras) slower than TF1+keras about 4 times ?", "user": {"login": "VitaMusic", "id": 12452501, "node_id": "MDQ6VXNlcjEyNDUyNTAx", "avatar_url": "https://avatars1.githubusercontent.com/u/12452501?v=4", "gravatar_id": "", "url": "https://api.github.com/users/VitaMusic", "html_url": "https://github.com/VitaMusic", "followers_url": "https://api.github.com/users/VitaMusic/followers", "following_url": "https://api.github.com/users/VitaMusic/following{/other_user}", "gists_url": "https://api.github.com/users/VitaMusic/gists{/gist_id}", "starred_url": "https://api.github.com/users/VitaMusic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/VitaMusic/subscriptions", "organizations_url": "https://api.github.com/users/VitaMusic/orgs", "repos_url": "https://api.github.com/users/VitaMusic/repos", "events_url": "https://api.github.com/users/VitaMusic/events{/privacy}", "received_events_url": "https://api.github.com/users/VitaMusic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 1754777628, "node_id": "MDU6TGFiZWwxNzU0Nzc3NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu:tensorrt", "name": "comp:gpu:tensorrt", "color": "ea98ba", "default": false, "description": "Issues specific to TensorRT"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-12-16T17:03:33Z", "updated_at": "2019-12-26T18:34:22Z", "closed_at": null, "author_association": "NONE", "body": "I'd like to understand the performance issue I faced :\r\nWhy TF2.0+TRT6 (keras) slower than TF1+keras about 4 times ?\r\n\r\nGPU K80\r\n\r\nbefore : TF1 + keras (as separate package)\r\nafter: TF2 + TRT6 integrated with integrated keras\r\n\r\non the same example TF2 is 4 times slower, when I'm waiting acceleration of training/predition in new version with TRT integration.\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35160", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35160/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35160/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35160/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35160", "id": 538534004, "node_id": "MDU6SXNzdWU1Mzg1MzQwMDQ=", "number": 35160, "title": "-D_GLIBCXX_USE_CXX11_ABI=1 increases a lot RAM usage", "user": {"login": "maingoh", "id": 8860364, "node_id": "MDQ6VXNlcjg4NjAzNjQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/8860364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maingoh", "html_url": "https://github.com/maingoh", "followers_url": "https://api.github.com/users/maingoh/followers", "following_url": "https://api.github.com/users/maingoh/following{/other_user}", "gists_url": "https://api.github.com/users/maingoh/gists{/gist_id}", "starred_url": "https://api.github.com/users/maingoh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maingoh/subscriptions", "organizations_url": "https://api.github.com/users/maingoh/orgs", "repos_url": "https://api.github.com/users/maingoh/repos", "events_url": "https://api.github.com/users/maingoh/events{/privacy}", "received_events_url": "https://api.github.com/users/maingoh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-12-16T16:56:29Z", "updated_at": "2019-12-30T10:49:10Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- TensorFlow installed from: pip\r\n- TensorFlow version (use command below): 1.13.1\r\n- Python version: python3.7\r\n- CUDA/cuDNN version: 10.1\r\n- GPU model and memory: GTX 1080 ti\r\n\r\n\r\n**Describe the current behavior**\r\n\r\nSince g++7 is now the default version on Ubuntu 18 and most distributions, most builds will use  `_GLIBCXX_USE_CXX11_ABI=1`. It seems also that when tensorflow is built with  `_GLIBCXX_USE_CXX11_ABI=0`, it implies recompiling all other libraries of the project with this flag which can be unconvenient. \r\n\r\nWe noticed that building with `_GLIBCXX_USE_CXX11_ABI=1` increases the RAM by a lot. \r\n\r\n**Describe the expected behavior**\r\n\r\nBoth packages should consume the same amount of RAM.\r\n\r\n**Code to reproduce the issue**\r\n\r\nYou can install tensorflow using `python3.7 -m pip install tensorflow==1.13.1` (related to https://github.com/tensorflow/tensorflow/issues/27078) and makes sure \r\n`python3.7 -c \"import tensorflow; print(tensorflow.sysconfig.get_compile_flags())\"` prints `-D_GLIBCXX_USE_CXX11_ABI=1`. \r\nThen you can install it in python3.6 `python3.6 -m pip install tensorflow==1.13.1` and make sure ` python3.6 -c \"import tensorflow; print(tensorflow.sysconfig.get_compile_flags())\"` prints `D_GLIBCXX_USE_CXX11_ABI=0`.\r\n\r\nNow run this script with python3.6 and python3.7 and you will see that the second one consume a lot more (x3 on the model I use). Any `saved_model.pb` should work.\r\n\r\n```python\r\nimport io\r\nimport os\r\nimport sys\r\ntry:\r\n    from urllib import urlopen\r\nexcept ImportError:\r\n    from urllib.request import urlopen\r\n\r\nimport numpy\r\nimport psutil\r\nfrom PIL import Image\r\n\r\nimport tensorflow as tf\r\nfrom tensorflow.core.protobuf import saved_model_pb2\r\nfrom tensorflow.python.platform import gfile\r\nfrom tensorflow.python.util import compat\r\n\r\nprocess = psutil.Process(os.getpid())\r\n\r\ndef print_ram(prefix=''):\r\n    print(\"RAM\", prefix, process.memory_info().rss / 1024. / 1024.)\r\n\r\n\r\nif __name__ == '__main__':\r\n\r\n    if len(sys.argv) == 1:\r\n        model_filename = 'saved_model.pb'\r\n    else:\r\n        model_filename = sys.argv[1]\r\n\r\n    with gfile.FastGFile(model_filename, 'rb') as f:\r\n        data = compat.as_bytes(f.read())\r\n        sm = saved_model_pb2.SavedModel()\r\n        sm.ParseFromString(data)\r\n        if 1 != len(sm.meta_graphs):\r\n            print('More than one graph found. Not sure which to write')\r\n            sys.exit(1)\r\n\r\n    img_url = 'https://i.dailymail.co.uk/1s/2019/11/23/09/21370544-7717313-image-a-1_1574501083030.jpg'\r\n    image_data = urlopen(img_url).read()\r\n    decoded_data = numpy.array(Image.open(io.BytesIO(image_data)))\r\n    decoded_data = numpy.expand_dims(decoded_data, axis=0)\r\n\r\n    print_ram('before graph import')\r\n    graph = tf.import_graph_def(sm.meta_graphs[0].graph_def)\r\n\r\n    print_ram('before device')\r\n    with tf.device(\"/device:GPU:0\"):\r\n        with tf.Session(graph=graph, config=None) as sess:\r\n            print_ram('after session')\r\n            output = sess.graph.get_tensor_by_name('import/predictions:0')\r\n            print_ram('before run')\r\n            for i in range(10000):\r\n                results = sess.run(output, feed_dict={\"import/image_tensor:0\": decoded_data})\r\n                print_ram('after run')\r\n```\r\n\r\n**Other info / logs**\r\n\r\npython3.6:\r\n```\r\nRAM before graph import 527.55078125\r\nRAM before device 856.59375\r\n2019-12-16 17:51:27.400388: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2019-12-16 17:51:27.425979: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3399580000 Hz\r\n2019-12-16 17:51:27.426637: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x229fee0 executing computations on platform Host. Devices:\r\n2019-12-16 17:51:27.426655: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>\r\nRAM after session 860.25\r\nRAM before run 860.25\r\nRAM after run 948.12109375\r\nRAM after run 998.0\r\nRAM after run 1022.2265625\r\nRAM after run 1038.984375\r\nRAM after run 1038.984375\r\nRAM after run 1056.0\r\nRAM after run 1092.1953125\r\nRAM after run 1097.09375\r\nRAM after run 1097.09375\r\nRAM after run 1097.09375\r\nRAM after run 1097.09375\r\nRAM after run 1097.09375\r\nRAM after run 1116.42578125\r\nRAM after run 1116.42578125\r\nRAM after run 1116.42578125\r\nRAM after run 1116.42578125\r\nRAM after run 1116.42578125\r\n```\r\n\r\npython3.7:\r\n```\r\nRAM before graph import 510.33984375\r\nRAM before device 752.87890625\r\n2019-12-16 17:26:00.118658: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2019-12-16 17:26:00.141979: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3399580000 Hz\r\n2019-12-16 17:26:00.142737: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x265aff0 executing computations on platform Host. Devices:\r\n2019-12-16 17:26:00.142775: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>\r\nRAM after session 756.5625\r\nRAM before run 756.5625\r\nRAM after run 2977.8515625\r\nRAM after run 3030.1640625\r\nRAM after run 3047.8046875\r\nRAM after run 3090.08203125\r\nRAM after run 3121.296875\r\nRAM after run 3122.0703125\r\nRAM after run 3123.1015625\r\nRAM after run 3123.1015625\r\nRAM after run 3135.9921875\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35155", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35155/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35155/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35155/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35155", "id": 538406233, "node_id": "MDU6SXNzdWU1Mzg0MDYyMzM=", "number": 35155, "title": "Memory chunk error when train BoostedTreesRegressor in docker container", "user": {"login": "Hujun", "id": 835329, "node_id": "MDQ6VXNlcjgzNTMyOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/835329?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Hujun", "html_url": "https://github.com/Hujun", "followers_url": "https://api.github.com/users/Hujun/followers", "following_url": "https://api.github.com/users/Hujun/following{/other_user}", "gists_url": "https://api.github.com/users/Hujun/gists{/gist_id}", "starred_url": "https://api.github.com/users/Hujun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Hujun/subscriptions", "organizations_url": "https://api.github.com/users/Hujun/orgs", "repos_url": "https://api.github.com/users/Hujun/repos", "events_url": "https://api.github.com/users/Hujun/events{/privacy}", "received_events_url": "https://api.github.com/users/Hujun/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-12-16T13:17:33Z", "updated_at": "2019-12-19T10:56:47Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04.3 LTS (in docker container)\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: NA\r\n- TensorFlow installed from (source or binary): pip wheel\r\n- TensorFlow version (use command below): 2.0.0\r\n- Python version: 3.6.8 \r\n- Bazel version (if compiling from source): NA\r\n- GCC/Compiler version (if compiling from source): NA\r\n- CUDA/cuDNN version: NA\r\n- GPU model and memory: NA\r\n\r\n**Describe the current behavior**\r\nThe training is down due to low layer system call (corrupted size vs. prev_size). the process is immediately corrupted without much log to trace.\r\n\r\n**Describe the expected behavior**\r\nthe estimator (BoostedTreesRegressor) should be trained in normal.\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport os\r\nimport uuid\r\nimport json\r\nfrom io import StringIO\r\n\r\nimport pandas as pd\r\nimport tensorflow as tf\r\nfrom sklearn.model_selection import train_test_split\r\nfrom tensorflow.estimator import BoostedTreesRegressor\r\n\r\ndef split_data(df: pd.DataFrame) -> (pd.DataFrame, pd.DataFrame, pd.DataFrame, pd.DataFrame):\r\n    \"\"\"Split data into train and test sets\r\n\r\n    Args:\r\n        df (DataFrame): pandas dataframe\r\n\r\n    Returns:\r\n        X_train, X_test, y_train, y_test\r\n    \"\"\"\r\n    feature_cols = [c for c in df.columns if c.startswith('FEATURE')]\r\n    label_col = [c for c in df.columns if c.startswith('LABEL')]\r\n\r\n    return train_test_split(df[feature_cols], df[label_col], test_size=.2, random_state=42)\r\n\r\n\r\ndef make_input_fn(X, y, n_epochs=None, shuffle=True):\r\n    def input_fn():\r\n        dataset = tf.data.Dataset.from_tensor_slices((dict(X), y))\r\n        if shuffle:\r\n            dataset = dataset.shuffle(len(y))\r\n        dataset = dataset.repeat(n_epochs)\r\n        dataset = dataset.batch(len(y))\r\n        return dataset\r\n    return input_fn\r\n\r\n\r\ndef make_serving_receiver_fn(df: pd.DataFrame):\r\n    feature_col_names = [c for c in df.columns if c.startswith('FEATURE')]\r\n    feature_cols = [tf.feature_column.numeric_column(fc) for fc in feature_col_names]\r\n    feature_spec = tf.feature_column.make_parse_example_spec(feature_cols)\r\n    return tf.estimator.export.build_parsing_serving_input_receiver_fn(feature_spec)\r\n\r\n\r\ndef train_model(df: pd.DataFrame, **params) -> (BoostedTreesRegressor, dict, dict):\r\n    \"\"\"Train Boost Tree\r\n\r\n    Args:\r\n        df (DataFrame): pandas dataframe\r\n        params (**dict): parameters for training\r\n\r\n    Returns:\r\n        BoostTreesRegressor, saved model dir, a dict containing the evaluation metrics\r\n    \"\"\"\r\n    feature_col_names = [c for c in df.columns if c.startswith('FEATURE')]\r\n    label_col_name = [c for c in df.columns if c.startswith('LABEL')]\r\n    feature_cols = [tf.feature_column.numeric_column(fc_name) for fc_name in feature_col_names]\r\n    default_params = {\r\n        'feature_columns': feature_cols,\r\n        'n_batches_per_layer': 1,\r\n        'model_dir': os.path.join('../output', str(uuid.uuid4())),\r\n    }\r\n    default_params.update(params)\r\n    regressor = BoostedTreesRegressor(**default_params)\r\n    X_train, X_valid, y_train, y_valid = train_test_split(df[feature_col_names], df[label_col_name], test_size=0.2, random_state=42)\r\n    train_input_fn = make_input_fn(X_train, y_train)\r\n    evaluate_input_fn = make_input_fn(X_valid, y_valid, n_epochs=1)\r\n    regressor.train(input_fn=train_input_fn)\r\n    summary = regressor.evaluate(input_fn=evaluate_input_fn)\r\n    receiver_fn = make_serving_receiver_fn(df)\r\n    export_dir = regressor.export_saved_model(regressor.model_dir, receiver_fn)\r\n\r\n    summary = {k: float(v) for k, v in summary.items()}\r\n\r\n    return regressor, export_dir, summary\r\n```\r\n\r\n**Other info / logs**\r\nNo problem under environment __OSX 10.14.5__ with __pyenv virtualenv 3.7.0 (default, Nov 22 2019, 12:39:30) \\n[Clang 11.0.0 (clang-1100.0.33.12)]__\r\n\r\nNo problem when use google colab runtime (__Ubuntu 18.04.3 LTS Python 3.6.9 compiled by GCC 8.3.0__). See __[notebook shared](https://colab.research.google.com/drive/1aAjJCWOBd7R0Hb6w4d7UCSnkfk4c-xyE)__\r\n\r\nSame problem in Kaggle runtime (__Debian GNU/Linux 9 Python 3.6.6 Anaconda GCC 7.3.0__) using tensorflow 2.0.0.\r\n\r\nFull error log in docker using official image __tensorflow/tensorflow:2.0.0-py3__:\r\n\r\n```\r\nWARNING: Logging before flag parsing goes to stderr.\r\nI1216 13:01:22.775628 140590360139584 estimator.py:1800] Using default config.\r\nI1216 13:01:22.778364 140590360139584 estimator.py:212] Using config: {'_model_dir': '/app/WINDMIL_PoC_Data_FE/service/estimator/saved_model/8f979f53-4821-4def-bc6e-9692d868e2ea', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': None, '_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true\r\ngraph_options {\r\n  rewrite_options {\r\n    meta_optimizer_iterations: ONE\r\n  }\r\n}\r\n, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_session_creation_timeout_secs': 7200, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fdd837c5d30>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}\r\nW1216 13:01:22.809657 140590360139584 deprecation.py:506] From /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nIf using Keras pass *_constraint arguments to layers.\r\nW1216 13:01:22.811977 140590360139584 deprecation.py:323] From /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/training/training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts.\r\nI1216 13:01:22.888739 140590360139584 estimator.py:1147] Calling model_fn.\r\nW1216 13:01:22.968535 140590360139584 deprecation.py:323] From /usr/local/lib/python3.6/dist-packages/tensorflow_estimator/python/estimator/canned/head.py:437: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse `tf.cast` instead.\r\nI1216 13:01:23.278414 140590360139584 estimator.py:1149] Done calling model_fn.\r\nI1216 13:01:23.278981 140590360139584 basic_session_run_hooks.py:541] Create CheckpointSaverHook.\r\nW1216 13:01:23.327183 140590360139584 meta_graph.py:448] Issue encountered when serializing resources.\r\nType is unsupported, or the types of the items don't match field type in CollectionDef. Note this is a warning and probably safe to ignore.\r\n'_Resource' object has no attribute 'name'\r\nI1216 13:01:23.468171 140590360139584 monitored_session.py:240] Graph was finalized.\r\n2019-12-16 13:01:23.468761: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2019-12-16 13:01:23.475253: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2904000000 Hz\r\n2019-12-16 13:01:23.476582: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4ed0210 executing computations on platform Host. Devices:\r\n2019-12-16 13:01:23.476657: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version\r\nI1216 13:01:23.541273 140590360139584 session_manager.py:500] Running local_init_op.\r\nI1216 13:01:23.561274 140590360139584 session_manager.py:502] Done running local_init_op.\r\nW1216 13:01:23.960061 140590360139584 meta_graph.py:448] Issue encountered when serializing resources.\r\nType is unsupported, or the types of the items don't match field type in CollectionDef. Note this is a warning and probably safe to ignore.\r\n'_Resource' object has no attribute 'name'\r\nI1216 13:01:24.019694 140590360139584 basic_session_run_hooks.py:606] Saving checkpoints for 0 into /app/WINDMIL_PoC_Data_FE/service/estimator/saved_model/8f979f53-4821-4def-bc6e-9692d868e2ea/model.ckpt.\r\nW1216 13:01:24.100714 140590360139584 meta_graph.py:448] Issue encountered when serializing resources.\r\nType is unsupported, or the types of the items don't match field type in CollectionDef. Note this is a warning and probably safe to ignore.\r\n'_Resource' object has no attribute 'name'\r\nI1216 13:01:24.385114 140590360139584 basic_session_run_hooks.py:262] loss = 0.017109463, step = 0\r\nW1216 13:01:24.594182 140590360139584 basic_session_run_hooks.py:724] It seems that global step (tf.train.get_global_step) has not been increased. Current value (could be stable): 0 vs previous value: 0. You could increase the global step by passing tf.train.get_global_step() to Optimizer.apply_gradients or Optimizer.minimize.\r\ncorrupted size vs. prev_size\r\nAborted\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35152", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35152/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35152/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35152/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35152", "id": 538381195, "node_id": "MDU6SXNzdWU1MzgzODExOTU=", "number": 35152, "title": "Memory leaks when using tf.strings.split in map_func for tf.data.Dataset.map with eager execution.", "user": {"login": "workingloong", "id": 18071380, "node_id": "MDQ6VXNlcjE4MDcxMzgw", "avatar_url": "https://avatars1.githubusercontent.com/u/18071380?v=4", "gravatar_id": "", "url": "https://api.github.com/users/workingloong", "html_url": "https://github.com/workingloong", "followers_url": "https://api.github.com/users/workingloong/followers", "following_url": "https://api.github.com/users/workingloong/following{/other_user}", "gists_url": "https://api.github.com/users/workingloong/gists{/gist_id}", "starred_url": "https://api.github.com/users/workingloong/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/workingloong/subscriptions", "organizations_url": "https://api.github.com/users/workingloong/orgs", "repos_url": "https://api.github.com/users/workingloong/repos", "events_url": "https://api.github.com/users/workingloong/events{/privacy}", "received_events_url": "https://api.github.com/users/workingloong/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 736653459, "node_id": "MDU6TGFiZWw3MzY2NTM0NTk=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:eager", "name": "comp:eager", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "kkimdev", "id": 503414, "node_id": "MDQ6VXNlcjUwMzQxNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/503414?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kkimdev", "html_url": "https://github.com/kkimdev", "followers_url": "https://api.github.com/users/kkimdev/followers", "following_url": "https://api.github.com/users/kkimdev/following{/other_user}", "gists_url": "https://api.github.com/users/kkimdev/gists{/gist_id}", "starred_url": "https://api.github.com/users/kkimdev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kkimdev/subscriptions", "organizations_url": "https://api.github.com/users/kkimdev/orgs", "repos_url": "https://api.github.com/users/kkimdev/repos", "events_url": "https://api.github.com/users/kkimdev/events{/privacy}", "received_events_url": "https://api.github.com/users/kkimdev/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "kkimdev", "id": 503414, "node_id": "MDQ6VXNlcjUwMzQxNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/503414?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kkimdev", "html_url": "https://github.com/kkimdev", "followers_url": "https://api.github.com/users/kkimdev/followers", "following_url": "https://api.github.com/users/kkimdev/following{/other_user}", "gists_url": "https://api.github.com/users/kkimdev/gists{/gist_id}", "starred_url": "https://api.github.com/users/kkimdev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kkimdev/subscriptions", "organizations_url": "https://api.github.com/users/kkimdev/orgs", "repos_url": "https://api.github.com/users/kkimdev/repos", "events_url": "https://api.github.com/users/kkimdev/events{/privacy}", "received_events_url": "https://api.github.com/users/kkimdev/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2019-12-16T12:26:25Z", "updated_at": "2020-01-23T06:02:42Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):  Linux Ubuntu 16.04\r\n- TensorFlow installed from (source or binary):  binary\r\n- TensorFlow version (use command below): 2.1.0rc1\r\n- Python version: 3.6.8\r\n- Bazel version (if compiling from source): N/A \r\n- GCC/Compiler version (if compiling from source): N/A \r\n- CUDA/cuDNN version: N/A \r\n- GPU model and memory: N/A \r\n\r\n**Describe the current behavior**\r\nIf we use `tf.strings.split` in map_func to process each element in tf.data.Dataset, the used memory grows when we iterate the dataset and the used memory is not freed after iteration. What's more, the used memory continues to grow greatly if we repeatedly create the same tf.data.Dataset instance. However, the used memory keeps stable if we use tf.py_function to implement the split logic.\r\n![image](https://user-images.githubusercontent.com/18071380/70906668-debb4780-2041-11ea-945c-bf2a05cbb637.png)\r\n\r\n\r\n**Describe the expected behavior**\r\nThe used memory when iterating the dataset should be freed and should grow the create the same tf.data.Dataset instance.\r\n\r\n**Code to reproduce the issue**\r\n#### Experiment\r\n```python\r\nimport psutil\r\nimport tensorflow as tf\r\nimport pandas as pd\r\nimport numpy as np\r\n\r\nFEATURE_COUNT = 400\r\n\r\n# mock feature names and feature data\r\ndef gen_feature_names(feature_count):\r\n    feature_names = []\r\n    for i in range(feature_count):\r\n        feature_names.append(\"f{}\".format(i))\r\n    return feature_names\r\n\r\n\r\ndef gen_samples(feature_names, sample_count=5000):\r\n    samples = []\r\n    for _ in range(sample_count):\r\n        feature_str = \"\"\r\n        for name in feature_names:\r\n            feature_str += \"{};\".format(np.random.random())\r\n        feature_str += str(np.random.randint(0,2))\r\n        yield feature_str\r\n        \r\ndef dataset_fn(dataset):\r\n    def _py_parse_data(record):\r\n        record = record.numpy()\r\n        feature_labels = bytes.decode(record).split(\";\")\r\n        return feature_labels\r\n\r\n    def _parse_data(*record):\r\n        feature_values = record[0:-1]\r\n        features = {}\r\n        for i,feature_name in enumerate(FEATURE_NAMES):\r\n            features[feature_name] = feature_values[i]\r\n        label = tf.strings.to_number(record[-1], tf.int64)\r\n        return features, label\r\n    \r\n    tout = [tf.string] * FEATURE_COUNT\r\n    tout.append(tf.string)\r\n    \r\n    dataset = dataset.map(\r\n        lambda record: tf.py_function(\r\n            _py_parse_data,\r\n            [record],\r\n            tout\r\n        )\r\n    )\r\n    dataset = dataset.map(_parse_data)\r\n    dataset = dataset.shuffle(buffer_size=100)\r\n    return dataset\r\n\r\n\r\ndef dataset_fn_using_split(dataset):\r\n    def _parse_data(record):\r\n        feature_label = tf.strings.split([record], sep=';')[0]\r\n        feature_values = feature_label[0:-1]\r\n        features = {}\r\n        for i, feature_name in enumerate(FEATURE_NAMES):\r\n            features[feature_name] = feature_values[i]\r\n        label = feature_label[-1]\r\n\r\n        return features, label\r\n    \r\n    dataset = dataset.map(_parse_data)\r\n    dataset = dataset.shuffle(buffer_size=100)\r\n    return dataset\r\n\r\ndef create_dataset(feature_names, using_split=True):\r\n    dataset = tf.data.Dataset.from_generator(\r\n        lambda : gen_samples(feature_names), tf.string\r\n    )\r\n    if using_split:\r\n        dataset = dataset_fn_using_split(dataset)\r\n    else:\r\n        dataset = dataset_fn(dataset)\r\n    dataset = dataset.batch(512)\r\n    return dataset\r\n\r\n\r\ndef view_used_mem():\r\n    used_mem = psutil.virtual_memory().used\r\n    print('used memory: {} Mb'.format(used_mem / 1024 / 1024))\r\n\r\nFEATURE_NAMES = gen_feature_names(FEATURE_COUNT)\r\n\r\n# Test used memory by using tf.strings.split in `map_func`\r\nFEATURE_NAMES = gen_feature_names(FEATURE_COUNT)\r\n\r\nstart_time = time.time()\r\nfor i in range(4):\r\n    print(\"loop {}\".format(i))\r\n    view_used_mem()\r\n    dataset = create_dataset(FEATURE_NAMES, using_split=True)\r\n    for batch in dataset:\r\n        pass\r\nprint(\"Consume time : {}\".format(time.time() - start_time))\r\nprint(\"end\")\r\nview_used_mem()\r\n\r\n# Test used memory by using `tf.py_function`\r\nstart_time = time.time()\r\nfor i in range(4):\r\n    print(\"loop {}\".format(i))\r\n    view_used_mem()\r\n    dataset = create_dataset(FEATURE_NAMES, using_split=False)\r\n    for batch in dataset:\r\n        pass\r\nprint(\"Consume time : {}\".format(time.time() - start_time))\r\nprint(\"end\")\r\nview_used_mem()\r\n\r\n**Other info / logs**\r\nWe encounter this issue when building inputs pipeline using `tf.data.Dataset` in [ElasticDL](https://github.com/sql-machine-learning/elasticdl)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35151", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35151/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35151/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35151/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35151", "id": 538328409, "node_id": "MDU6SXNzdWU1MzgzMjg0MDk=", "number": 35151, "title": "No data found in layer when fitting TF 2.0 Keras model with DenseFeatures as input", "user": {"login": "thisisandreeeee", "id": 11587285, "node_id": "MDQ6VXNlcjExNTg3Mjg1", "avatar_url": "https://avatars2.githubusercontent.com/u/11587285?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thisisandreeeee", "html_url": "https://github.com/thisisandreeeee", "followers_url": "https://api.github.com/users/thisisandreeeee/followers", "following_url": "https://api.github.com/users/thisisandreeeee/following{/other_user}", "gists_url": "https://api.github.com/users/thisisandreeeee/gists{/gist_id}", "starred_url": "https://api.github.com/users/thisisandreeeee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thisisandreeeee/subscriptions", "organizations_url": "https://api.github.com/users/thisisandreeeee/orgs", "repos_url": "https://api.github.com/users/thisisandreeeee/repos", "events_url": "https://api.github.com/users/thisisandreeeee/events{/privacy}", "received_events_url": "https://api.github.com/users/thisisandreeeee/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-12-16T10:40:45Z", "updated_at": "2019-12-18T09:22:43Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux-4.14.106+-x86_64-with-debian-buster-sid\r\n- TensorFlow installed from (source or binary): pip install\r\n- TensorFlow version (use command below): 2.0.0\r\n- Python version: 3.6.6\r\n\r\n**Describe the current behavior**\r\nI am trying to train a model using:\r\n* TF 2.0 Keras functional API\r\n* Feature columns and `DenseFeatures` as the input layer\r\n* tf.data.Dataset API as the `x` parameter in model.fit()\r\n\r\nThis raises a ValueError, and I'm not sure why because this doesn't work even with (what I think is) a minimal example. I suspect that this might be due to TF trying to match the feature columns to the inputs by name, but the name of the Input tensor contains a suffix e.g. `age:0`, but I may very well be mistaken.\r\n\r\nMight be related to: https://github.com/tensorflow/tensorflow/issues/30143\r\n\r\n**Describe the expected behavior**\r\nI expect to be able to train a model using the Keras functional API using data from the Dataset API, with feature_columns being fed into Input layers.\r\n\r\n**Code to reproduce the issue**\r\nThe following test case does not represent my use case, but it does reproduce the problem. Despite what the simplistic example suggests, I explicitly require both feature_columns and the functional API so suggesting that I use other TF libraries would not be an option, unless I can replicate the same functionality with minimal effort.\r\n\r\n```python\r\nimport tensorflow as tf\r\nimport numpy as np\r\nfrom tensorflow.keras.layers import DenseFeatures, Dense, Input\r\n\r\ndef make_model(features):\r\n    feature_columns = [tf.feature_column.numeric_column(key) for key in features]\r\n    nn_input = {key: Input(name=key, shape=(), dtype=tf.float32) for key in features}\r\n\r\n    feat = DenseFeatures(feature_columns)(nn_input)\r\n    dense = Dense(16)(feat)\r\n    output = Dense(1)(dense)\r\n    model = tf.keras.Model(inputs=nn_input, outputs=output)\r\n    model.compile(\r\n        optimizer=tf.keras.optimizers.Adam(learning_rate=0.001),\r\n        loss=tf.keras.losses.BinaryCrossentropy(from_logits=False),\r\n        metrics=[tf.keras.metrics.AUC()],\r\n    )\r\n    return model\r\n\r\nfeatures = [\"age\", \"income\"]\r\nlabel = \"is_male\"\r\n\r\ninput_dataset = tf.data.Dataset.from_tensor_slices(\r\n    {key: np.ones((1000, 1), dtype=np.float) for key in features}\r\n)\r\ntarget_dataset = tf.data.Dataset.from_tensor_slices(\r\n    {label: np.ones((1000, 1), dtype=np.int)}\r\n)\r\ncomplete_dataset = tf.data.Dataset.zip((input_dataset, target_dataset)).shuffle(10000)\r\n\r\nmodel = make_model(features)\r\nmodel.summary()\r\nmodel.fit(complete_dataset)\r\n```\r\n\r\nThis code references the issue created by @durandg12. Thank you.\r\n\r\n**Stack trace**\r\n```bash\r\n---------------------------------------------------------------------------\r\nKeyError                                  Traceback (most recent call last)\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_utils.py in standardize_input_data(data, names, shapes, check_batch_axis, exception_prefix)\r\n    498           if data[x].__class__.__name__ == 'DataFrame' else data[x]\r\n--> 499           for x in names\r\n    500       ]\r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_utils.py in <listcomp>(.0)\r\n    498           if data[x].__class__.__name__ == 'DataFrame' else data[x]\r\n--> 499           for x in names\r\n    500       ]\r\n\r\nKeyError: 'dense_1'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-1-0081a84113eb> in <module>\r\n     27 model = make_model(features)\r\n     28 model.summary()\r\n---> 29 model.fit(complete_dataset)\r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training.py in fit(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_freq, max_queue_size, workers, use_multiprocessing, **kwargs)\r\n    726         max_queue_size=max_queue_size,\r\n    727         workers=workers,\r\n--> 728         use_multiprocessing=use_multiprocessing)\r\n    729 \r\n    730   def evaluate(self,\r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2.py in fit(self, model, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_freq, **kwargs)\r\n    322                 mode=ModeKeys.TRAIN,\r\n    323                 training_context=training_context,\r\n--> 324                 total_epochs=epochs)\r\n    325             cbks.make_logs(model, epoch_logs, training_result, ModeKeys.TRAIN)\r\n    326 \r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2.py in run_one_epoch(model, iterator, execution_function, dataset_size, batch_size, strategy, steps_per_epoch, num_samples, mode, training_context, total_epochs)\r\n    121         step=step, mode=mode, size=current_batch_size) as batch_logs:\r\n    122       try:\r\n--> 123         batch_outs = execution_function(iterator)\r\n    124       except (StopIteration, errors.OutOfRangeError):\r\n    125         # TODO(kaftan): File bug about tf function and errors.OutOfRangeError?\r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py in execution_function(input_fn)\r\n     84     # `numpy` translates Tensors to values in Eager mode.\r\n     85     return nest.map_structure(_non_none_constant_value,\r\n---> 86                               distributed_function(input_fn))\r\n     87 \r\n     88   return execution_function\r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py in __call__(self, *args, **kwds)\r\n    455 \r\n    456     tracing_count = self._get_tracing_count()\r\n--> 457     result = self._call(*args, **kwds)\r\n    458     if tracing_count == self._get_tracing_count():\r\n    459       self._call_counter.called_without_tracing()\r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py in _call(self, *args, **kwds)\r\n    501       # This is the first call of __call__, so we have to initialize.\r\n    502       initializer_map = object_identity.ObjectIdentityDictionary()\r\n--> 503       self._initialize(args, kwds, add_initializers_to=initializer_map)\r\n    504     finally:\r\n    505       # At this point we know that the initialization is complete (or less\r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py in _initialize(self, args, kwds, add_initializers_to)\r\n    406     self._concrete_stateful_fn = (\r\n    407         self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access\r\n--> 408             *args, **kwds))\r\n    409 \r\n    410     def invalid_creator_scope(*unused_args, **unused_kwds):\r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py in _get_concrete_function_internal_garbage_collected(self, *args, **kwargs)\r\n   1846     if self.input_signature:\r\n   1847       args, kwargs = None, None\r\n-> 1848     graph_function, _, _ = self._maybe_define_function(args, kwargs)\r\n   1849     return graph_function\r\n   1850 \r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py in _maybe_define_function(self, args, kwargs)\r\n   2148         graph_function = self._function_cache.primary.get(cache_key, None)\r\n   2149         if graph_function is None:\r\n-> 2150           graph_function = self._create_graph_function(args, kwargs)\r\n   2151           self._function_cache.primary[cache_key] = graph_function\r\n   2152         return graph_function, args, kwargs\r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py in _create_graph_function(self, args, kwargs, override_flat_arg_shapes)\r\n   2039             arg_names=arg_names,\r\n   2040             override_flat_arg_shapes=override_flat_arg_shapes,\r\n-> 2041             capture_by_value=self._capture_by_value),\r\n   2042         self._function_attributes,\r\n   2043         # Tell the ConcreteFunction to clean up its graph once it goes out of\r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/framework/func_graph.py in func_graph_from_py_func(name, python_func, args, kwargs, signature, func_graph, autograph, autograph_options, add_control_dependencies, arg_names, op_return_value, collections, capture_by_value, override_flat_arg_shapes)\r\n    913                                           converted_func)\r\n    914 \r\n--> 915       func_outputs = python_func(*func_args, **func_kwargs)\r\n    916 \r\n    917       # invariant: `func_outputs` contains only Tensors, CompositeTensors,\r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py in wrapped_fn(*args, **kwds)\r\n    356         # __wrapped__ allows AutoGraph to swap in a converted function. We give\r\n    357         # the function a weak reference to itself to avoid a reference cycle.\r\n--> 358         return weak_wrapped_fn().__wrapped__(*args, **kwds)\r\n    359     weak_wrapped_fn = weakref.ref(wrapped_fn)\r\n    360 \r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py in distributed_function(input_iterator)\r\n     71     strategy = distribution_strategy_context.get_strategy()\r\n     72     outputs = strategy.experimental_run_v2(\r\n---> 73         per_replica_function, args=(model, x, y, sample_weights))\r\n     74     # Out of PerReplica outputs reduce or pick values to return.\r\n     75     all_outputs = dist_utils.unwrap_output_dict(\r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/distribute/distribute_lib.py in experimental_run_v2(self, fn, args, kwargs)\r\n    758       fn = autograph.tf_convert(fn, ag_ctx.control_status_ctx(),\r\n    759                                 convert_by_default=False)\r\n--> 760       return self._extended.call_for_each_replica(fn, args=args, kwargs=kwargs)\r\n    761 \r\n    762   def reduce(self, reduce_op, value, axis):\r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/distribute/distribute_lib.py in call_for_each_replica(self, fn, args, kwargs)\r\n   1785       kwargs = {}\r\n   1786     with self._container_strategy().scope():\r\n-> 1787       return self._call_for_each_replica(fn, args, kwargs)\r\n   1788 \r\n   1789   def _call_for_each_replica(self, fn, args, kwargs):\r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/distribute/distribute_lib.py in _call_for_each_replica(self, fn, args, kwargs)\r\n   2130         self._container_strategy(),\r\n   2131         replica_id_in_sync_group=constant_op.constant(0, dtypes.int32)):\r\n-> 2132       return fn(*args, **kwargs)\r\n   2133 \r\n   2134   def _reduce_to(self, reduce_op, value, destinations):\r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/autograph/impl/api.py in wrapper(*args, **kwargs)\r\n    290   def wrapper(*args, **kwargs):\r\n    291     with ag_ctx.ControlStatusCtx(status=ag_ctx.Status.DISABLED):\r\n--> 292       return func(*args, **kwargs)\r\n    293 \r\n    294   if inspect.isfunction(func) or inspect.ismethod(func):\r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py in train_on_batch(model, x, y, sample_weight, class_weight, reset_metrics)\r\n    251   x, y, sample_weights = model._standardize_user_data(\r\n    252       x, y, sample_weight=sample_weight, class_weight=class_weight,\r\n--> 253       extract_tensors_from_dataset=True)\r\n    254   batch_size = array_ops.shape(nest.flatten(x, expand_composites=True)[0])[0]\r\n    255   # If `model._distribution_strategy` is True, then we are in a replica context\r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training.py in _standardize_user_data(self, x, y, sample_weight, class_weight, batch_size, check_steps, steps_name, steps, validation_split, shuffle, extract_tensors_from_dataset)\r\n   2517           shapes=None,\r\n   2518           check_batch_axis=False,  # Don't enforce the batch size.\r\n-> 2519           exception_prefix='target')\r\n   2520 \r\n   2521       # Generate sample-wise weight values given the `sample_weight` and\r\n\r\n/opt/conda/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_utils.py in standardize_input_data(data, names, shapes, check_batch_axis, exception_prefix)\r\n    501     except KeyError as e:\r\n    502       raise ValueError('No data provided for \"' + e.args[0] + '\". Need data '\r\n--> 503                        'for each key in: ' + str(names))\r\n    504   elif isinstance(data, (list, tuple)):\r\n    505     if isinstance(data[0], (list, tuple)):\r\n\r\nValueError: No data provided for \"dense_1\". Need data for each key in: ['dense_1']\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35150", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35150/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35150/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35150/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35150", "id": 538322175, "node_id": "MDU6SXNzdWU1MzgzMjIxNzU=", "number": 35150, "title": "SavedModelBundle.getSignatures() does not return outputs in correct order.", "user": {"login": "vcarpani", "id": 38493091, "node_id": "MDQ6VXNlcjM4NDkzMDkx", "avatar_url": "https://avatars3.githubusercontent.com/u/38493091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vcarpani", "html_url": "https://github.com/vcarpani", "followers_url": "https://api.github.com/users/vcarpani/followers", "following_url": "https://api.github.com/users/vcarpani/following{/other_user}", "gists_url": "https://api.github.com/users/vcarpani/gists{/gist_id}", "starred_url": "https://api.github.com/users/vcarpani/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vcarpani/subscriptions", "organizations_url": "https://api.github.com/users/vcarpani/orgs", "repos_url": "https://api.github.com/users/vcarpani/repos", "events_url": "https://api.github.com/users/vcarpani/events{/privacy}", "received_events_url": "https://api.github.com/users/vcarpani/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-12-16T10:30:15Z", "updated_at": "2020-03-03T14:18:18Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Arch Linux\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 2.1.0.rc0\r\n- Python version: 3.8\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: Not relevant\r\n- GPU model and memory: Not relevant\r\n\r\n**Describe the current behavior**\r\nLoading a SavedModel in C++, the outputs (and probably also inputs, but I do not have models with multiple inputs) from the signature are returned in a random order, which then causes the network to fail when used for inference.\r\n\r\n**Describe the expected behavior**\r\nThe outputs (and probably inputs) should be returned in the correct order.\r\n\r\n**Code to reproduce the issue**\r\n```\r\nstd::string model_dir = \"/path/to/my_model\";\r\nstd::vector<string> input_names;\r\nstd::vector<string> output_names;\r\ntensorflow::SavedModelBundleLite bundle; // Same with SavedModelBundle\r\n\r\n// Create default options.\r\ntensorflow::SessionOptions session_options;\r\ntensorflow::RunOptions run_options;\r\n\r\n// Load model.\r\nauto status = tensorflow::LoadSavedModel(\r\n\tsession_options,\r\n\trun_options,\r\n\tmodel_dir,\r\n\t{tensorflow::kSavedModelTagServe},\r\n\t&bundle\r\n);\r\n\r\n// Check if model has been loaded correctly.\r\nif (!status.ok()) {\r\n\tstd::cerr << status.ToString() << std::endl;\r\n\treturn;\r\n}\r\n\r\n// Get model signature.\r\nauto signatures = bundle.GetSignatures();\r\nif (!signatures.contains(\"serving_default\")) {\r\n\tstd::cerr << \"Could not find serving_default in model signatures.\" << std::endl;\r\n\treturn;\r\n}\r\n\r\n// Get the inputs names.\r\nfor (auto const & input : signatures.at(\"serving_default\").inputs()) {\r\n\tinput_names.push_back(input.second.name());\r\n}\r\n\r\n// Get the outputs names.\r\nfor (auto const & output : signatures.at(\"serving_default\").outputs()) {\r\n\toutput_names.push_back(output.second.name());\r\n}\r\nstd::vector<tensorflow::Tensor>  inputs = getMyInputs();  // Some compatible input vector.\r\nstd::vector<tensorflow::Tensor>  outputs;\r\n\r\n// Create a vector of pairs for associating inputs to their names.\r\nstd::vector<std::pair<std::string, tensorflow::Tensor>> input_pairs;\r\nfor (std::size_t i = 0; i < inputs.size(); ++i) {\r\n\tinput_pairs.push_back({input_names.at(i), inputs.at(i)});\r\n}\r\n\r\n// Run the network.\r\nbundle.GetSession()->Run(\r\n\tinput_pairs,\r\n\toutput_names,\r\n\t{},\r\n\t&outputs\r\n);\r\n```\r\n\r\nWhen running this the output order changes, giving a mismatch error (eg. `Check failed: dtype() == expected_dtype (3 vs. 1) float expected, got int32`) after calling `Run`. \r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35146", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35146/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35146/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35146/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35146", "id": 538240318, "node_id": "MDU6SXNzdWU1MzgyNDAzMTg=", "number": 35146, "title": "Missing information when saving model in tf format", "user": {"login": "stekiri", "id": 13682691, "node_id": "MDQ6VXNlcjEzNjgyNjkx", "avatar_url": "https://avatars2.githubusercontent.com/u/13682691?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stekiri", "html_url": "https://github.com/stekiri", "followers_url": "https://api.github.com/users/stekiri/followers", "following_url": "https://api.github.com/users/stekiri/following{/other_user}", "gists_url": "https://api.github.com/users/stekiri/gists{/gist_id}", "starred_url": "https://api.github.com/users/stekiri/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stekiri/subscriptions", "organizations_url": "https://api.github.com/users/stekiri/orgs", "repos_url": "https://api.github.com/users/stekiri/repos", "events_url": "https://api.github.com/users/stekiri/events{/privacy}", "received_events_url": "https://api.github.com/users/stekiri/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-12-16T07:42:37Z", "updated_at": "2020-01-16T17:59:10Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: NA\r\n- TensorFlow installed from (source or binary): Binary (pip)\r\n- TensorFlow version (use command below): v2.0.0-rc2-26-g64c3d382ca 2.0.0\r\n- Python version: Python 3.6.8\r\n- Bazel version (if compiling from source): NA\r\n- GCC/Compiler version (if compiling from source): NA\r\n- CUDA/cuDNN version: CUDA 10.0.130_411.31; cuDNN 10.0 v7.6.5.32\r\n- GPU model and memory: NVIDIA Quadro P2000, 4 GB\r\n\r\n**Describe the current behavior**\r\nWhen the model is saved in the default tf format, warnings are logged when trying to serve the model.\r\n\r\nExamplary warning logs:\r\n```\r\nWARNING:tensorflow:5 out of the last 5 calls to <function recreate_function.<locals>.restored_function_body at 0x000001ED79058730> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings is likely due to passing python objects instead of tensors. Also, tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. Please refer to https://www.tensorflow.org/beta/tutorials/eager/tf_function#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for more details.\r\n```\r\n\r\nWhen the model is saved in the hdf5 format, the warnings do not occur.\r\n\r\n**Describe the expected behavior**\r\nThe save formats should be equivalent and behave in the same way.\r\n\r\n**Code to reproduce the issue**\r\nExecute the following scripts to create and serve model\r\n1. Run the first script with `format_ext = ''` which saves the model in tf format, **restart the Python console**, serve the model with the second script which creates the aforementioned warnings.\r\n1. When running the scripts with `format_ext = '.h5'`, the model is saved in hdf5 format and no warnings appear.\r\n\r\nModel creation:\r\n```python\r\nimport os\r\n\r\nimport tensorflow as tf\r\n\r\nformat_ext = ''  # '.h5' or empty for tf format\r\nmodel_path = os.path.join('out', 'mnist-classifier{}'.format(format_ext))\r\n\r\ngpus = tf.config.experimental.list_physical_devices('GPU')\r\n\r\ntf.config.experimental.set_virtual_device_configuration(\r\n    gpus[0],\r\n    [tf.config.experimental.VirtualDeviceConfiguration(memory_limit=512),\r\n     tf.config.experimental.VirtualDeviceConfiguration(memory_limit=512),\r\n     tf.config.experimental.VirtualDeviceConfiguration(memory_limit=512)]\r\n)\r\n\r\nstrategy = tf.distribute.MirroredStrategy()\r\nwith strategy.scope():\r\n    inputs = tf.keras.Input(shape=(784,), name='digits')\r\n    x = tf.keras.layers.Dense(64, activation='relu', name='dense_1')(inputs)\r\n    x = tf.keras.layers.Dense(64, activation='relu', name='dense_2')(x)\r\n    outputs = tf.keras.layers.Dense(10, activation='softmax', name='predictions')(x)\r\n\r\n    model = tf.keras.Model(inputs=inputs, outputs=outputs)\r\n\r\n    model.compile(optimizer=tf.keras.optimizers.RMSprop(),  # Optimizer\r\n                  # Loss function to minimize\r\n                  loss=tf.keras.losses.SparseCategoricalCrossentropy(),\r\n                  # List of metrics to monitor\r\n                  metrics=[tf.keras.metrics.SparseCategoricalAccuracy()])\r\n\r\nmodel.save(model_path)\r\n```\r\n\r\nModel serving:\r\n```python\r\nimport os\r\n\r\nimport tensorflow as tf\r\n\r\nformat_ext = ''  # '.h5' or empty for tf format\r\nmodel_path = os.path.join('out', 'mnist-classifier{}'.format(format_ext))\r\n\r\ngpus = tf.config.experimental.list_physical_devices('GPU')\r\n\r\ntf.config.experimental.set_virtual_device_configuration(\r\n    gpus[0],\r\n    [tf.config.experimental.VirtualDeviceConfiguration(memory_limit=512),\r\n     tf.config.experimental.VirtualDeviceConfiguration(memory_limit=512),\r\n     tf.config.experimental.VirtualDeviceConfiguration(memory_limit=512)]\r\n)\r\n\r\n(_, _), (x_test, _) = tf.keras.datasets.mnist.load_data()\r\nx_test = x_test.reshape(10000, 784).astype('float32') / 255\r\n\r\nstrategy = tf.distribute.MirroredStrategy()\r\nwith strategy.scope():\r\n    loaded_model = tf.keras.models.load_model(model_path)\r\n    predictions = loaded_model.predict(x_test, batch_size=64)\r\n```\r\n\r\n**Other info / logs**\r\nThe warnings occur only if more than two vGPUs are used."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35142", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35142/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35142/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35142/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35142", "id": 538130058, "node_id": "MDU6SXNzdWU1MzgxMzAwNTg=", "number": 35142, "title": "Building from source: ERROR: kernels:training_ops", "user": {"login": "lbarosi", "id": 19232581, "node_id": "MDQ6VXNlcjE5MjMyNTgx", "avatar_url": "https://avatars1.githubusercontent.com/u/19232581?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lbarosi", "html_url": "https://github.com/lbarosi", "followers_url": "https://api.github.com/users/lbarosi/followers", "following_url": "https://api.github.com/users/lbarosi/following{/other_user}", "gists_url": "https://api.github.com/users/lbarosi/gists{/gist_id}", "starred_url": "https://api.github.com/users/lbarosi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lbarosi/subscriptions", "organizations_url": "https://api.github.com/users/lbarosi/orgs", "repos_url": "https://api.github.com/users/lbarosi/repos", "events_url": "https://api.github.com/users/lbarosi/events{/privacy}", "received_events_url": "https://api.github.com/users/lbarosi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1133285679, "node_id": "MDU6TGFiZWwxMTMzMjg1Njc5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:xla", "name": "comp:xla", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-12-16T00:26:19Z", "updated_at": "2019-12-18T00:30:13Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- **Linux Ubuntu 18.04**\r\n- TensorFlow installed from (source or binary): **source**\r\n- TensorFlow version: v2 (master)\r\n- Python version: python 3.7.5\r\n- Installed using virtualenv? conda:  conda 4.7.12\r\n- Bazel version (if compiling from source): **bazel 1.1.0**\r\n- GCC/Compiler version (if compiling from source): **gcc 8.3.0**\r\n- CUDA/cuDNN version: **CUDA 10.2/cuDNN7.6.5**\r\n- GPU model and memory: GeForce GTX670 4035Mb\r\n- CPU Intel i7860@2.80GHz\r\n- Kernel  Linux-headers-4.15.0-73\r\n- NVCC -  v2.5.6, for CUDA 10.2, Nov 19,2019\r\n\r\n\r\n\r\n**Describe the problem**\r\n\r\nIt seems Bazel Build is disregarding my choice of **NOT INSTALLING XLA**.\r\n\r\nI installed CUDA and cuDNN, NCCL, created a python 3.7.5 environment and decided to build tensorflow from MASTER branch since my  GPU has capabilities 3.0 and the other installs I tried, from docker or conda, where complaining about a minimum capability of 3.5.\r\n\r\nThere were plenty of documentation for the need of a build from source for 3.0 capability and I decided to do it. \r\n\r\nFrom git I realized it was necessary to disable XLA. `./configure` asked for **XLA** capabitity and I answered **N** (Y was the default), it correctly detected python, cuda and gcc, I wrote **3.0** for desired capability, (A message showed me the need to disable XLA, what I already did). \r\n\r\nWhen I did the bazel build it took a huge lot of time and seemed to freeze with something like the piece below.\r\n````bash\r\n./tensorflow/compiler/xla/service/hlo_computation.h:562:3: note: in expansion of macro \u2018TF_RET_CHECK\u2019\r\n   TF_RET_CHECK(order.size() == instruction_count());\r\n   ^~~~~~~~~~~~\r\n./tensorflow/compiler/xla/service/hlo_computation.h: In instantiation of \u2018tensorflow::Status xla::HloComputation::AcceptOrdered(xla::DfsHloVisitorBase<HloInstructionPtr>*, absl::Span<xla::HloInstruction* const>) const [with HloInstructionPtr = const xla::HloInstruction*]\u2019:\r\n./tensorflow/compiler/xla/service/hlo_computation.h:588:61:   required from here\r\n./tensorflow/compiler/xla/service/hlo_computation.h:562:29: warning: comparison of integer expressions of different signedness: \u2018absl::Span<xla::HloInstruction* const>::size_type\u2019 {aka \u2018long unsigned int\u2019} and \u2018tensorflow::int64\u2019 {aka \u2018long long int\u2019} [-Wsign-compare]\r\n   TF_RET_CHECK(order.size() == instruction_count());\r\n./tensorflow/core/platform/macros.h:87:47: note: in definition of macro \u2018TF_PREDICT_FALSE\u2019\r\n #define TF_PREDICT_FALSE(x) (__builtin_expect(x, 0))\r\n                                               ^\r\n./tensorflow/compiler/xla/service/hlo_computation.h:562:3: note: in expansion of macro \u2018TF_RET_CHECK\u2019\r\n   TF_RET_CHECK(order.size() == instruction_count());\r\n   ^~~~~~~~~~~~\r\n./tensorflow/compiler/xla/array.h: In instantiation of \u2018tensorflow::int64 xla::Array<T>::dim(tensorflow::int64) const [with T = int; tensorflow::int64 = long long int]\u2019:\r\n\r\n````\r\n\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n````bash \r\nbazel build --config=opt -- config=--local_ram_resources=6000  --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" --config=cuda //tensorflow/tools/pip_package:build_pip_package\r\n````\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\nThe pieces showing the actual error ocurrered as follows:\r\n````\r\nERROR: /home/lbarosi/Pythonia/tensorflow/tensorflow/core/kernels/BUILD:5735:1: C++ compilation of rule '//tensorflow/core/kernels:training_ops' failed (Exit 1)\r\nx86_64-linux-gnu-gcc-8: fatal error: Killed signal terminated program cc1plus\r\ncompilation terminated.\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nUse --verbose_failures to see the command lines of failed build steps.\r\nERROR: /home/lbarosi/Pythonia/tensorflow/tensorflow/python/tools/BUILD:141:1 C++ compilation of rule '//tensorflow/core/kernels:training_ops' failed (Exit 1)\r\nINFO: Elapsed time: 4520.437s, Critical Path: 1586.97s\r\nINFO: 5492 processes: 5492 local.\r\nFAILED: Build did NOT complete successfully\r\n\r\n````\r\n\r\nAny help is appreciated. I would like to try as much as possible to stick with this configurations without downgradings of CUDA or cuDNN.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35141", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35141/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35141/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35141/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35141", "id": 538112349, "node_id": "MDU6SXNzdWU1MzgxMTIzNDk=", "number": 35141, "title": "tf.where should have optional dtype parameter", "user": {"login": "gkennos", "id": 12161195, "node_id": "MDQ6VXNlcjEyMTYxMTk1", "avatar_url": "https://avatars0.githubusercontent.com/u/12161195?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gkennos", "html_url": "https://github.com/gkennos", "followers_url": "https://api.github.com/users/gkennos/followers", "following_url": "https://api.github.com/users/gkennos/following{/other_user}", "gists_url": "https://api.github.com/users/gkennos/gists{/gist_id}", "starred_url": "https://api.github.com/users/gkennos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gkennos/subscriptions", "organizations_url": "https://api.github.com/users/gkennos/orgs", "repos_url": "https://api.github.com/users/gkennos/repos", "events_url": "https://api.github.com/users/gkennos/events{/privacy}", "received_events_url": "https://api.github.com/users/gkennos/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-12-15T21:59:06Z", "updated_at": "2019-12-17T21:16:13Z", "closed_at": null, "author_association": "NONE", "body": "- TensorFlow version (you are using): 2.0\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n```\r\ntf.keras.backend.floatx = tf.float64\r\nf64 = tf.Variable([0,0.2,0.5,0.7,1], dtype=tf.float64)\r\ntf.where(f64 > 0.5, 1., 0. )\r\n\r\n<tf.Tensor: id=16, shape=(5,), dtype=float32, numpy=array([0., 0., 0., 1., 1.], dtype=float32)>\r\n```\r\n\r\nalternatives for tf.float64 models lead to difficult to read code\r\n\r\n```\r\ntf.where(f64 > 0.5, tf.constant(1., dtype=tf.float64), tf.constant(0., dtype=tf.float64) )\r\ntf.cast(tf.where(f64 > 0.5, 1., 0. ), dtype=tf.float64)\r\n```\r\n\r\nassuming that tf.where can't respect the float type of the input variable nor the floatx setting, as those change the api, better would be:\r\n\r\n```\r\ntf.where(f64 > 0.5, 1., 0. , dtype=tf.float64)\r\n```\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35138", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35138/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35138/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35138/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35138", "id": 538086032, "node_id": "MDU6SXNzdWU1MzgwODYwMzI=", "number": 35138, "title": "Replacement for experimental_run_tf_function after removal from tf.keras.Model.compile ", "user": {"login": "tgaddair", "id": 1742912, "node_id": "MDQ6VXNlcjE3NDI5MTI=", "avatar_url": "https://avatars1.githubusercontent.com/u/1742912?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tgaddair", "html_url": "https://github.com/tgaddair", "followers_url": "https://api.github.com/users/tgaddair/followers", "following_url": "https://api.github.com/users/tgaddair/following{/other_user}", "gists_url": "https://api.github.com/users/tgaddair/gists{/gist_id}", "starred_url": "https://api.github.com/users/tgaddair/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tgaddair/subscriptions", "organizations_url": "https://api.github.com/users/tgaddair/orgs", "repos_url": "https://api.github.com/users/tgaddair/repos", "events_url": "https://api.github.com/users/tgaddair/events{/privacy}", "received_events_url": "https://api.github.com/users/tgaddair/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-12-15T18:14:07Z", "updated_at": "2020-02-08T01:08:57Z", "closed_at": null, "author_association": "NONE", "body": "It looks like `experimental_run_tf_function` was removed from `tf.keras.Model.compile` in this commit a few days ago: https://github.com/tensorflow/tensorflow/commit/c73c99ca3e0bacf2bca313f270bb3eae28869530#diff-de9b96ac2d81503324cbbbe21732031fR1159\r\n\r\nIn [Horovod](http://horovod.ai/), this flag / graph mode is necessary in order for `Optimizer.get_gradients()` to be called, which aggregates gradients across workers.  Since this flag has been removed, distributed training in Horovod with `tf.keras` is not working in our nightly builds.\r\n\r\nIs there a workaround to achieve the same behavior with the latest changes on master?\r\n\r\nNote that we cannot perform the allreduce aggregation in `apply_gradients` due to interactions with gradient clipping and loss scaling (see https://github.com/horovod/horovod/pull/1347).\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35116", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35116/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35116/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35116/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35116", "id": 537935864, "node_id": "MDU6SXNzdWU1Mzc5MzU4NjQ=", "number": 35116, "title": "Cannot build raspberry pi wheel for python 3.7", "user": {"login": "fgervais", "id": 5411996, "node_id": "MDQ6VXNlcjU0MTE5OTY=", "avatar_url": "https://avatars1.githubusercontent.com/u/5411996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fgervais", "html_url": "https://github.com/fgervais", "followers_url": "https://api.github.com/users/fgervais/followers", "following_url": "https://api.github.com/users/fgervais/following{/other_user}", "gists_url": "https://api.github.com/users/fgervais/gists{/gist_id}", "starred_url": "https://api.github.com/users/fgervais/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fgervais/subscriptions", "organizations_url": "https://api.github.com/users/fgervais/orgs", "repos_url": "https://api.github.com/users/fgervais/repos", "events_url": "https://api.github.com/users/fgervais/events{/privacy}", "received_events_url": "https://api.github.com/users/fgervais/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1194756584, "node_id": "MDU6TGFiZWwxMTk0NzU2NTg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20raspberry%20pi", "name": "subtype: raspberry pi", "color": "b619ea", "default": false, "description": "Raspberry Pi Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-12-14T16:41:00Z", "updated_at": "2020-03-05T20:53:28Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution: Ubuntu 18.04.3 LTS\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version: v2.1.0-rc1\r\n\r\n I'm building using the docker image for a raspberry pi 3 build.\r\n\r\n\r\n\r\n**Describe the problem**\r\n\r\nI'm able to correctly build `tensorflow-2.1.0rc1-cp35-none-linux_armv7l.whl` using:\r\n\r\n```\r\nCI_DOCKER_EXTRA_PARAMS=\"-e CI_BUILD_PYTHON=python3 -e CROSSTOOL_PYTHON_INCLUDE_PATH=/usr/include/python3.4\"     tensorflow/tools/ci_build/ci_build.sh PI-PYTHON3     tensorflow/tools/ci_build/pi/build_raspberry_pi.sh \r\n```\r\nI'm trying to do the same but with the python 3.7 docker images `PI-PYTHON37` (`tensorflow/tools/ci_build/Dockerfile.pi-python37`) but it fails with:\r\n\r\n```\r\nERROR: /workspace/tensorflow/lite/python/interpreter_wrapper/BUILD:8:1: C++ compilation of rule '//tensorflow/lite/python/interpreter_wrapper:numpy' failed (Exit 1)\r\ncc1plus: warning: command line option '-std=gnu11' is valid for C/ObjC but not for C++\r\nIn file included from bazel-out/armeabi-py2-opt/bin/external/local_config_python/python_include/Python.h:8:0,\r\n                 from ./tensorflow/lite/python/interpreter_wrapper/numpy.h:49,\r\n                 from tensorflow/lite/python/interpreter_wrapper/numpy.cc:17:\r\nbazel-out/armeabi-py2-opt/bin/external/local_config_python/python_include/pyconfig.h:13:55: fatal error: arm-linux-gnueabihf/python3.5m/pyconfig.h: No such file or directory\r\n #  include <arm-linux-gnueabihf/python3.5m/pyconfig.h>\r\n                                                       ^\r\ncompilation terminated.\r\nINFO: Elapsed time: 339.221s, Critical Path: 36.02s\r\nINFO: 6204 processes: 6204 local.\r\nFAILED: Build did NOT complete successfully\r\nFAILED: Build did NOT complete successfully\r\n```\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n\r\n```\r\ncd tensorflow\r\ngit checkout v2.1.0-rc1\r\nCI_DOCKER_EXTRA_PARAMS=\"-e CI_BUILD_PYTHON=python3 -e CROSSTOOL_PYTHON_INCLUDE_PATH=/usr/include/python3.4\"     tensorflow/tools/ci_build/ci_build.sh PI-PYTHON37     tensorflow/tools/ci_build/pi/build_raspberry_pi.sh\r\n```\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35114", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35114/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35114/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35114/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35114", "id": 537922963, "node_id": "MDU6SXNzdWU1Mzc5MjI5NjM=", "number": 35114, "title": "STM32F7-Disco Hello World example fails to build", "user": {"login": "pramodjayram", "id": 22176659, "node_id": "MDQ6VXNlcjIyMTc2NjU5", "avatar_url": "https://avatars2.githubusercontent.com/u/22176659?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pramodjayram", "html_url": "https://github.com/pramodjayram", "followers_url": "https://api.github.com/users/pramodjayram/followers", "following_url": "https://api.github.com/users/pramodjayram/following{/other_user}", "gists_url": "https://api.github.com/users/pramodjayram/gists{/gist_id}", "starred_url": "https://api.github.com/users/pramodjayram/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pramodjayram/subscriptions", "organizations_url": "https://api.github.com/users/pramodjayram/orgs", "repos_url": "https://api.github.com/users/pramodjayram/repos", "events_url": "https://api.github.com/users/pramodjayram/events{/privacy}", "received_events_url": "https://api.github.com/users/pramodjayram/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "wangtz", "id": 34290063, "node_id": "MDQ6VXNlcjM0MjkwMDYz", "avatar_url": "https://avatars1.githubusercontent.com/u/34290063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wangtz", "html_url": "https://github.com/wangtz", "followers_url": "https://api.github.com/users/wangtz/followers", "following_url": "https://api.github.com/users/wangtz/following{/other_user}", "gists_url": "https://api.github.com/users/wangtz/gists{/gist_id}", "starred_url": "https://api.github.com/users/wangtz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wangtz/subscriptions", "organizations_url": "https://api.github.com/users/wangtz/orgs", "repos_url": "https://api.github.com/users/wangtz/repos", "events_url": "https://api.github.com/users/wangtz/events{/privacy}", "received_events_url": "https://api.github.com/users/wangtz/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "wangtz", "id": 34290063, "node_id": "MDQ6VXNlcjM0MjkwMDYz", "avatar_url": "https://avatars1.githubusercontent.com/u/34290063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wangtz", "html_url": "https://github.com/wangtz", "followers_url": "https://api.github.com/users/wangtz/followers", "following_url": "https://api.github.com/users/wangtz/following{/other_user}", "gists_url": "https://api.github.com/users/wangtz/gists{/gist_id}", "starred_url": "https://api.github.com/users/wangtz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wangtz/subscriptions", "organizations_url": "https://api.github.com/users/wangtz/orgs", "repos_url": "https://api.github.com/users/wangtz/repos", "events_url": "https://api.github.com/users/wangtz/events{/privacy}", "received_events_url": "https://api.github.com/users/wangtz/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-12-14T14:48:06Z", "updated_at": "2019-12-16T22:58:25Z", "closed_at": null, "author_association": "NONE", "body": "@tensorflow/micro\r\n\r\n**System information**\r\n- Host OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\nNAME=\"Ubuntu\"\r\nVERSION=\"18.04.3 LTS\"\r\nID=ubuntu\r\nPRETTY_NAME=\"Ubuntu 18.04.3 LTS\"\r\nVERSION_ID=\"18.04\"\r\nPython versionL 2.7.15+\r\n- Target platform (e.g. Arm Mbed OS, Arduino Nano 33 etc.): STM32F7-Disco and also tried on K64F based on ARM-M4\r\n\r\n**Describe the problem**\r\nI am attempting to build the Hello World example for the STM32F7-Disco from the following link but it is failing to build\r\nhttps://github.com/tensorflow/tensorflow/tree/master/tensorflow/lite/micro/examples/hello_world.\r\n\r\n**Please provide the exact sequence of commands/steps when you ran into the problem**\r\nmake -f tensorflow/lite/micro/tools/make/Makefile TARGET=mbed TAGS=\"CMSIS disco_f746ng\" generate_hello_world_mbed_project\r\n\r\ncd tensorflow/lite/micro/tools/make/gen/mbed_cortex-m4/prj/hello_world/mbed\r\n\r\nmbed config root .\r\n\r\nmbed deploy\r\npython -c 'import fileinput, glob;\r\nfor filename in glob.glob(\"mbed-os/tools/profiles/*.json\"):\r\n  for line in fileinput.input(filename, inplace=True):\r\n    print line.replace(\"\\\"-std=gnu++98\\\"\",\"\\\"-std=c++11\\\", \\\"-fpermissive\\\"\")'\r\n\r\nmbed compile -m DISCO_F746NG -t GCC_ARM\r\n\r\nThis is the error I seen before making a change to :\r\n\r\n`Compile [ 98.7%]: arm_mult_q15.c\r\n[Error] arm_mult_q15.c@101,6: conflicting types for 'arm_mult_q15'\r\n[ERROR] ./tensorflow/lite/micro/tools/make/downloads/cmsis/CMSIS/DSP/Source/BasicMathFunctions/arm_mult_q15.c:101:6: error: conflicting types for 'arm_mult_q15'\r\n void arm_mult_q15(\r\n      ^~~~~~~~~~~~\r\nIn file included from ./tensorflow/lite/micro/tools/make/downloads/cmsis/CMSIS/DSP/Source/BasicMathFunctions/arm_mult_q15.c:29:0:\r\n./mbed-os/cmsis/TARGET_CORTEX_M/arm_math.h:1924:8: note: previous declaration of 'arm_mult_q15' was here\r\n   void arm_mult_q15(\r\n        ^~~~~~~~~~~~\r\n\r\n[mbed] ERROR: \"/usr/bin/python\" returned error.\r\n       Code: 1\r\n       Path: \"/home/pramod/tensorflow-master/tensorflow/lite/micro/tools/make/gen/mbed_cortex-m4/prj/hello_world/mbed\"\r\n       Command: \"/usr/bin/python -u /home/pramod/tensorflow-master/tensorflow/lite/micro/tools/make/gen/mbed_cortex-m4/prj/hello_world/mbed/mbed-os/tools/make.py -D TF_LITE_STATIC_MEMORY -t GCC_ARM -m DISCO_F746NG --source . --build ./BUILD/DISCO_F746NG/GCC_ARM\"\r\n       Tip: You could retry the last command with \"-v\" flag for verbose output\r\n`\r\nAny help regarding this is deeply appreciated.\r\n\r\nThank you"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35107", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35107/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35107/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35107/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35107", "id": 537854030, "node_id": "MDU6SXNzdWU1Mzc4NTQwMzA=", "number": 35107, "title": "tf.keras.layers.BatchNormalization() may not work in tf=2.0 and eager model is disable", "user": {"login": "CNOCycle", "id": 24318472, "node_id": "MDQ6VXNlcjI0MzE4NDcy", "avatar_url": "https://avatars3.githubusercontent.com/u/24318472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CNOCycle", "html_url": "https://github.com/CNOCycle", "followers_url": "https://api.github.com/users/CNOCycle/followers", "following_url": "https://api.github.com/users/CNOCycle/following{/other_user}", "gists_url": "https://api.github.com/users/CNOCycle/gists{/gist_id}", "starred_url": "https://api.github.com/users/CNOCycle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CNOCycle/subscriptions", "organizations_url": "https://api.github.com/users/CNOCycle/orgs", "repos_url": "https://api.github.com/users/CNOCycle/repos", "events_url": "https://api.github.com/users/CNOCycle/events{/privacy}", "received_events_url": "https://api.github.com/users/CNOCycle/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 736653459, "node_id": "MDU6TGFiZWw3MzY2NTM0NTk=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:eager", "name": "comp:eager", "color": "0052cc", "default": false, "description": ""}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tomerk", "id": 676357, "node_id": "MDQ6VXNlcjY3NjM1Nw==", "avatar_url": "https://avatars0.githubusercontent.com/u/676357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tomerk", "html_url": "https://github.com/tomerk", "followers_url": "https://api.github.com/users/tomerk/followers", "following_url": "https://api.github.com/users/tomerk/following{/other_user}", "gists_url": "https://api.github.com/users/tomerk/gists{/gist_id}", "starred_url": "https://api.github.com/users/tomerk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tomerk/subscriptions", "organizations_url": "https://api.github.com/users/tomerk/orgs", "repos_url": "https://api.github.com/users/tomerk/repos", "events_url": "https://api.github.com/users/tomerk/events{/privacy}", "received_events_url": "https://api.github.com/users/tomerk/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tomerk", "id": 676357, "node_id": "MDQ6VXNlcjY3NjM1Nw==", "avatar_url": "https://avatars0.githubusercontent.com/u/676357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tomerk", "html_url": "https://github.com/tomerk", "followers_url": "https://api.github.com/users/tomerk/followers", "following_url": "https://api.github.com/users/tomerk/following{/other_user}", "gists_url": "https://api.github.com/users/tomerk/gists{/gist_id}", "starred_url": "https://api.github.com/users/tomerk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tomerk/subscriptions", "organizations_url": "https://api.github.com/users/tomerk/orgs", "repos_url": "https://api.github.com/users/tomerk/repos", "events_url": "https://api.github.com/users/tomerk/events{/privacy}", "received_events_url": "https://api.github.com/users/tomerk/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-12-14T02:37:17Z", "updated_at": "2020-03-17T06:28:20Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04 in Docker\r\n- TensorFlow installed from (source or binary): pip install\r\n- TensorFlow version (use command below): v2.0.0-rc2-26-g64c3d38\r\n- Python version: 3.5\r\n- CUDA/cuDNN version: 10.0 / 7\r\n- GPU model and memory: GTX 1080Ti / 11175MiB\r\n\r\n**Describe the current behavior**\r\n\r\nHi authors and developers,\r\n\r\nI am developing our project in tf=2.0.0 and eager_mode is disable.\r\n\r\nThe main reason is tf=1.x will not be maintained but third party libraries have not been ready for tf=2.0 yet.\r\n\r\nThis issues is a separate issues from [#35050](https://github.com/tensorflow/tensorflow/issues/35050#issuecomment-565395512)\r\n\r\nThis potential issue is somethine wrong if users do custom training with level API which includes `tf.keras.layers.BatchNormalization()` in tf=2.0 and eager model is disable.\r\n\r\nI summary the testcaset as the following:\r\n\r\n```python\r\n#%%\r\nimport tensorflow as tf\r\ntf.compat.v1.disable_eager_execution()\r\n#tf.compat.v1.disable_v2_behavior()\r\n\r\nimport numpy as np\r\n\r\nbatch_size = 100\r\n\r\ndef download_data():\r\n\r\n    # get raw data\r\n    (trainX, trainY), (testX, testY) = tf.keras.datasets.cifar10.load_data()\r\n    trainX = trainX.astype(np.float32)\r\n    testX  = testX.astype(np.float32)\r\n\r\n    # ont-hot\r\n    trainY = tf.keras.utils.to_categorical(trainY, 10)\r\n    testY  = tf.keras.utils.to_categorical(testY , 10)\r\n\r\n    # get validation sets\r\n    training_size = 45000\r\n    validX = trainX[training_size:,:]\r\n    validY = trainY[training_size:,:]\r\n\r\n    trainX = trainX[:training_size,:]\r\n    trainY = trainY[:training_size,:]\r\n\r\n    return trainX, trainY, validX, validY, testX, testY\r\n\r\ndef data_pipeline(dataX, dataY):\r\n\r\n        dataset = tf.data.Dataset.from_tensor_slices( (dataX, dataY) )\r\n        dataset = dataset.shuffle(batch_size * 8)\r\n        dataset = dataset.repeat()\r\n        dataset = dataset.batch(batch_size)\r\n        dataset = dataset.prefetch(tf.data.experimental.AUTOTUNE)\r\n        return dataset\r\n\r\nclass custom_model():\r\n    def __init__(self):\r\n\r\n        def Acc():\r\n            acc = tf.keras.metrics.categorical_accuracy(label_ref, clf_out)\r\n            return tf.math.reduce_mean(acc)\r\n\r\n        def c_loss():\r\n            loss = tf.keras.losses.categorical_crossentropy(label_ref, clf_out)\r\n            loss = tf.math.reduce_mean(loss)\r\n            return loss\r\n\r\n        # create model\r\n        clf_input = tf.keras.layers.Input(shape=(32,32,3), name=\"model/input\")\r\n        model = tf.keras.applications.resnet_v2.ResNet50V2(include_top=True, weights=None, input_tensor=clf_input, pooling='max', classes=10)\r\n        #model = tf.keras.applications.vgg16.VGG16(include_top=True, weights=None, input_tensor=clf_input, pooling='max', classes=10)\r\n        model.compile(loss='categorical_crossentropy', optimizer='SGD', metrics=['accuracy'])\r\n\r\n        label_ref = tf.keras.layers.Input(shape=(10,) , name='label_ref')\r\n        clf_out = model(clf_input)\r\n\r\n        # using tf.keras.optimizers.Nadam would get error\r\n        #optimizer = tf.keras.optimizers.Nadam(lr=0.0005)\r\n        optimizer = tf.compat.v1.train.AdamOptimizer(learning_rate=0.01)\r\n        self.train_op = optimizer.minimize(c_loss(), var_list=[model.trainable_variables])\r\n\r\n        self.clf_model = model\r\n        self.clf_input = clf_input\r\n        self.label_ref = label_ref\r\n        self.op_acc = Acc()\r\n        self.c_loss = c_loss()\r\n\r\nif __name__ == '__main__':\r\n\r\n    # set GPU\r\n    import os\r\n    if os.environ.get(\"CUDA_VISIBLE_DEVICES\") is None:\r\n        os.environ[\"CUDA_VISIBLE_DEVICES\"] = \"0\"\r\n\r\n    # reset tf session\r\n    tf.compat.v1.keras.backend.clear_session()\r\n    gpu_options = tf.compat.v1.GPUOptions(allow_growth=True)\r\n    sess = tf.compat.v1.Session(config=tf.compat.v1.ConfigProto(gpu_options=gpu_options))\r\n    tf.compat.v1.keras.backend.set_session(sess) \r\n\r\n    # prepare data\r\n    trainX, trainY, validX, validY, testX, testY = download_data()\r\n    train_gen = data_pipeline(trainX, trainY)\r\n    valid_gen = data_pipeline(validX, validY)\r\n    test_gen = data_pipeline(testX, testY)\r\n\r\n    # build targeted model\r\n    model = tf.keras.applications.resnet_v2.ResNet50V2(include_top=True, weights=None, input_shape=(32,32,3), pooling='max', classes=10)\r\n    #model = tf.keras.applications.vgg16.VGG16(include_top=True, weights=None, input_shape=(32,32,3), pooling=None, classes=10)\r\n    model.compile(loss='categorical_crossentropy', optimizer='SGD', metrics=['accuracy'])\r\n\r\n    # fit and evalutate\r\n    model.fit(train_gen,\r\n            steps_per_epoch = trainY.shape[0] // batch_size,\r\n            validation_data = valid_gen,\r\n            validation_steps= validY.shape[0] // batch_size,\r\n            epochs=5,\r\n            verbose=2)\r\n    model.evaluate(testX, testY, verbose=2, batch_size=batch_size)\r\n\r\n    # create a new model\r\n    print('Make sure that we create a new model.')\r\n    model = custom_model()\r\n    sess.run(tf.compat.v1.global_variables_initializer())\r\n    model.clf_model.evaluate(testX, testY, verbose=2, batch_size=batch_size)\r\n\r\n    # train model\r\n    num_epoch = 5\r\n    total_len = trainY.shape[0] // batch_size\r\n    tf_iter = tf.compat.v1.data.make_initializable_iterator(train_gen)\r\n    tf_next = tf_iter.get_next()\r\n    sess.run(tf_iter.initializer)\r\n    for epoch in range(num_epoch):\r\n        c_loss, acc = 0.0, 0.0\r\n        for ii in range(total_len):\r\n            X, Y = sess.run(tf_next)\r\n            [b_c_loss, b_acc, _] = sess.run([model.c_loss, model.op_acc, model.train_op],\r\n                                                feed_dict={ model.clf_input: X,\r\n                                                            model.label_ref: Y,\r\n                                                            tf.keras.backend.learning_phase(): 1})\r\n            c_loss = c_loss + b_c_loss\r\n            acc = acc + b_acc\r\n        \r\n        c_loss = c_loss / total_len\r\n        acc = acc / total_len\r\n        print('[Training]Epoch: {:d}/{:d} - loss: {:.3f} - acc: {:.3f}'.format(epoch+1, num_epoch, c_loss, acc) )\r\n\r\n    print('Show loss and accuracy with keras API')\r\n    model.clf_model.evaluate(trainX, trainY, verbose=2, batch_size=batch_size)\r\n    model.clf_model.evaluate(validX, validY, verbose=2, batch_size=batch_size)\r\n    model.clf_model.evaluate(testX, testY, verbose=2, batch_size=batch_size)\r\n\r\n    print('Show loss and accuracy with low level API')\r\n    # evaluate\r\n    num_epoch = 1\r\n    total_len = validY.shape[0] // batch_size\r\n    tf_iter = tf.compat.v1.data.make_initializable_iterator(valid_gen)\r\n    tf_next = tf_iter.get_next()\r\n    sess.run(tf_iter.initializer)\r\n    for epoch in range(num_epoch):\r\n        c_loss_t, acc_t, c_loss_f, acc_f = 0.0, 0.0, 0.0, 0.0\r\n        for ii in range(total_len):\r\n            X, Y = sess.run(tf_next)\r\n            [b_c_loss, b_acc] = sess.run([model.c_loss, model.op_acc],\r\n                                        feed_dict={ model.clf_input: X,\r\n                                                    model.label_ref: Y,\r\n                                                    tf.keras.backend.learning_phase(): 1})\r\n            c_loss_t = c_loss_t + b_c_loss\r\n            acc_t = acc_t + b_acc\r\n\r\n            [b_c_loss, b_acc] = sess.run([model.c_loss, model.op_acc],\r\n                                        feed_dict={ model.clf_input: X,\r\n                                                    model.label_ref: Y,\r\n                                                    tf.keras.backend.learning_phase(): 0})\r\n            c_loss_f = c_loss_f + b_c_loss\r\n            acc_f = acc_f + b_acc\r\n\r\n        c_loss_t = c_loss_t / total_len\r\n        c_loss_f = c_loss_f / total_len\r\n        acc_t = acc_t / total_len\r\n        acc_f = acc_f / total_len\r\n        print('[Validation][learning_phase=1] Epoch: {:d}/{:d} - loss: {:.3f} - acc: {:.3f}'.format(epoch+1, num_epoch, c_loss_t, acc_t) )\r\n        print('[Validation][learning_phase=0] Epoch: {:d}/{:d} - loss: {:.3f} - acc: {:.3f}'.format(epoch+1, num_epoch, c_loss_f, acc_f) )\r\n\r\n    # evaluate\r\n    num_epoch = 1\r\n    total_len = testY.shape[0] // batch_size\r\n    tf_iter = tf.compat.v1.data.make_initializable_iterator(test_gen)\r\n    tf_next = tf_iter.get_next()\r\n    sess.run(tf_iter.initializer)\r\n    for epoch in range(num_epoch):\r\n        c_loss_t, acc_t, c_loss_f, acc_f = 0.0, 0.0, 0.0, 0.0\r\n        for ii in range(total_len):\r\n            X, Y = sess.run(tf_next)\r\n            [b_c_loss, b_acc] = sess.run([model.c_loss, model.op_acc],\r\n                                        feed_dict={ model.clf_input: X,\r\n                                                    model.label_ref: Y,\r\n                                                    tf.keras.backend.learning_phase(): 1})\r\n            c_loss_t = c_loss_t + b_c_loss\r\n            acc_t = acc_t + b_acc\r\n\r\n            [b_c_loss, b_acc] = sess.run([model.c_loss, model.op_acc],\r\n                                        feed_dict={ model.clf_input: X,\r\n                                                    model.label_ref: Y,\r\n                                                    tf.keras.backend.learning_phase(): 0})\r\n            c_loss_f = c_loss_f + b_c_loss\r\n            acc_f = acc_f + b_acc\r\n\r\n        c_loss_t = c_loss_t / total_len\r\n        c_loss_f = c_loss_f / total_len\r\n        acc_t = acc_t / total_len\r\n        acc_f = acc_f / total_len\r\n        print('[Testing][learning_phase=1] Epoch: {:d}/{:d} - loss: {:.3f} - acc: {:.3f}'.format(epoch+1, num_epoch, c_loss_t, acc_t) )\r\n        print('[Testing][learning_phase=0] Epoch: {:d}/{:d} - loss: {:.3f} - acc: {:.3f}'.format(epoch+1, num_epoch, c_loss_f, acc_f) )\r\n\r\n```\r\n\r\nThe first part of testing case is training model with high leval API and the result is as expected.\r\n```\r\n450/450 - 39s - loss: 1.9658 - accuracy: 0.2993 - val_loss: 1.7215 - val_accuracy: 0.3738\r\nEpoch 2/5\r\n450/450 - 28s - loss: 1.5722 - accuracy: 0.4334 - val_loss: 1.5897 - val_accuracy: 0.4152\r\nEpoch 3/5\r\n450/450 - 27s - loss: 1.3876 - accuracy: 0.4993 - val_loss: 1.4867 - val_accuracy: 0.4770\r\nEpoch 4/5\r\n450/450 - 28s - loss: 1.2564 - accuracy: 0.5477 - val_loss: 1.3498 - val_accuracy: 0.5060\r\nEpoch 5/5\r\n450/450 - 27s - loss: 1.1488 - accuracy: 0.5888 - val_loss: 1.3380 - val_accuracy: 0.5232\r\n10000/10000 - 3s - loss: 1.3523 - accuracy: 0.5289\r\n```\r\n\r\nI got a strange loss and the ourput can be seen the following:\r\n```\r\nMake sure that we create a new model.\r\n10000/10000 - 3s - loss: 10.2004 - accuracy: 0.1048\r\n[Training]Epoch: 1/5 - loss: 2.288 - acc: 0.268\r\n[Training]Epoch: 2/5 - loss: 1.513 - acc: 0.448\r\n[Training]Epoch: 3/5 - loss: 1.285 - acc: 0.537\r\n[Training]Epoch: 4/5 - loss: 1.426 - acc: 0.487\r\n[Training]Epoch: 5/5 - loss: 1.306 - acc: 0.535\r\nShow loss and accuracy with keras API\r\n45000/45000 - 9s - loss: nan - accuracy: 0.1002\r\n5000/5000 - 1s - loss: nan - accuracy: 0.0986\r\n10000/10000 - 2s - loss: nan - accuracy: 0.1000\r\nShow loss and accuracy with low level API\r\n[Validation][learning_phase=1] Epoch: 1/1 - loss: 1.163 - acc: 0.585\r\n[Validation][learning_phase=0] Epoch: 1/1 - loss: nan - acc: 0.099\r\n[Testing][learning_phase=1] Epoch: 1/1 - loss: 1.179 - acc: 0.587\r\n[Testing][learning_phase=0] Epoch: 1/1 - loss: nan - acc: 0.100\r\n```\r\n\r\nObviously, after training custom model with low level API, the result would be wrong when setting `tf.keras.backend.learning_phase(): 0`\r\n\r\nAlso, the result from keras API is wrong too.\r\n\r\n`tf.keras.backend.learning_phase(): 0` may affect the behavior of `tf.keras.layers.BatchNormalization()` but I'm not sure whether this is root cause.\r\n\r\nI have tried a small custom model without `tf.keras.layers.BatchNormalization()` for MNIST dataset and the result is normal.\r\n\r\nThe testcase for MNIST as shown in the following:\r\n\r\n```python\r\nimport tensorflow as tf\r\ntf.compat.v1.disable_eager_execution()\r\n#tf.compat.v1.disable_v2_behavior()\r\n\r\nimport numpy as np\r\n\r\nbatch_size = 100\r\n\r\ndef download_data():\r\n\r\n    # get raw data\r\n    (trainX, trainY), (testX, testY) = tf.keras.datasets.mnist.load_data()\r\n    trainX = trainX.astype(np.float32)\r\n    testX  = testX.astype(np.float32)\r\n\r\n    # ont-hot\r\n    trainY = tf.keras.utils.to_categorical(trainY, 10)\r\n    testY  = tf.keras.utils.to_categorical(testY , 10)\r\n\r\n    # get validation sets\r\n    training_size = 55000\r\n    validX = trainX[training_size:,:]\r\n    validY = trainY[training_size:,:]\r\n\r\n    trainX = trainX[:training_size,:]\r\n    trainY = trainY[:training_size,:]\r\n\r\n    # expand dimesion\r\n    trainX = np.expand_dims(trainX, axis=3)\r\n    validX = np.expand_dims(validX, axis=3)\r\n    testX  = np.expand_dims(testX , axis=3)\r\n\r\n    return trainX, trainY, validX, validY, testX, testY\r\n\r\ndef data_pipeline(dataX, dataY):\r\n\r\n        dataset = tf.data.Dataset.from_tensor_slices( (dataX, dataY) )\r\n        dataset = dataset.shuffle(batch_size * 8)\r\n        dataset = dataset.repeat()\r\n        dataset = dataset.batch(batch_size)\r\n        dataset = dataset.prefetch(tf.data.experimental.AUTOTUNE)\r\n        return dataset\r\n\r\nclass custom_model():\r\n    def __init__(self):\r\n\r\n        def Acc():\r\n            acc = tf.keras.metrics.categorical_accuracy(label_ref, clf_out)\r\n            return tf.math.reduce_mean(acc)\r\n\r\n        def c_loss():\r\n            loss = tf.keras.losses.categorical_crossentropy(label_ref, clf_out)\r\n            loss = tf.math.reduce_mean(loss)\r\n            return loss\r\n\r\n        # declare variables\r\n        self.init_op = tf.compat.v1.keras.initializers.he_normal()\r\n        model_layers = [ tf.keras.layers.Conv2D(16, (3, 3), padding=\"same\", activation=\"relu\", kernel_initializer=self.init_op, name=\"clf/c1\"),\r\n                         tf.keras.layers.Conv2D(32, (3, 3), padding=\"same\", activation=\"relu\", kernel_initializer=self.init_op, name=\"clf/c2\"),\r\n                         tf.keras.layers.MaxPooling2D(pool_size=(2, 2), name=\"clf/p1\"),\r\n                         tf.keras.layers.Conv2D(32, (3, 3), padding=\"same\", activation=\"relu\", kernel_initializer=self.init_op, name=\"clf/c3\"),\r\n                         tf.keras.layers.Conv2D(64, (3, 3), padding=\"same\", activation=\"relu\", kernel_initializer=self.init_op, name=\"clf/c4\"),\r\n                         tf.keras.layers.MaxPooling2D(pool_size=(2, 2), name=\"clf/p2\"),\r\n                         tf.keras.layers.Flatten(name=\"clf/f1\"),\r\n                         tf.keras.layers.Dense(256, activation=\"relu\", kernel_initializer=self.init_op, name=\"clf/d1\"),\r\n                         tf.keras.layers.Dense(10 , activation=None  , kernel_initializer=self.init_op, name=\"clf/d2\"),\r\n                         tf.keras.layers.Activation('softmax', name=\"clf/a1\")\r\n                        ]\r\n\r\n        # clf_model\r\n        clf_input = tf.keras.layers.Input(shape=(28,28,1 ), name=\"model/input\")\r\n        clf_out   = clf_input\r\n        for ii in model_layers:\r\n            clf_out = ii(clf_out)\r\n        clf_model = tf.keras.models.Model(inputs=clf_input, outputs=clf_out, name='clf_model')\r\n        clf_model.compile(loss='categorical_crossentropy', optimizer='Nadam', metrics=['accuracy'])\r\n\r\n\r\n        label_ref = tf.keras.layers.Input(shape=(10,) , name='label_ref')\r\n        clf_out = clf_model(clf_input)\r\n\r\n        # using tf.keras.optimizers.Nadam would get error\r\n        #optimizer = tf.keras.optimizers.Nadam(lr=0.0005)\r\n        optimizer = tf.compat.v1.train.AdamOptimizer(learning_rate=0.01)\r\n        self.train_op = optimizer.minimize(c_loss(), var_list=[clf_model.trainable_variables])\r\n\r\n        self.clf_model = clf_model\r\n        self.clf_input = clf_input\r\n        self.label_ref = label_ref\r\n        self.op_acc = Acc()\r\n        self.c_loss = c_loss()\r\n\r\nif __name__ == '__main__':\r\n\r\n    # set GPU\r\n    import os\r\n    if os.environ.get(\"CUDA_VISIBLE_DEVICES\") is None:\r\n        os.environ[\"CUDA_VISIBLE_DEVICES\"] = \"0\"\r\n\r\n    # reset tf session\r\n    tf.compat.v1.keras.backend.clear_session()\r\n    gpu_options = tf.compat.v1.GPUOptions(allow_growth=True)\r\n    sess = tf.compat.v1.Session(config=tf.compat.v1.ConfigProto(gpu_options=gpu_options))\r\n    tf.compat.v1.keras.backend.set_session(sess) \r\n\r\n    # prepare data\r\n    trainX, trainY, validX, validY, testX, testY = download_data()\r\n    train_gen = data_pipeline(trainX, trainY)\r\n    valid_gen = data_pipeline(validX, validY)\r\n    test_gen = data_pipeline(testX, testY)\r\n\r\n    # create a new model\r\n    print('Make sure that we create a new model.')\r\n    model = custom_model()\r\n    sess.run(tf.compat.v1.global_variables_initializer())\r\n    model.clf_model.evaluate(testX, testY, verbose=2, batch_size=batch_size)\r\n\r\n    # train model\r\n    num_epoch = 5\r\n    total_len = trainY.shape[0] // batch_size\r\n    tf_iter = tf.compat.v1.data.make_initializable_iterator(train_gen)\r\n    tf_next = tf_iter.get_next()\r\n    sess.run(tf_iter.initializer)\r\n    for epoch in range(num_epoch):\r\n        c_loss, acc = 0.0, 0.0\r\n        for ii in range(total_len):\r\n            X, Y = sess.run(tf_next)\r\n            [b_c_loss, b_acc, _] = sess.run([model.c_loss, model.op_acc, model.train_op],\r\n                                                feed_dict={ model.clf_input: X,\r\n                                                            model.label_ref: Y,\r\n                                                            tf.keras.backend.learning_phase(): 1})\r\n            c_loss = c_loss + b_c_loss\r\n            acc = acc + b_acc\r\n        \r\n        c_loss = c_loss / total_len\r\n        acc = acc / total_len\r\n        print('[Training]Epoch: {:d}/{:d} - loss: {:.3f} - acc: {:.3f}'.format(epoch+1, num_epoch, c_loss, acc) )\r\n\r\n    print('Show loss and accuracy with keras API')\r\n    model.clf_model.evaluate(trainX, trainY, verbose=2, batch_size=batch_size)\r\n    model.clf_model.evaluate(validX, validY, verbose=2, batch_size=batch_size)\r\n    model.clf_model.evaluate(testX, testY, verbose=2, batch_size=batch_size)\r\n\r\n    print('Show loss and accuracy with low level API')\r\n    # evaluate\r\n    num_epoch = 1\r\n    total_len = validY.shape[0] // batch_size\r\n    tf_iter = tf.compat.v1.data.make_initializable_iterator(valid_gen)\r\n    tf_next = tf_iter.get_next()\r\n    sess.run(tf_iter.initializer)\r\n    for epoch in range(num_epoch):\r\n        c_loss_t, acc_t, c_loss_f, acc_f = 0.0, 0.0, 0.0, 0.0\r\n        for ii in range(total_len):\r\n            X, Y = sess.run(tf_next)\r\n            [b_c_loss, b_acc] = sess.run([model.c_loss, model.op_acc],\r\n                                        feed_dict={ model.clf_input: X,\r\n                                                    model.label_ref: Y,\r\n                                                    tf.keras.backend.learning_phase(): 1})\r\n            c_loss_t = c_loss_t + b_c_loss\r\n            acc_t = acc_t + b_acc\r\n\r\n            [b_c_loss, b_acc] = sess.run([model.c_loss, model.op_acc],\r\n                                        feed_dict={ model.clf_input: X,\r\n                                                    model.label_ref: Y,\r\n                                                    tf.keras.backend.learning_phase(): 0})\r\n            c_loss_f = c_loss_f + b_c_loss\r\n            acc_f = acc_f + b_acc\r\n\r\n        c_loss_t = c_loss_t / total_len\r\n        c_loss_f = c_loss_f / total_len\r\n        acc_t = acc_t / total_len\r\n        acc_f = acc_f / total_len\r\n        print('[Validation][learning_phase=1] Epoch: {:d}/{:d} - loss: {:.3f} - acc: {:.3f}'.format(epoch+1, num_epoch, c_loss_t, acc_t) )\r\n        print('[Validation][learning_phase=0] Epoch: {:d}/{:d} - loss: {:.3f} - acc: {:.3f}'.format(epoch+1, num_epoch, c_loss_f, acc_f) )\r\n\r\n    # evaluate\r\n    num_epoch = 1\r\n    total_len = testY.shape[0] // batch_size\r\n    tf_iter = tf.compat.v1.data.make_initializable_iterator(test_gen)\r\n    tf_next = tf_iter.get_next()\r\n    sess.run(tf_iter.initializer)\r\n    for epoch in range(num_epoch):\r\n        c_loss_t, acc_t, c_loss_f, acc_f = 0.0, 0.0, 0.0, 0.0\r\n        for ii in range(total_len):\r\n            X, Y = sess.run(tf_next)\r\n            [b_c_loss, b_acc] = sess.run([model.c_loss, model.op_acc],\r\n                                        feed_dict={ model.clf_input: X,\r\n                                                    model.label_ref: Y,\r\n                                                    tf.keras.backend.learning_phase(): 1})\r\n            c_loss_t = c_loss_t + b_c_loss\r\n            acc_t = acc_t + b_acc\r\n\r\n            [b_c_loss, b_acc] = sess.run([model.c_loss, model.op_acc],\r\n                                        feed_dict={ model.clf_input: X,\r\n                                                    model.label_ref: Y,\r\n                                                    tf.keras.backend.learning_phase(): 0})\r\n            c_loss_f = c_loss_f + b_c_loss\r\n            acc_f = acc_f + b_acc\r\n\r\n        c_loss_t = c_loss_t / total_len\r\n        c_loss_f = c_loss_f / total_len\r\n        acc_t = acc_t / total_len\r\n        acc_f = acc_f / total_len\r\n        print('[Testing][learning_phase=1] Epoch: {:d}/{:d} - loss: {:.3f} - acc: {:.3f}'.format(epoch+1, num_epoch, c_loss_t, acc_t) )\r\n        print('[Testing][learning_phase=0] Epoch: {:d}/{:d} - loss: {:.3f} - acc: {:.3f}'.format(epoch+1, num_epoch, c_loss_f, acc_f) )\r\n```\r\n\r\nDefinitely, we got a very normal output:\r\n\r\n```\r\nMake sure that we create a new model.\r\n10000/10000 - 1s - loss: 398.0696 - acc: 0.1151\r\n[Training]Epoch: 1/5 - loss: 11.997 - acc: 0.558\r\n[Training]Epoch: 2/5 - loss: 0.474 - acc: 0.849\r\n[Training]Epoch: 3/5 - loss: 0.282 - acc: 0.914\r\n[Training]Epoch: 4/5 - loss: 0.213 - acc: 0.935\r\n[Training]Epoch: 5/5 - loss: 0.181 - acc: 0.945\r\nShow loss and accuracy with keras API\r\n55000/55000 - 1s - loss: 0.1555 - acc: 0.9535\r\n5000/5000 - 0s - loss: 0.1501 - acc: 0.9584\r\n10000/10000 - 0s - loss: 0.1687 - acc: 0.9539\r\nShow loss and accuracy with low level API\r\n[Validation][learning_phase=1] Epoch: 1/1 - loss: 0.150 - acc: 0.958\r\n[Validation][learning_phase=0] Epoch: 1/1 - loss: 0.150 - acc: 0.958\r\n[Testing][learning_phase=1] Epoch: 1/1 - loss: 0.169 - acc: 0.954\r\n[Testing][learning_phase=0] Epoch: 1/1 - loss: 0.169 - acc: 0.954\r\n```\r\n\r\n**Describe the expected behavior**\r\n\r\nIt should work properly.\r\n\r\n**Code to reproduce the issue**\r\n\r\nPlease see the section of **Describe the current behavior**\r\n\r\n**Other info / logs**\r\n\r\nskip ..."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35103", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35103/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35103/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35103/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35103", "id": 537806890, "node_id": "MDU6SXNzdWU1Mzc4MDY4OTA=", "number": 35103, "title": "Async functions cause tf_upgrade_v2 to crash", "user": {"login": "TheBicPen", "id": 23622288, "node_id": "MDQ6VXNlcjIzNjIyMjg4", "avatar_url": "https://avatars3.githubusercontent.com/u/23622288?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TheBicPen", "html_url": "https://github.com/TheBicPen", "followers_url": "https://api.github.com/users/TheBicPen/followers", "following_url": "https://api.github.com/users/TheBicPen/following{/other_user}", "gists_url": "https://api.github.com/users/TheBicPen/gists{/gist_id}", "starred_url": "https://api.github.com/users/TheBicPen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TheBicPen/subscriptions", "organizations_url": "https://api.github.com/users/TheBicPen/orgs", "repos_url": "https://api.github.com/users/TheBicPen/repos", "events_url": "https://api.github.com/users/TheBicPen/events{/privacy}", "received_events_url": "https://api.github.com/users/TheBicPen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 14, "created_at": "2019-12-13T22:31:45Z", "updated_at": "2020-02-06T20:57:50Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Manjaro Linux (kernel 4.19)\r\n- TensorFlow installed from (source or binary): binary? I'm not sure, I used `pip install tensorflow`\r\n- TensorFlow version: 2.0.0\r\n- Python version: Python 3.6.8\r\n- Installed using virtualenv? pip? conda?: pip. This is in a virtualenv environment though.\r\n\r\n**Describe the problem**\r\nRunning `tf_upgrade_v2` on a file that has async functions causes it to crash. \r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n```tf_upgrade_v2 --infile ./image_classification/test_tf.py --outfile ./image_classification_v2/test_tf.py\r\nTraceback (most recent call last):\r\n  File \"/home/alex/git-repos/bic-bot-py/bin/tf_upgrade_v2\", line 8, in <module>\r\n    sys.exit(main())\r\n  File \"/home/alex/git-repos/bic-bot-py/lib/python3.6/site-packages/tensorflow_core/tools/compatibility/tf_upgrade_v2_main.py\", line 139, in main\r\n    args.input_file, output_file, upgrade)\r\n  File \"/home/alex/git-repos/bic-bot-py/lib/python3.6/site-packages/tensorflow_core/tools/compatibility/tf_upgrade_v2_main.py\", line 40, in process_file\r\n    upgrader.process_file(in_filename, out_filename)\r\n  File \"/home/alex/git-repos/bic-bot-py/lib/python3.6/site-packages/tensorflow_core/tools/compatibility/ast_edits.py\", line 900, in process_file\r\n    temp_file)\r\n  File \"/home/alex/git-repos/bic-bot-py/lib/python3.6/site-packages/tensorflow_core/tools/compatibility/ast_edits.py\", line 960, in process_opened_file\r\n    self.update_string_pasta(\"\".join(lines), in_filename))\r\n  File \"/home/alex/git-repos/bic-bot-py/lib/python3.6/site-packages/tensorflow_core/tools/compatibility/ast_edits.py\", line 916, in update_string_pasta\r\n    t = pasta.parse(text)\r\n  File \"/home/alex/git-repos/bic-bot-py/lib/python3.6/site-packages/pasta/__init__.py\", line 25, in parse\r\n    annotator.visit(t)\r\n  File \"/home/alex/git-repos/bic-bot-py/lib/python3.6/site-packages/pasta/base/annotate.py\", line 1201, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"/home/alex/git-repos/bic-bot-py/lib/python3.6/site-packages/pasta/base/annotate.py\", line 133, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"/home/alex/.pyenv/versions/3.6.8/lib/python3.6/ast.py\", line 253, in visit\r\n    return visitor(node)\r\n  File \"/home/alex/git-repos/bic-bot-py/lib/python3.6/site-packages/pasta/base/annotate.py\", line 47, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"/home/alex/git-repos/bic-bot-py/lib/python3.6/site-packages/pasta/base/annotate.py\", line 225, in visit_Module\r\n    self.generic_visit(node)\r\n  File \"/home/alex/.pyenv/versions/3.6.8/lib/python3.6/ast.py\", line 261, in generic_visit\r\n    self.visit(item)\r\n  File \"/home/alex/git-repos/bic-bot-py/lib/python3.6/site-packages/pasta/base/annotate.py\", line 1201, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"/home/alex/git-repos/bic-bot-py/lib/python3.6/site-packages/pasta/base/annotate.py\", line 133, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"/home/alex/.pyenv/versions/3.6.8/lib/python3.6/ast.py\", line 253, in visit\r\n    return visitor(node)\r\n  File \"/home/alex/.pyenv/versions/3.6.8/lib/python3.6/ast.py\", line 261, in generic_visit\r\n    self.visit(item)\r\n  File \"/home/alex/git-repos/bic-bot-py/lib/python3.6/site-packages/pasta/base/annotate.py\", line 1201, in visit\r\n    super(AstAnnotator, self).visit(node)\r\n  File \"/home/alex/git-repos/bic-bot-py/lib/python3.6/site-packages/pasta/base/annotate.py\", line 133, in visit\r\n    super(BaseVisitor, self).visit(node)\r\n  File \"/home/alex/.pyenv/versions/3.6.8/lib/python3.6/ast.py\", line 253, in visit\r\n    return visitor(node)\r\n  File \"/home/alex/git-repos/bic-bot-py/lib/python3.6/site-packages/pasta/base/annotate.py\", line 47, in wrapped\r\n    f(self, node, *args, **kwargs)\r\n  File \"/home/alex/git-repos/bic-bot-py/lib/python3.6/site-packages/pasta/base/annotate.py\", line 673, in visit_Return\r\n    self.token('return')\r\n  File \"/home/alex/git-repos/bic-bot-py/lib/python3.6/site-packages/pasta/base/annotate.py\", line 1340, in token\r\n    token_val, token.src, token.start[0], token.line))\r\npasta.base.annotate.AnnotationError: Expected 'return' but found 'async'\r\nline 1: async def f():\r\n```\r\n\r\n**Any other info / logs**\r\ntest_tf.py:\r\n```\r\nasync def f():\r\n    return\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35102", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35102/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35102/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35102/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35102", "id": 537806887, "node_id": "MDU6SXNzdWU1Mzc4MDY4ODc=", "number": 35102, "title": "Adam implementation differs from paper (applies bias B_2 correction to \\epsilon)", "user": {"login": "bmc2-stripe", "id": 54961543, "node_id": "MDQ6VXNlcjU0OTYxNTQz", "avatar_url": "https://avatars1.githubusercontent.com/u/54961543?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bmc2-stripe", "html_url": "https://github.com/bmc2-stripe", "followers_url": "https://api.github.com/users/bmc2-stripe/followers", "following_url": "https://api.github.com/users/bmc2-stripe/following{/other_user}", "gists_url": "https://api.github.com/users/bmc2-stripe/gists{/gist_id}", "starred_url": "https://api.github.com/users/bmc2-stripe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bmc2-stripe/subscriptions", "organizations_url": "https://api.github.com/users/bmc2-stripe/orgs", "repos_url": "https://api.github.com/users/bmc2-stripe/repos", "events_url": "https://api.github.com/users/bmc2-stripe/events{/privacy}", "received_events_url": "https://api.github.com/users/bmc2-stripe/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "alextp", "id": 5061, "node_id": "MDQ6VXNlcjUwNjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/5061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alextp", "html_url": "https://github.com/alextp", "followers_url": "https://api.github.com/users/alextp/followers", "following_url": "https://api.github.com/users/alextp/following{/other_user}", "gists_url": "https://api.github.com/users/alextp/gists{/gist_id}", "starred_url": "https://api.github.com/users/alextp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alextp/subscriptions", "organizations_url": "https://api.github.com/users/alextp/orgs", "repos_url": "https://api.github.com/users/alextp/repos", "events_url": "https://api.github.com/users/alextp/events{/privacy}", "received_events_url": "https://api.github.com/users/alextp/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alextp", "id": 5061, "node_id": "MDQ6VXNlcjUwNjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/5061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alextp", "html_url": "https://github.com/alextp", "followers_url": "https://api.github.com/users/alextp/followers", "following_url": "https://api.github.com/users/alextp/following{/other_user}", "gists_url": "https://api.github.com/users/alextp/gists{/gist_id}", "starred_url": "https://api.github.com/users/alextp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alextp/subscriptions", "organizations_url": "https://api.github.com/users/alextp/orgs", "repos_url": "https://api.github.com/users/alextp/repos", "events_url": "https://api.github.com/users/alextp/events{/privacy}", "received_events_url": "https://api.github.com/users/alextp/received_events", "type": "User", "site_admin": false}, {"login": "robieta", "id": 13089297, "node_id": "MDQ6VXNlcjEzMDg5Mjk3", "avatar_url": "https://avatars0.githubusercontent.com/u/13089297?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robieta", "html_url": "https://github.com/robieta", "followers_url": "https://api.github.com/users/robieta/followers", "following_url": "https://api.github.com/users/robieta/following{/other_user}", "gists_url": "https://api.github.com/users/robieta/gists{/gist_id}", "starred_url": "https://api.github.com/users/robieta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robieta/subscriptions", "organizations_url": "https://api.github.com/users/robieta/orgs", "repos_url": "https://api.github.com/users/robieta/repos", "events_url": "https://api.github.com/users/robieta/events{/privacy}", "received_events_url": "https://api.github.com/users/robieta/received_events", "type": "User", "site_admin": false}, {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-12-13T22:31:44Z", "updated_at": "2019-12-23T19:46:12Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): N/A\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04.6\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): v2.0.0-rc2-26-g64c3d38 2.0.0\r\n- Python version: 3.7.3\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source): N/A\r\n- CUDA/cuDNN version: V10.0.130\r\n- GPU model and memory: Tesla V100-SXM2\r\n\r\n**Describe the current behavior**\r\nIn the Adam paper, we subtract the following quantity from our current gradient [0]:\r\n\\alpha * \\hat{m_t} / (\\sqrt{v_t / (1-\\beta^t_2)}  + \\epsilon)\r\n\r\n<img width=\"475\" alt=\"Screen Shot 2019-12-13 at 2 32 58 PM\" src=\"https://user-images.githubusercontent.com/54961543/70836600-7f490780-1db5-11ea-9669-27c50fe48cae.png\">\r\n\r\nThe Tensorflow implementation subtracts a subtly different quantity ([1]):\r\n\\alpha * \\hat{m_t} * \\sqrt{1-\\beta^T_2} / (\\sqrt{v_t} + \\epsilon)\r\n\r\n<img width=\"438\" alt=\"Screen Shot 2019-12-13 at 2 34 36 PM\" src=\"https://user-images.githubusercontent.com/54961543/70836654-c1724900-1db5-11ea-9260-5fc0678f6f39.png\">\r\n\r\nThe difference between the two expressions is that in the first, we de-bias only the moving average of the squared gradient, v_t. In the second, this bias correction is also applied to \\epsilon. This manifests as scaling up epilson quite a lot in very early training steps, reducing the magnitude of the gradient update.\r\n\r\nNote that the same bug was present in PyTorch prior to v1.3. It was fixed in this PR: https://github.com/pytorch/pytorch/pull/22628. That PR description provides a useful visualization.\r\n\r\n**Describe the expected behavior**\r\nImplement the algorithm as described in the paper. If the old implementation is necessary to preserve back-compat, providing a flag to trigger the correct implementation would be most helpful.\r\n\r\n\r\n[0] https://arxiv.org/pdf/1412.6980.pdf, see final 2 lines of Algorithm 1\r\n[1] Notable lines in TF implementation regarding this issue: \r\nhttps://github.com/tensorflow/tensorflow/blob/r2.0/tensorflow/python/keras/optimizer_v2/adam.py#L162\r\n\r\nhttps://github.com/tensorflow/tensorflow/blob/r2.0/tensorflow/python/keras/optimizer_v2/adam.py#L245\r\n\r\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/kernels/training_ops.cc#L373\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35099", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35099/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35099/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35099/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35099", "id": 537796132, "node_id": "MDU6SXNzdWU1Mzc3OTYxMzI=", "number": 35099, "title": "Inconsistency with the shapes for `reduce_sum` and `reduce_logsumexp` for vectorized_map in graph mode", "user": {"login": "rrkarim", "id": 11855380, "node_id": "MDQ6VXNlcjExODU1Mzgw", "avatar_url": "https://avatars0.githubusercontent.com/u/11855380?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rrkarim", "html_url": "https://github.com/rrkarim", "followers_url": "https://api.github.com/users/rrkarim/followers", "following_url": "https://api.github.com/users/rrkarim/following{/other_user}", "gists_url": "https://api.github.com/users/rrkarim/gists{/gist_id}", "starred_url": "https://api.github.com/users/rrkarim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rrkarim/subscriptions", "organizations_url": "https://api.github.com/users/rrkarim/orgs", "repos_url": "https://api.github.com/users/rrkarim/repos", "events_url": "https://api.github.com/users/rrkarim/events{/privacy}", "received_events_url": "https://api.github.com/users/rrkarim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2019-12-13T21:59:01Z", "updated_at": "2020-03-16T18:35:16Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "I don't understand the cause of different handling of shapes for two methods, here is the snippet:\r\n\r\n```python\r\nimport tensorflow as tf\r\nimport tensorflow_probability as tfp\r\n\r\ndef _log_prob(x):\r\n    x = tf.convert_to_tensor(x, name='x')\r\n    distribution_log_probs = [x for i in range(5)]\r\n    cat_log_probs = [x for i in range(5)]\r\n    final_log_probs = [\r\n        cat_lp + d_lp\r\n        for (cat_lp, d_lp) in zip(cat_log_probs, distribution_log_probs)\r\n    ]\r\n    concat_log_probs = tf.stack(final_log_probs, 0)\r\n    log_sum = tf.reduce_logsumexp(concat_log_probs, axis=[0])\r\n    # log_sum = tf.reduce_sum(concat_log_probs, axis=[0])\r\n    return log_sum\r\n\r\n@tf.function(autograph=False)\r\ndef f():\r\n    log_prob = tf.vectorized_map(_log_prob, tf.ones((1,5)))\r\n    print(log_prob.shape) # prints (None, 5) for `tf.reduce_logsumexp` and (1, 5) for `tf.reduce_sum`\r\n```\r\n\r\nSo basically `tf.reduce_logsumexp` gives dynamic shape for the output tensor while `tf.reduce_sum` assigns static shape. Can anybody please give some clear picture on such behaviour and is it expected?\r\n\r\n```\r\ntf: 2.0.0\r\ntfp: 0.8.0\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35096", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35096/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35096/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35096/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35096", "id": 537741484, "node_id": "MDU6SXNzdWU1Mzc3NDE0ODQ=", "number": 35096, "title": "Tensorflow lite C++ standalone projects from 'generate_projects' missing sparkfun headers?", "user": {"login": "BerndHuber", "id": 17990096, "node_id": "MDQ6VXNlcjE3OTkwMDk2", "avatar_url": "https://avatars1.githubusercontent.com/u/17990096?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BerndHuber", "html_url": "https://github.com/BerndHuber", "followers_url": "https://api.github.com/users/BerndHuber/followers", "following_url": "https://api.github.com/users/BerndHuber/following{/other_user}", "gists_url": "https://api.github.com/users/BerndHuber/gists{/gist_id}", "starred_url": "https://api.github.com/users/BerndHuber/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BerndHuber/subscriptions", "organizations_url": "https://api.github.com/users/BerndHuber/orgs", "repos_url": "https://api.github.com/users/BerndHuber/repos", "events_url": "https://api.github.com/users/BerndHuber/events{/privacy}", "received_events_url": "https://api.github.com/users/BerndHuber/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rockyrhodes", "id": 7253968, "node_id": "MDQ6VXNlcjcyNTM5Njg=", "avatar_url": "https://avatars2.githubusercontent.com/u/7253968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rockyrhodes", "html_url": "https://github.com/rockyrhodes", "followers_url": "https://api.github.com/users/rockyrhodes/followers", "following_url": "https://api.github.com/users/rockyrhodes/following{/other_user}", "gists_url": "https://api.github.com/users/rockyrhodes/gists{/gist_id}", "starred_url": "https://api.github.com/users/rockyrhodes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rockyrhodes/subscriptions", "organizations_url": "https://api.github.com/users/rockyrhodes/orgs", "repos_url": "https://api.github.com/users/rockyrhodes/repos", "events_url": "https://api.github.com/users/rockyrhodes/events{/privacy}", "received_events_url": "https://api.github.com/users/rockyrhodes/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rockyrhodes", "id": 7253968, "node_id": "MDQ6VXNlcjcyNTM5Njg=", "avatar_url": "https://avatars2.githubusercontent.com/u/7253968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rockyrhodes", "html_url": "https://github.com/rockyrhodes", "followers_url": "https://api.github.com/users/rockyrhodes/followers", "following_url": "https://api.github.com/users/rockyrhodes/following{/other_user}", "gists_url": "https://api.github.com/users/rockyrhodes/gists{/gist_id}", "starred_url": "https://api.github.com/users/rockyrhodes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rockyrhodes/subscriptions", "organizations_url": "https://api.github.com/users/rockyrhodes/orgs", "repos_url": "https://api.github.com/users/rockyrhodes/repos", "events_url": "https://api.github.com/users/rockyrhodes/events{/privacy}", "received_events_url": "https://api.github.com/users/rockyrhodes/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-12-13T19:44:19Z", "updated_at": "2019-12-16T07:05:07Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): OSX 10.14.6\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version: 1.15.0 (same observation for version 2.0), from https://github.com/tensorflow/tensorflow/releases/tag/v1.15.0\r\n- Python version: python3\r\n- GCC/Compiler version (if compiling from source): arm-none-eabi-g++\r\n\r\n**Describe the problem**\r\nThe standalone projects generated with Tensorflow Lite seem to be missing some headers.\r\n\r\nFollowing this tutorial: \r\n[https://www.tensorflow.org/lite/microcontrollers/library#generate_projects_for_other_platforms\r\n](https://www.tensorflow.org/lite/microcontrollers/library#generate_projects_for_other_platforms\r\n)\r\n\r\nI run the following command (the link seems to be off here in the tutorial, as 'micro' is in another subfolder' experimental'):\r\n`gmake -f tensorflow/lite/experimental/micro/tools/make/Makefile TARGET=sparkfun_edge generate_projects`\r\n\r\nAfter this command is finished, the files are generated as expected in:\r\n`tensorflow/lite/experimental/micro/tools/make/gen/sparkfun_edge_cortex-m4/prj`\r\n\r\nBut when trying to build the micro_speech binary like this:\r\n```\r\ncd tensorflow/lite/experimental/micro/tools/make/gen/sparkfun_edge_cortex-m4/prj/micro_speech/make\r\ngmake\r\n```\r\n\r\nI am getting the following error:\r\n```\r\narm-none-eabi-g++ -O3 -DNDEBUG -std=c++11 -g -DTF_LITE_STATIC_MEMORY -DPART_apollo3 -DAM_PACKAGE_BGA -DAM_PART_APOLLO3 -DGEMMLOWP_ALLOW_SLOW_SCALAR_FALLBACK -DTF_LITE_STATIC_MEMORY -DNDEBUG -DTF_LITE_MCU_DEBUG_LOG -D __FPU_PRESENT=1 -DARM_MATH_CM4 -fno-rtti -fmessage-length=0 -fno-exceptions -fno-unwind-tables -fno-builtin -ffunction-sections -fdata-sections -funsigned-char -MMD -mcpu=cortex-m4 -mthumb -mfpu=fpv4-sp-d16 -mfloat-abi=hard -std=gnu++11 -Wvla -Wall -Wextra -Wno-unused-parameter -Wno-missing-field-initializers -Wno-write-strings -Wno-sign-compare -fno-delete-null-pointer-checks -fomit-frame-pointer -fpermissive -nostdlib -ggdb -O3 -I. -I./third_party/gemmlowp -I./third_party/flatbuffers/include -I./third_party/kissfft  -c tensorflow/lite/experimental/micro/sparkfun_edge/debug_log.cc -o tensorflow/lite/experimental/micro/sparkfun_edge/debug_log.o\r\ntensorflow/lite/experimental/micro/sparkfun_edge/debug_log.cc:22:10: fatal error: am_bsp.h: No such file or directory\r\n #include \"am_bsp.h\"   // NOLINT\r\n          ^~~~~~~~~~\r\ncompilation terminated.\r\nmake: *** [tensorflow/lite/experimental/micro/sparkfun_edge/debug_log.o] Error 1\r\n```\r\n\r\nThis is the header file of the sparkfun edge board that I want to build this for.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35093", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35093/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35093/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35093/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35093", "id": 537646606, "node_id": "MDU6SXNzdWU1Mzc2NDY2MDY=", "number": 35093, "title": "Custom loss may not work when running keras model with tf.distribute.MirroredStrategy()", "user": {"login": "CNOCycle", "id": 24318472, "node_id": "MDQ6VXNlcjI0MzE4NDcy", "avatar_url": "https://avatars3.githubusercontent.com/u/24318472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CNOCycle", "html_url": "https://github.com/CNOCycle", "followers_url": "https://api.github.com/users/CNOCycle/followers", "following_url": "https://api.github.com/users/CNOCycle/following{/other_user}", "gists_url": "https://api.github.com/users/CNOCycle/gists{/gist_id}", "starred_url": "https://api.github.com/users/CNOCycle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CNOCycle/subscriptions", "organizations_url": "https://api.github.com/users/CNOCycle/orgs", "repos_url": "https://api.github.com/users/CNOCycle/repos", "events_url": "https://api.github.com/users/CNOCycle/events{/privacy}", "received_events_url": "https://api.github.com/users/CNOCycle/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-12-13T16:35:52Z", "updated_at": "2019-12-17T12:41:00Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04 in Docker\r\n- TensorFlow installed from (source or binary): pip install\r\n- TensorFlow version (use command below): v2.0.0-rc2-26-g64c3d38\r\n- Python version: 3.5\r\n- CUDA/cuDNN version: 10.0 / 7\r\n- GPU model and memory: GTX 1080Ti / 11175MiB\r\n\r\n**Describe the current behavior**\r\n\r\nHi authors and developers,\r\n\r\nI am developing our project in tf=2.0.0 and eager_mode is disable.\r\n\r\nThe main reason is tf=1.x will not be maintained but third party libraries have not been ready for tf=2.0 yet.\r\n\r\nI got bug when I was running custom loss keras model with tf.distribute.MirroredStrategy()\r\n\r\nThis bug can be reproduced by the following minimal testcase:\r\n\r\n```python\r\n#%%\r\nfrom distutils.version import LooseVersion\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\n# disable eager model for tf=2.x\r\ntf.compat.v1.disable_eager_execution()\r\n\r\nbatch_size = 100\r\nimg_h = 32\r\nimg_w = 32\r\nimg_min = 0\r\nimg_max = 1\r\nchannels = 3\r\nnum_classes = 10\r\n\r\nstrategy = tf.distribute.MirroredStrategy()\r\n#%%\r\ndef download_data():\r\n\r\n    # get raw data\r\n    (trainX, trainY), (testX, testY) = tf.keras.datasets.cifar10.load_data()\r\n    trainX = trainX.astype(np.float32)\r\n    testX  = testX.astype(np.float32)\r\n\r\n    # ont-hot\r\n    trainY = tf.keras.utils.to_categorical(trainY, 10)\r\n    testY  = tf.keras.utils.to_categorical(testY , 10)\r\n\r\n    # get validation sets\r\n    training_size = 45000\r\n    validX = trainX[training_size:,:]\r\n    validY = trainY[training_size:,:]\r\n\r\n    trainX = trainX[:training_size,:]\r\n    trainY = trainY[:training_size,:]\r\n\r\n    return trainX, trainY, validX, validY, testX, testY\r\n\r\n#%%\r\nclass DataGenerator:\r\n\r\n    def __init__(self, sess, dataX, dataY, total_len, batch_size):\r\n\r\n        super().__init__()\r\n\r\n        self.total_len  = total_len\r\n        self.batch_size = batch_size\r\n        self.cleanX = dataX\r\n        self.totalY = dataY\r\n        self.sess = sess\r\n        self.on_epoch_end()\r\n\r\n    def __build_pipeline(self, dataX, dataY):\r\n\r\n        # create dataset API\r\n        def preprocess_fn(dataX, dataY):\r\n            \r\n            dataX = tf.image.random_flip_left_right(dataX)\r\n\r\n            # workaround solution\r\n            if LooseVersion(tf.__version__) < LooseVersion('1.14.0'):\r\n                outputX = dataX\r\n            else:\r\n                outputX = (dataX, dataY)\r\n            return outputX, dataY\r\n\r\n        dataset = tf.data.Dataset.from_tensor_slices( (dataX, dataY) )\r\n        dataset = dataset.shuffle(batch_size * 8)\r\n        dataset = dataset.repeat()\r\n        dataset = dataset.batch(batch_size)\r\n        dataset = dataset.map(preprocess_fn, num_parallel_calls=tf.data.experimental.AUTOTUNE)\r\n        dataset = dataset.prefetch(tf.data.experimental.AUTOTUNE)\r\n\r\n        self.dataset   = dataset\r\n\r\n    def  __len__(self):\r\n\r\n        return self.total_len // self.batch_size\r\n\r\n    def on_epoch_end(self):\r\n\r\n        # run permutation\r\n        rand_idx = np.random.permutation(self.total_len)\r\n        cleanX = self.cleanX[rand_idx]\r\n        totalY = self.totalY[rand_idx]\r\n\r\n        self.__build_pipeline(cleanX, totalY)\r\n\r\n#%%\r\n# ref: https://keras.io/examples/cifar10_resnet/\r\ndef build_clf():\r\n    #with strategy.scope():\r\n    with tf.compat.v1.variable_scope('optimizer'):\r\n        def resnet_layer(inputs,\r\n                        num_filters=16,\r\n                        kernel_size=3,\r\n                        strides=1,\r\n                        activation='relu',\r\n                        batch_normalization=True,\r\n                        conv_first=True):\r\n            \"\"\"2D Convolution-Batch Normalization-Activation stack builder\r\n\r\n            # Arguments\r\n                inputs (tensor): input tensor from input image or previous layer\r\n                num_filters (int): Conv2D number of filters\r\n                kernel_size (int): Conv2D square kernel dimensions\r\n                strides (int): Conv2D square stride dimensions\r\n                activation (string): activation name\r\n                batch_normalization (bool): whether to include batch normalization\r\n                conv_first (bool): conv-bn-activation (True) or\r\n                    bn-activation-conv (False)\r\n\r\n            # Returns\r\n                x (tensor): tensor as input to the next layer\r\n            \"\"\"\r\n            conv = tf.keras.layers.Conv2D(num_filters,\r\n                        kernel_size=kernel_size,\r\n                        strides=strides,\r\n                        padding='same',\r\n                        kernel_initializer='he_normal',\r\n                        kernel_regularizer=tf.keras.regularizers.l2(1e-4))\r\n\r\n            x = inputs\r\n            if conv_first:\r\n                x = conv(x)\r\n                if batch_normalization:\r\n                    x = tf.keras.layers.BatchNormalization()(x)\r\n                if activation is not None:\r\n                    x = tf.keras.layers.Activation(activation)(x)\r\n            else:\r\n                if batch_normalization:\r\n                    x = tf.keras.layers.BatchNormalization()(x)\r\n                if activation is not None:\r\n                    x = tf.keras.layers.Activation(activation)(x)\r\n                x = conv(x)\r\n            return x\r\n\r\n        def cw_loss(y_true, y_pred):\r\n            label_mask  = label_ref\r\n            pre_softmax = x\r\n            if LooseVersion(tf.__version__) < LooseVersion('1.14.0'):\r\n                correct_logit = tf.reduce_sum(label_mask * pre_softmax, axis=1, keep_dims=True)\r\n            else:\r\n                correct_logit = tf.reduce_sum(label_mask * pre_softmax, axis=1, keepdims=True)\r\n            distance = tf.nn.relu( pre_softmax - correct_logit + (1-label_mask) * 10)\r\n            inactivate = tf.cast( tf.less_equal(distance, 1e-9), dtype=tf.float32)\r\n            weight = tf.keras.layers.Activation('softmax')(-1e9*inactivate + distance)\r\n            loss = tf.reduce_sum((1-label_mask) * distance * weight, axis=1)\r\n            loss = tf.math.reduce_mean(loss)\r\n            return loss\r\n\r\n        # set model's parameters (depth = n * 6 + 2)\r\n        n = 8\r\n        num_filters = 16\r\n\r\n        clf_input = tf.keras.layers.Input(shape=(img_h, img_w, channels), name=\"model/input\")\r\n        label_ref = tf.keras.layers.Input(shape=(num_classes,), name='label_ref')\r\n        input_list = [clf_input, label_ref]\r\n\r\n        x = resnet_layer(inputs=clf_input)\r\n        for stack in range(3):\r\n            for res_block in range(n):\r\n                strides = 1\r\n                if stack > 0 and res_block == 0:  # first layer but not first stack\r\n                    strides = 2  # downsample\r\n                y = resnet_layer(inputs=x,\r\n                                num_filters=num_filters,\r\n                                strides=strides)\r\n                y = resnet_layer(inputs=y,\r\n                                num_filters=num_filters,\r\n                                activation=None)\r\n                if stack > 0 and res_block == 0:  # first layer but not first stack\r\n                    # linear projection residual shortcut connection to match\r\n                    # changed dims\r\n                    x = resnet_layer(inputs=x,\r\n                                    num_filters=num_filters,\r\n                                    kernel_size=1,\r\n                                    strides=strides,\r\n                                    activation=None,\r\n                                    batch_normalization=False)\r\n                x = tf.keras.layers.Add()([x, y])\r\n                x = tf.keras.layers.Activation('relu')(x)\r\n            num_filters *= 2\r\n\r\n        x = tf.keras.layers.AveragePooling2D(pool_size=8)(x)\r\n        x = tf.keras.layers.Flatten()(x)\r\n        x = tf.keras.layers.Dense(num_classes , kernel_initializer='he_normal', activation=None)(x)\r\n        y = tf.keras.layers.Activation('softmax')(x)\r\n\r\n        optimizer = tf.keras.optimizers.Adam(lr=0.001)\r\n        clf_model = tf.keras.models.Model(inputs=input_list, outputs=y, name='clf_model')\r\n        clf_model.compile(loss='categorical_crossentropy', optimizer=optimizer, metrics=['accuracy', cw_loss])\r\n    clf_model.summary()\r\n\r\n    return clf_model\r\n\r\n#%%\r\nif __name__ == '__main__':\r\n\r\n    # set GPU\r\n    import os\r\n    if os.environ.get(\"CUDA_VISIBLE_DEVICES\") is None:\r\n        os.environ[\"CUDA_VISIBLE_DEVICES\"] = \"0\"\r\n\r\n    # reset tf session\r\n    tf.compat.v1.keras.backend.clear_session()\r\n    gpu_options = tf.compat.v1.GPUOptions(allow_growth=True)\r\n    sess = tf.compat.v1.Session(config=tf.compat.v1.ConfigProto(gpu_options=gpu_options))\r\n    tf.compat.v1.keras.backend.set_session(sess)\r\n\r\n    # Hyperparameters\r\n    batch_size = 100\r\n    epochs = 1\r\n\r\n    # prepare data\r\n    trainX, trainY, validX, validY, testX, testY = download_data()\r\n    train_gen = DataGenerator(sess, trainX, trainY, trainY.shape[0], batch_size)\r\n    valid_gen = DataGenerator(sess, validX, validY, validY.shape[0], batch_size)\r\n    test_gen  = DataGenerator(sess, testX, testY, testY.shape[0], batch_size)\r\n\r\n    # build model\r\n    model = build_clf()\r\n\r\n    # train model\r\n    model.fit(train_gen.dataset,\r\n                    epochs=epochs,\r\n                    steps_per_epoch = train_gen.__len__(),\r\n                    validation_data=valid_gen.dataset,\r\n                    validation_steps= valid_gen.__len__(),\r\n                    verbose=1)\r\n\r\n    # print result\r\n    meta_string = '[Testing]'\r\n    prefix_string = ''\r\n    output = model.evaluate(test_gen.dataset, steps = test_gen.__len__())\r\n    for ii in range( len( model.metrics_names) ):\r\n        meta_string = meta_string + '- {:s}{:s}: {:.3f} '.format(prefix_string, model.metrics_names[ii], output[ii])\r\n\r\n    print(meta_string)\r\n```\r\n\r\nFirst, this testing case looks good without enabling `tf.distribute.MirroredStrategy()`\r\n\r\nThere is the output for normal case:\r\n\r\n```\r\nTrain on 450 steps, validate on 50 steps\r\n2019-12-13 16:20:30.625379: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0\r\n2019-12-13 16:20:31.217430: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7\r\n2019-12-13 16:20:33.007150: W tensorflow/stream_executor/cuda/redzone_allocator.cc:312] Not found: ./bin/ptxas not found\r\nRelying on driver to perform ptx compilation. This message will be only logged once.\r\n450/450 [==============================] - 40s 88ms/step - loss: 1.8299 - accuracy: 0.4744 - cw_loss: 9.5022 - val_loss: 1.9870 - val_accuracy: 0.4528 - val_cw_loss: 9.6570\r\n100/100 [==============================] - 3s 26ms/step - loss: 2.0089 - accuracy: 0.4511 - cw_loss: 9.6708\r\n[Testing]- loss: 2.009 - accuracy: 0.451 - cw_loss: 9.671\r\n\r\n```\r\n\r\nNext, we tried to enable `tf.distribute.MirroredStrategy()` so we modified the testcase by the following patch:\r\n\r\n```diff\r\ndef build_clf():\r\n-    #with strategy.scope():\r\n-    with tf.compat.v1.variable_scope('optimizer'):\r\ndef build_clf():\r\n+    with strategy.scope():\r\n+    #with tf.compat.v1.variable_scope('optimizer'):\r\n```\r\n\r\nAnd we got the error message:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"bug.py\", line 233, in <module>\r\n    verbose=1)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/keras/engine/training.py\", line 717, in fit\r\n    use_multiprocessing=use_multiprocessing)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/keras/engine/training_distributed.py\", line 685, in fit\r\n    steps_name='steps_per_epoch')\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/keras/engine/training_arrays.py\", line 299, in model_iteration\r\n    batch_outs = f(actual_inputs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/keras/backend.py\", line 3580, in __call__\r\n    run_metadata=self.run_metadata)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/client/session.py\", line 1472, in __call__\r\n    run_metadata_ptr)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.\r\n  (0) Invalid argument: You must feed a value for placeholder tensor 'model/input' with dtype float and shape [?,32,32,3]\r\n         [[{{node model/input}}]]\r\n         [[batch_normalization_9/cond/else/_325/FusedBatchNormV3/ReadVariableOp/_2529]]\r\n  (1) Invalid argument: You must feed a value for placeholder tensor 'model/input' with dtype float and shape [?,32,32,3]\r\n         [[{{node model/input}}]]\r\n0 successful operations.\r\n0 derived errors ignored.\r\n```\r\n\r\nThis error is very similar to the previous issue #34866.\r\n\r\nI guess that those two issues may have some strong connection.\r\n\r\n**Describe the expected behavior**\r\n\r\nIt should work properly.\r\n\r\n**Code to reproduce the issue**\r\n\r\nPlease see the section of **Describe the current behavior**\r\n\r\n**Other info / logs**\r\n\r\nThe following message is the result generated by `tf_env_collect.sh`\r\n```\r\n== check python ===================================================\r\npython version: 3.5.2\r\npython branch:\r\npython build version: ('default', 'Oct  8 2019 13:06:37')\r\npython compiler version: GCC 5.4.0 20160609\r\npython implementation: CPython\r\n\r\n\r\n== check os platform ===============================================\r\nos: Linux\r\nos kernel version: #40~18.04.1-Ubuntu SMP Thu Nov 14 12:06:39 UTC 2019\r\nos release version: 5.0.0-37-generic\r\nos platform: Linux-5.0.0-37-generic-x86_64-with-Ubuntu-16.04-xenial\r\nlinux distribution: ('Ubuntu', '16.04', 'xenial')\r\nlinux os distribution: ('Ubuntu', '16.04', 'xenial')\r\nmac version: ('', ('', '', ''), '')\r\nuname: uname_result(system='Linux', node='f7f509f1dacf', release='5.0.0-37-generic', version='#40~18.04.1-Ubuntu SMP Thu Nov 14 12:06:39 UTC 2019', machine='x86_64', processor='x86_64')\r\narchitecture: ('64bit', 'ELF')\r\nmachine: x86_64\r\n\r\n\r\n== are we in docker =============================================\r\nYes\r\n\r\n== compiler =====================================================\r\nc++ (Ubuntu 5.4.0-6ubuntu1~16.04.12) 5.4.0 20160609\r\nCopyright (C) 2015 Free Software Foundation, Inc.\r\nThis is free software; see the source for copying conditions.  There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n\r\n\r\n== check pips ===================================================\r\nnumpy                  1.17.4\r\nprotobuf               3.11.1\r\ntensorflow-estimator   2.0.1\r\ntensorflow-gpu         2.0.0\r\ntensorflow-probability 0.8.0\r\n\r\n== check for virtualenv =========================================\r\nFalse\r\n\r\n== tensorflow import ============================================\r\ntf.version.VERSION = 2.0.0\r\ntf.version.GIT_VERSION = v2.0.0-rc2-26-g64c3d38\r\ntf.version.COMPILER_VERSION = 7.3.1 20180303\r\nSanity check: array([1], dtype=int32)\r\n       443:     find library=libpthread.so.0 [0]; searching\r\n       443:      search path=/usr/local/nvidia/lib/tls/x86_64:/usr/local/nvidia/lib/tls:/usr/local/nvidia/lib/x86_64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64/tls/x86_64:/usr/local/nvidia/lib64/tls:/usr/local/nvidia/lib64/x86_64:/usr/local/nvidia/lib64          (LD_LIBRARY_PATH)\r\n       443:       trying file=/usr/local/nvidia/lib/tls/x86_64/libpthread.so.0\r\n       443:       trying file=/usr/local/nvidia/lib/tls/libpthread.so.0\r\n       443:       trying file=/usr/local/nvidia/lib/x86_64/libpthread.so.0\r\n       443:       trying file=/usr/local/nvidia/lib/libpthread.so.0\r\n       443:       trying file=/usr/local/nvidia/lib64/tls/x86_64/libpthread.so.0\r\n       443:       trying file=/usr/local/nvidia/lib64/tls/libpthread.so.0\r\n       443:       trying file=/usr/local/nvidia/lib64/x86_64/libpthread.so.0\r\n       443:       trying file=/usr/local/nvidia/lib64/libpthread.so.0\r\n       443:      search cache=/etc/ld.so.cache\r\n       443:       trying file=/lib/x86_64-linux-gnu/libpthread.so.0\r\n       443:\r\n       443:     find library=libc.so.6 [0]; searching\r\n       443:      search path=           (LD_LIBRARY_PATH)\r\n       443:      search cache=/etc/ld.so.cache\r\n       443:       trying file=/lib/x86_64-linux-gnu/libc.so.6\r\n       443:\r\n       443:     find library=libdl.so.2 [0]; searching\r\n       443:      search path=           (LD_LIBRARY_PATH)\r\n       443:      search cache=/etc/ld.so.cache\r\n       443:       trying file=/lib/x86_64-linux-gnu/libdl.so.2\r\n       443:\r\n       443:     find library=libutil.so.1 [0]; searching\r\n       443:      search path=           (LD_LIBRARY_PATH)\r\n       443:      search cache=/etc/ld.so.cache\r\n       443:       trying file=/lib/x86_64-linux-gnu/libutil.so.1\r\n       443:\r\n       443:     find library=libexpat.so.1 [0]; searching\r\n       443:      search path=           (LD_LIBRARY_PATH)\r\n       443:      search cache=/etc/ld.so.cache\r\n       443:       trying file=/lib/x86_64-linux-gnu/libexpat.so.1\r\n       443:\r\n       443:     find library=libz.so.1 [0]; searching\r\n       443:      search path=           (LD_LIBRARY_PATH)\r\n       443:      search cache=/etc/ld.so.cache\r\n       443:       trying file=/lib/x86_64-linux-gnu/libz.so.1\r\n       443:\r\n       443:     find library=libm.so.6 [0]; searching\r\n       443:      search path=           (LD_LIBRARY_PATH)\r\n       443:      search cache=/etc/ld.so.cache\r\n       443:       trying file=/lib/x86_64-linux-gnu/libm.so.6\r\n       443:\r\n       443:\r\n       443:     calling init: /lib/x86_64-linux-gnu/libpthread.so.0\r\n       443:\r\n       443:\r\n       443:     calling init: /lib/x86_64-linux-gnu/libc.so.6\r\n       443:\r\n       443:\r\n       443:     calling init: /lib/x86_64-linux-gnu/libm.so.6\r\n       443:\r\n       443:\r\n       443:     calling init: /lib/x86_64-linux-gnu/libz.so.1\r\n       443:\r\n       443:\r\n       443:     calling init: /lib/x86_64-linux-gnu/libexpat.so.1\r\n       443:\r\n       443:\r\n       443:     calling init: /lib/x86_64-linux-gnu/libutil.so.1\r\n       443:\r\n       443:\r\n       443:     calling init: /lib/x86_64-linux-gnu/libdl.so.2\r\n       443:\r\n       443:\r\n       443:     initialize program: /usr/local/bin/python\r\n       443:\r\n       443:\r\n       443:     transferring control: /usr/local/bin/python\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/lib/python3.5/lib-dynload/_opcode.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/lib/python3.5/lib-dynload/_ctypes.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:     find library=libopenblasp-r0-34a18dc3.3.7.so [0]; searching\r\n       443:      search path=/usr/local/lib/python3.5/dist-packages/numpy/core/../.libs/tls/x86_64:/usr/local/lib/python3.5/dist-packages/numpy/core/../.libs/tls:/usr/local/lib/python3.5/dist-packages/numpy/core/../.libs/x86_64:/usr/local/lib/python3.5/dist-packages/numpy/core/../.libs            (RPATH from file /usr/local/lib/python3.5/dist-packages/numpy/core/_multiarray_umath.cpython-35m-x86_64-linux-gnu.so)\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/numpy/core/../.libs/tls/x86_64/libopenblasp-r0-34a18dc3.3.7.so\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/numpy/core/../.libs/tls/libopenblasp-r0-34a18dc3.3.7.so\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/numpy/core/../.libs/x86_64/libopenblasp-r0-34a18dc3.3.7.so\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/numpy/core/../.libs/libopenblasp-r0-34a18dc3.3.7.so\r\n       443:\r\n       443:     find library=libgfortran-ed201abd.so.3.0.0 [0]; searching\r\n       443:      search path=/usr/local/lib/python3.5/dist-packages/numpy/core/../.libs         (RPATH from file /usr/local/lib/python3.5/dist-packages/numpy/core/_multiarray_umath.cpython-35m-x86_64-linux-gnu.so)\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/numpy/core/../.libs/libgfortran-ed201abd.so.3.0.0\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/numpy/core/../.libs/libgfortran-ed201abd.so.3.0.0\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/numpy/core/../.libs/libopenblasp-r0-34a18dc3.3.7.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/numpy/core/_multiarray_umath.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/numpy/core/_multiarray_tests.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/numpy/linalg/lapack_lite.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/numpy/linalg/_umath_linalg.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:     find library=libbz2.so.1.0 [0]; searching\r\n       443:      search path=           (LD_LIBRARY_PATH)\r\n       443:      search cache=/etc/ld.so.cache\r\n       443:       trying file=/lib/x86_64-linux-gnu/libbz2.so.1.0\r\n       443:\r\n       443:\r\n       443:     calling init: /lib/x86_64-linux-gnu/libbz2.so.1.0\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/lib/python3.5/lib-dynload/_bz2.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:     find library=liblzma.so.5 [0]; searching\r\n       443:      search path=           (LD_LIBRARY_PATH)\r\n       443:      search cache=/etc/ld.so.cache\r\n       443:       trying file=/lib/x86_64-linux-gnu/liblzma.so.5\r\n       443:\r\n       443:\r\n       443:     calling init: /lib/x86_64-linux-gnu/liblzma.so.5\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/lib/python3.5/lib-dynload/_lzma.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:     find library=libmpdec.so.2 [0]; searching\r\n       443:      search path=           (LD_LIBRARY_PATH)\r\n       443:      search cache=/etc/ld.so.cache\r\n       443:       trying file=/usr/lib/x86_64-linux-gnu/libmpdec.so.2\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/lib/x86_64-linux-gnu/libmpdec.so.2\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/lib/python3.5/lib-dynload/_decimal.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/numpy/fft/_pocketfft_internal.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/numpy/random/mtrand.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/numpy/random/common.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/numpy/random/bounded_integers.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/numpy/random/mt19937.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/numpy/random/bit_generator.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:     find library=libcrypto.so.1.0.0 [0]; searching\r\n       443:      search path=           (LD_LIBRARY_PATH)\r\n       443:      search cache=/etc/ld.so.cache\r\n       443:       trying file=/lib/x86_64-linux-gnu/libcrypto.so.1.0.0\r\n       443:\r\n       443:\r\n       443:     calling init: /lib/x86_64-linux-gnu/libcrypto.so.1.0.0\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/lib/python3.5/lib-dynload/_hashlib.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/numpy/random/philox.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/numpy/random/pcg64.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/numpy/random/sfc64.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/numpy/random/generator.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:     find library=libtensorflow_framework.so.2 [0]; searching\r\n       443:      search path=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/tls/x86_64:/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/tls:/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/x86_64:/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow:/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/tls/x86_64:/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/tls:/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/x86_64:/usr/local/lib/python3.5/dist-packages/tensorflow_core/python:/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../tls/x86_64:/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../tls:/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../x86_64:/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/..            (RPATH from file /usr/local/lib/python3.5/dist-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so)\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/tls/x86_64/libtensorflow_framework.so.2\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/tls/libtensorflow_framework.so.2\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/x86_64/libtensorflow_framework.so.2\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/libtensorflow_framework.so.2\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/tls/x86_64/libtensorflow_framework.so.2\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/tls/libtensorflow_framework.so.2\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/x86_64/libtensorflow_framework.so.2\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/libtensorflow_framework.so.2\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../tls/x86_64/libtensorflow_framework.so.2\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../tls/libtensorflow_framework.so.2\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../x86_64/libtensorflow_framework.so.2\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../libtensorflow_framework.so.2\r\n       443:\r\n       443:     find library=librt.so.1 [0]; searching\r\n       443:      search path=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python:/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/..             (RPATH from file /usr/local/lib/python3.5/dist-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so)\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/librt.so.1\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../librt.so.1\r\n       443:      search path=           (LD_LIBRARY_PATH)\r\n       443:      search cache=/etc/ld.so.cache\r\n       443:       trying file=/lib/x86_64-linux-gnu/librt.so.1\r\n       443:\r\n       443:     find library=libstdc++.so.6 [0]; searching\r\n       443:      search path=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python:/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/..             (RPATH from file /usr/local/lib/python3.5/dist-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so)\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/libstdc++.so.6\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../libstdc++.so.6\r\n       443:      search path=           (LD_LIBRARY_PATH)\r\n       443:      search cache=/etc/ld.so.cache\r\n       443:       trying file=/usr/lib/x86_64-linux-gnu/libstdc++.so.6\r\n       443:\r\n       443:     find library=libgcc_s.so.1 [0]; searching\r\n       443:      search path=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python:/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/..             (RPATH from file /usr/local/lib/python3.5/dist-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so)\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/libgcc_s.so.1\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../libgcc_s.so.1\r\n       443:      search path=           (LD_LIBRARY_PATH)\r\n       443:      search cache=/etc/ld.so.cache\r\n       443:       trying file=/lib/x86_64-linux-gnu/libgcc_s.so.1\r\n       443:\r\n       443:\r\n       443:     calling init: /lib/x86_64-linux-gnu/libgcc_s.so.1\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/lib/x86_64-linux-gnu/libstdc++.so.6\r\n       443:\r\n       443:\r\n       443:     calling init: /lib/x86_64-linux-gnu/librt.so.1\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../libtensorflow_framework.so.2\r\n       443:\r\n       443:     find library=libhdfs.so [0]; searching\r\n       443:      search path=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/..           (RPATH from file /usr/local/lib/python3.5/dist-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so)\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../libhdfs.so\r\n       443:      search path=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python:/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/..             (RPATH from file /usr/local/lib/python3.5/dist-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so)\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/libhdfs.so\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../libhdfs.so\r\n       443:      search path=           (LD_LIBRARY_PATH)\r\n       443:      search cache=/etc/ld.so.cache\r\n       443:      search path=/lib/x86_64-linux-gnu/tls/x86_64:/lib/x86_64-linux-gnu/tls:/lib/x86_64-linux-gnu/x86_64:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu/tls/x86_64:/usr/lib/x86_64-linux-gnu/tls:/usr/lib/x86_64-linux-gnu/x86_64:/usr/lib/x86_64-linux-gnu:/lib/tls/x86_64:/lib/tls:/lib/x86_64:/lib:/usr/lib/tls/x86_64:/usr/lib/tls:/usr/lib/x86_64:/usr/lib              (system search path)\r\n       443:       trying file=/lib/x86_64-linux-gnu/tls/x86_64/libhdfs.so\r\n       443:       trying file=/lib/x86_64-linux-gnu/tls/libhdfs.so\r\n       443:       trying file=/lib/x86_64-linux-gnu/x86_64/libhdfs.so\r\n       443:       trying file=/lib/x86_64-linux-gnu/libhdfs.so\r\n       443:       trying file=/usr/lib/x86_64-linux-gnu/tls/x86_64/libhdfs.so\r\n       443:       trying file=/usr/lib/x86_64-linux-gnu/tls/libhdfs.so\r\n       443:       trying file=/usr/lib/x86_64-linux-gnu/x86_64/libhdfs.so\r\n       443:       trying file=/usr/lib/x86_64-linux-gnu/libhdfs.so\r\n       443:       trying file=/lib/tls/x86_64/libhdfs.so\r\n       443:       trying file=/lib/tls/libhdfs.so\r\n       443:       trying file=/lib/x86_64/libhdfs.so\r\n       443:       trying file=/lib/libhdfs.so\r\n       443:       trying file=/usr/lib/tls/x86_64/libhdfs.so\r\n       443:       trying file=/usr/lib/tls/libhdfs.so\r\n       443:       trying file=/usr/lib/x86_64/libhdfs.so\r\n       443:       trying file=/usr/lib/libhdfs.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/google/protobuf/internal/_api_implementation.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/google/protobuf/pyext/_message.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/lib/python3.5/lib-dynload/_csv.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/lib/python3.5/lib-dynload/termios.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/tensorflow_core/python/framework/fast_tensor_util.so\r\n       443:\r\n       443:     find library=libuuid.so.1 [0]; searching\r\n       443:      search path=           (LD_LIBRARY_PATH)\r\n       443:      search cache=/etc/ld.so.cache\r\n       443:       trying file=/lib/x86_64-linux-gnu/libuuid.so.1\r\n       443:\r\n       443:\r\n       443:     calling init: /lib/x86_64-linux-gnu/libuuid.so.1\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/wrapt/_wrappers.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/lib/python3.5/lib-dynload/_json.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:     find library=libssl.so.1.0.0 [0]; searching\r\n       443:      search path=           (LD_LIBRARY_PATH)\r\n       443:      search cache=/etc/ld.so.cache\r\n       443:       trying file=/lib/x86_64-linux-gnu/libssl.so.1.0.0\r\n       443:\r\n       443:\r\n       443:     calling init: /lib/x86_64-linux-gnu/libssl.so.1.0.0\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/lib/python3.5/lib-dynload/_ssl.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:     find library=libhdf5-49599f4e.so.103.0.0 [0]; searching\r\n       443:      search path=/usr/local/lib/python3.5/dist-packages/h5py/.libs/tls/x86_64:/usr/local/lib/python3.5/dist-packages/h5py/.libs/tls:/usr/local/lib/python3.5/dist-packages/h5py/.libs/x86_64:/usr/local/lib/python3.5/dist-packages/h5py/.libs                (RPATH from file /usr/local/lib/python3.5/dist-packages/h5py/_errors.cpython-35m-x86_64-linux-gnu.so)\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/h5py/.libs/tls/x86_64/libhdf5-49599f4e.so.103.0.0\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/h5py/.libs/tls/libhdf5-49599f4e.so.103.0.0\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/h5py/.libs/x86_64/libhdf5-49599f4e.so.103.0.0\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/h5py/.libs/libhdf5-49599f4e.so.103.0.0\r\n       443:\r\n       443:     find library=libhdf5_hl-db841637.so.100.1.1 [0]; searching\r\n       443:      search path=/usr/local/lib/python3.5/dist-packages/h5py/.libs          (RPATH from file /usr/local/lib/python3.5/dist-packages/h5py/_errors.cpython-35m-x86_64-linux-gnu.so)\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/h5py/.libs/libhdf5_hl-db841637.so.100.1.1\r\n       443:\r\n       443:     find library=libsz-1c7dd0cf.so.2.0.1 [0]; searching\r\n       443:      search path=/usr/local/lib/python3.5/dist-packages/h5py/.libs/./tls/x86_64:/usr/local/lib/python3.5/dist-packages/h5py/.libs/./tls:/usr/local/lib/python3.5/dist-packages/h5py/.libs/./x86_64:/usr/local/lib/python3.5/dist-packages/h5py/.libs/.                (RPATH from file /usr/local/lib/python3.5/dist-packages/h5py/.libs/libhdf5-49599f4e.so.103.0.0)\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/h5py/.libs/./tls/x86_64/libsz-1c7dd0cf.so.2.0.1\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/h5py/.libs/./tls/libsz-1c7dd0cf.so.2.0.1\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/h5py/.libs/./x86_64/libsz-1c7dd0cf.so.2.0.1\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/h5py/.libs/./libsz-1c7dd0cf.so.2.0.1\r\n       443:\r\n       443:     find library=libaec-2147abcd.so.0.0.4 [0]; searching\r\n       443:      search path=/usr/local/lib/python3.5/dist-packages/h5py/.libs/.                (RPATH from file /usr/local/lib/python3.5/dist-packages/h5py/.libs/libhdf5-49599f4e.so.103.0.0)\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/h5py/.libs/./libaec-2147abcd.so.0.0.4\r\n       443:\r\n       443:     find library=libz-a147dcb0.so.1.2.3 [0]; searching\r\n       443:      search path=/usr/local/lib/python3.5/dist-packages/h5py/.libs/.                (RPATH from file /usr/local/lib/python3.5/dist-packages/h5py/.libs/libhdf5-49599f4e.so.103.0.0)\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/h5py/.libs/./libz-a147dcb0.so.1.2.3\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/.libs/./libz-a147dcb0.so.1.2.3\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/.libs/./libaec-2147abcd.so.0.0.4\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/.libs/./libsz-1c7dd0cf.so.2.0.1\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/.libs/libhdf5-49599f4e.so.103.0.0\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/.libs/libhdf5_hl-db841637.so.100.1.1\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/_errors.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/h5.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/defs.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/_objects.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/_conv.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/h5r.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/h5t.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/utils.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       452:     find library=libc.so.6 [0]; searching\r\n       452:      search path=/usr/local/nvidia/lib/tls/x86_64:/usr/local/nvidia/lib/tls:/usr/local/nvidia/lib/x86_64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64/tls/x86_64:/usr/local/nvidia/lib64/tls:/usr/local/nvidia/lib64/x86_64:/usr/local/nvidia/lib64          (LD_LIBRARY_PATH)\r\n       452:       trying file=/usr/local/nvidia/lib/tls/x86_64/libc.so.6\r\n       452:       trying file=/usr/local/nvidia/lib/tls/libc.so.6\r\n       452:       trying file=/usr/local/nvidia/lib/x86_64/libc.so.6\r\n       452:       trying file=/usr/local/nvidia/lib/libc.so.6\r\n       452:       trying file=/usr/local/nvidia/lib64/tls/x86_64/libc.so.6\r\n       452:       trying file=/usr/local/nvidia/lib64/tls/libc.so.6\r\n       452:       trying file=/usr/local/nvidia/lib64/x86_64/libc.so.6\r\n       452:       trying file=/usr/local/nvidia/lib64/libc.so.6\r\n       452:      search cache=/etc/ld.so.cache\r\n       452:       trying file=/lib/x86_64-linux-gnu/libc.so.6\r\n       452:\r\n       452:\r\n       452:     calling init: /lib/x86_64-linux-gnu/libc.so.6\r\n       452:\r\n       452:\r\n       452:     initialize program: /bin/sh\r\n       452:\r\n       452:\r\n       452:     transferring control: /bin/sh\r\n       452:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/h5z.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/h5a.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/h5s.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/h5p.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/h5ac.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/_proxy.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/h5d.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/h5ds.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/h5f.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/h5g.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/h5i.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/h5fd.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/h5pl.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/h5o.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/h5py/h5l.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/scipy/_lib/_ccallback_c.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/scipy/sparse/_sparsetools.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/scipy/sparse/_csparsetools.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/scipy/sparse/csgraph/_shortest_path.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/scipy/sparse/csgraph/_tools.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/scipy/sparse/csgraph/_traversal.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/scipy/sparse/csgraph/_min_spanning_tree.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/scipy/sparse/csgraph/_reordering.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:     find library=libjpeg-3b10b538.so.9.3.0 [0]; searching\r\n       443:      search path=/usr/local/lib/python3.5/dist-packages/PIL/.libs/tls/x86_64:/usr/local/lib/python3.5/dist-packages/PIL/.libs/tls:/usr/local/lib/python3.5/dist-packages/PIL/.libs/x86_64:/usr/local/lib/python3.5/dist-packages/PIL/.libs            (RPATH from file /usr/local/lib/python3.5/dist-packages/PIL/_imaging.cpython-35m-x86_64-linux-gnu.so)\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/PIL/.libs/tls/x86_64/libjpeg-3b10b538.so.9.3.0\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/PIL/.libs/tls/libjpeg-3b10b538.so.9.3.0\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/PIL/.libs/x86_64/libjpeg-3b10b538.so.9.3.0\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/PIL/.libs/libjpeg-3b10b538.so.9.3.0\r\n       443:\r\n       443:     find library=libopenjp2-b3d7668a.so.2.3.1 [0]; searching\r\n       443:      search path=/usr/local/lib/python3.5/dist-packages/PIL/.libs           (RPATH from file /usr/local/lib/python3.5/dist-packages/PIL/_imaging.cpython-35m-x86_64-linux-gnu.so)\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/PIL/.libs/libopenjp2-b3d7668a.so.2.3.1\r\n       443:\r\n       443:     find library=libtiff-8267adfe.so.5.4.0 [0]; searching\r\n       443:      search path=/usr/local/lib/python3.5/dist-packages/PIL/.libs           (RPATH from file /usr/local/lib/python3.5/dist-packages/PIL/_imaging.cpython-35m-x86_64-linux-gnu.so)\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/PIL/.libs/libtiff-8267adfe.so.5.4.0\r\n       443:\r\n       443:     find library=liblzma-6cd627ed.so.5.2.4 [0]; searching\r\n       443:      search path=/usr/local/lib/python3.5/dist-packages/PIL/.libs/./tls/x86_64:/usr/local/lib/python3.5/dist-packages/PIL/.libs/./tls:/usr/local/lib/python3.5/dist-packages/PIL/.libs/./x86_64:/usr/local/lib/python3.5/dist-packages/PIL/.libs/.            (RPATH from file /usr/local/lib/python3.5/dist-packages/PIL/.libs/libtiff-8267adfe.so.5.4.0)\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/PIL/.libs/./tls/x86_64/liblzma-6cd627ed.so.5.2.4\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/PIL/.libs/./tls/liblzma-6cd627ed.so.5.2.4\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/PIL/.libs/./x86_64/liblzma-6cd627ed.so.5.2.4\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/PIL/.libs/./liblzma-6cd627ed.so.5.2.4\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/PIL/.libs/./liblzma-6cd627ed.so.5.2.4\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/PIL/.libs/libjpeg-3b10b538.so.9.3.0\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/PIL/.libs/libtiff-8267adfe.so.5.4.0\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/PIL/.libs/libopenjp2-b3d7668a.so.2.3.1\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/PIL/_imaging.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/scipy/ndimage/_nd_image.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/scipy/ndimage/_ni_label.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:     find library=libopenblasp-r0-2ecf47d5.3.7.dev.so [0]; searching\r\n       443:      search path=/usr/local/lib/python3.5/dist-packages/scipy/linalg/../.libs/tls/x86_64:/usr/local/lib/python3.5/dist-packages/scipy/linalg/../.libs/tls:/usr/local/lib/python3.5/dist-packages/scipy/linalg/../.libs/x86_64:/usr/local/lib/python3.5/dist-packages/scipy/linalg/../.libs            (RPATH from file /usr/local/lib/python3.5/dist-packages/scipy/linalg/_fblas.cpython-35m-x86_64-linux-gnu.so)\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/scipy/linalg/../.libs/tls/x86_64/libopenblasp-r0-2ecf47d5.3.7.dev.so\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/scipy/linalg/../.libs/tls/libopenblasp-r0-2ecf47d5.3.7.dev.so\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/scipy/linalg/../.libs/x86_64/libopenblasp-r0-2ecf47d5.3.7.dev.so\r\n       443:       trying file=/usr/local/lib/python3.5/dist-packages/scipy/linalg/../.libs/libopenblasp-r0-2ecf47d5.3.7.dev.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/scipy/linalg/../.libs/libopenblasp-r0-2ecf47d5.3.7.dev.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/scipy/linalg/_fblas.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/scipy/linalg/_flapack.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/scipy/linalg/_flinalg.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/scipy/linalg/_solve_toeplitz.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/scipy/linalg/_decomp_update.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/scipy/linalg/cython_blas.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/scipy/linalg/cython_lapack.cpython-35m-x86_64-linux-gnu.so\r\n       443:\r\n       443:\r\n       443:     calling init: /usr/local/lib/python3.5/dist-packages/tensorflow_core/lite/experimental/microfrontend/python/ops/_audio_microfrontend_op.so\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/bin/python [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /lib/x86_64-linux-gnu/libutil.so.1 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /lib/x86_64-linux-gnu/libexpat.so.1 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /lib/x86_64-linux-gnu/libz.so.1 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/lib/python3.5/lib-dynload/_opcode.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/lib/python3.5/lib-dynload/_ctypes.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/numpy/core/_multiarray_umath.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/numpy/core/_multiarray_tests.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/numpy/linalg/lapack_lite.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/numpy/linalg/_umath_linalg.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/numpy/core/../.libs/libopenblasp-r0-34a18dc3.3.7.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/lib/python3.5/lib-dynload/_bz2.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /lib/x86_64-linux-gnu/libbz2.so.1.0 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/lib/python3.5/lib-dynload/_lzma.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /lib/x86_64-linux-gnu/liblzma.so.5 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/lib/python3.5/lib-dynload/_decimal.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/lib/x86_64-linux-gnu/libmpdec.so.2 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/numpy/fft/_pocketfft_internal.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/numpy/random/mtrand.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/numpy/random/common.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/numpy/random/bounded_integers.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/numpy/random/mt19937.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/numpy/random/bit_generator.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/lib/python3.5/lib-dynload/_hashlib.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/numpy/random/philox.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/numpy/random/pcg64.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/numpy/random/sfc64.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/numpy/random/generator.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/google/protobuf/internal/_api_implementation.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/google/protobuf/pyext/_message.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/lib/python3.5/lib-dynload/_csv.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/lib/python3.5/lib-dynload/termios.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/tensorflow_core/python/framework/fast_tensor_util.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /lib/x86_64-linux-gnu/libuuid.so.1 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/wrapt/_wrappers.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/lib/python3.5/lib-dynload/_json.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/lib/python3.5/lib-dynload/_ssl.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /lib/x86_64-linux-gnu/libssl.so.1.0.0 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /lib/x86_64-linux-gnu/libcrypto.so.1.0.0 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/_errors.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/h5.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/defs.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/_objects.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/_conv.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/h5r.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/h5t.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/utils.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/h5z.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/h5a.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/h5s.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/h5p.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/h5ac.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/_proxy.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/h5d.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/h5ds.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/h5f.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/h5g.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/h5i.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/h5fd.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/h5pl.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/h5o.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/h5l.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/.libs/libhdf5_hl-db841637.so.100.1.1 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/.libs/libhdf5-49599f4e.so.103.0.0 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/.libs/./libsz-1c7dd0cf.so.2.0.1 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/.libs/./libaec-2147abcd.so.0.0.4 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/scipy/_lib/_ccallback_c.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/scipy/sparse/_sparsetools.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/scipy/sparse/_csparsetools.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/scipy/sparse/csgraph/_shortest_path.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/scipy/sparse/csgraph/_tools.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/scipy/sparse/csgraph/_traversal.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/scipy/sparse/csgraph/_min_spanning_tree.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/scipy/sparse/csgraph/_reordering.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/PIL/_imaging.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/PIL/.libs/libopenjp2-b3d7668a.so.2.3.1 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/PIL/.libs/libtiff-8267adfe.so.5.4.0 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/PIL/.libs/libjpeg-3b10b538.so.9.3.0 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/h5py/.libs/./libz-a147dcb0.so.1.2.3 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/PIL/.libs/./liblzma-6cd627ed.so.5.2.4 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/scipy/ndimage/_nd_image.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/scipy/ndimage/_ni_label.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/scipy/linalg/_fblas.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/scipy/linalg/_flapack.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/scipy/linalg/_flinalg.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/scipy/linalg/_solve_toeplitz.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/scipy/linalg/_decomp_update.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/scipy/linalg/cython_blas.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/scipy/linalg/cython_lapack.cpython-35m-x86_64-linux-gnu.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/scipy/linalg/../.libs/libopenblasp-r0-2ecf47d5.3.7.dev.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/numpy/core/../.libs/libgfortran-ed201abd.so.3.0.0 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/tensorflow_core/lite/experimental/microfrontend/python/ops/_audio_microfrontend_op.so [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/local/lib/python3.5/dist-packages/tensorflow_core/python/../libtensorflow_framework.so.2 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /usr/lib/x86_64-linux-gnu/libstdc++.so.6 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /lib/x86_64-linux-gnu/libgcc_s.so.1 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /lib/x86_64-linux-gnu/librt.so.1 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /lib/x86_64-linux-gnu/libm.so.6 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /lib/x86_64-linux-gnu/libdl.so.2 [0]\r\n       443:\r\n       443:\r\n       443:     calling fini: /lib/x86_64-linux-gnu/libpthread.so.0 [0]\r\n       443:\r\n\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35084", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35084/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35084/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35084/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35084", "id": 537460324, "node_id": "MDU6SXNzdWU1Mzc0NjAzMjQ=", "number": 35084, "title": "Memory leak when using py_function inside tf.data.Dataset", "user": {"login": "QiJune", "id": 22017000, "node_id": "MDQ6VXNlcjIyMDE3MDAw", "avatar_url": "https://avatars0.githubusercontent.com/u/22017000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/QiJune", "html_url": "https://github.com/QiJune", "followers_url": "https://api.github.com/users/QiJune/followers", "following_url": "https://api.github.com/users/QiJune/following{/other_user}", "gists_url": "https://api.github.com/users/QiJune/gists{/gist_id}", "starred_url": "https://api.github.com/users/QiJune/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/QiJune/subscriptions", "organizations_url": "https://api.github.com/users/QiJune/orgs", "repos_url": "https://api.github.com/users/QiJune/repos", "events_url": "https://api.github.com/users/QiJune/events{/privacy}", "received_events_url": "https://api.github.com/users/QiJune/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 736653459, "node_id": "MDU6TGFiZWw3MzY2NTM0NTk=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:eager", "name": "comp:eager", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "kkimdev", "id": 503414, "node_id": "MDQ6VXNlcjUwMzQxNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/503414?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kkimdev", "html_url": "https://github.com/kkimdev", "followers_url": "https://api.github.com/users/kkimdev/followers", "following_url": "https://api.github.com/users/kkimdev/following{/other_user}", "gists_url": "https://api.github.com/users/kkimdev/gists{/gist_id}", "starred_url": "https://api.github.com/users/kkimdev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kkimdev/subscriptions", "organizations_url": "https://api.github.com/users/kkimdev/orgs", "repos_url": "https://api.github.com/users/kkimdev/repos", "events_url": "https://api.github.com/users/kkimdev/events{/privacy}", "received_events_url": "https://api.github.com/users/kkimdev/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "kkimdev", "id": 503414, "node_id": "MDQ6VXNlcjUwMzQxNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/503414?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kkimdev", "html_url": "https://github.com/kkimdev", "followers_url": "https://api.github.com/users/kkimdev/followers", "following_url": "https://api.github.com/users/kkimdev/following{/other_user}", "gists_url": "https://api.github.com/users/kkimdev/gists{/gist_id}", "starred_url": "https://api.github.com/users/kkimdev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kkimdev/subscriptions", "organizations_url": "https://api.github.com/users/kkimdev/orgs", "repos_url": "https://api.github.com/users/kkimdev/repos", "events_url": "https://api.github.com/users/kkimdev/events{/privacy}", "received_events_url": "https://api.github.com/users/kkimdev/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-12-13T10:10:20Z", "updated_at": "2020-01-14T04:11:18Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution: Linux Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary):\r\n- TensorFlow version (use command below): 2.0\r\n- Python version: 3.6.8\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\n\r\n**Describe the current behavior**\r\n\r\n<img width=\"368\" alt=\"\u5c4f\u5e55\u5feb\u7167 2019-12-13 \u4e0b\u53486 06 20\" src=\"https://user-images.githubusercontent.com/22017000/70792077-6c453000-1dd3-11ea-8489-5b6131950515.png\">\r\n\r\n\r\n**Describe the expected behavior**\r\n\r\nThe tf.data.Dataset instance should be freed in every step.\r\n\r\n**Code to reproduce the issue**\r\n\r\n```python\r\nimport tensorflow as tf\r\nimport os\r\nimport numpy as np\r\nimport psutil\r\n\r\ndef _generator():\r\n    for i in range(100):\r\n        yield \"1,2,3,4,5,6,7,8\"\r\n\r\ndef _py_parse_data(record):\r\n    record = record.numpy()\r\n    record = bytes.decode(record)\r\n    rl = record.split(\",\")\r\n    rl = [str(int(r) + 1) for r in rl]\r\n    return [\",\".join(rl)]\r\n\r\ndef parse_data(record, shape=10):\r\n    sparse_data = tf.strings.split([record], sep=\",\")\r\n    sparse_data = tf.strings.to_number(sparse_data[0], tf.int64)\r\n    ids_num = tf.cast(tf.size(sparse_data), tf.int64)\r\n    indices = tf.range(0, ids_num, dtype=tf.int64)\r\n    indices = tf.reshape(indices, shape=(-1, 1))\r\n    sparse_data = tf.sparse.SparseTensor(\r\n                indices, sparse_data, dense_shape=(shape,)\r\n    )\r\n    return sparse_data\r\n\r\nprocess = psutil.Process(os.getpid())\r\n\r\nstep = 0\r\nwhile (step < 10000):\r\n    t = tf.data.Dataset.from_generator(_generator, output_types=tf.string)\r\n    t = t.map(lambda record: tf.py_function(_py_parse_data, [record], [tf.string]))\r\n    t = t.map(parse_data)\r\n    for d in t:\r\n        a = 1\r\n    if step % 10 == 0:\r\n        print(\"Memory : \", process.memory_info().rss)\r\n    step += 1\r\n```\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35080", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35080/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35080/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35080/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35080", "id": 537376572, "node_id": "MDU6SXNzdWU1MzczNzY1NzI=", "number": 35080, "title": "Start background prefetching without calling next on dataset iterator", "user": {"login": "Tilps", "id": 12046033, "node_id": "MDQ6VXNlcjEyMDQ2MDMz", "avatar_url": "https://avatars3.githubusercontent.com/u/12046033?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Tilps", "html_url": "https://github.com/Tilps", "followers_url": "https://api.github.com/users/Tilps/followers", "following_url": "https://api.github.com/users/Tilps/following{/other_user}", "gists_url": "https://api.github.com/users/Tilps/gists{/gist_id}", "starred_url": "https://api.github.com/users/Tilps/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Tilps/subscriptions", "organizations_url": "https://api.github.com/users/Tilps/orgs", "repos_url": "https://api.github.com/users/Tilps/repos", "events_url": "https://api.github.com/users/Tilps/events{/privacy}", "received_events_url": "https://api.github.com/users/Tilps/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-12-13T06:41:37Z", "updated_at": "2019-12-18T00:26:51Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): 2.0\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nCurrently if you have a dataset with a large shuffle buffer, it doesn't start trying to populate that buffer until the first request to retrieve data from the data set. This is a lost opportunity for parallelism during training script startup - the shuffle buffer could be filling in the background while the model is compiling.  \r\nSince calling next is blocking, its not possible to trigger this overlap to happen. \r\n\r\n**Will this change the current api? How?** Maybe - could add a start_prefetching() method.  The other idea I had was to make it implicit in calling __iter__ - but that is possibly more useful for my specific use case than more generally.\r\n\r\n**Who will benefit with this feature?**\r\nAnyone who cares about the startup time of their training script and uses a large shuffle buffer.\r\n\r\n**Any Other info.**\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35079", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35079/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35079/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35079/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35079", "id": 537372026, "node_id": "MDU6SXNzdWU1MzczNzIwMjY=", "number": 35079, "title": "Add usage examples for tf.audio APIs", "user": {"login": "boronhub", "id": 31139873, "node_id": "MDQ6VXNlcjMxMTM5ODcz", "avatar_url": "https://avatars3.githubusercontent.com/u/31139873?v=4", "gravatar_id": "", "url": "https://api.github.com/users/boronhub", "html_url": "https://github.com/boronhub", "followers_url": "https://api.github.com/users/boronhub/followers", "following_url": "https://api.github.com/users/boronhub/following{/other_user}", "gists_url": "https://api.github.com/users/boronhub/gists{/gist_id}", "starred_url": "https://api.github.com/users/boronhub/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/boronhub/subscriptions", "organizations_url": "https://api.github.com/users/boronhub/orgs", "repos_url": "https://api.github.com/users/boronhub/repos", "events_url": "https://api.github.com/users/boronhub/events{/privacy}", "received_events_url": "https://api.github.com/users/boronhub/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-12-13T06:26:16Z", "updated_at": "2020-01-11T16:22:09Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "Thank you for submitting a TensorFlow documentation issue. Per our GitHub\r\npolicy, we only address code/doc bugs, performance issues, feature requests, and\r\nbuild/installation issues on GitHub.\r\n\r\nThe TensorFlow docs are open source! To get involved, read the documentation\r\ncontributor guide: https://www.tensorflow.org/community/contribute/docs\r\n\r\n## URL(s) with the issue:\r\n\r\nPlease provide a link to the documentation entry, for example:\r\nhttps://www.tensorflow.org/api_docs/python/tf/audio\r\n\r\n## Description of issue (what needs changing):\r\nCurrently, there are no usage examples for tf.audio APIs , which makes it difficult for new users to implement the same.\r\n\r\n### Clear description\r\n\r\nFor example, why should someone use this method? How is it useful?\r\n**Audio is an area not really explored in machine learning to extent image and text has. While TensorFlow does provide a good amount of documentation for the general Args and Returns of the various functions under tf.audio, since most new users will have very little experience with audio as compared to tf.image**\n\r\n### Correct links\r\n\r\nIs the link to the source code correct?\r\n**Yes**\r\n\r\n### Parameters defined\r\n\r\nAre all parameters defined and formatted correctly?\r\n**Yes**\r\n\r\n### Returns defined\r\n\r\nAre return values defined?\r\n**Yes**\r\n\r\n### Raises listed and defined\r\n\r\nAre the errors defined? For example,\r\nhttps://www.tensorflow.org/versions/r2.0/api_docs/python/tf/feature_column/categorical_column_with_vocabulary_file#raises\r\n**No**\r\n\r\n### Usage example\r\n\r\nIs there a usage example?\r\n**No**\r\n\r\nSee the API guide: https://www.tensorflow.org/community/contribute/docs_ref\r\non how to write testable usage examples.\r\n\r\n### Request visuals, if applicable\r\n\r\nAre there currently visuals? If not, will it clarify the content?\r\n**Formatted code blocks are present, which are satisfactory.**\r\n\r\n### Submit a pull request?\r\n\r\nAre you planning to also submit a pull request to fix the issue? See the docs\r\ncontributor guide: https://www.tensorflow.org/community/contribute/docs,\r\ndocs API guide: https://www.tensorflow.org/community/contribute/docs_ref and the\r\ndocs style guide: https://www.tensorflow.org/community/contribute/docs_style\r\n**Yes, I think I can provide a detailed usage example.**\r\n  "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35072", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35072/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35072/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35072/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35072", "id": 537282379, "node_id": "MDU6SXNzdWU1MzcyODIzNzk=", "number": 35072, "title": "Explain how int8 input and output quantization conversion works in TensorFlow Lite", "user": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-12-13T00:18:11Z", "updated_at": "2020-01-28T04:52:44Z", "closed_at": null, "author_association": "MEMBER", "body": "We've had feedback from multiple developers that it's hard to figure out how to calculate the right  int8 values for quantized inputs, and understand what int8 values mean as outputs.\r\n\r\nFor example, when feeding an image to uint8 quantized inputs, the values can be left as in their source 0 to 255 range. For int8 inputs, the developer will typically need to subtract 128 from each value, but this knowledge (and how the offset value is calculated) is not documented. In the same way, users will need to map the -128 to 127 output values to the actual real number range of their outputs, but this process is unclear.\r\n\r\nTagging the @tensorflow/micro team."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35071", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35071/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35071/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35071/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35071", "id": 537279307, "node_id": "MDU6SXNzdWU1MzcyNzkzMDc=", "number": 35071, "title": "TensorFlow Lite Micro MaxPool kernel needs int8 support", "user": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-12-13T00:07:30Z", "updated_at": "2020-02-07T14:10:10Z", "closed_at": null, "author_association": "MEMBER", "body": "TensorFlow Lite for Microcontrollers has a MAXPOOL operation, but it only supports float and uint8 execution, not int8."}]