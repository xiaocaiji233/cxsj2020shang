[{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22464", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22464/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22464/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22464/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22464", "id": 362857966, "node_id": "MDU6SXNzdWUzNjI4NTc5NjY=", "number": 22464, "title": "memory leak cased by function tf.dynamic_partition", "user": {"login": "mzhaoshuai", "id": 22476764, "node_id": "MDQ6VXNlcjIyNDc2NzY0", "avatar_url": "https://avatars1.githubusercontent.com/u/22476764?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mzhaoshuai", "html_url": "https://github.com/mzhaoshuai", "followers_url": "https://api.github.com/users/mzhaoshuai/followers", "following_url": "https://api.github.com/users/mzhaoshuai/following{/other_user}", "gists_url": "https://api.github.com/users/mzhaoshuai/gists{/gist_id}", "starred_url": "https://api.github.com/users/mzhaoshuai/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mzhaoshuai/subscriptions", "organizations_url": "https://api.github.com/users/mzhaoshuai/orgs", "repos_url": "https://api.github.com/users/mzhaoshuai/repos", "events_url": "https://api.github.com/users/mzhaoshuai/events{/privacy}", "received_events_url": "https://api.github.com/users/mzhaoshuai/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-09-22T13:39:33Z", "updated_at": "2018-12-07T18:52:59Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:_no_\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:  _Linux Ubuntu 16.04.4 LTS_\u3002\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:_no_\r\n- **TensorFlow installed from (source or binary)**:_binary_\r\n- **TensorFlow version (use command below)**:_1.8.0_\r\n- **Python version**:_Python 3.5.2_\r\n- **Bazel version (if compiling from source)**:_None_\r\n- **GCC/Compiler version (if compiling from source)**:_None_\r\n- **CUDA/cuDNN version**:_CUDA-9.0/cuDNN-7.0.5_\r\n- **GPU model and memory**: _GTX 1080Ti 11GB, 2 same cards_\r\n- **Exact command to reproduce**:_below_\r\n\r\n### Supplementary material\r\nI just pulled the tensorflow's offical docker image and RUN some `pip install ...` instructions.\r\nThe tag of the iamge is `1.8.0-devel-gpu-py3`.\r\n\r\n### Describe the problem\r\nI want to calculate a focal loss. \r\n![image](https://user-images.githubusercontent.com/22476764/45917573-bb403600-beac-11e8-8262-56be63acd1c3.png)\r\n\r\nIt just added weight factor to the original cross entropy loss.\r\n\r\n#### `tf_leak` code (shown in Source code / logs) \r\n\r\nWhen I used the `tf_leak` code as shown below, there will be memory leak.\r\nI used `top` command to see the process's memory usage.\r\n\r\n- **pic01 occupy about 3G memory after about 1min**\r\n![image](https://user-images.githubusercontent.com/22476764/45917603-212cbd80-bead-11e8-8b2b-e784196405b2.png)\r\n\r\n- **pic02 occupy about 11G memory after about 33min**\r\n![image](https://user-images.githubusercontent.com/22476764/45917609-3ace0500-bead-11e8-9d6e-b58d748f6fbc.png)\r\n\r\n- **pic03 occupy about 14G memory after about 191min**\r\n![image](https://user-images.githubusercontent.com/22476764/45917619-45889a00-bead-11e8-8370-082b341c4907.png)\r\n\r\n**I use the `tf.estimator` and the graph is finazied. So I do not add ops to the graph when the seesion is running.**\r\n\r\n- **pic04 graph is finazied**\r\n![image](https://user-images.githubusercontent.com/22476764/45917706-16bef380-beae-11e8-8af9-a0a8fd46c52a.png)\r\n\r\n\r\n#### `tf_no_leak` code (shown in Source code / logs) \r\n \r\nI replace the ` tf.dynamic_partition` function with `tf.boolean_mask` and the memory leak disappered.\r\n\r\n- **pic05 occupy about 3G memory after about 9min**\r\n![image](https://user-images.githubusercontent.com/22476764/45917758-ec216a80-beae-11e8-9d49-115f2598fa50.png)\r\n\r\n- **pic06 occupy about 3G memory after about 133min**\r\n![image](https://user-images.githubusercontent.com/22476764/45917782-2be85200-beaf-11e8-9427-021f2f5fcd51.png)\r\n\r\n#### more information\r\n\r\nI tested the `tf_leak` and `tf_no_leak` code with a small dataset, when I use a bigger dataset, the process will occupy a large memory and the system will kill the process. This is why I found the problem.\r\n\r\n\r\n### Source code / logs\r\n```\r\nparams:\r\n\t\tvalid_labels\t:\tthe labels, a Tensor with shape [N * w * h, ]\r\n\t\tvalid_logits\t:\tthe logits, a Tensor with shape [N * w * h, num_classes]\r\n\t\tnum_classes \t: \tthe number of classes, a scalar\r\n                ohem_prob_g  :       a hyperparameter, a scalar, default=1.5\r\n```\r\n\r\n1. `tf_leak` code\r\n\r\n```\t\r\nvalid_probs = tf.clip_by_value(tf.nn.softmax(valid_logits, axis=-1), \\\r\n\t\t\t\t\tclip_value_min=1e-6, clip_value_max=1.0\r\nvalid_one_hot = tf.one_hot(valid_labels, depth=num_classes, dtype=tf.int32)\r\nweight_matrix = ohem_prob_g - tf.dynamic_partition(valid_probs, valid_one_hot, num_partitions=2)[1]\r\n## calculate the final cross-entropy\r\ncross_entropy = tf.losses.sparse_softmax_cross_entropy(labels=valid_labels, \r\n\t\t\t\t\t\tlogits=valid_logits, weights=weight_matrix)\r\nreturn cross_entropy\r\n```\r\n\r\n2. `tf_no_leak` code\r\n\r\nsame as the `tf_leak` code except I replace the `tf.dynamic_partition` with `tf.boolean_mask`.\r\n\r\n```\r\nvalid_probs = tf.clip_by_value(tf.nn.softmax(valid_logits, axis=-1), \\\r\n\t\t\t\t\tclip_value_min=1e-6, clip_value_max=1.0)\r\nvalid_one_hot = tf.one_hot(valid_labels, depth=num_classes, dtype=tf.int32)\r\n## calculate the final cross-entropy\r\nweight_matrix = ohem_prob_g - tf.boolean_mask(valid_probs, valid_one_hot)\r\ncross_entropy = tf.losses.sparse_softmax_cross_entropy(labels=valid_labels, \r\n\t\t\t\t\t\tlogits=valid_logits, weights=weight_matrix)\r\nreturn cross_entropy\r\n```\r\n\r\n3. input code used for the `tf.estimator`\r\n\r\n```\r\ndef input_fn(is_training, data_dir, batch_size, num_epochs=1):\r\n  \"\"\"Input_fn using the tf.data input pipeline for CIFAR-10 dataset.\r\n  Args:\r\n    is_training: A boolean denoting whether the input is for training.\r\n    data_dir: The directory containing the input data.\r\n    batch_size: The number of samples per batch.\r\n    num_epochs: The number of epochs to repeat the dataset.\r\n  Returns:\r\n    A tuple of images and labels.\r\n  \"\"\"\r\n  dataset = tf.data.Dataset.from_tensor_slices(get_filenames(is_training, data_dir))\r\n  dataset = dataset.flat_map(tf.data.TFRecordDataset)\r\n  if is_training:\r\n    dataset = dataset.shuffle(buffer_size=_NUM_IMAGES['train'])\r\n\r\n  dataset = dataset.map(parse_record)\r\n  dataset = dataset.map(\r\n      lambda image, label, idx: preprocess_image(image, label, idx, is_training),\r\n      num_parallel_calls=1)\r\n\r\n  # We call repeat after shuffling, rather than before, to prevent separate\r\n  # epochs from blending together.\r\n  dataset = dataset.repeat(num_epochs)\r\n  dataset = dataset.batch(batch_size)\r\n  dataset = dataset.prefetch(buffer_size=FLAGS.prefetch_buffer_size)\r\n\r\n  iterator = dataset.make_one_shot_iterator()\r\n  images, labels, idx = iterator.get_next()\r\n\r\n  return images, labels\r\n\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22459", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22459/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22459/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22459/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22459", "id": 362826969, "node_id": "MDU6SXNzdWUzNjI4MjY5Njk=", "number": 22459, "title": "[bazel] Unrecoverable error while evaluating node '//tensorflow/cc:ops/io_ops_gen_cc", "user": {"login": "pauldelmusica", "id": 25024770, "node_id": "MDQ6VXNlcjI1MDI0Nzcw", "avatar_url": "https://avatars3.githubusercontent.com/u/25024770?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pauldelmusica", "html_url": "https://github.com/pauldelmusica", "followers_url": "https://api.github.com/users/pauldelmusica/followers", "following_url": "https://api.github.com/users/pauldelmusica/following{/other_user}", "gists_url": "https://api.github.com/users/pauldelmusica/gists{/gist_id}", "starred_url": "https://api.github.com/users/pauldelmusica/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pauldelmusica/subscriptions", "organizations_url": "https://api.github.com/users/pauldelmusica/orgs", "repos_url": "https://api.github.com/users/pauldelmusica/repos", "events_url": "https://api.github.com/users/pauldelmusica/events{/privacy}", "received_events_url": "https://api.github.com/users/pauldelmusica/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-09-22T05:01:00Z", "updated_at": "2018-12-13T18:59:27Z", "closed_at": null, "author_association": "NONE", "body": "I am running bazel  0.17.2 on Windows 7, with the following command:\r\nbazel build tensorflow/examples/wav_to_spectrogram/...\r\n\r\nThe output:\r\n\r\nc:\\tensorflow-master>bazel build tensorflow/examples/wav_to_spectrogram/...\r\nLoading:\r\nLoading: 0 packages loaded\r\nDEBUG: C:/users/me/_bazel_me/cxy76ymx/external/bazel_tools/tools/cpp/lib_cc_conf\r\nigure.bzl:115:5:\r\nAuto-Configuration Warning: 'BAZEL_VC' is not set, start looking for the latest\r\nVisual C++ installed.\r\nDEBUG: C:/users/me/_bazel_me/cxy76ymx/external/bazel_tools/tools/cpp/lib_cc_conf\r\nigure.bzl:115:5:\r\nAuto-Configuration Warning: Looking for VS%VERSION%COMNTOOLS environment variabl\r\nes, eg. VS140COMNTOOLS\r\nDEBUG: C:/users/me/_bazel_me/cxy76ymx/external/bazel_tools/tools/cpp/lib_cc_conf\r\nigure.bzl:115:5:\r\nAuto-Configuration Warning: Visual C++ build tools found at C:\\Program Files (x8\r\n6)\\Microsoft Visual Studio 12.0\\VC\\\r\nAnalyzing: 3 targets (0 packages loaded)\r\nAnalyzing: 3 targets (0 packages loaded)\r\nAnalyzing: 3 targets (1 packages loaded)\r\nWARNING: C:/tensorflow-master/tensorflow/core/BUILD:2501:1: in includes attribut\r\ne of cc_library rule //tensorflow/core:framework_internal_headers_lib: '../../ex\r\nternal/com_google_absl' resolves to 'external/com_google_absl' not below the rel\r\native path of its package 'tensorflow/core'. This will be an error in the future\r\n. Since this rule was created by the macro 'cc_header_only_library', the error m\r\night have been caused by the macro implementation in C:/tensorflow-master/tensor\r\nflow/tensorflow.bzl:1376:20\r\nWARNING: C:/tensorflow-master/tensorflow/core/BUILD:2587:1: in includes attribut\r\ne of cc_library rule //tensorflow/core:framework_headers_lib: '../../external/co\r\nm_google_absl' resolves to 'external/com_google_absl' not below the relative pat\r\nh of its package 'tensorflow/core'. This will be an error in the future. Since t\r\nhis rule was created by the macro 'cc_header_only_library', the error might have\r\n been caused by the macro implementation in C:/tensorflow-master/tensorflow/tens\r\norflow.bzl:1376:20\r\nUnhandled exception thrown during build; message: Unrecoverable error while eval\r\nuating node '//tensorflow/cc:ops/io_ops_gen_cc BuildConfigurationValue.Key[ac98f\r\n5975123fd6eeb07a7415b6161fb] true' (requested by nodes '//tensorflow/cc:io_ops_g\r\nenrule BuildConfigurationValue.Key[6a75becf8194103d260d4e5a345be2c2] false')\r\nINFO: Elapsed time: 31.631s\r\nINFO: 0 processes.\r\nFAILED: Build did NOT complete successfully (2 packages loaded)\r\njava.lang.RuntimeException: Unrecoverable error while evaluating node '//tensorf\r\nlow/cc:ops/io_ops_gen_cc BuildConfigurationValue.Key[ac98f5975123fd6eeb07a7415b6\r\n161fb] true' (requested by nodes '//tensorflow/cc:io_ops_genrule BuildConfigurat\r\nionValue.Key[6a75becf8194103d260d4e5a345be2c2] false')\r\n        at com.google.devtools.build.skyframe.AbstractParallelEvaluator$Evaluate\r\n.run(AbstractParallelEvaluator.java:497)\r\n        at com.google.devtools.build.lib.concurrent.AbstractQueueVisitor$Wrapped\r\nRunnable.run(AbstractQueueVisitor.java:368)\r\n        at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown S\r\nource)\r\n        at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown\r\nSource)\r\n        at java.base/java.lang.Thread.run(Unknown Source)\r\nCaused by: java.lang.IllegalStateException\r\n        at com.google.common.base.Preconditions.checkState(Preconditions.java:49\r\n1)\r\n        at com.google.devtools.build.lib.rules.cpp.LibrariesToLinkCollector.addD\r\nynamicInputLinkOptions(LibrariesToLinkCollector.java:290)\r\n        at com.google.devtools.build.lib.rules.cpp.LibrariesToLinkCollector.addL\r\ninkerInputs(LibrariesToLinkCollector.java:258)\r\n        at com.google.devtools.build.lib.rules.cpp.LibrariesToLinkCollector.coll\r\nectLibrariesToLink(LibrariesToLinkCollector.java:203)\r\n        at com.google.devtools.build.lib.rules.cpp.CppLinkActionBuilder.build(Cp\r\npLinkActionBuilder.java:916)\r\n        at com.google.devtools.build.lib.rules.cpp.CcBinary.init(CcBinary.java:4\r\n13)\r\n        at com.google.devtools.build.lib.rules.cpp.CcBinary.create(CcBinary.java\r\n:179)\r\n        at com.google.devtools.build.lib.rules.cpp.CcBinary.create(CcBinary.java\r\n:71)\r\n        at com.google.devtools.build.lib.analysis.ConfiguredTargetFactory.create\r\nRule(ConfiguredTargetFactory.java:320)\r\n        at com.google.devtools.build.lib.analysis.ConfiguredTargetFactory.create\r\nConfiguredTarget(ConfiguredTargetFactory.java:205)\r\n        at com.google.devtools.build.lib.skyframe.SkyframeBuildView.createConfig\r\nuredTarget(SkyframeBuildView.java:631)\r\n        at com.google.devtools.build.lib.skyframe.ConfiguredTargetFunction.creat\r\neConfiguredTarget(ConfiguredTargetFunction.java:770)\r\n        at com.google.devtools.build.lib.skyframe.ConfiguredTargetFunction.compu\r\nte(ConfiguredTargetFunction.java:320)\r\n        at com.google.devtools.build.skyframe.AbstractParallelEvaluator$Evaluate\r\n.run(AbstractParallelEvaluator.java:420)\r\n        ... 4 more\r\njava.lang.RuntimeException: Unrecoverable error while evaluating node '//tensorf\r\nlow/cc:ops/io_ops_gen_cc BuildConfigurationValue.Key[ac98f5975123fd6eeb07a7415b6\r\n161fb] true' (requested by nodes '//tensorflow/cc:io_ops_genrule BuildConfigurat\r\nionValue.Key[6a75becf8194103d260d4e5a345be2c2] false')\r\n        at com.google.devtools.build.skyframe.AbstractParallelEvaluator$Evaluate\r\n.run(AbstractParallelEvaluator.java:497)\r\n        at com.google.devtools.build.lib.concurrent.AbstractQueueVisitor$Wrapped\r\nRunnable.run(AbstractQueueVisitor.java:368)\r\n        at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown S\r\nource)\r\n        at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown\r\nSource)\r\n        at java.base/java.lang.Thread.run(Unknown Source)\r\nCaused by: java.lang.IllegalStateException\r\n        at com.google.common.base.Preconditions.checkState(Preconditions.java:49\r\n1)\r\n        at com.google.devtools.build.lib.rules.cpp.LibrariesToLinkCollector.addD\r\nynamicInputLinkOptions(LibrariesToLinkCollector.java:290)\r\n        at com.google.devtools.build.lib.rules.cpp.LibrariesToLinkCollector.addL\r\ninkerInputs(LibrariesToLinkCollector.java:258)\r\n        at com.google.devtools.build.lib.rules.cpp.LibrariesToLinkCollector.coll\r\nectLibrariesToLink(LibrariesToLinkCollector.java:203)\r\n        at com.google.devtools.build.lib.rules.cpp.CppLinkActionBuilder.build(Cp\r\npLinkActionBuilder.java:916)\r\n        at com.google.devtools.build.lib.rules.cpp.CcBinary.init(CcBinary.java:4\r\n13)\r\n        at com.google.devtools.build.lib.rules.cpp.CcBinary.create(CcBinary.java\r\n:179)\r\n        at com.google.devtools.build.lib.rules.cpp.CcBinary.create(CcBinary.java\r\n:71)\r\n        at com.google.devtools.build.lib.analysis.ConfiguredTargetFactory.create\r\nRule(ConfiguredTargetFactory.java:320)\r\n        at com.google.devtools.build.lib.analysis.ConfiguredTargetFactory.create\r\nConfiguredTarget(ConfiguredTargetFactory.java:205)\r\n        at com.google.devtools.build.lib.skyframe.SkyframeBuildView.createConfig\r\nuredTarget(SkyframeBuildView.java:631)\r\n        at com.google.devtools.build.lib.skyframe.ConfiguredTargetFunction.creat\r\neConfiguredTarget(ConfiguredTargetFunction.java:770)\r\n        at com.google.devtools.build.lib.skyframe.ConfiguredTargetFunction.compu\r\nte(ConfiguredTargetFunction.java:320)\r\n        at com.google.devtools.build.skyframe.AbstractParallelEvaluator$Evaluate\r\n.run(AbstractParallelEvaluator.java:420)\r\n        ... 4 more\r\nFAILED: Build did NOT complete successfully (2 packages loaded)\r\n\r\nServer terminated abruptly (error code: 14, error message: '', log file: 'c:\\use\r\nrs\\me\\_bazel_me\\cxy76ymx/server/jvm.out')\r\n\r\n\r\nc:\\tensorflow-master>"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22411", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22411/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22411/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22411/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22411", "id": 362168685, "node_id": "MDU6SXNzdWUzNjIxNjg2ODU=", "number": 22411, "title": "the session->close() is ok,but the error is  stack smashing detected ", "user": {"login": "Yangxiu123321", "id": 29605999, "node_id": "MDQ6VXNlcjI5NjA1OTk5", "avatar_url": "https://avatars3.githubusercontent.com/u/29605999?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Yangxiu123321", "html_url": "https://github.com/Yangxiu123321", "followers_url": "https://api.github.com/users/Yangxiu123321/followers", "following_url": "https://api.github.com/users/Yangxiu123321/following{/other_user}", "gists_url": "https://api.github.com/users/Yangxiu123321/gists{/gist_id}", "starred_url": "https://api.github.com/users/Yangxiu123321/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Yangxiu123321/subscriptions", "organizations_url": "https://api.github.com/users/Yangxiu123321/orgs", "repos_url": "https://api.github.com/users/Yangxiu123321/repos", "events_url": "https://api.github.com/users/Yangxiu123321/events{/privacy}", "received_events_url": "https://api.github.com/users/Yangxiu123321/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-09-20T12:40:10Z", "updated_at": "2019-11-09T06:21:54Z", "closed_at": null, "author_association": "NONE", "body": "### OS platform:ubuntu:16.04\r\n### ensorflow install from source code\r\n### tensorflow version:1.11(master branch)\r\n### Bazel version:0.17.1\r\n### CPU\r\n## 1\u3001comand:\r\nbazel build --copt=-mavx --copt=-mavx2 --copt=-mfma --copt=-mfpmath=both --copt=-msse4.2 --config=monolithic //tensorflow:libtensorflow_cc.so\r\nbazel build --copt=-mavx --copt=-mavx2 --copt=-mfma --copt=-mfpmath=both --copt=-msse4.2 --config=monolithic //tensorflow:libtensorflow_framework.so\r\n\r\nsudo mkdir /usr/local/include/tf\r\nsudo mkdir /usr/local/include/tf/tensorflow\r\nsudo cp -r bazel-genfiles/ /usr/include/tf\r\nsudo cp -r tensorflow/cc /usr/include/tf/tensorflow\r\nsudo cp -r tensorflow/core /usr/include/tf/tensorflow\r\nsudo cp -r third_party /usr/include/tf\r\nsudo cp -r bazel-bin/tensorflow/libtensorflow_cc.so /usr/local/lib\r\nsudo cp -r bazel-bin/tensorflow/libtensorflow_framework.so /usr/local/lib\r\n## 2\u3001code:\r\n#include \"tensorflow/core/public/session.h\"\r\n#include \"tensorflow/core/platform/env.h\"\r\n\r\nusing namespace std;\r\nusing namespace chrono;\r\nusing namespace tensorflow;\r\nint main(int argc, char* argv[]) {\r\n// SessionOptions options;\r\n// std::unique_ptrtensorflow::Session session(tensorflow::NewSession(options));\r\nSession *session = NewSession(SessionOptions());\r\nif(session == nullptr)\r\n{\r\nthrow runtime_error(\"Could not create tensorflow session\");\r\n}\r\nStatus status = session->Close();\r\nreturn 0;\r\n}\r\n## 3\u3001the status is status.ok() is right,but the error is \"*** stack smashing detected ***: terminated \u5df2\u653e\u5f03 (\u6838\u5fc3\u5df2\u8f6c\u50a8)\""}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22410", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22410/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22410/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22410/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22410", "id": 362158259, "node_id": "MDU6SXNzdWUzNjIxNTgyNTk=", "number": 22410, "title": "GAN train will hand if not use default GANTrainSteps(1, 1)", "user": {"login": "mpjlu", "id": 13826327, "node_id": "MDQ6VXNlcjEzODI2MzI3", "avatar_url": "https://avatars1.githubusercontent.com/u/13826327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpjlu", "html_url": "https://github.com/mpjlu", "followers_url": "https://api.github.com/users/mpjlu/followers", "following_url": "https://api.github.com/users/mpjlu/following{/other_user}", "gists_url": "https://api.github.com/users/mpjlu/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpjlu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpjlu/subscriptions", "organizations_url": "https://api.github.com/users/mpjlu/orgs", "repos_url": "https://api.github.com/users/mpjlu/repos", "events_url": "https://api.github.com/users/mpjlu/events{/privacy}", "received_events_url": "https://api.github.com/users/mpjlu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "joel-shor", "id": 6020988, "node_id": "MDQ6VXNlcjYwMjA5ODg=", "avatar_url": "https://avatars1.githubusercontent.com/u/6020988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joel-shor", "html_url": "https://github.com/joel-shor", "followers_url": "https://api.github.com/users/joel-shor/followers", "following_url": "https://api.github.com/users/joel-shor/following{/other_user}", "gists_url": "https://api.github.com/users/joel-shor/gists{/gist_id}", "starred_url": "https://api.github.com/users/joel-shor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joel-shor/subscriptions", "organizations_url": "https://api.github.com/users/joel-shor/orgs", "repos_url": "https://api.github.com/users/joel-shor/repos", "events_url": "https://api.github.com/users/joel-shor/events{/privacy}", "received_events_url": "https://api.github.com/users/joel-shor/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "joel-shor", "id": 6020988, "node_id": "MDQ6VXNlcjYwMjA5ODg=", "avatar_url": "https://avatars1.githubusercontent.com/u/6020988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joel-shor", "html_url": "https://github.com/joel-shor", "followers_url": "https://api.github.com/users/joel-shor/followers", "following_url": "https://api.github.com/users/joel-shor/following{/other_user}", "gists_url": "https://api.github.com/users/joel-shor/gists{/gist_id}", "starred_url": "https://api.github.com/users/joel-shor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joel-shor/subscriptions", "organizations_url": "https://api.github.com/users/joel-shor/orgs", "repos_url": "https://api.github.com/users/joel-shor/repos", "events_url": "https://api.github.com/users/joel-shor/events{/privacy}", "received_events_url": "https://api.github.com/users/joel-shor/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-09-20T12:11:41Z", "updated_at": "2018-12-14T19:00:03Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "When I test WGAN on tensorflow,  I set the generator_train_steps = 1 and discriminator_train_steps = 5 following the paper, like this:\r\ntensorflow/contrib/gan/python/train.py:815\r\n`def get_sequential_train_hooks(train_steps=namedtuples.GANTrainSteps(1, 5))`\r\nThe train process always hand after the first step. \r\nAnd the default value works well.\r\n`def get_sequential_train_hooks(train_steps=namedtuples.GANTrainSteps(1, 1))`\r\n\r\nTest:\r\njust run \r\n`https://github.com/tensorflow/models/blob/master/research/gan/cifar/train.py `\r\nwith cifar10 dataset.\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22396", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22396/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22396/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22396/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22396", "id": 361954749, "node_id": "MDU6SXNzdWUzNjE5NTQ3NDk=", "number": 22396, "title": "[Feature Request]:Assign the name to SaprseTensor when build_tensor_info of it", "user": {"login": "haotianteng", "id": 11155295, "node_id": "MDQ6VXNlcjExMTU1Mjk1", "avatar_url": "https://avatars3.githubusercontent.com/u/11155295?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haotianteng", "html_url": "https://github.com/haotianteng", "followers_url": "https://api.github.com/users/haotianteng/followers", "following_url": "https://api.github.com/users/haotianteng/following{/other_user}", "gists_url": "https://api.github.com/users/haotianteng/gists{/gist_id}", "starred_url": "https://api.github.com/users/haotianteng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haotianteng/subscriptions", "organizations_url": "https://api.github.com/users/haotianteng/orgs", "repos_url": "https://api.github.com/users/haotianteng/repos", "events_url": "https://api.github.com/users/haotianteng/events{/privacy}", "received_events_url": "https://api.github.com/users/haotianteng/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "karmel", "id": 667809, "node_id": "MDQ6VXNlcjY2NzgwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karmel", "html_url": "https://github.com/karmel", "followers_url": "https://api.github.com/users/karmel/followers", "following_url": "https://api.github.com/users/karmel/following{/other_user}", "gists_url": "https://api.github.com/users/karmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/karmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karmel/subscriptions", "organizations_url": "https://api.github.com/users/karmel/orgs", "repos_url": "https://api.github.com/users/karmel/repos", "events_url": "https://api.github.com/users/karmel/events{/privacy}", "received_events_url": "https://api.github.com/users/karmel/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "karmel", "id": 667809, "node_id": "MDQ6VXNlcjY2NzgwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karmel", "html_url": "https://github.com/karmel", "followers_url": "https://api.github.com/users/karmel/followers", "following_url": "https://api.github.com/users/karmel/following{/other_user}", "gists_url": "https://api.github.com/users/karmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/karmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karmel/subscriptions", "organizations_url": "https://api.github.com/users/karmel/orgs", "repos_url": "https://api.github.com/users/karmel/repos", "events_url": "https://api.github.com/users/karmel/events{/privacy}", "received_events_url": "https://api.github.com/users/karmel/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 14, "created_at": "2018-09-19T22:42:23Z", "updated_at": "2019-02-07T14:47:10Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: N.A.\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: 1.10.1\r\n- **Python version**: 3.6\r\n- **Bazel version (if compiling from source)**: 0.16.1\r\n- **GCC/Compiler version (if compiling from source)**: gcc version 5.4.0 20160609\r\n- **CUDA/cuDNN version**: 9.0/7.0\r\n- **GPU model and memory**: Tesla P100 16GB\r\n- **Exact command to reproduce**:\r\nA minimum reproduce example:\r\n```\r\na = tf.constant([[[1.0]]])\r\nb = tf.constant([1])\r\noutput,prob = tf.nn.ctc_beam_search_decoder(a,b)\r\na_tensor_proto = tf.saved_model.utils.build_tensor_info(a)\r\noutput_tensor_proto = tf.saved_model.utils.build_tensor_info(output[0]) \r\n```\r\n### Describe the problem\r\nA normal Tensor has a name:\r\n```\r\na_tensor_proto\r\nname: \"Const_15:0\"\r\ndtype: DT_FLOAT\r\ntensor_shape {\r\n  dim {\r\n    size: 1\r\n  }\r\n  dim {\r\n    size: 1\r\n  }\r\n  dim {\r\n    size: 1\r\n  }\r\n}\r\n\r\n```\r\nwhile the SparseTensor from the ctc Beam_Search_Decoder does not has a name:\r\n```\r\noutput_tensor_proto\r\ndtype: DT_INT64\r\ntensor_shape {\r\n  dim {\r\n    size: -1\r\n  }\r\n  dim {\r\n    size: -1\r\n  }\r\n}\r\ncoo_sparse {\r\n  values_tensor_name: \"CTCBeamSearchDecoder_12:1\"\r\n  indices_tensor_name: \"CTCBeamSearchDecoder_12:0\"\r\n  dense_shape_tensor_name: \"CTCBeamSearchDecoder_12:2\"\r\n}\r\n```\r\nWhich cause the error when predict:\r\n\r\n```\r\nimport tensorflow as tf\r\nfrom tensorflow.contrib import predictor\r\nfrom tensorflow.contrib.saved_model.python.saved_model import reader\r\nfrom tensorflow.contrib.saved_model.python.saved_model import signature_def_utils\r\nfrom tensorflow.python.tools import saved_model_utils\r\n\r\nexp_dir = MY_EXPORT_DIRECTORY\r\nmetagraph_def = saved_model_utils.get_meta_graph_def(exp_dir,'serve')\r\nsignature_def = signature_def_utils.get_signature_def_by_key(\r\n        metagraph_def,\r\n        'predicted_sequences')\r\noutput_names = {k: v.name for k, v in signature_def.outputs.items()}\r\nprint(output_names)\r\npredict_fn = predictor.from_saved_model(exp_dir)\r\nseq_len = np.asarray([[4]])\r\ncombined_input = np.concatenate((batch_x,seq_len),axis = 1)\r\npredictions = predict_fn({'inputs':combined_input})\r\n```\r\nValueError: The name '' looks like an (invalid) Operation name, not a Tensor. Tensor names must be of the form \"<op_name>:<output_index>\".\r\nand  also the above error, when export it into a saved_model and request it.\r\n\r\nThe reason is when building a TensorProto for the SaprseTensor, no name is assigned to it:\r\nhttps://github.com/tensorflow/tensorflow/blob/r1.10/tensorflow/python/saved_model/utils_impl.py#L46\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22395", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22395/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22395/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22395/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22395", "id": 361949553, "node_id": "MDU6SXNzdWUzNjE5NDk1NTM=", "number": 22395, "title": "numpy not found during python_api generation", "user": {"login": "maxnbk", "id": 6218350, "node_id": "MDQ6VXNlcjYyMTgzNTA=", "avatar_url": "https://avatars1.githubusercontent.com/u/6218350?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maxnbk", "html_url": "https://github.com/maxnbk", "followers_url": "https://api.github.com/users/maxnbk/followers", "following_url": "https://api.github.com/users/maxnbk/following{/other_user}", "gists_url": "https://api.github.com/users/maxnbk/gists{/gist_id}", "starred_url": "https://api.github.com/users/maxnbk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maxnbk/subscriptions", "organizations_url": "https://api.github.com/users/maxnbk/orgs", "repos_url": "https://api.github.com/users/maxnbk/repos", "events_url": "https://api.github.com/users/maxnbk/events{/privacy}", "received_events_url": "https://api.github.com/users/maxnbk/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "annarev", "id": 22060313, "node_id": "MDQ6VXNlcjIyMDYwMzEz", "avatar_url": "https://avatars0.githubusercontent.com/u/22060313?v=4", "gravatar_id": "", "url": "https://api.github.com/users/annarev", "html_url": "https://github.com/annarev", "followers_url": "https://api.github.com/users/annarev/followers", "following_url": "https://api.github.com/users/annarev/following{/other_user}", "gists_url": "https://api.github.com/users/annarev/gists{/gist_id}", "starred_url": "https://api.github.com/users/annarev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/annarev/subscriptions", "organizations_url": "https://api.github.com/users/annarev/orgs", "repos_url": "https://api.github.com/users/annarev/repos", "events_url": "https://api.github.com/users/annarev/events{/privacy}", "received_events_url": "https://api.github.com/users/annarev/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "annarev", "id": 22060313, "node_id": "MDQ6VXNlcjIyMDYwMzEz", "avatar_url": "https://avatars0.githubusercontent.com/u/22060313?v=4", "gravatar_id": "", "url": "https://api.github.com/users/annarev", "html_url": "https://github.com/annarev", "followers_url": "https://api.github.com/users/annarev/followers", "following_url": "https://api.github.com/users/annarev/following{/other_user}", "gists_url": "https://api.github.com/users/annarev/gists{/gist_id}", "starred_url": "https://api.github.com/users/annarev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/annarev/subscriptions", "organizations_url": "https://api.github.com/users/annarev/orgs", "repos_url": "https://api.github.com/users/annarev/repos", "events_url": "https://api.github.com/users/annarev/events{/privacy}", "received_events_url": "https://api.github.com/users/annarev/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 26, "created_at": "2018-09-19T22:19:47Z", "updated_at": "2018-12-16T18:37:20Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: CentOS-7.4\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: None\r\n- **TensorFlow installed from (source or binary)**: Source\r\n- **TensorFlow version (use command below)**: 1.10.1, earlier versions\r\n- **Python version**: 2.7, 3.6 (separate rebuilds same issue)\r\n- **Bazel version (if compiling from source)**: 0.17.1\r\n- **GCC/Compiler version (if compiling from source)**: 4.8.5, 6.3.1 (separate rebuilds same issue)\r\n- **CUDA/cuDNN version**: CPU only build\r\n- **GPU model and memory**: Quadro K4000\r\n- **Exact command to reproduce**: Not reproducible with single command\r\n\r\n### Describe the problem\r\nProblem manifests as \"No module named numpy\", during python api generation as detailed below in log section.\r\n\r\nIf placing a simple `print(sys.path)` or `print(os.environ['PYTHONPATH'])` in the listed `__init__.py` (in below log), none of the resulting paths listed include the path that numpy is included on via the PYTHONPATH, which is being passed along to the build environ included via bazels CLI opts, `--action_env` and `--test_env` arguments to the build call.\r\n\r\nI believe this issue will be reproducible only under a state where someone has installed numpy to a nonstandard location, and is including it via PYTHONPATH and `--action_env` such as is listed. However, all python modules in our environment are in separate paths, as managed by an environment manager, so I cannot install them to a common system path for testing if the issue resolves itself. What is strange is that earlier steps that require numpy have built just fine and not errored from what I can tell.\r\n\r\nApologies if my details included are omitting some crucial detail. The specific set of config values seems unnecessary for detail here, but let me know if they are needed. (Every optional component driven by `TF_NEED_{var}` is turned off except for `TF_NEED_JEMALLOC` which does not appear to be part of the problem)\r\n\r\n### Source code / logs\r\n\r\nbuild command, while prefaced by many environment variable changes and the ./configure step, is of the form:\r\n`bazel --batch build --action_env=PYTHONPATH --action_env=LD_LIBRARY_PATH --test_env=PYTHONPATH --test_env=LD_LIBRARY_PATH -c opt --copt=-mfpmath=both --copt=-msse4.2 //tensorflow/tools/pip_package:build_pip_package`\r\n\r\n`ERROR: ${build_root}/tensorflow/BUILD:581:1: Executing genrule //tensorflow:tensorflow_python_api_gen failed (Exit 1)\r\nTraceback (most recent call last):\r\n  File \"/home/${user}/.cache/bazel/_bazel_${user}/ff38b9a62494579437724e08cde1b695/execroot/org_tensorflow/bazel-out/host/bin/tensorflow/create_tensorflow.python_api.runfiles/org_tensorflow/tensorflow/python/tools/api/generator/create_python_api.py\", line 27, in <module>\r\n    from tensorflow.python.tools.api.generator import doc_srcs\r\n  File \"/home/${user}/.cache/bazel/_bazel_${user}/ff38b9a62494579437724e08cde1b695/execroot/org_tensorflow/bazel-out/host/bin/tensorflow/create_tensorflow.python_api.runfiles/org_tensorflow/tensorflow/python/__init__.py\", line 49, in <module>\r\n    import numpy as np\r\nImportError: No module named numpy`"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22384", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22384/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22384/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22384/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22384", "id": 361803828, "node_id": "MDU6SXNzdWUzNjE4MDM4Mjg=", "number": 22384, "title": "BUG: reciprocal GPU kernel for complex 1/1 division not found", "user": {"login": "mayou36", "id": 17454848, "node_id": "MDQ6VXNlcjE3NDU0ODQ4", "avatar_url": "https://avatars3.githubusercontent.com/u/17454848?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mayou36", "html_url": "https://github.com/mayou36", "followers_url": "https://api.github.com/users/mayou36/followers", "following_url": "https://api.github.com/users/mayou36/following{/other_user}", "gists_url": "https://api.github.com/users/mayou36/gists{/gist_id}", "starred_url": "https://api.github.com/users/mayou36/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mayou36/subscriptions", "organizations_url": "https://api.github.com/users/mayou36/orgs", "repos_url": "https://api.github.com/users/mayou36/repos", "events_url": "https://api.github.com/users/mayou36/events{/privacy}", "received_events_url": "https://api.github.com/users/mayou36/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2018-09-19T15:28:14Z", "updated_at": "2019-12-09T22:19:01Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 18.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: 1.10.0\r\n- **Python version**: 3.6\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**: 9.2/7.2.1\r\n- **GPU model and memory**: GeForce GTX 1050 mobile, 4096MiB\r\n- **Exact command to reproduce**:\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\n# create a lot of points\r\n# CHANGE NUMBER BELOW (higher -> fails)\r\nn_points = 670000  # fails around > 650'000 (e.g. 1'000'000) for np.linspace generation\r\n\r\n\r\n# points creation\r\npoints = np.ones(n_points)\r\n# alternate points creation\r\n# low = 100.  # irrelevant, only > 0 -> no 0 (division)\r\n# high = 200.  # irrelevant\r\n# points = tf.random_uniform(shape=[n_points], minval=low, maxval=high)\r\n# points = np.linspace(low, high, n_points)\r\n\r\nwith tf.Session() as sess:\r\n    # just do complex division: 1.0+0j / points\r\n    complex_1_0 = tf.cast(1., dtype=tf.complex128)\r\n    denom = tf.cast(points, dtype=tf.complex128)\r\n    division = complex_1_0 / denom\r\n    result = sess.run(division)\r\n    print(result)\r\n```\r\n\r\n### Describe the problem\r\nFor a certain amount of points, the complex division kernel (or rather reciprocal kernel) \"seems to not be available on the GPU\".\r\n**It works for**\r\n- a lower number of points\r\n- for floats\r\n- on CPU (tested with \"tf.devices\")\r\n\r\n**It seems to be independent of**\r\n- the generation of the points (see commented lines for alternate creation)\r\n- GPU (also tested on Tesla K80) with lower TF/Cuda version\r\n\r\nNo idea where to start...\r\n\r\n### Source code / logs\r\nrelevant error:\r\nNotFoundError (see above for traceback): No registered 'Reciprocal' OpKernel for GPU devices compatible with node truediv = Reciprocal[T=DT_COMPLEX128, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](Cast_1)\r\n\t (OpKernel was found, but attributes didn't match)\r\n\t.  Registered:  device='GPU'; T in [DT_INT64]\r\n  device='GPU'; T in [DT_DOUBLE]\r\n  device='GPU'; T in [DT_HALF]\r\n  device='GPU'; T in [DT_FLOAT]\r\n  device='CPU'; T in [DT_COMPLEX128]\r\n  device='CPU'; T in [DT_COMPLEX64]\r\n  device='CPU'; T in [DT_DOUBLE]\r\n  device='CPU'; T in [DT_HALF]\r\n  device='CPU'; T in [DT_FLOAT]\r\n\t [[Node: truediv = Reciprocal[T=DT_COMPLEX128, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](Cast_1)]]\r\n\r\nFull stacktrace of failure: \r\n2018-09-19 17:18:40.965160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 3010 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1050, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n2018-09-19 17:18:41.104747: E tensorflow/core/common_runtime/executor.cc:697] Executor failed to create kernel. Not found: No registered 'Reciprocal' OpKernel for GPU devices compatible with node truediv = Reciprocal[T=DT_COMPLEX128, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](Cast_1)\r\n\t (OpKernel was found, but attributes didn't match)\r\n\t.  Registered:  device='GPU'; T in [DT_INT64]\r\n  device='GPU'; T in [DT_DOUBLE]\r\n  device='GPU'; T in [DT_HALF]\r\n  device='GPU'; T in [DT_FLOAT]\r\n  device='CPU'; T in [DT_COMPLEX128]\r\n  device='CPU'; T in [DT_COMPLEX64]\r\n  device='CPU'; T in [DT_DOUBLE]\r\n  device='CPU'; T in [DT_HALF]\r\n  device='CPU'; T in [DT_FLOAT]\r\n\t [[Node: truediv = Reciprocal[T=DT_COMPLEX128, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](Cast_1)]]\r\nTraceback (most recent call last):\r\n  File \"/home/jonas/anaconda3/envs/zfit36/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1278, in _do_call\r\n    return fn(*args)\r\n  File \"/home/jonas/anaconda3/envs/zfit36/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1263, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"/home/jonas/anaconda3/envs/zfit36/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1350, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.NotFoundError: No registered 'Reciprocal' OpKernel for GPU devices compatible with node truediv = Reciprocal[T=DT_COMPLEX128, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](Cast_1)\r\n\t (OpKernel was found, but attributes didn't match)\r\n\t.  Registered:  device='GPU'; T in [DT_INT64]\r\n  device='GPU'; T in [DT_DOUBLE]\r\n  device='GPU'; T in [DT_HALF]\r\n  device='GPU'; T in [DT_FLOAT]\r\n  device='CPU'; T in [DT_COMPLEX128]\r\n  device='CPU'; T in [DT_COMPLEX64]\r\n  device='CPU'; T in [DT_DOUBLE]\r\n  device='CPU'; T in [DT_HALF]\r\n  device='CPU'; T in [DT_FLOAT]\r\n\t [[Node: truediv = Reciprocal[T=DT_COMPLEX128, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](Cast_1)]]\r\nDuring handling of the above exception, another exception occurred:\r\nTraceback (most recent call last):\r\n  File \"/home/jonas/anaconda3/envs/zfit36/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2961, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-2-0ba75500be23>\", line 1, in <module>\r\n    runfile('/home/jonas/Documents/uni/Master_thesis/code/test/tf_playground/test/gpu_div_bug.py', wdir='/home/jonas/Documents/uni/Master_thesis/code/test/tf_playground/test')\r\n  File \"/usr/share/pycharm/helpers/pydev/_pydev_bundle/pydev_umd.py\", line 197, in runfile\r\n    pydev_imports.execfile(filename, global_vars, local_vars)  # execute the script\r\n  File \"/usr/share/pycharm/helpers/pydev/_pydev_imps/_pydev_execfile.py\", line 18, in execfile\r\n    exec(compile(contents+\"\\n\", file, 'exec'), glob, loc)\r\n  File \"/home/jonas/Documents/uni/Master_thesis/code/test/tf_playground/test/gpu_div_bug.py\", line 20, in <module>\r\n    result = sess.run(division)\r\n  File \"/home/jonas/anaconda3/envs/zfit36/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 877, in run\r\n    run_metadata_ptr)\r\n  File \"/home/jonas/anaconda3/envs/zfit36/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1100, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/jonas/anaconda3/envs/zfit36/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1272, in _do_run\r\n    run_metadata)\r\n  File \"/home/jonas/anaconda3/envs/zfit36/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1291, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.NotFoundError: No registered 'Reciprocal' OpKernel for GPU devices compatible with node truediv = Reciprocal[T=DT_COMPLEX128, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](Cast_1)\r\n\t (OpKernel was found, but attributes didn't match)\r\n\t.  Registered:  device='GPU'; T in [DT_INT64]\r\n  device='GPU'; T in [DT_DOUBLE]\r\n  device='GPU'; T in [DT_HALF]\r\n  device='GPU'; T in [DT_FLOAT]\r\n  device='CPU'; T in [DT_COMPLEX128]\r\n  device='CPU'; T in [DT_COMPLEX64]\r\n  device='CPU'; T in [DT_DOUBLE]\r\n  device='CPU'; T in [DT_HALF]\r\n  device='CPU'; T in [DT_FLOAT]\r\n\t [[Node: truediv = Reciprocal[T=DT_COMPLEX128, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](Cast_1)]]\r\nCaused by op 'truediv', defined at:\r\n  File \"/usr/share/pycharm/helpers/pydev/pydevconsole.py\", line 511, in <module>\r\n    pydevconsole.start_server(host, int(port), int(client_port), client_host)\r\n  File \"/usr/share/pycharm/helpers/pydev/pydevconsole.py\", line 336, in start_server\r\n    process_exec_queue(interpreter)\r\n  File \"/usr/share/pycharm/helpers/pydev/pydevconsole.py\", line 192, in process_exec_queue\r\n    more = interpreter.add_exec(code_fragment)\r\n  File \"/usr/share/pycharm/helpers/pydev/_pydev_bundle/pydev_console_utils.py\", line 281, in add_exec\r\n    more = self.do_add_exec(code_fragment)\r\n  File \"/usr/share/pycharm/helpers/pydev/_pydev_bundle/pydev_ipython_console.py\", line 41, in do_add_exec\r\n    res = bool(self.interpreter.add_exec(code_fragment.text))\r\n  File \"/usr/share/pycharm/helpers/pydev/_pydev_bundle/pydev_ipython_console_011.py\", line 442, in add_exec\r\n    self.ipython.run_cell(line, store_history=True)\r\n  File \"/home/jonas/anaconda3/envs/zfit36/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2662, in run_cell\r\n    raw_cell, store_history, silent, shell_futures)\r\n  File \"/home/jonas/anaconda3/envs/zfit36/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2785, in _run_cell\r\n    interactivity=interactivity, compiler=compiler, result=result)\r\n  File \"/home/jonas/anaconda3/envs/zfit36/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2907, in run_ast_nodes\r\n    if self.run_code(code, result):\r\n  File \"/home/jonas/anaconda3/envs/zfit36/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2961, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-2-0ba75500be23>\", line 1, in <module>\r\n    runfile('/home/jonas/Documents/uni/Master_thesis/code/test/tf_playground/test/gpu_div_bug.py', wdir='/home/jonas/Documents/uni/Master_thesis/code/test/tf_playground/test')\r\n  File \"/usr/share/pycharm/helpers/pydev/_pydev_bundle/pydev_umd.py\", line 197, in runfile\r\n    pydev_imports.execfile(filename, global_vars, local_vars)  # execute the script\r\n  File \"/usr/share/pycharm/helpers/pydev/_pydev_imps/_pydev_execfile.py\", line 18, in execfile\r\n    exec(compile(contents+\"\\n\", file, 'exec'), glob, loc)\r\n  File \"/home/jonas/Documents/uni/Master_thesis/code/test/tf_playground/test/gpu_div_bug.py\", line 19, in <module>\r\n    division = complex_1_0 / denom\r\n  File \"/home/jonas/anaconda3/envs/zfit36/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py\", line 850, in binary_op_wrapper\r\n    return func(x, y, name=name)\r\n  File \"/home/jonas/anaconda3/envs/zfit36/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py\", line 958, in _truediv_python3\r\n    return gen_math_ops.real_div(x, y, name=name)\r\n  File \"/home/jonas/anaconda3/envs/zfit36/lib/python3.6/site-packages/tensorflow/python/ops/gen_math_ops.py\", line 5881, in real_div\r\n    \"RealDiv\", x=x, y=y, name=name)\r\n  File \"/home/jonas/anaconda3/envs/zfit36/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 787, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/home/jonas/anaconda3/envs/zfit36/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 454, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/home/jonas/anaconda3/envs/zfit36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3155, in create_op\r\n    op_def=op_def)\r\n  File \"/home/jonas/anaconda3/envs/zfit36/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 1717, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\nNotFoundError (see above for traceback): No registered 'Reciprocal' OpKernel for GPU devices compatible with node truediv = Reciprocal[T=DT_COMPLEX128, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](Cast_1)\r\n\t (OpKernel was found, but attributes didn't match)\r\n\t.  Registered:  device='GPU'; T in [DT_INT64]\r\n  device='GPU'; T in [DT_DOUBLE]\r\n  device='GPU'; T in [DT_HALF]\r\n  device='GPU'; T in [DT_FLOAT]\r\n  device='CPU'; T in [DT_COMPLEX128]\r\n  device='CPU'; T in [DT_COMPLEX64]\r\n  device='CPU'; T in [DT_DOUBLE]\r\n  device='CPU'; T in [DT_HALF]\r\n  device='CPU'; T in [DT_FLOAT]\r\n\t [[Node: truediv = Reciprocal[T=DT_COMPLEX128, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](Cast_1)]]\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22377", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22377/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22377/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22377/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22377", "id": 361666356, "node_id": "MDU6SXNzdWUzNjE2NjYzNTY=", "number": 22377, "title": "tflite can't ResizeInputTensor size", "user": {"login": "TPcoding", "id": 17492681, "node_id": "MDQ6VXNlcjE3NDkyNjgx", "avatar_url": "https://avatars3.githubusercontent.com/u/17492681?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TPcoding", "html_url": "https://github.com/TPcoding", "followers_url": "https://api.github.com/users/TPcoding/followers", "following_url": "https://api.github.com/users/TPcoding/following{/other_user}", "gists_url": "https://api.github.com/users/TPcoding/gists{/gist_id}", "starred_url": "https://api.github.com/users/TPcoding/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TPcoding/subscriptions", "organizations_url": "https://api.github.com/users/TPcoding/orgs", "repos_url": "https://api.github.com/users/TPcoding/repos", "events_url": "https://api.github.com/users/TPcoding/events{/privacy}", "received_events_url": "https://api.github.com/users/TPcoding/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2018-09-19T09:49:10Z", "updated_at": "2019-10-09T16:21:52Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:N/A\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:16.04.1-Ubuntu\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:N/A\r\n- **TensorFlow installed from (source or binary)**:source\r\n- **TensorFlow version (use command below)**:1.11.0rc0\r\n- **Python version**:3.5\r\n- **Bazel version (if compiling from source)**:0.16.1\r\n- **GCC/Compiler version (if compiling from source)**: (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609\r\n- **CUDA/cuDNN version**:N/A\r\n- **GPU model and memory**:N/A\r\n- **Exact command to reproduce**:See below\r\n### Describe the problem\r\nWhen I use tflite,I set ResizeInputTensor different from model, error show:\r\n```\r\ntensorflow/contrib/lite/kernels/reshape.cc:58 num_input_elements != num_output_elements (880 != 440)\r\nNode number 0 (RESHAPE) failed to prepare.\r\n```\r\nfisrt,my net input is [?,440], I convert it by set intput to [1,440]. I want to use it in forward with different size [n,440].Maybe I conert it to tflite wrong?\r\n### Source code / logs\r\n*my code:\r\n```\r\nint main() {\r\n\r\n    // load model\r\n    std::unique_ptr<tflite::FlatBufferModel> model;\r\n    std::unique_ptr<tflite::Interpreter> interpreter;\r\n    model = tflite::FlatBufferModel::BuildFromFile(\"./moble.tflite\");\r\n    if (!model) {\r\n\tcout << \"load model err.\" << endl;\r\n\texit(-1);\r\n    }\r\n\r\n    // build op\r\n    tflite::ops::builtin::BuiltinOpResolver resolver;\r\n\r\n    tflite::InterpreterBuilder (*model, resolver)(&interpreter);\r\n    if (!interpreter) {\r\n\tcout << \"Failed to construct interpreter\\n\" << endl;\r\n\texit(-1);\r\n    }\r\n\r\n    interpreter->UseNNAPI(0);\r\n    interpreter->SetNumThreads(1);\r\n\r\n    // allocate tensors space\r\n    int input = interpreter->inputs()[0];\r\n    interpreter->ResizeInputTensor(input, {2,440});\r\n    if (interpreter->AllocateTensors() != kTfLiteOk) {\r\n\tcout << \"Failed to allocate tensors.\\n\";\r\n\texit(-1);\r\n    }\r\n\r\n    // set input\r\n    float *in = interpreter->typed_tensor<float>(input);\r\n    for (int i = 0; i < 440 * 2; i++) {\r\n\tin[i] = i + 1.0f;\r\n    }\r\n\r\n    // inference\r\n    if (interpreter->Invoke() != kTfLiteOk) {\r\n\tcout << \"Failed to invoke!\\n\";\r\n\texit(-1);\r\n    }\r\n\r\n    // get result\r\n    float *output = interpreter->typed_output_tensor<float>(0);\r\n    for (int i = 0; i < 200; i++) {\r\n\tcout << output[i] << \" \";\r\n    }\r\n    cout << endl;\r\n    return 0;\r\n}\r\n```\r\n* python convert script\r\n** my net\r\n```\r\nbazel run tensorflow/tools/graph_transforms:summarize_graph -- --in_graph=/home/aisp/work_mirror/tensorflow/model/cnn/vocal_print_model/graph_vprint.pb\r\n```\r\nresult\r\n```\r\nFound 1 possible inputs: (name=ac_input, type=float(1), shape=[?,440]) \r\nNo variables spotted.\r\nFound 1 possible outputs: (name=Inference/final_output/output, op=Identity) \r\nFound 382867 (382.87k) const parameters, 0 (0) variable parameters, and 0 control_edges\r\nOp types used: 50 Const, 13 Reshape, 13 Identity, 12 Transpose, 6 BiasAdd, 4 Conv2D, 4 Relu, 3 ConcatV2, 3 Mul, 2 GatherV2, 2 Add, 2 Cast, 2 Prod, 2 Mean, 2 MaxPool, 2 MatMul, 1 Pack, 1 Placeholder, 1 Range, 1 ListDiff, 1 Less, 1 Shape, 1 Sqrt, 1 Sub, 1 GreaterEqual\r\n```\r\n** transform net\r\n```\r\nbazel run tensorflow/tools/graph_transforms:transform_graph -- --in_graph=/home/aisp/work_mirror/tensorflow/model/cnn/vocal_print_model/graph_vprint.pb --out_graph=/home/aisp/work_mirror/tensorflow/model/cnn/vocal_print_model/transformed_graph_simple.pb --inputs='ac_input' --outputs='Inference/final_output/output' --transforms='strip_unused_nodes(type=float,shape=\"1,440\") fold_constants(ingore_errors=true) fold_batch_norms fold_old_batch_norms'\r\n```\r\n** convert to lite\r\n```\r\ntflite_convert   --output_file=$(pwd)/model/cnn/vocal_print_model/moble.tflite  --graph_def_file=$(pwd)/model/cnn/vocal_print_model/transformed_graph_simple.pb   --input_arrays=ac_input   --output_arrays=Inference/final_output/output --input_shapes=1,440\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22369", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22369/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22369/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22369/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22369", "id": 361568488, "node_id": "MDU6SXNzdWUzNjE1Njg0ODg=", "number": 22369, "title": "when use tensorflow to predict images with different resolution,the forward's cost  unstable", "user": {"login": "kasyoukin", "id": 8893270, "node_id": "MDQ6VXNlcjg4OTMyNzA=", "avatar_url": "https://avatars3.githubusercontent.com/u/8893270?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kasyoukin", "html_url": "https://github.com/kasyoukin", "followers_url": "https://api.github.com/users/kasyoukin/followers", "following_url": "https://api.github.com/users/kasyoukin/following{/other_user}", "gists_url": "https://api.github.com/users/kasyoukin/gists{/gist_id}", "starred_url": "https://api.github.com/users/kasyoukin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kasyoukin/subscriptions", "organizations_url": "https://api.github.com/users/kasyoukin/orgs", "repos_url": "https://api.github.com/users/kasyoukin/repos", "events_url": "https://api.github.com/users/kasyoukin/events{/privacy}", "received_events_url": "https://api.github.com/users/kasyoukin/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "reedwm", "id": 6510203, "node_id": "MDQ6VXNlcjY1MTAyMDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6510203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedwm", "html_url": "https://github.com/reedwm", "followers_url": "https://api.github.com/users/reedwm/followers", "following_url": "https://api.github.com/users/reedwm/following{/other_user}", "gists_url": "https://api.github.com/users/reedwm/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedwm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedwm/subscriptions", "organizations_url": "https://api.github.com/users/reedwm/orgs", "repos_url": "https://api.github.com/users/reedwm/repos", "events_url": "https://api.github.com/users/reedwm/events{/privacy}", "received_events_url": "https://api.github.com/users/reedwm/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "reedwm", "id": 6510203, "node_id": "MDQ6VXNlcjY1MTAyMDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6510203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedwm", "html_url": "https://github.com/reedwm", "followers_url": "https://api.github.com/users/reedwm/followers", "following_url": "https://api.github.com/users/reedwm/following{/other_user}", "gists_url": "https://api.github.com/users/reedwm/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedwm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedwm/subscriptions", "organizations_url": "https://api.github.com/users/reedwm/orgs", "repos_url": "https://api.github.com/users/reedwm/repos", "events_url": "https://api.github.com/users/reedwm/events{/privacy}", "received_events_url": "https://api.github.com/users/reedwm/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-09-19T03:55:46Z", "updated_at": "2018-12-16T18:37:16Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:no\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:Linux Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**:binary\r\n- **TensorFlow version (use command below)**:1.10.1\r\n- **Python version**:3.5\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**:9.0/7.1\r\n- **GPU model and memory**:Tesla P4 ,8GB\r\n- **Exact command to reproduce**:no\r\n\r\n### Describe the problem\r\nwhen use tensorflow to predict images with different resolution,the forward's cost  unstable. my image long side is less than 1280 , the resize code below:\r\n```\r\n def resize_im(self, im, scale=600, max_scale=1280): \r\n      f = 1.0\r\n      if scale > min(im.shape[0], im.shape[1]): \r\n        f = float(scale) / min(im.shape[0], im.shape[1]) \r\n      if max_scale != None and f * max(im.shape[0], im.shape[1]) > max_scale: \r\n        f = float(max_scale) / max(im.shape[0], im.shape[1]) \r\n      return cv2.resize(im, None, None, fx=f, fy=f, interpolation=cv2.INTER_LINEAR), f \r\n```\r\n\r\n[use different resolution.txt](https://github.com/tensorflow/tensorflow/files/2395362/use.different.resolution.txt)\r\nsee the net_fw\r\n\r\nwhen padding image to 1280*1280, the forward's cost stable,between 0.25 and 0.3,but the small image will cost more.\r\n\r\nI think it is BFC\u2018s problem.\r\nHow can I solve this problem?I think if tensorflow can lock the chunk's memory (use input image with resolution 1280*1280) for all layers , this problem could be sovled\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22359", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22359/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22359/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22359/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22359", "id": 361484012, "node_id": "MDU6SXNzdWUzNjE0ODQwMTI=", "number": 22359, "title": "Bazel Build all_protos proto_library Support", "user": {"login": "zanes2016", "id": 22779446, "node_id": "MDQ6VXNlcjIyNzc5NDQ2", "avatar_url": "https://avatars0.githubusercontent.com/u/22779446?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zanes2016", "html_url": "https://github.com/zanes2016", "followers_url": "https://api.github.com/users/zanes2016/followers", "following_url": "https://api.github.com/users/zanes2016/following{/other_user}", "gists_url": "https://api.github.com/users/zanes2016/gists{/gist_id}", "starred_url": "https://api.github.com/users/zanes2016/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zanes2016/subscriptions", "organizations_url": "https://api.github.com/users/zanes2016/orgs", "repos_url": "https://api.github.com/users/zanes2016/repos", "events_url": "https://api.github.com/users/zanes2016/events{/privacy}", "received_events_url": "https://api.github.com/users/zanes2016/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-09-18T21:06:12Z", "updated_at": "2018-12-16T18:37:11Z", "closed_at": null, "author_association": "NONE", "body": "I would like to build a `proto_library` for all the protobuf files in (core) tensorflow.\r\n\r\nSpecifically, I need to build the GraphDef protobuf message (and later target it for Golang) and include it in a custom proto definition. However, it seems only cc and py are visible/supported. It does not seem like the general `proto_library` is exposed by the tensorflow repo. Is there a simple way to do this? Ideally there would be a `proto_library` definition that is available in the [core/BUILD file](https://github.com/tensorflow/tensorflow/blob/89e172f6ae5a52f8ceca6b4690331e1dce89d456/tensorflow/core/BUILD).\r\n\r\nWhen I try to execute \"tf_additional_all_protos\" after successfully loading it from build_config.bzl, I get an error saying `no such package 'tensorflow/core'`. \r\n\r\nAny suggestions?\r\n\r\nHave I written custom code\r\n### Bazel Build\r\n```\r\n# bazel build :my_tf_proto\r\nERROR: /Users/zane/dev0/piran/test/BUILD:4:1: no such package 'tensorflow/core': BUILD file not found on package path and referenced by '//:_tensorflow_all_protos'\r\nERROR: Analysis of target '//:my_tf_proto' failed; build aborted: Analysis failed\r\nINFO: Elapsed time: 0.346s\r\nINFO: 0 processes.\r\nFAILED: Build did NOT complete successfully (1 packages loaded)\r\n```\r\n\r\n### Environment\r\nOS Platform and Distribution\r\n```\r\n# bazel version\r\nBuild label: 0.15.2\r\nBuild target: bazel-out/k8-opt/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\r\nBuild time: Tue Jul 17 12:22:40 2018 (1531830160)\r\nBuild timestamp: 1531830160\r\nBuild timestamp as int: 1531830160\r\n#\r\n# lsb_release -a\r\nNo LSB modules are available.\r\nDistributor ID:\tUbuntu\r\nDescription:\tUbuntu 16.04.5 LTS\r\nRelease:\t16.04\r\nCodename:\txenial\r\n```\r\n\r\ntf.proto\r\n```\r\nsyntax = \"proto3\";\r\n\r\npackage mytf;\r\n\r\nimport \"tensorflow/core/framework/graph.proto\";\r\n\r\nmessage MyMessage {\r\n  tensorflow.GraphDef myGraph = 1;\r\n}\r\n```\r\n\r\nWORKSPACE\r\n```\r\n\r\ngit_repository(\r\n    name = \"io_bazel_rules_closure\",\r\n    remote = \"https://github.com/bazelbuild/rules_closure.git\",\r\n    tag = \"0.8.0\",\r\n)\r\n\r\ngit_repository(\r\n    name = \"com_github_tensorflow_tensorflow\",\r\n    remote = \"https://github.com/tensorflow/tensorflow.git\",\r\n    commit = \"0c8a8289da120ee353c4fba5decb0bea9014e0a7\"  # Sep 18, 2018\r\n)\r\nload(\"@com_github_tensorflow_tensorflow//tensorflow:workspace.bzl\", \"tf_workspace\")\r\ntf_workspace()\r\n\r\n```\r\n\r\nBUILD\r\n```\r\npackage(default_visibility = [\"//visibility:public\"])\r\nload(\"@com_github_tensorflow_tensorflow//tensorflow/core:platform/default/build_config.bzl\", \"tf_additional_all_protos\")\r\n\r\nproto_library(\r\n  name = '_tensorflow_all_protos',\r\n  srcs = tf_additional_all_protos(),\r\n)\r\n\r\nproto_library(\r\n\tname = 'my_tf_proto',\r\n\tsrcs = ['tf.proto'],\r\n\tdeps = [':_tensorflow_all_protos'],\r\n)\r\n```\r\n\r\nTensorFlow installed from: N/A\r\nTensorFlow version: N/A\r\nCUDA/cuDNN version: N/A\r\nGPU model and memory: N/A\r\nExact command to reproduce: `bazel build :my_tf_proto`\r\nMobile device: N/A"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22358", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22358/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22358/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22358/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22358", "id": 361479816, "node_id": "MDU6SXNzdWUzNjE0Nzk4MTY=", "number": 22358, "title": "Document how to train with large batch sizes", "user": {"login": "tfboyd", "id": 23486130, "node_id": "MDQ6VXNlcjIzNDg2MTMw", "avatar_url": "https://avatars1.githubusercontent.com/u/23486130?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tfboyd", "html_url": "https://github.com/tfboyd", "followers_url": "https://api.github.com/users/tfboyd/followers", "following_url": "https://api.github.com/users/tfboyd/following{/other_user}", "gists_url": "https://api.github.com/users/tfboyd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tfboyd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tfboyd/subscriptions", "organizations_url": "https://api.github.com/users/tfboyd/orgs", "repos_url": "https://api.github.com/users/tfboyd/repos", "events_url": "https://api.github.com/users/tfboyd/events{/privacy}", "received_events_url": "https://api.github.com/users/tfboyd/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "guptapriya", "id": 14104855, "node_id": "MDQ6VXNlcjE0MTA0ODU1", "avatar_url": "https://avatars1.githubusercontent.com/u/14104855?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guptapriya", "html_url": "https://github.com/guptapriya", "followers_url": "https://api.github.com/users/guptapriya/followers", "following_url": "https://api.github.com/users/guptapriya/following{/other_user}", "gists_url": "https://api.github.com/users/guptapriya/gists{/gist_id}", "starred_url": "https://api.github.com/users/guptapriya/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guptapriya/subscriptions", "organizations_url": "https://api.github.com/users/guptapriya/orgs", "repos_url": "https://api.github.com/users/guptapriya/repos", "events_url": "https://api.github.com/users/guptapriya/events{/privacy}", "received_events_url": "https://api.github.com/users/guptapriya/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "guptapriya", "id": 14104855, "node_id": "MDQ6VXNlcjE0MTA0ODU1", "avatar_url": "https://avatars1.githubusercontent.com/u/14104855?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guptapriya", "html_url": "https://github.com/guptapriya", "followers_url": "https://api.github.com/users/guptapriya/followers", "following_url": "https://api.github.com/users/guptapriya/following{/other_user}", "gists_url": "https://api.github.com/users/guptapriya/gists{/gist_id}", "starred_url": "https://api.github.com/users/guptapriya/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guptapriya/subscriptions", "organizations_url": "https://api.github.com/users/guptapriya/orgs", "repos_url": "https://api.github.com/users/guptapriya/repos", "events_url": "https://api.github.com/users/guptapriya/events{/privacy}", "received_events_url": "https://api.github.com/users/guptapriya/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-09-18T20:54:21Z", "updated_at": "2018-12-19T18:49:51Z", "closed_at": null, "author_association": "MEMBER", "body": "This request was a result of the TensorFlow Fall Symposium. Document tips and methods to use for large batch scaling with TensorFlow.  Possibly mention where this is proven and unproven to work.  This would include adding optimizers or wrapper to simplify usage.  Researchers are large labs want to scale but do not have the knowledge to do it quickly.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22338", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22338/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22338/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22338/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22338", "id": 361148610, "node_id": "MDU6SXNzdWUzNjExNDg2MTA=", "number": 22338, "title": "using bazel to build tensorflow.dll", "user": {"login": "taotaolin", "id": 11807206, "node_id": "MDQ6VXNlcjExODA3MjA2", "avatar_url": "https://avatars3.githubusercontent.com/u/11807206?v=4", "gravatar_id": "", "url": "https://api.github.com/users/taotaolin", "html_url": "https://github.com/taotaolin", "followers_url": "https://api.github.com/users/taotaolin/followers", "following_url": "https://api.github.com/users/taotaolin/following{/other_user}", "gists_url": "https://api.github.com/users/taotaolin/gists{/gist_id}", "starred_url": "https://api.github.com/users/taotaolin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/taotaolin/subscriptions", "organizations_url": "https://api.github.com/users/taotaolin/orgs", "repos_url": "https://api.github.com/users/taotaolin/repos", "events_url": "https://api.github.com/users/taotaolin/events{/privacy}", "received_events_url": "https://api.github.com/users/taotaolin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "meteorcloudy", "id": 4171702, "node_id": "MDQ6VXNlcjQxNzE3MDI=", "avatar_url": "https://avatars2.githubusercontent.com/u/4171702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/meteorcloudy", "html_url": "https://github.com/meteorcloudy", "followers_url": "https://api.github.com/users/meteorcloudy/followers", "following_url": "https://api.github.com/users/meteorcloudy/following{/other_user}", "gists_url": "https://api.github.com/users/meteorcloudy/gists{/gist_id}", "starred_url": "https://api.github.com/users/meteorcloudy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/meteorcloudy/subscriptions", "organizations_url": "https://api.github.com/users/meteorcloudy/orgs", "repos_url": "https://api.github.com/users/meteorcloudy/repos", "events_url": "https://api.github.com/users/meteorcloudy/events{/privacy}", "received_events_url": "https://api.github.com/users/meteorcloudy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "meteorcloudy", "id": 4171702, "node_id": "MDQ6VXNlcjQxNzE3MDI=", "avatar_url": "https://avatars2.githubusercontent.com/u/4171702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/meteorcloudy", "html_url": "https://github.com/meteorcloudy", "followers_url": "https://api.github.com/users/meteorcloudy/followers", "following_url": "https://api.github.com/users/meteorcloudy/following{/other_user}", "gists_url": "https://api.github.com/users/meteorcloudy/gists{/gist_id}", "starred_url": "https://api.github.com/users/meteorcloudy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/meteorcloudy/subscriptions", "organizations_url": "https://api.github.com/users/meteorcloudy/orgs", "repos_url": "https://api.github.com/users/meteorcloudy/repos", "events_url": "https://api.github.com/users/meteorcloudy/events{/privacy}", "received_events_url": "https://api.github.com/users/meteorcloudy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 66, "created_at": "2018-09-18T06:07:29Z", "updated_at": "2020-02-24T10:09:19Z", "closed_at": null, "author_association": "NONE", "body": "i try using bazel to build on windows, but tips:\r\n\r\n**Have I written custom code** No\r\n**OS Platform and Distribution** WIN7 Visual Studio 2015\r\n**TensorFlow installed from** source master\r\n**Bazel version** 0.17.1\r\n**CUDA/cuDNN version** CUDA9.0 / CUDNN 7.2.1\r\n**GPU model and memory** 1080Ti / 11G\r\n**Mobile device** N/A\r\n**Exact command to reproduce**\r\n1. python ./configure.py\r\n```\r\nWARNING: An illegal reflective access operation has occurred\r\nWARNING: Illegal reflective access by com.google.protobuf.UnsafeUtil (file:/C:/U\r\nsers/tao/_bazel_tao/install/360a69cc0fef41d83a4dd948c0474ca5/_embedded_binaries/\r\nA-server.jar) to field java.lang.String.value\r\nWARNING: Please consider reporting this to the maintainers of com.google.protobu\r\nf.UnsafeUtil\r\nWARNING: Use --illegal-access=warn to enable warnings of further illegal reflect\r\nive access operations\r\nWARNING: All illegal access operations will be denied in a future release\r\nWARNING: --batch mode is deprecated. Please instead explicitly shut down your Ba\r\nzel server using the command \"bazel shutdown\".\r\nYou have bazel 0.17.1 installed.\r\nPlease specify the location of python. [Default is C:\\Users\\tao\\AppData\\Local\\Pr\r\nograms\\Python\\Python35\\python.exe]:\r\n\r\nFound possible Python library paths:\r\n  C:\\Users\\tao\\AppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages\r\nPlease input the desired Python library path to use.  Default is [C:\\Users\\tao\\A\r\nppData\\Local\\Programs\\Python\\Python35\\lib\\site-packages]\r\n\r\nDo you wish to build TensorFlow with nGraph support? [y/N]:\r\nNo nGraph support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with CUDA support? [y/N]: y\r\nCUDA support will be enabled for TensorFlow.\r\n\r\nPlease specify the CUDA SDK version you want to use. [Leave empty to default to\r\nCUDA 9.0]:\r\n\r\nPlease specify the location where CUDA 9.0 toolkit is installed. Refer to README\r\n.md for more details. [Default is C:/Program Files/NVIDIA GPU Computing Toolkit/\r\nCUDA/v9.0]:\r\n\r\n\r\nPlease specify the cuDNN version you want to use. [Leave empty to default to cuD\r\nNN 7.0]:\r\n\r\n\r\nPlease specify the location where cuDNN 7 library is installed. Refer to README.\r\nmd for more details. [Default is C:/Program Files/NVIDIA GPU Computing Toolkit/C\r\nUDA/v9.0]:\r\n\r\nPlease specify a list of comma-separated Cuda compute capabilities you want to b\r\nuild with.\r\nYou can find the compute capability of your device at: https://developer.nvidia.\r\ncom/cuda-gpus.\r\nPlease note that each additional compute capability significantly increases your\r\n build time and binary size. [Default is: 3.5,7.0]:\r\n\r\nPlease specify optimization flags to use during compilation when bazel option \"-\r\n-config=opt\" is specified [Default is /arch:AVX]:\r\n\r\nWould you like to override eigen strong inline for some C++ compilation to reduc\r\ne the compilation time? [Y/n]:\r\nEigen strong inline overridden.\r\n```\r\n\r\n\r\n2.bazel build --config=opt --config=cuda //tensorflow:libtensorflow.so\r\n```\r\nbazel build --config=opt --config=cuda //tensorflow:libtensorflow.so will be generated tensorflow.so and tensorflow.lib ?\r\n```\r\nThen rename the libtensorflow.so to tensorflow.dll, it can be work? @meteorcloudy"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22336", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22336/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22336/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22336/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22336", "id": 361134300, "node_id": "MDU6SXNzdWUzNjExMzQzMDA=", "number": 22336, "title": "ssd_mobilenet_v1_quantized_300x300_coco14_sync's mAP=0", "user": {"login": "cococyx", "id": 30077786, "node_id": "MDQ6VXNlcjMwMDc3Nzg2", "avatar_url": "https://avatars3.githubusercontent.com/u/30077786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cococyx", "html_url": "https://github.com/cococyx", "followers_url": "https://api.github.com/users/cococyx/followers", "following_url": "https://api.github.com/users/cococyx/following{/other_user}", "gists_url": "https://api.github.com/users/cococyx/gists{/gist_id}", "starred_url": "https://api.github.com/users/cococyx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cococyx/subscriptions", "organizations_url": "https://api.github.com/users/cococyx/orgs", "repos_url": "https://api.github.com/users/cococyx/repos", "events_url": "https://api.github.com/users/cococyx/events{/privacy}", "received_events_url": "https://api.github.com/users/cococyx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "achowdhery", "id": 4723042, "node_id": "MDQ6VXNlcjQ3MjMwNDI=", "avatar_url": "https://avatars3.githubusercontent.com/u/4723042?v=4", "gravatar_id": "", "url": "https://api.github.com/users/achowdhery", "html_url": "https://github.com/achowdhery", "followers_url": "https://api.github.com/users/achowdhery/followers", "following_url": "https://api.github.com/users/achowdhery/following{/other_user}", "gists_url": "https://api.github.com/users/achowdhery/gists{/gist_id}", "starred_url": "https://api.github.com/users/achowdhery/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/achowdhery/subscriptions", "organizations_url": "https://api.github.com/users/achowdhery/orgs", "repos_url": "https://api.github.com/users/achowdhery/repos", "events_url": "https://api.github.com/users/achowdhery/events{/privacy}", "received_events_url": "https://api.github.com/users/achowdhery/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "achowdhery", "id": 4723042, "node_id": "MDQ6VXNlcjQ3MjMwNDI=", "avatar_url": "https://avatars3.githubusercontent.com/u/4723042?v=4", "gravatar_id": "", "url": "https://api.github.com/users/achowdhery", "html_url": "https://github.com/achowdhery", "followers_url": "https://api.github.com/users/achowdhery/followers", "following_url": "https://api.github.com/users/achowdhery/following{/other_user}", "gists_url": "https://api.github.com/users/achowdhery/gists{/gist_id}", "starred_url": "https://api.github.com/users/achowdhery/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/achowdhery/subscriptions", "organizations_url": "https://api.github.com/users/achowdhery/orgs", "repos_url": "https://api.github.com/users/achowdhery/repos", "events_url": "https://api.github.com/users/achowdhery/events{/privacy}", "received_events_url": "https://api.github.com/users/achowdhery/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2018-09-18T04:48:18Z", "updated_at": "2018-12-15T18:41:32Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\n- **OS Platform Ubuntu 16.04\r\n- **TensorFlow installed from source: models's commit = 55d55abc71483723743c0273b9c1fd8e0c7d8391 and tensorflow's commit = 6c3e1f4bc803f2dc8a804f4f15ada0eda6c90a18\r\n- **TensorFlow version **:1.9.0\r\n- **Python version**:Python 3.5.2 (default, Nov 23 2017, 16:37:01)\r\n- **Bazel version (if compiling from source)**: 0.11.1\r\n- **GCC/Compiler version (if compiling from source)**: gcc (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609\r\n- **CUDA/cuDNN version**: Cuda compilation tools, release 9.0, V9.0.176;cuDNN7.0\r\n- **GPU model and memory**: GeForce GTX 1070 Ti  * 4\r\n- **Exact command to reproduce**:\r\npython object_detection/model_main.py --pipeline_config_path=./object_detection/samples/configs/ssd_mobilenet_v1_quantized_300x300_coco14_sync.config  --model_dir=/checkpoint/ssd_mobilenet_v1_quantized_300x300_coco14_sync --checkpoint_dir=/ssd/ssd_mobilenet_v1_quantized_300x300_coco14_sync_2018_07_18 --run_once=True\r\n\r\n### Describe the problem\r\n0.\r\ntrain\t\t118287\r\nwget -c http://images.cocodataset.org/zips/train2017.zip \r\nwget -c http://images.cocodataset.org/annotations/annotations_trainval2017.zip\r\neval\t\t5000\r\nwget -c http://images.cocodataset.org/zips/val2017.zip \r\nwget -c http://images.cocodataset.org/annotations/stuff_annotations_trainval2017.zip\r\n1\r\nDownload checkpoint in http://download.tensorflow.org/models/object_detection/ssd_mobilenet_v1_quantized_300x300_coco14_sync_2018_07_18.tar.gz\r\n2\r\nAmend file's path in models/object_detection/samples/configs/ssd_mobilenet_v1_quantized_300x300_coco14_sync.config\r\n3.\r\nfrom models/research,\r\npython object_detection/model_main.py --pipeline_config_path=./object_detection/samples/configs/ssd_mobilenet_v1_quantized_300x300_coco14_sync.config  --model_dir=/checkpoint/ssd_mobilenet_v1_quantized_300x300_coco14_sync --checkpoint_dir=/ssd/ssd_mobilenet_v1_quantized_300x300_coco14_sync_2018_07_18 --run_once=True\r\n\r\n### Source code / logs\r\n1\r\n[ssd_mobilenet_v1_quantized_300x300_coco14_sync.zip](https://github.com/tensorflow/tensorflow/files/2391202/ssd_mobilenet_v1_quantized_300x300_coco14_sync.zip)\r\n2\r\n[ssd_mobilenet_v1_quantized_300x300_coco14_sync_log.txt](https://github.com/tensorflow/tensorflow/files/2391211/ssd_mobilenet_v1_quantized_300x300_coco14_sync_log.txt)\r\n\r\n\r\n\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22330", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22330/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22330/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22330/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22330", "id": 361033418, "node_id": "MDU6SXNzdWUzNjEwMzM0MTg=", "number": 22330, "title": "Eigenvalue decomposition of asymmetric matrices", "user": {"login": "mbrubake", "id": 3383416, "node_id": "MDQ6VXNlcjMzODM0MTY=", "avatar_url": "https://avatars0.githubusercontent.com/u/3383416?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mbrubake", "html_url": "https://github.com/mbrubake", "followers_url": "https://api.github.com/users/mbrubake/followers", "following_url": "https://api.github.com/users/mbrubake/following{/other_user}", "gists_url": "https://api.github.com/users/mbrubake/gists{/gist_id}", "starred_url": "https://api.github.com/users/mbrubake/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mbrubake/subscriptions", "organizations_url": "https://api.github.com/users/mbrubake/orgs", "repos_url": "https://api.github.com/users/mbrubake/repos", "events_url": "https://api.github.com/users/mbrubake/events{/privacy}", "received_events_url": "https://api.github.com/users/mbrubake/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-09-17T20:36:00Z", "updated_at": "2018-12-19T18:49:42Z", "closed_at": null, "author_association": "NONE", "body": "There is no general eigenvalue decomposition available in TensorFlow.  ```tf.self_adjoint_eig``` currently only supports self-adjoint matrices.  A full implementation of the eigenvalue decomposition for more general (diagonalizable) matrices could be very useful.  Even a version without gradients would be helpful.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22325", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22325/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22325/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22325/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22325", "id": 361009284, "node_id": "MDU6SXNzdWUzNjEwMDkyODQ=", "number": 22325, "title": "bazel build tensorflow on windows 10 getting cudnn.h- system cannot find the file specified", "user": {"login": "rcorvus", "id": 5025458, "node_id": "MDQ6VXNlcjUwMjU0NTg=", "avatar_url": "https://avatars2.githubusercontent.com/u/5025458?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rcorvus", "html_url": "https://github.com/rcorvus", "followers_url": "https://api.github.com/users/rcorvus/followers", "following_url": "https://api.github.com/users/rcorvus/following{/other_user}", "gists_url": "https://api.github.com/users/rcorvus/gists{/gist_id}", "starred_url": "https://api.github.com/users/rcorvus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rcorvus/subscriptions", "organizations_url": "https://api.github.com/users/rcorvus/orgs", "repos_url": "https://api.github.com/users/rcorvus/repos", "events_url": "https://api.github.com/users/rcorvus/events{/privacy}", "received_events_url": "https://api.github.com/users/rcorvus/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586558, "node_id": "MDU6TGFiZWw0MDQ1ODY1NTg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:community%20support", "name": "stat:community support", "color": "f4b400", "default": false, "description": ""}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2018-09-17T19:28:01Z", "updated_at": "2019-08-06T10:35:28Z", "closed_at": null, "author_association": "NONE", "body": "From stackoverflow:\r\n\r\nhttps://stackoverflow.com/questions/52335703/bazel-build-tensorflow-on-windows-10-getting-cudnn-h-system-cannot-find-the-fil\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Windows 10\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: N/A\r\n- **TensorFlow installed from (source or binary)**: 1.11.0\r\n- **TensorFlow version (use command below)**:  \r\n- **Python version**: 3.6.5\r\n- **Bazel version (if compiling from source)**: 0.16.0\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**:  9.2/7.2.1\r\n- **GPU model and memory**: Nvidia M1000M\r\n- **Exact command to reproduce**:\r\n\r\nAdditional information:\r\nI've added these to my path (and rebooted):\r\nC:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.2\\bin\r\nC:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.2\\libnvvp\r\nC:\\tools\\msys64\r\nC:\\tools\\bazel\r\nC:\\tools\\bazel\\bazel.exe\r\nC:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.2\\extras\\CUPTI\\libx64\r\n\r\nThese are the system variables I've set:\r\nBAZEL_SH  C:\\tools\\msys64\\usr\\bin\\bash.exe\r\nBAZEL_VC  C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\r\nBAZEL_VS  C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\r\n\r\n### Describe the problem\r\nI keep getting this error when trying to build the tensorflow-gpu using bazel and python in Windows 10:\r\n\r\nCuda Configuration Error: Error reading C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v9.2/cuda/include/cudnn.h: ja\r\nva.io.IOException: ERROR: src/main/native/windows/processes-jni.cc(239): CreateProcessW(\"grep\" --color=never -A1 -E \"#de\r\nfine CUDNN_MAJOR\" \"C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v9.2/cuda/include/cudnn.h\"): The system cannot fin\r\nd the file specified.\r\nThis is the command I'm trying to run:\r\nbazel build --config=opt //tensorflow/tools/pip_package:build_pip_package\r\n\r\nI've confirmed the C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v9.2/cuda/include/cudnn.h is there.\r\n\r\nI've tried running it from VS2015 x64 Native Tools Command Prompt, cmd, and powershell and get the same error.\r\n\r\nI'm using bazel 0.16.1, CUDA 9.2, Anaconda3 (Python 3.6.5), and CUDNN 7.2.1. I \"installed\" the CUDDNN files by unzipping its cuda folder into my C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.2 folder (i.e. the whole \"cuda\" folder). I specified the C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.2\\cuda path in the cudnn path question when I ran the configure.py. The configure.py completes without error.\r\n\r\nI also tried putting the CUDNN files directly in the C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v9.2 folder (instead of a cuda folder in there) and specified the default location and still get basically the same error: \"C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v9.2/include/cudnn.h\": The system cannot find the file specified.\r\n\r\nThis is the full error:\r\n\r\nERROR: Skipping '//tensorflow/tools/pip_package:build_pip_package': error loading package 'tensorflow/tools/pip_package'\r\n: Encountered error while reading extension file 'cuda/build_defs.bzl': no such package '@local_config_cuda//cuda': Trac\r\neback (most recent call last):\r\n        File \"C:/tensorflow/third_party/gpus/cuda_configure.bzl\", line 1458\r\n                _create_local_cuda_repository(repository_ctx)\r\n        File \"C:/tensorflow/third_party/gpus/cuda_configure.bzl\", line 1185, in _create_local_cuda_repository\r\n                _get_cuda_config(repository_ctx)\r\n        File \"C:/tensorflow/third_party/gpus/cuda_configure.bzl\", line 909, in _get_cuda_config\r\n                _cudnn_version(repository_ctx, cudnn_install_base..., ...)\r\n        File \"C:/tensorflow/third_party/gpus/cuda_configure.bzl\", line 584, in _cudnn_version\r\n                find_cuda_define(repository_ctx, cudnn_header_dir, \"c...\", ...)\r\n        File \"C:/tensorflow/third_party/gpus/cuda_configure.bzl\", line 534, in find_cuda_define\r\n                auto_configure_fail((\"Error reading %s: %s\" % (str(h...)))\r\n        File \"C:/tensorflow/third_party/gpus/cuda_configure.bzl\", line 315, in auto_configure_fail\r\n                fail((\"\\n%sCuda Configuration Error:%...)))\r\n\r\nCuda Configuration Error: Error reading C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v9.2/cuda/include/cudnn.h: ja\r\nva.io.IOException: ERROR: src/main/native/windows/processes-jni.cc(239): CreateProcessW(\"grep\" --color=never -A1 -E \"#de\r\nfine CUDNN_MAJOR\" \"C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v9.2/cuda/include/cudnn.h\"): The system cannot fin\r\nd the file specified.\r\n\r\nWARNING: Target pattern parsing failed.\r\nERROR: error loading package 'tensorflow/tools/pip_package': Encountered error while reading extension file 'cuda/build_\r\ndefs.bzl': no such package '@local_config_cuda//cuda': Traceback (most recent call last):\r\n        File \"C:/tensorflow/third_party/gpus/cuda_configure.bzl\", line 1458\r\n                _create_local_cuda_repository(repository_ctx)\r\n        File \"C:/tensorflow/third_party/gpus/cuda_configure.bzl\", line 1185, in _create_local_cuda_repository\r\n                _get_cuda_config(repository_ctx)\r\n        File \"C:/tensorflow/third_party/gpus/cuda_configure.bzl\", line 909, in _get_cuda_config\r\n                _cudnn_version(repository_ctx, cudnn_install_base..., ...)\r\n        File \"C:/tensorflow/third_party/gpus/cuda_configure.bzl\", line 584, in _cudnn_version\r\n                find_cuda_define(repository_ctx, cudnn_header_dir, \"c...\", ...)\r\n        File \"C:/tensorflow/third_party/gpus/cuda_configure.bzl\", line 534, in find_cuda_define\r\n                auto_configure_fail((\"Error reading %s: %s\" % (str(h...)))\r\n        File \"C:/tensorflow/third_party/gpus/cuda_configure.bzl\", line 315, in auto_configure_fail\r\n                fail((\"\\n%sCuda Configuration Error:%...)))\r\n\r\nCuda Configuration Error: Error reading C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v9.2/cuda/include/cudnn.h: ja\r\nva.io.IOException: ERROR: src/main/native/windows/processes-jni.cc(239): CreateProcessW(\"grep\" --color=never -A1 -E \"#de\r\nfine CUDNN_MAJOR\" \"C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v9.2/cuda/include/cudnn.h\"): The system cannot fin\r\nd the file specified.\r\n\r\n\r\n### Source code / logs\r\nSolution/workaround is:\r\n\r\nThe problem is a bug in cuda_configure.bzl: it uses ctx.execute instead of ctx.action.run_shell.\r\nTo work around it: add c:\\tools\\msys64\\usr\\bin to your PATH. That's where grep.exe is so ctx.execute can find grep on the PATH.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22304", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22304/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22304/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22304/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22304", "id": 360709968, "node_id": "MDU6SXNzdWUzNjA3MDk5Njg=", "number": 22304, "title": "C++   set_allow_soft_placement does not work", "user": {"login": "xu-song", "id": 13825126, "node_id": "MDQ6VXNlcjEzODI1MTI2", "avatar_url": "https://avatars3.githubusercontent.com/u/13825126?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xu-song", "html_url": "https://github.com/xu-song", "followers_url": "https://api.github.com/users/xu-song/followers", "following_url": "https://api.github.com/users/xu-song/following{/other_user}", "gists_url": "https://api.github.com/users/xu-song/gists{/gist_id}", "starred_url": "https://api.github.com/users/xu-song/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xu-song/subscriptions", "organizations_url": "https://api.github.com/users/xu-song/orgs", "repos_url": "https://api.github.com/users/xu-song/repos", "events_url": "https://api.github.com/users/xu-song/events{/privacy}", "received_events_url": "https://api.github.com/users/xu-song/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "reedwm", "id": 6510203, "node_id": "MDQ6VXNlcjY1MTAyMDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6510203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedwm", "html_url": "https://github.com/reedwm", "followers_url": "https://api.github.com/users/reedwm/followers", "following_url": "https://api.github.com/users/reedwm/following{/other_user}", "gists_url": "https://api.github.com/users/reedwm/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedwm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedwm/subscriptions", "organizations_url": "https://api.github.com/users/reedwm/orgs", "repos_url": "https://api.github.com/users/reedwm/repos", "events_url": "https://api.github.com/users/reedwm/events{/privacy}", "received_events_url": "https://api.github.com/users/reedwm/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "reedwm", "id": 6510203, "node_id": "MDQ6VXNlcjY1MTAyMDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6510203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedwm", "html_url": "https://github.com/reedwm", "followers_url": "https://api.github.com/users/reedwm/followers", "following_url": "https://api.github.com/users/reedwm/following{/other_user}", "gists_url": "https://api.github.com/users/reedwm/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedwm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedwm/subscriptions", "organizations_url": "https://api.github.com/users/reedwm/orgs", "repos_url": "https://api.github.com/users/reedwm/repos", "events_url": "https://api.github.com/users/reedwm/events{/privacy}", "received_events_url": "https://api.github.com/users/reedwm/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2018-09-17T03:02:13Z", "updated_at": "2019-11-20T02:57:48Z", "closed_at": null, "author_association": "NONE", "body": "\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\n- **OS Platform and Distribution: Mac  CPU\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: 1.8.0\r\n- **Python version**: 2.7\r\n\r\n### Describe the problem\r\n\r\nI have set set_allow_soft_placement(true), but it does not work.\r\n\r\n\r\n\r\n### Source code / logs\r\n\r\n\r\nc++ source code\r\n```c++\r\n    const string pathToGraph = \u201ctf/checkpoint/model-1.meta\";\r\n\r\n    tensorflow::SessionOptions options;\r\n    options.config.set_allow_soft_placement(true);  // why this does not work?\r\n    auto session = NewSession(options);\r\n\r\n    Status status = session->Create(graph_def.graph_def());\r\n\r\n```\r\n\r\nIt get errors in my mac(cpu),  no error in GPU.\r\n\r\n```sh\r\n./eval\r\nlibc++abi.dylib: terminating with uncaught exception of type std::runtime_error: \r\nError creating graph: Invalid argument: Cannot assign a device for \r\noperation 'ExponentialMovingAverage/AssignMovingAvg_5/sub': \r\nOperation was explicitly assigned to /device:GPU:0 but available devices are \r\n[ /job:localhost/replica:0/task:0/device:CPU:0 ]. \r\nMake sure the device specification refers to a valid device.\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22298", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22298/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22298/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22298/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22298", "id": 360646147, "node_id": "MDU6SXNzdWUzNjA2NDYxNDc=", "number": 22298, "title": "Can't initialize keras.Model based network with tf.train.init_from_chekpoint", "user": {"login": "jrabary", "id": 1025387, "node_id": "MDQ6VXNlcjEwMjUzODc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1025387?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jrabary", "html_url": "https://github.com/jrabary", "followers_url": "https://api.github.com/users/jrabary/followers", "following_url": "https://api.github.com/users/jrabary/following{/other_user}", "gists_url": "https://api.github.com/users/jrabary/gists{/gist_id}", "starred_url": "https://api.github.com/users/jrabary/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jrabary/subscriptions", "organizations_url": "https://api.github.com/users/jrabary/orgs", "repos_url": "https://api.github.com/users/jrabary/repos", "events_url": "https://api.github.com/users/jrabary/events{/privacy}", "received_events_url": "https://api.github.com/users/jrabary/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2018-09-16T14:47:21Z", "updated_at": "2018-12-19T18:49:33Z", "closed_at": null, "author_association": "NONE", "body": "\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**:\r\n- **TensorFlow version (use command below)**: git master\r\n- **Python version**: 3.6\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**:\r\n- **GPU model and memory**:\r\n- **Exact command to reproduce**:\r\n\r\nYou can collect some of this information using our environment capture script:\r\n\r\nhttps://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh\r\n\r\nYou can obtain the TensorFlow version with\r\n\r\npython -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"\r\n\r\n### Describe the problem\r\n\r\nWe are trying use `tf.keras.Model` as a base class for our neural network. So far, with `slim` based network we have used `tf.train.init_from_checkpoint` to warm start the training.\r\nBut, it seems that the current version of `tf.train.init_from_checkpoint` doesn't play well with `keras.Model`. Probably because under the hood, `tf.train.init_from_checkpoint` calls `variable_scope._get_defautl_variable_store()` which doesn't know variables created with keras objects.\r\n\r\nBelow a snippet of code to illustrate this problem\r\n\r\n### Source code / logs\r\n\r\n```\r\nimport tensorflow as tf\r\n\r\nfrom tensorflow.python.ops import variable_scope as vs\r\n\r\nnet = tf.keras.Sequential([\r\n    tf.keras.layers.Dense(10, name='fc1')\r\n])\r\n\r\nx = tf.random_uniform([10, 3])\r\ny = net(x)\r\n\r\n# all variable are created \r\nvars = tf.get_collection(tf.GraphKeys.TRAINABLE_VARIABLES)\r\nfor v in vars:\r\n    print(v.name)\r\n\r\n# but variable scope doesn't see them\r\n# then no variable to initialize for tf.train.init_from_checkpoint\r\nvar_store = vs._get_default_variable_store()._vars\r\nprint(var_store)\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22291", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22291/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22291/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22291/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22291", "id": 360522742, "node_id": "MDU6SXNzdWUzNjA1MjI3NDI=", "number": 22291, "title": "vgg16  transfer learning will be error \"TypeError: provided list of inputs contains objects other than 'EagerTensor'\"", "user": {"login": "Q82822", "id": 36806042, "node_id": "MDQ6VXNlcjM2ODA2MDQy", "avatar_url": "https://avatars2.githubusercontent.com/u/36806042?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Q82822", "html_url": "https://github.com/Q82822", "followers_url": "https://api.github.com/users/Q82822/followers", "following_url": "https://api.github.com/users/Q82822/following{/other_user}", "gists_url": "https://api.github.com/users/Q82822/gists{/gist_id}", "starred_url": "https://api.github.com/users/Q82822/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Q82822/subscriptions", "organizations_url": "https://api.github.com/users/Q82822/orgs", "repos_url": "https://api.github.com/users/Q82822/repos", "events_url": "https://api.github.com/users/Q82822/events{/privacy}", "received_events_url": "https://api.github.com/users/Q82822/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 736653459, "node_id": "MDU6TGFiZWw3MzY2NTM0NTk=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:eager", "name": "comp:eager", "color": "0052cc", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "akshaym", "id": 122911, "node_id": "MDQ6VXNlcjEyMjkxMQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/122911?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akshaym", "html_url": "https://github.com/akshaym", "followers_url": "https://api.github.com/users/akshaym/followers", "following_url": "https://api.github.com/users/akshaym/following{/other_user}", "gists_url": "https://api.github.com/users/akshaym/gists{/gist_id}", "starred_url": "https://api.github.com/users/akshaym/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akshaym/subscriptions", "organizations_url": "https://api.github.com/users/akshaym/orgs", "repos_url": "https://api.github.com/users/akshaym/repos", "events_url": "https://api.github.com/users/akshaym/events{/privacy}", "received_events_url": "https://api.github.com/users/akshaym/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "akshaym", "id": 122911, "node_id": "MDQ6VXNlcjEyMjkxMQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/122911?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akshaym", "html_url": "https://github.com/akshaym", "followers_url": "https://api.github.com/users/akshaym/followers", "following_url": "https://api.github.com/users/akshaym/following{/other_user}", "gists_url": "https://api.github.com/users/akshaym/gists{/gist_id}", "starred_url": "https://api.github.com/users/akshaym/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akshaym/subscriptions", "organizations_url": "https://api.github.com/users/akshaym/orgs", "repos_url": "https://api.github.com/users/akshaym/repos", "events_url": "https://api.github.com/users/akshaym/events{/privacy}", "received_events_url": "https://api.github.com/users/akshaym/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-09-15T09:07:29Z", "updated_at": "2018-12-19T18:49:29Z", "closed_at": null, "author_association": "NONE", "body": "\r\n### System information\r\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):Linux Ubuntu 16.04\r\nMobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\nTensorFlow installed from (source or binary): source\r\nTensorFlow version (use command below): 1.11.0 (use tf-night-gpu)\r\nPython version:2.7\r\nBazel version (if compiling from source):\r\nGCC/Compiler version (if compiling from source):\r\nCUDA/cuDNN version: 9.0 /7.1\r\nGPU model and memory:\r\nExact command to reproduce:\r\n\r\n### Describe the problem\r\nvgg16  used to `transfer learning ` and data `cocodataset 2014`  and it will be error `TypeError: provided list of inputs contains objects other than 'EagerTensor'. Item 0 is Tensor`  but use` InceptionV3` it is can work. \r\n\r\n### Source code / logs\r\nthis is my code.  the cocodataset need to download 3 hours,  \r\nif vgg16  change to InceptionV3, it is can work\r\n```\r\nimport tensorflow as tf\r\ntf.enable_eager_execution()\r\n\r\n# We'll generate plots of attention in order to see which parts of an image\r\n# our model focuses on during captioning\r\nimport matplotlib.pyplot as plt\r\n#import inception_v4 \r\n# Scikit-learn includes many helpful utilities\r\nfrom sklearn.model_selection import train_test_split\r\nfrom sklearn.utils import shuffle\r\nimport time\r\nimport re\r\nimport numpy as np\r\nimport os\r\nimport time\r\nimport json\r\nfrom glob import glob\r\nfrom PIL import Image\r\nimport pickle\r\n\r\nannotation_zip = tf.keras.utils.get_file('captions.zip', \r\n                                          cache_subdir=os.path.abspath('.'),\r\n                                          origin = 'http://images.cocodataset.org/annotations/annotations_trainval2014.zip',\r\n                                          extract = True)\r\nannotation_file = os.path.dirname(annotation_zip)+'/annotations/captions_train2014.json'\r\n\r\nname_of_zip = 'train2014.zip'\r\nif not os.path.exists(os.path.abspath('.') + '/' + name_of_zip):\r\n    image_zip = tf.keras.utils.get_file(name_of_zip, \r\n                                      cache_subdir=os.path.abspath('.'),\r\n                                      origin = 'http://images.cocodataset.org/zips/train2014.zip',\r\n                                      extract = True)\r\n    PATH = os.path.dirname(image_zip)+'/train2014/'\r\nelse:\r\n    PATH = os.path.abspath('.')+'/train2014/'\r\n\r\n\r\n# read the json file# read  \r\nwith open(annotation_file, 'r') as f:\r\n    annotations = json.load(f)\r\n\r\n# storing the captions and the image name in vectors\r\nall_captions = []\r\nall_img_name_vector = []\r\n\r\nfor annot in annotations['annotations']:\r\n    caption = '<start> ' + annot['caption'] + ' <end>'\r\n    image_id = annot['image_id']\r\n    full_coco_image_path = PATH + 'COCO_train2014_' + '%012d.jpg' % (image_id)\r\n    \r\n    all_img_name_vector.append(full_coco_image_path)\r\n    all_captions.append(caption)\r\n\r\ntrain_captions, img_name_vector = shuffle(all_captions,\r\n                                          all_img_name_vector,\r\n                                          random_state=1)\r\n\r\n# selecting the first 30000 captions from the shuffled set\r\nnum_examples = 30000\r\n\r\ndef load_image(image_path):\r\n    img = tf.read_file(image_path)\r\n    img = tf.image.decode_jpeg(img, channels=3)\r\n    img = tf.image.resize_images(img, (224, 224))\r\n    img = tf.keras.applications.vgg16.preprocess_input(x = img)\r\n    return img, image_path\r\n\r\nimage_model = tf.keras.applications.vgg16.VGG16(include_top=False, weights='imagenet')\r\nnew_input = image_model.input\r\nhidden_layer = image_model.layers[-1].output\r\nimage_features_extract_model = tf.keras.Model(new_input, hidden_layer)\r\n\r\nstartTime=time.time()\r\n# getting the unique images\r\nencode_train = sorted(set(img_name_vector))\r\n\r\n# feel free to change the batch_size according to your system configuration\r\nimage_dataset = tf.data.Dataset.from_tensor_slices(\r\n                                encode_train).map(load_image).batch(16)\r\n\r\nfor img, path in image_dataset:\r\n    batch_features_0 = image_features_extract_model(img)\r\n  \r\n    batch_features = tf.reshape(batch_features_0, (batch_features_0.shape[0], -1, batch_features_0.shape[3]))\r\n    Nan = np.any(np.isnan(batch_features))\r\n\r\n    for bf, p in zip(batch_features, path):\r\n\r\n        path_of_feature = p.numpy().decode(\"utf-8\")\r\n        np.save(path_of_feature, bf.numpy())\r\n\r\n### test image\r\nimage = './COCO_val2014_000000000042.jpg'\r\nprint(load_image(image))\r\n```\r\nthe error output\r\n```\r\n_FallbackException                        Traceback (most recent call last)\r\n/home/ailab/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_array_ops.py in reshape(tensor, shape, name)\r\n   6211         _ctx._context_handle, _ctx._eager_context.device_name, \"Reshape\",\r\n-> 6212         name, _ctx._post_execution_callbacks, tensor, shape)\r\n   6213       return _result\r\n\r\n_FallbackException: This function does not handle the case of the path where all inputs are not already EagerTensors.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-7-90810626227a> in <module>()\r\n      1 image = './COCO_val2014_000000000042.jpg'\r\n----> 2 print(type(load_image(image)))\r\n      3 print(len(load_image(image)))\r\n      4 print(load_image(image))\r\n\r\n<ipython-input-4-34a6a48d497c> in load_image(image_path)\r\n      8     #img = tf.keras.applications.inception_v3.preprocess_input(img)\r\n      9     #img = inception_v4.preprocess_input(img)\r\n---> 10     img = tf.keras.applications.vgg16.preprocess_input(x = img)\r\n     11     return img, image_path\r\n\r\n/home/ailab/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/applications/imagenet_utils.py in preprocess_input(x, data_format, mode)\r\n    197     return _preprocess_numpy_input(x, data_format=data_format, mode=mode)\r\n    198   else:\r\n--> 199     return _preprocess_symbolic_input(x, data_format=data_format, mode=mode)\r\n    200 \r\n    201 \r\n\r\n/home/ailab/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/applications/imagenet_utils.py in _preprocess_symbolic_input(x, data_format, mode)\r\n    160     x = K.bias_add(x, math_ops.cast(_IMAGENET_MEAN, K.dtype(x)), data_format)\r\n    161   else:\r\n--> 162     x = K.bias_add(x, _IMAGENET_MEAN, data_format)\r\n    163   if std is not None:\r\n    164     x /= std\r\n\r\n/home/ailab/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/backend.py in bias_add(x, bias, data_format)\r\n   4480     elif data_format == 'channels_last':\r\n   4481       if len(bias_shape) == 1:\r\n-> 4482         x = x + reshape(bias, (1, 1, bias_shape[0]))\r\n   4483       else:\r\n   4484         x = x + reshape(bias, (1,) + bias_shape)\r\n\r\n/home/ailab/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/backend.py in reshape(x, shape)\r\n   2214       A tensor.\r\n   2215   \"\"\"\r\n-> 2216   return array_ops.reshape(x, shape)\r\n   2217 \r\n   2218 \r\n\r\n/home/ailab/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_array_ops.py in reshape(tensor, shape, name)\r\n   6214     except _core._FallbackException:\r\n   6215       return reshape_eager_fallback(\r\n-> 6216           tensor, shape, name=name, ctx=_ctx)\r\n   6217     except _core._NotOkStatusException as e:\r\n   6218       if name is not None:\r\n\r\n/home/ailab/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_array_ops.py in reshape_eager_fallback(tensor, shape, name, ctx)\r\n   6233   _attrs = (\"T\", _attr_T, \"Tshape\", _attr_Tshape)\r\n   6234   _result = _execute.execute(b\"Reshape\", 1, inputs=_inputs_flat, attrs=_attrs,\r\n-> 6235                              ctx=_ctx, name=name)\r\n   6236   _execute.record_gradient(\r\n   6237       \"Reshape\", _inputs_flat, _attrs, _result, name)\r\n\r\n/home/ailab/anaconda3/lib/python3.6/site-packages/tensorflow/python/eager/execute.py in quick_execute(op_name, num_outputs, inputs, attrs, ctx, name)\r\n     58     tensors = pywrap_tensorflow.TFE_Py_Execute(ctx._handle, device_name,\r\n     59                                                op_name, inputs, attrs,\r\n---> 60                                                num_outputs)\r\n     61   except core._NotOkStatusException as e:\r\n     62     if name is not None:\r\n\r\nTypeError: provided list of inputs contains objects other than 'EagerTensor'. Item 0 is Tensor\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22242", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22242/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22242/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22242/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22242", "id": 359669190, "node_id": "MDU6SXNzdWUzNTk2NjkxOTA=", "number": 22242, "title": "Using TF-TRT doubles the size of frozen protobuf file", "user": {"login": "dhingratul", "id": 4759327, "node_id": "MDQ6VXNlcjQ3NTkzMjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/4759327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dhingratul", "html_url": "https://github.com/dhingratul", "followers_url": "https://api.github.com/users/dhingratul/followers", "following_url": "https://api.github.com/users/dhingratul/following{/other_user}", "gists_url": "https://api.github.com/users/dhingratul/gists{/gist_id}", "starred_url": "https://api.github.com/users/dhingratul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dhingratul/subscriptions", "organizations_url": "https://api.github.com/users/dhingratul/orgs", "repos_url": "https://api.github.com/users/dhingratul/repos", "events_url": "https://api.github.com/users/dhingratul/events{/privacy}", "received_events_url": "https://api.github.com/users/dhingratul/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-09-12T22:03:02Z", "updated_at": "2018-12-08T18:41:02Z", "closed_at": null, "author_association": "NONE", "body": "Please go to Stack Overflow for help and support:\r\n\r\nhttps://stackoverflow.com/questions/tagged/tensorflow\r\n\r\nIf you open a GitHub issue, here is our policy:\r\n\r\n1. It must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).\r\n2. The form below must be filled out.\r\n3. It shouldn't be a TensorBoard issue. Those go [here](https://github.com/tensorflow/tensorboard/issues).\r\n\r\n**Here's why we have that policy**: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.\r\n\r\n------------------------\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: N/a\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: master @ 3e137b24b06a81772402b86392dbd158653d487b\r\n- **Python version**:2.7\r\n- **Bazel version (if compiling from source)**: 0.16.1\r\n- **GCC/Compiler version (if compiling from source)**: 5.4.0 20160609\r\n- **CUDA/cuDNN version**: 9.0/7.1\r\n- **GPU model and memory**: 1080ti/11gb dual\r\n- **Exact command to reproduce**: \r\n\r\n```\r\nimport tensorflow as tf\r\nfrom tensorflow.contrib import tensorrt as trt\r\nimport numpy as np\r\n\r\nfrom keras import backend as K\r\ncfg = K.tf.ConfigProto()\r\ncfg.gpu_options.allow_growth = True\r\nK.set_session(K.tf.Session(config=cfg))\r\n\r\ndef load_graph(frozen_graph_filename):\r\n    # We load the protobuf file from the disk and parse it to retrieve the\r\n    # unserialized graph_def\r\n    with tf.gfile.GFile(frozen_graph_filename, \"rb\") as f:\r\n        graph_def = tf.GraphDef()\r\n        graph_def.ParseFromString(f.read())\r\n\r\n    # Then, we can use again a convenient built-in function to import a graph_def into the\r\n    # current default Graph\r\n    with tf.Graph().as_default() as graph:\r\n        tf.import_graph_def(\r\n            graph_def,\r\n            name='', #DEBUG\r\n        )\r\n    return graph\r\n\r\nfid = \"model.pb\"\r\noutput_nodenames = 'output1,output2,output3'\r\noutput_node = list(output_nodenames.split(\",\"))\r\ng = load_graph(fid)\r\nwith tf.Session(graph=g) as sess:\r\n    nodes = [n.name for n in tf.get_default_graph().as_graph_def().node]\r\n    with open(\"original_graph.txt\", \"w\") as fid:\r\n        for item in nodes:\r\n            fid.write(\"%s\\n\" % item)\r\n    writer = tf.summary.FileWriter(\"logs_viz_orig\", tf.get_default_graph().as_graph_def())\r\n    trt_graph = trt.create_inference_graph(\r\n    input_graph_def=tf.get_default_graph().as_graph_def(),\r\n    outputs=output_node,\r\n    max_batch_size=1,\r\n    max_workspace_size_bytes=1 << 25,\r\n    precision_mode=\"FP32\",  # TRT Engine precision \"FP32\",\"FP16\" or \"INT8\"\r\n    minimum_segment_size=2  # minimum number of nodes in an engine\r\n    )\r\n    f = open(\"trt.pb\", 'w')\r\n    f.write(trt_graph.SerializeToString())\r\n    f.close()\r\n```\r\n  \r\nThe original graph as ~1100 ops in total, and trt graph has ~900, even then the original model was ~60mb, whereas the exported trt graph is ~120 mb. \r\n\r\nYou can collect some of this information using our environment capture script:\r\n\r\nhttps://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh\r\n\r\nYou can obtain the TensorFlow version with\r\n\r\npython -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"\r\n\r\n### Describe the problem\r\nDescribe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.\r\n\r\n### Source code / logs\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22226", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22226/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22226/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22226/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22226", "id": 359342694, "node_id": "MDU6SXNzdWUzNTkzNDI2OTQ=", "number": 22226, "title": "Orthogonal initialization gives inaccurate result when running on GPU", "user": {"login": "dargilboa", "id": 16104218, "node_id": "MDQ6VXNlcjE2MTA0MjE4", "avatar_url": "https://avatars1.githubusercontent.com/u/16104218?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dargilboa", "html_url": "https://github.com/dargilboa", "followers_url": "https://api.github.com/users/dargilboa/followers", "following_url": "https://api.github.com/users/dargilboa/following{/other_user}", "gists_url": "https://api.github.com/users/dargilboa/gists{/gist_id}", "starred_url": "https://api.github.com/users/dargilboa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dargilboa/subscriptions", "organizations_url": "https://api.github.com/users/dargilboa/orgs", "repos_url": "https://api.github.com/users/dargilboa/repos", "events_url": "https://api.github.com/users/dargilboa/events{/privacy}", "received_events_url": "https://api.github.com/users/dargilboa/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2018-09-12T07:06:10Z", "updated_at": "2019-08-22T06:58:24Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code**: see example below\r\n- **OS Platform and Distribution**:Google Colabratory (also in compiled code on Linux)\r\n- **Mobile device**: N/A\r\n- **TensorFlow installed from (source or binary)**: Google Colabratory\r\n- **TensorFlow version (use command below)**: 1.10.1\r\n- **Python version**: 2.7.14 \r\n- **Bazel version (if compiling from source)**:  N/A\r\n- **GCC/Compiler version (if compiling from source)**:  N/A\r\n- **CUDA/cuDNN version**:  N/A\r\n- **GPU model and memory**: Issue occurred both on Telsa V100 and Tesla K80 with at least 11GB of available memory (but not when using CPU runtime)\r\n- **Exact command to reproduce**: see example below\r\n\r\n### Describe the problem\r\nWhen generating an orthogonal matrix and running on a GPU, if the matrix is 1000x1000 or larger the resulting matrix is not orthogonal. The deviations are several orders of magnitude larger than expected from finite precision errors.\r\nThe issue doesn't occur for smaller n (say 100) or when running on a CPU.\r\n\r\nIn the example below, the final result has entry-wise deviations from the identity matrix of order 1e-2.\r\n\r\n### Source code / logs\r\n \r\n\r\n```\r\nimport tensorflow as tf\r\ntf.enable_eager_execution()\r\ntf.set_random_seed(0)\r\ninit = tf.orthogonal_initializer(1,seed=0)\r\na = init([1000,1000])\r\ntf.matmul(a,tf.transpose(a))\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22214", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22214/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22214/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22214/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22214", "id": 359133745, "node_id": "MDU6SXNzdWUzNTkxMzM3NDU=", "number": 22214, "title": "C++ API: tensorflow::ops::Mul causes read access violation when second attribute is int constant", "user": {"login": "GPhilo", "id": 4441724, "node_id": "MDQ6VXNlcjQ0NDE3MjQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/4441724?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GPhilo", "html_url": "https://github.com/GPhilo", "followers_url": "https://api.github.com/users/GPhilo/followers", "following_url": "https://api.github.com/users/GPhilo/following{/other_user}", "gists_url": "https://api.github.com/users/GPhilo/gists{/gist_id}", "starred_url": "https://api.github.com/users/GPhilo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GPhilo/subscriptions", "organizations_url": "https://api.github.com/users/GPhilo/orgs", "repos_url": "https://api.github.com/users/GPhilo/repos", "events_url": "https://api.github.com/users/GPhilo/events{/privacy}", "received_events_url": "https://api.github.com/users/GPhilo/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-09-11T16:53:53Z", "updated_at": "2020-02-08T01:11:21Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes, see below\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Windows 10\r\n- **TensorFlow installed from (source or binary)**: C++ API compiled from source\r\n- **TensorFlow version (use command below)**: 1.10.0\r\n- **Python version**: 3.5\r\n- **Bazel version (if compiling from source)**: Compiled via CMake\r\n- **GCC/Compiler version (if compiling from source)**: VS 2015\r\n- **CUDA/cuDNN version**: 9/7.0.5\r\n- **GPU model and memory**: GTX 1080, 8GBs\r\n- **Exact command to reproduce**: run the script\r\n\r\n### Describe the problem\r\nIt seems `tensorflow::ops::Mul` accepts arguments of different type ad then crashes during `Run()`.\r\n\r\nTake this sample program:\r\n\r\n```\r\n// dunno if all are needed, some may be redundant for this small sample\r\n#include <tensorflow/cc/ops/const_op.h>\r\n#include <tensorflow/cc/ops/image_ops.h>\r\n#include <tensorflow/cc/ops/standard_ops.h>\r\n#include <tensorflow/core/public/session.h>\r\n#include <tensorflow/core/platform/init_main.h>\r\n#include <tensorflow/cc/client/client_session.h>\r\n\r\nint main(int argc, char* argv[])\r\n{\r\n    tensorflow::port::InitMain(argv[0], &argc, &argv);\r\n    auto root = tensorflow::Scope::NewRootScope();\r\n    auto input = tensorflow::ops::Placeholder(root, tensorflow::DataType::DT_UINT8);\r\n    auto id = tensorflow::ops::Identity(root, input); // just to check we get this far before the error occurs\r\n    auto to_float = tensorflow::ops::Cast(root, id, tensorflow::DataType::DT_FLOAT);\r\n    auto mul = tensorflow::ops::Mul(root, to_float, { -1 }); // <<<<<<<<<<<<<<<<<\r\n\r\n    tensorflow::ClientSession session(root);\r\n\r\n    // Run net\r\n    std::vector<tensorflow::Tensor> outputs;\r\n    tensorflow::Status run_status = session.Run({ {input, {(uint8_t)42, (uint8_t)35}} }, { id, mul }, &outputs);\r\n    std::cout << \"Run status: \" << run_status << std::endl;\r\n    std::cout << outputs[0].DebugString() << std::endl;\r\n    std::cout << outputs[1].DebugString() << std::endl;\r\n\r\n    return 0;\r\n}\r\n```\r\n\r\nIt compiles fine but it will throw an \"Access Violation reading location 0x0000000000000050\" when executing `Run()`.\r\n\r\nChanging the marked line to\r\n`auto mul = tensorflow::ops::Mul(root, to_float, { -1.0f });`\r\n(i.e., just changing the numerical constant in the second argument from int to float) fixes the error and produces the proper output.\r\n\r\nI'm not sure whether this is a bug or my error for passing two tensors with different types, but either way IMHO this should probably emit a warning at graph construction time (or prevent compilation altogether, which would be the better solution).\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22213", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22213/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22213/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22213/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22213", "id": 359055177, "node_id": "MDU6SXNzdWUzNTkwNTUxNzc=", "number": 22213, "title": "how to fix  \"tf.nightly-gpu\" caused \"nan\" problem", "user": {"login": "Q82822", "id": 36806042, "node_id": "MDQ6VXNlcjM2ODA2MDQy", "avatar_url": "https://avatars2.githubusercontent.com/u/36806042?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Q82822", "html_url": "https://github.com/Q82822", "followers_url": "https://api.github.com/users/Q82822/followers", "following_url": "https://api.github.com/users/Q82822/following{/other_user}", "gists_url": "https://api.github.com/users/Q82822/gists{/gist_id}", "starred_url": "https://api.github.com/users/Q82822/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Q82822/subscriptions", "organizations_url": "https://api.github.com/users/Q82822/orgs", "repos_url": "https://api.github.com/users/Q82822/repos", "events_url": "https://api.github.com/users/Q82822/events{/privacy}", "received_events_url": "https://api.github.com/users/Q82822/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-09-11T13:46:11Z", "updated_at": "2018-12-15T18:41:18Z", "closed_at": null, "author_association": "NONE", "body": "\r\n### System information\r\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):Linux Ubuntu 16.04\r\nMobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\nTensorFlow installed from (source or binary): source\r\nTensorFlow version (use command below): 1.11.0 (use tf-night-gpu)\r\nPython version:2.7\r\nBazel version (if compiling from source):\r\nGCC/Compiler version (if compiling from source):\r\nCUDA/cuDNN version: 9.0 /7.1\r\nGPU model and memory:\r\nExact command to reproduce:\r\n\r\n\r\n### Describe the problem\r\nI used `tf-night-gpu` in my project code, but it will be made \"nan\" at the next batch train.\r\nit only the  `tf-night-gpu` will happen, it is can work in tensorflow1.10.\r\n\r\n\r\n### Source code / logs\r\nthe minimal code at here , it is just part of my project code. the input is word_index.\r\nthe batch size = 64\r\nuse tf-nightly-gpu.\r\nplatform = jupyter notebook.\r\nin first batch size was worked, but in next batch train will be \"nan\". but this problem only happen in \"tf-nightly-gpu\"\r\n```\r\n\r\nclass  RNN_Decoder(tf.keras.Model):\r\n    def __init__(self, embedding_dim, units, vocab_size):\r\n        super(RNN_Decoder, self).__init__()\r\n        self.units = units\r\n        self.embedding = tf.keras.layers.Embedding(vocab_size, embedding_dim)\r\n    def call(self, x, features, hidden):\r\n        print('embedding_input:  ', x)\r\n        x = self.embedding(x)\r\n        print('embedding_output:  ', x)\r\n\r\ndecoder = RNN_Decoder(embedding_dim, units, vocab_size)\r\n\r\nfor epoch in range(20):\r\n    hidden = decoder.reset_state(batch_size=64)\r\n    dec_input = tf.expand_dims([tokenizer.word_index['<start>']] * BATCH_SIZE, 1)\r\n        with tf.GradientTape() as tape:\r\n            features = encoder(img_tensor)\r\n            for i in range(1, target.shape[1])\r\n            predictions, hidden, _ = decoder(dec_input, features, hidden)\r\n```\r\n\r\n---- first batch train input and output------\r\n```\r\n('embedding_input ', <tf.Tensor: id=4586198, shape=(64, 1), dtype=int32, numpy=\r\narray([[3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3]], dtype=int32)>)\r\n('Embedding_output:  ', <tf.Tensor: id=4586379, shape=(64, 1, 256), dtype=float32, numpy=\r\narray([[[ 0.01097491, -0.02041122,  0.04823625, ..., -0.0155656 ,\r\n          0.01521399, -0.0496642 ]],\r\n\r\n       [[ 0.01097491, -0.02041122,  0.04823625, ..., -0.0155656 ,\r\n          0.01521399, -0.0496642 ]],\r\n\r\n       [[ 0.01097491, -0.02041122,  0.04823625, ..., -0.0155656 ,\r\n          0.01521399, -0.0496642 ]],\r\n\r\n       ...,\r\n\r\n       [[ 0.01097491, -0.02041122,  0.04823625, ..., -0.0155656 ,\r\n          0.01521399, -0.0496642 ]],\r\n\r\n       [[ 0.01097491, -0.02041122,  0.04823625, ..., -0.0155656 ,\r\n          0.01521399, -0.0496642 ]],\r\n\r\n       [[ 0.01097491, -0.02041122,  0.04823625, ..., -0.0155656 ,\r\n          0.01521399, -0.0496642 ]]], dtype=float32)>)\r\n```\r\n\r\nthe next batch train , have same keras.layers.Embedding_input:\r\n\r\n```\r\n`Epoch 1 Batch 0 Loss 2.0415\r\n(''keras.layers.Embedding_input:: ', <tf.Tensor: id=4607289, shape=(64, 1), dtype=int32, numpy=\r\narray([[3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3]], dtype=int32)>)\r\n(''keras.layers.Embedding_output::  ', <tf.Tensor: id=4607374, shape=(64, 1, 256), dtype=float32, numpy=\r\narray([[[nan, nan, nan, ..., nan, nan, nan]],\r\n\r\n       [[nan, nan, nan, ..., nan, nan, nan]],\r\n\r\n       [[nan, nan, nan, ..., nan, nan, nan]],\r\n\r\n\r\n       [[nan, nan, nan, ..., nan, nan, nan]],\r\n\r\n       [[nan, nan, nan, ..., nan, nan, nan]],\r\n\r\n       [[nan, nan, nan, ..., nan, nan, nan]]], dtype=float32)>)`\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22208", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22208/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22208/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22208/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22208", "id": 358936128, "node_id": "MDU6SXNzdWUzNTg5MzYxMjg=", "number": 22208, "title": "LookupError: No gradient defined for operation type: ResizeNearestNeighborGrad or ResizeBilinearGrad", "user": {"login": "GPrathap", "id": 7587302, "node_id": "MDQ6VXNlcjc1ODczMDI=", "avatar_url": "https://avatars0.githubusercontent.com/u/7587302?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GPrathap", "html_url": "https://github.com/GPrathap", "followers_url": "https://api.github.com/users/GPrathap/followers", "following_url": "https://api.github.com/users/GPrathap/following{/other_user}", "gists_url": "https://api.github.com/users/GPrathap/gists{/gist_id}", "starred_url": "https://api.github.com/users/GPrathap/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GPrathap/subscriptions", "organizations_url": "https://api.github.com/users/GPrathap/orgs", "repos_url": "https://api.github.com/users/GPrathap/repos", "events_url": "https://api.github.com/users/GPrathap/events{/privacy}", "received_events_url": "https://api.github.com/users/GPrathap/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2018-09-11T08:15:48Z", "updated_at": "2019-07-01T19:33:59Z", "closed_at": null, "author_association": "NONE", "body": "### System information:\r\n- **OS Platform and Distribution**: Linux Ubuntu 16.04\r\n- **TensorFlow installed from (source or binary)**:binary\r\n- **TensorFlow version**:1.10.0\r\n- **Python version**:2.7.x\r\n- **CUDA/cuDNN version**:9.0.x\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:Nope\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:N/\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **GCC/Compiler version (if compiling from source)**:N/A\r\n- **GPU model and memory**: Geforce 940mx\r\n- **Exact command to reproduce**: N/A\r\n\r\n### Describe the problem\r\nI want to the gradient of any of [these image resizing operations](https://www.tensorflow.org/api_docs/python/tf/image/ResizeMethod) inside the neural network. But seems to be any of these does not define the gradient ops for them. I see there is a [similar issue ](https://github.com/tensorflow/tensorflow/issues/7641) which has not been answered yet. I also asked in the [SO](https://stackoverflow.com/questions/52264891/lookuperror-no-gradient-defined-for-operation-type-resizenearestneighborgrad) but still, I did not get an answer for this. \r\n\r\n### Source code / logs\r\n\r\n      \r\n\t\tdifferences = tf.subtract(images_fake, images_real)\r\n\t\talpha_shape = [params.batch_size] + [1] * (differences.shape.ndims - 1)\r\n\t\talpha = tf.random_uniform(shape=alpha_shape, minval=0., maxval=1.)\r\n\t\tinterpolates = images_real + (alpha * differences)\r\n\t\td_model = Model(params, args.mode, interpolates, reuse_variables, images_fake, 1)\r\n\t\tgradients = tf.gradients(d_model.logistic_linear, [interpolates])[0]\r\n\t\tslopes = tf.sqrt(tf.reduce_sum(tf.square(gradients), reduction_indices=[1]))\r\n\t\tgradient_penalty = tf.reduce_mean((slopes - 1.) ** 2)\r\n\t\t_gradient_penalty = 10 * gradient_penalty\r\n\r\nInside my model, it uses [ tf.image.resize_bicubic()](https://www.tensorflow.org/api_docs/python/tf/image/resize_bicubic). But I see there are some [exisiting implementation](https://github.com/tensorflow/tensorflow/commit/3331c574bcfd85787d7a4f3d1b1b139239a6595b) for this. But not sure how those things get it them working. Please let me know how this can be achieved. These image resizing cannot be done as preprocessing it needs to be done inside a model. Any help would be really appreciated. "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22182", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22182/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22182/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22182/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22182", "id": 358517717, "node_id": "MDU6SXNzdWUzNTg1MTc3MTc=", "number": 22182, "title": "\"master\" in cluster spec for distributed training ", "user": {"login": "llidev", "id": 29957883, "node_id": "MDQ6VXNlcjI5OTU3ODgz", "avatar_url": "https://avatars0.githubusercontent.com/u/29957883?v=4", "gravatar_id": "", "url": "https://api.github.com/users/llidev", "html_url": "https://github.com/llidev", "followers_url": "https://api.github.com/users/llidev/followers", "following_url": "https://api.github.com/users/llidev/following{/other_user}", "gists_url": "https://api.github.com/users/llidev/gists{/gist_id}", "starred_url": "https://api.github.com/users/llidev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/llidev/subscriptions", "organizations_url": "https://api.github.com/users/llidev/orgs", "repos_url": "https://api.github.com/users/llidev/repos", "events_url": "https://api.github.com/users/llidev/events{/privacy}", "received_events_url": "https://api.github.com/users/llidev/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "tatatodd", "id": 5453737, "node_id": "MDQ6VXNlcjU0NTM3Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5453737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatatodd", "html_url": "https://github.com/tatatodd", "followers_url": "https://api.github.com/users/tatatodd/followers", "following_url": "https://api.github.com/users/tatatodd/following{/other_user}", "gists_url": "https://api.github.com/users/tatatodd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatatodd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatatodd/subscriptions", "organizations_url": "https://api.github.com/users/tatatodd/orgs", "repos_url": "https://api.github.com/users/tatatodd/repos", "events_url": "https://api.github.com/users/tatatodd/events{/privacy}", "received_events_url": "https://api.github.com/users/tatatodd/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tatatodd", "id": 5453737, "node_id": "MDQ6VXNlcjU0NTM3Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5453737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatatodd", "html_url": "https://github.com/tatatodd", "followers_url": "https://api.github.com/users/tatatodd/followers", "following_url": "https://api.github.com/users/tatatodd/following{/other_user}", "gists_url": "https://api.github.com/users/tatatodd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatatodd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatatodd/subscriptions", "organizations_url": "https://api.github.com/users/tatatodd/orgs", "repos_url": "https://api.github.com/users/tatatodd/repos", "events_url": "https://api.github.com/users/tatatodd/events{/privacy}", "received_events_url": "https://api.github.com/users/tatatodd/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-09-10T08:26:40Z", "updated_at": "2018-12-10T18:57:13Z", "closed_at": null, "author_association": "NONE", "body": "Hi,\r\n\r\nGiven in the sample code [mnist_replica.py](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/tools/dist_test/python/mnist_replica.py), `tf.train.ClusterSpec()` needs to be used to define the cluster for distributed training.  The function `tf.train.ClusterSpec()` can only take `\"ps\"` and `\"worker\"` hosts, but `\"master\"` is not allowed. As far as I know, `\"master\"` is usually defined as a special worker and should be a part of the worker hosts, referred as `task_id = 0`. This makes sense to me.\r\n\r\nHowever, in the context of `tf.estimator`, if `\"cluster\"` is set in `TF_CONFIG`, it must have one `\"chief\"` node, in addition to `\"worker\"`. For example,\r\n\r\n```\r\nTF_CONFIG='{\r\n    \"cluster\": {\r\n        \"chief\": [\"host0:2222\"],\r\n        \"worker\": [\"host1:2222\", \"host2:2222\", \"host3:2222\"],\r\n        \"ps\": [\"host4:2222\", \"host5:2222\"]\r\n    },\r\n    \"task\": {\"type\": \"chief\", \"index\": 0}\r\n}'\r\n```\r\nI am trying to use `TF_CONFIG` for all our distributed training work, but it looks like to be inconsistent. For example, we need to do some preprocessing in the above `TF_CONFIG` (i.e., combining `\"chief\"` and `\"worker\"` hosts, and re-index them), to use it for `tf.train.ClusterSpec()`. \r\n\r\nIs there any better standard we can follow to achieve our goal?\r\n\r\nThanks \r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22174", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22174/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22174/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22174/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22174", "id": 358400619, "node_id": "MDU6SXNzdWUzNTg0MDA2MTk=", "number": 22174, "title": "tensorflow/core/framework/tensor.cc:861] Check failed: buf_ null buf_ with non-zero shape size 1", "user": {"login": "dbl001", "id": 3105499, "node_id": "MDQ6VXNlcjMxMDU0OTk=", "avatar_url": "https://avatars2.githubusercontent.com/u/3105499?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbl001", "html_url": "https://github.com/dbl001", "followers_url": "https://api.github.com/users/dbl001/followers", "following_url": "https://api.github.com/users/dbl001/following{/other_user}", "gists_url": "https://api.github.com/users/dbl001/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbl001/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbl001/subscriptions", "organizations_url": "https://api.github.com/users/dbl001/orgs", "repos_url": "https://api.github.com/users/dbl001/repos", "events_url": "https://api.github.com/users/dbl001/events{/privacy}", "received_events_url": "https://api.github.com/users/dbl001/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-09-09T18:40:05Z", "updated_at": "2020-02-08T01:11:43Z", "closed_at": null, "author_association": "NONE", "body": "I'm running a model Lda2vec_tensorflow on a Mac with Tensorflow 1.8 in an anaconda 3.6 virtual environment.  The model runs properly without trying to attach the tensor board debugger.\r\nWhen I attach the debugger I get an abort signal.\r\n\r\n**Have I written custom code**\r\nNo\r\n**OS Platform and Distribution**\r\nOS X 10.11.6\r\n\r\n**TensorFlow installed from**\r\n```\r\n$ conda list tensorflow\r\n# packages in environment at /Users/davidlaxer/anaconda/envs/ai:\r\n#\r\n# Name                    Version                   Build  Channel\r\ntensorflow                1.8.0                    py36_1    condo-forge\r\n```\r\n**TensorFlow version**\r\n1.8.0\r\n\r\n**Bazel version**\r\n[bazel release 0.14.0]\r\n\r\n**CUDA/cuDNN version**\r\nN/A\r\n\r\n**GPU model and memory**\r\nN/A\r\n\r\n**Exact command to reproduce**\r\n```\r\n/Users/davidlaxer/anaconda/envs/ai/bin/python /Applications/PyCharm.app/Contents/helpers/pydev/pydevd.py --multiproc --qt-support=auto --client 127.0.0.1 --port 51376 --file /Users/davidlaxer/Lda2vec-Tensorflow/run_stories.py\r\npydev debugger: process 91253 is connecting\r\n\r\nConnected to pydev debugger (build 182.4129.34)\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n/Users/davidlaxer/anaconda/envs/ai/lib/python3.6/site-packages/tensorflow/python/util/tf_inspect.py:55: DeprecationWarning: inspect.getargspec() is deprecated, use inspect.signature() or inspect.getfullargspec()\r\n  if d.decorator_argspec is not None), _inspect.getargspec(target))\r\n95 ops no flops stats due to incomplete shapes.\r\n```\r\n\r\nNext, click STEP in tensor board debugger:\r\n```\r\n2018-09-10 10:27:19.544078: F tensorflow/core/framework/tensor.cc:861] Check failed: buf_ null buf_ with non-zero shape size 1\r\nProcess finished with exit code 134 (interrupted by signal 6: SIGABRT)\r\n```\r\n\r\n**Mobile device**\r\nN/A\r\n\r\nHere's my environment:\r\n```\r\n$ cat tf_env.txt \r\n\r\n== cat /etc/issue ===============================================\r\nDarwin David-Laxers-MacBook-Pro.local 15.6.0 Darwin Kernel Version 15.6.0: Thu Jun 21 20:07:40 PDT 2018; root:xnu-3248.73.11~1/RELEASE_X86_64 x86_64\r\nMac OS X 10.11.6\r\n\r\n== are we in docker =============================================\r\nNo\r\n\r\n== compiler =====================================================\r\nApple LLVM version 8.0.0 (clang-800.0.42.1)\r\nTarget: x86_64-apple-darwin15.6.0\r\nThread model: posix\r\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\r\n\r\n== uname -a =====================================================\r\nDarwin David-Laxers-MacBook-Pro.local 15.6.0 Darwin Kernel Version 15.6.0: Thu Jun 21 20:07:40 PDT 2018; root:xnu-3248.73.11~1/RELEASE_X86_64 x86_64\r\n\r\n== check pips ===================================================\r\nmsgpack-numpy       0.4.3     \r\nnumpy               1.14.5    \r\nprotobuf            3.6.0     \r\ntensorflow          1.8.0     \r\n\r\n== check for virtualenv =========================================\r\nFalse\r\n\r\n== tensorflow import ============================================\r\ntf.VERSION = 1.8.0\r\ntf.GIT_VERSION = b'v1.8.0-8-g23c2187'\r\ntf.COMPILER_VERSION = b'v1.8.0-8-g23c2187'\r\nSanity check: array([1], dtype=int32)\r\n\r\n== env ==========================================================\r\nLD_LIBRARY_PATH is unset\r\nDYLD_LIBRARY_PATH is unset\r\n\r\n== nvidia-smi ===================================================\r\n./tf_env_collect.sh: line 105: nvidia-smi: command not found\r\n\r\n\r\n\r\n== cuda libs  ===================================================\r\n(ai) David-Laxers-MacBook-Pro:tools davidlaxer$ \r\n\r\npython -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"\r\n\r\nb'v1.8.0-8-g23c2187' 1.8.0\r\n```\r\n\r\nI'm trying to use the tensorboard debugger to debug the github model Lda2vec_tensorflow model.\r\nI am able to attach the tensorboard debugger to the model, however, when I click 'step' or 'continue,\r\nthe process running the model exits with the following error message :\r\n\r\n95 ops no flops stats due to incomplete shapes.\r\n2018-09-09 11:07:02.150246: F tensorflow/core/framework/tensor.cc:861] Check failed: buf_ null buf_ with non-zero shape size 1\r\n\r\nProcess finished with exit code 134 (interrupted by signal 6: SIGABRT)\r\n\r\n\r\n### Source code / logs\r\n\r\nThe code to run the Lda2vec_Tensorflow model is here:\r\n\r\nhttps://github.com/nateraw/Lda2vec-Tensorflow\r\n\r\nHere is the code that I use to invoke the tensor board debugger.\r\n\r\nI use port 60664 to attach the debugger:\r\n```\r\nself.sesh = tf.Session(config=self.config)\r\nself.sesh = tf_debug.TensorBoardDebugWrapperSession(self.sesh, 'localhost:6064')\r\n...\r\nrun_metadata = tf.RunMetadata()\r\nself.sesh.run(tf.global_variables_initializer(), options=tf.RunOptions(trace_level=tf.RunOptions.FULL_TRACE, report_tensor_allocations_upon_oom=True),\r\n               run_metadata=run_metadata)\r\n```\r\n![screen shot 2018-09-09 at 11 07 05 am](https://user-images.githubusercontent.com/3105499/45267642-12fa8e00-b425-11e8-8687-abee65c7f1be.png)"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22162", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22162/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22162/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22162/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22162", "id": 358275499, "node_id": "MDU6SXNzdWUzNTgyNzU0OTk=", "number": 22162, "title": "tf.map_fn causes error when importing the same graph twice and connecting them", "user": {"login": "stefsietz", "id": 2621937, "node_id": "MDQ6VXNlcjI2MjE5Mzc=", "avatar_url": "https://avatars0.githubusercontent.com/u/2621937?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefsietz", "html_url": "https://github.com/stefsietz", "followers_url": "https://api.github.com/users/stefsietz/followers", "following_url": "https://api.github.com/users/stefsietz/following{/other_user}", "gists_url": "https://api.github.com/users/stefsietz/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefsietz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefsietz/subscriptions", "organizations_url": "https://api.github.com/users/stefsietz/orgs", "repos_url": "https://api.github.com/users/stefsietz/repos", "events_url": "https://api.github.com/users/stefsietz/events{/privacy}", "received_events_url": "https://api.github.com/users/stefsietz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "skye", "id": 88808, "node_id": "MDQ6VXNlcjg4ODA4", "avatar_url": "https://avatars1.githubusercontent.com/u/88808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skye", "html_url": "https://github.com/skye", "followers_url": "https://api.github.com/users/skye/followers", "following_url": "https://api.github.com/users/skye/following{/other_user}", "gists_url": "https://api.github.com/users/skye/gists{/gist_id}", "starred_url": "https://api.github.com/users/skye/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skye/subscriptions", "organizations_url": "https://api.github.com/users/skye/orgs", "repos_url": "https://api.github.com/users/skye/repos", "events_url": "https://api.github.com/users/skye/events{/privacy}", "received_events_url": "https://api.github.com/users/skye/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "skye", "id": 88808, "node_id": "MDQ6VXNlcjg4ODA4", "avatar_url": "https://avatars1.githubusercontent.com/u/88808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skye", "html_url": "https://github.com/skye", "followers_url": "https://api.github.com/users/skye/followers", "following_url": "https://api.github.com/users/skye/following{/other_user}", "gists_url": "https://api.github.com/users/skye/gists{/gist_id}", "starred_url": "https://api.github.com/users/skye/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skye/subscriptions", "organizations_url": "https://api.github.com/users/skye/orgs", "repos_url": "https://api.github.com/users/skye/repos", "events_url": "https://api.github.com/users/skye/events{/privacy}", "received_events_url": "https://api.github.com/users/skye/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2018-09-08T08:13:47Z", "updated_at": "2018-12-08T18:40:53Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 18.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**: binary (pip in conda environment)\r\n- **TensorFlow version (use command below)**: v1.10.1-0-g4dcfddc5d1 1.10.1\r\n- **Python version**: 3.6.6\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**: 9.0\r\n- **GPU model and memory**: GTX 1070 / 8GB\r\n- **Exact command to reproduce**: below\r\n\r\n\r\n### Describe the problem\r\nI am trying to load the same graph twice (with different variable weights) to perform stage-wise object detection with one connected graph. I import them with different name scopes, but still I get an error message because there is some bug in the tf.map_fn:\r\n```\"tensorflow.python.framework.errors_impl.InvalidArgumentError: Invalid loop structure: Loop \"map/while/while_context\" has more than one LoopCond node: \"graph2/map/while/LoopCond\" and \"graph1/map/while/LoopCond\". This is an internal bug, please file a bug report with instructions on how to reproduce the error.\"```\r\n\r\nMinimal example to reproduce is below, but to me it ocurred with the faster-rcnn meta architecture from the object detection framework, where the first loop that causes this error is in the \"preprocess\" funtion of \"object_detection.meta_architectures.faster_rcnn_meta_arch.py\" at line 535. When I changed the tf.name_scope from 'Preprocessor' to something else in just one of the graphs, it threw this error from a different usage of the map_fn further down the graph.\r\n\r\nfrom object_detection.meta_architectures.faster_rcnn_meta_arch.py (line 535):\r\n```python\r\n    if inputs.dtype is not tf.float32:\r\n      raise ValueError('`preprocess` expects a tf.float32 tensor')\r\n    with tf.name_scope('Preprocessor'): #when I change this in one of the graphs, the error doesn't occur here anymore\r\n      outputs = shape_utils.static_or_dynamic_map_fn(\r\n          self._image_resizer_fn,\r\n          elems=inputs,\r\n          dtype=[tf.float32, tf.int32],\r\n          parallel_iterations=self._parallel_iterations)\r\n      resized_inputs = outputs[0]\r\n      true_image_shapes = outputs[1]\r\n      return (self._feature_extractor.preprocess(resized_inputs),\r\n              true_image_shapes)\r\n```\r\nThis would actually be my workaround if this doesn't get fixed, to just rename all the map_fn scopes before training each subgraph.\r\n\r\n### Script to reproduce bug\r\n```python\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\ndef build_map_graph(name_scope=''):\r\n    graph = tf.Graph()\r\n    with graph.as_default():\r\n        input_tensor = tf.placeholder(tf.float32, shape=[None, 1], name='input')\r\n\r\n        def mult(input):\r\n            input = tf.multiply(input, 2)\r\n            return input\r\n\r\n        with tf.name_scope(name_scope):\r\n            multiplied = tf.map_fn(mult, input_tensor)\r\n        out_tensor = tf.identity(multiplied, name='output')\r\n\r\n    return graph\r\n\r\ndef build_simple_graph():\r\n    graph = tf.Graph()\r\n    with graph.as_default():\r\n        input_tensor = tf.placeholder(tf.float32, shape=[None, 1], name='input')\r\n\r\n        multiplied = tf.multiply(input_tensor, 2)\r\n        out_tensor = tf.identity(multiplied, name='output')\r\n\r\n    return graph\r\n\r\n\r\ndef connect_graphs(both_are_map_graphs=False, rename_second=False):\r\n    test_data = np.asarray([[1.0], [2.0]], dtype=np.float32)\r\n\r\n    graph1 = build_map_graph()\r\n    g1_graph_def = graph1.as_graph_def()\r\n\r\n    g2_map_name_scope = 'graph2_map' if rename_second else ''\r\n    graph2 = build_map_graph(g2_map_name_scope) if both_are_map_graphs else build_simple_graph()\r\n\r\n    g2_graph_def = graph2.as_graph_def()\r\n\r\n    connected_graph = tf.Graph()\r\n\r\n    with connected_graph.as_default():\r\n        tf.import_graph_def(g1_graph_def, name='graph1')\r\n\r\n        g1_output_tensor = tf.get_default_graph().get_tensor_by_name('graph1/output:0')\r\n        g1_input_tensor = tf.get_default_graph().get_tensor_by_name('graph1/input:0')\r\n\r\n        tf.import_graph_def(g2_graph_def, name='graph2', input_map={'input': g1_output_tensor})\r\n        g2_output_tensor = tf.get_default_graph().get_tensor_by_name('graph2/output:0')\r\n\r\n        with tf.Session() as sess:\r\n            result = sess.run(g2_output_tensor, {g1_input_tensor: test_data})\r\n            print(result)\r\n\r\n\r\n#runs fine\r\nconnect_graphs(both_are_map_graphs=False)\r\nconnect_graphs(both_are_map_graphs=True, rename_second=True)\r\n\r\n#throws error\r\nconnect_graphs(both_are_map_graphs=True)\r\n```\r\n\r\nEdit:\r\nchanged connect_graphs(both_are_map_graphs=False, rename_second=True) to connect_graphs(both_are_map_graphs=True, rename_second=True) in the example to better demonstrate the issue."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22146", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22146/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22146/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22146/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22146", "id": 358108690, "node_id": "MDU6SXNzdWUzNTgxMDg2OTA=", "number": 22146, "title": "TOCO fails to handle Dilated Convolution properly", "user": {"login": "gashmish", "id": 673872, "node_id": "MDQ6VXNlcjY3Mzg3Mg==", "avatar_url": "https://avatars1.githubusercontent.com/u/673872?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gashmish", "html_url": "https://github.com/gashmish", "followers_url": "https://api.github.com/users/gashmish/followers", "following_url": "https://api.github.com/users/gashmish/following{/other_user}", "gists_url": "https://api.github.com/users/gashmish/gists{/gist_id}", "starred_url": "https://api.github.com/users/gashmish/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gashmish/subscriptions", "organizations_url": "https://api.github.com/users/gashmish/orgs", "repos_url": "https://api.github.com/users/gashmish/repos", "events_url": "https://api.github.com/users/gashmish/events{/privacy}", "received_events_url": "https://api.github.com/users/gashmish/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "suharshs", "id": 1450614, "node_id": "MDQ6VXNlcjE0NTA2MTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/1450614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suharshs", "html_url": "https://github.com/suharshs", "followers_url": "https://api.github.com/users/suharshs/followers", "following_url": "https://api.github.com/users/suharshs/following{/other_user}", "gists_url": "https://api.github.com/users/suharshs/gists{/gist_id}", "starred_url": "https://api.github.com/users/suharshs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suharshs/subscriptions", "organizations_url": "https://api.github.com/users/suharshs/orgs", "repos_url": "https://api.github.com/users/suharshs/repos", "events_url": "https://api.github.com/users/suharshs/events{/privacy}", "received_events_url": "https://api.github.com/users/suharshs/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "suharshs", "id": 1450614, "node_id": "MDQ6VXNlcjE0NTA2MTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/1450614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suharshs", "html_url": "https://github.com/suharshs", "followers_url": "https://api.github.com/users/suharshs/followers", "following_url": "https://api.github.com/users/suharshs/following{/other_user}", "gists_url": "https://api.github.com/users/suharshs/gists{/gist_id}", "starred_url": "https://api.github.com/users/suharshs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suharshs/subscriptions", "organizations_url": "https://api.github.com/users/suharshs/orgs", "repos_url": "https://api.github.com/users/suharshs/repos", "events_url": "https://api.github.com/users/suharshs/events{/privacy}", "received_events_url": "https://api.github.com/users/suharshs/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 24, "created_at": "2018-09-07T15:17:34Z", "updated_at": "2020-02-27T09:10:28Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\nHave I written custom code (as opposed to using a stock example script provided in TensorFlow):N/A\r\nOS Platform and Distribution (e.g., Linux Ubuntu 16.04):Linux Ubuntu 16.04\r\nMobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:N/A\r\nTensorFlow installed from (source or binary):source\r\nTensorFlow version (use command below):1.10.0\r\nPython version: 2.7.12\r\nBazel version (if compiling from source):0.15.0\r\nGCC/Compiler version (if compiling from source):5.4.0\r\nCUDA/cuDNN version:N/A\r\nGPU model and memory:N/A\r\nExact command to reproduce:N/A\r\n\r\n### Problem description\r\nI have frozen_model.pb which works well.\r\n\r\nI build toco with command:\r\n`bazel build -c opt //tensorflow/contrib/lite/toco:toco`\r\n \r\nThen i'm trying to convert model to TfLite:\r\n`toco --allow_custom_ops --input_file='frozen_model.pb'  --output_file='wavenet.tflite' --input_arrays='original_input' --input_shapes='1,48000,1' --output_arrays='activation_2/Softmax' --dump_graphviz=graph --dump_graphviz_video=true`\r\n\r\n\r\nand geting error:\r\n\r\n```\r\n2018-09-07 17:45:53.870648: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 412 operators, 674 arrays (0 quantized)\r\n2018-09-07 17:45:53.876846: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 412 operators, 674 arrays (0 quantized)\r\n2018-09-07 17:45:53.877237: I tensorflow/contrib/lite/toco/graph_transformations/identify_dilated_conv.cc:161] Identified sub-network emulating dilated convolution.\r\n2018-09-07 17:45:53.877266: I tensorflow/contrib/lite/toco/graph_transformations/identify_dilated_conv.cc:209] Replaced with Dilated Conv2D op outputting \"dilated_conv_2_tanh/convolution/Conv2D\".\r\n2018-09-07 17:45:53.877487: I tensorflow/contrib/lite/toco/graph_transformations/identify_dilated_conv.cc:161] Identified sub-network emulating dilated convolution.\r\n2018-09-07 17:45:53.877512: I tensorflow/contrib/lite/toco/graph_transformations/identify_dilated_conv.cc:209] Replaced with Dilated Conv2D op outputting \"dilated_conv_2_sigm/convolution/Conv2D\".\r\n2018-09-07 17:45:53.877852: F tensorflow/contrib/lite/toco/graph_transformations/propagate_fixed_sizes.cc:116] Check failed: dim_x == dim_y (48002 vs. 48000)Dimensions must match\r\n```\r\n\r\n\r\nThis is Dilated Convolution block in original frozen_model.pb visualized in tensorboard, it has input and output shape [?, 48000, 40]:\r\n\r\n[?, 48000, 40] ->Pad->[?, 48002, 40]->SpaceToBatchND -> ExpandDims -> Conv2D -> Squeeze -> BatchToSpaceND->[?, 48000, 40]\r\n\r\n![img2](https://user-images.githubusercontent.com/673872/45226776-67d4c200-b2c8-11e8-9886-1aa498559a00.png)\r\n\r\n\r\nTOCO tries to substitute with\r\n[?, 48000, 40] ->Pad->[?, 48002, 40]->Reshape -> Conv1x1/S -> Squeze->[?, 48002, 40]\r\n![img3](https://user-images.githubusercontent.com/673872/45227203-cf8b0d00-b2c8-11e8-9092-7a4a94a731c0.png)\r\n\r\nso ouput of resulted block is [?, 48002, 40] instead of [?, 48000, 40], it causes error in subsequent operations.\r\n\r\nI managed to avoid this issue by removing line 102:\r\n`transformations->Add(new IdentifyDilatedConv);`\r\nfrom tensorflow/contrib/lite/toco/toco_tooling.cc and rebuilding TOCO,\r\nbut unfortunately this causes new problems, because some operations like SpaceToBatchND and BatchToSpaceND don't support 3D tensors in current TfLite verison.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22145", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22145/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22145/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22145/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22145", "id": 358097865, "node_id": "MDU6SXNzdWUzNTgwOTc4NjU=", "number": 22145, "title": "Depthwise convolution inside Dataset API throws data_format error", "user": {"login": "Talmaj", "id": 5983634, "node_id": "MDQ6VXNlcjU5ODM2MzQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/5983634?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Talmaj", "html_url": "https://github.com/Talmaj", "followers_url": "https://api.github.com/users/Talmaj/followers", "following_url": "https://api.github.com/users/Talmaj/following{/other_user}", "gists_url": "https://api.github.com/users/Talmaj/gists{/gist_id}", "starred_url": "https://api.github.com/users/Talmaj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Talmaj/subscriptions", "organizations_url": "https://api.github.com/users/Talmaj/orgs", "repos_url": "https://api.github.com/users/Talmaj/repos", "events_url": "https://api.github.com/users/Talmaj/events{/privacy}", "received_events_url": "https://api.github.com/users/Talmaj/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 14, "created_at": "2018-09-07T14:49:17Z", "updated_at": "2020-03-06T10:25:53Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n-  Linux Ubuntu 16.04\r\n- TensorFlow installed using: pip\r\n- TensorFlow version: 1.10\r\n- Python version: 3.6\r\n- CUDA/cuDNN version: 9.0/7.2\r\n- GPU model and memory: GeForce GTX 1080 ti\r\n\r\nI tried to reproduce the error in a simpler fashion but couldn't manage it. Basically I use dataset API to load some patches from tfrecords and apply a synthethic blur on it (loaded from another tfrrecords) similar to this:\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\ndef apply_blur(img):\r\n    blur = np.random.rand(3,3,1,1)\r\n    img = tf.nn.depthwise_conv2d(img[None], blur, [1,1,1,1], 'VALID')\r\n    return img\r\n\r\ntf.reset_default_graph()\r\ndataset = tf.data.Dataset.from_tensor_slices(np.ones((10, 128, 128, 1)))\r\ndataset = dataset.map(apply_blur, 2)\r\n\r\niterator = dataset.make_one_shot_iterator()\r\nbatch = iterator.get_next()\r\n\r\nconfig = tf.ConfigProto()\r\nconfig.gpu_options.allow_growth = True\r\nwith tf.Session(config=config) as sess:\r\n    out = sess.run(batch)\r\n```\r\n\r\nMy code is still working with tf v1.8, but not in higher versions. It says the data_format should be \"NCHW\" for \r\nDepthwise convolution on CPU, while in fact the data_format is \"NCHW\".\r\n\r\n### Source code / logs\r\n```\r\nTraceback (most recent call last):\r\n  File \"cli_deblurring.py\", line 95, in <module>\r\n    cli()\r\n  File \"/home/user/miniconda3/lib/python3.6/site-packages/click/core.py\", line 722, in __call__\r\n    return self.main(*args, **kwargs)\r\n  File \"/home/user/miniconda3/lib/python3.6/site-packages/click/core.py\", line 697, in main\r\n    rv = self.invoke(ctx)\r\n  File \"/home/user/miniconda3/lib/python3.6/site-packages/click/core.py\", line 895, in invoke\r\n    return ctx.invoke(self.callback, **ctx.params)\r\n  File \"/home/user/miniconda3/lib/python3.6/site-packages/click/core.py\", line 535, in invoke\r\n    return callback(*args, **kwargs)\r\n  File \"cli_deblurring.py\", line 90, in cli\r\n    model.train()\r\n  File \"/home/user/Project/model/__init__.py\", line 159, in train\r\n    self._train(sess)\r\n  File \"/home/user/Project/model/deblurring.py\", line 318, in _train\r\n    epoch, global_step = self._train_epoch(sess)\r\n  File \"/home/user/Project/model/deblurring.py\", line 291, in _train_epoch\r\n    sess.run(light_fetches, feed_dict=self.train_feed_dict)\r\n  File \"/home/user/miniconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 900, in run\r\n    run_metadata_ptr)\r\n  File \"/home/user/miniconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1135, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/home/user/miniconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1316, in _do_run\r\n    run_metadata)\r\n  File \"/home/user/miniconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1335, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.UnimplementedError: Depthwise convolution on CPU is only supported for NHWC format\r\n         [[Node: depthwise_3 = DepthwiseConv2dNative[T=DT_FLOAT, data_format=\"NCHW\", dilations=[1, 1, 1, 1], padding=\"VALID\", strides=[1, 1, 1, 1]](depthwise-0-TransposeNHWCToNCHW-LayoutOptimizer, strided_slice_4)]]\r\n         [[Node: load_data/IteratorGetNext = IteratorGetNext[output_shapes=[[?,8,128,128,1], [?,128,128,1]], output_types=[DT_FLOAT, DT_FLOAT], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"](load_data/Iterator)]]\r\n         [[Node: load_data/IteratorGetNext/_671 = _Recv[client_terminated=false, recv_device=\"/job:localhost/replica:0/task:0/device:GPU:0\", send_device=\"/job:localhost/replica:0/task:0/device:CPU:0\", send_device_incarnation=1, tensor_name=\"edge_64_load_data/IteratorGetNext\"\r\n, tensor_type=DT_FLOAT, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"]()]]\r\n```\r\nAny idea why this error could happen in higher versions?\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22137", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22137/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22137/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22137/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22137", "id": 357902847, "node_id": "MDU6SXNzdWUzNTc5MDI4NDc=", "number": 22137, "title": "ps0 will be OOM using MonitoredTrainingSession when workers too many", "user": {"login": "jackonan", "id": 9108860, "node_id": "MDQ6VXNlcjkxMDg4NjA=", "avatar_url": "https://avatars3.githubusercontent.com/u/9108860?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jackonan", "html_url": "https://github.com/jackonan", "followers_url": "https://api.github.com/users/jackonan/followers", "following_url": "https://api.github.com/users/jackonan/following{/other_user}", "gists_url": "https://api.github.com/users/jackonan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jackonan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jackonan/subscriptions", "organizations_url": "https://api.github.com/users/jackonan/orgs", "repos_url": "https://api.github.com/users/jackonan/repos", "events_url": "https://api.github.com/users/jackonan/events{/privacy}", "received_events_url": "https://api.github.com/users/jackonan/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "martinwicke", "id": 577277, "node_id": "MDQ6VXNlcjU3NzI3Nw==", "avatar_url": "https://avatars2.githubusercontent.com/u/577277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martinwicke", "html_url": "https://github.com/martinwicke", "followers_url": "https://api.github.com/users/martinwicke/followers", "following_url": "https://api.github.com/users/martinwicke/following{/other_user}", "gists_url": "https://api.github.com/users/martinwicke/gists{/gist_id}", "starred_url": "https://api.github.com/users/martinwicke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martinwicke/subscriptions", "organizations_url": "https://api.github.com/users/martinwicke/orgs", "repos_url": "https://api.github.com/users/martinwicke/repos", "events_url": "https://api.github.com/users/martinwicke/events{/privacy}", "received_events_url": "https://api.github.com/users/martinwicke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "martinwicke", "id": 577277, "node_id": "MDQ6VXNlcjU3NzI3Nw==", "avatar_url": "https://avatars2.githubusercontent.com/u/577277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martinwicke", "html_url": "https://github.com/martinwicke", "followers_url": "https://api.github.com/users/martinwicke/followers", "following_url": "https://api.github.com/users/martinwicke/following{/other_user}", "gists_url": "https://api.github.com/users/martinwicke/gists{/gist_id}", "starred_url": "https://api.github.com/users/martinwicke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martinwicke/subscriptions", "organizations_url": "https://api.github.com/users/martinwicke/orgs", "repos_url": "https://api.github.com/users/martinwicke/repos", "events_url": "https://api.github.com/users/martinwicke/events{/privacy}", "received_events_url": "https://api.github.com/users/martinwicke/received_events", "type": "User", "site_admin": false}, {"login": "karmel", "id": 667809, "node_id": "MDQ6VXNlcjY2NzgwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karmel", "html_url": "https://github.com/karmel", "followers_url": "https://api.github.com/users/karmel/followers", "following_url": "https://api.github.com/users/karmel/following{/other_user}", "gists_url": "https://api.github.com/users/karmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/karmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karmel/subscriptions", "organizations_url": "https://api.github.com/users/karmel/orgs", "repos_url": "https://api.github.com/users/karmel/repos", "events_url": "https://api.github.com/users/karmel/events{/privacy}", "received_events_url": "https://api.github.com/users/karmel/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-09-07T03:07:28Z", "updated_at": "2018-12-08T18:40:44Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: No\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: 1.4\r\n- **Python version**: 2.7.5\r\n- **Bazel version (if compiling from source)**: 1.9\r\n- **GCC/Compiler version (if compiling from source)**: 4.9.2\r\n- **CUDA/cuDNN version**: CPU\r\n- **GPU model and memory**: CPU\r\n- **Exact command to reproduce**: Using MonitoredTrainingSession and thousands of workers.\r\n\r\n\r\n### Describe the problem\r\nMy model is large and complex. Thousands of worker&ps are needed and MonitoredTrainingSession is used. In the stage of initialization, the memory of ps0 will raise up to 100G and then OOM, but other ps work correctly. Op device placement is tf.train.replica_device_setter and no other special strategy.\r\n\r\nI open the log_device_placement and found that all ops related with report_uninitialized_xxx are placed on ps0. I think this is the root cause.\r\n\r\nI change the code as PR #22136 , and then it works correctly.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22129", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22129/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22129/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22129/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22129", "id": 357875710, "node_id": "MDU6SXNzdWUzNTc4NzU3MTA=", "number": 22129, "title": "[Feature Request] Exporting TF-Hub for the Best Model", "user": {"login": "sumitbinnani", "id": 11199045, "node_id": "MDQ6VXNlcjExMTk5MDQ1", "avatar_url": "https://avatars3.githubusercontent.com/u/11199045?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sumitbinnani", "html_url": "https://github.com/sumitbinnani", "followers_url": "https://api.github.com/users/sumitbinnani/followers", "following_url": "https://api.github.com/users/sumitbinnani/following{/other_user}", "gists_url": "https://api.github.com/users/sumitbinnani/gists{/gist_id}", "starred_url": "https://api.github.com/users/sumitbinnani/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sumitbinnani/subscriptions", "organizations_url": "https://api.github.com/users/sumitbinnani/orgs", "repos_url": "https://api.github.com/users/sumitbinnani/repos", "events_url": "https://api.github.com/users/sumitbinnani/events{/privacy}", "received_events_url": "https://api.github.com/users/sumitbinnani/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-09-07T00:21:48Z", "updated_at": "2020-02-08T01:11:46Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: N/A\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: N/A\r\n- **TensorFlow installed from (source or binary)**: N/A\r\n- **TensorFlow version (use command below)**: N/A\r\n- **Python version**: N/A\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **GCC/Compiler version (if compiling from source)**: N/A\r\n- **CUDA/cuDNN version**: N/A\r\n- **GPU model and memory**: N/A\r\n- **Exact command to reproduce**: N/A\r\n\r\n### Describe the problem\r\nI believe that it might be helpful to have `BestExporter` equivalent for `tf-hub` too. Currently, there is no way to export hub corresponding to the bet model. The easiest way to achieve this (or at least the way I did) is to trigger the `LatestHubExporter` within the `export` of `BestExporter`.\r\n\r\nAnother design proposal:\r\nThe exporters can be chained. However, I do not know of any other use cases (other than the one above)."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22121", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22121/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22121/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22121/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22121", "id": 357764911, "node_id": "MDU6SXNzdWUzNTc3NjQ5MTE=", "number": 22121, "title": "Unable to profile tf.keras Model. Am I missing something or is it a known issue?", "user": {"login": "Nithanaroy", "id": 670556, "node_id": "MDQ6VXNlcjY3MDU1Ng==", "avatar_url": "https://avatars1.githubusercontent.com/u/670556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nithanaroy", "html_url": "https://github.com/Nithanaroy", "followers_url": "https://api.github.com/users/Nithanaroy/followers", "following_url": "https://api.github.com/users/Nithanaroy/following{/other_user}", "gists_url": "https://api.github.com/users/Nithanaroy/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nithanaroy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nithanaroy/subscriptions", "organizations_url": "https://api.github.com/users/Nithanaroy/orgs", "repos_url": "https://api.github.com/users/Nithanaroy/repos", "events_url": "https://api.github.com/users/Nithanaroy/events{/privacy}", "received_events_url": "https://api.github.com/users/Nithanaroy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "cy89", "id": 29663194, "node_id": "MDQ6VXNlcjI5NjYzMTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/29663194?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cy89", "html_url": "https://github.com/cy89", "followers_url": "https://api.github.com/users/cy89/followers", "following_url": "https://api.github.com/users/cy89/following{/other_user}", "gists_url": "https://api.github.com/users/cy89/gists{/gist_id}", "starred_url": "https://api.github.com/users/cy89/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cy89/subscriptions", "organizations_url": "https://api.github.com/users/cy89/orgs", "repos_url": "https://api.github.com/users/cy89/repos", "events_url": "https://api.github.com/users/cy89/events{/privacy}", "received_events_url": "https://api.github.com/users/cy89/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "cy89", "id": 29663194, "node_id": "MDQ6VXNlcjI5NjYzMTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/29663194?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cy89", "html_url": "https://github.com/cy89", "followers_url": "https://api.github.com/users/cy89/followers", "following_url": "https://api.github.com/users/cy89/following{/other_user}", "gists_url": "https://api.github.com/users/cy89/gists{/gist_id}", "starred_url": "https://api.github.com/users/cy89/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cy89/subscriptions", "organizations_url": "https://api.github.com/users/cy89/orgs", "repos_url": "https://api.github.com/users/cy89/repos", "events_url": "https://api.github.com/users/cy89/events{/privacy}", "received_events_url": "https://api.github.com/users/cy89/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-09-06T18:02:52Z", "updated_at": "2019-02-01T09:59:22Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: RHEL 7\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: NA\r\n- **TensorFlow installed from (source or binary)**: No\r\n- **TensorFlow version (use command below)**: 1.9\r\n- **Python version**: 2.7\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**:\r\n- **GPU model and memory**: NA\r\n- **Exact command to reproduce**: Below code\r\n\r\n### Describe the problem\r\n**tf.contrib.tfprof** does not profile tf.keras Model. Am I missing something or is it a known issue?\r\n\r\n### Source code / logs\r\nThe goal is to find what % of total time is spent in the input pipeline (mostly IO) and what % of total time is spent on model training \u2013 ideally a chart like the one presented in the [Training Performance session](https://www.youtube.com/watch?v=SxOsJPaxHME&feature=youtu.be&t=977) at tf dev summit 2018.\r\n\r\n**Model Training:**\r\n```python\r\ntraining_set = tfdata_generator_with_interleave([\u201cf1.avro\u201d, \u201cf2.avro\u201d, \u2026], is_training=True, batch_size=512, preprocess_fn=preprocess_fn_dense)\r\nvalidation_set = tfdata_generator_with_interleave([\u201cf1_val.avro\u201d, \u201cf2_val.avro\u201d, \u2026], is_training=False, batch_size=512, preprocess_fn=preprocess_fn_dense)\r\nmodel = my_tf_keras_dense_deep_model()\r\nmodel.compile(loss='categorical_crossentropy', optimizer=\u201dadam\u201d, metrics=['accuracy'])\r\n\r\nwith tf.contrib.tfprof.ProfileContext( './profiles/dense_model\u2019) ) as pctx:\r\n   model.fit(\r\n                training_set.make_one_shot_iterator(),\r\n                steps_per_epoch=TOTAL_TRAIN_RECORDS // _BATCH_SIZE, # need this as we are feeding data using a generator\r\n                epochs=_EPOCHS,\r\n                validation_data= validation_set.make_one_shot_iterator(),\r\n                validation_steps=TOTAL_TEST_RECORDS // _BATCH_SIZE,\r\n                callbacks=[tensorboard])\r\n```\r\n\r\n**Input Pipeline:**\r\n```python\r\ndef tfdata_generator_with_interleave(data_files, is_training, batch_size=128, preprocess_fn=preprocess_fn_dense):\r\n    def wrap_generator(filename):\r\n        return tf.data.Dataset.from_generator(read_local_avro_data_gen, (tf.float32, tf.float64),\r\n                                              args=[filename, batch_size / 4])\r\n\r\n    files = tf.data.Dataset.from_tensor_slices(data_files)\r\n    dataset = files.apply(tf.contrib.data.parallel_interleave(wrap_generator, cycle_length=4, sloppy=True))\r\n    dataset = dataset.flat_map(lambda *x: tf.data.Dataset.from_tensor_slices(x))\r\n\r\n    if is_training:\r\n        dataset = dataset.apply(tf.contrib.data.shuffle_and_repeat(1000, -1, 42))\r\n\r\n    dataset = dataset.apply(tf.contrib.data.map_and_batch(preprocess_fn, batch_size,\r\n                                                          num_parallel_batches=num_parallel_data_fetch,\r\n                                                          drop_remainder=True if is_training else False)\r\n                            )\r\n\r\n    dataset = dataset.prefetch(tf.contrib.data.AUTOTUNE)\r\n    return dataset\r\n```\r\n\r\nBut I do not see any files to load into tensorboard or chrome in ./profiles directory. Does the profile not work with tf.keras models? Or Am I missing any setup?\r\n\r\nAlso tried contacting the email address mentioned on the [Profiler README](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/profiler/README.md) - xpan@google.com, but message sending failed.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22119", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22119/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22119/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22119/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22119", "id": 357759534, "node_id": "MDU6SXNzdWUzNTc3NTk1MzQ=", "number": 22119, "title": "XLA commonly aborts with nvidia error", "user": {"login": "joeyearsley", "id": 1836025, "node_id": "MDQ6VXNlcjE4MzYwMjU=", "avatar_url": "https://avatars2.githubusercontent.com/u/1836025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joeyearsley", "html_url": "https://github.com/joeyearsley", "followers_url": "https://api.github.com/users/joeyearsley/followers", "following_url": "https://api.github.com/users/joeyearsley/following{/other_user}", "gists_url": "https://api.github.com/users/joeyearsley/gists{/gist_id}", "starred_url": "https://api.github.com/users/joeyearsley/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joeyearsley/subscriptions", "organizations_url": "https://api.github.com/users/joeyearsley/orgs", "repos_url": "https://api.github.com/users/joeyearsley/repos", "events_url": "https://api.github.com/users/joeyearsley/events{/privacy}", "received_events_url": "https://api.github.com/users/joeyearsley/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "shivaniag", "id": 16565716, "node_id": "MDQ6VXNlcjE2NTY1NzE2", "avatar_url": "https://avatars1.githubusercontent.com/u/16565716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shivaniag", "html_url": "https://github.com/shivaniag", "followers_url": "https://api.github.com/users/shivaniag/followers", "following_url": "https://api.github.com/users/shivaniag/following{/other_user}", "gists_url": "https://api.github.com/users/shivaniag/gists{/gist_id}", "starred_url": "https://api.github.com/users/shivaniag/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shivaniag/subscriptions", "organizations_url": "https://api.github.com/users/shivaniag/orgs", "repos_url": "https://api.github.com/users/shivaniag/repos", "events_url": "https://api.github.com/users/shivaniag/events{/privacy}", "received_events_url": "https://api.github.com/users/shivaniag/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "shivaniag", "id": 16565716, "node_id": "MDQ6VXNlcjE2NTY1NzE2", "avatar_url": "https://avatars1.githubusercontent.com/u/16565716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shivaniag", "html_url": "https://github.com/shivaniag", "followers_url": "https://api.github.com/users/shivaniag/followers", "following_url": "https://api.github.com/users/shivaniag/following{/other_user}", "gists_url": "https://api.github.com/users/shivaniag/gists{/gist_id}", "starred_url": "https://api.github.com/users/shivaniag/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shivaniag/subscriptions", "organizations_url": "https://api.github.com/users/shivaniag/orgs", "repos_url": "https://api.github.com/users/shivaniag/repos", "events_url": "https://api.github.com/users/shivaniag/events{/privacy}", "received_events_url": "https://api.github.com/users/shivaniag/received_events", "type": "User", "site_admin": false}, {"login": "tfboyd", "id": 23486130, "node_id": "MDQ6VXNlcjIzNDg2MTMw", "avatar_url": "https://avatars1.githubusercontent.com/u/23486130?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tfboyd", "html_url": "https://github.com/tfboyd", "followers_url": "https://api.github.com/users/tfboyd/followers", "following_url": "https://api.github.com/users/tfboyd/following{/other_user}", "gists_url": "https://api.github.com/users/tfboyd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tfboyd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tfboyd/subscriptions", "organizations_url": "https://api.github.com/users/tfboyd/orgs", "repos_url": "https://api.github.com/users/tfboyd/repos", "events_url": "https://api.github.com/users/tfboyd/events{/privacy}", "received_events_url": "https://api.github.com/users/tfboyd/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 25, "created_at": "2018-09-06T17:46:57Z", "updated_at": "2018-12-19T18:49:15Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**: Source\r\n- **TensorFlow version (use command below)**: 1.10\r\n- **Python version**: 3.5\r\n- **Bazel version (if compiling from source)**: 0.15\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**: 9.2 / 7.2.1.38\r\n- **GPU model and memory**: Titan\r\n- **Exact command to reproduce**: N/A\r\n\r\n### Describe the problem\r\nWhen running XLA via the session config we commonly hit the following error:\r\n\r\n`2018-09-06 17:28:38.814423: F tensorflow/stream_executor/cuda/cuda_dnn.cc:211] Check failed: status == CUDNN_STATUS_SUCCESS (7 vs. 0)Failed to set cuDNN stream.\r\n`\r\n\r\nHowever, sometimes we get further than this error and see significant speed up with XLA and the loss decreasing.\r\n\r\nWhat could be causing this error?\r\n\r\nThe docker image is located at: https://hub.docker.com/r/joeyearsley/tf-builds/\r\n\r\nI can't diverge the exact script, however I do have the following:\r\n- NCCL for multi-gpu reduction like TF-Benchmark's Variable Manager\r\n- `tf.data` APIs including the string handles to alter between train and validation datasets.\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22116", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22116/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22116/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22116/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22116", "id": 357722019, "node_id": "MDU6SXNzdWUzNTc3MjIwMTk=", "number": 22116, "title": "[1.10.1] op_level_cost_estimator.cc:404] Check failed: 0 < gflops (0 vs. 0)", "user": {"login": "cdluminate", "id": 5723047, "node_id": "MDQ6VXNlcjU3MjMwNDc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5723047?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cdluminate", "html_url": "https://github.com/cdluminate", "followers_url": "https://api.github.com/users/cdluminate/followers", "following_url": "https://api.github.com/users/cdluminate/following{/other_user}", "gists_url": "https://api.github.com/users/cdluminate/gists{/gist_id}", "starred_url": "https://api.github.com/users/cdluminate/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cdluminate/subscriptions", "organizations_url": "https://api.github.com/users/cdluminate/orgs", "repos_url": "https://api.github.com/users/cdluminate/repos", "events_url": "https://api.github.com/users/cdluminate/events{/privacy}", "received_events_url": "https://api.github.com/users/cdluminate/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "cy89", "id": 29663194, "node_id": "MDQ6VXNlcjI5NjYzMTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/29663194?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cy89", "html_url": "https://github.com/cy89", "followers_url": "https://api.github.com/users/cy89/followers", "following_url": "https://api.github.com/users/cy89/following{/other_user}", "gists_url": "https://api.github.com/users/cy89/gists{/gist_id}", "starred_url": "https://api.github.com/users/cy89/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cy89/subscriptions", "organizations_url": "https://api.github.com/users/cy89/orgs", "repos_url": "https://api.github.com/users/cy89/repos", "events_url": "https://api.github.com/users/cy89/events{/privacy}", "received_events_url": "https://api.github.com/users/cy89/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "cy89", "id": 29663194, "node_id": "MDQ6VXNlcjI5NjYzMTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/29663194?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cy89", "html_url": "https://github.com/cy89", "followers_url": "https://api.github.com/users/cy89/followers", "following_url": "https://api.github.com/users/cy89/following{/other_user}", "gists_url": "https://api.github.com/users/cy89/gists{/gist_id}", "starred_url": "https://api.github.com/users/cy89/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cy89/subscriptions", "organizations_url": "https://api.github.com/users/cy89/orgs", "repos_url": "https://api.github.com/users/cy89/repos", "events_url": "https://api.github.com/users/cy89/events{/privacy}", "received_events_url": "https://api.github.com/users/cy89/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-09-06T15:57:33Z", "updated_at": "2018-12-08T18:40:40Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: no\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: debian experimental\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: no\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: 1.10.1\r\n- **Python version**: not related\r\n- **Bazel version (if compiling from source)**: not related\r\n- **GCC/Compiler version (if compiling from source)**: gcc8\r\n- **CUDA/cuDNN version**: not related\r\n- **GPU model and memory**: not related\r\n- **Exact command to reproduce**:\r\n\r\n### Describe the problem\r\n\r\nI built tensorflow from source with a customized build system instead of bazel. https://salsa.debian.org/science-team/tensorflow . I can successfully build libtensorflow_cc.so according to the bazel query result. However when running `benchmark_model` test I encountered this problem:\r\n\r\n```\r\n$ LD_LIBRARY_PATH=. ./tf_benchmark_model --graph=../tensorflow_inception_graph.pb --num_threads=1\r\n2018-09-06 15:45:23.316799: I tensorflow/tools/benchmark/benchmark_model.cc:469] Graph: [../tensorflow_inception_graph.pb.pb]\r\n2018-09-06 15:45:23.316843: I tensorflow/tools/benchmark/benchmark_model.cc:470] Init ops:\r\n2018-09-06 15:45:23.316848: I tensorflow/tools/benchmark/benchmark_model.cc:471] Input layers: [input:0]\r\n2018-09-06 15:45:23.316852: I tensorflow/tools/benchmark/benchmark_model.cc:472] Input shapes: [1,224,224,3]\r\n2018-09-06 15:45:23.316855: I tensorflow/tools/benchmark/benchmark_model.cc:473] Input types: [float]\r\n2018-09-06 15:45:23.316859: I tensorflow/tools/benchmark/benchmark_model.cc:474] Output layers: [output:0]\r\n2018-09-06 15:45:23.316862: I tensorflow/tools/benchmark/benchmark_model.cc:475] Target layers: []\r\n2018-09-06 15:45:23.316868: I tensorflow/tools/benchmark/benchmark_model.cc:476] Num runs: [1000]\r\n2018-09-06 15:45:23.316874: I tensorflow/tools/benchmark/benchmark_model.cc:477] Inter-inference delay (seconds): [-1.0]\r\n2018-09-06 15:45:23.316898: I tensorflow/tools/benchmark/benchmark_model.cc:478] Inter-benchmark delay (seconds): [-1.0]\r\n2018-09-06 15:45:23.316903: I tensorflow/tools/benchmark/benchmark_model.cc:480] Num threads: [1]\r\n2018-09-06 15:45:23.316907: I tensorflow/tools/benchmark/benchmark_model.cc:481] Benchmark name: []\r\n2018-09-06 15:45:23.316911: I tensorflow/tools/benchmark/benchmark_model.cc:482] Output prefix: []\r\n2018-09-06 15:45:23.316915: I tensorflow/tools/benchmark/benchmark_model.cc:483] Show sizes: [0]\r\n2018-09-06 15:45:23.316932: I tensorflow/tools/benchmark/benchmark_model.cc:484] Warmup runs: [1]\r\n2018-09-06 15:45:23.316937: I tensorflow/tools/benchmark/benchmark_model.cc:251] Loading TensorFlow.\r\n2018-09-06 15:45:23.316950: I tensorflow/tools/benchmark/benchmark_model.cc:258] Got config, 0 devices\r\n2018-09-06 15:45:23.317031: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE3 SSE4.1 SSE4.2 AVX AVX2 FMA\r\n2018-09-06 15:45:23.380132: I tensorflow/tools/benchmark/benchmark_model.cc:496] Initialized session in 0.063179s\r\n2018-09-06 15:45:23.380206: I tensorflow/tools/benchmark/benchmark_model.cc:327] Running benchmark for max 1 iterations, max -1 seconds without detailed stat logging, with -1s sleep between inferences\r\n2018-09-06 15:45:23.516527: F tensorflow/core/grappler/costs/op_level_cost_estimator.cc:404] Check failed: 0 < gflops (0 vs. 0)type: \"CPU\"\r\nvendor: \"GenuineIntel\"\r\nmodel: \"110\"\r\nnum_cores: 4\r\nenvironment {\r\n  key: \"cpu_instruction_set\"\r\n  value: \"SSE, SSE2\"\r\n}\r\nenvironment {\r\n  key: \"eigen\"\r\n  value: \"3.3.90\"\r\n}\r\nl1_cache_size: 32768\r\nl2_cache_size: 262144\r\nl3_cache_size: 6291456\r\nmemory_size: 8558383104\r\n\r\nAborted\r\n```\r\n\r\nthe `tensorflow_inception_graph.pb` files comes from `tensorflow/contrib/makefile/README.md`\r\n\r\n### Source code / logs\r\n\r\nhttps://salsa.debian.org/science-team/tensorflow\r\n\r\nFor error log see above.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22109", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22109/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22109/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22109/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22109", "id": 357563704, "node_id": "MDU6SXNzdWUzNTc1NjM3MDQ=", "number": 22109, "title": "TocoConverter: permute layer after dim-reducing reshape / squeeze: error on conversion", "user": {"login": "MaximilianStaab", "id": 830908, "node_id": "MDQ6VXNlcjgzMDkwOA==", "avatar_url": "https://avatars0.githubusercontent.com/u/830908?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MaximilianStaab", "html_url": "https://github.com/MaximilianStaab", "followers_url": "https://api.github.com/users/MaximilianStaab/followers", "following_url": "https://api.github.com/users/MaximilianStaab/following{/other_user}", "gists_url": "https://api.github.com/users/MaximilianStaab/gists{/gist_id}", "starred_url": "https://api.github.com/users/MaximilianStaab/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MaximilianStaab/subscriptions", "organizations_url": "https://api.github.com/users/MaximilianStaab/orgs", "repos_url": "https://api.github.com/users/MaximilianStaab/repos", "events_url": "https://api.github.com/users/MaximilianStaab/events{/privacy}", "received_events_url": "https://api.github.com/users/MaximilianStaab/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2018-09-06T09:09:58Z", "updated_at": "2020-01-31T23:57:45Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: -\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: v1.10.1-0-g4dcfddc5d1 1.10.1\r\n- **Python version**: 3.5.5\r\n- **Bazel version (if compiling from source)**: -\r\n- **GCC/Compiler version (if compiling from source)**: -\r\n- **CUDA/cuDNN version**: V9.0.176\r\n- **GPU model and memory**: NVIDIA TITAN Xp, 12196MiB\r\n- **Exact command to reproduce**: see minimum example code below\r\n\r\n\r\n### Describe the problem\r\nThe code example below containing a model with an input, \"transformation\" and permute layer compiles fine on pc and it is also possible to call `predict()`on it and getting the expected results.\r\nThe input layer expects the last dimension to be 1, the transform layer being either a reshape or a squeeze layer gets rid of the 1, and the permutation layer just pushes the first dimension after the batch size to the end.\r\nThe native Keras reshape layer (A) is the only one that doesn't work because it doesn't support dimensionality reduction. Its output shape would be `(None, None, 10, 42)`.\r\nHowever, lines (B), (C) and (D) all work fine and it doesn't matter which one is commented in.\r\nIn the same way it doesn't matter whether the Keras permute layer (E) or the backend version (F) is commented in.\r\n\r\nIf all transform layers (A-D) are commented out and only one permute layer (E) or (F) is commented in, directly gets passed `input` and an input shape of `(2,3,1)` for (E) or `(0,2,3,1)` for (F), the model compiles and the `TocoConverter` produces a tflite-file.\r\nIf all permute layers (E, F) are commented out and only one transform layer (B) or (C) or (D) is commented in and the `outputs` of `Model` is set to `[transform]`, the model also compiles and the `TocoConverter` produces a tflite-file.\r\n\r\nBut for each combination of (B-C) and (E, F) being commented in so that one transform layer and one permute layer is there, the TocoConverter doesn't produce a tflite-file although the model compiles and the model summary looks as it should.\r\n\r\nThe expected result is the minimum example code running without errors and producing a tflite model file from the converted keras model file.\r\n\r\n---------------\r\n**Edit: For the time being and for everyone with the same problem, I wrote an updated minimum example code with an \"emulated\" permute layer as a workaround. It uses split, concatenate and reshape operations and you find it at the end of this page after the tracebacks.**\r\n\r\n---------------\r\n\r\n### Source code / logs\r\n#### Minimum Example Code:\r\n```python\r\nfrom tensorflow.keras import Model\r\nfrom tensorflow.keras.models import save_model\r\n\r\nfrom tensorflow.keras.layers import Input, Lambda, Permute, Reshape\r\nfrom tensorflow.keras.backend import permute_dimensions\r\nfrom tensorflow.keras.backend import squeeze as b_squeeze\r\nfrom tensorflow import reshape, squeeze\r\n\r\nfrom tensorflow.contrib import lite\r\n\r\n\r\ninput = Input(shape=(10, 42, 1))\r\n\r\n# transform = Reshape((-1, 10, 42))(input)\t\t\t\t\t# (A)\r\ntransform = Lambda(lambda x: reshape(x, (-1, 10, 42)))(input)\t\t\t# (B)\r\n# transform = Lambda(lambda x: squeeze(x, axis=-1))(input)\t\t\t# (C)\r\n# transform = Lambda(lambda x: b_squeeze(x, axis=-1))(input)\t\t\t# (D)\r\n\r\npermute = Permute((2,1))(transform)\t\t\t\t\t\t# (E)\r\n# permute = Lambda(lambda x: permute_dimensions(x, (0,2,1)))(transform)\t\t# (F)\r\n\r\nkeras_model = Model(inputs=[input], outputs=[permute])\r\nkeras_model.compile(loss='categorical_crossentropy', optimizer='sgd', metrics=['accuracy'])\r\n\r\n\r\nprint(keras_model.summary())\r\nsave_model(model=keras_model, filepath=\"keras_model.hdf5\",\r\n\toverwrite=True, include_optimizer=True)\r\n\r\nconverter = lite.TocoConverter.from_keras_model_file(\"keras_model.hdf5\")\r\ntflite_model = converter.convert()\r\nwith open(\"tflite_model.tflite\", \"wb\") as f: f.write(tflite_model)\r\n```\r\n\r\n#### keras_model.summary() for each of the valid six combinations:\r\n```\r\n_________________________________________________________________\r\nLayer (type)                 Output Shape              Param #\r\n=================================================================\r\ninput_1 (InputLayer)         (None, 10, 42, 1)         0\r\n_________________________________________________________________\r\nlambda (Lambda)              (None, 10, 42)            0\r\n_________________________________________________________________\r\npermute (Permute)            (None, 42, 10)            0\r\n=================================================================\r\nTotal params: 0\r\nTrainable params: 0\r\nNon-trainable params: 0\r\n_________________________________________________________________\r\n```\r\n\r\n#### Traceback for (B)+(E) and (B)+(F):\r\n```\r\nTraceback (most recent call last):\r\n  File \"minimal.py\", line 32, in <module>\r\n    tflite_model = converter.convert()\r\n  File \"/usr/stud/staab/anaconda3/envs/tensorflow/lib/python3.5/site-packages/tensorflow/contrib/lite/python/lite.py\", line 374, in convert\r\n    dump_graphviz_video=self.dump_graphviz_video)\r\n  File \"/usr/stud/staab/anaconda3/envs/tensorflow/lib/python3.5/site-packages/tensorflow/contrib/lite/python/convert.py\", line 246, in toco_convert\r\n    input_data.SerializeToString())\r\n  File \"/usr/stud/staab/anaconda3/envs/tensorflow/lib/python3.5/site-packages/tensorflow/contrib/lite/python/convert.py\", line 106, in toco_convert_protos\r\n    (stdout, stderr))\r\nRuntimeError: TOCO failed see console for info.\r\nb'2018-09-06 10:40:25.228797: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 2 operators, 5 arrays (0 quantized)\\n\r\n2018-09-06 10:40:25.228949: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 2 operators, 5 arrays (0 quantized)\\n\r\n2018-09-06 10:40:25.229050: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 1: 2 operators, 5 arrays (0 quantized)\\n\r\n2018-09-06 10:40:25.229088: F tensorflow/contrib/lite/toco/graph_transformations/propagate_fixed_sizes.cc:1402] Check failed: axis < input_shape.dimensions_count() (1211997096 vs. 4)\\n\r\nAborted (core dumped)\\n'\r\nNone\r\n```\r\nThe number 1211997096 is always randomly different and even can be negative.\r\n\r\n#### Traceback for (C)+(E), (D)+(E), (C)+(F) and (D)+(F):\r\n```\r\nTraceback (most recent call last):\r\n  File \"minimal.py\", line 32, in <module>\r\n    tflite_model = converter.convert()\r\n  File \"/usr/stud/staab/anaconda3/envs/tensorflow/lib/python3.5/site-packages/tensorflow/contrib/lite/python/lite.py\", line 374, in convert\r\n    dump_graphviz_video=self.dump_graphviz_video)\r\n  File \"/usr/stud/staab/anaconda3/envs/tensorflow/lib/python3.5/site-packages/tensorflow/contrib/lite/python/convert.py\", line 246, in toco_convert\r\n    input_data.SerializeToString())\r\n  File \"/usr/stud/staab/anaconda3/envs/tensorflow/lib/python3.5/site-packages/tensorflow/contrib/lite/python/convert.py\", line 106, in toco_convert_protos\r\n    (stdout, stderr))\r\nRuntimeError: TOCO failed see console for info.\r\nb'2018-09-06 10:44:46.550688: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 2 operators, 4 arrays (0 quantized)\\n\r\n2018-09-06 10:44:46.550805: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 2 operators, 4 arrays (0 quantized)\\n\r\n2018-09-06 10:44:46.550870: F tensorflow/contrib/lite/toco/graph_transformations/propagate_fixed_sizes.cc:1395] Check failed: perm.size() == input_shape.dimensions_count() (3 vs. 4)Transpose permutation input permute/transpose/perm must be same length as input dimensions\\n\r\nAborted (core dumped)\\n'\r\nNone\r\n```\r\n\r\n#### Minimum Example Code with Workaround:\r\n```python\r\nfrom tensorflow.keras import Model\r\nfrom tensorflow.keras.models import save_model\r\n\r\nfrom tensorflow.keras.layers import Input, Lambda, Permute, Reshape, concatenate\r\nfrom tensorflow.keras.backend import permute_dimensions\r\nfrom tensorflow.keras.backend import squeeze as b_squeeze\r\nfrom tensorflow import reshape, squeeze, split, expand_dims\r\n\r\nfrom tensorflow.contrib import lite\r\n\r\n\r\ninput = Input(shape=(10, 42, 1))\r\n\r\n# transform = Reshape((-1, 10, 42))(input)\t\t\t\t\t# (A)\r\ntransform = Lambda(lambda x: reshape(x, (-1, 10, 42)))(input)\t\t\t# (B)\r\n# transform = Lambda(lambda x: squeeze(x, axis=-1))(input)\t\t\t# (C)\r\n# transform = Lambda(lambda x: b_squeeze(x, axis=-1))(input)\t\t\t# (D)\r\n\r\n# Emulated permute to come around a bug: split, concatenate, reshape\r\n#------------------------------------------------------------------------------\r\nsplit_p = Lambda(lambda x: split(expand_dims(x, axis=-1), num_or_size_splits=10,\r\n                                                            axis=1))(transform)\r\nmerge_p = concatenate(split_p)\r\nsqueeze_p = Lambda(lambda x: reshape(x, (-1, 42, 10)))(merge_p)\r\n#------------------------------------------------------------------------------\r\n\r\nkeras_model = Model(inputs=[input], outputs=[squeeze_p])\r\nkeras_model.compile(loss='categorical_crossentropy', optimizer='sgd', metrics=['accuracy'])\r\n\r\n\r\nprint(keras_model.summary())\r\nsave_model(model=keras_model, filepath=\"keras_model.hdf5\",\r\n\toverwrite=True, include_optimizer=True)\r\n\r\nconverter = lite.TocoConverter.from_keras_model_file(\"keras_model.hdf5\")\r\ntflite_model = converter.convert()\r\nwith open(\"tflite_model.tflite\", \"wb\") as f: f.write(tflite_model)\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22108", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22108/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22108/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22108/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22108", "id": 357560570, "node_id": "MDU6SXNzdWUzNTc1NjA1NzA=", "number": 22108, "title": "tf.nightly-gpu will create \"nan\" in  next batch train value", "user": {"login": "Q82822", "id": 36806042, "node_id": "MDQ6VXNlcjM2ODA2MDQy", "avatar_url": "https://avatars2.githubusercontent.com/u/36806042?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Q82822", "html_url": "https://github.com/Q82822", "followers_url": "https://api.github.com/users/Q82822/followers", "following_url": "https://api.github.com/users/Q82822/following{/other_user}", "gists_url": "https://api.github.com/users/Q82822/gists{/gist_id}", "starred_url": "https://api.github.com/users/Q82822/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Q82822/subscriptions", "organizations_url": "https://api.github.com/users/Q82822/orgs", "repos_url": "https://api.github.com/users/Q82822/repos", "events_url": "https://api.github.com/users/Q82822/events{/privacy}", "received_events_url": "https://api.github.com/users/Q82822/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "shivaniag", "id": 16565716, "node_id": "MDQ6VXNlcjE2NTY1NzE2", "avatar_url": "https://avatars1.githubusercontent.com/u/16565716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shivaniag", "html_url": "https://github.com/shivaniag", "followers_url": "https://api.github.com/users/shivaniag/followers", "following_url": "https://api.github.com/users/shivaniag/following{/other_user}", "gists_url": "https://api.github.com/users/shivaniag/gists{/gist_id}", "starred_url": "https://api.github.com/users/shivaniag/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shivaniag/subscriptions", "organizations_url": "https://api.github.com/users/shivaniag/orgs", "repos_url": "https://api.github.com/users/shivaniag/repos", "events_url": "https://api.github.com/users/shivaniag/events{/privacy}", "received_events_url": "https://api.github.com/users/shivaniag/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "shivaniag", "id": 16565716, "node_id": "MDQ6VXNlcjE2NTY1NzE2", "avatar_url": "https://avatars1.githubusercontent.com/u/16565716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shivaniag", "html_url": "https://github.com/shivaniag", "followers_url": "https://api.github.com/users/shivaniag/followers", "following_url": "https://api.github.com/users/shivaniag/following{/other_user}", "gists_url": "https://api.github.com/users/shivaniag/gists{/gist_id}", "starred_url": "https://api.github.com/users/shivaniag/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shivaniag/subscriptions", "organizations_url": "https://api.github.com/users/shivaniag/orgs", "repos_url": "https://api.github.com/users/shivaniag/repos", "events_url": "https://api.github.com/users/shivaniag/events{/privacy}", "received_events_url": "https://api.github.com/users/shivaniag/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-09-06T09:01:22Z", "updated_at": "2018-12-07T18:52:41Z", "closed_at": null, "author_association": "NONE", "body": "\r\n------------------------\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: \r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:Linux Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: 1.11.0   (use tf-night-gpu)\r\n- **Python version**:2.7\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**: 9.0 /7.1\r\n- **GPU model and memory**:\r\n- **Exact command to reproduce**:\r\n\r\n### Describe the problem\r\nI installed  tf-night-gpu, and my` tf.__version__` was `1.11.0-dev20180905`\r\nit only use `tf-night-gpu` can create  the `tf.keras.applications.InceptionResNetV2` model so i can't without. my problem is the  `tf-night-gpu` will create `nan`  in  next batch model output \r\n\r\n### Source code / logs\r\nin first batch train the\r\n```\r\n('keras.layers.Embedding_input: ', <tf.Tensor: id=4586198, shape=(64, 1), dtype=int32, numpy=\r\narray([[3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3]], dtype=int32)>)\r\n('Embedding_output:  ', <tf.Tensor: id=4586379, shape=(64, 1, 256), dtype=float32, numpy=\r\narray([[[ 0.01097491, -0.02041122,  0.04823625, ..., -0.0155656 ,\r\n          0.01521399, -0.0496642 ]],\r\n\r\n       [[ 0.01097491, -0.02041122,  0.04823625, ..., -0.0155656 ,\r\n          0.01521399, -0.0496642 ]],\r\n\r\n       [[ 0.01097491, -0.02041122,  0.04823625, ..., -0.0155656 ,\r\n          0.01521399, -0.0496642 ]],\r\n\r\n       ...,\r\n\r\n       [[ 0.01097491, -0.02041122,  0.04823625, ..., -0.0155656 ,\r\n          0.01521399, -0.0496642 ]],\r\n\r\n       [[ 0.01097491, -0.02041122,  0.04823625, ..., -0.0155656 ,\r\n          0.01521399, -0.0496642 ]],\r\n\r\n       [[ 0.01097491, -0.02041122,  0.04823625, ..., -0.0155656 ,\r\n          0.01521399, -0.0496642 ]]], dtype=float32)>)\r\n```\r\nthe next batch train , have same `keras.layers.Embedding_input: `\r\n```\r\n`Epoch 1 Batch 0 Loss 2.0415\r\n(''keras.layers.Embedding_input:: ', <tf.Tensor: id=4607289, shape=(64, 1), dtype=int32, numpy=\r\narray([[3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3],\r\n       [3]], dtype=int32)>)\r\n(''keras.layers.Embedding_output::  ', <tf.Tensor: id=4607374, shape=(64, 1, 256), dtype=float32, numpy=\r\narray([[[nan, nan, nan, ..., nan, nan, nan]],\r\n\r\n       [[nan, nan, nan, ..., nan, nan, nan]],\r\n\r\n       [[nan, nan, nan, ..., nan, nan, nan]],\r\n\r\n\r\n       [[nan, nan, nan, ..., nan, nan, nan]],\r\n\r\n       [[nan, nan, nan, ..., nan, nan, nan]],\r\n\r\n       [[nan, nan, nan, ..., nan, nan, nan]]], dtype=float32)>)`\r\n```\r\nand \"nan\" forever....."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22098", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22098/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22098/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22098/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22098", "id": 357366660, "node_id": "MDU6SXNzdWUzNTczNjY2NjA=", "number": 22098, "title": "Memory issue when inter_op_parallelism_threads > 1 on Ubuntu 16.04", "user": {"login": "btaba", "id": 7320238, "node_id": "MDQ6VXNlcjczMjAyMzg=", "avatar_url": "https://avatars3.githubusercontent.com/u/7320238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/btaba", "html_url": "https://github.com/btaba", "followers_url": "https://api.github.com/users/btaba/followers", "following_url": "https://api.github.com/users/btaba/following{/other_user}", "gists_url": "https://api.github.com/users/btaba/gists{/gist_id}", "starred_url": "https://api.github.com/users/btaba/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/btaba/subscriptions", "organizations_url": "https://api.github.com/users/btaba/orgs", "repos_url": "https://api.github.com/users/btaba/repos", "events_url": "https://api.github.com/users/btaba/events{/privacy}", "received_events_url": "https://api.github.com/users/btaba/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 18, "created_at": "2018-09-05T19:15:48Z", "updated_at": "2019-12-17T10:16:24Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes, see below\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: \r\n```\r\n== cat /etc/issue ===============================================\r\nLinux ml 4.4.0-87-generic #110-Ubuntu SMP Tue Jul 18 12:55:35 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\r\nVERSION=\"16.04.3 LTS (Xenial Xerus)\"\r\nVERSION_ID=\"16.04\"\r\nVERSION_CODENAME=xenial\r\n\r\n== are we in docker =============================================\r\nNo\r\n\r\n== compiler =====================================================\r\nc++ (Ubuntu 5.4.0-6ubuntu1~16.04.9) 5.4.0 20160609\r\nCopyright (C) 2015 Free Software Foundation, Inc.\r\nThis is free software; see the source for copying conditions.  There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n\r\n\r\n== uname -a =====================================================\r\nLinux ml 4.4.0-87-generic #110-Ubuntu SMP Tue Jul 18 12:55:35 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n== check pips ===================================================\r\nnumpy (1.14.3)\r\nprotobuf (3.6.1)\r\ntensorflow (1.10.0)\r\ntensorflow-tensorboard (0.4.0)\r\n\r\n== check for virtualenv =========================================\r\nTrue\r\n\r\n== tensorflow import ============================================\r\ntf.VERSION = 1.10.0\r\ntf.GIT_VERSION = v1.10.0-0-g656e7a2b34\r\ntf.COMPILER_VERSION = v1.10.0-0-g656e7a2b34\r\nSanity check: array([1], dtype=int32)\r\n/home/btabanpour/mlpy/lib/python3.5/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\r\n  from ._conv import register_converters as _register_converters\r\n\r\n== env ==========================================================\r\nLD_LIBRARY_PATH /usr/local/cuda/lib64:/home/anaconda3/lib/\r\nDYLD_LIBRARY_PATH is unset\r\n\r\n```\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: NA\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: 1.10.0\r\n- **Python version**: Python 3.5.2\r\n- **Bazel version (if compiling from source)**: NA\r\n- **GCC/Compiler version (if compiling from source)**: NA\r\n- **CUDA/cuDNN version**: NA\r\n- **GPU model and memory**: NA\r\n- **Exact command to reproduce**:\r\n\r\n\r\nSave this file as `reproduce.py`:\r\n\r\n```python\r\nimport numpy as np\r\nfrom tensorflow.keras.applications.inception_v3 import InceptionV3\r\nfrom memory_profiler import profile\r\n\r\nimage = np.random.random((1, 299, 299, 3))\r\n\r\n@profile\r\ndef predict():\r\n    m.predict(image)\r\n\r\n\r\nif __name__ == '__main__':\r\n    m = InceptionV3()  # or any other large network like VGG19()\r\n    for _ in range(100):\r\n        predict()\r\n```\r\n\r\nI run `python reproduce.py` and memory increases from ~500MiB to ~1200MiB after 100 calls of `predict()`, **running on CPU**. Here is truncated output:\r\n\r\n```\r\n > python reproduce.py\r\n2018-09-05 14:41:10.229405: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\nFilename: reproduce.py\r\n\r\nLine #    Mem usage    Increment   Line Contents\r\n================================================\r\n     7    493.0 MiB    493.0 MiB   @profile\r\n     8                             def predict():\r\n     9    524.8 MiB     31.8 MiB       m.predict(image)\r\n\r\n\r\nFilename: reproduce.py\r\n\r\nLine #    Mem usage    Increment   Line Contents\r\n================================================\r\n     7    524.8 MiB    524.8 MiB   @profile\r\n     8                             def predict():\r\n     9    557.2 MiB     32.4 MiB       m.predict(image)\r\n\r\n\r\n...\r\n\r\n\r\nFilename: reproduce.py\r\n\r\nLine #    Mem usage    Increment   Line Contents\r\n================================================\r\n     7   1283.4 MiB   1283.4 MiB   @profile\r\n     8                             def predict():\r\n     9   1283.6 MiB      0.2 MiB       m.predict(image)\r\n\r\n\r\nFilename: reproduce.py\r\n\r\nLine #    Mem usage    Increment   Line Contents\r\n================================================\r\n     7   1283.6 MiB   1283.6 MiB   @profile\r\n     8                             def predict():\r\n     9   1285.9 MiB      2.3 MiB       m.predict(image)\r\n\r\n```\r\n\r\n### Describe the problem\r\n\r\nIn short, memory keeps increasing after each predict call. I tried the above script with other networks such as `tensorflow.keras.applications.vgg19` and pure tensorflow convnets and I see the same issue.\r\n\r\nThis issue seems to be resolved when I set `inter_op_parallelism_threads=1` in the `tf.ConfigProto` as such:\r\n\r\n```python\r\n    config = tf.ConfigProto(\r\n        inter_op_parallelism_threads=1)\r\n    sess = tf.Session(config=config)\r\n```\r\n\r\nAnd re-appears when I start increasing `inter_op_parallelism_threads` to 32 (I'm running on 32 CPU cores).\r\n\r\n### Another issue:\r\n\r\nAs I mentioned previously, setting `inter_op_parallelism_threads=1` stops the memory from increasing on each predict call. Here is a script that sets the config `inter_op_parallelism_threads=1` and does not exhibit a memory leak:\r\n```python\r\nimport numpy as np\r\nimport tensorflow as tf\r\nimport tensorflow.keras.backend as K\r\n\r\nfrom tensorflow.keras.applications.inception_v3 import InceptionV3\r\nfrom memory_profiler import profile\r\n\r\n\r\nimage = np.random.random((1, 299, 299, 3))\r\n\r\n\r\n@profile\r\ndef predict():\r\n    m.predict(image)\r\n\r\n\r\nif __name__ == '__main__':\r\n    config = tf.ConfigProto(\r\n        inter_op_parallelism_threads=1)\r\n    sess = tf.Session(config=config)\r\n\r\n    print(sess._config)\r\n    K.set_session(sess)\r\n\r\n    m = InceptionV3()\r\n    for _ in range(100):\r\n        predict()\r\n```\r\n\r\nHowever, I see memory increasing again if I add an extra call to `tf.Session()` before calling the one with the `tf.ConfigProto`:\r\n\r\n```python\r\nimport numpy as np\r\nimport tensorflow as tf\r\nimport tensorflow.keras.backend as K\r\n\r\nfrom tensorflow.keras.applications.inception_v3 import InceptionV3\r\nfrom memory_profiler import profile\r\n\r\nimage = np.random.random((1, 299, 299, 3))\r\n\r\n\r\n@profile\r\ndef predict():\r\n    m.predict(image)\r\n\r\n\r\nif __name__ == '__main__':\r\n    s = tf.Session()  # Added an extra tf.Session() call here!!!\r\n    s.close()\r\n\r\n    config = tf.ConfigProto(\r\n        inter_op_parallelism_threads=1)\r\n    sess = tf.Session(config=config)\r\n\r\n    print(sess._config)\r\n    K.set_session(sess)\r\n\r\n    m = InceptionV3()\r\n\r\n    for _ in range(100):\r\n        predict()\r\n```\r\n\r\nIt seems like the ConfigProto from the first `tf.Session()` is overwriting the config from the next session I create.\r\n\r\n---\r\n\r\nHere is a graph of the script above for 1000 predict calls:\r\n\r\n![tf_issue](https://user-images.githubusercontent.com/7320238/45115233-3cfa3a80-b11d-11e8-9b5e-781508fc8583.png)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22095", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22095/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22095/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22095/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22095", "id": 357262504, "node_id": "MDU6SXNzdWUzNTcyNjI1MDQ=", "number": 22095, "title": "3D convolutions on GPU with large input produces incorrect results on some GPUs", "user": {"login": "gerbenvv", "id": 1511521, "node_id": "MDQ6VXNlcjE1MTE1MjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/1511521?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gerbenvv", "html_url": "https://github.com/gerbenvv", "followers_url": "https://api.github.com/users/gerbenvv/followers", "following_url": "https://api.github.com/users/gerbenvv/following{/other_user}", "gists_url": "https://api.github.com/users/gerbenvv/gists{/gist_id}", "starred_url": "https://api.github.com/users/gerbenvv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gerbenvv/subscriptions", "organizations_url": "https://api.github.com/users/gerbenvv/orgs", "repos_url": "https://api.github.com/users/gerbenvv/repos", "events_url": "https://api.github.com/users/gerbenvv/events{/privacy}", "received_events_url": "https://api.github.com/users/gerbenvv/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 11, "created_at": "2018-09-05T14:41:12Z", "updated_at": "2020-02-08T01:11:49Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes, see reproduction script below.\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 16.04.5 LTS\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: N/A\r\n- **TensorFlow installed from (source or binary)**: Binary via pip\r\n- **TensorFlow version (use command below)**: 1.10.1\r\n- **Python version**: 3.6.3\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **GCC/Compiler version (if compiling from source)**: GCC 5.4.0\r\n- **CUDA/cuDNN version**: CUDA 9.0 / cuDNN 7.2\r\n- **GPU model and memory**: GTX 1080 Ti\r\n- **Exact command to reproduce**: See script below.\r\n\r\n```\r\n== cat /etc/issue ===============================================\r\nLinux gpu01 4.4.0-116-generic #140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux\r\nVERSION=\"16.04.5 LTS (Xenial Xerus)\"\r\nVERSION_ID=\"16.04\"\r\nVERSION_CODENAME=xenial\r\n\r\n== are we in docker =============================================\r\nNo\r\n\r\n== compiler =====================================================\r\nc++ (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609\r\nCopyright (C) 2015 Free Software Foundation, Inc.\r\nThis is free software; see the source for copying conditions.  There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n\r\n\r\n== uname -a =====================================================\r\nLinux gpu01 4.4.0-116-generic #140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n== check pips ===================================================\r\nnumpy                    1.14.2\r\nprotobuf                 3.6.1\r\ntensorflow-gpu           1.10.1\r\ntensorflow-tensorboard   1.5.1\r\n\r\n== check for virtualenv =========================================\r\nFalse\r\n\r\n== tensorflow import ============================================\r\ntf.VERSION = 1.10.1\r\ntf.GIT_VERSION = v1.10.1-0-g4dcfddc5d1\r\ntf.COMPILER_VERSION = v1.10.1-0-g4dcfddc5d1\r\nSanity check: array([1], dtype=int32)\r\n\r\n== env ==========================================================\r\nLD_LIBRARY_PATH /usr/local/cuda/lib64\r\nDYLD_LIBRARY_PATH is unset\r\n\r\n== nvidia-smi ===================================================\r\nWed Sep  5 16:19:24 2018\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 387.26                 Driver Version: 387.26                    |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce GTX 108...  On   | 00000000:04:00.0 Off |                  N/A |\r\n| 23%   38C    P0    64W / 250W |      1MiB / 11172MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   1  GeForce GTX 108...  On   | 00000000:05:00.0 Off |                  N/A |\r\n| 23%   36C    P2    65W / 250W |      1MiB / 11172MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   2  GeForce GTX 108...  On   | 00000000:08:00.0 Off |                  N/A |\r\n| 23%   42C    P0    77W / 250W |      1MiB / 11172MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   3  GeForce GTX 108...  On   | 00000000:09:00.0 Off |                  N/A |\r\n| 23%   42C    P0    63W / 250W |      1MiB / 11172MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   4  GeForce GTX 108...  On   | 00000000:85:00.0 Off |                  N/A |\r\n| 23%   35C    P0    63W / 250W |      1MiB / 11172MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   5  GeForce GTX 108...  On   | 00000000:86:00.0 Off |                  N/A |\r\n| 23%   38C    P0    73W / 250W |      1MiB / 11172MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   6  GeForce GTX 108...  On   | 00000000:89:00.0 Off |                  N/A |\r\n| 23%   38C    P0    72W / 250W |      1MiB / 11172MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   7  GeForce GTX 108...  On   | 00000000:8A:00.0 Off |                  N/A |\r\n| 23%   36C    P0    71W / 250W |      1MiB / 11172MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n\r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|  No running processes found                                                 |\r\n+-----------------------------------------------------------------------------+\r\n\r\n== cuda libs  ===================================================\r\n/usr/local/cuda-8.0/doc/man/man7/libcudart.so.7\r\n/usr/local/cuda-8.0/doc/man/man7/libcudart.7\r\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart.so.8.0.61\r\n/usr/local/cuda-8.0/targets/x86_64-linux/lib/libcudart_static.a\r\n/usr/local/cuda-9.0/doc/man/man7/libcudart.so.7\r\n/usr/local/cuda-9.0/doc/man/man7/libcudart.7\r\n/usr/local/cuda-9.0/targets/x86_64-linux/lib/libcudart.so.9.0.176\r\n/usr/local/cuda-9.0/targets/x86_64-linux/lib/libcudart_static.a\r\n/usr/local/cuda-9.1/doc/man/man7/libcudart.so.7\r\n/usr/local/cuda-9.1/doc/man/man7/libcudart.7\r\n/usr/local/cuda-9.1/targets/x86_64-linux/lib/libcudart.so.9.1.85\r\n/usr/local/cuda-9.1/targets/x86_64-linux/lib/libcudart_static.a\r\n```\r\n\r\n### Describe the problem\r\n3D convolutions on GPU with large batches fail to calculate the correct result for the last part of the batch. The first entries will be correct, however, after some point the resulting values will be random. This is the case for at least the GTX 1080 Ti and the GeForce GTX 980 Ti gpus. It produces the correct result however on the CPU and at least the K80 GPU.\r\n\r\n### Source code / logs\r\n\r\nA small reproduction script:\r\n\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\n\r\n\r\nrun_on_gpu = True  # Set to false for the correct result, computed on the CPU.\r\nbatch_size = 128  # Try out a large batch, that just fits into memory. Small batches work fine.\r\n\r\n\r\n\r\nrandom_state = np.random.RandomState(42)\r\n\r\ninputs = tf.placeholder(tf.float32, (None, 29, 72, 72, 1), 'inputs')\r\n\r\ndevice_name = '/gpu:0' if run_on_gpu else '/cpu:0'\r\n\r\nwith tf.device(device_name):\r\n    weights = tf.constant(random_state.randn(3, 3, 3, 1, 32).astype(np.float32))\r\n    outputs = tf.nn.conv3d(inputs, weights, strides=(1, 1, 1, 1, 1), padding='SAME', dilations=(1, 1, 1, 1, 1))\r\n    weights = tf.constant(random_state.randn(1, 1, 1, 32, 16).astype(np.float32))\r\n    outputs = tf.nn.conv3d(outputs, weights, strides=(1, 1, 1, 1, 1), padding='VALID', dilations=(1, 1, 1, 1, 1))\r\n\r\nsession = tf.Session()\r\n\r\nrandom_inputs = random_state.randn(batch_size, 29, 72, 72, 1).astype(np.float32)\r\n\r\na = session.run(outputs, feed_dict={inputs: random_inputs})[-1]\r\nb = session.run(outputs, feed_dict={inputs: random_inputs[-1:]})[0]\r\n\r\n# Should print the same line, twice.\r\nprint(a.shape, a.ravel()[0])\r\nprint(b.shape, b.ravel()[0])\r\n```\r\n\r\nThis script should print the same line twice.\r\n\r\nExpected result:\r\n```\r\n(29, 72, 72, 16) -5.843975\r\n(29, 72, 72, 16) -5.843975\r\n```\r\n\r\nActual result:\r\n```\r\n(29, 72, 72, 16) -4.591032\r\n(29, 72, 72, 16) -5.843975\r\n```\r\n\r\nRun on a GeForce GTX 1080 Ti:\r\n\r\n```\r\nPython 3.6.3\r\nTensorflow 1.10.1\r\nNumpy 1.15.1\r\n\r\n2018-09-05 15:55:27.172809: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2018-09-05 15:55:27.685907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties: \r\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582\r\npciBusID: 0000:8a:00.0\r\ntotalMemory: 10.91GiB freeMemory: 10.75GiB\r\n2018-09-05 15:55:27.685952: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0\r\n2018-09-05 15:55:28.161475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-09-05 15:55:28.161524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 \r\n2018-09-05 15:55:28.161532: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N \r\n2018-09-05 15:55:28.161948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10398 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:8a:00.0, compute capability: 6.1)\r\n\r\n(29, 72, 72, 16) -4.591032\r\n(29, 72, 72, 16) -5.843975\r\n```\r\n\r\nRun on a GeForce GTX 980 Ti:\r\n\r\n```\r\nPython 3.6.3\r\nTensorflow 1.5.1\r\nNumpy 1.14.2\r\n\r\n2018-09-05 16:05:54.557373: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2018-09-05 16:05:57.096399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105] Found device 0 with properties:\r\nname: GeForce GTX 980 Ti major: 5 minor: 2 memoryClockRate(GHz): 1.076\r\npciBusID: 0000:02:00.0\r\ntotalMemory: 5.94GiB freeMemory: 5.83GiB\r\n2018-09-05 16:05:57.096467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1195] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX 980 Ti, pci bus id: 0000:02:00.0, compute capability: 5.2)\r\n\r\n(29, 72, 72, 16) -4.591032\r\n(29, 72, 72, 16) -5.843975\r\n```\r\n\r\nRun on a K80:\r\n\r\n```\r\nPython 3.6.5\r\nTensorflow 1.5.1\r\nNumpy 1.15.0\r\n\r\n2018-09-05 14:37:31.279189: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2018-09-05 14:37:32.131417: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:895] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-09-05 14:37:32.131763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105] Found device 0 with properties:\r\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\r\npciBusID: 0000:00:1e.0\r\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\r\n2018-09-05 14:37:32.131795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1195] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:00:1e.0, compute capability: 3.7)\r\n\r\n(29, 72, 72, 16) -5.843975\r\n(29, 72, 72, 16) -5.843975\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22093", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22093/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22093/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22093/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22093", "id": 357236176, "node_id": "MDU6SXNzdWUzNTcyMzYxNzY=", "number": 22093, "title": "AttributeError: 'SsdAnchorGenerator' object has no attribute 'height_stride'", "user": {"login": "Tgmstriker", "id": 39170485, "node_id": "MDQ6VXNlcjM5MTcwNDg1", "avatar_url": "https://avatars0.githubusercontent.com/u/39170485?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Tgmstriker", "html_url": "https://github.com/Tgmstriker", "followers_url": "https://api.github.com/users/Tgmstriker/followers", "following_url": "https://api.github.com/users/Tgmstriker/following{/other_user}", "gists_url": "https://api.github.com/users/Tgmstriker/gists{/gist_id}", "starred_url": "https://api.github.com/users/Tgmstriker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Tgmstriker/subscriptions", "organizations_url": "https://api.github.com/users/Tgmstriker/orgs", "repos_url": "https://api.github.com/users/Tgmstriker/repos", "events_url": "https://api.github.com/users/Tgmstriker/events{/privacy}", "received_events_url": "https://api.github.com/users/Tgmstriker/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jch1", "id": 1811449, "node_id": "MDQ6VXNlcjE4MTE0NDk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1811449?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jch1", "html_url": "https://github.com/jch1", "followers_url": "https://api.github.com/users/jch1/followers", "following_url": "https://api.github.com/users/jch1/following{/other_user}", "gists_url": "https://api.github.com/users/jch1/gists{/gist_id}", "starred_url": "https://api.github.com/users/jch1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jch1/subscriptions", "organizations_url": "https://api.github.com/users/jch1/orgs", "repos_url": "https://api.github.com/users/jch1/repos", "events_url": "https://api.github.com/users/jch1/events{/privacy}", "received_events_url": "https://api.github.com/users/jch1/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jch1", "id": 1811449, "node_id": "MDQ6VXNlcjE4MTE0NDk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1811449?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jch1", "html_url": "https://github.com/jch1", "followers_url": "https://api.github.com/users/jch1/followers", "following_url": "https://api.github.com/users/jch1/following{/other_user}", "gists_url": "https://api.github.com/users/jch1/gists{/gist_id}", "starred_url": "https://api.github.com/users/jch1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jch1/subscriptions", "organizations_url": "https://api.github.com/users/jch1/orgs", "repos_url": "https://api.github.com/users/jch1/repos", "events_url": "https://api.github.com/users/jch1/events{/privacy}", "received_events_url": "https://api.github.com/users/jch1/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-09-05T13:43:20Z", "updated_at": "2018-12-09T18:40:37Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nI am using the stock scripts with a custom training dataset\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\nWindows 10\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\nn/A\r\n- **TensorFlow installed from (source or binary)**:\r\nInstalled via Anaconda command line\r\n- **TensorFlow version (use command below)**:\r\nb'v1.10.0-rc1-19-g656e7a2b34' 1.10.0\r\n- **Python version**:\r\nanaconda                  5.1.0                    py36_2\r\n- **Bazel version (if compiling from source)**:\r\nN/A\r\n- **GCC/Compiler version (if compiling from source)**:\r\nN/A\r\n- **CUDA/cuDNN version**:\r\nN/A\r\n- **GPU model and memory**:\r\nN/A\r\n- **Exact command to reproduce**:\r\npython train.py --logtostderr --train_dir=training\\\\ --pipeline_config_path=training\\\\test.config\r\n\r\n### Describe the problem\r\nI'm trying to train various models using a custom dataset.  I am able to train using the Faster RCNN Inception V2 without issue.  However, all of the other models I try to use throw the same error:\r\n\r\nAttributeError: 'SsdAnchorGenerator' object has no attribute 'height_stride'\r\n\r\nI've tried with ssd_mobilenet_v1_coco,ssd_mobilenet_v2_coco, and ssd_inception_v2_coco.  All three produce the same error.\r\n\r\n### Source code / logs\r\nC:\\ProgramData\\Anaconda3\\lib\\site-packages\\h5py\\__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\r\n  from ._conv import register_converters as _register_converters\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 168, in <module>\r\n    tf.app.run()\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\tensorflow\\python\\platform\\app.py\", line 125, in run\r\n    _sys.exit(main(argv))\r\n  File \"train.py\", line 164, in main\r\n    worker_job_name, is_chief, FLAGS.train_dir)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\object_detection-0.1-py3.6.egg\\object_detection\\trainer.py\", line 240, in train\r\n    detection_model = create_model_fn()\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\object_detection-0.1-py3.6.egg\\object_detection\\builders\\model_builder.py\", line 98, in build\r\n    add_background_class)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\object_detection-0.1-py3.6.egg\\object_detection\\builders\\model_builder.py\", line 178, in _build_ssd_model\r\n    ssd_config.anchor_generator)\r\n  File \"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\object_detection-0.1-py3.6.egg\\object_detection\\builders\\anchor_generator_builder.py\", line 59, in build\r\n    if ssd_anchor_generator_config.height_stride:\r\nAttributeError: 'SsdAnchorGenerator' object has no attribute 'height_stride'\r\nPS C:\\Users\\timothy.molner\\Desktop\\tensorflow\\research\\object_detection> python train.py --logtostderr --train_dir=training\\\\ --pipeline_config_path=training\\\\test.config"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22092", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22092/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22092/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22092/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22092", "id": 357222886, "node_id": "MDU6SXNzdWUzNTcyMjI4ODY=", "number": 22092, "title": "TF Record, Example, and SeqeunceExample inconsistency(?) / Documentation request", "user": {"login": "SumNeuron", "id": 22868585, "node_id": "MDQ6VXNlcjIyODY4NTg1", "avatar_url": "https://avatars3.githubusercontent.com/u/22868585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SumNeuron", "html_url": "https://github.com/SumNeuron", "followers_url": "https://api.github.com/users/SumNeuron/followers", "following_url": "https://api.github.com/users/SumNeuron/following{/other_user}", "gists_url": "https://api.github.com/users/SumNeuron/gists{/gist_id}", "starred_url": "https://api.github.com/users/SumNeuron/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SumNeuron/subscriptions", "organizations_url": "https://api.github.com/users/SumNeuron/orgs", "repos_url": "https://api.github.com/users/SumNeuron/repos", "events_url": "https://api.github.com/users/SumNeuron/events{/privacy}", "received_events_url": "https://api.github.com/users/SumNeuron/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "lamberta", "id": 43051, "node_id": "MDQ6VXNlcjQzMDUx", "avatar_url": "https://avatars2.githubusercontent.com/u/43051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lamberta", "html_url": "https://github.com/lamberta", "followers_url": "https://api.github.com/users/lamberta/followers", "following_url": "https://api.github.com/users/lamberta/following{/other_user}", "gists_url": "https://api.github.com/users/lamberta/gists{/gist_id}", "starred_url": "https://api.github.com/users/lamberta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lamberta/subscriptions", "organizations_url": "https://api.github.com/users/lamberta/orgs", "repos_url": "https://api.github.com/users/lamberta/repos", "events_url": "https://api.github.com/users/lamberta/events{/privacy}", "received_events_url": "https://api.github.com/users/lamberta/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "lamberta", "id": 43051, "node_id": "MDQ6VXNlcjQzMDUx", "avatar_url": "https://avatars2.githubusercontent.com/u/43051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lamberta", "html_url": "https://github.com/lamberta", "followers_url": "https://api.github.com/users/lamberta/followers", "following_url": "https://api.github.com/users/lamberta/following{/other_user}", "gists_url": "https://api.github.com/users/lamberta/gists{/gist_id}", "starred_url": "https://api.github.com/users/lamberta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lamberta/subscriptions", "organizations_url": "https://api.github.com/users/lamberta/orgs", "repos_url": "https://api.github.com/users/lamberta/repos", "events_url": "https://api.github.com/users/lamberta/events{/privacy}", "received_events_url": "https://api.github.com/users/lamberta/received_events", "type": "User", "site_admin": false}, {"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}, {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2018-09-05T13:12:16Z", "updated_at": "2019-09-27T17:51:18Z", "closed_at": null, "author_association": "NONE", "body": "I have posted 2 stack overflow questions regarding TF Records and (Sequence)Examples.\r\nI even had a bounty on one. \r\nDespite only receiving up-votes. Neither received any support.\r\nBoth had an associated Colab document to assist.\r\n\r\nThe questions where\r\n\r\n1. [Store images as byte strings or per channel?]https://stackoverflow.com/questions/52035692/tensorflow-v1-10-store-images-as-byte-strings-or-per-channel)\r\n\r\n2. [Recovering TF Records](https://stackoverflow.com/questions/52064866/tensorflow-1-10-tfrecorddataset-recovering-tfrecords)\r\n\r\nWith the corresponding colabs\r\n\r\n[Colab 1](https://colab.research.google.com/drive/1HUGoXfgxp0A_0eSdaCzutOkFvnYZ-egv)\r\n[Colab 2](https://colab.research.google.com/drive/1M10tbHih5eJ8LiApJSKKpNM79IconYJX)\r\n\r\n\r\nI am creating an issue as I am struggling to see the consistency in the behavior between tf Records, Example, SequenceExample, Feature, Features, FeatureList, FeatureLists, FixLenFeature, FixLenSequenceFeature, and VarLenFeature.\r\n\r\nIn this [Colab](https://colab.research.google.com/drive/1M10tbHih5eJ8LiApJSKKpNM79IconYJX)\r\n\r\nI survey 10 ways of encoding an array / array of arrays.\r\n\r\n-    Example: Int64 feature (int array)\r\n-    Example: Float feature (float array)\r\n-    Example: Bytes feature (int array dumped to byte string)\r\n-    SequenceExample: Int64 feature list (array of int arrays)\r\n-    SequenceExample: Float feature list (array of float arrays)\r\n-    SequenceExample: Bytes feature list (array of int arrays dumped to byte strings)\r\n-    Example: Bytes feature (array of int arrays all of which is dumped to byte string)\r\n-    SequenceExample: Bytes feature list (array of int arrays dumped to byte strings)\r\n-    SequenceExample: Bytes feature list (array of int arrays all of which is dumped to byte string)\r\n-    SequenceExample: Bytes feature list (array of int arrays, where each int is dumped to byte string)\r\n\r\nIn short, with the exception of 8, I was able to 'recover' (write to tf.record and read back the data). However, it should be noted that for methods 7 and 10, the retrieved array is flattened.\r\n\r\nFurther, when I state 'recover' I mean that of course that the feature is wrapped in an addition array. e.g. shape (3, ) becomes (1, 3).\r\n\r\n\r\nAs most tutorials of TF Record, Example and SequenceExample are just a rehashing of the one example provided in the TF Docs (for a movie recommender system, although code is provided for images). \r\n\r\nI think it would be beneficial for a \"style guide\" of sorts, given that one can their data in a myriad of ways. (e.g. are byte strings superior to float feature lists? should one break their image / sequence down per channel? why is there FixLenSeqeuenceFeature but no VarLenSequenceFeature?, if Example and SequenceExample are meant to contain a single data record, why are the only options List based features?)\r\n\r\nI would be happy to contribute to more documentation / examples if I knew the answer to these questions. However, to my unexperienced eyes the mismatch between converting data into a (Sequence)Example and extracting it out from a Record is bewildering.\r\n\r\n\r\n\r\n-------\r\n\r\nTensorFlow Butler requested information:\r\n\r\nHave I written custom code: yes, see linked colabs and S.O. posts.\r\nOS Platform and Distribution: N/a (irrelevant, but Ubuntu 16.04LTS / macOS High Sierra)\r\nTensorFlow installed from: (irrelevant, but conda / Colab's V.M.)\r\nTensorFlow version: 1.10\r\nBazel version: N/a\r\nCUDA/cuDNN version: N/a (irrelevant but latest / Colab's V.M.'s)\r\nGPU model and memory: N/a (irrelevant, but NVIDIA Titan X / NVIDIA Titan V / Colab's GPU)\r\nExact command to reproduce: see linked to code\r\nMobile device: N/a  (irrelevant) \r\n\r\n\r\nThis is more of a \"meta\" question regarding the structuring of Example / SequenceExample, the correspondingly needed Feature, Features, FeatureList, FeatureLists, etc and the parsing equivalents FixedLenFeature, VariableLenFeature, FixedLenSequenceFeature.\r\n\r\nMore specifically:\r\n\r\n- a request for more documentation\r\n- a request for \"best\" practices recording encoding of rank 2+ tensors\r\n\r\n   +  e.g. if I have a sequence in an _numpy.ndarray_ with _n_ channels should I \"dump\" (call _.tostring()_) on the entire sequence and store in a BytesFeature in an Example? or split each channel up into a Float/Int Feature (or dump to BytesFeature) in an Example / SequenceExample. \r\n\r\n-  a request for \"best\" practices as to why ever use Example, when it seems that the \"context features\" are equivalent and then if sequence features are needed later it is easier to adapt? (i.e. the difference between context features in sequence example and normal features of example rather than just calling context features \"meta-data\" of the sequences)\r\n\r\n- a request for \"best' practices for recording rank 0 tensors (as they have to be wrapped into a feature list, so should similarly typed features be concatenated together)\r\n\r\n- a request for elucidating why sometimes decoding a bytes array losses the rank from which it was encoded (see linked colab)\r\n\r\n- a request for a mid-tier api at the feature level e.g. remove the need for the user to define how a feature should be encoded as a record and then decoded  (parsed) from a serialized record. I have a conceptual prototype that I can include here or in another colab if interested. \r\n\r\netc, etc\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22089", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22089/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22089/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22089/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22089", "id": 357164300, "node_id": "MDU6SXNzdWUzNTcxNjQzMDA=", "number": 22089, "title": "ResourceExhaustedError", "user": {"login": "ajaysh2193", "id": 24571705, "node_id": "MDQ6VXNlcjI0NTcxNzA1", "avatar_url": "https://avatars0.githubusercontent.com/u/24571705?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ajaysh2193", "html_url": "https://github.com/ajaysh2193", "followers_url": "https://api.github.com/users/ajaysh2193/followers", "following_url": "https://api.github.com/users/ajaysh2193/following{/other_user}", "gists_url": "https://api.github.com/users/ajaysh2193/gists{/gist_id}", "starred_url": "https://api.github.com/users/ajaysh2193/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ajaysh2193/subscriptions", "organizations_url": "https://api.github.com/users/ajaysh2193/orgs", "repos_url": "https://api.github.com/users/ajaysh2193/repos", "events_url": "https://api.github.com/users/ajaysh2193/events{/privacy}", "received_events_url": "https://api.github.com/users/ajaysh2193/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "drpngx", "id": 20959853, "node_id": "MDQ6VXNlcjIwOTU5ODUz", "avatar_url": "https://avatars1.githubusercontent.com/u/20959853?v=4", "gravatar_id": "", "url": "https://api.github.com/users/drpngx", "html_url": "https://github.com/drpngx", "followers_url": "https://api.github.com/users/drpngx/followers", "following_url": "https://api.github.com/users/drpngx/following{/other_user}", "gists_url": "https://api.github.com/users/drpngx/gists{/gist_id}", "starred_url": "https://api.github.com/users/drpngx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/drpngx/subscriptions", "organizations_url": "https://api.github.com/users/drpngx/orgs", "repos_url": "https://api.github.com/users/drpngx/repos", "events_url": "https://api.github.com/users/drpngx/events{/privacy}", "received_events_url": "https://api.github.com/users/drpngx/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "drpngx", "id": 20959853, "node_id": "MDQ6VXNlcjIwOTU5ODUz", "avatar_url": "https://avatars1.githubusercontent.com/u/20959853?v=4", "gravatar_id": "", "url": "https://api.github.com/users/drpngx", "html_url": "https://github.com/drpngx", "followers_url": "https://api.github.com/users/drpngx/followers", "following_url": "https://api.github.com/users/drpngx/following{/other_user}", "gists_url": "https://api.github.com/users/drpngx/gists{/gist_id}", "starred_url": "https://api.github.com/users/drpngx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/drpngx/subscriptions", "organizations_url": "https://api.github.com/users/drpngx/orgs", "repos_url": "https://api.github.com/users/drpngx/repos", "events_url": "https://api.github.com/users/drpngx/events{/privacy}", "received_events_url": "https://api.github.com/users/drpngx/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-09-05T10:26:30Z", "updated_at": "2018-12-20T18:49:35Z", "closed_at": null, "author_association": "NONE", "body": "Hi, I have trained CNN model on overall 3021 images (train data) which belongs to 9 classes (labeled data). I have 453 test images to verify my model predictions. My training model built fine with no issues (~95% accuracy) but while I am predicting it on test data, after running on some 40-45 images(also printing their predictions), it does not able to load and process further data/images to make prediction and shows below error.\r\nI have tried reducing the batch size, but problems still persist.\r\n\r\n\r\nError:\r\nResourceExhaustedError: OOM when allocating tensor with shape[64,64,3,3] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc\r\n\t [[Node: block1_conv2_77/convolution = Conv2D[T=DT_FLOAT, data_format=\"NCHW\", dilations=[1, 1, 1, 1], padding=\"SAME\", strides=[1, 1, 1, 1], use_cudnn_on_gpu=true, _device=\"/job:localhost/replica:0/task:0/device:GPU:0\"](block1_conv1_77/Relu, block1_conv2_77/kernel/read)]]\r\nHint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.\r\n\r\n*****************************************************************\r\n\r\n\r\nFor the reference, I am attaching my source code(please check model.zip for code) and error screenshot and I am using Tensorflow  1.10.0  with Python 3.6.5\r\n\r\n\r\nNote: My system configuration -\r\nIntel i7, 32GB RAM, NVIDIA 1080 GPU, Windows 10.\r\n![error](https://user-images.githubusercontent.com/24571705/45087543-e5ab9880-b123-11e8-9bae-ebaa1cda965c.png)\r\n![gpu](https://user-images.githubusercontent.com/24571705/45087544-e6442f00-b123-11e8-9a13-11ea42f5c0b6.PNG)\r\n\r\n\r\n\r\n[model.zip](https://github.com/tensorflow/tensorflow/files/2352317/model.zip)\r\n\r\n\r\n\r\n-----\r\nRegards,\r\nAjay Sharma\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22080", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22080/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22080/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22080/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22080", "id": 357093776, "node_id": "MDU6SXNzdWUzNTcwOTM3NzY=", "number": 22080, "title": "The performance of FusedBatchNormGradGrad is very low", "user": {"login": "mpjlu", "id": 13826327, "node_id": "MDQ6VXNlcjEzODI2MzI3", "avatar_url": "https://avatars1.githubusercontent.com/u/13826327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpjlu", "html_url": "https://github.com/mpjlu", "followers_url": "https://api.github.com/users/mpjlu/followers", "following_url": "https://api.github.com/users/mpjlu/following{/other_user}", "gists_url": "https://api.github.com/users/mpjlu/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpjlu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpjlu/subscriptions", "organizations_url": "https://api.github.com/users/mpjlu/orgs", "repos_url": "https://api.github.com/users/mpjlu/repos", "events_url": "https://api.github.com/users/mpjlu/events{/privacy}", "received_events_url": "https://api.github.com/users/mpjlu/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "joel-shor", "id": 6020988, "node_id": "MDQ6VXNlcjYwMjA5ODg=", "avatar_url": "https://avatars1.githubusercontent.com/u/6020988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joel-shor", "html_url": "https://github.com/joel-shor", "followers_url": "https://api.github.com/users/joel-shor/followers", "following_url": "https://api.github.com/users/joel-shor/following{/other_user}", "gists_url": "https://api.github.com/users/joel-shor/gists{/gist_id}", "starred_url": "https://api.github.com/users/joel-shor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joel-shor/subscriptions", "organizations_url": "https://api.github.com/users/joel-shor/orgs", "repos_url": "https://api.github.com/users/joel-shor/repos", "events_url": "https://api.github.com/users/joel-shor/events{/privacy}", "received_events_url": "https://api.github.com/users/joel-shor/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "joel-shor", "id": 6020988, "node_id": "MDQ6VXNlcjYwMjA5ODg=", "avatar_url": "https://avatars1.githubusercontent.com/u/6020988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joel-shor", "html_url": "https://github.com/joel-shor", "followers_url": "https://api.github.com/users/joel-shor/followers", "following_url": "https://api.github.com/users/joel-shor/following{/other_user}", "gists_url": "https://api.github.com/users/joel-shor/gists{/gist_id}", "starred_url": "https://api.github.com/users/joel-shor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joel-shor/subscriptions", "organizations_url": "https://api.github.com/users/joel-shor/orgs", "repos_url": "https://api.github.com/users/joel-shor/repos", "events_url": "https://api.github.com/users/joel-shor/events{/privacy}", "received_events_url": "https://api.github.com/users/joel-shor/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2018-09-05T07:10:30Z", "updated_at": "2019-01-22T09:21:52Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "When I test the performance of GAN model (https://github.com/tensorflow/models/tree/master/research/gan), I find to use FusedBatchNorm can boost the performance by 20% to 30% (https://github.com/tensorflow/models/issues/5206).\r\n\r\nHowever, when use gan_loss with gradient_penalty, there is no performance improvement with FusedBatchNorm.  I find the root cause is FusedBatchNormGradGrad is very low performance.\r\n\r\nI propose to set fused_batch_norm to false on (https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/gan/python/losses/python/losses_impl.py#L367) to use BatchNormGradGrad to replace FusedBatchNormGradGrad. There is about 20% performance improvement with this change. \r\nChange\r\n`disc_interpolates = discriminator_fn(interpolates, generator_inputs)`\r\nto \r\n`disc_interpolates = discriminator_fn(interpolates, generator_inputs, fused_batch_norm=false)`\r\n   \r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22069", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22069/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22069/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22069/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22069", "id": 356998088, "node_id": "MDU6SXNzdWUzNTY5OTgwODg=", "number": 22069, "title": "freeze_graph.py with --input_saved_model argument gives `IOError: SavedModel file does not exist`", "user": {"login": "chrisrapson", "id": 4982550, "node_id": "MDQ6VXNlcjQ5ODI1NTA=", "avatar_url": "https://avatars2.githubusercontent.com/u/4982550?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chrisrapson", "html_url": "https://github.com/chrisrapson", "followers_url": "https://api.github.com/users/chrisrapson/followers", "following_url": "https://api.github.com/users/chrisrapson/following{/other_user}", "gists_url": "https://api.github.com/users/chrisrapson/gists{/gist_id}", "starred_url": "https://api.github.com/users/chrisrapson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chrisrapson/subscriptions", "organizations_url": "https://api.github.com/users/chrisrapson/orgs", "repos_url": "https://api.github.com/users/chrisrapson/repos", "events_url": "https://api.github.com/users/chrisrapson/events{/privacy}", "received_events_url": "https://api.github.com/users/chrisrapson/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "karmel", "id": 667809, "node_id": "MDQ6VXNlcjY2NzgwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karmel", "html_url": "https://github.com/karmel", "followers_url": "https://api.github.com/users/karmel/followers", "following_url": "https://api.github.com/users/karmel/following{/other_user}", "gists_url": "https://api.github.com/users/karmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/karmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karmel/subscriptions", "organizations_url": "https://api.github.com/users/karmel/orgs", "repos_url": "https://api.github.com/users/karmel/repos", "events_url": "https://api.github.com/users/karmel/events{/privacy}", "received_events_url": "https://api.github.com/users/karmel/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "karmel", "id": 667809, "node_id": "MDQ6VXNlcjY2NzgwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karmel", "html_url": "https://github.com/karmel", "followers_url": "https://api.github.com/users/karmel/followers", "following_url": "https://api.github.com/users/karmel/following{/other_user}", "gists_url": "https://api.github.com/users/karmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/karmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karmel/subscriptions", "organizations_url": "https://api.github.com/users/karmel/orgs", "repos_url": "https://api.github.com/users/karmel/repos", "events_url": "https://api.github.com/users/karmel/events{/privacy}", "received_events_url": "https://api.github.com/users/karmel/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2018-09-04T22:25:14Z", "updated_at": "2018-12-07T18:52:36Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nno\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\nUbuntu 18.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\nn/a\r\n- **TensorFlow installed from (source or binary)**:\r\npip\r\n- **TensorFlow version (use command below)**:\r\n1.10.1\r\n- **Python version**:\r\n2.7.15rc1\r\n- **Bazel version (if compiling from source)**:\r\nn/a\r\n- **GCC/Compiler version (if compiling from source)**:\r\nn/a\r\n- **CUDA/cuDNN version**:\r\nn/a\r\n- **GPU model and memory**:\r\nn/a\r\n- **Exact command to reproduce**:\r\n```\r\n#first, train the model with\r\npython tensorflow/models/research/deeplab/train.py \\\r\n    --logtostderr \\\r\n    --clone_on_cpu=True \\\r\n    --training_number_of_steps=900 \\ # 90000 \\\r\n    --train_split=\"train\" \\\r\n    --model_variant=\"mobilenet_v2\" \\\r\n    --atrous_rates=6 \\\r\n    --atrous_rates=12 \\\r\n    --atrous_rates=18 \\\r\n    --output_stride=16 \\\r\n    --decoder_output_stride=4 \\\r\n    --train_crop_size=128 \\\r\n    --train_crop_size=128 \\\r\n    --train_batch_size=1 \\\r\n    --dataset=\"cityscapes\" \\\r\n    --tf_initial_checkpoint=${PATH_TO_INITIAL_CHECKPOINT} \\\r\n    --train_logdir=${PATH_TO_TRAIN_DIR} \\\r\n    --dataset_dir=${PATH_TO_DATASET}\r\n\r\n#then try to freeze the output\r\npython tensorflow/python/tools/freeze_graph.py \\\r\n     --input_saved_model=${PATH_TO_TRAIN_DIR} \\\r\n     --output_graph=${PATH_TO_TRAIN_DIR}/frozen_graph.pb \\\r\n     --output_node_names=MobilenetV2/expanded_conv_16/output\r\n```\r\n\r\n### Describe the problem\r\nThe first problem is that the train.py script seems to change the structure of the graph. Specifically, the input and output nodes from the `initial_checkpoint` are missing. The normal `output_node_names` such as softmax, predictions etc do not appear in the trained graph.pbtxt, which is why I have used `MobilenetV2/expanded_conv_16/output`. The ImageTensor also does not appear as an input_node.\r\nHowever, the problem with missing nodes is not the focus of this issue.\r\n\r\nThe second problem is that `freeze_graph.ph` with the `--input_saved_model` option gives \r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/username/.local/lib/python2.7/site-packages/tensorflow/python/tools/freeze_graph.py\", line 382, in <module>\r\n    run_main()\r\n  File \"/home/username/.local/lib/python2.7/site-packages/tensorflow/python/tools/freeze_graph.py\", line 379, in run_main\r\n    app.run(main=my_main, argv=[sys.argv[0]] + unparsed)\r\n  File \"/home/username/.local/lib/python2.7/site-packages/tensorflow/python/platform/app.py\", line 125, in run\r\n    _sys.exit(main(argv))\r\n  File \"/home/username/.local/lib/python2.7/site-packages/tensorflow/python/tools/freeze_graph.py\", line 378, in <lambda>\r\n    my_main = lambda unused_args: main(unused_args, flags)\r\n  File \"/home/username/.local/lib/python2.7/site-packages/tensorflow/python/tools/freeze_graph.py\", line 272, in main\r\n    flags.saved_model_tags, checkpoint_version)\r\n  File \"/home/username/.local/lib/python2.7/site-packages/tensorflow/python/tools/freeze_graph.py\", line 229, in freeze_graph\r\n    input_saved_model_dir, saved_model_tags).graph_def\r\n  File \"/home/username/.local/lib/python2.7/site-packages/tensorflow/python/tools/saved_model_utils.py\", line 42, in get_meta_graph_def\r\n    saved_model = reader.read_saved_model(saved_model_dir)\r\n  File \"/home/username/.local/lib/python2.7/site-packages/tensorflow/contrib/saved_model/python/saved_model/reader.py\", line 55, in read_saved_model\r\n    raise IOError(\"SavedModel file does not exist at: %s\" % saved_model_dir)\r\nIOError: SavedModel file does not exist at: /path/given/in/PATH_TO_TRAIN_DIR\r\n\r\n$ls ${PATH_TO_TRAIN_DIR}\r\n-rw-r--r-- 1 username username    21786 Sep  3 15:28 model.ckpt-0.index\r\n-rw-r--r-- 1 username username 21955616 Sep  3 15:28 model.ckpt-0.data-00000-of-00001\r\n-rw-r--r-- 1 username username  3070908 Sep  3 15:28 model.ckpt-0.meta\r\n-rw-r--r-- 1 username username  6081043 Sep  4 10:54 graph.pbtxt\r\n-rw-r--r-- 1 username username 21955616 Sep  4 10:54 model.ckpt-900.data-00000-of-00001\r\n-rw-r--r-- 1 username username    21786 Sep  4 10:54 model.ckpt-900.index\r\n-rw-r--r-- 1 username username  3070908 Sep  4 10:54 model.ckpt-900.meta\r\n-rw-r--r-- 1 username username      541 Sep  4 10:54 checkpoint\r\n\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22059", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22059/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22059/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22059/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22059", "id": 356911243, "node_id": "MDU6SXNzdWUzNTY5MTEyNDM=", "number": 22059, "title": "Optimizing slice of variable not possible", "user": {"login": "Hoeze", "id": 1200058, "node_id": "MDQ6VXNlcjEyMDAwNTg=", "avatar_url": "https://avatars0.githubusercontent.com/u/1200058?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Hoeze", "html_url": "https://github.com/Hoeze", "followers_url": "https://api.github.com/users/Hoeze/followers", "following_url": "https://api.github.com/users/Hoeze/following{/other_user}", "gists_url": "https://api.github.com/users/Hoeze/gists{/gist_id}", "starred_url": "https://api.github.com/users/Hoeze/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Hoeze/subscriptions", "organizations_url": "https://api.github.com/users/Hoeze/orgs", "repos_url": "https://api.github.com/users/Hoeze/repos", "events_url": "https://api.github.com/users/Hoeze/events{/privacy}", "received_events_url": "https://api.github.com/users/Hoeze/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-09-04T17:44:33Z", "updated_at": "2019-02-15T21:21:58Z", "closed_at": null, "author_association": "NONE", "body": "Applying the gradient of a variable slice currently results in a `NotImplemented` error of tf.train.Optimizer.\r\n\r\n**The following two examples are working:**\r\n```python\r\n### WORKING ###\r\nX = tf.Variable(2, dtype=tf.float32)\r\ny = tf.constant(10, dtype=\"float32\")\r\nloss = y - (X*X)\r\n\r\nvariables=[X]\r\ngradient = tf.gradients(loss, variables)\r\ngradient = [(g, v) for g, v in zip(gradient, variables)]\r\ntrain_op = tf.train.AdamOptimizer().apply_gradients(gradient)\r\n```\r\n\r\n```python\r\n### WORKING ###\r\nbig_X = tf.Variable([2,3,4], dtype=tf.float32)\r\nX = big_X[0]\r\ny = tf.constant(10, dtype=\"float32\")\r\nloss = y - (X*X)\r\n\r\ntrain_op = train_op = tf.train.AdamOptimizer().minimize(loss)\r\n```\r\n\r\n**The following example throws an error:**\r\n```python\r\n### NOT WORKING ###\r\nbig_X = tf.Variable([2,3,4], dtype=tf.float32)\r\nX = big_X[0]\r\ny = tf.constant(10, dtype=\"float32\")\r\nloss = y - (X*X)\r\n\r\nvariables=[X]\r\ngradient = tf.gradients(loss, variables)\r\ngradient = [(g, v) for g, v in zip(gradient, variables)]\r\ntrain_op = tf.train.AdamOptimizer().apply_gradients(gradient)\r\n```\r\nThe error:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 2963, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-22-10282dee2005>\", line 10, in <module>\r\n    train_op = tf.train.AdamOptimizer().apply_gradients(gradient)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/training/optimizer.py\", line 605, in apply_gradients\r\n    update_ops.append(processor.update_op(self, grad))\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/training/optimizer.py\", line 189, in update_op\r\n    raise NotImplementedError(\"Trying to update a Tensor \", self._v)\r\nNotImplementedError: ('Trying to update a Tensor ', <tf.Tensor 'strided_slice_9:0' shape=() dtype=float32>)\r\n```\r\n------------------------\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 18.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: NA\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: v1.10.1-0-g4dcfddc5d1 1.10.1\r\n- **Python version**: 3.6.5\r\n- **Bazel version (if compiling from source)**: NA\r\n- **GCC/Compiler version (if compiling from source)**: NA\r\n- **CUDA/cuDNN version**: NA\r\n- **GPU model and memory**: NA\r\n- **Exact command to reproduce**: NA"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22058", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22058/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22058/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22058/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22058", "id": 356908533, "node_id": "MDU6SXNzdWUzNTY5MDg1MzM=", "number": 22058, "title": "tf.estimator.Estimator with distribution strategy messes up TensorBoard readability", "user": {"login": "patzm", "id": 5219726, "node_id": "MDQ6VXNlcjUyMTk3MjY=", "avatar_url": "https://avatars1.githubusercontent.com/u/5219726?v=4", "gravatar_id": "", "url": "https://api.github.com/users/patzm", "html_url": "https://github.com/patzm", "followers_url": "https://api.github.com/users/patzm/followers", "following_url": "https://api.github.com/users/patzm/following{/other_user}", "gists_url": "https://api.github.com/users/patzm/gists{/gist_id}", "starred_url": "https://api.github.com/users/patzm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/patzm/subscriptions", "organizations_url": "https://api.github.com/users/patzm/orgs", "repos_url": "https://api.github.com/users/patzm/repos", "events_url": "https://api.github.com/users/patzm/events{/privacy}", "received_events_url": "https://api.github.com/users/patzm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 284285184, "node_id": "MDU6TGFiZWwyODQyODUxODQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tensorboard", "name": "comp:tensorboard", "color": "0052cc", "default": false, "description": ""}, {"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false, "description": ""}, {"id": 1345373822, "node_id": "MDU6TGFiZWwxMzQ1MzczODIy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:ds-triaged", "name": "stat:ds-triaged", "color": "f2dea7", "default": false, "description": "Internal label for triaging"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "karmel", "id": 667809, "node_id": "MDQ6VXNlcjY2NzgwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karmel", "html_url": "https://github.com/karmel", "followers_url": "https://api.github.com/users/karmel/followers", "following_url": "https://api.github.com/users/karmel/following{/other_user}", "gists_url": "https://api.github.com/users/karmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/karmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karmel/subscriptions", "organizations_url": "https://api.github.com/users/karmel/orgs", "repos_url": "https://api.github.com/users/karmel/repos", "events_url": "https://api.github.com/users/karmel/events{/privacy}", "received_events_url": "https://api.github.com/users/karmel/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "karmel", "id": 667809, "node_id": "MDQ6VXNlcjY2NzgwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karmel", "html_url": "https://github.com/karmel", "followers_url": "https://api.github.com/users/karmel/followers", "following_url": "https://api.github.com/users/karmel/following{/other_user}", "gists_url": "https://api.github.com/users/karmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/karmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karmel/subscriptions", "organizations_url": "https://api.github.com/users/karmel/orgs", "repos_url": "https://api.github.com/users/karmel/repos", "events_url": "https://api.github.com/users/karmel/events{/privacy}", "received_events_url": "https://api.github.com/users/karmel/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 17, "created_at": "2018-09-04T17:36:03Z", "updated_at": "2019-06-05T20:56:04Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: no\r\n- **OS Platform and Distribution**: Ubuntu 16.04\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: 1.12.0\r\n- **Python version**: 2.7\r\n- **Bazel version**: N/A\r\n- **Mobile device**: N/A\r\n- **CUDA/cuDNN version**: cuda-9-0 / libcudnn.so.7\r\n- **GPU model and memory**: 2x NVIDIA T4, 16GB\r\n- **Exact command to reproduce**: example provided here: https://github.com/patzm/tf-estimator-distribute-so\r\n\r\n### Describe the problem\r\nUsing a `tf.estimator.Estimator` with a distribution strategy like `OneDeviceStrategy` or `MirroredStrategy` creates a lot of tensors / operations that are not enclosed in a common scope.\r\nIf one views the graph in TensorBoard, it is very annoying.\r\nTensorBoard automatically zooms out until all nodes are visible, making everything so tiny and unreadable.\r\nAlso TensorBoard becomes pretty slow.\r\nIn essence this is the\r\n```python\r\n    run_config = tf.estimator.RunConfig(\r\n        model_dir='/tmp/some/dir',\r\n        session_config=session_config,\r\n        train_distribute=MirroredStrategy(num_gpus=2),  # or OneDeviceStrategy(device)\r\n        save_summary_steps=1,\r\n        save_checkpoints_steps=1e4,\r\n    )\r\n\r\n    estimator = tf.estimator.Estimator(\r\n        model_fn=model_fn,\r\n        config=run_config,\r\n        params={},\r\n    )\r\n```\r\nHere are two example images:\r\n\r\n* `OneDeviceStrategy`:\r\n  \r\n  ![OneDeviceStrategy](https://raw.githubusercontent.com/patzm/tf-estimator-distribute-so/master/images/OneDeviceStrategy.png)\r\n\r\n* `MirroredStrategy`:\r\n\r\n  ![MirroredStrategy](https://raw.githubusercontent.com/patzm/tf-estimator-distribute-so/master/images/MirroredStrategy.png)\r\n\r\nThe row / column of `Read_<num>` / `group_deps_<num>` nodes continues way beyond the area of the screenshot.\r\nThe initial view of the TensorBoard could look like this, with the nodes almost invisible, because they are so tiny:\r\n![TensorBoardInitialView](https://i.imgur.com/iuhxLCK.png)\r\n\r\n### Source code / logs\r\nexample provided here: https://github.com/patzm/tf-estimator-distribute-so\r\nI also raised the issue on StackOverflow: https://stackoverflow.com/questions/50924287/how-to-influence-the-name-scope-of-collated-variables-slots\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22052", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22052/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22052/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22052/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22052", "id": 356778106, "node_id": "MDU6SXNzdWUzNTY3NzgxMDY=", "number": 22052, "title": "Variables in bijectors cannot be reused.", "user": {"login": "shuiruge", "id": 2098947, "node_id": "MDQ6VXNlcjIwOTg5NDc=", "avatar_url": "https://avatars1.githubusercontent.com/u/2098947?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shuiruge", "html_url": "https://github.com/shuiruge", "followers_url": "https://api.github.com/users/shuiruge/followers", "following_url": "https://api.github.com/users/shuiruge/following{/other_user}", "gists_url": "https://api.github.com/users/shuiruge/gists{/gist_id}", "starred_url": "https://api.github.com/users/shuiruge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shuiruge/subscriptions", "organizations_url": "https://api.github.com/users/shuiruge/orgs", "repos_url": "https://api.github.com/users/shuiruge/repos", "events_url": "https://api.github.com/users/shuiruge/events{/privacy}", "received_events_url": "https://api.github.com/users/shuiruge/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvdillon", "id": 1137078, "node_id": "MDQ6VXNlcjExMzcwNzg=", "avatar_url": "https://avatars0.githubusercontent.com/u/1137078?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvdillon", "html_url": "https://github.com/jvdillon", "followers_url": "https://api.github.com/users/jvdillon/followers", "following_url": "https://api.github.com/users/jvdillon/following{/other_user}", "gists_url": "https://api.github.com/users/jvdillon/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvdillon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvdillon/subscriptions", "organizations_url": "https://api.github.com/users/jvdillon/orgs", "repos_url": "https://api.github.com/users/jvdillon/repos", "events_url": "https://api.github.com/users/jvdillon/events{/privacy}", "received_events_url": "https://api.github.com/users/jvdillon/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvdillon", "id": 1137078, "node_id": "MDQ6VXNlcjExMzcwNzg=", "avatar_url": "https://avatars0.githubusercontent.com/u/1137078?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvdillon", "html_url": "https://github.com/jvdillon", "followers_url": "https://api.github.com/users/jvdillon/followers", "following_url": "https://api.github.com/users/jvdillon/following{/other_user}", "gists_url": "https://api.github.com/users/jvdillon/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvdillon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvdillon/subscriptions", "organizations_url": "https://api.github.com/users/jvdillon/orgs", "repos_url": "https://api.github.com/users/jvdillon/repos", "events_url": "https://api.github.com/users/jvdillon/events{/privacy}", "received_events_url": "https://api.github.com/users/jvdillon/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-09-04T12:01:59Z", "updated_at": "2019-02-14T23:21:22Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Centos 6\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: N/A\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: 1.9.0 (tested in 1.10.0 too)\r\n- **Python version**: 3.6\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **GCC/Compiler version (if compiling from source)**: N/A\r\n- **CUDA/cuDNN version**: 8.0\r\n- **GPU model and memory**: NVIDIA Tesla, 24GB\r\n- **Exact command to reproduce**: the code within the \"Source code / logs\"\r\n\r\n### Describe the problem\r\nI am trying to reuse the weights and biases in the neural network within the MaskedAutoregressiveFlow bijector, by placing it within a `tf.variable_scope` with `reuse=tf.AUTO_REUSE`. But found that the weights and biases are not reused in practice.\r\n\r\n### Source code / logs\r\n```\r\nimport tensorflow as tf\r\nfrom tensorflow.contrib.distributions.python.ops import bijectors as tfb\r\n\r\ndef get_bijector(name='my_bijector', reuse=None):\r\n  \"\"\"Returns a MAF bijector.\"\"\"\r\n  with tf.variable_scope(name, reuse=reuse):\r\n    shift_and_log_scale_fn = \\\r\n        tfb.masked_autoregressive_default_template([128])\r\n    return tfb.MaskedAutoregressiveFlow(shift_and_log_scale_fn)\r\n  \r\nx = tf.placeholder(shape=[None, 64], dtype='float32', name='x')\r\n\r\nbijector_0 = get_bijector(reuse=tf.AUTO_REUSE)\r\ny_0 = bijector_0.forward(x)\r\n\r\nbijector_1 = get_bijector(reuse=tf.AUTO_REUSE)\r\ny_1 = bijector_1.forward(x)\r\n\r\n# We were expecting that the `y_0` and `y_1` share the same dependent variables,\r\n# since we used `tf.AUTO_REUSE` within the `tf.variable_scope`. However, the following\r\n# will return a `False`.\r\nprint(get_dependent_variables(y_0) == get_dependent_variables(y_1))\r\n```\r\n\r\nwherein we have employed the function that gains all the variables a tensor depends on:\r\n\r\n```\r\nimport collections\r\n\r\ndef get_dependent_variables(tensor):\r\n  \"\"\"Returns all variables that the tensor `tensor` depends on.\r\n  \r\n  Forked from: https://stackoverflow.com/a/42861919/1218716\r\n  \r\n  Args:\r\n    tensor: Tensor.\r\n    \r\n  Returns:\r\n    List of variables.\r\n  \"\"\"  \r\n  # Initialize\r\n  starting_op = tensor.op\r\n  dependent_vars = []\r\n  queue = collections.deque()\r\n  queue.append(starting_op)\r\n  op_to_var = {var.op: var for var in tf.trainable_variables()}\r\n  visited = {starting_op}\r\n\r\n  while queue:\r\n    op = queue.popleft()\r\n    try:\r\n      dependent_vars.append(op_to_var[op])\r\n    except KeyError:\r\n      # `op` is not a variable, so search its inputs (if any). \r\n      for op_input in op.inputs:\r\n        if op_input.op not in visited:\r\n          queue.append(op_input.op)\r\n          visited.add(op_input.op)\r\n          \r\n  return dependent_vars\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22039", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22039/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22039/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22039/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22039", "id": 356643590, "node_id": "MDU6SXNzdWUzNTY2NDM1OTA=", "number": 22039, "title": "Session.run () takes a long time", "user": {"login": "gulingfengze", "id": 16677891, "node_id": "MDQ6VXNlcjE2Njc3ODkx", "avatar_url": "https://avatars0.githubusercontent.com/u/16677891?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gulingfengze", "html_url": "https://github.com/gulingfengze", "followers_url": "https://api.github.com/users/gulingfengze/followers", "following_url": "https://api.github.com/users/gulingfengze/following{/other_user}", "gists_url": "https://api.github.com/users/gulingfengze/gists{/gist_id}", "starred_url": "https://api.github.com/users/gulingfengze/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gulingfengze/subscriptions", "organizations_url": "https://api.github.com/users/gulingfengze/orgs", "repos_url": "https://api.github.com/users/gulingfengze/repos", "events_url": "https://api.github.com/users/gulingfengze/events{/privacy}", "received_events_url": "https://api.github.com/users/gulingfengze/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "bignamehyp", "id": 3474655, "node_id": "MDQ6VXNlcjM0NzQ2NTU=", "avatar_url": "https://avatars2.githubusercontent.com/u/3474655?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bignamehyp", "html_url": "https://github.com/bignamehyp", "followers_url": "https://api.github.com/users/bignamehyp/followers", "following_url": "https://api.github.com/users/bignamehyp/following{/other_user}", "gists_url": "https://api.github.com/users/bignamehyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/bignamehyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bignamehyp/subscriptions", "organizations_url": "https://api.github.com/users/bignamehyp/orgs", "repos_url": "https://api.github.com/users/bignamehyp/repos", "events_url": "https://api.github.com/users/bignamehyp/events{/privacy}", "received_events_url": "https://api.github.com/users/bignamehyp/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "bignamehyp", "id": 3474655, "node_id": "MDQ6VXNlcjM0NzQ2NTU=", "avatar_url": "https://avatars2.githubusercontent.com/u/3474655?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bignamehyp", "html_url": "https://github.com/bignamehyp", "followers_url": "https://api.github.com/users/bignamehyp/followers", "following_url": "https://api.github.com/users/bignamehyp/following{/other_user}", "gists_url": "https://api.github.com/users/bignamehyp/gists{/gist_id}", "starred_url": "https://api.github.com/users/bignamehyp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bignamehyp/subscriptions", "organizations_url": "https://api.github.com/users/bignamehyp/orgs", "repos_url": "https://api.github.com/users/bignamehyp/repos", "events_url": "https://api.github.com/users/bignamehyp/events{/privacy}", "received_events_url": "https://api.github.com/users/bignamehyp/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2018-09-04T03:49:40Z", "updated_at": "2019-02-20T01:42:29Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:N/A\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**:1.9.0\r\n- **Python version**:3.6\r\n- **Bazel version (if compiling from source)**:N/A\r\n- **GCC/Compiler version (if compiling from source)**:6.4.0\r\n- **CUDA/cuDNN version**:9.0 / 7.0\r\n- **GPU model and memory**:GeForce GTX960\r\n- **Exact command to reproduce**:N/A\r\n\r\n### Describe the problem\r\n\r\nEach time tensorflow performs session.run() for target detection, the detection time of the first image is very long (including some initialization operations, of course), while the detection time of other images is normal. Suppose I detect the image under a certain path (for example, there are ten images), the time of detecting the first image is relatively long, and the remaining nine images are relatively short (basically consistent). However, my operation in practical application is as follows: the session.run() is called every once in a while to detect a picture. I hope that the detection time after the first one is normal except for the long time. However, through my test (guess), after exiting the loop logic of detection, tensorflow redid a series of initialization operations the next time the detection was done, which puzzled me.\r\n\r\nWith other frameworks, such as mxnet, initial detection takes longer. And then the detection time is normal, as if it's not doing some initialization anymore. I thought, could tensorflow do the same thing?\r\n\r\n### Source code / logs\r\n\r\n2018-09-04 14:48:59.111510: W tensorflow/core/common_runtime/bfc_allocator.cc:219] Allocator (GPU_0_bfc) ran out of memory trying to allocate 3.57GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.\r\ntime\uff1a5627.940655ms\r\n0.9999423027038574\r\ntime\uff1a657.650471ms\r\n0.9996843338012695\r\ntime\uff1a676.565170ms\r\n0.9722122550010681\r\n0.6320008635520935\r\ntime\uff1a667.881966ms\r\n0.996504545211792\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22037", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22037/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22037/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22037/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22037", "id": 356610740, "node_id": "MDU6SXNzdWUzNTY2MTA3NDA=", "number": 22037, "title": "compile issue for bazel build tensorflow/python/tools:optimize_for_inference", "user": {"login": "starkdg", "id": 17888885, "node_id": "MDQ6VXNlcjE3ODg4ODg1", "avatar_url": "https://avatars3.githubusercontent.com/u/17888885?v=4", "gravatar_id": "", "url": "https://api.github.com/users/starkdg", "html_url": "https://github.com/starkdg", "followers_url": "https://api.github.com/users/starkdg/followers", "following_url": "https://api.github.com/users/starkdg/following{/other_user}", "gists_url": "https://api.github.com/users/starkdg/gists{/gist_id}", "starred_url": "https://api.github.com/users/starkdg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/starkdg/subscriptions", "organizations_url": "https://api.github.com/users/starkdg/orgs", "repos_url": "https://api.github.com/users/starkdg/repos", "events_url": "https://api.github.com/users/starkdg/events{/privacy}", "received_events_url": "https://api.github.com/users/starkdg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "reedwm", "id": 6510203, "node_id": "MDQ6VXNlcjY1MTAyMDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6510203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedwm", "html_url": "https://github.com/reedwm", "followers_url": "https://api.github.com/users/reedwm/followers", "following_url": "https://api.github.com/users/reedwm/following{/other_user}", "gists_url": "https://api.github.com/users/reedwm/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedwm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedwm/subscriptions", "organizations_url": "https://api.github.com/users/reedwm/orgs", "repos_url": "https://api.github.com/users/reedwm/repos", "events_url": "https://api.github.com/users/reedwm/events{/privacy}", "received_events_url": "https://api.github.com/users/reedwm/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "reedwm", "id": 6510203, "node_id": "MDQ6VXNlcjY1MTAyMDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6510203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedwm", "html_url": "https://github.com/reedwm", "followers_url": "https://api.github.com/users/reedwm/followers", "following_url": "https://api.github.com/users/reedwm/following{/other_user}", "gists_url": "https://api.github.com/users/reedwm/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedwm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedwm/subscriptions", "organizations_url": "https://api.github.com/users/reedwm/orgs", "repos_url": "https://api.github.com/users/reedwm/repos", "events_url": "https://api.github.com/users/reedwm/events{/privacy}", "received_events_url": "https://api.github.com/users/reedwm/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2018-09-03T23:02:38Z", "updated_at": "2019-03-23T18:25:54Z", "closed_at": null, "author_association": "NONE", "body": "optimize_for_inference.py\r\n\r\n### System information:\r\n\r\n## OS platform and distribution\r\nLinux debian 4.9.0-6-amd64 #1 SMP Debian 4.9.82-1+deb9u3 (2018-03-02) x86_64 GNU/Linux\r\n\r\n## Tensorflow version\r\nTensorflow version r1.9 (compiled from source for CPU)\r\n\r\n## CUDA/cuDNN \r\nn/a\r\n\r\n## gpu model and memory\r\nn/a\r\n\r\n## Python version\r\nPython version 3.5\r\n\r\n## Bazel version\r\nBazel version 0.16.0 \r\n\r\n## Gcc version\r\ngcc version 6.3.0\r\n\r\n## No custom code used, just standard script:\r\noptimize_for_inference.py\r\n\r\n### Command to reproduce:\r\n\r\nbazel build tensorflow/python/tools:optimize_for_inference\r\n\r\n### Mobile device \r\n\r\nn/a\r\n\r\n### Problem:\r\n\r\nThe result is a failure to build.  \r\n\r\n### Source code / logs\r\nThe output is rather lengthy, but here is the relevant \"ERROR\" part:\r\n\r\nERROR: /home/david/tensorflow/tensorflow/contrib/coder/BUILD:144:1: C++ compilation of rule '//tensorflow/contrib/coder:python/ops/_coder_ops.so' failed (Exit 1)\r\nIn file included from /usr/include/c++/6/map:60:0,\r\n                 from external/protobuf_archive/src/google/protobuf/stubs/common.h:40,\r\n                 from external/protobuf_archive/src/google/protobuf/stubs/atomicops.h:59,\r\n                 from external/protobuf_archive/src/google/protobuf/stubs/atomic_sequence_num.h:33,\r\n                 from external/protobuf_archive/src/google/protobuf/arena_impl.h:38,\r\n                 from external/protobuf_archive/src/google/protobuf/arena.h:54,\r\n                 from ./tensorflow/core/platform/default/protobuf.h:22,\r\n                 from ./tensorflow/core/platform/protobuf.h:31,\r\n                 from ./tensorflow/core/platform/default/string_coding.h:23,\r\n                 from ./tensorflow/core/platform/tensor_coding.h:29,\r\n                 from ./tensorflow/core/framework/resource_handle.h:19,\r\n                 from ./tensorflow/core/framework/allocator.h:24,\r\n                 from ./tensorflow/core/framework/op_kernel.h:23,\r\n                 from tensorflow/contrib/coder/kernels/pmf_to_cdf_op.cc:24:\r\n/usr/include/c++/6/bits/stl_tree.h: In instantiation of 'std::pair<std::_Rb_tree_iterator<_Val>, std::_Rb_tree_iterator<_Val> > std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::equal_range(const _Key&) [with _Key = std::__cxx11::basic_string<char>*; _Val = std::__cxx11::basic_string<char>*; _KeyOfValue = std::_Identity<std::__cxx11::basic_string<char>*>; _Compare = google::protobuf::Map<std::__cxx11::basic_string<char>, tensorflow::AttrValue>::InnerMap::KeyCompare; _Alloc = google::protobuf::Map<std::__cxx11::basic_string<char>, tensorflow::AttrValue>::MapAllocator<std::__cxx11::basic_string<char>*>]':\r\n/usr/include/c++/6/bits/stl_tree.h:2298:49:   required from 'std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::size_type std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::erase(const _Key&) [with _Key = std::__cxx11::basic_string<char>*; _Val = std::__cxx11::basic_string<char>*; _KeyOfValue = std::_Identity<std::__cxx11::basic_string<char>*>; _Compare = google::protobuf::Map<std::__cxx11::basic_string<char>, tensorflow::AttrValue>::InnerMap::KeyCompare; _Alloc = google::protobuf::Map<std::__cxx11::basic_string<char>, tensorflow::AttrValue>::MapAllocator<std::__cxx11::basic_string<char>*>; std::_Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::size_type = long unsigned int]'\r\n/usr/include/c++/6/bits/stl_set.h:602:30:   required from 'std::set<_Key, _Compare, _Alloc>::size_type std::set<_Key, _Compare, _Alloc>::erase(const key_type&) [with _Key = std::__cxx11::basic_string<char>*; _Compare = google::protobuf::Map<std::__cxx11::basic_string<char>, tensorflow::AttrValue>::InnerMap::KeyCompare; _Alloc = google::protobuf::Map<std::__cxx11::basic_string<char>, tensorflow::AttrValue>::MapAllocator<std::__cxx11::basic_string<char>*>; std::set<_Key, _Compare, _Alloc>::size_type = long unsigned int; std::set<_Key, _Compare, _Alloc>::key_type = std::__cxx11::basic_string<char>*]'\r\nexternal/protobuf_archive/src/google/protobuf/map.h:619:9:   required from 'void google::protobuf::Map<Key, T>::InnerMap::erase(google::protobuf::Map<Key, T>::InnerMap::iterator) [with Key = std::__cxx11::basic_string<char>; T = tensorflow::AttrValue; google::protobuf::Map<Key, T>::InnerMap::iterator = google::protobuf::Map<std::__cxx11::basic_string<char>, tensorflow::AttrValue>::InnerMap::iterator_base<google::protobuf::Map<std::__cxx11::basic_string<char>, tensorflow::AttrValue>::KeyValuePair>]'\r\nexternal/protobuf_archive/src/google/protobuf/map.h:1139:5:   required from 'google::protobuf::Map<Key, T>::iterator google::protobuf::Map<Key, T>::erase(google::protobuf::Map<Key, T>::iterator) [with Key = std::__cxx11::basic_string<char>; T = tensorflow::AttrValue]'\r\nexternal/protobuf_archive/src/google/protobuf/map.h:1144:20:   required from 'void google::protobuf::Map<Key, T>::erase(google::protobuf::Map<Key, T>::iterator, google::protobuf::Map<Key, T>::iterator) [with Key = std::__cxx11::basic_string<char>; T = tensorflow::AttrValue]'\r\nexternal/protobuf_archive/src/google/protobuf/map.h:1147:23:   required from 'void google::protobuf::Map<Key, T>::clear() [with Key = std::__cxx11::basic_string<char>; T = tensorflow::AttrValue]'\r\nexternal/protobuf_archive/src/google/protobuf/map_field_inl.h:180:3:   required from 'void google::protobuf::internal::MapField<Derived, Key, T, key_wire_type, value_wire_type, default_enum_value>::Clear() [with Derived = tensorflow::NameAttrList_AttrEntry_DoNotUse; Key = std::__cxx11::basic_string<char>; T = tensorflow::AttrValue; google::protobuf::internal::WireFormatLite::FieldType kKeyFieldType = (google::protobuf::internal::WireFormatLite::FieldType)9u; google::protobuf::internal::WireFormatLite::FieldType kValueFieldType = (google::protobuf::internal::WireFormatLite::FieldType)11u; int default_enum_value = 0]'\r\nbazel-out/k8-opt/genfiles/tensorflow/core/framework/attr_value.pb.h:1764:15:   required from here\r\n/usr/include/c++/6/bits/stl_tree.h:1739:5: internal compiler error: Segmentation fault\r\n     }\r\n     ^\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22028", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22028/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22028/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22028/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22028", "id": 356483953, "node_id": "MDU6SXNzdWUzNTY0ODM5NTM=", "number": 22028, "title": "Graph Transorform fold_constants does not work with NoOp as output node", "user": {"login": "ajgarn", "id": 5390422, "node_id": "MDQ6VXNlcjUzOTA0MjI=", "avatar_url": "https://avatars1.githubusercontent.com/u/5390422?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ajgarn", "html_url": "https://github.com/ajgarn", "followers_url": "https://api.github.com/users/ajgarn/followers", "following_url": "https://api.github.com/users/ajgarn/following{/other_user}", "gists_url": "https://api.github.com/users/ajgarn/gists{/gist_id}", "starred_url": "https://api.github.com/users/ajgarn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ajgarn/subscriptions", "organizations_url": "https://api.github.com/users/ajgarn/orgs", "repos_url": "https://api.github.com/users/ajgarn/repos", "events_url": "https://api.github.com/users/ajgarn/events{/privacy}", "received_events_url": "https://api.github.com/users/ajgarn/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "shivaniag", "id": 16565716, "node_id": "MDQ6VXNlcjE2NTY1NzE2", "avatar_url": "https://avatars1.githubusercontent.com/u/16565716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shivaniag", "html_url": "https://github.com/shivaniag", "followers_url": "https://api.github.com/users/shivaniag/followers", "following_url": "https://api.github.com/users/shivaniag/following{/other_user}", "gists_url": "https://api.github.com/users/shivaniag/gists{/gist_id}", "starred_url": "https://api.github.com/users/shivaniag/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shivaniag/subscriptions", "organizations_url": "https://api.github.com/users/shivaniag/orgs", "repos_url": "https://api.github.com/users/shivaniag/repos", "events_url": "https://api.github.com/users/shivaniag/events{/privacy}", "received_events_url": "https://api.github.com/users/shivaniag/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "shivaniag", "id": 16565716, "node_id": "MDQ6VXNlcjE2NTY1NzE2", "avatar_url": "https://avatars1.githubusercontent.com/u/16565716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shivaniag", "html_url": "https://github.com/shivaniag", "followers_url": "https://api.github.com/users/shivaniag/followers", "following_url": "https://api.github.com/users/shivaniag/following{/other_user}", "gists_url": "https://api.github.com/users/shivaniag/gists{/gist_id}", "starred_url": "https://api.github.com/users/shivaniag/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shivaniag/subscriptions", "organizations_url": "https://api.github.com/users/shivaniag/orgs", "repos_url": "https://api.github.com/users/shivaniag/repos", "events_url": "https://api.github.com/users/shivaniag/events{/privacy}", "received_events_url": "https://api.github.com/users/shivaniag/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-09-03T12:20:34Z", "updated_at": "2018-12-19T18:49:10Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nYes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\nOS X 10.13.6\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\nN/A\r\n- **TensorFlow installed from (source or binary)**:\r\nbinary\r\n- **TensorFlow version (use command below)**:\r\nv1.10.0-rc1-19-g656e7a2b34 1.10.0\r\n- **Python version**:\r\nPython 3.6.5\r\n- **Bazel version (if compiling from source)**:\r\nN/A\r\n- **GCC/Compiler version (if compiling from source)**:\r\nN/A\r\n- **CUDA/cuDNN version**:\r\nN/A\r\n- **GPU model and memory**:\r\nN/A\r\n- **Exact command to reproduce**:\r\nN/A\r\n\r\n### Describe the problem\r\nI run the [Graph Transform](https://github.com/tensorflow/tensorflow/tree/master/tensorflow/tools/graph_transforms/) tool and apply the transformation `fold_constants(ignore_errors=true)`. One of the output nodes I specify is a variable initializer (i.e. a `NoOp`). This causes the `fold_constants` transformation to fail and my graph is not optimized.\r\n\r\n### Source code / logs\r\n```python\r\nfrom tensorflow.tools import graph_transforms\r\n\r\nwith tf.Graph().as_default():\r\n    # Setup a graph\r\n    \r\n    tf.variables_initializer(variables_to_initialize, name='initializer')\r\n    \r\n    graph_def = tf.get_default_graph().as_graph_def()\r\n\r\noutput_nodes = ['graph_output', 'initializer']\r\ngraph_def = graph_transforms.TransformGraph(\r\n        graph_def, input_nodes, output_nodes, [\r\n           'fold_constants(ignore_errors=true)'\r\n        ])\r\n```\r\nOutput\r\n\r\n    2018-09-03 14:28:06.751967: I tensorflow/tools/graph_transforms/transform_graph.cc:318] Applying fold_constants\r\n    2018-09-03 14:28:06.756892: E tensorflow/tools/graph_transforms/transform_graph.cc:333] fold_constants: Ignoring error Tried to fetch data for 'initializer', which produces no output.  To run to a node but not fetch any data, pass 'initializer' as an argument to the 'target_node_names' argument of the Session::Run API.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22027", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22027/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22027/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22027/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22027", "id": 356480384, "node_id": "MDU6SXNzdWUzNTY0ODAzODQ=", "number": 22027, "title": "tfcompile: minimum_alignment_for_allocation and kAlign = 64", "user": {"login": "wuclv", "id": 30358621, "node_id": "MDQ6VXNlcjMwMzU4NjIx", "avatar_url": "https://avatars0.githubusercontent.com/u/30358621?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wuclv", "html_url": "https://github.com/wuclv", "followers_url": "https://api.github.com/users/wuclv/followers", "following_url": "https://api.github.com/users/wuclv/following{/other_user}", "gists_url": "https://api.github.com/users/wuclv/gists{/gist_id}", "starred_url": "https://api.github.com/users/wuclv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wuclv/subscriptions", "organizations_url": "https://api.github.com/users/wuclv/orgs", "repos_url": "https://api.github.com/users/wuclv/repos", "events_url": "https://api.github.com/users/wuclv/events{/privacy}", "received_events_url": "https://api.github.com/users/wuclv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-09-03T12:09:20Z", "updated_at": "2018-12-14T18:59:45Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 18.04.1\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: -\r\n- **TensorFlow installed from (source or binary)**: Yes\r\n- **TensorFlow version (use command below)**: v1.10.1-0-g4dcfddc5d1\r\n- **Python version**: 3.6.5\r\n- **Bazel version (if compiling from source)**: 0.16.1\r\n- **GCC/Compiler version (if compiling from source)**: 7.3.0\r\n- **CUDA/cuDNN version**: -\r\n- **GPU model and memory**: -\r\n- **Exact command to reproduce**: -\r\n\r\n\r\n### Describe the problem\r\n\r\ntfcompile uses `minimum_alignment_for_allocation` to check if it can call Eigen on a tensor. `minimum_alignment_for_allocation` uses the minimum alignment of `malloc` but the buffers that tfcompile uses are allocated by `MallocContiguousBuffers` which currently always returns buffers with a minimum alignment of `kAlign` = 64.\r\n\r\n\r\n### Source code / logs\r\n\r\nhttps://github.com/tensorflow/tensorflow/blob/4dcfddc5d12018a5a0fdca652b9221ed95e9eb23/tensorflow/compiler/xla/service/cpu/target_machine_features.cc#L34-L43\r\n\r\nhttps://github.com/tensorflow/tensorflow/blob/4dcfddc5d12018a5a0fdca652b9221ed95e9eb23/tensorflow/compiler/aot/runtime.h#L36-L37\r\n\r\nhttps://github.com/tensorflow/tensorflow/blob/4dcfddc5d12018a5a0fdca652b9221ed95e9eb23/tensorflow/compiler/aot/runtime.h#L29"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22023", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22023/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22023/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22023/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22023", "id": 356416139, "node_id": "MDU6SXNzdWUzNTY0MTYxMzk=", "number": 22023, "title": "Tensorflow build fails with vectorization ", "user": {"login": "Nayana-ibm", "id": 20816038, "node_id": "MDQ6VXNlcjIwODE2MDM4", "avatar_url": "https://avatars0.githubusercontent.com/u/20816038?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nayana-ibm", "html_url": "https://github.com/Nayana-ibm", "followers_url": "https://api.github.com/users/Nayana-ibm/followers", "following_url": "https://api.github.com/users/Nayana-ibm/following{/other_user}", "gists_url": "https://api.github.com/users/Nayana-ibm/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nayana-ibm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nayana-ibm/subscriptions", "organizations_url": "https://api.github.com/users/Nayana-ibm/orgs", "repos_url": "https://api.github.com/users/Nayana-ibm/repos", "events_url": "https://api.github.com/users/Nayana-ibm/events{/privacy}", "received_events_url": "https://api.github.com/users/Nayana-ibm/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 27, "created_at": "2018-09-03T09:01:22Z", "updated_at": "2019-04-03T19:44:51Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "### System information\r\n\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:  Ubuntu 16.04, 18.04 \r\n- **TensorFlow installed from (source or binary)**:  source \r\n- **TensorFlow version (use command below)**:  1.8.0 \r\n- **Python version**:  2.7.15rc1\r\n- **Bazel version (if compiling from source)**:  0.12.0\r\n- **GCC/Compiler version (if compiling from source)**: gcc-7.3.0, gcc-6.3.0\r\n- **CUDA/cuDNN version**: NA\r\n- **GPU model and memory**: NA\r\n- **Exact command to reproduce**:  ` bazel build -c opt  --incompatible_load_argument_is_label=false --incompatible_disallow_uncalled_set_constructor=false  --config=opt  --copt=\"-mzvector\" //tensorflow/tools/pip_package:build_pip_package`\r\n\r\n**Description:** \r\nWhile building TensorFlow with vectorization on s390x platform, faced following issues :\r\n**With gcc 6.3.0 , Ubuntu 16.04, z13**  :\r\n\r\n```\r\nINFO: From Compiling external/snappy/snappy-sinksource.cc [for host]:\r\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\r\nSlow read: a 7184608-byte read from /root/.cache/bazel/_bazel_root/9b63c66f147d91a5644a0e81d48c020e/external/org_sqlite/sqlite3.c took 26065ms.\r\nERROR: /root/.cache/bazel/_bazel_root/9b63c66f147d91a5644a0e81d48c020e/external/org_sqlite/BUILD:35:1: C++ compilation of rule '@org_sqlite//:org_sqlite' failed (Exit 1)\r\nexternal/org_sqlite/sqlite3.c: In function 'vdbeRecordCompareInt':\r\nexternal/org_sqlite/sqlite3.c:76283:1: internal compiler error: in maybe_record_trace_start, at dwarf2cfi.c:2284\r\n}\r\n\u02c6\r\n0x1385bc7 maybe_record_trace_start\r\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:2284\r\n0x1388285 scan_trace\r\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:2462\r\n0x13888dd create_cfi_notes\r\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:2616\r\n0x13888dd execute_dwarf2_frame\r\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:2974\r\n0x13888dd execute\r\n        ../../gcc-6.3.0/gcc/dwarf2cfi.c:3454\r\nPlease submit a full bug report,\r\nwith preprocessed source if appropriate.\r\nPlease include the complete backtrace with any bug report.\r\nSee <http://gcc.gnu.org/bugs.html> for instructions.\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nUse --verbose_failures to see the command lines of failed build steps.\r\nINFO: Elapsed time: 1795.018s, Critical Path: 24.14s\r\nFAILED: Build did NOT complete successfully\r\n```\r\n**With gcc 6.3.0/7.3.0 , Ubuntu 16.04, z14**  :\r\n\r\n```\r\nERROR: /tensorflow/tensorflow/core/kernels/BUILD:436:1: C++ compilation of rule '//tensorflow/core/kernels:split_lib' failed (Exit 1)\r\nIn file included from external/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/Core:427:0,\r\n                from external/eigen_archive/unsupported/Eigen/CXX11/Tensor:14,\r\n                from ./third_party/eigen3/unsupported/Eigen/CXX11/Tensor:1,\r\n                from ./tensorflow/core/kernels/split_lib.h:20,\r\n                from tensorflow/core/kernels/split_lib_cpu.cc:18:\r\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Eigen::internal::Packet4f Eigen::internal::vec_splat_packet4f(const Packet4f&)':\r\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/ZVector/PacketMath.h:657:11: error: request for member 'v4f' in 'splat', which is of non-class type 'Eigen::internal::Packet4f {aka __vector(4) float}'\r\n    splat.v4f[0] = vec_splat(from.v4f[0], 0);\r\n          \u02c6\u02dc\u02dc\r\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/ZVector/PacketMath.h:657:35: error: request for member 'v4f' in 'from', which is of non-class type 'const Packet4f {aka const __vector(4) float}'\r\n    splat.v4f[0] = vec_splat(from.v4f[0], 0);\r\n                                  \u02c6\u02dc\u02dc\r\nexternal/eigen_archive/unsupported/Eigen/CXX11/../../../Eigen/src/Core/arch/ZVector/PacketMath.h:657:44: internal compiler error: tree check: expected class 'type', have 'exceptional' (error_mark) in s390_fn_types_compatible, at config/s390/s390-c.c:727\r\n    splat.v4f[0] = vec_splat(from.v4f[0], 0);\r\n                                           \u02c6\r\n0x80cc535f tree_class_check_failed(tree_node const*, tree_code_class, char const*, int, char const*)\r\n       ../../gcc-6.3.0/gcc/tree.c:9704\r\n```\r\n\r\n**With gcc 7.3.0 , Ubuntu 18.04, z14**  :\r\n```\r\n\r\nINFO: From Compiling tensorflow/contrib/lite/util.cc:\r\ntensorflow/contrib/lite/util.cc: In function 'TfLiteIntArray* tflite::ConvertArrayToTfLiteIntArray(int, const int*)':\r\ntensorflow/contrib/lite/util.cc:25:24: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\r\n   for (size_t i = 0; i < rank; i++) {\r\n                      \u02dc\u02dc\u02c6\u02dc\u02dc\u02dc\u02dc\u02dc\r\nERROR: /scratch/ecos0030/nayana/tensorflow/tensorflow/contrib/lite/kernels/BUILD:43:1: C++ compilation of rule '//tensorflow/contrib/lite/kernels:eig         en_support' failed (Exit 1)\r\nIn file included from external/eigen_archive/Eigen/Core:248:0,\r\n                 from ./third_party/eigen3/Eigen/Core:1,\r\n                 from tensorflow/contrib/lite/kernels/eigen_support.cc:17:\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pround(const Packet&) [with Packet = __vector(2         ) double]':\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:471:86: error: '__builtin_s390_vfi' was not declared in this scope\r\ntemplate<> EIGEN_STRONG_INLINE Packet2d pround<Packet2d>(const Packet2d& a) { return vec_round(a); }\r\n                                                                                      \u02c6\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:471:86: note: suggested alternative: '__builtin_s390_vfidb'\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pceil(const Packet&) [with Packet = __vector(2)          double]':\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:472:86: error: '__builtin_s390_vfi' was not declared in this scope\r\ntemplate<> EIGEN_STRONG_INLINE Packet2d pceil<Packet2d>(const  Packet2d& a) { return vec_ceil(a); }\r\n                                                                                      \u02c6\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:472:86: note: suggested alternative: '__builtin_s390_vfidb'\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pfloor(const Packet&) [with Packet = __vector(2         ) double]':\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:473:86: error: '__builtin_s390_vfi' was not declared in this scope\r\ntemplate<> EIGEN_STRONG_INLINE Packet2d pfloor<Packet2d>(const Packet2d& a) { return vec_floor(a); }\r\n                                                                                      \u02c6\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:473:86: note: suggested alternative: '__builtin_s390_vfidb'\r\nIn file included from external/eigen_archive/Eigen/Core:427:0,\r\n                 from ./third_party/eigen3/Eigen/Core:1,\r\n                 from tensorflow/contrib/lite/kernels/eigen_support.cc:17:\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pmadd(const Packet&, const Packet&, const Packe         t&) [with Packet = __vector(4) float]':\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1073:141: error: cannot convert 'const Packet4f {aka const __vector(4) float}' to '__         vector(2) double' for argument '1' to '__vector(2) double __builtin_s390_vfmadb(__vector(2) double, __vector(2) double, __vector(2) double)'\r\ntemplate<> EIGEN_STRONG_INLINE Packet4f pmadd<Packet4f>  (const Packet4f& a, const Packet4f& b, const Packet4f& c) { return vec_madd(a, b, c); }\r\n                                                                                                                                             \u02c6\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pxor(const Packet&, const Packet&) [with Packet          = __vector(4) float]':\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1078:118: error: invalid parameter combination for intrinsic '__builtin_s390_vec_xor'\r\ntemplate<> EIGEN_STRONG_INLINE Packet4f pxor<Packet4f>   (const Packet4f& a, const Packet4f& b) { return vec_xor(a, b); }\r\n                                                                                                                      \u02c6\r\nIn file included from external/eigen_archive/Eigen/Core:248:0,\r\n                 from ./third_party/eigen3/Eigen/Core:1,\r\n                 from tensorflow/contrib/lite/kernels/eigen_support.cc:17:\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pround(const Packet&) [with Packet = __vector(4         ) float]':\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1080:87: error: '__builtin_s390_vfi' was not declared in this scope\r\ntemplate<> EIGEN_STRONG_INLINE Packet4f pround<Packet4f> (const Packet4f& a) { return vec_round(a); }\r\n                                                                                       \u02c6\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1080:87: note: suggested alternative: '__builtin_s390_vfidb'\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pceil(const Packet&) [with Packet = __vector(4)          float]':\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1081:87: error: '__builtin_s390_vfi' was not declared in this scope\r\ntemplate<> EIGEN_STRONG_INLINE Packet4f pceil<Packet4f>  (const Packet4f& a) { return vec_ceil(a); }\r\n                                                                                       \u02c6\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1081:87: note: suggested alternative: '__builtin_s390_vfidb'\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h: In function 'Packet Eigen::internal::pfloor(const Packet&) [with Packet = __vector(4         ) float]':\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1082:87: error: '__builtin_s390_vfi' was not declared in this scope\r\ntemplate<> EIGEN_STRONG_INLINE Packet4f pfloor<Packet4f> (const Packet4f& a) { return vec_floor(a); }\r\n                                                                                       \u02c6\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/PacketMath.h:1082:87: note: suggested alternative: '__builtin_s390_vfidb'\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/MathFunctions.h: In function 'Packet Eigen::internal::pexp(const Packet&) [with Packet = __vector(         2) double]':\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/MathFunctions.h:101:8: error: '__builtin_s390_vfi' was not declared in this scope\r\n   fx = vec_floor(fx);\r\n        \u02c6\r\nexternal/eigen_archive/Eigen/src/Core/arch/ZVector/MathFunctions.h:101:8: note: suggested alternative: '__builtin_s390_vfidb'\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\n```\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22007", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22007/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22007/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22007/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22007", "id": 356230397, "node_id": "MDU6SXNzdWUzNTYyMzAzOTc=", "number": 22007, "title": "Newly included absl headers are missing from the include path", "user": {"login": "alsrgv", "id": 16640218, "node_id": "MDQ6VXNlcjE2NjQwMjE4", "avatar_url": "https://avatars2.githubusercontent.com/u/16640218?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alsrgv", "html_url": "https://github.com/alsrgv", "followers_url": "https://api.github.com/users/alsrgv/followers", "following_url": "https://api.github.com/users/alsrgv/following{/other_user}", "gists_url": "https://api.github.com/users/alsrgv/gists{/gist_id}", "starred_url": "https://api.github.com/users/alsrgv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alsrgv/subscriptions", "organizations_url": "https://api.github.com/users/alsrgv/orgs", "repos_url": "https://api.github.com/users/alsrgv/repos", "events_url": "https://api.github.com/users/alsrgv/events{/privacy}", "received_events_url": "https://api.github.com/users/alsrgv/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586558, "node_id": "MDU6TGFiZWw0MDQ1ODY1NTg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:community%20support", "name": "stat:community support", "color": "f4b400", "default": false, "description": ""}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 24, "created_at": "2018-09-01T20:26:32Z", "updated_at": "2019-04-23T03:53:46Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "[Newly included](https://github.com/tensorflow/tensorflow/commit/3cb3a450ed845c4602080f43d7bb6cfade298a22) `absl` headers are present in the `tf-nightly` Python package but do not seem to be part of the include path, and now custom op plugin compilation fails.\r\n\r\nThis has been broken between `tf_nightly-1.11.0.dev20180830` and `tf_nightly-1.11.0.dev20180831`.\r\n\r\n```\r\n    x86_64-linux-gnu-gcc -pthread -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fno-strict-aliasing -Wdate-time -D_FORTIFY_SOURCE=2 -g -fstack-protector-strong -Wformat -Werror=format-security -fPIC -DHAVE_CUDA=1 -DHAVE_NCCL=1 -DHOROVOD_GPU_ALLREDUCE='N' -I/usr/local/cuda/include -I/usr/include/python2.7 -c horovod/tensorflow/mpi_ops.cc -o build/temp.linux-x86_64-2.7/horovod/tensorflow/mpi_ops.o -std=c++11 -fPIC -O2 -I/usr/local/include -pthread -Wl,-rpath -Wl,/usr/local/lib -Wl,--enable-new-dtags -L/usr/local/lib -lmpi -I/usr/local/lib/python2.7/dist-packages/tensorflow/include -D_GLIBCXX_USE_CXX11_ABI=0\r\n    cc1plus: warning: command line option '-Wstrict-prototypes' is valid for C/ObjC but not for C++\r\n    In file included from /usr/local/lib/python2.7/dist-packages/tensorflow/include/tensorflow/core/lib/core/status.h:24:0,\r\n                     from /usr/local/lib/python2.7/dist-packages/tensorflow/include/tensorflow/core/framework/op_def_builder.h:25,\r\n                     from /usr/local/lib/python2.7/dist-packages/tensorflow/include/tensorflow/core/framework/op.h:23,\r\n                     from horovod/tensorflow/mpi_ops.cc:22:\r\n    /usr/local/lib/python2.7/dist-packages/tensorflow/include/tensorflow/core/lib/core/stringpiece.h:34:38: fatal error: absl/strings/string_view.h: No such file or directory\r\n    compilation terminated.\r\n    error: command 'x86_64-linux-gnu-gcc' failed with exit status 1\r\n```\r\n\r\ncc @yunxing "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22000", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22000/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22000/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/22000/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/22000", "id": 356155941, "node_id": "MDU6SXNzdWUzNTYxNTU5NDE=", "number": 22000, "title": "Map twice on a shuffled dataset got different result", "user": {"login": "jgong5", "id": 8359223, "node_id": "MDQ6VXNlcjgzNTkyMjM=", "avatar_url": "https://avatars3.githubusercontent.com/u/8359223?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jgong5", "html_url": "https://github.com/jgong5", "followers_url": "https://api.github.com/users/jgong5/followers", "following_url": "https://api.github.com/users/jgong5/following{/other_user}", "gists_url": "https://api.github.com/users/jgong5/gists{/gist_id}", "starred_url": "https://api.github.com/users/jgong5/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jgong5/subscriptions", "organizations_url": "https://api.github.com/users/jgong5/orgs", "repos_url": "https://api.github.com/users/jgong5/repos", "events_url": "https://api.github.com/users/jgong5/events{/privacy}", "received_events_url": "https://api.github.com/users/jgong5/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "tatatodd", "id": 5453737, "node_id": "MDQ6VXNlcjU0NTM3Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5453737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatatodd", "html_url": "https://github.com/tatatodd", "followers_url": "https://api.github.com/users/tatatodd/followers", "following_url": "https://api.github.com/users/tatatodd/following{/other_user}", "gists_url": "https://api.github.com/users/tatatodd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatatodd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatatodd/subscriptions", "organizations_url": "https://api.github.com/users/tatatodd/orgs", "repos_url": "https://api.github.com/users/tatatodd/repos", "events_url": "https://api.github.com/users/tatatodd/events{/privacy}", "received_events_url": "https://api.github.com/users/tatatodd/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tatatodd", "id": 5453737, "node_id": "MDQ6VXNlcjU0NTM3Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5453737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatatodd", "html_url": "https://github.com/tatatodd", "followers_url": "https://api.github.com/users/tatatodd/followers", "following_url": "https://api.github.com/users/tatatodd/following{/other_user}", "gists_url": "https://api.github.com/users/tatatodd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatatodd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatatodd/subscriptions", "organizations_url": "https://api.github.com/users/tatatodd/orgs", "repos_url": "https://api.github.com/users/tatatodd/repos", "events_url": "https://api.github.com/users/tatatodd/events{/privacy}", "received_events_url": "https://api.github.com/users/tatatodd/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-09-01T00:30:28Z", "updated_at": "2018-12-20T18:49:21Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 14.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**: source (self built)\r\n- **TensorFlow version (use command below)**: v1.9.0-rc2-1175-g12f51c2 1.9.0\r\n- **Python version**: 3.x\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**:\r\n- **GPU model and memory**:\r\n- **Exact command to reproduce**:\r\n\r\n### Describe the problem\r\nDescribe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.\r\nI do a shuffle on a dataset and then map it twice before zip the result to a pair. I expect the pair has the same value, e.g. (0,0) or (30,30) but the running result shows differently, e.g. (78, 31). Is it a normal behavior of shuffle and map? Why?\r\n\r\n### Source code / logs\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n```\r\ndataset = tf.data.Dataset.range(100)\r\ndataset = dataset.shuffle(buffer_size=100)\r\nfeature = dataset.map(lambda x: x)\r\nlabel = dataset.map(lambda x: x)\r\ndataset = tf.data.Dataset.zip((feature, label))\r\nnext_item = dataset.make_one_shot_iterator().get_next()\r\nwith tf.Session() as sess:\r\n    print(sess.run(next_item))\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21998", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21998/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21998/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21998/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21998", "id": 356134968, "node_id": "MDU6SXNzdWUzNTYxMzQ5Njg=", "number": 21998, "title": "TensorRT INT8 assertion failed when performing calibration", "user": {"login": "qinyao-he", "id": 6523975, "node_id": "MDQ6VXNlcjY1MjM5NzU=", "avatar_url": "https://avatars2.githubusercontent.com/u/6523975?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qinyao-he", "html_url": "https://github.com/qinyao-he", "followers_url": "https://api.github.com/users/qinyao-he/followers", "following_url": "https://api.github.com/users/qinyao-he/following{/other_user}", "gists_url": "https://api.github.com/users/qinyao-he/gists{/gist_id}", "starred_url": "https://api.github.com/users/qinyao-he/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qinyao-he/subscriptions", "organizations_url": "https://api.github.com/users/qinyao-he/orgs", "repos_url": "https://api.github.com/users/qinyao-he/repos", "events_url": "https://api.github.com/users/qinyao-he/events{/privacy}", "received_events_url": "https://api.github.com/users/qinyao-he/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "shivaniag", "id": 16565716, "node_id": "MDQ6VXNlcjE2NTY1NzE2", "avatar_url": "https://avatars1.githubusercontent.com/u/16565716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shivaniag", "html_url": "https://github.com/shivaniag", "followers_url": "https://api.github.com/users/shivaniag/followers", "following_url": "https://api.github.com/users/shivaniag/following{/other_user}", "gists_url": "https://api.github.com/users/shivaniag/gists{/gist_id}", "starred_url": "https://api.github.com/users/shivaniag/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shivaniag/subscriptions", "organizations_url": "https://api.github.com/users/shivaniag/orgs", "repos_url": "https://api.github.com/users/shivaniag/repos", "events_url": "https://api.github.com/users/shivaniag/events{/privacy}", "received_events_url": "https://api.github.com/users/shivaniag/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "shivaniag", "id": 16565716, "node_id": "MDQ6VXNlcjE2NTY1NzE2", "avatar_url": "https://avatars1.githubusercontent.com/u/16565716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shivaniag", "html_url": "https://github.com/shivaniag", "followers_url": "https://api.github.com/users/shivaniag/followers", "following_url": "https://api.github.com/users/shivaniag/following{/other_user}", "gists_url": "https://api.github.com/users/shivaniag/gists{/gist_id}", "starred_url": "https://api.github.com/users/shivaniag/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shivaniag/subscriptions", "organizations_url": "https://api.github.com/users/shivaniag/orgs", "repos_url": "https://api.github.com/users/shivaniag/repos", "events_url": "https://api.github.com/users/shivaniag/events{/privacy}", "received_events_url": "https://api.github.com/users/shivaniag/received_events", "type": "User", "site_admin": false}, {"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-08-31T21:59:32Z", "updated_at": "2018-12-20T18:49:17Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nNo\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\nUbuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**:\r\nsource\r\n- **TensorFlow version (use command below)**:\r\n('v1.9.0-rc2-3472-g61038f8', '1.10.0')\r\ngithub master commit: 61038f89e98fc430c56a9aa056692413c82eaafa\r\n\r\n- **Python version**:\r\n- **Bazel version (if compiling from source)**:\r\n0.16.1\r\n- **GCC/Compiler version (if compiling from source)**:\r\n5.4.0\r\n- **CUDA/cuDNN version**:\r\nCUDA 9.0 cuDNN 7.1.4\r\n- **GPU model and memory**:\r\nTitan V\r\n- **Exact command to reproduce**:\r\nI build TensorFlow from source with TensorRT 4.\r\n\r\nUse official TensorFlow-TensorRT example:\r\nhttps://github.com/tensorflow/models/tree/master/research/tensorrt\r\nand do INT8 test with command:\r\n\r\n> python tensorrt.py --frozen_graph=resnetv2_imagenet_frozen_graph.pb --image_file=image.jpg --int8 --output_dir=output\r\n\r\nNote that you should download ImageNet pretrained model http://download.tensorflow.org/models/official/resnetv2_imagenet_frozen_graph.pb\r\n\r\n### Describe the problem\r\nProgram core dumped when doing calibration step\r\n\r\n> INFO:tensorflow:Starting Warmup cycle\r\n> 2018-08-31 14:53:15.227087: I tensorflow/contrib/tensorrt/kernels/trt_engine_op.cc:577] Starting calibration thread on device 0, Calibration Resource @ 0x7f76f0001860                             \r\n> 2018-08-31 14:53:31.166463: I tensorflow/contrib/tensorrt/kernels/trt_engine_op.cc:577] Starting calibration thread on device 0, Calibration Resource @ 0x7f76f1709b00                             \r\n> python: helpers.cpp:56: nvinfer1::DimsCHW nvinfer1::getCHW(const nvinfer1::Dims&): Assertion `d.nbDims >= 3' failed.                                                                               \r\n> [1]    4880 abort (core dumped)  python tensorrt.py --frozen_graph=resnetv2_imagenet_frozen_graph.pb  --int8\r\n\r\nThis problem doesn't exist with tf 1.7 and 1.8.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21991", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21991/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21991/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21991/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21991", "id": 355948265, "node_id": "MDU6SXNzdWUzNTU5NDgyNjU=", "number": 21991, "title": "Strange behavior of loss function in WALSMatrixFactorization TF 1.8", "user": {"login": "NatLun091238", "id": 26412310, "node_id": "MDQ6VXNlcjI2NDEyMzEw", "avatar_url": "https://avatars0.githubusercontent.com/u/26412310?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NatLun091238", "html_url": "https://github.com/NatLun091238", "followers_url": "https://api.github.com/users/NatLun091238/followers", "following_url": "https://api.github.com/users/NatLun091238/following{/other_user}", "gists_url": "https://api.github.com/users/NatLun091238/gists{/gist_id}", "starred_url": "https://api.github.com/users/NatLun091238/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NatLun091238/subscriptions", "organizations_url": "https://api.github.com/users/NatLun091238/orgs", "repos_url": "https://api.github.com/users/NatLun091238/repos", "events_url": "https://api.github.com/users/NatLun091238/events{/privacy}", "received_events_url": "https://api.github.com/users/NatLun091238/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "walidk", "id": 734669, "node_id": "MDQ6VXNlcjczNDY2OQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/734669?v=4", "gravatar_id": "", "url": "https://api.github.com/users/walidk", "html_url": "https://github.com/walidk", "followers_url": "https://api.github.com/users/walidk/followers", "following_url": "https://api.github.com/users/walidk/following{/other_user}", "gists_url": "https://api.github.com/users/walidk/gists{/gist_id}", "starred_url": "https://api.github.com/users/walidk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/walidk/subscriptions", "organizations_url": "https://api.github.com/users/walidk/orgs", "repos_url": "https://api.github.com/users/walidk/repos", "events_url": "https://api.github.com/users/walidk/events{/privacy}", "received_events_url": "https://api.github.com/users/walidk/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "walidk", "id": 734669, "node_id": "MDQ6VXNlcjczNDY2OQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/734669?v=4", "gravatar_id": "", "url": "https://api.github.com/users/walidk", "html_url": "https://github.com/walidk", "followers_url": "https://api.github.com/users/walidk/followers", "following_url": "https://api.github.com/users/walidk/following{/other_user}", "gists_url": "https://api.github.com/users/walidk/gists{/gist_id}", "starred_url": "https://api.github.com/users/walidk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/walidk/subscriptions", "organizations_url": "https://api.github.com/users/walidk/orgs", "repos_url": "https://api.github.com/users/walidk/repos", "events_url": "https://api.github.com/users/walidk/events{/privacy}", "received_events_url": "https://api.github.com/users/walidk/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2018-08-31T11:44:33Z", "updated_at": "2018-12-08T18:40:36Z", "closed_at": null, "author_association": "NONE", "body": "Our current implementation of recommendation system use TF 1.8 and WALS algorithm. The model was trained using self.fit(input_fn=input_fn) and ML Engine with run time version 1.8. Data set was formed following [example](https://github.com/GoogleCloudPlatform/training-data-analyst/blob/master/courses/machine_learning/deepdive/10_recommend/wals.ipynb) using tensorflow.train.Example(...) Extraction from training logs shown below. \r\n\r\n[Extraction from training logs](https://drive.google.com/open?id=1HS4dPXC31Qv42YAWb_PT5y_C_uFD03GM) \r\n\r\nThe fit was performed with some default parameters. The loss value did decreased on second evaluation. However loss did not changed after that. The final Root weighted squared error (rwse) in this training became 0.126.\r\n\r\nHyperparameter tuning was performed later and the best parameter set was used in the following training. The result of that training is shown below.\r\n\r\n[Post hyperparameter tuning log extraction](https://drive.google.com/open?id=1zrt1jsfVdFAtuEegzquV-8sU8AJtlmKY)\r\n\r\nTree things to note here. First, the loss value at the beginning is lower than at later evaluation steps. Low value in the beginning most likely due to choice of parameters from the results of hyperparameter tuning. Increase of the loss value later on looks strange. Second, it\u2019s unchanged loss value after second evaluation. This pattern remains the same while self.fit(input_fn=input_fn) is used for model training. Third, the final rwse in this training became 0.487 while during hyperparameter tuning with the same parameter set rwse=0.015. \r\n\r\nThe question is if anyone observed something similar? Could the reason of unchanged loss value be due to fixed learning rate? If yes, is it possible to change it while using WALSMatrixFactorization class and self.fit(input_fn=input_fn)??\r\n\r\n------------------------\r\n\r\n### System information\r\n\r\n- GCP VM instance  created-with-datalab-version\t20180503\r\n\r\n- TensorFlow version 1.8.0\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21983", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21983/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21983/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21983/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21983", "id": 355810460, "node_id": "MDU6SXNzdWUzNTU4MTA0NjA=", "number": 21983, "title": "Keras models converted to Estimators do not write summaries.", "user": {"login": "zmjjmz", "id": 1694612, "node_id": "MDQ6VXNlcjE2OTQ2MTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1694612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zmjjmz", "html_url": "https://github.com/zmjjmz", "followers_url": "https://api.github.com/users/zmjjmz/followers", "following_url": "https://api.github.com/users/zmjjmz/following{/other_user}", "gists_url": "https://api.github.com/users/zmjjmz/gists{/gist_id}", "starred_url": "https://api.github.com/users/zmjjmz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zmjjmz/subscriptions", "organizations_url": "https://api.github.com/users/zmjjmz/orgs", "repos_url": "https://api.github.com/users/zmjjmz/repos", "events_url": "https://api.github.com/users/zmjjmz/events{/privacy}", "received_events_url": "https://api.github.com/users/zmjjmz/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "karmel", "id": 667809, "node_id": "MDQ6VXNlcjY2NzgwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karmel", "html_url": "https://github.com/karmel", "followers_url": "https://api.github.com/users/karmel/followers", "following_url": "https://api.github.com/users/karmel/following{/other_user}", "gists_url": "https://api.github.com/users/karmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/karmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karmel/subscriptions", "organizations_url": "https://api.github.com/users/karmel/orgs", "repos_url": "https://api.github.com/users/karmel/repos", "events_url": "https://api.github.com/users/karmel/events{/privacy}", "received_events_url": "https://api.github.com/users/karmel/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "karmel", "id": 667809, "node_id": "MDQ6VXNlcjY2NzgwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karmel", "html_url": "https://github.com/karmel", "followers_url": "https://api.github.com/users/karmel/followers", "following_url": "https://api.github.com/users/karmel/following{/other_user}", "gists_url": "https://api.github.com/users/karmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/karmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karmel/subscriptions", "organizations_url": "https://api.github.com/users/karmel/orgs", "repos_url": "https://api.github.com/users/karmel/repos", "events_url": "https://api.github.com/users/karmel/events{/privacy}", "received_events_url": "https://api.github.com/users/karmel/received_events", "type": "User", "site_admin": false}, {"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 17, "created_at": "2018-08-31T01:42:37Z", "updated_at": "2019-10-30T10:54:30Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Debian Jessie\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: n/a\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: ('v1.9.0-0-g25c197e023', '1.9.0') \r\n- **Python version**: 2.7.9\r\n- **Bazel version (if compiling from source)**: n/a\r\n- **GCC/Compiler version (if compiling from source)**: n/a\r\n- **CUDA/cuDNN version**: n/a\r\n- **GPU model and memory**: n/a\r\n- **Exact command to reproduce**: See provided gist\r\n\r\n### Describe the problem\r\nI've been setting up Estimators by using Keras layers to define tensors and then feeding them into my own `model_fn`. This was a pain and prevented me from easily doing stuff like adding regularization, but was necessary until recently due to various bugs within `model_to_estimator`. Luckily those bugs have been fixed, and I can now use the much more canonical and proper `model_to_estimator`. Unfortunately there are still some holes...\r\n\r\nAnyways, when I did this I would, in defining the model, set various summaries to be collected simply by calling `tf.summary.scalar` etc. as documented. However, when I take the same tensors and put them through a Keras model and then through `model_to_estimator`, the summaries I've defined do not get \r\nwritten.\r\n\r\nI've tried a few things here, but largely haven't met with any success. One of the workarounds [I've seen suggested](https://groups.google.com/forum/#!topic/keras-users/rEJ1xYqD3AM) is to try and shove the result of `tf.summary.merge_all` into a `metric`, but this does not work since Keras wants those to be numeric and summaries are strings. This does not work if I put this in as `target_tensors` either, as commented out in the gist.\r\n\r\nNote: I recognize that this is filed against TF 1.9, but I don't see anything in the 1.10 changelog to indicate that this was noted or fixed. I am in a weird situation where it is best for me to use 1.9, unfortunately.\r\n\r\n### Source code / logs\r\nThe [gist](https://gist.github.com/zmjjmz/75ba919d5f2755738252b4d0b0032faa) here reproduces this issue by taking a common function to get the tensors for a model, and creating estimators in both scenarios. \r\n\r\nBelow is the first event with a summary from each case. It shows that in the 'plain' case, the summary tag `class_norm` shows up whereas in the `keras` case it does not. This is the crux of the issue I'm encountering.\r\n\r\nPlain case:\r\n`{'value': [{'simple_value': 1.0, 'tag': u'enqueue_input/queue/enqueue_input/random_shuffle_queuefraction_over_250_of_750_full'}, {'simple_value': 4.119956016540527, 'tag': u'class_norm'}, {'simple_value': 0.6801050901412964, 'tag': u'loss'}]}`\r\nKeras case:\r\n`{'value': [{'simple_value': 1.0, 'tag': u'enqueue_input/queue/enqueue_input/random_shuffle_queuefraction_over_250_of_750_full'}, {'simple_value': 0.8805878758430481, 'tag': u'loss_1'}]}`\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21979", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21979/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21979/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21979/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21979", "id": 355720085, "node_id": "MDU6SXNzdWUzNTU3MjAwODU=", "number": 21979, "title": "[Feature Request] Keeping Keras Callback functionality in Estimators created from `keras.model_to_estimator`", "user": {"login": "zmjjmz", "id": 1694612, "node_id": "MDQ6VXNlcjE2OTQ2MTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1694612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zmjjmz", "html_url": "https://github.com/zmjjmz", "followers_url": "https://api.github.com/users/zmjjmz/followers", "following_url": "https://api.github.com/users/zmjjmz/following{/other_user}", "gists_url": "https://api.github.com/users/zmjjmz/gists{/gist_id}", "starred_url": "https://api.github.com/users/zmjjmz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zmjjmz/subscriptions", "organizations_url": "https://api.github.com/users/zmjjmz/orgs", "repos_url": "https://api.github.com/users/zmjjmz/repos", "events_url": "https://api.github.com/users/zmjjmz/events{/privacy}", "received_events_url": "https://api.github.com/users/zmjjmz/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-08-30T19:20:26Z", "updated_at": "2020-02-05T11:20:05Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: n/a\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: n/a\r\n- **TensorFlow installed from (source or binary)**: n/a\r\n- **TensorFlow version (use command below)**: 1.9\r\n- **Python version**: 2.7\r\n- **Bazel version (if compiling from source)**: n/a\r\n- **GCC/Compiler version (if compiling from source)**: n/a\r\n- **CUDA/cuDNN version**: n/a\r\n- **GPU model and memory**: n/a\r\n- **Exact command to reproduce**: n/a\r\n\r\n### Describe the problem\r\n\r\nCurrently if I want to define a model in Keras and train it in a distributed fashion, the easiest/most-apparent method is to convert it into an Estimator using [model_to_estimator](https://www.tensorflow.org/api_docs/python/tf/keras/estimator/model_to_estimator). Unfortunately this has a few issues, and one of them is that any [Keras Callbacks](https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/Callback) go unpreserved.\r\n\r\nTheoretically these callbacks could be converted into some form of [`SessionRunHook`](https://www.tensorflow.org/api_docs/python/tf/train/SessionRunHook) although the SessionRunHook doesn't know things that the Callback does (e.g. epoch information). However, this does not happen at all -- the `EstimatorSpec` that's returned out of the `model_fn` from `_create_keras_model_fn` [does not specify any sort of `training_hooks`](https://github.com/tensorflow/tensorflow/blob/r1.9/tensorflow/python/estimator/keras.py#L400) regardless of whether or not the Keras model has Callbacks defined.\r\n\r\nI'm sure this is a non-trivial problem to solve, however it is frustrating that `model_to_estimator` causes a loss in functionality like this.\r\n\r\nAre there any plans to remedy this going forward?\r\n\r\nThanks!"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21946", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21946/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21946/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21946/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21946", "id": 355144906, "node_id": "MDU6SXNzdWUzNTUxNDQ5MDY=", "number": 21946, "title": "[feature request] specify subgraphs to route to TensorRT in tf.contrib.tensorrt", "user": {"login": "fferroni", "id": 16327442, "node_id": "MDQ6VXNlcjE2MzI3NDQy", "avatar_url": "https://avatars1.githubusercontent.com/u/16327442?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fferroni", "html_url": "https://github.com/fferroni", "followers_url": "https://api.github.com/users/fferroni/followers", "following_url": "https://api.github.com/users/fferroni/following{/other_user}", "gists_url": "https://api.github.com/users/fferroni/gists{/gist_id}", "starred_url": "https://api.github.com/users/fferroni/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fferroni/subscriptions", "organizations_url": "https://api.github.com/users/fferroni/orgs", "repos_url": "https://api.github.com/users/fferroni/repos", "events_url": "https://api.github.com/users/fferroni/events{/privacy}", "received_events_url": "https://api.github.com/users/fferroni/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-08-29T12:50:01Z", "updated_at": "2018-12-12T18:48:14Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**: Source\r\n- **TensorFlow version (use command below)**: 1.10.1\r\n- **Python version**: 3.5\r\n- **Bazel version (if compiling from source)**: 0.15.1\r\n- **GCC/Compiler version (if compiling from source)**: 5\r\n- **CUDA/cuDNN version**: 9.0, 7.0\r\n- **GPU model and memory**: \r\n- **Exact command to reproduce**:\r\n\r\n### Describe the problem\r\nBased on the examples provided in tf.contrib.tensorrt as well as on the internet, it seems that the following:\r\n```\r\nimport tensorflow.contrib.tensorrt as trt\r\nwith gfile.FastGFile(protobuf_file, 'rb') as f:\r\n    graph_def = tf.GraphDef()\r\n    graph_def.ParseFromString(f.read())\r\n    trt_graph = trt.create_inference_graph(graph_def, trt_nodes,\r\n                                           max_batch_size=batch_size,\r\n                                           max_workspace_size_bytes=memory_allocation,\r\n                                           minimum_segment_size=minimum_segment_size,\r\n                                           precision_mode=\"FP32\")  # Get optimized graph\r\n```\r\nis enough to make the parts that are recognized by TensorRT into trt_ops. The only control you have of what to send to TensorRT within the graph is \"minimum_segment_size\" which excludes sections of the graph below this number of compatible ops.\r\nHowever, it would be helpful to be able to define sections (either explicit ops, or input/output pairs in the subgraph).\r\nFor example, at the moment, I am struggling to convert into a hybrid TF/TRT graph a Fast-RCNN architecture. TensorRT will convert for example all convolution operations, however the encoder part will have convolutions with a batch size equal to the number of images provided, while the proposal classification part of the network will have convolutions with batch size equal to the number of proposals. I have everything as a single Tensorflow graph with dynamic batch for the 2nd stage, however TensorRT expects a max batch size. If I set the max batch size to the max number of proposals, I run out of memory since it will also assign this max batch to the encoder part.\r\nAt the moment I've set the minimum_segment_size high enough for TensorRT to ignore the proposal part of the network and convert only the encoder. However, it would be helpful to be convert both sections, and leave the unsupported operations (like `tf.image.crop_and_resize`, or `tf.image.non_max_suppression` in Tensorflow).\r\nAny advice? Thanks\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21935", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21935/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21935/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21935/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21935", "id": 354948481, "node_id": "MDU6SXNzdWUzNTQ5NDg0ODE=", "number": 21935, "title": "import tensorflow.contrib fails on arm32", "user": {"login": "hododoy", "id": 18301645, "node_id": "MDQ6VXNlcjE4MzAxNjQ1", "avatar_url": "https://avatars3.githubusercontent.com/u/18301645?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hododoy", "html_url": "https://github.com/hododoy", "followers_url": "https://api.github.com/users/hododoy/followers", "following_url": "https://api.github.com/users/hododoy/following{/other_user}", "gists_url": "https://api.github.com/users/hododoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/hododoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hododoy/subscriptions", "organizations_url": "https://api.github.com/users/hododoy/orgs", "repos_url": "https://api.github.com/users/hododoy/repos", "events_url": "https://api.github.com/users/hododoy/events{/privacy}", "received_events_url": "https://api.github.com/users/hododoy/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "cy89", "id": 29663194, "node_id": "MDQ6VXNlcjI5NjYzMTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/29663194?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cy89", "html_url": "https://github.com/cy89", "followers_url": "https://api.github.com/users/cy89/followers", "following_url": "https://api.github.com/users/cy89/following{/other_user}", "gists_url": "https://api.github.com/users/cy89/gists{/gist_id}", "starred_url": "https://api.github.com/users/cy89/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cy89/subscriptions", "organizations_url": "https://api.github.com/users/cy89/orgs", "repos_url": "https://api.github.com/users/cy89/repos", "events_url": "https://api.github.com/users/cy89/events{/privacy}", "received_events_url": "https://api.github.com/users/cy89/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "cy89", "id": 29663194, "node_id": "MDQ6VXNlcjI5NjYzMTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/29663194?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cy89", "html_url": "https://github.com/cy89", "followers_url": "https://api.github.com/users/cy89/followers", "following_url": "https://api.github.com/users/cy89/following{/other_user}", "gists_url": "https://api.github.com/users/cy89/gists{/gist_id}", "starred_url": "https://api.github.com/users/cy89/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cy89/subscriptions", "organizations_url": "https://api.github.com/users/cy89/orgs", "repos_url": "https://api.github.com/users/cy89/repos", "events_url": "https://api.github.com/users/cy89/events{/privacy}", "received_events_url": "https://api.github.com/users/cy89/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-08-29T00:11:45Z", "updated_at": "2018-12-14T18:59:27Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No. running \"tensorflow/examples/learn/resnet.py\"\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: custom embedded linux\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: Yes, rpi class device\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: 1.10.1 / 4dcfddc5d12018a5a0fdca652b9221ed95e9eb23\r\n- **Python version**: 2.7.15\r\n- **Bazel version (if compiling from source)**:  0.16.0\r\n- **GCC/Compiler version (if compiling from source)**: gcc 6.3\r\n- **CUDA/cuDNN version**: None\r\n- **GPU model and memory**: None\r\n- **Exact command to reproduce**: \"import tensorflow.contrib\"\r\n\r\n### Describe the problem\r\nI am cross-compiling tensorflow to work on a 32-bit armhf system. My build system is x86-64. sample apps seem to work ok. but I am having difficulty in the python environment. \"import tensorflow\" works ok. But \"import tensorflow.contrib\" fails with this error:\r\n\r\n```\r\n>>> import tensorflow.contrib\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/mnt/nfs/baseline/obj.32/target/usr/local/lib/python2.7/site-packages/tensorflow/contrib/__init__.py\", line 69, in <module>\r\n    from tensorflow.contrib import periodic_resample\r\n  File \"/mnt/nfs/baseline/obj.32/target/usr/local/lib/python2.7/site-packages/tensorflow/contrib/periodic_resample/__init__.py\", line 22, in <module>\r\n    from tensorflow.contrib.periodic_resample.python.ops.periodic_resample_op import periodic_resample\r\n  File \"/mnt/nfs/baseline/obj.32/target/usr/local/lib/python2.7/site-packages/tensorflow/contrib/periodic_resample/python/ops/periodic_resample_op.py\", line 32, in <module>\r\n    resource_loader.get_path_to_datafile('_periodic_resample_op.so'))\r\n  File \"/mnt/nfs/baseline/obj.32/target/usr/local/lib/python2.7/site-packages/tensorflow/contrib/util/loader.py\", line 56, in load_op_library\r\n    ret = load_library.load_op_library(path)\r\n  File \"/mnt/nfs/baseline/obj.32/target/usr/local/lib/python2.7/site-packages/tensorflow/python/framework/load_library.py\", line 73, in load_op_library\r\n    exec(wrappers, module.__dict__)\r\n  File \"<string>\", line 293, in <module>\r\n  File \"<string>\", line 229, in _InitOpDefLibrary\r\n  File \"/mnt/nfs/baseline/obj.32/target/usr/local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_registry.py\", line 35, in register_op_list\r\n    assert _registered_ops[op_def.name] == op_def\r\nAssertionError\r\n```\r\n\r\nI have tried combinations of bazel 0.12/0.16, tensorflow 1.8/1.10 and python 2.7.10/2.7.15. I get the same result every time. Issue seems to be related to only PeriodicResample & PeriodicResampleOpGrad. Other modules do not assert.\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21925", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21925/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21925/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21925/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21925", "id": 354760712, "node_id": "MDU6SXNzdWUzNTQ3NjA3MTI=", "number": 21925, "title": "tf.scatter_update gradients silently failing in eager mode", "user": {"login": "francisr", "id": 2079844, "node_id": "MDQ6VXNlcjIwNzk4NDQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/2079844?v=4", "gravatar_id": "", "url": "https://api.github.com/users/francisr", "html_url": "https://github.com/francisr", "followers_url": "https://api.github.com/users/francisr/followers", "following_url": "https://api.github.com/users/francisr/following{/other_user}", "gists_url": "https://api.github.com/users/francisr/gists{/gist_id}", "starred_url": "https://api.github.com/users/francisr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/francisr/subscriptions", "organizations_url": "https://api.github.com/users/francisr/orgs", "repos_url": "https://api.github.com/users/francisr/repos", "events_url": "https://api.github.com/users/francisr/events{/privacy}", "received_events_url": "https://api.github.com/users/francisr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "tatatodd", "id": 5453737, "node_id": "MDQ6VXNlcjU0NTM3Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5453737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatatodd", "html_url": "https://github.com/tatatodd", "followers_url": "https://api.github.com/users/tatatodd/followers", "following_url": "https://api.github.com/users/tatatodd/following{/other_user}", "gists_url": "https://api.github.com/users/tatatodd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatatodd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatatodd/subscriptions", "organizations_url": "https://api.github.com/users/tatatodd/orgs", "repos_url": "https://api.github.com/users/tatatodd/repos", "events_url": "https://api.github.com/users/tatatodd/events{/privacy}", "received_events_url": "https://api.github.com/users/tatatodd/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tatatodd", "id": 5453737, "node_id": "MDQ6VXNlcjU0NTM3Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5453737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatatodd", "html_url": "https://github.com/tatatodd", "followers_url": "https://api.github.com/users/tatatodd/followers", "following_url": "https://api.github.com/users/tatatodd/following{/other_user}", "gists_url": "https://api.github.com/users/tatatodd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatatodd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatatodd/subscriptions", "organizations_url": "https://api.github.com/users/tatatodd/orgs", "repos_url": "https://api.github.com/users/tatatodd/repos", "events_url": "https://api.github.com/users/tatatodd/events{/privacy}", "received_events_url": "https://api.github.com/users/tatatodd/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-08-28T14:35:23Z", "updated_at": "2018-12-08T18:40:32Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**: Source\r\n- **TensorFlow version (use command below)**: 1.10\r\n- **Python version**: 3.5\r\n- **Bazel version (if compiling from source)**: 0.16.0\r\n- **GCC/Compiler version (if compiling from source)**: 5.4.0\r\n- **CUDA/cuDNN version**: 8.0/6.0\r\n- **GPU model and memory**: GTX 980 4GB\r\n- **Exact command to reproduce**:\r\n\r\n### Describe the problem\r\nWhen I use `tf.scatter_update` in `eager` mode, I get `None` gradients for variables that are involved in the update (not for the updated variable).   \r\nThe same code in graph mode produces an error.   \r\nThe behaviour I expect is either for the gradients to be properly computed (not sure why tensorflow can't do this), or to give the same kind of error as in graph mode.\r\n\r\n### Source code / logs\r\n```\r\nfrom __future__ import print_function\r\nimport tensorflow as tf\r\ntf.enable_eager_execution()\r\n\r\nv = tf.Variable(13.0)\r\nalpha = tf.Variable([1, 2, 3], dtype=tf.float32)\r\nidx = 1\r\nwith tf.GradientTape() as tape:\r\n    alpha = tf.scatter_update(alpha, idx, v)\r\n    loss = tf.reduce_sum(tf.square(alpha))\r\ngrads = tape.gradient(loss, [v, alpha])\r\nprint(grads)\r\n```\r\nThe output of `print(grads)` is `[None, <tf.Tensor: id=31, shape=(3,), dtype=float32, numpy=array([ 2., 26.,  6.], dtype=float32)>]`, so the gradient is not computed for `v`.\r\n\r\nIn graph mode\r\n```\r\nfrom __future__ import print_function\r\nimport tensorflow as tf\r\n\r\nv = tf.Variable(13.0)\r\nalpha = tf.Variable([1, 2, 3], dtype=tf.float32)\r\nidx = 1\r\nalpha = tf.scatter_update(alpha, idx, v)\r\nloss = tf.reduce_sum(tf.square(alpha))\r\ngrads = tf.gradients(loss, [v, alpha])\r\nprint(grads)\r\n\r\n```\r\nThe error I get: `LookupError: No gradient defined for operation 'ScatterUpdate' (op type: ScatterUpdate)`"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21923", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21923/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21923/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21923/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21923", "id": 354726189, "node_id": "MDU6SXNzdWUzNTQ3MjYxODk=", "number": 21923, "title": "\u00c0 trous 1D convolution slow in certain scenarios ", "user": {"login": "zbitouzakaria", "id": 12535244, "node_id": "MDQ6VXNlcjEyNTM1MjQ0", "avatar_url": "https://avatars0.githubusercontent.com/u/12535244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zbitouzakaria", "html_url": "https://github.com/zbitouzakaria", "followers_url": "https://api.github.com/users/zbitouzakaria/followers", "following_url": "https://api.github.com/users/zbitouzakaria/following{/other_user}", "gists_url": "https://api.github.com/users/zbitouzakaria/gists{/gist_id}", "starred_url": "https://api.github.com/users/zbitouzakaria/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zbitouzakaria/subscriptions", "organizations_url": "https://api.github.com/users/zbitouzakaria/orgs", "repos_url": "https://api.github.com/users/zbitouzakaria/repos", "events_url": "https://api.github.com/users/zbitouzakaria/events{/privacy}", "received_events_url": "https://api.github.com/users/zbitouzakaria/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "skye", "id": 88808, "node_id": "MDQ6VXNlcjg4ODA4", "avatar_url": "https://avatars1.githubusercontent.com/u/88808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skye", "html_url": "https://github.com/skye", "followers_url": "https://api.github.com/users/skye/followers", "following_url": "https://api.github.com/users/skye/following{/other_user}", "gists_url": "https://api.github.com/users/skye/gists{/gist_id}", "starred_url": "https://api.github.com/users/skye/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skye/subscriptions", "organizations_url": "https://api.github.com/users/skye/orgs", "repos_url": "https://api.github.com/users/skye/repos", "events_url": "https://api.github.com/users/skye/events{/privacy}", "received_events_url": "https://api.github.com/users/skye/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "skye", "id": 88808, "node_id": "MDQ6VXNlcjg4ODA4", "avatar_url": "https://avatars1.githubusercontent.com/u/88808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skye", "html_url": "https://github.com/skye", "followers_url": "https://api.github.com/users/skye/followers", "following_url": "https://api.github.com/users/skye/following{/other_user}", "gists_url": "https://api.github.com/users/skye/gists{/gist_id}", "starred_url": "https://api.github.com/users/skye/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skye/subscriptions", "organizations_url": "https://api.github.com/users/skye/orgs", "repos_url": "https://api.github.com/users/skye/repos", "events_url": "https://api.github.com/users/skye/events{/privacy}", "received_events_url": "https://api.github.com/users/skye/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-08-28T13:15:35Z", "updated_at": "2018-12-08T18:40:27Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16.04\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: 1.10.1\r\n- **Python version**: 3.5.2\r\n- **CUDA/cuDNN version**: 9.0.176\r\n- **GPU model and memory**: CPU\r\n- **Exact command to reproduce**: See below\r\n- **Bazel version**: N/A\r\n- **Mobile device**: N/A\r\n\r\n### Describe the problem\r\nRunning\r\n\r\n``\r\ntf.nn.atrous_conv2d(images, filters, rate=dilation_rate, padding=\"SAME\")\r\n``\r\n\r\nand\r\n\r\n``\r\ntf.nn.convolution(images, filters, dilation_rate=[dilation_rate, dilation_rate], padding=\"SAME\")\r\n``\r\n\r\ntakes much more time to run than:\r\n\r\n``\r\ntf.nn.convolution(images, filters, dilation_rate=[1, dilation_rate], padding=\"SAME\")\r\n``\r\n\r\nfor `1D` convolutions.\r\n\r\nI don't think this is supposed to behave like this, provided that the input data is one dimensional along the width or the height (i.e. ``shape = [batch, 1, width, channels] or [batch, height, 1, channels]``) since in this case, no dilation is needed on the corresponding axis.\r\n\r\nA person using `tf.nn.atrous_conv2d` for `1D` \"\u00e0 trous\" convolutions might never notice the issue here, and his network will be really slow to train.\r\n\r\n### Source code / logs\r\nA small snippet to compare the performance of the different methods\r\n\r\n```python\r\nimport tensorflow as tf\r\nimport numpy as np\r\nimport time\r\n\r\n# Scenario\r\nbatch_size = 100\r\nchannels = 3\r\no_channels = 10\r\nimage_size = 160\r\nfilter_size = 3\r\n\r\n# Dummy images and filters\r\nimages = tf.random_normal(shape=[batch_size, 1, image_size, channels],  dtype=tf.float32)\r\nfilters = tf.random_normal(shape=[1, filter_size, channels, o_channels], dtype=tf.float32)\r\n\r\n# Ops definition\r\nnormal_conv = tf.nn.convolution(images, filters, padding=\"SAME\")\r\natrous_convs = []\r\natrous_convs_wrapper = []\r\nfor i in [5, 10, 20, 50]:\r\n    atrous_convs.append({\"dilation\": i, \"op\": tf.nn.convolution(images, filters, dilation_rate=[1, i], padding=\"SAME\")})\r\n    atrous_convs_wrapper.append({\"dilation\": i, \"op\": tf.nn.convolution(images, filters, dilation_rate=[i, i], padding=\"SAME\")})\r\n    # Or\r\n    # atrous_convs_wrapper.append({\"dilation\": i, \"op\": tf.nn.atrous_conv2d(images, filters, rate=i, padding=\"SAME\")})\r\n# Test\r\nwith tf.Session() as sess:\r\n    repeats = 50\r\n    \r\n    for conv in atrous_convs:\r\n        op1 = conv[\"op\"]\r\n        op2 = [elt for elt in atrous_convs_wrapper if elt[\"dilation\"] == conv[\"dilation\"]][0][\"op\"]\r\n        op1_res, op2_res = sess.run([op1, op2])\r\n        np.testing.assert_equal(op1_res, op2_res)\r\n    \r\n    # Benchmark normal method\r\n    start = time.time()\r\n    for _ in range(repeats):\r\n        _ = sess.run(normal_conv)\r\n    end = time.time()\r\n    normal_conv_time = int((end - start) / repeats * 1000)\r\n\r\n    # Benchmark atrous conv method\r\n    for conv in atrous_convs:\r\n        start = time.time()\r\n        for _ in range(repeats):\r\n            _ = sess.run(conv[\"op\"])\r\n        end = time.time()\r\n        conv.update({\"time\": int((end - start) / repeats * 1000)})\r\n    \r\n    for conv in atrous_convs_wrapper:\r\n        start = time.time()\r\n        for _ in range(repeats):\r\n            _ = sess.run(conv[\"op\"])\r\n        end = time.time()\r\n        conv.update({\"time\": int((end - start) / repeats * 1000)})\r\n\r\n    print(\"Normal conv: {}ms\".format(normal_conv_time))\r\n    for conv in atrous_convs:\r\n        print(\"Atrous conv w/ dilation {}: {}ms\".format(conv[\"dilation\"], conv[\"time\"]))\r\n    for conv in atrous_convs_wrapper:\r\n        print(\"Atrous conv(wrapper) w/ dilation {}: {}ms\".format(conv[\"dilation\"], conv[\"time\"]))\r\n\r\n```\r\n\r\nreturns\r\n\r\n```\r\nNormal conv: 1ms\r\nAtrous conv w/ dilation 5: 1ms\r\nAtrous conv w/ dilation 10: 2ms\r\nAtrous conv w/ dilation 20: 1ms\r\nAtrous conv w/ dilation 50: 2ms\r\nAtrous conv(wrapper) w/ dilation 5: 4ms\r\nAtrous conv(wrapper) w/ dilation 10: 9ms\r\nAtrous conv(wrapper) w/ dilation 20: 15ms\r\nAtrous conv(wrapper) w/ dilation 50: 47ms\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21922", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21922/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21922/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21922/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21922", "id": 354711633, "node_id": "MDU6SXNzdWUzNTQ3MTE2MzM=", "number": 21922, "title": "TF_GraphImportGraphDef fails with no input mapping on existing nodes", "user": {"login": "gil-cohen", "id": 34191292, "node_id": "MDQ6VXNlcjM0MTkxMjky", "avatar_url": "https://avatars0.githubusercontent.com/u/34191292?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gil-cohen", "html_url": "https://github.com/gil-cohen", "followers_url": "https://api.github.com/users/gil-cohen/followers", "following_url": "https://api.github.com/users/gil-cohen/following{/other_user}", "gists_url": "https://api.github.com/users/gil-cohen/gists{/gist_id}", "starred_url": "https://api.github.com/users/gil-cohen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gil-cohen/subscriptions", "organizations_url": "https://api.github.com/users/gil-cohen/orgs", "repos_url": "https://api.github.com/users/gil-cohen/repos", "events_url": "https://api.github.com/users/gil-cohen/events{/privacy}", "received_events_url": "https://api.github.com/users/gil-cohen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "skye", "id": 88808, "node_id": "MDQ6VXNlcjg4ODA4", "avatar_url": "https://avatars1.githubusercontent.com/u/88808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skye", "html_url": "https://github.com/skye", "followers_url": "https://api.github.com/users/skye/followers", "following_url": "https://api.github.com/users/skye/following{/other_user}", "gists_url": "https://api.github.com/users/skye/gists{/gist_id}", "starred_url": "https://api.github.com/users/skye/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skye/subscriptions", "organizations_url": "https://api.github.com/users/skye/orgs", "repos_url": "https://api.github.com/users/skye/repos", "events_url": "https://api.github.com/users/skye/events{/privacy}", "received_events_url": "https://api.github.com/users/skye/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "skye", "id": 88808, "node_id": "MDQ6VXNlcjg4ODA4", "avatar_url": "https://avatars1.githubusercontent.com/u/88808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skye", "html_url": "https://github.com/skye", "followers_url": "https://api.github.com/users/skye/followers", "following_url": "https://api.github.com/users/skye/following{/other_user}", "gists_url": "https://api.github.com/users/skye/gists{/gist_id}", "starred_url": "https://api.github.com/users/skye/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skye/subscriptions", "organizations_url": "https://api.github.com/users/skye/orgs", "repos_url": "https://api.github.com/users/skye/repos", "events_url": "https://api.github.com/users/skye/events{/privacy}", "received_events_url": "https://api.github.com/users/skye/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-08-28T12:37:06Z", "updated_at": "2018-12-14T18:59:18Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: linux, ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: N/A\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: 1.10\r\n- **Python version**:  3.5.2\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **GCC/Compiler version (if compiling from source)**: N/A\r\n- **CUDA/cuDNN version**: N/A\r\n- **GPU model and memory**: N/A\r\n- **Exact command to reproduce**: N/A\r\n\r\n\r\n### Describe the problem\r\n\r\nUsing `TF_GraphImportGraphDef` to incrementally build a graph (using NodeDefs instead of the extensive `TF_OperationDescription* ` API) returns a `TF_Status` error code (3) with message  **Unknown input node** when a node currently being imported has an input node who is  not in the current import call, but already in the graph.\r\n\r\n\r\n### Source code / logs\r\n\r\nI would assume that it would be okay to import a node whose inputs are already in the graph.\r\n\r\nIf this assumption is correct the problem arises from line 529 In [graph_constructor.cc](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/graph/graph_constructor.cc):\r\n\r\n```\r\nfor (int i = 0; i < node_def.input_size(); ++i) {\r\n      StringPiece input_name = node_def.input(i);\r\n      TensorId id(ParseTensorName(input_name));\r\n      if (opts_.input_map.count(id) == 0) {\r\n        // If an input is not mapped, then the input should appear in the graph\r\n        // being imported.\r\n        auto iter = gdef_nodes_.find(id.first);\r\n        if (iter == gdef_nodes_.end()) {\r\n          return errors::InvalidArgument(\"Node '\", node_def.name(),\r\n                                         \"': Unknown input node '\",\r\n                                         node_def.input(i), \"'\");\r\n        }\r\n        outputs_[iter->second.gdef_index].push_back(n);\r\n      } else {\r\n        // This input is mapped to an existing edge. Therefore this input is\r\n        // as good as being already processed.\r\n        --pending_count;\r\n        DCHECK_GE(pending_count, 0);\r\n      }\r\n    }\r\n```\r\n\r\nWhere if no mapping was supplied using `TF_ImportGraphDefOptionsAddInputMapping`, the validation check assumes the input nodes exist in the current import call, along side the node being imported itself, without bothering to check if the graph might already contain these nodes (which is the assumption when a mapping IS supplied).\r\n\r\nThis means that when importing a graph, unnecessary input mappings have to be supplied.\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21915", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21915/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21915/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21915/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21915", "id": 354521259, "node_id": "MDU6SXNzdWUzNTQ1MjEyNTk=", "number": 21915, "title": "Batch normalization implemented incorrectly in canned DNN estimators", "user": {"login": "lukmanr", "id": 1057193, "node_id": "MDQ6VXNlcjEwNTcxOTM=", "avatar_url": "https://avatars1.githubusercontent.com/u/1057193?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lukmanr", "html_url": "https://github.com/lukmanr", "followers_url": "https://api.github.com/users/lukmanr/followers", "following_url": "https://api.github.com/users/lukmanr/following{/other_user}", "gists_url": "https://api.github.com/users/lukmanr/gists{/gist_id}", "starred_url": "https://api.github.com/users/lukmanr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lukmanr/subscriptions", "organizations_url": "https://api.github.com/users/lukmanr/orgs", "repos_url": "https://api.github.com/users/lukmanr/repos", "events_url": "https://api.github.com/users/lukmanr/events{/privacy}", "received_events_url": "https://api.github.com/users/lukmanr/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "tatianashp", "id": 986732, "node_id": "MDQ6VXNlcjk4NjczMg==", "avatar_url": "https://avatars2.githubusercontent.com/u/986732?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatianashp", "html_url": "https://github.com/tatianashp", "followers_url": "https://api.github.com/users/tatianashp/followers", "following_url": "https://api.github.com/users/tatianashp/following{/other_user}", "gists_url": "https://api.github.com/users/tatianashp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatianashp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatianashp/subscriptions", "organizations_url": "https://api.github.com/users/tatianashp/orgs", "repos_url": "https://api.github.com/users/tatianashp/repos", "events_url": "https://api.github.com/users/tatianashp/events{/privacy}", "received_events_url": "https://api.github.com/users/tatianashp/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tatianashp", "id": 986732, "node_id": "MDQ6VXNlcjk4NjczMg==", "avatar_url": "https://avatars2.githubusercontent.com/u/986732?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatianashp", "html_url": "https://github.com/tatianashp", "followers_url": "https://api.github.com/users/tatianashp/followers", "following_url": "https://api.github.com/users/tatianashp/following{/other_user}", "gists_url": "https://api.github.com/users/tatianashp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatianashp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatianashp/subscriptions", "organizations_url": "https://api.github.com/users/tatianashp/orgs", "repos_url": "https://api.github.com/users/tatianashp/repos", "events_url": "https://api.github.com/users/tatianashp/events{/privacy}", "received_events_url": "https://api.github.com/users/tatianashp/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2018-08-28T00:04:36Z", "updated_at": "2018-12-19T18:48:47Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: all\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: 1.10\r\n- **Python version**: 3.6.2\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**:\r\n- **GPU model and memory**:\r\n- **Exact command to reproduce**:\r\n\r\n### Describe the problem\r\nBatch normalization is implemented incorrectly in canned DNN estimators.  In _dnn_logit_fn_builder, batch normalization is applied after the dense layer which includes the activation function.  But batch normalization should be applied to the inputs to a layer, prior to the activation function.  See the original paper by Ioffe, Szegedy: \" ... we focus on transforms that consist of an affine transformation followed by anelement-wise nonlinearity:\r\nz = g(Wu + b)\r\nwhere W and b are learned parameters of the model, and g(\u00b7) is the nonlinearity such as sigmoid or ReLU. ...  We add the BN transform immediately before the nonlinearity, by normalizing x = Wu+ b.\"\r\n\r\nAlso see the many published reference implementations of batch normalization.\r\n\r\nThe current implementation is not only incorrect but produces very poor results.  \r\n\r\n### Source code / logs\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21891", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21891/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21891/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21891/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21891", "id": 354283277, "node_id": "MDU6SXNzdWUzNTQyODMyNzc=", "number": 21891, "title": "Search in Embedding Projector using Japanese or Hindi text causes Cannot read property 'toString' of undefined", "user": {"login": "ToonTalk", "id": 2138696, "node_id": "MDQ6VXNlcjIxMzg2OTY=", "avatar_url": "https://avatars2.githubusercontent.com/u/2138696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ToonTalk", "html_url": "https://github.com/ToonTalk", "followers_url": "https://api.github.com/users/ToonTalk/followers", "following_url": "https://api.github.com/users/ToonTalk/following{/other_user}", "gists_url": "https://api.github.com/users/ToonTalk/gists{/gist_id}", "starred_url": "https://api.github.com/users/ToonTalk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ToonTalk/subscriptions", "organizations_url": "https://api.github.com/users/ToonTalk/orgs", "repos_url": "https://api.github.com/users/ToonTalk/repos", "events_url": "https://api.github.com/users/ToonTalk/events{/privacy}", "received_events_url": "https://api.github.com/users/ToonTalk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 284285184, "node_id": "MDU6TGFiZWwyODQyODUxODQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tensorboard", "name": "comp:tensorboard", "color": "0052cc", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "nfelt", "id": 710113, "node_id": "MDQ6VXNlcjcxMDExMw==", "avatar_url": "https://avatars0.githubusercontent.com/u/710113?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nfelt", "html_url": "https://github.com/nfelt", "followers_url": "https://api.github.com/users/nfelt/followers", "following_url": "https://api.github.com/users/nfelt/following{/other_user}", "gists_url": "https://api.github.com/users/nfelt/gists{/gist_id}", "starred_url": "https://api.github.com/users/nfelt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nfelt/subscriptions", "organizations_url": "https://api.github.com/users/nfelt/orgs", "repos_url": "https://api.github.com/users/nfelt/repos", "events_url": "https://api.github.com/users/nfelt/events{/privacy}", "received_events_url": "https://api.github.com/users/nfelt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nfelt", "id": 710113, "node_id": "MDQ6VXNlcjcxMDExMw==", "avatar_url": "https://avatars0.githubusercontent.com/u/710113?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nfelt", "html_url": "https://github.com/nfelt", "followers_url": "https://api.github.com/users/nfelt/followers", "following_url": "https://api.github.com/users/nfelt/following{/other_user}", "gists_url": "https://api.github.com/users/nfelt/gists{/gist_id}", "starred_url": "https://api.github.com/users/nfelt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nfelt/subscriptions", "organizations_url": "https://api.github.com/users/nfelt/orgs", "repos_url": "https://api.github.com/users/nfelt/repos", "events_url": "https://api.github.com/users/nfelt/events{/privacy}", "received_events_url": "https://api.github.com/users/nfelt/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-08-27T11:35:37Z", "updated_at": "2018-12-19T18:48:43Z", "closed_at": null, "author_association": "NONE", "body": "Please go to Stack Overflow for help and support:\r\n\r\nhttps://stackoverflow.com/questions/tagged/tensorflow\r\n\r\nIf you open a GitHub issue, here is our policy:\r\n\r\n1. It must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).\r\n2. The form below must be filled out.\r\n3. It shouldn't be a TensorBoard issue. Those go [here](https://github.com/tensorflow/tensorboard/issues).\r\n\r\n**Here's why we have that policy**: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.\r\n\r\n------------------------\r\n\r\n### System information\r\nVisiting http://projector.tensorflow.org/?config=https://ecraft2learn.github.io/ai/word-embeddings/hi/projector.json using Chrome 68\r\n\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**:\r\n- **TensorFlow version (use command below)**:\r\n- **Python version**:\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**:\r\n- **GPU model and memory**:\r\n- **Exact command to reproduce**:\r\n\r\nYou can collect some of this information using our environment capture script:\r\n\r\nhttps://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh\r\n\r\nYou can obtain the TensorFlow version with\r\n\r\npython -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"\r\n\r\n### Describe the problem\r\nAfter visiting http://projector.tensorflow.org/?config=https://ecraft2learn.github.io/ai/word-embeddings/hi/projector.json using Chrome 68 and then entering any Hindi text in the Search field the console shows\r\n\r\nUncaught TypeError: Cannot read property 'toString' of undefined\r\n    at b (?config=https://ecraft2learn.github.io/ai/word-embeddings/hi/projector.json:formatted:60928)\r\n    at ?config=https://ecraft2learn.github.io/ai/word-embeddings/hi/projector.json:formatted:61345\r\n    at Array.forEach (<anonymous>)\r\n    at a.query (?config=https://ecraft2learn.github.io/ai/word-embeddings/hi/projector.json:formatted:61344)\r\n    at ?config=https://ecraft2learn.github.io/ai/word-embeddings/hi/projector.json:formatted:66646\r\n    at ?config=https://ecraft2learn.github.io/ai/word-embeddings/hi/projector.json:formatted:66171\r\n    at Array.forEach (<anonymous>)\r\n    at HTMLElement.b.notifyInputChanged (?config=https://ecraft2learn.github.io/ai/word-embeddings/hi/projector.json:formatted:66170)\r\n    at HTMLElement.b.onTextChanged (?config=https://ecraft2learn.github.io/ai/word-embeddings/hi/projector.json:formatted:66185)\r\n    at HTMLElement.<anonymous> (?config=https://ecraft2learn.github.io/ai/word-embeddings/hi/projector.json:formatted:66151)\r\nb @ ?config=https://ecraft2learn.github.io/ai/word-embeddings/hi/projector.json:formatted:60928\r\n(anonymous) @ ?config=https://ecraft2learn.github.io/ai/word-embeddings/hi/projector.json:formatted:61345\r\na.query @ ?config=https://ecraft2learn.github.io/ai/word-embeddings/hi/projector.json:formatted:61344\r\n(anonymous) @ ?config=https://ecraft2learn.github.io/ai/word-embeddings/hi/projector.json:formatted:66646\r\n(anonymous) @ ?config=https://ecraft2learn.github.io/ai/word-embeddings/hi/projector.json:formatted:66171\r\nb.notifyInputChanged @ ?config=https://ecraft2learn.github.io/ai/word-embeddings/hi/projector.json:formatted:66170\r\nb.onTextChanged @ ?config=https://ecraft2learn.github.io/ai/word-embeddings/hi/projector.json:formatted:66185\r\n(anonymous) @ ?config=https://ecraft2learn.github.io/ai/word-embeddings/hi/projector.json:formatted:66151\r\n\r\n### Source code / logs\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21881", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21881/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21881/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21881/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21881", "id": 354080209, "node_id": "MDU6SXNzdWUzNTQwODAyMDk=", "number": 21881, "title": "Tensorflow nearly 2 times slower than Pytorch in training!", "user": {"login": "Coderx7", "id": 5382892, "node_id": "MDQ6VXNlcjUzODI4OTI=", "avatar_url": "https://avatars0.githubusercontent.com/u/5382892?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Coderx7", "html_url": "https://github.com/Coderx7", "followers_url": "https://api.github.com/users/Coderx7/followers", "following_url": "https://api.github.com/users/Coderx7/following{/other_user}", "gists_url": "https://api.github.com/users/Coderx7/gists{/gist_id}", "starred_url": "https://api.github.com/users/Coderx7/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Coderx7/subscriptions", "organizations_url": "https://api.github.com/users/Coderx7/orgs", "repos_url": "https://api.github.com/users/Coderx7/repos", "events_url": "https://api.github.com/users/Coderx7/events{/privacy}", "received_events_url": "https://api.github.com/users/Coderx7/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "tfboyd", "id": 23486130, "node_id": "MDQ6VXNlcjIzNDg2MTMw", "avatar_url": "https://avatars1.githubusercontent.com/u/23486130?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tfboyd", "html_url": "https://github.com/tfboyd", "followers_url": "https://api.github.com/users/tfboyd/followers", "following_url": "https://api.github.com/users/tfboyd/following{/other_user}", "gists_url": "https://api.github.com/users/tfboyd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tfboyd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tfboyd/subscriptions", "organizations_url": "https://api.github.com/users/tfboyd/orgs", "repos_url": "https://api.github.com/users/tfboyd/repos", "events_url": "https://api.github.com/users/tfboyd/events{/privacy}", "received_events_url": "https://api.github.com/users/tfboyd/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tfboyd", "id": 23486130, "node_id": "MDQ6VXNlcjIzNDg2MTMw", "avatar_url": "https://avatars1.githubusercontent.com/u/23486130?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tfboyd", "html_url": "https://github.com/tfboyd", "followers_url": "https://api.github.com/users/tfboyd/followers", "following_url": "https://api.github.com/users/tfboyd/following{/other_user}", "gists_url": "https://api.github.com/users/tfboyd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tfboyd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tfboyd/subscriptions", "organizations_url": "https://api.github.com/users/tfboyd/orgs", "repos_url": "https://api.github.com/users/tfboyd/repos", "events_url": "https://api.github.com/users/tfboyd/events{/privacy}", "received_events_url": "https://api.github.com/users/tfboyd/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 16, "created_at": "2018-08-26T09:26:46Z", "updated_at": "2019-03-13T01:55:55Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: -\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: 1.7.0 and 1.10.1\r\n- **Python version**: 3.6\r\n- **Bazel version (if compiling from source)**:-\r\n- **GCC/Compiler version (if compiling from source)**:-\r\n- **CUDA/cuDNN version**:9.0/7.0 and 7.1\r\n- **GPU model and memory**: GTX1080/8Gig\r\n- **Exact command to reproduce**:\r\n\r\n### Describe the problem\r\nI was trying to train the same network on both `Tensorflow` and `Pytorch` frameworks and noticed `Tensorflow` is nearly **2x slower** than `Pytorch`!  \r\nWhile each epoch in `Pytorch` takes roughly about **50** seconds, in `Tensorflow` it takes **90** seconds!     \r\nI initially tried Stackoverflow, but after seeing a similar issue (https://github.com/tensorflow/tensorflow/issues/7187)from around a year ago, which reported the same performance issues and ultimately got solved, I changed my mind and thought it should be a bug.  \r\nI uploaded the code snippets regarding Tensorflow (which are taken from [official TF model repository-resnet ][1] and changed to be used with the new architecture(nearly everything is intact except minor changes needed to use the new architecture (simpleNet, which is a very simple convolutional architecture)).  \r\nIt should be noted that, the points in the previous similar issue that solved the performance discrepancy are not valid in this one. since the code base is changed and has been updated according to the latest improvements in TF. \r\nThings such as not using feed_dict, or offloading the input on to the CPU instead of GPU and setting `TF_ENABLE_WINOGRAD_NONFUSED `flags are already addressed in the new example which is used for this case, however the performance issue still persists. \r\n\r\n### Source code / logs \r\n\r\nHere are the code snippets :     \r\n\r\n> [simple_model.py][2]   \r\n> [cifar10_main.py][3]      \r\n> [simplenet_run_loop.py][4]\r\n\r\nHere are the logs for Pytorch and tensorflow respectively :\r\n\r\n**Pytorch (v0.4)** :\r\n\r\n    ==>>[2018-08-19 00:00:26] [Epoch=000/450] [Need: 00:00:00] [learning_rate=0.100000] [Best : Accuracy=0.00, Error=100.00]\r\n      Epoch: [000][000/500]   Time 1.345 (1.345)   Data 0.089 (0.089)   Loss 4.8846 (4.8846)   Prec@1 0.000 (0.000)   Prec@5 4.000 (4.000)   [2018-08-19 00:00:28]\r\n      Epoch: [000][200/500]   Time 0.089 (0.096)   Data 0.000 (0.001)   Loss 4.0047 (4.3586)   Prec@1 6.000 (3.771)   Prec@5 28.000 (14.930)   [2018-08-19 00:00:46]\r\n      Epoch: [000][400/500]   Time 0.089 (0.093)   Data 0.000 (0.000)   Loss 3.9328 (4.1781)   Prec@1 9.000 (5.519)   Prec@5 26.000 (20.142)   [2018-08-19 00:01:04]\r\n      **Train** Prec@1 6.352 Prec@5 22.334 Error@1 93.648\r\n      **Test** Prec@1 8.520 Prec@5 31.600 Error@1 91.480\r\n    \r\n    ==>>[2018-08-19 00:01:17] [Epoch=001/450] [Need: 06:07:54] [learning_rate=0.100000] [Best : Accuracy=8.52, Error=91.48]\r\n      Epoch: [001][000/500]   Time 0.128 (0.128)   Data 0.086 (0.086)   Loss 3.7810 (3.7810)   Prec@1 9.000 (9.000)   Prec@5 34.000 (34.000)   [2018-08-19 00:01:17]\r\n      Epoch: [001][200/500]   Time 0.090 (0.090)   Data 0.000 (0.001)   Loss 3.5385 (3.7109)   Prec@1 18.000 (11.517)   Prec@5 39.000 (34.861)   [2018-08-19 00:01:35]\r\n      Epoch: [001][400/500]   Time 0.088 (0.090)   Data 0.000 (0.000)   Loss 3.6088 (3.6151)   Prec@1 11.000 (13.274)   Prec@5 34.000 (38.102)   [2018-08-19 00:01:54]\r\n      **Train** Prec@1 14.048 Prec@5 39.416 Error@1 85.952\r\n      **Test** Prec@1 19.110 Prec@5 45.950 Error@1 80.890\r\n    \r\n    ==>>[2018-08-19 00:02:07] [Epoch=002/450] [Need: 06:10:38] [learning_rate=0.100000] [Best : Accuracy=19.11, Error=80.89]\r\n      Epoch: [002][000/500]   Time 0.133 (0.133)   Data 0.086 (0.086)   Loss 3.4438 (3.4438)   Prec@1 17.000 (17.000)   Prec@5 45.000 (45.000)   [2018-08-19 00:02:07]\r\n      Epoch: [002][200/500]   Time 0.089 (0.091)   Data 0.000 (0.001)   Loss 3.1025 (3.2688)   Prec@1 26.000 (19.721)   Prec@5 56.000 (48.085)   [2018-08-19 00:02:26]\r\n      Epoch: [002][400/500]   Time 0.092 (0.091)   Data 0.000 (0.000)   Loss 2.9271 (3.1983)   Prec@1 24.000 (20.998)   Prec@5 57.000 (50.125)   [2018-08-19 00:02:44]\r\n      **Train** Prec@1 21.658 Prec@5 50.980 Error@1 78.342\r\n      **Test** Prec@1 26.430 Prec@5 56.030 Error@1 73.570\r\n    \r\n    ==>>[2018-08-19 00:02:57] [Epoch=003/450] [Need: 06:10:40] [learning_rate=0.100000] [Best : Accuracy=26.43, Error=73.57]\r\n      Epoch: [003][000/500]   Time 0.136 (0.136)   Data 0.087 (0.087)   Loss 2.8432 (2.8432)   Prec@1 23.000 (23.000)   Prec@5 55.000 (55.000)   [2018-08-19 00:02:57]\r\n      Epoch: [003][200/500]   Time 0.092 (0.091)   Data 0.000 (0.001)   Loss 2.8233 (2.8715)   Prec@1 33.000 (26.567)   Prec@5 62.000 (58.433)   [2018-08-19 00:03:16]\r\n      Epoch: [003][400/500]   Time 0.092 (0.091)   Data 0.000 (0.000)   Loss 2.6975 (2.8040)   Prec@1 29.000 (28.047)   Prec@5 58.000 (60.125)   [2018-08-19 00:03:34]\r\n      **Train** Prec@1 28.784 Prec@5 60.932 Error@1 71.216\r\n      **Test** Prec@1 30.960 Prec@5 61.810 Error@1 69.040\r\n\r\n\r\n\r\n**Tensorflow( v1.7.0)** :\r\n\r\n    totalMemory: 7.93GiB freeMemory: 7.38GiB\r\n    2018-08-26 09:06:38.766280: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1423] Adding visible gpu devices: 0\r\n    2018-08-26 09:06:38.929447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n    2018-08-26 09:06:38.929480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0 \r\n    2018-08-26 09:06:38.929484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N \r\n    2018-08-26 09:06:38.929650: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1041] Created TensorFlow device (/device:GPU:0 with 7131 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n    INFO:tensorflow:Benchmark run: {'model_name': 'simpnet', 'machine_config': {'cpu_info': {'num_cores': 8, 'cpu_info': 'Intel(R) Core(TM) i7-4790K CPU @ 4.00GHz', 'mhz_per_cpu': 4000.0}, 'gpu_info': {'count': 1, 'model': 'GeForce GTX 1080'}, 'memory_total': 20986626048, 'memory_available': 14860541952}, 'run_date': '2018-08-26T04:36:38.596702Z', 'tensorflow_version': {'version': '1.7.0', 'git_hash': 'v1.7.0-3-g024aecf414'}, 'tensorflow_environment_variables': [{'name': 'TF_ENABLE_WINOGRAD_NONFUSED', 'value': '1'}]}\r\n    INFO:tensorflow:Starting a training cycle: 0/250\r\n    INFO:tensorflow:Calling model_fn.\r\n    data_format:  channels_first\r\n    INFO:tensorflow:Done calling model_fn.\r\n    INFO:tensorflow:Create CheckpointSaverHook.\r\n    INFO:tensorflow:Graph was finalized.\r\n    2018-08-26 09:06:40.685552: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1423] Adding visible gpu devices: 0\r\n    2018-08-26 09:06:40.685610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n    2018-08-26 09:06:40.685617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0 \r\n    2018-08-26 09:06:40.685630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N \r\n    2018-08-26 09:06:40.685744: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1041] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7131 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n    INFO:tensorflow:Running local_init_op.\r\n    INFO:tensorflow:Done running local_init_op.\r\n    INFO:tensorflow:Saving checkpoints for 1 into /tmp/cifar10_model/model.ckpt.\r\n    INFO:tensorflow:learning_rate = 0.1, cross_entropy = 7.7181897, train_accuracy = 0.09\r\n    INFO:tensorflow:loss = 20.531982, step = 0\r\n    INFO:tensorflow:global_step/sec: 5.5106\r\n    INFO:tensorflow:learning_rate = 0.1, cross_entropy = 2.26069, train_accuracy = 0.105 (18.147 sec)\r\n    INFO:tensorflow:loss = 13.960868, step = 100 (18.147 sec)\r\n    INFO:tensorflow:global_step/sec: 5.42846\r\n    INFO:tensorflow:learning_rate = 0.1, cross_entropy = 2.291137, train_accuracy = 0.10666667 (18.421 sec)\r\n    INFO:tensorflow:loss = 12.874262, step = 200 (18.421 sec)\r\n    INFO:tensorflow:global_step/sec: 5.62853\r\n    INFO:tensorflow:learning_rate = 0.1, cross_entropy = 2.1555672, train_accuracy = 0.1175 (17.767 sec)\r\n    INFO:tensorflow:loss = 11.73109, step = 300 (17.767 sec)\r\n    INFO:tensorflow:global_step/sec: 5.45977\r\n    INFO:tensorflow:learning_rate = 0.1, cross_entropy = 2.0706115, train_accuracy = 0.122 (18.316 sec)\r\n    INFO:tensorflow:loss = 10.739094, step = 400 (18.316 sec)\r\n    INFO:tensorflow:Saving checkpoints for 500 into /tmp/cifar10_model/model.ckpt.\r\n    INFO:tensorflow:Loss for final step: 9.72249.\r\n    INFO:tensorflow:Starting to evaluate.\r\n    INFO:tensorflow:Calling model_fn.\r\n    data_format:  channels_first\r\n    INFO:tensorflow:Done calling model_fn.\r\n    INFO:tensorflow:Starting evaluation at 2018-08-26-04:38:16\r\n    INFO:tensorflow:Graph was finalized.\r\n    2018-08-26 09:08:16.838937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1423] Adding visible gpu devices: 0\r\n    2018-08-26 09:08:16.838968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n    2018-08-26 09:08:16.838986: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0 \r\n    2018-08-26 09:08:16.838989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N \r\n    2018-08-26 09:08:16.839099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1041] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7131 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n    INFO:tensorflow:Restoring parameters from /tmp/cifar10_model/model.ckpt-500\r\n    INFO:tensorflow:Running local_init_op.\r\n    INFO:tensorflow:Done running local_init_op.\r\n    INFO:tensorflow:Finished evaluation at 2018-08-26-04:38:22\r\n    INFO:tensorflow:Saving dict for global step 500: accuracy = 0.2181, global_step = 500, loss = 9.815871\r\n    INFO:tensorflow:Benchmark metric: Name accuracy, value 0, unit None, global_step 500, extras []\r\n    INFO:tensorflow:Benchmark metric: Name loss, value 9, unit None, global_step 500, extras []\r\n    INFO:tensorflow:Starting a training cycle: 1/250\r\n    INFO:tensorflow:Calling model_fn.\r\n    data_format:  channels_first\r\n    INFO:tensorflow:Done calling model_fn.\r\n    INFO:tensorflow:Create CheckpointSaverHook.\r\n    INFO:tensorflow:Graph was finalized.\r\n    2018-08-26 09:08:23.994577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1423] Adding visible gpu devices: 0\r\n    2018-08-26 09:08:23.994610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n    2018-08-26 09:08:23.994625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0 \r\n    2018-08-26 09:08:23.994630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N \r\n    2018-08-26 09:08:23.994726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1041] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7131 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n    INFO:tensorflow:Restoring parameters from /tmp/cifar10_model/model.ckpt-500\r\n    INFO:tensorflow:Running local_init_op.\r\n    INFO:tensorflow:Done running local_init_op.\r\n    INFO:tensorflow:Saving checkpoints for 501 into /tmp/cifar10_model/model.ckpt.\r\n    INFO:tensorflow:learning_rate = 0.1, cross_entropy = 1.831348, train_accuracy = 0.23\r\n    INFO:tensorflow:loss = 9.679985, step = 500\r\n    INFO:tensorflow:global_step/sec: 5.3539\r\n    INFO:tensorflow:learning_rate = 0.1, cross_entropy = 1.8214886, train_accuracy = 0.25 (18.678 sec)\r\n    INFO:tensorflow:loss = 8.9299, step = 600 (18.678 sec)\r\n    INFO:tensorflow:global_step/sec: 5.49204\r\n    INFO:tensorflow:learning_rate = 0.1, cross_entropy = 1.7747709, train_accuracy = 0.26666668 (18.208 sec)\r\n    INFO:tensorflow:loss = 8.215595, step = 700 (18.208 sec)\r\n    INFO:tensorflow:global_step/sec: 5.48954\r\n    INFO:tensorflow:learning_rate = 0.1, cross_entropy = 1.7076583, train_accuracy = 0.275 (18.216 sec)\r\n    INFO:tensorflow:loss = 7.5460052, step = 800 (18.216 sec)\r\n    INFO:tensorflow:global_step/sec: 5.65214\r\n    INFO:tensorflow:learning_rate = 0.1, cross_entropy = 1.6106825, train_accuracy = 0.286 (17.692 sec)\r\n    INFO:tensorflow:loss = 6.904671, step = 900 (17.692 sec)\r\n    INFO:tensorflow:Saving checkpoints for 1000 into /tmp/cifar10_model/model.ckpt.\r\n    INFO:tensorflow:Loss for final step: 6.5854077.\r\n    INFO:tensorflow:Starting to evaluate.\r\n    INFO:tensorflow:Calling model_fn.\r\n    data_format:  channels_first\r\n    INFO:tensorflow:Done calling model_fn.\r\n    INFO:tensorflow:Starting evaluation at 2018-08-26-04:39:57\r\n    INFO:tensorflow:Graph was finalized.\r\n    2018-08-26 09:09:57.431671: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1423] Adding visible gpu devices: 0\r\n    2018-08-26 09:09:57.431702: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n    2018-08-26 09:09:57.431718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0 \r\n    2018-08-26 09:09:57.431722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N \r\n    2018-08-26 09:09:57.431814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1041] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7131 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n    INFO:tensorflow:Restoring parameters from /tmp/cifar10_model/model.ckpt-1000\r\n    INFO:tensorflow:Running local_init_op.\r\n    INFO:tensorflow:Done running local_init_op.\r\n    INFO:tensorflow:Finished evaluation at 2018-08-26-04:40:02\r\n    INFO:tensorflow:Saving dict for global step 1000: accuracy = 0.264, global_step = 1000, loss = 6.684446\r\n    INFO:tensorflow:Benchmark metric: Name accuracy, value 0, unit None, global_step 1000, extras []\r\n    INFO:tensorflow:Benchmark metric: Name loss, value 6, unit None, global_step 1000, extras []\r\n    INFO:tensorflow:Starting a training cycle: 2/250\r\n    INFO:tensorflow:Calling model_fn.\r\n    data_format:  channels_first\r\n    INFO:tensorflow:Done calling model_fn.\r\n    INFO:tensorflow:Create CheckpointSaverHook.\r\n    INFO:tensorflow:Graph was finalized.\r\n    2018-08-26 09:10:04.247883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1423] Adding visible gpu devices: 0\r\n    2018-08-26 09:10:04.247914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n    2018-08-26 09:10:04.247930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0 \r\n    2018-08-26 09:10:04.247934: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N \r\n    2018-08-26 09:10:04.248028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1041] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7131 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n    INFO:tensorflow:Restoring parameters from /tmp/cifar10_model/model.ckpt-1000\r\n    INFO:tensorflow:Running local_init_op.\r\n    INFO:tensorflow:Done running local_init_op.\r\n    INFO:tensorflow:Saving checkpoints for 1001 into /tmp/cifar10_model/model.ckpt.\r\n    INFO:tensorflow:learning_rate = 0.1, cross_entropy = 1.7071365, train_accuracy = 0.32\r\n    INFO:tensorflow:loss = 6.5100193, step = 1000\r\n    INFO:tensorflow:global_step/sec: 5.54579\r\n    INFO:tensorflow:learning_rate = 0.1, cross_entropy = 1.5869155, train_accuracy = 0.335 (18.032 sec)\r\n    INFO:tensorflow:loss = 5.9459677, step = 1100 (18.032 sec)\r\n    INFO:tensorflow:global_step/sec: 5.69552\r\n    INFO:tensorflow:learning_rate = 0.1, cross_entropy = 1.754588, train_accuracy = 0.31 (17.558 sec)\r\n    INFO:tensorflow:loss = 5.7136836, step = 1200 (17.558 sec)\r\n    INFO:tensorflow:global_step/sec: 5.69235\r\n    INFO:tensorflow:learning_rate = 0.1, cross_entropy = 1.6495434, train_accuracy = 0.3225 (17.568 sec)\r\n    INFO:tensorflow:loss = 5.2463627, step = 1300 (17.568 sec)\r\n    INFO:tensorflow:global_step/sec: 5.60754\r\n    INFO:tensorflow:learning_rate = 0.1, cross_entropy = 1.6227012, train_accuracy = 0.326 (17.833 sec)\r\n    INFO:tensorflow:loss = 4.8923674, step = 1400 (17.833 sec)\r\n    INFO:tensorflow:Saving checkpoints for 1500 into /tmp/cifar10_model/model.ckpt.\r\n    INFO:tensorflow:Loss for final step: 4.7713437.\r\n    INFO:tensorflow:Starting to evaluate.\r\n    INFO:tensorflow:Calling model_fn.\r\n    data_format:  channels_first\r\n    INFO:tensorflow:Done calling model_fn.\r\n    INFO:tensorflow:Starting evaluation at 2018-08-26-04:41:36\r\n    INFO:tensorflow:Graph was finalized.\r\n    2018-08-26 09:11:36.521245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1423] Adding visible gpu devices: 0\r\n    2018-08-26 09:11:36.521277: I tensorflow/core/common_runtime/gpu/gpu_device.cc:911] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n    2018-08-26 09:11:36.521285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:917]      0 \r\n    2018-08-26 09:11:36.521290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:930] 0:   N \r\n    2018-08-26 09:11:36.521385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1041] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7131 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n    INFO:tensorflow:Restoring parameters from /tmp/cifar10_model/model.ckpt-1500\r\n    INFO:tensorflow:Running local_init_op.\r\n    INFO:tensorflow:Done running local_init_op.\r\n    INFO:tensorflow:Finished evaluation at 2018-08-26-04:41:41\r\n    INFO:tensorflow:Saving dict for global step 1500: accuracy = 0.3168, global_step = 1500, loss = 4.7169304\r\n    INFO:tensorflow:Benchmark metric: Name accuracy, value 0, unit None, global_step 1500, extras []\r\n    INFO:tensorflow:Benchmark metric: Name loss, value 4, unit None, global_step 1500, extras []\r\n    INFO:tensorflow:Starting a training cycle: 3/250\r\n    INFO:tensorflow:Calling model_fn.\r\n    data_format:  channels_first\r\n    INFO:tensorflow:Done calling model_fn.\r\n    INFO:tensorflow:Create CheckpointSaverHook.\r\n    INFO:tensorflow:Graph was finalized.\r\n\r\n**Extra info** :  \r\nOs: Ubuntu 16.04  \r\nGPU: GTX1080  \r\nCPU: Intel 4790K  \r\nRAM : 20Gig  \r\nGPU Utilization : 99%    \r\n\r\n  [1]: https://github.com/tensorflow/models/tree/master/official/resnet\r\n  [2]: https://paste.ee/p/pN07i#s=2\r\n  [3]: https://paste.ee/p/pN07i#section0\r\n  [4]: https://paste.ee/p/pN07i#s=1"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21875", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21875/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21875/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21875/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21875", "id": 354021528, "node_id": "MDU6SXNzdWUzNTQwMjE1Mjg=", "number": 21875, "title": "Incompatible shapes between op input and calculated input gradient for nn.conv3d_transpose", "user": {"login": "Bedrettin-Cetinkaya", "id": 28837795, "node_id": "MDQ6VXNlcjI4ODM3Nzk1", "avatar_url": "https://avatars0.githubusercontent.com/u/28837795?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Bedrettin-Cetinkaya", "html_url": "https://github.com/Bedrettin-Cetinkaya", "followers_url": "https://api.github.com/users/Bedrettin-Cetinkaya/followers", "following_url": "https://api.github.com/users/Bedrettin-Cetinkaya/following{/other_user}", "gists_url": "https://api.github.com/users/Bedrettin-Cetinkaya/gists{/gist_id}", "starred_url": "https://api.github.com/users/Bedrettin-Cetinkaya/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Bedrettin-Cetinkaya/subscriptions", "organizations_url": "https://api.github.com/users/Bedrettin-Cetinkaya/orgs", "repos_url": "https://api.github.com/users/Bedrettin-Cetinkaya/repos", "events_url": "https://api.github.com/users/Bedrettin-Cetinkaya/events{/privacy}", "received_events_url": "https://api.github.com/users/Bedrettin-Cetinkaya/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-08-25T15:34:36Z", "updated_at": "2019-11-21T03:03:42Z", "closed_at": null, "author_association": "NONE", "body": "This is code:\r\n\r\n```\r\nfrom __future__ import absolute_import\r\nfrom __future__ import division\r\nfrom __future__ import print_function\r\nfrom utils import init_weight\r\nimport tensorflow as tf\r\n\r\nslim = tf.contrib.slim\r\n\r\n\r\n@tf.contrib.framework.add_arg_scope\r\ndef conv3d_transpose(inputs,\r\n                     num_outputs,\r\n                     kernel_size,\r\n                     weights,\r\n                     biases,\r\n                     stride,\r\n                     padding,\r\n                     activation_fn=tf.nn.relu,\r\n                     weights_initializer=tf.contrib.layers.xavier_initializer(),\r\n                     biases_initializer=tf.zeros_initializer(),\r\n                     reuse=None,\r\n                     trainable=True,\r\n                     scope=None):\r\n\r\n  with tf.variable_scope(\r\n      scope, 'Conv3d_transpose', [inputs], reuse=reuse):\r\n    dtype = inputs.dtype.base_dtype\r\n    kernel_d, kernel_h, kernel_w = kernel_size[0:3]\r\n    num_filters_in = inputs.get_shape()[4]\r\n    weights_shape = [kernel_d, kernel_h, kernel_w, num_outputs, num_filters_in]\r\n    \r\n    weights = tf.get_variable('weights',\r\n                              shape=weights_shape,\r\n                              dtype=dtype,\r\n                              initializer=tf.constant_initializer(weights),\r\n                              trainable=trainable)\r\n    \r\n    tf.contrib.framework.add_model_variable(weights)\r\n    \r\n    input_shape = inputs.get_shape().as_list()\r\n    batch_size = input_shape[0]\r\n    depth = input_shape[1]\r\n    height = input_shape[2]\r\n    width = input_shape[3]\r\n\r\n    def get_deconv_dim(dim_size, stride_size,pading,kernel):\r\n      if isinstance(dim_size, tf.Tensor):\r\n        sub = tf.subtract(dim_size,1)\r\n        dim_size = tf.multiply(dim_size,sub)\r\n        dim_size = tf.subtract(dim_size, 2*pading)\r\n        dim_size = tf.add(dim_size,kernel)\r\n        \r\n      elif dim_size is not None:\r\n        dim_size  = (dim_size -1)*stride_size - 2*pading + kernel\r\n      return dim_size\r\n   \r\n    pad = 1\r\n    if padding == 'VALID':\r\n      pad = 0\r\n    out_depth = get_deconv_dim(depth, stride,pad,weights.get_shape().as_list()[0])\r\n    out_height = get_deconv_dim(height, stride,pad,weights.get_shape().as_list()[1])\r\n    out_width = get_deconv_dim(width, stride,pad,weights.get_shape().as_list()[2])\r\n\r\n    out_shape = [batch_size, out_depth, out_height, out_width, num_outputs]\r\n    outputs = tf.nn.conv3d_transpose(inputs, weights, out_shape,\r\n                                     [1, stride, stride, stride, 1],\r\n                                     padding)\r\n\r\n    biases = tf.get_variable('biases',\r\n                               shape=[num_outputs,],\r\n                               dtype=dtype,\r\n                               initializer=tf.constant_initializer(biases),\r\n                               trainable=trainable)\r\n    tf.contrib.framework.add_model_variable(biases)\r\n    outputs = tf.nn.bias_add(outputs, biases)\r\n    \r\n    if activation_fn:\r\n      outputs = activation_fn(outputs)\r\n    return outputs\r\n\r\n\r\ndef model(identities, params, is_training):\r\n  \"\"\"Model transforming embedding to voxels.\"\"\"\r\n  del is_training  # Unused\r\n  f_dim = params.f_dim\r\n  with slim.arg_scope(\r\n      [slim.fully_connected, conv3d_transpose]):\r\n    w0 = init_weight(\"DecoderWeights/Layer1_13824_512_w.txt\",[13824,512],\"w\")\r\n    print(identities.get_shape().as_list())\r\n    h0 = slim.fully_connected(\r\n        identities, 3 * 3 * 3 * f_dim * 8, weights_initializer = tf.constant_initializer(w0), activation_fn=tf.nn.relu)\r\n    b0 = init_weight(\"DecoderWeights/Layer1_13824_b.txt\",[13824],\"b\")\r\n    b0 = tf.get_variable('db0',shape=[13824], initializer=tf.constant_initializer(b0),trainable=True)\r\n    h0 = tf.nn.bias_add(h0,b0)\r\n\r\n    h1 = tf.reshape(h0, [-1, 3, 3, 3, f_dim * 8])\r\n    print(h1.get_shape().as_list())\r\n    w1 = init_weight(\"DecoderWeights/Layer2_512_256_4_4_4_w.txt\",[512,256,4,4,4],\"w\")\r\n    b1 = init_weight(\"DecoderWeights/Layer2_256_b.txt\",[256],\"b\")\r\n    h1 = conv3d_transpose(\r\n        h1, f_dim * 4, [4, 4, 4],w1, b1,stride=1, padding= 'VALID',activation_fn=tf.nn.relu)\r\n    print(h1.get_shape().as_list())\r\n    w2 = init_weight(\"DecoderWeights/Layer3_256_96_5_5_5_w.txt\",[256,96,5,5,5],\"w\")\r\n    b2 = init_weight(\"DecoderWeights/Layer3_96_b.txt\",[96],\"b\")\r\n    h2 = conv3d_transpose(\r\n        h1, int(f_dim * 3 / 2), [5, 5, 5],w2 , b2, stride=2,padding ='VALID' ,activation_fn=tf.nn.relu)\r\n    print(h2.get_shape().as_list())\r\n    w3 = init_weight(\"DecoderWeights/Layer4_96_1_6_6_6_w.txt\",[96,1,6,6,6],\"w\")\r\n    b3 = init_weight(\"DecoderWeights/Layer4_1_b.txt\",[1],\"b\")\r\n    h3 = conv3d_transpose(\r\n        h2, 1, [6, 6, 6], w3,b3, stride=2, padding ='SAME' ,activation_fn=tf.nn.sigmoid)\r\n    print(h3.get_shape().as_list())\r\n  return h3\r\n```\r\n\r\nThis is error:\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 81, in <module>\r\n    epsilon=1e-08).minimize(loss, global_step=global_step)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 343, in minimize\r\n    grad_loss=grad_loss)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/training/optimizer.py\", line 414, in compute_gradients\r\n    colocate_gradients_with_ops=colocate_gradients_with_ops)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gradients_impl.py\", line 609, in gradients\r\n    % (op.name, i, t_in.shape, in_grad.shape))\r\nValueError: Incompatible shapes between op input and calculated input gradient.  Forward operation: decoder/Conv3d_transpose_2/conv3d_transpose.  Input index: 2. Original input shape: (6, 15, 15, 15, 96).  Calculated input gradient shape: (6, 16, 16, 16, 96)\r\n\r\nTf version : 1.4.1\r\n\r\nI have 4 layers, 1 fc and 3 conv3d_transpose.\r\n\r\nLayer shape as follows:\r\n\r\n[6, 512]\r\n[6, 3, 3, 3, 512]\r\n[6, 6, 6, 6, 256]\r\n[6, 15, 15, 15, 96]\r\n[6, 32, 32, 32, 1]\r\n\r\nI calculated conv3d_tranpose output shape as follows:\r\n```\r\n def get_deconv_dim(dim_size, stride_size,pading,kernel):\r\n      if dim_size is not None:\r\n        dim_size  = (dim_size -1)*stride_size - 2*pading + kernel\r\n      return dim_size\r\n   \r\n   pad = 1\r\n   if padding == 'VALID':\r\n     pad = 0\r\n   out_depth = get_deconv_dim(depth, stride,pad,weights.get_shape().as_list()[0])\r\n   out_height = get_deconv_dim(height, stride,pad,weights.get_shape().as_list()[1])\r\n   out_width = get_deconv_dim(width, stride,pad,weights.get_shape().as_list()[2])\r\n   out_shape = [batch_size, out_depth, out_height, out_width, num_outputs]\r\n   outputs = tf.nn.conv3d_transpose(inputs, weights, out_shape,\r\n                                     [1, stride, stride, stride, 1],\r\n                                     padding)\r\n```\r\nIn the last conv3d_transpose layer, while its output is calculated as (6,15,15,15,96), input gradient is calculated as (6,16,16,16,96). Therefore, this leads to error.\r\n\r\nWhen i call last conv3d_transpose layer with padding=\"SAME\", it didn't gives error.\r\n\r\nedit:\r\n\r\nEnvironment:\r\nOs: Ubuntu 16.04.3 LTS\r\nbazel: N/a\r\nTensorflow : 1.4.1 via pip install\r\ncuda: 9.0.176\r\nGPU: tesla k40, memory: 12gb\r\ncommand: I uploaded only erroneous python script, just run \"python blabla.py\".  If you want, i can upload all python scripts."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21855", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21855/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21855/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21855/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21855", "id": 353846601, "node_id": "MDU6SXNzdWUzNTM4NDY2MDE=", "number": 21855, "title": "Tensorflow Lite issue on Raspberry Pi", "user": {"login": "abhi-rf", "id": 19860524, "node_id": "MDQ6VXNlcjE5ODYwNTI0", "avatar_url": "https://avatars0.githubusercontent.com/u/19860524?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abhi-rf", "html_url": "https://github.com/abhi-rf", "followers_url": "https://api.github.com/users/abhi-rf/followers", "following_url": "https://api.github.com/users/abhi-rf/following{/other_user}", "gists_url": "https://api.github.com/users/abhi-rf/gists{/gist_id}", "starred_url": "https://api.github.com/users/abhi-rf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abhi-rf/subscriptions", "organizations_url": "https://api.github.com/users/abhi-rf/orgs", "repos_url": "https://api.github.com/users/abhi-rf/repos", "events_url": "https://api.github.com/users/abhi-rf/events{/privacy}", "received_events_url": "https://api.github.com/users/abhi-rf/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 14, "created_at": "2018-08-24T16:19:30Z", "updated_at": "2019-07-04T05:09:37Z", "closed_at": null, "author_association": "NONE", "body": "Hi Everyone. I am working on running some scripts on Tensorflow on Raspberry Pi 3. When I try to import a tflite model into the tflite interpreter, it throws an error. Please help :) :) \r\n------------------------\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:Raspbian Stretch\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:Rasp Pi 3\r\n- **TensorFlow installed from (source or binary)**:Binary\r\n- **TensorFlow version (use command below)**:1.9\r\n- **Python version**:2.7\r\n- **Bazel version (if compiling from source)**:NA\r\n- **GCC/Compiler version (if compiling from source)**:NA\r\n- **CUDA/cuDNN version**:NA\r\n- **GPU model and memory**:NA\r\n- **Exact command to reproduce**:-\r\n\r\n\r\n### Source code / logs\r\n\r\n###THE CODE###\r\n interpreter = tf.contrib.lite.Interpreter(model_path='mobilenet_v1_0.25_128_quant.tflite')\r\n\r\n###ERROR###\r\n\r\n/home/pi/.local/lib/python2.7/site-packages/tensorflow/python/framework/tensor_util.py:32: RuntimeWarning: numpy.dtype size changed, may indicate binary incompatibility. Expected 56, got 52\r\n  from tensorflow.python.framework import fast_tensor_util\r\nTraceback (most recent call last):\r\n  File \"mobilenet_int_tflite.py\", line 24, in <module>\r\n    interpreter = tf.contrib.lite.Interpreter(model_path='mobilenet_v1_0.25_128_quant.tflite')\r\n  File \"/home/pi/.local/lib/python2.7/site-packages/tensorflow/contrib/lite/python/interpreter.py\", line 50, in __init__\r\n    _interpreter_wrapper.InterpreterWrapper_CreateWrapperCPPFromFile(\r\n  File \"/home/pi/.local/lib/python2.7/site-packages/tensorflow/python/util/lazy_loader.py\", line 53, in __getattr__\r\n    module = self._load()\r\n  File \"/home/pi/.local/lib/python2.7/site-packages/tensorflow/python/util/lazy_loader.py\", line 42, in _load\r\n    module = importlib.import_module(self.__name__)\r\n  File \"/usr/lib/python2.7/importlib/__init__.py\", line 37, in import_module\r\n    __import__(name)\r\n  File \"/home/pi/.local/lib/python2.7/site-packages/tensorflow/contrib/lite/python/interpreter_wrapper/tensorflow_wrap_interpreter_wrapper.py\", line 28, in <module>\r\n    _tensorflow_wrap_interpreter_wrapper = swig_import_helper()\r\n  File \"/home/pi/.local/lib/python2.7/site-packages/tensorflow/contrib/lite/python/interpreter_wrapper/tensorflow_wrap_interpreter_wrapper.py\", line 24, in swig_import_helper\r\n    _mod = imp.load_module('_tensorflow_wrap_interpreter_wrapper', fp, pathname, description)\r\nImportError: /home/pi/.local/lib/python2.7/site-packages/tensorflow/contrib/lite/python/interpreter_wrapper/_tensorflow_wrap_interpreter_wrapper.so: undefined symbol: _ZN6tflite12tensor_utils39NeonMatrixBatchVectorMultiplyAccumulateEPKfiiS2_iPfi\r\n \r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21850", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21850/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21850/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21850/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21850", "id": 353722955, "node_id": "MDU6SXNzdWUzNTM3MjI5NTU=", "number": 21850, "title": "Error while using create_inference_graph - Can't find a device placement for the op!", "user": {"login": "srihari-humbarwadi", "id": 24864163, "node_id": "MDQ6VXNlcjI0ODY0MTYz", "avatar_url": "https://avatars0.githubusercontent.com/u/24864163?v=4", "gravatar_id": "", "url": "https://api.github.com/users/srihari-humbarwadi", "html_url": "https://github.com/srihari-humbarwadi", "followers_url": "https://api.github.com/users/srihari-humbarwadi/followers", "following_url": "https://api.github.com/users/srihari-humbarwadi/following{/other_user}", "gists_url": "https://api.github.com/users/srihari-humbarwadi/gists{/gist_id}", "starred_url": "https://api.github.com/users/srihari-humbarwadi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/srihari-humbarwadi/subscriptions", "organizations_url": "https://api.github.com/users/srihari-humbarwadi/orgs", "repos_url": "https://api.github.com/users/srihari-humbarwadi/repos", "events_url": "https://api.github.com/users/srihari-humbarwadi/events{/privacy}", "received_events_url": "https://api.github.com/users/srihari-humbarwadi/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-08-24T10:06:15Z", "updated_at": "2020-02-08T01:11:52Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: No\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: 1.10\r\n- **Python version**: 3.5\r\n- **Bazel version (if compiling from source)**:  0.16.1\r\n- **GCC/Compiler version (if compiling from source)**:  5.4.0\r\n- **CUDA/cuDNN version**: 9.0/7.0.5\r\n- **GPU model and memory**: 4 x GTX 1080Ti 394.44 11GB VRAM each\r\n- **TensorRT version**:3.0.4\r\n\r\n### Describe the problem\r\nerror while running trt.create_inference_graph on a frozen graph pb\r\n\r\n### Source code\r\n```\r\nimport os\r\nimport tensorflow as tf\r\nimport tensorflow.contrib.tensorrt as trt\r\nfrom tensorflow.python.framework import graph_io\r\n\r\n_input = 'input_1'\r\n_output = 'output_node0'\r\noutputs = [_output]\r\n\r\n\r\ndef get_frozen_graph():\r\n  with tf.gfile.FastGFile('model.h5.pb', \"rb\") as f:\r\n    graph_def = tf.GraphDef()\r\n    graph_def.ParseFromString(f.read())\r\n  return graph_def\r\n\r\n\r\nfrozen_graph_def = get_frozen_graph()\r\ntrt_graph_def = trt.create_inference_graph(frozen_graph_def, \r\n\t\t\t\t\toutputs,\r\n\t\t\t\t\tmax_batch_size=256, \r\n\t\t\t\t\tmax_workspace_size_bytes=1 << 30, \r\n\t\t\t\t\tprecision_mode='FP16')\r\ntf.reset_default_graph()\r\ng = tf.Graph()\r\nwith tf.Session(graph=g) as sess:\r\n\twith g.as_default():\r\n\t\ttf.import_graph_def(\r\n  \t\tgraph_def=trt_graph_def,\r\n  \t\tname='')\r\n\tgraph_io.write_graph(g, '.', 'trt_frozen.pb', as_text=False)\r\n```\r\n### logs\r\n2018-08-24 15:34:59.873109: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-08-24 15:34:59.964048: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-08-24 15:35:00.046908: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-08-24 15:35:00.149867: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2018-08-24 15:35:00.150535: I tensorflow/core/grappler/devices.cc:51] Number of eligible GPUs (core count >= 8): 4\r\n2018-08-24 15:35:00.150615: I tensorflow/core/grappler/clusters/single_machine.cc:359] Starting new session\r\n2018-08-24 15:35:00.151247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 0 with properties: \r\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582\r\npciBusID: 0000:01:00.0\r\ntotalMemory: 10.91GiB freeMemory: 10.38GiB\r\n2018-08-24 15:35:00.151374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 1 with properties: \r\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582\r\npciBusID: 0000:02:00.0\r\ntotalMemory: 10.92GiB freeMemory: 10.76GiB\r\n2018-08-24 15:35:00.151494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 2 with properties: \r\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582\r\npciBusID: 0000:03:00.0\r\ntotalMemory: 10.92GiB freeMemory: 10.76GiB\r\n2018-08-24 15:35:00.151608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 3 with properties: \r\nname: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582\r\npciBusID: 0000:05:00.0\r\ntotalMemory: 10.92GiB freeMemory: 10.76GiB\r\n2018-08-24 15:35:00.156119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3\r\n2018-08-24 15:35:01.123215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-08-24 15:35:01.123254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3 \r\n2018-08-24 15:35:01.123259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y \r\n2018-08-24 15:35:01.123263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y \r\n2018-08-24 15:35:01.123266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y \r\n2018-08-24 15:35:01.123269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N \r\n2018-08-24 15:35:01.123691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10016 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n2018-08-24 15:35:01.202813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10386 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080 Ti, pci bus id: 0000:02:00.0, compute capability: 6.1)\r\n2018-08-24 15:35:01.286295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10386 MB memory) -> physical GPU (device: 2, name: GeForce GTX 1080 Ti, pci bus id: 0000:03:00.0, compute capability: 6.1)\r\n2018-08-24 15:35:01.369518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10386 MB memory) -> physical GPU (device: 3, name: GeForce GTX 1080 Ti, pci bus id: 0000:05:00.0, compute capability: 6.1)\r\n2018-08-24 15:35:01.827178: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2951] Segment @scope '', converted to graph\r\n2018-08-24 15:35:01.827279: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:418] Can't find a device placement for the op!\r\n2018-08-24 15:35:01.901005: W tensorflow/contrib/tensorrt/log/trt_logger.cc:34] DefaultLogger Half2 support requested on hardware without native FP16 support, performance will be negatively affected.\r\n2018-08-24 15:35:02.432465: E tensorflow/contrib/tensorrt/log/trt_logger.cc:38] DefaultLogger resources.cpp (199) - Cuda Error in gieCudaMalloc: 2\r\n2018-08-24 15:35:02.433733: E tensorflow/contrib/tensorrt/log/trt_logger.cc:38] DefaultLogger resources.cpp (199) - Cuda Error in gieCudaMalloc: 2\r\n2018-08-24 15:35:02.434291: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:958] Engine my_trt_op_0 creation for segment 0, composed of 1089 nodes failed: Internal: Failed to build TensorRT engine. Skipping...\r\n2018-08-24 15:35:02.751864: I tensorflow/contrib/tensorrt/convert/convert_nodes.cc:2951] Segment @scope '', converted to graph\r\n2018-08-24 15:35:02.751964: E tensorflow/contrib/tensorrt/convert/convert_graph.cc:418] Can't find a device placement for the op!\r\n2018-08-24 15:35:02.856268: W tensorflow/contrib/tensorrt/log/trt_logger.cc:34] DefaultLogger Half2 support requested on hardware without native FP16 support, performance will be negatively affected.\r\n2018-08-24 15:35:02.904384: E tensorflow/contrib/tensorrt/log/trt_logger.cc:38] DefaultLogger resources.cpp (199) - Cuda Error in gieCudaMalloc: 2\r\n2018-08-24 15:35:02.905595: E tensorflow/contrib/tensorrt/log/trt_logger.cc:38] DefaultLogger resources.cpp (199) - Cuda Error in gieCudaMalloc: 2\r\n2018-08-24 15:35:02.906038: W tensorflow/contrib/tensorrt/convert/convert_graph.cc:958] Engine my_trt_op_0 creation for segment 0, composed of 1089 nodes failed: Internal: Failed to build TensorRT engine. Skipping...\r\n2018-08-24 15:35:03.064587: W tensorflow/contrib/tensorrt/convert/trt_optimization_pass.cc:185] TensorRTOptimizer is probably called on funcdef! This optimizer must *NOT* be called on function objects.\r\n2018-08-24 15:35:03.127441: W tensorflow/contrib/tensorrt/convert/trt_optimization_pass.cc:185] TensorRTOptimizer is probably called on funcdef! This optimizer must *NOT* be called on function objects.\r\n2018-08-24 15:35:03.160255: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:403] Optimization results for grappler item: tf_graph\r\n2018-08-24 15:35:03.160298: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   constant folding: Graph size after: 1098 nodes (-606), 1155 edges (-606), time = 96.013ms.\r\n2018-08-24 15:35:03.160304: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   layout: Graph size after: 1161 nodes (63), 1157 edges (2), time = 32.452ms.\r\n2018-08-24 15:35:03.160322: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   TensorRTOptimizer: Graph size after: 1161 nodes (0), 1157 edges (0), time = 808.131ms.\r\n2018-08-24 15:35:03.160329: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   constant folding: Graph size after: 1100 nodes (-61), 1157 edges (0), time = 80.726ms.\r\n2018-08-24 15:35:03.160332: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   TensorRTOptimizer: Graph size after: 1100 nodes (0), 1157 edges (0), time = 390.558ms.\r\n2018-08-24 15:35:03.160335: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:403] Optimization results for grappler item: my_trt_op_0_native_segment\r\n2018-08-24 15:35:03.160349: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   constant folding: Graph size after: 1090 nodes (0), 1147 edges (0), time = 65.266ms.\r\n2018-08-24 15:35:03.160434: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   layout: Invalid argument: The graph is already optimized by layout optimizer.\r\n2018-08-24 15:35:03.160438: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   TensorRTOptimizer: Graph size after: 1090 nodes (0), 1147 edges (0), time = 9.5ms.\r\n2018-08-24 15:35:03.160455: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   constant folding: Graph size after: 1090 nodes (0), 1147 edges (0), time = 53.271ms.\r\n2018-08-24 15:35:03.160458: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:405]   TensorRTOptimizer: Graph size after: 1090 nodes (0), 1147 edges (0), time = 9.467ms.\r\n2018-08-24 15:35:03.336425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1, 2, 3\r\n2018-08-24 15:35:03.336534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-08-24 15:35:03.336542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1 2 3 \r\n2018-08-24 15:35:03.336545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y Y Y \r\n2018-08-24 15:35:03.336548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N Y Y \r\n2018-08-24 15:35:03.336551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 2:   Y Y N Y \r\n2018-08-24 15:35:03.336553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 3:   Y Y Y N \r\n2018-08-24 15:35:03.336822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10016 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)\r\n2018-08-24 15:35:03.336960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10386 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080 Ti, pci bus id: 0000:02:00.0, compute capability: 6.1)\r\n2018-08-24 15:35:03.337073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 10386 MB memory) -> physical GPU (device: 2, name: GeForce GTX 1080 Ti, pci bus id: 0000:03:00.0, compute capability: 6.1)\r\n2018-08-24 15:35:03.337142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 10386 MB memory) -> physical GPU (device: 3, name: GeForce GTX 1080 Ti, pci bus id: 0000:05:00.0, compute capability: 6.1)"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21845", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21845/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21845/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21845/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21845", "id": 353694205, "node_id": "MDU6SXNzdWUzNTM2OTQyMDU=", "number": 21845, "title": "android yolo sample output format is different from the official documentation", "user": {"login": "lolicon", "id": 227627, "node_id": "MDQ6VXNlcjIyNzYyNw==", "avatar_url": "https://avatars0.githubusercontent.com/u/227627?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lolicon", "html_url": "https://github.com/lolicon", "followers_url": "https://api.github.com/users/lolicon/followers", "following_url": "https://api.github.com/users/lolicon/following{/other_user}", "gists_url": "https://api.github.com/users/lolicon/gists{/gist_id}", "starred_url": "https://api.github.com/users/lolicon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lolicon/subscriptions", "organizations_url": "https://api.github.com/users/lolicon/orgs", "repos_url": "https://api.github.com/users/lolicon/repos", "events_url": "https://api.github.com/users/lolicon/events{/privacy}", "received_events_url": "https://api.github.com/users/lolicon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "andrewharp", "id": 3376817, "node_id": "MDQ6VXNlcjMzNzY4MTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/3376817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andrewharp", "html_url": "https://github.com/andrewharp", "followers_url": "https://api.github.com/users/andrewharp/followers", "following_url": "https://api.github.com/users/andrewharp/following{/other_user}", "gists_url": "https://api.github.com/users/andrewharp/gists{/gist_id}", "starred_url": "https://api.github.com/users/andrewharp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andrewharp/subscriptions", "organizations_url": "https://api.github.com/users/andrewharp/orgs", "repos_url": "https://api.github.com/users/andrewharp/repos", "events_url": "https://api.github.com/users/andrewharp/events{/privacy}", "received_events_url": "https://api.github.com/users/andrewharp/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "andrewharp", "id": 3376817, "node_id": "MDQ6VXNlcjMzNzY4MTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/3376817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andrewharp", "html_url": "https://github.com/andrewharp", "followers_url": "https://api.github.com/users/andrewharp/followers", "following_url": "https://api.github.com/users/andrewharp/following{/other_user}", "gists_url": "https://api.github.com/users/andrewharp/gists{/gist_id}", "starred_url": "https://api.github.com/users/andrewharp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andrewharp/subscriptions", "organizations_url": "https://api.github.com/users/andrewharp/orgs", "repos_url": "https://api.github.com/users/andrewharp/repos", "events_url": "https://api.github.com/users/andrewharp/events{/privacy}", "received_events_url": "https://api.github.com/users/andrewharp/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-08-24T08:36:45Z", "updated_at": "2018-12-12T10:15:30Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:  MacOS 10.13.5 (Non-Relevant)\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:  Non-Relevant\r\n- **TensorFlow installed from (source or binary)**: Unsure\r\n- **TensorFlow version (use command below)**: org.tensorflow:tensorflow-android:1.9.0 Non-Relevant\r\n- **Python version**:  N/A\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **GCC/Compiler version (if compiling from source)**: N/A\r\n- **CUDA/cuDNN version**: N/A\r\n- **GPU model and memory**: N/A\r\n- **Exact command to reproduce**:N/A\r\n\r\n### Describe the problem\r\n\r\nIn Android Yolo Sample Code\r\n\r\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/android/src/org/tensorflow/demo/TensorFlowYoloDetector.java#L171\r\n\r\n```java\r\n        new float[gridWidth * gridHeight * (NUM_CLASSES + 5) * NUM_BOXES_PER_BLOCK];\r\n        ............\r\n        for (int y = 0; y < gridHeight; ++y) {\r\n           for (int x = 0; x < gridWidth; ++x) {\r\n               for (int b = 0; b < NUM_BOXES_PER_BLOCK; ++b) {\r\n                   ..........\r\n                    for (int c = 0; c < NUM_CLASSES; ++c) {\r\n                        classes[c] = output[offset + 5 + c];\r\n```\r\nalong with the following output decoding process, is not compatible with the original paper\r\nthese code assumes the output formats was \r\n\r\n **grid * grid * (class + 5) * box** \r\n\r\nbut in the original paper and other resource , this should be   \r\n\r\n**grid * grid * (class + box * 5)**\r\n\r\nas per in the paper [https://arxiv.org/pdf/1506.02640.pdf]( S * S * (B * 5 + C) )\r\nthis is totally different in format and size since every offset of the grid messed up\r\nthe paper indicates that the network only predicts one set of class probabilities per cell, regardless of the number of boxes B\r\n\r\n### Source code / logs\r\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/android/src/org/tensorflow/demo/TensorFlowYoloDetector.java#L171\r\n\r\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/android/src/org/tensorflow/demo/TensorFlowYoloDetector.java#L187-L213\r\n\r\nhttps://arxiv.org/pdf/1506.02640.pdf\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21839", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21839/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21839/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21839/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21839", "id": 353645169, "node_id": "MDU6SXNzdWUzNTM2NDUxNjk=", "number": 21839, "title": "SSD_mobilenet_v1/0.75_quantized_coco trained model is not detecting anything after porting on Android [Detect app]", "user": {"login": "alokranjan007", "id": 19912807, "node_id": "MDQ6VXNlcjE5OTEyODA3", "avatar_url": "https://avatars1.githubusercontent.com/u/19912807?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alokranjan007", "html_url": "https://github.com/alokranjan007", "followers_url": "https://api.github.com/users/alokranjan007/followers", "following_url": "https://api.github.com/users/alokranjan007/following{/other_user}", "gists_url": "https://api.github.com/users/alokranjan007/gists{/gist_id}", "starred_url": "https://api.github.com/users/alokranjan007/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alokranjan007/subscriptions", "organizations_url": "https://api.github.com/users/alokranjan007/orgs", "repos_url": "https://api.github.com/users/alokranjan007/repos", "events_url": "https://api.github.com/users/alokranjan007/events{/privacy}", "received_events_url": "https://api.github.com/users/alokranjan007/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "achowdhery", "id": 4723042, "node_id": "MDQ6VXNlcjQ3MjMwNDI=", "avatar_url": "https://avatars3.githubusercontent.com/u/4723042?v=4", "gravatar_id": "", "url": "https://api.github.com/users/achowdhery", "html_url": "https://github.com/achowdhery", "followers_url": "https://api.github.com/users/achowdhery/followers", "following_url": "https://api.github.com/users/achowdhery/following{/other_user}", "gists_url": "https://api.github.com/users/achowdhery/gists{/gist_id}", "starred_url": "https://api.github.com/users/achowdhery/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/achowdhery/subscriptions", "organizations_url": "https://api.github.com/users/achowdhery/orgs", "repos_url": "https://api.github.com/users/achowdhery/repos", "events_url": "https://api.github.com/users/achowdhery/events{/privacy}", "received_events_url": "https://api.github.com/users/achowdhery/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "achowdhery", "id": 4723042, "node_id": "MDQ6VXNlcjQ3MjMwNDI=", "avatar_url": "https://avatars3.githubusercontent.com/u/4723042?v=4", "gravatar_id": "", "url": "https://api.github.com/users/achowdhery", "html_url": "https://github.com/achowdhery", "followers_url": "https://api.github.com/users/achowdhery/followers", "following_url": "https://api.github.com/users/achowdhery/following{/other_user}", "gists_url": "https://api.github.com/users/achowdhery/gists{/gist_id}", "starred_url": "https://api.github.com/users/achowdhery/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/achowdhery/subscriptions", "organizations_url": "https://api.github.com/users/achowdhery/orgs", "repos_url": "https://api.github.com/users/achowdhery/repos", "events_url": "https://api.github.com/users/achowdhery/events{/privacy}", "received_events_url": "https://api.github.com/users/achowdhery/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2018-08-24T05:01:31Z", "updated_at": "2019-11-08T13:14:26Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\n     No, I have only changed few lines in the config file.\r\n- **OS Platform and Distribution: 14.04 LTS\r\n- **Mobile device if the issue happens on mobile device**: Motoroloa, Android version 7.1.1\r\n- **TensorFlow installed from (source or binary)**: Source\r\n- **TensorFlow version (use command below)**: 1.10.0\r\n- **Python version**: 3.6\r\n- **GCC/Compiler version (if compiling from source)**: 7.2.0\r\n- **CUDA/cuDNN version**: NA\r\n- **GPU model and memory**: 4GB, 64-Bit\r\n- **Bazel Version**: 0.16.0\r\n\r\n### Describe the problem\r\nCould you please help me regarding the results of the trained model.\r\n\r\nI trained two different models from tensorflow zoo directory named ssd_mobilenet_v1_0.75_depth_quantized_coco and ssd_mobilenet_v1_quantized_coco each with 10000 training steps. I had changed the no of classes to 5 (for my data set) and used a batch size of 10 for both the models. However, the total no of of images are limited to 205.\r\n\r\nBoth the model trained well with all files generated. I **tested** the trained model using **webcam** and it worked perfectly fine.\r\n\r\nAs a next step, I used this blog by @achowdhery  [Blog Link](https://medium.com/tensorflow/training-and-serving-a-realtime-mobile-object-detector-in-30-minutes-with-cloud-tpus-b78971cf1193) here and converted the .pb file into .tflite format. The generated detect.tflite is of size 3.2 Mb (This is what authors have also suggested in the blog that the file should be less than 4 Mb). However, after build over android device, **there is no detection at all**.\r\n\r\nI tried to hold it for at least 2 minutes for each classes (by showing images of each class), but there is no result in detection. It did not even overfit and show any false detection.\r\n\r\nWhat I have done wrong? Please share your thoughts.\r\n\r\nI am trying with both the models but no luck at all. I wonder the same model **(frozen graph) is working perfectly fine for webcam based detection.**\r\n\r\nThank you,"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21836", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21836/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21836/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21836/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21836", "id": 353593677, "node_id": "MDU6SXNzdWUzNTM1OTM2Nzc=", "number": 21836, "title": "tf.test.is_gpu_available(True) allocates all GPU(s) VRAM", "user": {"login": "BrianPugh", "id": 14318576, "node_id": "MDQ6VXNlcjE0MzE4NTc2", "avatar_url": "https://avatars3.githubusercontent.com/u/14318576?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BrianPugh", "html_url": "https://github.com/BrianPugh", "followers_url": "https://api.github.com/users/BrianPugh/followers", "following_url": "https://api.github.com/users/BrianPugh/following{/other_user}", "gists_url": "https://api.github.com/users/BrianPugh/gists{/gist_id}", "starred_url": "https://api.github.com/users/BrianPugh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BrianPugh/subscriptions", "organizations_url": "https://api.github.com/users/BrianPugh/orgs", "repos_url": "https://api.github.com/users/BrianPugh/repos", "events_url": "https://api.github.com/users/BrianPugh/events{/privacy}", "received_events_url": "https://api.github.com/users/BrianPugh/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2018-08-23T23:46:06Z", "updated_at": "2020-02-08T01:11:55Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: N/A\r\n- **TensorFlow installed from (source or binary)**:  1.10.0-devel-gpu-py3\r\n- **TensorFlow version (use command below)**: 1.10.0-devel-gpu-py3\r\n- **Python version**: 3.5.2\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **GCC/Compiler version (if compiling from source)**: N/A\r\n- **CUDA/cuDNN version**: CUDA: V9.0.176 cuDNN: V7.1.4\r\n- **GPU model and memory**: 2x 1080ti 11GB\r\n- **Exact command to reproduce**:\r\n\r\n```\r\nimport tensorflow as tf\r\n\r\ndata_format = 'channels_first' if tf.test.is_gpu_available(True) \\\r\n    else 'channels_last'\r\n# At this point, all memory is allocated across all GPUs\r\nconfig = tf.ConfigProto()\r\nconfig.gpu_options.allow_growth = True\r\nsess = tf.Session(config=config)\r\n# All VRAM still allocated\r\n```\r\n\r\n### Describe the problem\r\nUsing tf.test.is_gpu_available(True) to check if a system GPU is available allocates all the VRAM available."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21835", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21835/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21835/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21835/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21835", "id": 353535738, "node_id": "MDU6SXNzdWUzNTM1MzU3Mzg=", "number": 21835, "title": "New feature request: LOBPCG in addition to Lanczos?", "user": {"login": "lobpcg", "id": 42650045, "node_id": "MDQ6VXNlcjQyNjUwMDQ1", "avatar_url": "https://avatars0.githubusercontent.com/u/42650045?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lobpcg", "html_url": "https://github.com/lobpcg", "followers_url": "https://api.github.com/users/lobpcg/followers", "following_url": "https://api.github.com/users/lobpcg/following{/other_user}", "gists_url": "https://api.github.com/users/lobpcg/gists{/gist_id}", "starred_url": "https://api.github.com/users/lobpcg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lobpcg/subscriptions", "organizations_url": "https://api.github.com/users/lobpcg/orgs", "repos_url": "https://api.github.com/users/lobpcg/repos", "events_url": "https://api.github.com/users/lobpcg/events{/privacy}", "received_events_url": "https://api.github.com/users/lobpcg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2018-08-23T20:12:05Z", "updated_at": "2019-01-29T03:06:03Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nN/A\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\nall\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\nall\r\n- **TensorFlow installed from (source or binary)**:\r\nN/A\r\n- **TensorFlow version (use command below)**:\r\nN/A\r\n- **Python version**:\r\nN/A\r\n- **Bazel version (if compiling from source)**:\r\nN/A\r\n- **GCC/Compiler version (if compiling from source)**:\r\nN/A\r\n- **CUDA/cuDNN version**:\r\nN/A\r\n- **GPU model and memory**:\r\nN/A\r\n- **Exact command to reproduce**:\r\nN/A\r\n\r\n### Describe the problem\r\nTensorFlow now has a native implementation of Lanczos https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/solvers/python/ops/lanczos.py\r\n\r\nIt could be useful to add a native TensorFlow implementation of LOBPCG, see https://en.wikipedia.org/wiki/LOBPCG which is an alternative to Lanczos  and has some advantages, e.g., warm-starts. SciPy has the Python native implementation https://docs.scipy.org/doc/scipy-1.1.0/reference/generated/scipy.sparse.linalg.lobpcg.html used in Scikit for manifold spectral embedding http://scikit-learn.org/stable/modules/generated/sklearn.manifold.spectral_embedding.html and for spectral clustering http://scikit-learn.org/stable/modules/generated/sklearn.cluster.SpectralClustering.html\r\n\r\nReference implementations of LOBPCG are described in \r\n\r\n1. Knyazev, Andrew V. (2001). \"Toward the Optimal Preconditioned Eigensolver: Locally Optimal Block Preconditioned Conjugate Gradient Method\". SIAM Journal on Scientific Computing. 23 (2): 517\u2013541. doi:10.1137/S1064827500366124\r\n2. Knyazev, A. V.; Argentati, M. E.; Lashuk, I.; Ovtchinnikov, E. E. (2007). \"Block Locally Optimal Preconditioned Eigenvalue Xolvers (BLOPEX) in Hypre and PETSc\". SIAM Journal on Scientific Computing. 29 (5): 2224. arXiv:0705.2626\u202fFreely accessible. doi:10.1137/060661624\r\n\r\nLOBPCG can be easily adopted to compute partial SVD and PCA for a data matrix X without ever computing its covariance matrix X'*X, i.e. in matrix-free fashion, see comments at https://www.mathworks.com/matlabcentral/fileexchange/48-lobpcg-m\r\n\r\nNVIDIA has implemented LOBPCG in its nvGRAPH library introduced in CUDA 8.\r\n\r\nA first simple step could be to write a single-vector (non-block) version LOPCG, which would be very similar to already existing https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/solvers/python/ops/linear_equations.py\r\nbut instead of solving Ax=rhs would produce a single eigenvector of selfadjoint matrix `A`  matrix-free where the action of the matrix A is represented by  `operator`, corresponding to the largest (or smallest) eigenvalue, possibly constrained to be orthogonal to a set of given vectors Y. The latter would allow computing several main eigenvectors one-by-one, putting all previously computed eigenvectors into Y.\r\n\r\nI can help with the implementation if numerical issues arise.\r\n\r\n### Source code / logs\r\nN/A\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21830", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21830/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21830/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21830/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21830", "id": 353395011, "node_id": "MDU6SXNzdWUzNTMzOTUwMTE=", "number": 21830, "title": "Canned TensorForest Tracking", "user": {"login": "yupbank", "id": 741544, "node_id": "MDQ6VXNlcjc0MTU0NA==", "avatar_url": "https://avatars1.githubusercontent.com/u/741544?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yupbank", "html_url": "https://github.com/yupbank", "followers_url": "https://api.github.com/users/yupbank/followers", "following_url": "https://api.github.com/users/yupbank/following{/other_user}", "gists_url": "https://api.github.com/users/yupbank/gists{/gist_id}", "starred_url": "https://api.github.com/users/yupbank/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yupbank/subscriptions", "organizations_url": "https://api.github.com/users/yupbank/orgs", "repos_url": "https://api.github.com/users/yupbank/repos", "events_url": "https://api.github.com/users/yupbank/events{/privacy}", "received_events_url": "https://api.github.com/users/yupbank/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 969831806, "node_id": "MDU6TGFiZWw5Njk4MzE4MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/WIP", "name": "WIP", "color": "f4c77f", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "nataliaponomareva", "id": 4313109, "node_id": "MDQ6VXNlcjQzMTMxMDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/4313109?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nataliaponomareva", "html_url": "https://github.com/nataliaponomareva", "followers_url": "https://api.github.com/users/nataliaponomareva/followers", "following_url": "https://api.github.com/users/nataliaponomareva/following{/other_user}", "gists_url": "https://api.github.com/users/nataliaponomareva/gists{/gist_id}", "starred_url": "https://api.github.com/users/nataliaponomareva/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nataliaponomareva/subscriptions", "organizations_url": "https://api.github.com/users/nataliaponomareva/orgs", "repos_url": "https://api.github.com/users/nataliaponomareva/repos", "events_url": "https://api.github.com/users/nataliaponomareva/events{/privacy}", "received_events_url": "https://api.github.com/users/nataliaponomareva/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nataliaponomareva", "id": 4313109, "node_id": "MDQ6VXNlcjQzMTMxMDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/4313109?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nataliaponomareva", "html_url": "https://github.com/nataliaponomareva", "followers_url": "https://api.github.com/users/nataliaponomareva/followers", "following_url": "https://api.github.com/users/nataliaponomareva/following{/other_user}", "gists_url": "https://api.github.com/users/nataliaponomareva/gists{/gist_id}", "starred_url": "https://api.github.com/users/nataliaponomareva/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nataliaponomareva/subscriptions", "organizations_url": "https://api.github.com/users/nataliaponomareva/orgs", "repos_url": "https://api.github.com/users/nataliaponomareva/repos", "events_url": "https://api.github.com/users/nataliaponomareva/events{/privacy}", "received_events_url": "https://api.github.com/users/nataliaponomareva/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2018-08-23T14:01:26Z", "updated_at": "2018-12-13T18:58:56Z", "closed_at": null, "author_association": "MEMBER", "body": "Implementation steps for https://github.com/tensorflow/community/blob/master/rfcs/20180626-tensor-forest.md\r\n\r\n\r\n- [x] classification only and inference only  the tf/core/kernerl part https://github.com/tensorflow/tensorflow/pull/21803\r\n- [ ] classification only and inference only the tf/estimator python part https://github.com/tensorflow/estimator/pull/9\r\n- [ ] classification only and with training https://github.com/tensorflow/tensorflow/pull/23889\r\n- [ ] end2end classification estimator with tests and docs.\r\n- [ ] regression support \r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21829", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21829/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21829/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21829/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21829", "id": 353383719, "node_id": "MDU6SXNzdWUzNTMzODM3MTk=", "number": 21829, "title": "//tensorflow/contrib/fused_conv:fused_conv2d_bias_activation_op_test  running into `implementation not found` error", "user": {"login": "deven-amd", "id": 36858332, "node_id": "MDQ6VXNlcjM2ODU4MzMy", "avatar_url": "https://avatars2.githubusercontent.com/u/36858332?v=4", "gravatar_id": "", "url": "https://api.github.com/users/deven-amd", "html_url": "https://github.com/deven-amd", "followers_url": "https://api.github.com/users/deven-amd/followers", "following_url": "https://api.github.com/users/deven-amd/following{/other_user}", "gists_url": "https://api.github.com/users/deven-amd/gists{/gist_id}", "starred_url": "https://api.github.com/users/deven-amd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/deven-amd/subscriptions", "organizations_url": "https://api.github.com/users/deven-amd/orgs", "repos_url": "https://api.github.com/users/deven-amd/repos", "events_url": "https://api.github.com/users/deven-amd/events{/privacy}", "received_events_url": "https://api.github.com/users/deven-amd/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "azaks2", "id": 40365382, "node_id": "MDQ6VXNlcjQwMzY1Mzgy", "avatar_url": "https://avatars2.githubusercontent.com/u/40365382?v=4", "gravatar_id": "", "url": "https://api.github.com/users/azaks2", "html_url": "https://github.com/azaks2", "followers_url": "https://api.github.com/users/azaks2/followers", "following_url": "https://api.github.com/users/azaks2/following{/other_user}", "gists_url": "https://api.github.com/users/azaks2/gists{/gist_id}", "starred_url": "https://api.github.com/users/azaks2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/azaks2/subscriptions", "organizations_url": "https://api.github.com/users/azaks2/orgs", "repos_url": "https://api.github.com/users/azaks2/repos", "events_url": "https://api.github.com/users/azaks2/events{/privacy}", "received_events_url": "https://api.github.com/users/azaks2/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "azaks2", "id": 40365382, "node_id": "MDQ6VXNlcjQwMzY1Mzgy", "avatar_url": "https://avatars2.githubusercontent.com/u/40365382?v=4", "gravatar_id": "", "url": "https://api.github.com/users/azaks2", "html_url": "https://github.com/azaks2", "followers_url": "https://api.github.com/users/azaks2/followers", "following_url": "https://api.github.com/users/azaks2/following{/other_user}", "gists_url": "https://api.github.com/users/azaks2/gists{/gist_id}", "starred_url": "https://api.github.com/users/azaks2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/azaks2/subscriptions", "organizations_url": "https://api.github.com/users/azaks2/orgs", "repos_url": "https://api.github.com/users/azaks2/repos", "events_url": "https://api.github.com/users/azaks2/events{/privacy}", "received_events_url": "https://api.github.com/users/azaks2/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-08-23T13:34:34Z", "updated_at": "2018-12-11T18:52:38Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "------------------------\r\n\r\n### System information\r\n- **Have I written custom code**: No\r\n- **OS Platform and Distribution**:\r\n`tensorflow/tensorflow:1.9.0-devel-gpu-py3` docker container running on `Linux Ubuntu 16.04` host\r\n- **Mobile device**:  Not Applicable\r\n- **TensorFlow installed from (source or binary)**: cloned from repo\r\n- **TensorFlow version (use command below)**: `b'v1.9.0-0-g25c197e' 1.9.0`\r\n- **Python version**: `Python 3.5.2`\r\n- **Bazel version (if compiling from source)**: `0.15.0`\r\n- **GCC/Compiler version (if compiling from source)**: `5.4.0`\r\n- **CUDA/cuDNN version**: 9.0\r\n- **GPU model and memory**: Not Applicable\r\n- **Exact command to reproduce**: \r\n```\r\nbazel test --config=cuda  //tensorflow/contrib/fused_conv:fused_conv2d_bias_activation_op_test \r\n```\r\n\r\n### Describe the problem\r\n\r\nI am unable to run the `fused_conv` example from the contrib area. The error I run into is shown in the `Source code / logs` section below. The problem seems to be that \r\n- the code in kernel implementation for the `fused_conv2d_bias_activation_op` calls routines that are present in the `_pywrap_tensorflow_internal.so` library\r\n- the shared library created for the custom op `_fused_conv2d_bias_activation_op.so` does **not** have a dependency on the `_pywrap_tensorflow_internal.so` library\r\n\r\nI think one way to get past this error would be add the missing library dependency, but I do not know how to go about doing that. \r\n\r\n\r\n### Source code / logs\r\n\r\nerror from bazel command output\r\n\r\n```\r\nexec ${PAGER:-/usr/bin/less} \"$0\" || exit 1\r\nExecuting tests from //tensorflow/contrib/fused_conv:fused_conv2d_bias_activation_op_test\r\n-----------------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n File \"/root/.cache/bazel/_bazel_root/efb88f6336d9c4a18216fb94287b8d97/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/contrib/fused_conv/fused_conv2d_bias_activation_op_test.runfiles/org_tensorflow/tensorflow/contrib/fused_conv/python/ops/fused_conv2d_bia\\\r\ns_activation_op_test.py\", line 23, in <module>\r\n   from tensorflow.contrib.fused_conv.python.ops import fused_conv2d_bias_activation_op\r\n File \"/root/.cache/bazel/_bazel_root/efb88f6336d9c4a18216fb94287b8d97/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/contrib/fused_conv/fused_conv2d_bias_activation_op_test.runfiles/org_tensorflow/tensorflow/contrib/fused_conv/__init__.py\", line 22, in <\\\r\nmodule>\r\n   from tensorflow.contrib.fused_conv.python.ops.fused_conv2d_bias_activation_op import *\r\n File \"/root/.cache/bazel/_bazel_root/efb88f6336d9c4a18216fb94287b8d97/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/contrib/fused_conv/fused_conv2d_bias_activation_op_test.runfiles/org_tensorflow/tensorflow/contrib/fused_conv/python/ops/fused_conv2d_bia\\\r\ns_activation_op.py\", line 26, in <module>\r\n   resource_loader.get_path_to_datafile(\"_fused_conv2d_bias_activation_op.so\"))\r\n File \"/root/.cache/bazel/_bazel_root/efb88f6336d9c4a18216fb94287b8d97/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/contrib/fused_conv/fused_conv2d_bias_activation_op_test.runfiles/org_tensorflow/tensorflow/contrib/util/loader.py\", line 56, in load_op_l\\\r\nibrary\r\n   ret = load_library.load_op_library(path)\r\n File \"/root/.cache/bazel/_bazel_root/efb88f6336d9c4a18216fb94287b8d97/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/contrib/fused_conv/fused_conv2d_bias_activation_op_test.runfiles/org_tensorflow/tensorflow/python/framework/load_library.py\", line 56, in\\\r\nload_op_library\r\n   lib_handle = py_tf.TF_LoadLibrary(library_filename)\r\ntensorflow.python.framework.errors_impl.NotFoundError: /root/.cache/bazel/_bazel_root/efb88f6336d9c4a18216fb94287b8d97/execroot/org_tensorflow/bazel-out/k8-opt/bin/tensorflow/contrib/fused_conv/fused_conv2d_bias_activation_op_test.runfiles/org_tensorflow/tensorflow\\\r\n/contrib/fused_conv/python/ops/_fused_conv2d_bias_activation_op.so: undefined symbol: _ZN10tensorflow7functor10NHWCToNCHWIN5Eigen9GpuDeviceEfLi4EEclERKS3_NS2_9TensorMapINS2_6TensorIKfLi4ELi1ElEELi16ENS2_11MakePointerEEENS7_INS8_IfLi4ELi1ElEELi16ESB_EE\r\n```\r\n\r\nnote the lack of dependency on `_pywrap_tensorflow_internal.so`\r\n\r\n```\r\nroot@fptitan1:~/tensorflow# ldd ./bazel-tensorflow/bazel-out/k8-opt/bin/tensorflow/contrib/fused_conv/python/ops/_fused_conv2d_bias_activation_op.so\r\n\tlinux-vdso.so.1 =>  (0x00007ffebf7a9000)\r\n\tlibtensorflow_framework.so => /root/tensorflow/./bazel-tensorflow/bazel-out/k8-opt/bin/tensorflow/contrib/fused_conv/python/ops/../../../../../_solib_local/_U_S_Stensorflow_Scontrib_Sfused_Uconv_Cpython_Sops_S_Ufused_Uconv2d_Ubias_Uactivation_Uop.so___Utensorflow/libtensorflow_framework.so (0x00007f93a5e5e000)\r\n\tlibm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007f93a5b55000)\r\n\tlibdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f93a5951000)\r\n\tlibpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f93a5734000)\r\n\tlibrt.so.1 => /lib/x86_64-linux-gnu/librt.so.1 (0x00007f93a552c000)\r\n\tlibstdc++.so.6 => /usr/lib/x86_64-linux-gnu/libstdc++.so.6 (0x00007f93a51aa000)\r\n\tlibgcc_s.so.1 => /lib/x86_64-linux-gnu/libgcc_s.so.1 (0x00007f93a4f94000)\r\n\tlibc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f93a4bca000)\r\n\tlibcublas.so.9.0 => /usr/local/cuda-9.0/targets/x86_64-linux/lib/libcublas.so.9.0 (0x00007f93a12c5000)\r\n\tlibcuda.so.1 => /usr/local/nvidia/lib64/libcuda.so.1 (0x00007f93a0725000)\r\n\tlibcudnn.so.7 => /usr/lib/x86_64-linux-gnu/libcudnn.so.7 (0x00007f938c734000)\r\n\tlibcufft.so.9.0 => /usr/local/cuda-9.0/targets/x86_64-linux/lib/libcufft.so.9.0 (0x00007f9384693000)\r\n\tlibcurand.so.9.0 => /usr/local/cuda-9.0/targets/x86_64-linux/lib/libcurand.so.9.0 (0x00007f938072f000)\r\n\tlibcudart.so.9.0 => /usr/local/cuda-9.0/targets/x86_64-linux/lib/libcudart.so.9.0 (0x00007f93804c2000)\r\n\t/lib64/ld-linux-x86-64.so.2 (0x00007f93a70d5000)\r\n\tlibnvidia-fatbinaryloader.so.390.30 => /usr/local/nvidia/lib64/libnvidia-fatbinaryloader.so.390.30 (0x00007f9380276000)\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21820", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21820/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21820/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21820/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21820", "id": 353247094, "node_id": "MDU6SXNzdWUzNTMyNDcwOTQ=", "number": 21820, "title": "Dataset.padded_batch doc improvement request", "user": {"login": "harahu", "id": 6145801, "node_id": "MDQ6VXNlcjYxNDU4MDE=", "avatar_url": "https://avatars1.githubusercontent.com/u/6145801?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harahu", "html_url": "https://github.com/harahu", "followers_url": "https://api.github.com/users/harahu/followers", "following_url": "https://api.github.com/users/harahu/following{/other_user}", "gists_url": "https://api.github.com/users/harahu/gists{/gist_id}", "starred_url": "https://api.github.com/users/harahu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harahu/subscriptions", "organizations_url": "https://api.github.com/users/harahu/orgs", "repos_url": "https://api.github.com/users/harahu/repos", "events_url": "https://api.github.com/users/harahu/events{/privacy}", "received_events_url": "https://api.github.com/users/harahu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-08-23T06:51:43Z", "updated_at": "2018-12-10T18:05:29Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: n/a\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: n/a\r\n- **TensorFlow installed from (source or binary)**: n/a\r\n- **TensorFlow version (use command below)**: 1.10\r\n- **Python version**: 3.6\r\n- **Bazel version (if compiling from source)**: n/a\r\n- **GCC/Compiler version (if compiling from source)**: n/a\r\n- **CUDA/cuDNN version**: n/a\r\n- **GPU model and memory**: n/a\r\n- **Exact command to reproduce**: n/a\r\n\r\n### Describe the problem\r\nDocumentation problem. In the method documentation for 'tf.data.Dataset.padded_batch', the argument of `padded_shapes` is described to be \r\n\r\n> A nested structure of `tf.TensorShape` or `tf.int64` vector tensor-like objects...\r\n\r\nPython contains a myriad of different nesting structures. I would like the doc to at least refer to some complete definition of what this nested structure can be. Can it contain lists, tuples, dicts, sets? Maybe even more complex objects? Can it be an arbitrary non-cyclic graph? Please make clear any limitations on this structure.\r\n\r\n### Source code / logs\r\n[https://github.com/tensorflow/tensorflow/blob/r1.10/tensorflow/python/data/ops/dataset_ops.py](https://github.com/tensorflow/tensorflow/blob/r1.10/tensorflow/python/data/ops/dataset_ops.py)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21818", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21818/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21818/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21818/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21818", "id": 353207689, "node_id": "MDU6SXNzdWUzNTMyMDc2ODk=", "number": 21818, "title": "Unable to import tensorrt on macOS", "user": {"login": "nehaljwani", "id": 1779189, "node_id": "MDQ6VXNlcjE3NzkxODk=", "avatar_url": "https://avatars0.githubusercontent.com/u/1779189?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nehaljwani", "html_url": "https://github.com/nehaljwani", "followers_url": "https://api.github.com/users/nehaljwani/followers", "following_url": "https://api.github.com/users/nehaljwani/following{/other_user}", "gists_url": "https://api.github.com/users/nehaljwani/gists{/gist_id}", "starred_url": "https://api.github.com/users/nehaljwani/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nehaljwani/subscriptions", "organizations_url": "https://api.github.com/users/nehaljwani/orgs", "repos_url": "https://api.github.com/users/nehaljwani/repos", "events_url": "https://api.github.com/users/nehaljwani/events{/privacy}", "received_events_url": "https://api.github.com/users/nehaljwani/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586558, "node_id": "MDU6TGFiZWw0MDQ1ODY1NTg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:community%20support", "name": "stat:community support", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2018-08-23T03:25:30Z", "updated_at": "2018-10-03T03:26:24Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: macOS, 10.13.6\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: N/A\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: 1.10.0\r\n- **Python version**: 2.7.15\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **GCC/Compiler version (if compiling from source)**: N/A\r\n- **CUDA/cuDNN version**: N/A\r\n- **GPU model and memory**: N/A\r\n- **Exact command to reproduce**:  `python -c 'from tensorflow.contrib import tensorrt as trt'`\r\n\r\n\r\n### Describe the problem\r\nUnable to import tensorrt\r\n\r\n### Source code / logs\r\n```\r\n(/private/tmp/scratch.nwani/1534993632/dev) \u279c  1534993632 python\r\nPython 2.7.15 |Anaconda, Inc.| (default, May  1 2018, 18:37:05)\r\n[GCC 4.2.1 Compatible Clang 4.0.1 (tags/RELEASE_401/final)] on darwin\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> from tensorflow.contrib import tensorrt as trt\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/private/tmp/scratch.nwani/1534993632/dev/lib/python2.7/site-packages/tensorflow/contrib/tensorrt/__init__.py\", line 25, in <module>\r\n    from tensorflow.contrib.tensorrt.python import *\r\n  File \"/private/tmp/scratch.nwani/1534993632/dev/lib/python2.7/site-packages/tensorflow/contrib/tensorrt/python/__init__.py\", line 23, in <module>\r\n    from tensorflow.contrib.tensorrt.python.trt_convert import calib_graph_to_infer_graph\r\n  File \"/private/tmp/scratch.nwani/1534993632/dev/lib/python2.7/site-packages/tensorflow/contrib/tensorrt/python/trt_convert.py\", line 23, in <module>\r\n    from tensorflow.contrib.tensorrt.wrap_conversion import calib_convert\r\n  File \"/private/tmp/scratch.nwani/1534993632/dev/lib/python2.7/site-packages/tensorflow/contrib/tensorrt/wrap_conversion.py\", line 28, in <module>\r\n    _wrap_conversion = swig_import_helper()\r\n  File \"/private/tmp/scratch.nwani/1534993632/dev/lib/python2.7/site-packages/tensorflow/contrib/tensorrt/wrap_conversion.py\", line 24, in swig_import_helper\r\n    _mod = imp.load_module('_wrap_conversion', fp, pathname, description)\r\nImportError: dynamic module does not define init function (init_wrap_conversion)\r\n>>>\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21782", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21782/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21782/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21782/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21782", "id": 352790026, "node_id": "MDU6SXNzdWUzNTI3OTAwMjY=", "number": 21782, "title": "profiler trace_steps is not match global step in distribution training", "user": {"login": "PaulChongPeng", "id": 18079752, "node_id": "MDQ6VXNlcjE4MDc5NzUy", "avatar_url": "https://avatars1.githubusercontent.com/u/18079752?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PaulChongPeng", "html_url": "https://github.com/PaulChongPeng", "followers_url": "https://api.github.com/users/PaulChongPeng/followers", "following_url": "https://api.github.com/users/PaulChongPeng/following{/other_user}", "gists_url": "https://api.github.com/users/PaulChongPeng/gists{/gist_id}", "starred_url": "https://api.github.com/users/PaulChongPeng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PaulChongPeng/subscriptions", "organizations_url": "https://api.github.com/users/PaulChongPeng/orgs", "repos_url": "https://api.github.com/users/PaulChongPeng/repos", "events_url": "https://api.github.com/users/PaulChongPeng/events{/privacy}", "received_events_url": "https://api.github.com/users/PaulChongPeng/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}], "state": "open", "locked": false, "assignee": {"login": "wt-huang", "id": 42785337, "node_id": "MDQ6VXNlcjQyNzg1MzM3", "avatar_url": "https://avatars0.githubusercontent.com/u/42785337?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wt-huang", "html_url": "https://github.com/wt-huang", "followers_url": "https://api.github.com/users/wt-huang/followers", "following_url": "https://api.github.com/users/wt-huang/following{/other_user}", "gists_url": "https://api.github.com/users/wt-huang/gists{/gist_id}", "starred_url": "https://api.github.com/users/wt-huang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wt-huang/subscriptions", "organizations_url": "https://api.github.com/users/wt-huang/orgs", "repos_url": "https://api.github.com/users/wt-huang/repos", "events_url": "https://api.github.com/users/wt-huang/events{/privacy}", "received_events_url": "https://api.github.com/users/wt-huang/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "wt-huang", "id": 42785337, "node_id": "MDQ6VXNlcjQyNzg1MzM3", "avatar_url": "https://avatars0.githubusercontent.com/u/42785337?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wt-huang", "html_url": "https://github.com/wt-huang", "followers_url": "https://api.github.com/users/wt-huang/followers", "following_url": "https://api.github.com/users/wt-huang/following{/other_user}", "gists_url": "https://api.github.com/users/wt-huang/gists{/gist_id}", "starred_url": "https://api.github.com/users/wt-huang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wt-huang/subscriptions", "organizations_url": "https://api.github.com/users/wt-huang/orgs", "repos_url": "https://api.github.com/users/wt-huang/repos", "events_url": "https://api.github.com/users/wt-huang/events{/privacy}", "received_events_url": "https://api.github.com/users/wt-huang/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2018-08-22T03:29:10Z", "updated_at": "2018-12-21T18:52:11Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n\r\n== cat /etc/issue ===============================================\r\nLinux gpu0198 3.10.0-229.el7.x86_64 #1 SMP Fri Mar 6 11:36:42 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux\r\nVERSION=\"7 (Core)\"\r\nVERSION_ID=\"7\"\r\nCENTOS_MANTISBT_PROJECT_VERSION=\"7\"\r\nREDHAT_SUPPORT_PRODUCT_VERSION=\"7\"\r\n\r\n== are we in docker =============================================\r\nYes\r\n\r\n== compiler =====================================================\r\nc++ (GCC) 4.8.5 20150623 (Red Hat 4.8.5-28)\r\nCopyright (C) 2015 Free Software Foundation, Inc.\r\nThis is free software; see the source for copying conditions.  There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n\r\n\r\n== uname -a =====================================================\r\nLinux gpu0198 3.10.0-229.el7.x86_64 #1 SMP Fri Mar 6 11:36:42 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n== check pips ===================================================\r\nnumpy                              1.14.5\r\nprotobuf                           3.6.1\r\ntensorflow-gpu                     1.10.0\r\n\r\n== check for virtualenv =========================================\r\nTrue\r\n\r\n== tensorflow import ============================================\r\ntf.VERSION = 1.10.0\r\ntf.GIT_VERSION = v1.10.0-0-g656e7a2b34\r\ntf.COMPILER_VERSION = v1.10.0-0-g656e7a2b34\r\nSanity check: array([1], dtype=int32)\r\n\r\n== env ==========================================================\r\nLD_LIBRARY_PATH :/usr/local/nvidia/cpu_lib:/nodemanager/lib/native:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/java//jre/lib/amd64/server:/nodemanager/lib/native\r\nDYLD_LIBRARY_PATH is unset\r\n\r\n== nvidia-smi ===================================================\r\nWed Aug 22 03:12:21 2018\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 390.46                 Driver Version: 390.46                    |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  Tesla V100-PCIE...  On   | 00000000:86:00.0 Off |                    0 |\r\n| N/A   28C    P0    38W / 250W |      0MiB / 16160MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n\r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|  No running processes found                                                 |\r\n+-----------------------------------------------------------------------------+\r\n\r\n== cuda libs  ===================================================\r\n/usr/local/cuda-9.0/targets/x86_64-linux/lib/libcudart.so.9.0.176\r\n/usr/local/cuda-9.0/targets/x86_64-linux/lib/libcudart_static.a \r\n\r\n\r\n### Describe the problem\r\n\r\nWhen I use tensorflow profiler to get the timeline for distribution training, I found the trace_steps didn't match the global step and it result in useless timeline.\r\nI check the profile_context.py and find that the profile step is not related to the global step.\r\n\r\ndistribution config:\r\nps 2\r\nworker 8\r\n1 gpu per worker\r\n\r\n### Source code / logs\r\nsync code:\r\nwith tf.contrib.tfprof.ProfileContext(profile_dir=FLAGS.train_dir,\r\n                                                trace_steps=range(100, 200,3),\r\n                                                dump_steps=[200],\r\n                                                enabled=FLAGS.enable_profile,\r\n                                                debug=FLAGS.enable_profile_debug) as pctx:\r\n...\r\n...\r\n                optimizer = tf.train.SyncReplicasOptimizer(\r\n                    opt=optimizer,\r\n                    replicas_to_aggregate=FLAGS.replicas_to_aggregate,\r\n                    total_num_replicas=worker_replicas,\r\n                    variable_averages=variable_averages,\r\n                    variables_to_average=moving_average_variables)\r\n\r\n\r\nsync train log :\r\nworker 0:\r\ndebug: tracing step: 148\r\ndebug: tracing step: 151\r\nINFO:tensorflow:global step 19: loss = 2.1377 (8.300 sec/step)\r\ndebug: tracing step: 154\r\ndebug: tracing step: 157\r\n\r\nasync code:\r\nwith tf.contrib.tfprof.ProfileContext(profile_dir=FLAGS.train_dir,\r\n                                                trace_steps=range(800, 900),\r\n                                                dump_steps=[200],\r\n                                                enabled=FLAGS.enable_profile,\r\n                                                debug=FLAGS.enable_profile_debug) as pctx:\r\n\r\nasync train log:\r\nworker 0:\r\ndebug: tracing step: 838\r\nINFO:tensorflow:global step 2198: loss = 2.0687 (6.361 sec/step)\r\ndebug: tracing step: 839\r\n\r\nworker 7:\r\ndebug: tracing step: 825\r\nINFO:tensorflow:global step 3137: loss = 2.5605 (7.343 sec/step)\r\ndebug: tracing step: 826\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21748", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21748/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21748/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21748/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21748", "id": 352358955, "node_id": "MDU6SXNzdWUzNTIzNTg5NTU=", "number": 21748, "title": "train_spec.max_steps is ignored by tf.estimator.train_and_evaluate()", "user": {"login": "tarokiritani", "id": 1145404, "node_id": "MDQ6VXNlcjExNDU0MDQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/1145404?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tarokiritani", "html_url": "https://github.com/tarokiritani", "followers_url": "https://api.github.com/users/tarokiritani/followers", "following_url": "https://api.github.com/users/tarokiritani/following{/other_user}", "gists_url": "https://api.github.com/users/tarokiritani/gists{/gist_id}", "starred_url": "https://api.github.com/users/tarokiritani/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tarokiritani/subscriptions", "organizations_url": "https://api.github.com/users/tarokiritani/orgs", "repos_url": "https://api.github.com/users/tarokiritani/repos", "events_url": "https://api.github.com/users/tarokiritani/events{/privacy}", "received_events_url": "https://api.github.com/users/tarokiritani/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "shivaniag", "id": 16565716, "node_id": "MDQ6VXNlcjE2NTY1NzE2", "avatar_url": "https://avatars1.githubusercontent.com/u/16565716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shivaniag", "html_url": "https://github.com/shivaniag", "followers_url": "https://api.github.com/users/shivaniag/followers", "following_url": "https://api.github.com/users/shivaniag/following{/other_user}", "gists_url": "https://api.github.com/users/shivaniag/gists{/gist_id}", "starred_url": "https://api.github.com/users/shivaniag/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shivaniag/subscriptions", "organizations_url": "https://api.github.com/users/shivaniag/orgs", "repos_url": "https://api.github.com/users/shivaniag/repos", "events_url": "https://api.github.com/users/shivaniag/events{/privacy}", "received_events_url": "https://api.github.com/users/shivaniag/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "shivaniag", "id": 16565716, "node_id": "MDQ6VXNlcjE2NTY1NzE2", "avatar_url": "https://avatars1.githubusercontent.com/u/16565716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shivaniag", "html_url": "https://github.com/shivaniag", "followers_url": "https://api.github.com/users/shivaniag/followers", "following_url": "https://api.github.com/users/shivaniag/following{/other_user}", "gists_url": "https://api.github.com/users/shivaniag/gists{/gist_id}", "starred_url": "https://api.github.com/users/shivaniag/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shivaniag/subscriptions", "organizations_url": "https://api.github.com/users/shivaniag/orgs", "repos_url": "https://api.github.com/users/shivaniag/repos", "events_url": "https://api.github.com/users/shivaniag/events{/privacy}", "received_events_url": "https://api.github.com/users/shivaniag/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2018-08-21T02:09:53Z", "updated_at": "2019-02-06T10:36:28Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: v1.10.0-0-g656e7a2b34 1.10.0\r\n- **Python version**: 3.6.4\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**:  CUDA Version 9.1.85\r\n- **GPU model and memory**: Tesla K80\r\n- **Exact command to reproduce**: The following script\r\n\r\n```\r\nimport tensorflow as tf\r\ntf.logging.set_verbosity(20)\r\nimport math\r\nimport numpy as np\r\n\r\nx = np.array([[1,2,3.3, 2,10], [2,4.6,45,5,3],[5,5,56,2,1],[1,2,3,4,100],[10,2,1,4,50]]).astype(np.float32)\r\ny=np.array([0,0,0,1,1]).astype(np.float32)\r\nbatch_size = 2\r\n\r\ntrain_input_fn = tf.estimator.inputs.numpy_input_fn(x={'x': x},\r\n        y=y,\r\n        batch_size=batch_size,\r\n        num_epochs=1,\r\n        shuffle=True\r\n        )\r\n\r\neval_input_fn = tf.estimator.inputs.numpy_input_fn(x={'x': np.array([[1,2,3,1,4], [1,23,4,1,90]]).astype(np.float32)},\r\n        y=np.array([0,1]).astype(np.float32),\r\n        batch_size=batch_size,\r\n        num_epochs=1,\r\n        shuffle=False\r\n        )\r\n\r\ndnn = tf.estimator.DNNClassifier([32],\r\n    feature_columns=[tf.feature_column.numeric_column('x', shape=[5])])\r\n\r\nsteps_per_epoch = math.ceil(len(x) / batch_size)\r\nepochs = 3\r\n\r\ntrain_spec = tf.estimator.TrainSpec(input_fn=train_input_fn, max_steps=epochs * steps_per_epoch)\r\neval_spec = tf.estimator.EvalSpec(input_fn=eval_input_fn)\r\n\r\ntf.estimator.train_and_evaluate(dnn, train_spec, eval_spec)\r\n```\r\n\r\n### Describe the problem\r\ntf.estimator.train_and_evaluate() stops after 1 iteration with tf 1.10. It works fine with tf 1.9. Training should occur 9 times (=3 epochs x 3 steps per epoch) in total.\r\n\r\n### Source code / logs\r\n\r\nThe traceback with tf v1.9.0-0-g25c197e023 1.9.0:\r\n```\r\nINFO:tensorflow:Using default config.\r\nWARNING:tensorflow:Using temporary folder as model directory: /tmp/tmpgn5y57s6\r\nINFO:tensorflow:Using config: {'_model_dir': '/tmp/tmpgn5y57s6', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': None, '_save_checkpoints_secs': 600, '_session_config': None, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_device_fn': None, '_service': None, '_cluster_spec': <tensorflow.python.tr\r\naining.server_lib.ClusterSpec object at 0x7f29437f6908>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': \r\n0, '_num_worker_replicas': 1}\r\nINFO:tensorflow:Running training and evaluation locally (non-distributed).\r\nINFO:tensorflow:Start train and evaluate loop. The evaluate will happen after 600 secs (eval_spec.throttle_secs) or training is finished.\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Create CheckpointSaverHook.\r\nINFO:tensorflow:Graph was finalized.\r\n2018-08-21 01:06:30.556250: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\nINFO:tensorflow:Running local_init_op.\r\nINFO:tensorflow:Done running local_init_op.\r\nINFO:tensorflow:Saving checkpoints for 0 into /tmp/tmpgn5y57s6/model.ckpt.\r\nINFO:tensorflow:loss = 11.228095, step = 1\r\nINFO:tensorflow:Saving checkpoints for 3 into /tmp/tmpgn5y57s6/model.ckpt.\r\nINFO:tensorflow:Loss for final step: 0.016822023.\r\nINFO:tensorflow:Calling model_fn.\r\nWARNING:tensorflow:Trapezoidal rule is known to produce incorrect PR-AUCs; please switch to \"careful_interpolation\" instead.\r\nWARNING:tensorflow:Trapezoidal rule is known to produce incorrect PR-AUCs; please switch to \"careful_interpolation\" instead.\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Starting evaluation at 2018-08-21-01:06:31\r\nINFO:tensorflow:Graph was finalized.\r\nINFO:tensorflow:Restoring parameters from /tmp/tmpgn5y57s6/model.ckpt-3\r\nINFO:tensorflow:Running local_init_op.\r\nINFO:tensorflow:Done running local_init_op.\r\nINFO:tensorflow:Finished evaluation at 2018-08-21-01:06:32\r\nINFO:tensorflow:Saving dict for global step 3: accuracy = 1.0, accuracy_baseline = 0.5, auc = 0.99999905, auc_precision_recall = 0.999999, average_loss = 0.27123037, global_step = 3, label/mean = 0.5, los\r\ns = 0.54246074, precision = 1.0, prediction/mean = 0.4936065, recall = 1.0\r\n...\r\n---Information of steps 1-9 is shown.---\r\n```\r\n\r\nWith tf 1.10, the program ends after step 3:\r\n```\r\nINFO:tensorflow:Using default config.\r\nWARNING:tensorflow:Using temporary folder as model directory: /tmp/tmp686id5oc\r\nINFO:tensorflow:Using config: {'_model_dir': '/tmp/tmp686id5oc', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': None, '_save_checkpoints_secs': 600, '_session_config': None, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_device_fn': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f10547942b0>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}\r\nINFO:tensorflow:Running training and evaluation locally (non-distributed).\r\nINFO:tensorflow:Start train and evaluate loop. The evaluate will happen after every checkpoint. Checkpoint frequency is determined based on RunConfig arguments: save_checkpoints_steps None or save_checkpoints_secs 600.\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Create CheckpointSaverHook.\r\nINFO:tensorflow:Graph was finalized.\r\n2018-08-21 01:17:17.979737: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\nINFO:tensorflow:Running local_init_op.\r\nINFO:tensorflow:Done running local_init_op.\r\nINFO:tensorflow:Saving checkpoints for 0 into /tmp/tmp686id5oc/model.ckpt.\r\nINFO:tensorflow:loss = 6.8426137, step = 1\r\nINFO:tensorflow:Saving checkpoints for 3 into /tmp/tmp686id5oc/model.ckpt.\r\nINFO:tensorflow:Calling model_fn.\r\nWARNING:tensorflow:Trapezoidal rule is known to produce incorrect PR-AUCs; please switch to \"careful_interpolation\" instead.\r\nWARNING:tensorflow:Trapezoidal rule is known to produce incorrect PR-AUCs; please switch to \"careful_interpolation\" instead.\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Starting evaluation at 2018-08-21-01:17:19\r\nINFO:tensorflow:Graph was finalized.\r\nINFO:tensorflow:Restoring parameters from /tmp/tmp686id5oc/model.ckpt-3\r\nINFO:tensorflow:Running local_init_op.\r\nINFO:tensorflow:Done running local_init_op.\r\nINFO:tensorflow:Finished evaluation at 2018-08-21-01:17:19\r\nINFO:tensorflow:Saving dict for global step 3: accuracy = 1.0, accuracy_baseline = 0.5, auc = 0.99999905, auc_precision_recall = 0.999999, average_loss = 0.371122, global_step = 3, label/mean = 0.5, loss = 0.742244, precision = 1.0, prediction/mean = 0.42290705, recall = 1.0\r\nINFO:tensorflow:Saving 'checkpoint_path' summary for global step 3: /tmp/tmp686id5oc/model.ckpt-3\r\nINFO:tensorflow:Loss for final step: 1.7909913.\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21745", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21745/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21745/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21745/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21745", "id": 352330438, "node_id": "MDU6SXNzdWUzNTIzMzA0Mzg=", "number": 21745, "title": "Distributed tensorflow worker hangs at TF_CloseSession() when using MonitoredTrainingSession", "user": {"login": "leewyang", "id": 3676078, "node_id": "MDQ6VXNlcjM2NzYwNzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/3676078?v=4", "gravatar_id": "", "url": "https://api.github.com/users/leewyang", "html_url": "https://github.com/leewyang", "followers_url": "https://api.github.com/users/leewyang/followers", "following_url": "https://api.github.com/users/leewyang/following{/other_user}", "gists_url": "https://api.github.com/users/leewyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/leewyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/leewyang/subscriptions", "organizations_url": "https://api.github.com/users/leewyang/orgs", "repos_url": "https://api.github.com/users/leewyang/repos", "events_url": "https://api.github.com/users/leewyang/events{/privacy}", "received_events_url": "https://api.github.com/users/leewyang/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "yuefengz", "id": 1647833, "node_id": "MDQ6VXNlcjE2NDc4MzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/1647833?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yuefengz", "html_url": "https://github.com/yuefengz", "followers_url": "https://api.github.com/users/yuefengz/followers", "following_url": "https://api.github.com/users/yuefengz/following{/other_user}", "gists_url": "https://api.github.com/users/yuefengz/gists{/gist_id}", "starred_url": "https://api.github.com/users/yuefengz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yuefengz/subscriptions", "organizations_url": "https://api.github.com/users/yuefengz/orgs", "repos_url": "https://api.github.com/users/yuefengz/repos", "events_url": "https://api.github.com/users/yuefengz/events{/privacy}", "received_events_url": "https://api.github.com/users/yuefengz/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "yuefengz", "id": 1647833, "node_id": "MDQ6VXNlcjE2NDc4MzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/1647833?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yuefengz", "html_url": "https://github.com/yuefengz", "followers_url": "https://api.github.com/users/yuefengz/followers", "following_url": "https://api.github.com/users/yuefengz/following{/other_user}", "gists_url": "https://api.github.com/users/yuefengz/gists{/gist_id}", "starred_url": "https://api.github.com/users/yuefengz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yuefengz/subscriptions", "organizations_url": "https://api.github.com/users/yuefengz/orgs", "repos_url": "https://api.github.com/users/yuefengz/repos", "events_url": "https://api.github.com/users/yuefengz/events{/privacy}", "received_events_url": "https://api.github.com/users/yuefengz/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 15, "created_at": "2018-08-20T23:22:27Z", "updated_at": "2019-02-11T22:01:12Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: yes\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: N/A\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:  RHEL7 and also Mac OS X 10.13.6\r\n- **TensorFlow installed from (source or binary)**: binary (pip install)\r\n- **TensorFlow version (use command below)**: 1.9.0+\r\n- **Python version**: 2.7 (RHEL7), 3.6 (Mac)\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **GCC/Compiler version (if compiling from source)**: N/A\r\n- **CUDA/cuDNN version**: N/A\r\n- **GPU model and memory**: N/A\r\n- **Exact command to reproduce**: See below\r\n\r\n### Describe the problem\r\nWhen using `MonitoredTrainingSession` in TensorFlow version 1.9 or higher, I'm seeing the following deadlock/hang (as reported by the `hanging-threads` pip package) when the context manager exits.  Note: I do not see this hang for versions 1.8 or earlier.  Also, note that this does not occur if using the older `tf.train.Supervisor` API.\r\n```\r\n----------     Thread 140682110711616 hangs       ----------\r\n\tFile \"trainer.py\", line 102, in <module>\r\n\t\ttf.app.run(main=main, argv=[sys.argv[0]] + unparsed)\r\n\tFile \"/usr/lib/python2.7/site-packages/tensorflow/python/platform/app.py\", line 125, in run\r\n\t\t_sys.exit(main(argv))\r\n\tFile \"trainer.py\", line 67, in main\r\n\t\tprint(\"step: {}\".format(step))\r\n\tFile \"/usr/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 689, in __exit__\r\n\t\tself._close_internal(exception_type)\r\n\tFile \"/usr/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 726, in _close_internal\r\n\t\tself._sess.close()\r\n\tFile \"/usr/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 974, in close\r\n\t\tself._sess.close()\r\n\tFile \"/usr/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 1121, in close\r\n\t\t_WrappedSession.close(self)\r\n\tFile \"/usr/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 974, in close\r\n\t\tself._sess.close()\r\n\tFile \"/usr/lib/python2.7/site-packages/tensorflow/python/training/monitored_session.py\", line 974, in close\r\n\t\tself._sess.close()\r\n\tFile \"/usr/lib/python2.7/site-packages/tensorflow/python/client/session.py\", line 690, in close\r\n\t\ttf_session.TF_CloseSession(self._session)\r\n```\r\n\r\nThe [code](https://gist.github.com/leewyang/7bf6d0df0328fbc4e2e97275d741a044) that generates this is based on the [Distributed Tensorflow](https://www.tensorflow.org/deploy/distributed) documentation (with a trivial/dummy model).  I start one PS node and two worker nodes on a single box as follows:\r\n```\r\nrm -rf /tmp/train_logs; \\\r\npython trainer.py \\\r\n     --ps_hosts=localhost:2222 \\\r\n     --worker_hosts=localhost:2223,localhost:2224 \\\r\n     --job_name=ps --task_index=0\r\n\r\npython trainer.py \\\r\n     --ps_hosts=localhost:2222 \\\r\n     --worker_hosts=localhost:2223,localhost:2224 \\\r\n     --job_name=worker --task_index=0\r\n\r\npython trainer.py \\\r\n     --ps_hosts=localhost:2222 \\\r\n     --worker_hosts=localhost:2223,localhost:2224 \\\r\n     --job_name=worker --task_index=1\r\n```\r\n\r\nI've been able to reproduce this quite consistently on:\r\n- Mac 10.13.6, Python 3.6, TensorFlow 1.10\r\n- RHEL7, Python2.7, TensorFlow 1.9\r\n\r\nAnd the symptom goes away when switching to 1.8 or earlier."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21744", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21744/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21744/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21744/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21744", "id": 352316194, "node_id": "MDU6SXNzdWUzNTIzMTYxOTQ=", "number": 21744, "title": "Loading contrib ops in Windows via C API", "user": {"login": "adamAlnatsheh", "id": 29709248, "node_id": "MDQ6VXNlcjI5NzA5MjQ4", "avatar_url": "https://avatars2.githubusercontent.com/u/29709248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adamAlnatsheh", "html_url": "https://github.com/adamAlnatsheh", "followers_url": "https://api.github.com/users/adamAlnatsheh/followers", "following_url": "https://api.github.com/users/adamAlnatsheh/following{/other_user}", "gists_url": "https://api.github.com/users/adamAlnatsheh/gists{/gist_id}", "starred_url": "https://api.github.com/users/adamAlnatsheh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adamAlnatsheh/subscriptions", "organizations_url": "https://api.github.com/users/adamAlnatsheh/orgs", "repos_url": "https://api.github.com/users/adamAlnatsheh/repos", "events_url": "https://api.github.com/users/adamAlnatsheh/events{/privacy}", "received_events_url": "https://api.github.com/users/adamAlnatsheh/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-08-20T22:16:36Z", "updated_at": "2020-02-08T01:11:59Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nNo\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\nWindows 10\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\nN/A\r\n- **TensorFlow installed from (source or binary)**:\r\nbinary: https://storage.googleapis.com/tensorflow/libtensorflow/libtensorflow-cpu-windows-x86_64-1.10.0.zip\r\n- **TensorFlow version (use command below)**:\r\n1.10.0\r\n- **Python version**:\r\n3.6.5\r\n- **Bazel version (if compiling from source)**:\r\nN/A\r\n- **GCC/Compiler version (if compiling from source)**:\r\nMSVC 14.15\r\n- **CUDA/cuDNN version**:\r\nN/A\r\n- **GPU model and memory**:\r\nN/A\r\n- **Exact command to reproduce**:\r\ndescribed below\r\n\r\n### Describe the problem\r\nI am trying to load and run a graph with contrib ops (specifically lstm ops) trained in python via the C API. On Linux and Mac, I am able to do this using `TF_LoadLibrary` and the `_lstm_ops.so` from the python wheel. However, doing the same on Windows yields an error status `<path to _lstm_ops.dll> not found`, and I am sure I entered the global path correctly (and thus am confused why the error seems to be with finding the library itself, not with registering the ops).  Is there something I am missing? Any tips/suggestions someone can provide?\r\n\r\nFurther, is there a better/more supported way of doing this in general?\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21737", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21737/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21737/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21737/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21737", "id": 352190346, "node_id": "MDU6SXNzdWUzNTIxOTAzNDY=", "number": 21737, "title": "Population Based training with tf.Estimator", "user": {"login": "agniszczotka", "id": 25079800, "node_id": "MDQ6VXNlcjI1MDc5ODAw", "avatar_url": "https://avatars0.githubusercontent.com/u/25079800?v=4", "gravatar_id": "", "url": "https://api.github.com/users/agniszczotka", "html_url": "https://github.com/agniszczotka", "followers_url": "https://api.github.com/users/agniszczotka/followers", "following_url": "https://api.github.com/users/agniszczotka/following{/other_user}", "gists_url": "https://api.github.com/users/agniszczotka/gists{/gist_id}", "starred_url": "https://api.github.com/users/agniszczotka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/agniszczotka/subscriptions", "organizations_url": "https://api.github.com/users/agniszczotka/orgs", "repos_url": "https://api.github.com/users/agniszczotka/repos", "events_url": "https://api.github.com/users/agniszczotka/events{/privacy}", "received_events_url": "https://api.github.com/users/agniszczotka/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2018-08-20T15:39:34Z", "updated_at": "2019-02-01T11:12:17Z", "closed_at": null, "author_association": "NONE", "body": "OS Platform and Distribution N/A\r\nTensorFlow installed from N/A\r\nTensorFlow version 1.10\r\nBazel version N/A\r\nCUDA/cuDNN version N/A\r\nGPU model and memory N/A\r\nExact command to reproduce N/A\r\nMobile device N/A\r\n\r\nFeature request:\r\n\r\nCan you implement population-based training with tf.Estimator? \r\nhttps://deepmind.com/blog/population-based-training-neural-networks/"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21730", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21730/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21730/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21730/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21730", "id": 352058046, "node_id": "MDU6SXNzdWUzNTIwNTgwNDY=", "number": 21730, "title": "The Hessian computation does not work for graphs using `tf.gather`.", "user": {"login": "rwolst", "id": 3892689, "node_id": "MDQ6VXNlcjM4OTI2ODk=", "avatar_url": "https://avatars2.githubusercontent.com/u/3892689?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rwolst", "html_url": "https://github.com/rwolst", "followers_url": "https://api.github.com/users/rwolst/followers", "following_url": "https://api.github.com/users/rwolst/following{/other_user}", "gists_url": "https://api.github.com/users/rwolst/gists{/gist_id}", "starred_url": "https://api.github.com/users/rwolst/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rwolst/subscriptions", "organizations_url": "https://api.github.com/users/rwolst/orgs", "repos_url": "https://api.github.com/users/rwolst/repos", "events_url": "https://api.github.com/users/rwolst/events{/privacy}", "received_events_url": "https://api.github.com/users/rwolst/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-08-20T09:41:10Z", "updated_at": "2019-01-25T22:14:06Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes.\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16.04.\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**: Binary.\r\n- **TensorFlow version (use command below)**: v1.4.0-19-ga52c8d9 1.4.1\r\n- **Python version**: '3.6.5 (default, Mar 29 2018, 03:28:50) \\n[GCC 5.4.0 20160609]'\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**:\r\n- **GPU model and memory**:\r\n- **Exact command to reproduce**:\r\n\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\ntheta = tf.get_variable('theta', shape=[10], dtype=tf.float32, initializer=tf.zeros_initializer)\r\nindices = tf.placeholder(tf.int64, shape=(None, 3))\r\nY = tf.gather(theta, indices)\r\nloss = tf.reduce_sum(tf.square(Y))\r\ngrads = tf.gradients(loss, theta)\r\nwith tf.Session() as sess:\r\n   print(sess.run(grads, feed_dict={theta: np.arange(10), indices: np.array([[1,3,6], [2,4,5]])}))\r\n\r\nhess = tf.hessians(loss, theta)\r\nwith tf.Session() as sess:\r\n   print(sess.run(hess, feed_dict={theta: np.arange(10), indices: np.array([[1,3,6], [2,4,5]])}))\r\n```\r\n\r\n### Describe the problem\r\nWhen trying to compute Hessians with a graph that uses `tf.gather`, it throws a `TypeError: 'IndexedSlices' object is not subscriptable`. This I believe is because the gradients are returned as `IndexedSlice` objects whereas Tensorflow is expecting them to be a normal array.\r\n\r\nWhat I would expect is a sort of 2D `IndexedSlice` object for `hess` such that `hess.values[i, j]` is the second partial derivative of `loss` with respect to the `theta` indices `hess.indices[i]` and `hess.indices[j]`.\r\n\r\n### Source code / logs\r\nThe traceback:\r\n\r\n```TypeError                                 Traceback (most recent call last)\r\n<ipython-input-11-b8b35a8e0799> in <module>()\r\n----> 1 hess = tf.hessians(loss, theta)\r\n\r\n~/Documents/Ravenholm/citadel/citadel_env/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py in hessians(ys, xs, name, colocate_gradients_with_ops, gate_gradients, aggregation_method)\r\n    999           lambda j, result: (j + 1,\r\n   1000                              result.write(j, gradients(_gradient[j], x)[0])),\r\n-> 1001           loop_vars\r\n   1002       )\r\n   1003 \r\n\r\n~/Documents/Ravenholm/citadel/citadel_env/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py in while_loop(cond, body, loop_vars, shape_invariants, parallel_iterations, back_prop, swap_memory, name)\r\n   2814     loop_context = WhileContext(parallel_iterations, back_prop, swap_memory)  # pylint: disable=redefined-outer-name\r\n   2815     ops.add_to_collection(ops.GraphKeys.WHILE_CONTEXT, loop_context)\r\n-> 2816     result = loop_context.BuildLoop(cond, body, loop_vars, shape_invariants)\r\n   2817     return result\r\n   2818 \r\n\r\n~/Documents/Ravenholm/citadel/citadel_env/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py in BuildLoop(self, pred, body, loop_vars, shape_invariants)\r\n   2638       self.Enter()\r\n   2639       original_body_result, exit_vars = self._BuildLoop(\r\n-> 2640           pred, body, original_loop_vars, loop_vars, shape_invariants)\r\n   2641     finally:\r\n   2642       self.Exit()\r\n\r\n~/Documents/Ravenholm/citadel/citadel_env/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py in _BuildLoop(self, pred, body, original_loop_vars, loop_vars, shape_invariants)\r\n   2588         structure=original_loop_vars,\r\n   2589         flat_sequence=vars_for_body_with_tensor_arrays)\r\n-> 2590     body_result = body(*packed_vars_for_body)\r\n   2591     if not nest.is_sequence(body_result):\r\n   2592       body_result = [body_result]\r\n\r\n~/Documents/Ravenholm/citadel/citadel_env/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py in <lambda>(j, result)\r\n    998           lambda j, _: j < n,\r\n    999           lambda j, result: (j + 1,\r\n-> 1000                              result.write(j, gradients(_gradient[j], x)[0])),\r\n   1001           loop_vars\r\n   1002       )\r\n\r\nTypeError: 'IndexedSlices' object is not subscriptable\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21724", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21724/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21724/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21724/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21724", "id": 351966075, "node_id": "MDU6SXNzdWUzNTE5NjYwNzU=", "number": 21724, "title": "[license] fft2d's license is overly short and provides no enough declaration", "user": {"login": "cdluminate", "id": 5723047, "node_id": "MDQ6VXNlcjU3MjMwNDc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5723047?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cdluminate", "html_url": "https://github.com/cdluminate", "followers_url": "https://api.github.com/users/cdluminate/followers", "following_url": "https://api.github.com/users/cdluminate/following{/other_user}", "gists_url": "https://api.github.com/users/cdluminate/gists{/gist_id}", "starred_url": "https://api.github.com/users/cdluminate/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cdluminate/subscriptions", "organizations_url": "https://api.github.com/users/cdluminate/orgs", "repos_url": "https://api.github.com/users/cdluminate/repos", "events_url": "https://api.github.com/users/cdluminate/events{/privacy}", "received_events_url": "https://api.github.com/users/cdluminate/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false, "description": ""}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "martinwicke", "id": 577277, "node_id": "MDQ6VXNlcjU3NzI3Nw==", "avatar_url": "https://avatars2.githubusercontent.com/u/577277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martinwicke", "html_url": "https://github.com/martinwicke", "followers_url": "https://api.github.com/users/martinwicke/followers", "following_url": "https://api.github.com/users/martinwicke/following{/other_user}", "gists_url": "https://api.github.com/users/martinwicke/gists{/gist_id}", "starred_url": "https://api.github.com/users/martinwicke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martinwicke/subscriptions", "organizations_url": "https://api.github.com/users/martinwicke/orgs", "repos_url": "https://api.github.com/users/martinwicke/repos", "events_url": "https://api.github.com/users/martinwicke/events{/privacy}", "received_events_url": "https://api.github.com/users/martinwicke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "martinwicke", "id": 577277, "node_id": "MDQ6VXNlcjU3NzI3Nw==", "avatar_url": "https://avatars2.githubusercontent.com/u/577277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/martinwicke", "html_url": "https://github.com/martinwicke", "followers_url": "https://api.github.com/users/martinwicke/followers", "following_url": "https://api.github.com/users/martinwicke/following{/other_user}", "gists_url": "https://api.github.com/users/martinwicke/gists{/gist_id}", "starred_url": "https://api.github.com/users/martinwicke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/martinwicke/subscriptions", "organizations_url": "https://api.github.com/users/martinwicke/orgs", "repos_url": "https://api.github.com/users/martinwicke/repos", "events_url": "https://api.github.com/users/martinwicke/events{/privacy}", "received_events_url": "https://api.github.com/users/martinwicke/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2018-08-20T02:44:27Z", "updated_at": "2018-12-19T18:48:16Z", "closed_at": null, "author_association": "NONE", "body": "In order to create tensorflow package for linux distributions, the distributions maintainers need to make sure the software being redistributed are free software. While looking into TensorFlow's dependencies, I found fft2d's license very confusing because it doesn't provide enough detail.\r\n\r\nhttps://github.com/tensorflow/tensorflow/blob/master/third_party/fft2d/LICENSE\r\n\r\nI raised a discussion in Debian's legal mailing list https://lists.debian.org/debian-legal/2018/08/msg00005.html , and the two follow-ups said the fft2d license is missing the right to distribute modified code. If modified fft2d indeed cannot be redistributed, then fft2d cannot be considered as a free software.\r\n\r\nApart from that, is it possible to build TensorFlow without fft2d with sensible change to the build system? I haven't looked into the code yet."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21675", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21675/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21675/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21675/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21675", "id": 351521728, "node_id": "MDU6SXNzdWUzNTE1MjE3Mjg=", "number": 21675, "title": "op type not registered 'DenseToDenseSetOperation' when running tfcompile", "user": {"login": "mehditlili", "id": 7859307, "node_id": "MDQ6VXNlcjc4NTkzMDc=", "avatar_url": "https://avatars1.githubusercontent.com/u/7859307?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mehditlili", "html_url": "https://github.com/mehditlili", "followers_url": "https://api.github.com/users/mehditlili/followers", "following_url": "https://api.github.com/users/mehditlili/following{/other_user}", "gists_url": "https://api.github.com/users/mehditlili/gists{/gist_id}", "starred_url": "https://api.github.com/users/mehditlili/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mehditlili/subscriptions", "organizations_url": "https://api.github.com/users/mehditlili/orgs", "repos_url": "https://api.github.com/users/mehditlili/repos", "events_url": "https://api.github.com/users/mehditlili/events{/privacy}", "received_events_url": "https://api.github.com/users/mehditlili/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "drpngx", "id": 20959853, "node_id": "MDQ6VXNlcjIwOTU5ODUz", "avatar_url": "https://avatars1.githubusercontent.com/u/20959853?v=4", "gravatar_id": "", "url": "https://api.github.com/users/drpngx", "html_url": "https://github.com/drpngx", "followers_url": "https://api.github.com/users/drpngx/followers", "following_url": "https://api.github.com/users/drpngx/following{/other_user}", "gists_url": "https://api.github.com/users/drpngx/gists{/gist_id}", "starred_url": "https://api.github.com/users/drpngx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/drpngx/subscriptions", "organizations_url": "https://api.github.com/users/drpngx/orgs", "repos_url": "https://api.github.com/users/drpngx/repos", "events_url": "https://api.github.com/users/drpngx/events{/privacy}", "received_events_url": "https://api.github.com/users/drpngx/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "drpngx", "id": 20959853, "node_id": "MDQ6VXNlcjIwOTU5ODUz", "avatar_url": "https://avatars1.githubusercontent.com/u/20959853?v=4", "gravatar_id": "", "url": "https://api.github.com/users/drpngx", "html_url": "https://github.com/drpngx", "followers_url": "https://api.github.com/users/drpngx/followers", "following_url": "https://api.github.com/users/drpngx/following{/other_user}", "gists_url": "https://api.github.com/users/drpngx/gists{/gist_id}", "starred_url": "https://api.github.com/users/drpngx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/drpngx/subscriptions", "organizations_url": "https://api.github.com/users/drpngx/orgs", "repos_url": "https://api.github.com/users/drpngx/repos", "events_url": "https://api.github.com/users/drpngx/events{/privacy}", "received_events_url": "https://api.github.com/users/drpngx/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2018-08-17T09:25:15Z", "updated_at": "2019-10-10T06:21:14Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes (code from maskrcnn, and export.py to freeze my model)\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: Laptop\r\n- **TensorFlow installed from (source or binary)**: Source\r\n- **TensorFlow version (use command below)**: ('v1.9.0-rc2-2314-g3a99980', '1.10.0')\r\n- **Python version**: 2.7\r\n- **Bazel version (if compiling from source)**: 0.16.1\r\n- **GCC/Compiler version (if compiling from source)**: 5.4.0 20160609\r\n- **CUDA/cuDNN version**: no cuda\r\n- **GPU model and memory**:  Geforce GT 730M, 1Gb memory\r\n- **Exact command to reproduce**: \r\n\r\n`bazel-bin/tensorflow/compiler/aot/tfcompile --graph=/home/mehdi/Desktop/data/resnet101_model.pb --config=/home/mehdi/Desktop/data/config.pbtxt --cpp_class=\"foo::bar\" --out_function_object=\"./out_model.o\" --out_header=\"./out.h\" --out_metadata_object=\"./out_helper.o\"`\r\n\r\nI have been testing [mask rcnn](https://github.com/matterport/Mask_RCNN) in order to do object detection and segmentation on images. It worked quite well and now I am trying to export my model to a standalone binary that can be used without having to install tensorflow on my target system. In order to do this I tried to use tfcompile. The first step was to take my .h5 keras model and converted it to a frozen tf .pb file. I used [this script](https://github.com/ericj974/Mask_RCNN/blob/master/scripts/export.py) that was especially written to convert mask rcnn models. I then downloaded the source code of tensorflow, compiled it by running\r\n\r\n`bazel build --config=opt //tensorflow/tools/pip_package:build_pip_package --jobs 3`\r\n\r\nbefore that, I set support XLA JIT to true when running configure.\r\nAfter compilation was done I installed tensorflow and it was importable from python.\r\n\r\nThen in order to compile my model I run:\r\n`bazel-bin/tensorflow/compiler/aot/tfcompile --graph=/home/mehdi/Desktop/data/resnet101_model.pb --config=/home/mehdi/Desktop/data/config.pbtxt --cpp_class=\"foo::bar\" --out_function_object=\"./out_model.o\" --out_header=\"./out.h\" --out_metadata_object=\"./out_helper.o\"`\r\n\r\nwhere resnet101_model.pb is the result of running export.py on my keras .h5 model.\r\nconfig.pgtxt is as follows:\r\n\r\n```\r\n# Each feed is a positional input argument for the generated function.  The order\r\n# of each entry matches the order of each input argument.  Here \u201cx_hold\u201d and \u201cy_hold\u201d\r\n# refer to the names of placeholder nodes defined in the graph.\r\nfeed {\r\n  id { node_name: \"input_image\" }\r\n  shape {\r\n    dim { size: 320 }\r\n    dim { size: 320 }\r\n    dim { size: 4 }\r\n  }\r\n}\r\n\r\n# Each fetch is a positional output argument for the generated function.  The order\r\n# of each entry matches the order of each output argument.  Here \u201cx_y_prod\u201d\r\n# refers to the name of a matmul node defined in the graph.\r\nfetch {\r\n  id { node_name: \"mrcnn_mask/Reshape_1\" }\r\n}\r\n```\r\n\r\nUnfortunately I can't upload my model as Github only allows 10Mb. But [here](https://github.com/matterport/Mask_RCNN/releases) is a similar model trained on the same network  (mask_rcnn_balloon.h5)\r\n\r\ntfcompile fails with the following error:\r\n\r\n`2018-08-16 12:38:27.078016: F tensorflow/compiler/aot/tfcompile_main.cc:150] Non-OK-status: status status: Not found: Op type not registered 'DenseToDenseSetOperation' in binary running on mehdi-t440p. Make sure the Op and Kernel are registered in the binary running in this process. Note that if you are loading a saved graph which used ops from tf.contrib, accessing (e.g.) tf.contrib.resampler should be done before importing the graph, as contrib ops are lazily registered when the module is first accessed. Aborted`\r\n\r\nThis is difficult to understand for me as DenseToDenseSetIOperation is existing and registered in tensorflow/core/ops/set_ops.cc (line 35).\r\nI searched for tutorials or documentation, even watched the video presentation made by tensorflow guys, but there is no troubleshooting support anywhere. So I thought Github is the right place for this kind of problem.\r\n\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21673", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21673/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21673/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21673/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21673", "id": 351487461, "node_id": "MDU6SXNzdWUzNTE0ODc0NjE=", "number": 21673, "title": "Feature Request: make grid image summary adapt to different channel number", "user": {"login": "AtlantixJJ", "id": 20163080, "node_id": "MDQ6VXNlcjIwMTYzMDgw", "avatar_url": "https://avatars1.githubusercontent.com/u/20163080?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AtlantixJJ", "html_url": "https://github.com/AtlantixJJ", "followers_url": "https://api.github.com/users/AtlantixJJ/followers", "following_url": "https://api.github.com/users/AtlantixJJ/following{/other_user}", "gists_url": "https://api.github.com/users/AtlantixJJ/gists{/gist_id}", "starred_url": "https://api.github.com/users/AtlantixJJ/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AtlantixJJ/subscriptions", "organizations_url": "https://api.github.com/users/AtlantixJJ/orgs", "repos_url": "https://api.github.com/users/AtlantixJJ/repos", "events_url": "https://api.github.com/users/AtlantixJJ/events{/privacy}", "received_events_url": "https://api.github.com/users/AtlantixJJ/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tatianashp", "id": 986732, "node_id": "MDQ6VXNlcjk4NjczMg==", "avatar_url": "https://avatars2.githubusercontent.com/u/986732?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatianashp", "html_url": "https://github.com/tatianashp", "followers_url": "https://api.github.com/users/tatianashp/followers", "following_url": "https://api.github.com/users/tatianashp/following{/other_user}", "gists_url": "https://api.github.com/users/tatianashp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatianashp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatianashp/subscriptions", "organizations_url": "https://api.github.com/users/tatianashp/orgs", "repos_url": "https://api.github.com/users/tatianashp/repos", "events_url": "https://api.github.com/users/tatianashp/events{/privacy}", "received_events_url": "https://api.github.com/users/tatianashp/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tatianashp", "id": 986732, "node_id": "MDQ6VXNlcjk4NjczMg==", "avatar_url": "https://avatars2.githubusercontent.com/u/986732?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatianashp", "html_url": "https://github.com/tatianashp", "followers_url": "https://api.github.com/users/tatianashp/followers", "following_url": "https://api.github.com/users/tatianashp/following{/other_user}", "gists_url": "https://api.github.com/users/tatianashp/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatianashp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatianashp/subscriptions", "organizations_url": "https://api.github.com/users/tatianashp/orgs", "repos_url": "https://api.github.com/users/tatianashp/repos", "events_url": "https://api.github.com/users/tatianashp/events{/privacy}", "received_events_url": "https://api.github.com/users/tatianashp/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-08-17T07:31:14Z", "updated_at": "2019-01-25T22:07:21Z", "closed_at": null, "author_association": "NONE", "body": "- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nYes.\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\nLinux Ubuntu 16.04\r\n- **TensorFlow installed from (source or binary)**:\r\nBinary\r\n- **TensorFlow version (use command below)**:\r\n1.10.0\r\n- **Python version**:\r\n3.6\r\n- **Bazel version**:\r\nN/A\r\n- **CUDA/cuDNN version**:\r\nN/A\r\n- **GPU model and memory**:\r\nN/A\r\n- **Exact command to reproduce**:\r\nN/A\r\n- **Mobile device**:\r\nN/A\r\n\r\n### Describe the problem\r\n\r\nIn image-to-image translation, sometimes we need to transform a grey image to a colored one and vice versa. In this case, image summary need to concatenate different images with different number of channels together. In tensorflow.contrib.gan standard library, this will produce a bug.\r\n\r\nI request to add an automatic mechanism to complete image channel, e.g. tile up gery image to have 3 channels. It's quite simple, and I write a workaround code. Hope this can help you add this feature.\r\n\r\n### Source code / logs\r\n\r\nFirst, a compulsory function for converting channel number. Notice it's input is a 3D image (H, W, C).\r\n\r\n```python\r\ndef convert_channel(image):\r\n  H, W = image.get_shape()[:2]\r\n  image = array_ops.tile(image, [1, 1, math_ops.maximum(1, 4 - array_ops.shape(image)[2])])\r\n  image = array_ops.slice(image, [0, 0, 0], [H, W, 3])\r\n  return image\r\n```\r\n\r\nSecond, apply this before any concatenation of image summary.\r\n\r\nThank you.\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21670", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21670/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21670/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21670/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21670", "id": 351472385, "node_id": "MDU6SXNzdWUzNTE0NzIzODU=", "number": 21670, "title": "freeze_graph returns with error", "user": {"login": "roche-k", "id": 36398146, "node_id": "MDQ6VXNlcjM2Mzk4MTQ2", "avatar_url": "https://avatars0.githubusercontent.com/u/36398146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/roche-k", "html_url": "https://github.com/roche-k", "followers_url": "https://api.github.com/users/roche-k/followers", "following_url": "https://api.github.com/users/roche-k/following{/other_user}", "gists_url": "https://api.github.com/users/roche-k/gists{/gist_id}", "starred_url": "https://api.github.com/users/roche-k/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/roche-k/subscriptions", "organizations_url": "https://api.github.com/users/roche-k/orgs", "repos_url": "https://api.github.com/users/roche-k/repos", "events_url": "https://api.github.com/users/roche-k/events{/privacy}", "received_events_url": "https://api.github.com/users/roche-k/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586558, "node_id": "MDU6TGFiZWw0MDQ1ODY1NTg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:community%20support", "name": "stat:community support", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-08-17T06:26:54Z", "updated_at": "2019-01-25T22:06:36Z", "closed_at": null, "author_association": "NONE", "body": "I used `bazel-bin/tensorflow/python/tools/freeze_graph` to freeze my graph. This program complied with bazel several minutes ago.\r\nBut this returns with error:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/roche/git/download/tensorflow-1.10.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/tools/freeze_graph.py\", line 48, in <module>\r\n    from tensorflow.python import pywrap_tensorflow\r\n  File \"/home/roche/git/download/tensorflow-1.10.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/__init__.py\", line 63, in <module>\r\n    from tensorflow.python.framework.framework_lib import *  # pylint: disable=redefined-builtin\r\n  File \"/home/roche/git/download/tensorflow-1.10.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/framework/framework_lib.py\", line 52, in <module>\r\n    from tensorflow.python.framework.importer import import_graph_def\r\n  File \"/home/roche/git/download/tensorflow-1.10.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/framework/importer.py\", line 27, in <module>\r\n    from tensorflow.python.framework import function\r\n  File \"/home/roche/git/download/tensorflow-1.10.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/framework/function.py\", line 39, in <module>\r\n    from tensorflow.python.ops import variable_scope as vs\r\n  File \"/home/roche/git/download/tensorflow-1.10.0/bazel-bin/tensorflow/python/tools/freeze_graph.runfiles/org_tensorflow/tensorflow/python/ops/variable_scope.py\", line 181, in <module>\r\n    class _ReuseMode(enum.Enum):\r\nNameError: name 'enum' is not defined\r\n```\r\n\r\nHere's my environment specification:\r\nSys:Debian 9.5\r\npython:python 3.5.3\r\nTensorflow: tensorflow (1.10.0) from pip3\r\nbazel:0.16.1\r\ngcc:gcc (Debian 6.3.0-18+deb9u1) 6.3.0 20170516\r\n\r\ntensorflow souce code from 1.10.0 release.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21653", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21653/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21653/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21653/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21653", "id": 351139262, "node_id": "MDU6SXNzdWUzNTExMzkyNjI=", "number": 21653, "title": "Endless restarting of session when run distribute traning with tensorflow 1.8", "user": {"login": "SharkWater", "id": 37606610, "node_id": "MDQ6VXNlcjM3NjA2NjEw", "avatar_url": "https://avatars0.githubusercontent.com/u/37606610?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SharkWater", "html_url": "https://github.com/SharkWater", "followers_url": "https://api.github.com/users/SharkWater/followers", "following_url": "https://api.github.com/users/SharkWater/following{/other_user}", "gists_url": "https://api.github.com/users/SharkWater/gists{/gist_id}", "starred_url": "https://api.github.com/users/SharkWater/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SharkWater/subscriptions", "organizations_url": "https://api.github.com/users/SharkWater/orgs", "repos_url": "https://api.github.com/users/SharkWater/repos", "events_url": "https://api.github.com/users/SharkWater/events{/privacy}", "received_events_url": "https://api.github.com/users/SharkWater/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-08-16T10:06:39Z", "updated_at": "2019-06-24T22:30:26Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Red Hat 4.8.5-4\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: Not applicable\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: r1.8\r\n- **Python version**: 2.7.5\r\n- **Bazel version (if compiling from source)**: 0.5.4\r\n- **GCC/Compiler version (if compiling from source)**: 4.9.2\r\n- **CUDA/cuDNN version**: 9.0\r\n- **GPU model and memory**: M40 11448MiB\r\n- **Exact command to reproduce**:\r\n```\r\nCleanup partition error: Unavailable: OS Error\r\n```\r\n\r\n### Descripe problem\r\nTraining the same model with tensorflow r1.4 is OK. With tensorflow r1.8, the session restarts without stop at the end of training. I have checked the traning log. Some workers went wrong when clearing partition. This error caused session restarting. But at this time, the other workers have alreadly stopped running. Thus, the restarting workers went wrong with master init error and start another session restarting progress.\r\n\r\n### Logs\r\n```\r\n### End of Training\r\n[2018-08-16 14:54:54.279 193 master_session.cc:1754] [ERROR] Cleanup partition error: Unavailable: OS Error\r\n[2018-08-16 14:54:54.282 tf_logging.py:126] [WARNING] An error was raised. This may be due to a preemption in a connected worker or parameter server. The current session will be closed and a new session will be created. Error: OS Error\r\n[2018-08-16 14:54:55.281 193 master_session.cc:1754] [ERROR] Cleanup partition error: Unavailable: OS Error\r\n[2018-08-16 14:54:55.333 tf_logging.py:116] [INFO] Graph was finalized.\r\n[2018-08-16 14:54:55.404 tf_logging.py:116] [INFO] Restoring parameters from hdfs://...\r\n[2018-08-16 14:54:56.288 193 master.cc:284] [ERROR] Master init: Unavailable: OS Error\r\n[2018-08-16 14:54:56.288 193 master_session.cc:1017] [INFO] DeregisterGraph error: Unavailable: OS Error\r\n[2018-08-16 14:54:56.288 193 master_session.cc:1017] [INFO] DeregisterGraph error: Unavailable: OS Error\r\n[2018-08-16 14:54:56.288 193 master_session.cc:1017] [INFO] DeregisterGraph error: Unavailable: OS Error\r\n[2018-08-16 14:55:05.450 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:2\r\n[2018-08-16 14:55:05.450 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:3\r\n[2018-08-16 14:55:05.450 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:4\r\n[2018-08-16 14:55:05.450 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:6\r\n[2018-08-16 14:55:05.450 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:7\r\n[2018-08-16 14:55:15.450 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:2\r\n[2018-08-16 14:55:15.450 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:3\r\n[2018-08-16 14:55:15.450 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:4\r\n[2018-08-16 14:55:15.450 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:6\r\n[2018-08-16 14:55:15.450 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:7\r\n[2018-08-16 14:55:16.451 196 master.cc:284] [ERROR] Master init: Unavailable: OS Error\r\n[2018-08-16 14:55:25.451 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:2\r\n[2018-08-16 14:55:25.451 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:3\r\n[2018-08-16 14:55:25.451 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:6\r\n[2018-08-16 14:55:25.451 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:7\r\n[2018-08-16 14:55:35.451 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:2\r\n[2018-08-16 14:55:35.451 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:3\r\n[2018-08-16 14:55:35.451 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:6\r\n[2018-08-16 14:55:35.451 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:7\r\n[2018-08-16 14:55:44.452 195 master.cc:284] [ERROR] Master init: Unavailable: OS Error\r\n[2018-08-16 14:55:45.451 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:2\r\n[2018-08-16 14:55:45.451 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:6\r\n[2018-08-16 14:55:45.451 4571 master.cc:236] [INFO] CreateSession still waiting for response from worker: /job:worker/replica:0/task:7\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21647", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21647/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21647/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21647/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21647", "id": 351048294, "node_id": "MDU6SXNzdWUzNTEwNDgyOTQ=", "number": 21647, "title": "ValueError: Attempted to map inputs that were not found in graph_def: [input:0]", "user": {"login": "NylaWorker", "id": 25090956, "node_id": "MDQ6VXNlcjI1MDkwOTU2", "avatar_url": "https://avatars2.githubusercontent.com/u/25090956?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NylaWorker", "html_url": "https://github.com/NylaWorker", "followers_url": "https://api.github.com/users/NylaWorker/followers", "following_url": "https://api.github.com/users/NylaWorker/following{/other_user}", "gists_url": "https://api.github.com/users/NylaWorker/gists{/gist_id}", "starred_url": "https://api.github.com/users/NylaWorker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NylaWorker/subscriptions", "organizations_url": "https://api.github.com/users/NylaWorker/orgs", "repos_url": "https://api.github.com/users/NylaWorker/repos", "events_url": "https://api.github.com/users/NylaWorker/events{/privacy}", "received_events_url": "https://api.github.com/users/NylaWorker/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1105108936, "node_id": "MDU6TGFiZWwxMTA1MTA4OTM2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:model", "name": "comp:model", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "asimshankar", "id": 16018, "node_id": "MDQ6VXNlcjE2MDE4", "avatar_url": "https://avatars2.githubusercontent.com/u/16018?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asimshankar", "html_url": "https://github.com/asimshankar", "followers_url": "https://api.github.com/users/asimshankar/followers", "following_url": "https://api.github.com/users/asimshankar/following{/other_user}", "gists_url": "https://api.github.com/users/asimshankar/gists{/gist_id}", "starred_url": "https://api.github.com/users/asimshankar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asimshankar/subscriptions", "organizations_url": "https://api.github.com/users/asimshankar/orgs", "repos_url": "https://api.github.com/users/asimshankar/repos", "events_url": "https://api.github.com/users/asimshankar/events{/privacy}", "received_events_url": "https://api.github.com/users/asimshankar/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "asimshankar", "id": 16018, "node_id": "MDQ6VXNlcjE2MDE4", "avatar_url": "https://avatars2.githubusercontent.com/u/16018?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asimshankar", "html_url": "https://github.com/asimshankar", "followers_url": "https://api.github.com/users/asimshankar/followers", "following_url": "https://api.github.com/users/asimshankar/following{/other_user}", "gists_url": "https://api.github.com/users/asimshankar/gists{/gist_id}", "starred_url": "https://api.github.com/users/asimshankar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asimshankar/subscriptions", "organizations_url": "https://api.github.com/users/asimshankar/orgs", "repos_url": "https://api.github.com/users/asimshankar/repos", "events_url": "https://api.github.com/users/asimshankar/events{/privacy}", "received_events_url": "https://api.github.com/users/asimshankar/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2018-08-16T04:07:51Z", "updated_at": "2019-01-25T22:05:31Z", "closed_at": null, "author_association": "NONE", "body": "Hello! \r\n\r\nI have asked this question in stackoverflow but at this point it merits a long post. \r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nNo\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\n Linux Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\nNA\r\n- **TensorFlow installed from (source or binary)**:\r\npip \r\n- **TensorFlow version (use command below)**:\r\n1.8\r\n- **Python version**:\r\nPython 2.7.12\r\n- **Bazel version (if compiling from source)**:\r\nNA\r\n- **GCC/Compiler version (if compiling from source)**:\r\nNA\r\n- **CUDA/cuDNN version**:\r\n9.2\r\n- **GPU model and memory**:\r\n 7611MiB (gpu nvidia p4)\r\n- **Exact command to reproduce**:\r\n`ValueError: Attempted to map inputs that were not found in graph_def: [input:0]`\r\n\r\n\r\n### Describe the problem\r\nTrying to create a frozen graph, technically succeeding at doing that but then unable to run it. I am unsure about what the tags do. I want to use the model for inference,  but wasn't able to load it in a frozen graph in training and serving mode.  I suppose I have to restore the session? the documentation does not show that. And I double checked my output node's name is softmax. I saw the frozen graph in tensorboard and looks fine, but does not load into the graph. Help? I found people with issues like this but none resolved or their issues I already fixed in my code.\r\n\r\n### Source code / logs\r\nThis is the code to freeze from and not frozen  .pb file and its variables. \r\n```\r\nimport tensorflow as tf\r\nexport_dir='../catmod'\r\nwith tf.Session(graph=tf.Graph()) as sess:\r\n    # I have not been able to find how the tags affect this. Does training work? I tried as well with serve\r\n    # serve gave the same error of input:0  * I checked with saved_model_cli\r\n    tf.saved_model.loader.load(sess, [tf.saved_model.tag_constants.TRAINING], export_dir)\r\n    output_graph = \"frozen_graph.pb\" \r\n    # changing nodes from refswitch to switch then moving it accordingly \r\n    for node in gd.node:\r\n        if node.op == 'RefSwitch':\r\n            node.op = 'Switch'\r\n            for index in xrange(len(node.input)):\r\n                if 'moving_' in node.input[index]:\r\n                    node.input[index] = node.input[index] + '/read'\r\n        elif node.op == 'AssignSub':\r\n            node.op = 'Sub'\r\n            if 'use_locking' in node.attr: del node.attr['use_locking']\r\n    gd = sess.graph.as_graph_def()\r\n    output_nodes=['softmax']\r\n    output_graph_def = tf.graph_util.convert_variables_to_constants(\r\n       sess, # The session is used to retrieve the weights\r\n       gd,\r\n       output_nodes# The output node names are used to select the usefull nodes\r\n    )\r\n\r\n\r\n\r\n    # Finally we serialize and dump the output graph to the filesystem\r\n    with tf.gfile.GFile(output_graph, \"wb\") as f:\r\n        f.write(output_graph_def.SerializeToString())\r\nsess.close()\r\n\r\n\r\n```\r\nThis code is functional as I have used it with pre-frozen graphs.  (parts of) Code to load the frozen graph which I used with other frozen graphs that I got from the internet:\r\n\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\nfrom tensorflow.python.platform import gfile\r\nfrom tensorflow.python.client import timeline\r\nfrom tensorflow.python.util import compat\r\n\r\n### Loading the model \r\n\r\ndef getModel(pb_frozen):\r\n    with gfile.FastGFile(pb_frozen,'rb') as f:\r\n        graph_def = tf.GraphDef()\r\n        graph_def.ParseFromString(f.read())\r\n    return graph_def\r\n\r\n# Running the model \r\ntf.logging.info(\"Starting execution\")\r\n\r\ngpu_options = tf.GPUOptions(per_process_gpu_memory_fraction=0.50)\r\ntf.reset_default_graph()\r\n\r\ng = tf.Graph()\r\n\r\ndummy_input = np.random.random_sample((batch_size,224,224,3))\r\noutlist=[]\r\n# creating the graph \r\nwith g.as_default():\r\n    inc=tf.constant(dummy_input, dtype=tf.float32)\r\n    dataset=tf.data.Dataset.from_tensors(inc)\r\n    dataset=dataset.repeat()\r\n    iterator=dataset.make_one_shot_iterator()\r\n    next_element=iterator.get_next()\r\n    out = tf.import_graph_def(\r\n      graph_def=  getModel(pb_frozen), # loading graph \r\n      input_map={\"input\":next_element},\r\n      return_elements=['dense/bias']\r\n    )\r\n    out = out[0].outputs[0]\r\n    outlist.append(out)\r\n\r\n``` \r\nAnd then is run in a session. \r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21644", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21644/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21644/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21644/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21644", "id": 351038237, "node_id": "MDU6SXNzdWUzNTEwMzgyMzc=", "number": 21644, "title": "Not found: FeedInputs: unable to find feed output phase_train", "user": {"login": "cvJie", "id": 31844043, "node_id": "MDQ6VXNlcjMxODQ0MDQz", "avatar_url": "https://avatars0.githubusercontent.com/u/31844043?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cvJie", "html_url": "https://github.com/cvJie", "followers_url": "https://api.github.com/users/cvJie/followers", "following_url": "https://api.github.com/users/cvJie/following{/other_user}", "gists_url": "https://api.github.com/users/cvJie/gists{/gist_id}", "starred_url": "https://api.github.com/users/cvJie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cvJie/subscriptions", "organizations_url": "https://api.github.com/users/cvJie/orgs", "repos_url": "https://api.github.com/users/cvJie/repos", "events_url": "https://api.github.com/users/cvJie/events{/privacy}", "received_events_url": "https://api.github.com/users/cvJie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tatatodd", "id": 5453737, "node_id": "MDQ6VXNlcjU0NTM3Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5453737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatatodd", "html_url": "https://github.com/tatatodd", "followers_url": "https://api.github.com/users/tatatodd/followers", "following_url": "https://api.github.com/users/tatatodd/following{/other_user}", "gists_url": "https://api.github.com/users/tatatodd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatatodd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatatodd/subscriptions", "organizations_url": "https://api.github.com/users/tatatodd/orgs", "repos_url": "https://api.github.com/users/tatatodd/repos", "events_url": "https://api.github.com/users/tatatodd/events{/privacy}", "received_events_url": "https://api.github.com/users/tatatodd/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tatatodd", "id": 5453737, "node_id": "MDQ6VXNlcjU0NTM3Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5453737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatatodd", "html_url": "https://github.com/tatatodd", "followers_url": "https://api.github.com/users/tatatodd/followers", "following_url": "https://api.github.com/users/tatatodd/following{/other_user}", "gists_url": "https://api.github.com/users/tatatodd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatatodd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatatodd/subscriptions", "organizations_url": "https://api.github.com/users/tatatodd/orgs", "repos_url": "https://api.github.com/users/tatatodd/repos", "events_url": "https://api.github.com/users/tatatodd/events{/privacy}", "received_events_url": "https://api.github.com/users/tatatodd/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-08-16T03:01:56Z", "updated_at": "2019-01-25T22:04:22Z", "closed_at": null, "author_association": "NONE", "body": "I try to use  Facenet  by   tensorflow C++ API (VS2015),it can load graph,but it doesn't work.\r\nNot found: FeedInputs: unable to find feed output phase_train\r\ncode like this:\r\ntensorflow::Tensor input_tensor(DT_FLOAT, TensorShape({ 2 , iHeight, iWidth, depth }));\r\nauto input_tensor_mapped = input_tensor.tensor<float, 4>(); \r\n...................................................\r\ntensorflow::Tensor phase(DT_BOOL, TensorShape());\r\n\t phase.scalar<int>()() = FALSE;\r\n\r\n\tinput_tensor.shape();\r\n\tstd::vector<std::pair<std::string, tensorflow::Tensor>> inputs = {\r\n\t\t{ \"input\", input_tensor },                                    //it's OK\r\n\t\t{\" phase_train\",phase }      // it' bad    \r\n\t};\r\n please help me,thansk"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21637", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21637/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21637/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21637/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21637", "id": 350902602, "node_id": "MDU6SXNzdWUzNTA5MDI2MDI=", "number": 21637, "title": "Tensorflow Prediction Artifacts", "user": {"login": "tibuch", "id": 5450869, "node_id": "MDQ6VXNlcjU0NTA4Njk=", "avatar_url": "https://avatars3.githubusercontent.com/u/5450869?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tibuch", "html_url": "https://github.com/tibuch", "followers_url": "https://api.github.com/users/tibuch/followers", "following_url": "https://api.github.com/users/tibuch/following{/other_user}", "gists_url": "https://api.github.com/users/tibuch/gists{/gist_id}", "starred_url": "https://api.github.com/users/tibuch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tibuch/subscriptions", "organizations_url": "https://api.github.com/users/tibuch/orgs", "repos_url": "https://api.github.com/users/tibuch/repos", "events_url": "https://api.github.com/users/tibuch/events{/privacy}", "received_events_url": "https://api.github.com/users/tibuch/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, {"login": "poxvoculi", "id": 15676913, "node_id": "MDQ6VXNlcjE1Njc2OTEz", "avatar_url": "https://avatars2.githubusercontent.com/u/15676913?v=4", "gravatar_id": "", "url": "https://api.github.com/users/poxvoculi", "html_url": "https://github.com/poxvoculi", "followers_url": "https://api.github.com/users/poxvoculi/followers", "following_url": "https://api.github.com/users/poxvoculi/following{/other_user}", "gists_url": "https://api.github.com/users/poxvoculi/gists{/gist_id}", "starred_url": "https://api.github.com/users/poxvoculi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/poxvoculi/subscriptions", "organizations_url": "https://api.github.com/users/poxvoculi/orgs", "repos_url": "https://api.github.com/users/poxvoculi/repos", "events_url": "https://api.github.com/users/poxvoculi/events{/privacy}", "received_events_url": "https://api.github.com/users/poxvoculi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2018-08-15T17:49:59Z", "updated_at": "2019-03-19T17:24:45Z", "closed_at": null, "author_association": "NONE", "body": "### System Information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Mint 18\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: N/A\r\n- **TensorFlow installed from (source or binary)**: Binary\r\n- **TensorFlow version (use command below)**: v1.10.0-0-g656e7a2b34 1.10.0\r\n- **Python version**: 3.6\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **GCC/Compiler version (if compiling from source)**: N/A\r\n- **CUDA/cuDNN version**: 9.0.176/7.1.2\r\n- **GPU model and memory**: Tesla P40 24GB\r\n- **Exact command to reproduce**: python3 example.py\r\n\r\n### Describe the problem\r\nHello,\r\nI am using Tensorflow on 3D image data and I observe some strange prediction artifacts once my input exceeds a certain size.\r\nI created a minimal working example (below) which produces the artifacts. In the example all weights of the loaded u-net are initialized to 0.5 and then a 3D volume (Z: 180, Y: 196, X: 240) with a gradient in Z direction is given as prediction input. The returned output contains the gradient up to Z around 140 and then the output values change to smaller values. \r\n![observation](https://user-images.githubusercontent.com/5450869/44163361-7661fc00-a0c3-11e8-8c67-a3524370b632.png)\r\n\r\nIf a slightly smaller 3D volume (Z: 176, Y: 196, X: 240) is given, the output contains the full gradient as expected. \r\n\r\nUnfortunately I don't know if this is a TensorFlow, CUDA, cuDNN or some other sort of bug. I am grateful for any explanation or any hints on what it could be or how to fix this issue (without cropping/tiling the input).\r\n\r\n### Source code / logs\r\n\r\nThe minimum example:\r\n```\r\nimport tensorflow as tf\r\nfrom tensorflow.keras.models import model_from_json\r\nimport numpy as np\r\nfrom tifffile import imsave\r\n\r\n# load u-net architecture, kernel-size = 3, depth = 2\r\njson_file = open('model.json', 'r')\r\nloaded_model_json = json_file.read()\r\njson_file.close()\r\nmodel = model_from_json(loaded_model_json)\r\n\r\n# set all weights to 0.5\r\nw = model.get_weights()\r\ninit = []\r\nfor l in w:\r\n    init.append(l*0 + 0.5)\r\n\r\nmodel.set_weights(init)\r\n\r\ntmp = np.zeros((180, 196, 240), np.float32)\r\nfor i in range(tmp.shape[0]):\r\n    tmp[i] = i\r\n\r\ntmp = tmp[:, :, :, np.newaxis]\r\n\r\nprediction_fail = np.moveaxis(model.predict(np.moveaxis(tmp[np.newaxis], 4, -1))[0], 3, 0)\r\ntmp = tmp[:176]\r\nprediction_succ = np.moveaxis(model.predict(np.moveaxis(tmp[np.newaxis], 4, -1))[0], 3, 0)\r\n\r\nimsave('input.tif', tmp)\r\nimsave('prediction_fail.tif', prediction_fail[0])\r\nimsave('prediction_success.tif', prediction_succ[0])\r\n```\r\n\r\nThe model.json with the u-net architecture:\r\n```\r\n{\"class_name\": \"Model\", \"config\": {\"name\": \"model_3\", \"layers\": [{\"name\": \"input\", \"class_name\": \"InputLayer\", \"config\": {\"batch_input_shape\": [null, null, null, null, 1], \"dtype\": \"float32\", \"sparse\": false, \"name\": \"input\"}, \"inbound_nodes\": []}, {\"name\": \"down_level_0_no_0\", \"class_name\": \"Conv3D\", \"config\": {\"name\": \"down_level_0_no_0\", \"trainable\": true, \"filters\": 32, \"kernel_size\": [3, 3, 3], \"strides\": [1, 1, 1], \"padding\": \"same\", \"data_format\": \"channels_last\", \"dilation_rate\": [1, 1, 1], \"activation\": \"relu\", \"use_bias\": true, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"scale\": 1.0, \"mode\": \"fan_avg\", \"distribution\": \"uniform\", \"seed\": null}}, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"kernel_regularizer\": null, \"bias_regularizer\": null, \"activity_regularizer\": null, \"kernel_constraint\": null, \"bias_constraint\": null}, \"inbound_nodes\": [[[\"input\", 0, 0, {}]]]}, {\"name\": \"down_level_0_no_1\", \"class_name\": \"Conv3D\", \"config\": {\"name\": \"down_level_0_no_1\", \"trainable\": true, \"filters\": 32, \"kernel_size\": [3, 3, 3], \"strides\": [1, 1, 1], \"padding\": \"same\", \"data_format\": \"channels_last\", \"dilation_rate\": [1, 1, 1], \"activation\": \"relu\", \"use_bias\": true, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"scale\": 1.0, \"mode\": \"fan_avg\", \"distribution\": \"uniform\", \"seed\": null}}, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"kernel_regularizer\": null, \"bias_regularizer\": null, \"activity_regularizer\": null, \"kernel_constraint\": null, \"bias_constraint\": null}, \"inbound_nodes\": [[[\"down_level_0_no_0\", 0, 0, {}]]]}, {\"name\": \"max_0\", \"class_name\": \"MaxPooling3D\", \"config\": {\"name\": \"max_0\", \"trainable\": true, \"pool_size\": [2, 2, 2], \"padding\": \"valid\", \"strides\": [2, 2, 2], \"data_format\": \"channels_last\"}, \"inbound_nodes\": [[[\"down_level_0_no_1\", 0, 0, {}]]]}, {\"name\": \"down_level_1_no_0\", \"class_name\": \"Conv3D\", \"config\": {\"name\": \"down_level_1_no_0\", \"trainable\": true, \"filters\": 64, \"kernel_size\": [3, 3, 3], \"strides\": [1, 1, 1], \"padding\": \"same\", \"data_format\": \"channels_last\", \"dilation_rate\": [1, 1, 1], \"activation\": \"relu\", \"use_bias\": true, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"scale\": 1.0, \"mode\": \"fan_avg\", \"distribution\": \"uniform\", \"seed\": null}}, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"kernel_regularizer\": null, \"bias_regularizer\": null, \"activity_regularizer\": null, \"kernel_constraint\": null, \"bias_constraint\": null}, \"inbound_nodes\": [[[\"max_0\", 0, 0, {}]]]}, {\"name\": \"down_level_1_no_1\", \"class_name\": \"Conv3D\", \"config\": {\"name\": \"down_level_1_no_1\", \"trainable\": true, \"filters\": 64, \"kernel_size\": [3, 3, 3], \"strides\": [1, 1, 1], \"padding\": \"same\", \"data_format\": \"channels_last\", \"dilation_rate\": [1, 1, 1], \"activation\": \"relu\", \"use_bias\": true, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"scale\": 1.0, \"mode\": \"fan_avg\", \"distribution\": \"uniform\", \"seed\": null}}, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"kernel_regularizer\": null, \"bias_regularizer\": null, \"activity_regularizer\": null, \"kernel_constraint\": null, \"bias_constraint\": null}, \"inbound_nodes\": [[[\"down_level_1_no_0\", 0, 0, {}]]]}, {\"name\": \"max_1\", \"class_name\": \"MaxPooling3D\", \"config\": {\"name\": \"max_1\", \"trainable\": true, \"pool_size\": [2, 2, 2], \"padding\": \"valid\", \"strides\": [2, 2, 2], \"data_format\": \"channels_last\"}, \"inbound_nodes\": [[[\"down_level_1_no_1\", 0, 0, {}]]]}, {\"name\": \"middle_0\", \"class_name\": \"Conv3D\", \"config\": {\"name\": \"middle_0\", \"trainable\": true, \"filters\": 128, \"kernel_size\": [3, 3, 3], \"strides\": [1, 1, 1], \"padding\": \"same\", \"data_format\": \"channels_last\", \"dilation_rate\": [1, 1, 1], \"activation\": \"relu\", \"use_bias\": true, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"scale\": 1.0, \"mode\": \"fan_avg\", \"distribution\": \"uniform\", \"seed\": null}}, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"kernel_regularizer\": null, \"bias_regularizer\": null, \"activity_regularizer\": null, \"kernel_constraint\": null, \"bias_constraint\": null}, \"inbound_nodes\": [[[\"max_1\", 0, 0, {}]]]}, {\"name\": \"middle_2\", \"class_name\": \"Conv3D\", \"config\": {\"name\": \"middle_2\", \"trainable\": true, \"filters\": 64, \"kernel_size\": [3, 3, 3], \"strides\": [1, 1, 1], \"padding\": \"same\", \"data_format\": \"channels_last\", \"dilation_rate\": [1, 1, 1], \"activation\": \"relu\", \"use_bias\": true, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"scale\": 1.0, \"mode\": \"fan_avg\", \"distribution\": \"uniform\", \"seed\": null}}, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"kernel_regularizer\": null, \"bias_regularizer\": null, \"activity_regularizer\": null, \"kernel_constraint\": null, \"bias_constraint\": null}, \"inbound_nodes\": [[[\"middle_0\", 0, 0, {}]]]}, {\"name\": \"up_sampling3d_5\", \"class_name\": \"UpSampling3D\", \"config\": {\"name\": \"up_sampling3d_5\", \"trainable\": true, \"size\": [2, 2, 2], \"data_format\": \"channels_last\"}, \"inbound_nodes\": [[[\"middle_2\", 0, 0, {}]]]}, {\"name\": \"concatenate_5\", \"class_name\": \"Concatenate\", \"config\": {\"name\": \"concatenate_5\", \"trainable\": true, \"axis\": -1}, \"inbound_nodes\": [[[\"up_sampling3d_5\", 0, 0, {}], [\"down_level_1_no_1\", 0, 0, {}]]]}, {\"name\": \"up_level_1_no_0\", \"class_name\": \"Conv3D\", \"config\": {\"name\": \"up_level_1_no_0\", \"trainable\": true, \"filters\": 64, \"kernel_size\": [3, 3, 3], \"strides\": [1, 1, 1], \"padding\": \"same\", \"data_format\": \"channels_last\", \"dilation_rate\": [1, 1, 1], \"activation\": \"relu\", \"use_bias\": true, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"scale\": 1.0, \"mode\": \"fan_avg\", \"distribution\": \"uniform\", \"seed\": null}}, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"kernel_regularizer\": null, \"bias_regularizer\": null, \"activity_regularizer\": null, \"kernel_constraint\": null, \"bias_constraint\": null}, \"inbound_nodes\": [[[\"concatenate_5\", 0, 0, {}]]]}, {\"name\": \"up_level_1_no_2\", \"class_name\": \"Conv3D\", \"config\": {\"name\": \"up_level_1_no_2\", \"trainable\": true, \"filters\": 32, \"kernel_size\": [3, 3, 3], \"strides\": [1, 1, 1], \"padding\": \"same\", \"data_format\": \"channels_last\", \"dilation_rate\": [1, 1, 1], \"activation\": \"relu\", \"use_bias\": true, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"scale\": 1.0, \"mode\": \"fan_avg\", \"distribution\": \"uniform\", \"seed\": null}}, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"kernel_regularizer\": null, \"bias_regularizer\": null, \"activity_regularizer\": null, \"kernel_constraint\": null, \"bias_constraint\": null}, \"inbound_nodes\": [[[\"up_level_1_no_0\", 0, 0, {}]]]}, {\"name\": \"up_sampling3d_6\", \"class_name\": \"UpSampling3D\", \"config\": {\"name\": \"up_sampling3d_6\", \"trainable\": true, \"size\": [2, 2, 2], \"data_format\": \"channels_last\"}, \"inbound_nodes\": [[[\"up_level_1_no_2\", 0, 0, {}]]]}, {\"name\": \"concatenate_6\", \"class_name\": \"Concatenate\", \"config\": {\"name\": \"concatenate_6\", \"trainable\": true, \"axis\": -1}, \"inbound_nodes\": [[[\"up_sampling3d_6\", 0, 0, {}], [\"down_level_0_no_1\", 0, 0, {}]]]}, {\"name\": \"up_level_0_no_0\", \"class_name\": \"Conv3D\", \"config\": {\"name\": \"up_level_0_no_0\", \"trainable\": true, \"filters\": 32, \"kernel_size\": [3, 3, 3], \"strides\": [1, 1, 1], \"padding\": \"same\", \"data_format\": \"channels_last\", \"dilation_rate\": [1, 1, 1], \"activation\": \"relu\", \"use_bias\": true, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"scale\": 1.0, \"mode\": \"fan_avg\", \"distribution\": \"uniform\", \"seed\": null}}, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"kernel_regularizer\": null, \"bias_regularizer\": null, \"activity_regularizer\": null, \"kernel_constraint\": null, \"bias_constraint\": null}, \"inbound_nodes\": [[[\"concatenate_6\", 0, 0, {}]]]}, {\"name\": \"up_level_0_no_2\", \"class_name\": \"Conv3D\", \"config\": {\"name\": \"up_level_0_no_2\", \"trainable\": true, \"filters\": 32, \"kernel_size\": [3, 3, 3], \"strides\": [1, 1, 1], \"padding\": \"same\", \"data_format\": \"channels_last\", \"dilation_rate\": [1, 1, 1], \"activation\": \"relu\", \"use_bias\": true, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"scale\": 1.0, \"mode\": \"fan_avg\", \"distribution\": \"uniform\", \"seed\": null}}, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"kernel_regularizer\": null, \"bias_regularizer\": null, \"activity_regularizer\": null, \"kernel_constraint\": null, \"bias_constraint\": null}, \"inbound_nodes\": [[[\"up_level_0_no_0\", 0, 0, {}]]]}, {\"name\": \"conv3d_3\", \"class_name\": \"Conv3D\", \"config\": {\"name\": \"conv3d_3\", \"trainable\": true, \"filters\": 1, \"kernel_size\": [1, 1, 1], \"strides\": [1, 1, 1], \"padding\": \"valid\", \"data_format\": \"channels_last\", \"dilation_rate\": [1, 1, 1], \"activation\": \"linear\", \"use_bias\": true, \"kernel_initializer\": {\"class_name\": \"VarianceScaling\", \"config\": {\"scale\": 1.0, \"mode\": \"fan_avg\", \"distribution\": \"uniform\", \"seed\": null}}, \"bias_initializer\": {\"class_name\": \"Zeros\", \"config\": {}}, \"kernel_regularizer\": null, \"bias_regularizer\": null, \"activity_regularizer\": null, \"kernel_constraint\": null, \"bias_constraint\": null}, \"inbound_nodes\": [[[\"up_level_0_no_2\", 0, 0, {}]]]}, {\"name\": \"add_19\", \"class_name\": \"Add\", \"config\": {\"name\": \"add_19\", \"trainable\": true}, \"inbound_nodes\": [[[\"conv3d_3\", 0, 0, {}], [\"input\", 0, 0, {}]]]}, {\"name\": \"activation_52\", \"class_name\": \"Activation\", \"config\": {\"name\": \"activation_52\", \"trainable\": true, \"activation\": \"linear\"}, \"inbound_nodes\": [[[\"add_19\", 0, 0, {}]]]}], \"input_layers\": [[\"input\", 0, 0]], \"output_layers\": [[\"activation_52\", 0, 0]]}, \"keras_version\": \"2.2.0\", \"backend\": \"tensorflow\"}\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21622", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21622/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21622/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21622/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21622", "id": 350691781, "node_id": "MDU6SXNzdWUzNTA2OTE3ODE=", "number": 21622, "title": "NotFoundError (see above for traceback): Key conv1/biases not found in checkpoint \t [[Node: save/RestoreV2 = RestoreV2[dtypes=[DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, ..., DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT, DT_FLOAT], _device=\"/job:worker/replica:0/task:0/device:CPU:0\"](_recv_save/Const_0, save/RestoreV2/tensor_names, save/RestoreV2/shape_and_slices)]]", "user": {"login": "Darkknight2018", "id": 42400287, "node_id": "MDQ6VXNlcjQyNDAwMjg3", "avatar_url": "https://avatars0.githubusercontent.com/u/42400287?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Darkknight2018", "html_url": "https://github.com/Darkknight2018", "followers_url": "https://api.github.com/users/Darkknight2018/followers", "following_url": "https://api.github.com/users/Darkknight2018/following{/other_user}", "gists_url": "https://api.github.com/users/Darkknight2018/gists{/gist_id}", "starred_url": "https://api.github.com/users/Darkknight2018/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Darkknight2018/subscriptions", "organizations_url": "https://api.github.com/users/Darkknight2018/orgs", "repos_url": "https://api.github.com/users/Darkknight2018/repos", "events_url": "https://api.github.com/users/Darkknight2018/events{/privacy}", "received_events_url": "https://api.github.com/users/Darkknight2018/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tatatodd", "id": 5453737, "node_id": "MDQ6VXNlcjU0NTM3Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5453737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatatodd", "html_url": "https://github.com/tatatodd", "followers_url": "https://api.github.com/users/tatatodd/followers", "following_url": "https://api.github.com/users/tatatodd/following{/other_user}", "gists_url": "https://api.github.com/users/tatatodd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatatodd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatatodd/subscriptions", "organizations_url": "https://api.github.com/users/tatatodd/orgs", "repos_url": "https://api.github.com/users/tatatodd/repos", "events_url": "https://api.github.com/users/tatatodd/events{/privacy}", "received_events_url": "https://api.github.com/users/tatatodd/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tatatodd", "id": 5453737, "node_id": "MDQ6VXNlcjU0NTM3Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5453737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatatodd", "html_url": "https://github.com/tatatodd", "followers_url": "https://api.github.com/users/tatatodd/followers", "following_url": "https://api.github.com/users/tatatodd/following{/other_user}", "gists_url": "https://api.github.com/users/tatatodd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatatodd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatatodd/subscriptions", "organizations_url": "https://api.github.com/users/tatatodd/orgs", "repos_url": "https://api.github.com/users/tatatodd/repos", "events_url": "https://api.github.com/users/tatatodd/events{/privacy}", "received_events_url": "https://api.github.com/users/tatatodd/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2018-08-15T05:38:08Z", "updated_at": "2019-01-25T21:57:50Z", "closed_at": null, "author_association": "NONE", "body": "Please go to Stack Overflow for help and support:\r\n\r\nhttps://stackoverflow.com/questions/tagged/tensorflow\r\n\r\nIf you open a GitHub issue, here is our policy:\r\n\r\n1. It must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).\r\n2. The form below must be filled out.\r\n3. It shouldn't be a TensorBoard issue. Those go [here](https://github.com/tensorflow/tensorboard/issues).\r\n\r\n**Here's why we have that policy**: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.\r\n\r\n------------------------\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**:\r\n- **TensorFlow version (use command below)**:\r\n- **Python version**:\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**:\r\n- **GPU model and memory**:\r\n- **Exact command to reproduce**:\r\n\r\nYou can collect some of this information using our environment capture script:\r\n\r\nhttps://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh\r\n\r\nYou can obtain the TensorFlow version with\r\n\r\npython -c \"import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"\r\n\r\n### Describe the problem\r\nDescribe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.\r\n\r\n### Source code / logs\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21615", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21615/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21615/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21615/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21615", "id": 350593048, "node_id": "MDU6SXNzdWUzNTA1OTMwNDg=", "number": 21615, "title": "Fine tuning a model by building a Scaffold in Mirrored Strategy is not supported", "user": {"login": "lamsalab", "id": 23664489, "node_id": "MDQ6VXNlcjIzNjY0NDg5", "avatar_url": "https://avatars2.githubusercontent.com/u/23664489?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lamsalab", "html_url": "https://github.com/lamsalab", "followers_url": "https://api.github.com/users/lamsalab/followers", "following_url": "https://api.github.com/users/lamsalab/following{/other_user}", "gists_url": "https://api.github.com/users/lamsalab/gists{/gist_id}", "starred_url": "https://api.github.com/users/lamsalab/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lamsalab/subscriptions", "organizations_url": "https://api.github.com/users/lamsalab/orgs", "repos_url": "https://api.github.com/users/lamsalab/repos", "events_url": "https://api.github.com/users/lamsalab/events{/privacy}", "received_events_url": "https://api.github.com/users/lamsalab/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 1345373822, "node_id": "MDU6TGFiZWwxMzQ1MzczODIy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:ds-triaged", "name": "stat:ds-triaged", "color": "f2dea7", "default": false, "description": "Internal label for triaging"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "seemuch", "id": 2233625, "node_id": "MDQ6VXNlcjIyMzM2MjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/2233625?v=4", "gravatar_id": "", "url": "https://api.github.com/users/seemuch", "html_url": "https://github.com/seemuch", "followers_url": "https://api.github.com/users/seemuch/followers", "following_url": "https://api.github.com/users/seemuch/following{/other_user}", "gists_url": "https://api.github.com/users/seemuch/gists{/gist_id}", "starred_url": "https://api.github.com/users/seemuch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/seemuch/subscriptions", "organizations_url": "https://api.github.com/users/seemuch/orgs", "repos_url": "https://api.github.com/users/seemuch/repos", "events_url": "https://api.github.com/users/seemuch/events{/privacy}", "received_events_url": "https://api.github.com/users/seemuch/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "seemuch", "id": 2233625, "node_id": "MDQ6VXNlcjIyMzM2MjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/2233625?v=4", "gravatar_id": "", "url": "https://api.github.com/users/seemuch", "html_url": "https://github.com/seemuch", "followers_url": "https://api.github.com/users/seemuch/followers", "following_url": "https://api.github.com/users/seemuch/following{/other_user}", "gists_url": "https://api.github.com/users/seemuch/gists{/gist_id}", "starred_url": "https://api.github.com/users/seemuch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/seemuch/subscriptions", "organizations_url": "https://api.github.com/users/seemuch/orgs", "repos_url": "https://api.github.com/users/seemuch/repos", "events_url": "https://api.github.com/users/seemuch/events{/privacy}", "received_events_url": "https://api.github.com/users/seemuch/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2018-08-14T20:51:33Z", "updated_at": "2020-02-08T01:12:06Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\nHave I written custom code: Yes\r\nOS Platform and Distribution: Linux Ubuntu 18.04\r\nMobile device: N/A\r\nTensorFlow installed from: source\r\nTensorFlow version: ('v1.9.0-rc2-2165-g7b80190d52', '1.10.0-rc1')\r\nPython version: 2.7\r\nBazel version: 0.15.2\r\nGCC/Compiler version: gcc version 6.4.0 20180424\r\nCUDA/cuDNN version: 9.1 / 7.1\r\nGPU model and memory: K80,  12GB\r\nExact command to reproduce: N/A\r\n\r\n### Describe the problem\r\nDescribe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.\r\nI have been trying to  fine tune my model using Mirrored Strategy. To initialize the weights from a given checkpoint, I pass a scaffold object to Estimator_Spec object, with init_fn as a parameter. However, when I run it, the program crashes (refer to the stacktrace below for more details). I looked around for similar issue, but couldn't find any. Hence, I had to dig through the source code to figure the cause of the issue. While exploring, I ran into this message:\r\n**TODO(anjalisridhar): Figure out how to resolve the following scaffold parameters: init_feed_dict, init_fn**\r\ncalled here:\r\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/estimator/estimator.py#L1599\r\n\r\nI was wondering whether fixing this is on priority list, or whether it has been sitting on the back burner until other issues have been resolved.\r\n\r\ni am not sure how to present a reproducible code in this context, but do let me know if I need to clarify some more.\r\n\r\n### Source code / logs\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n\r\nINFO:tensorflow:Using config: {'_save_checkpoints_secs': 120, '_session_config': allow_soft_placement: true\r\n, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': <tensorflow.contrib.distribute.python.mirrored_strategy.MirroredStrategy object at 0x7fd221bfad10>, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fd221bfacd0>, '_model_dir': '../data/model2', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': 100, '_evaluation_master': '', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': ''}\r\n2018-08-11 08:50:44.010343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 0 with properties:\r\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\r\npciBusID: 0000:04:00.0\r\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\r\n2018-08-11 08:50:44.164489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Found device 1 with properties:\r\nname: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235\r\npciBusID: 0000:05:00.0\r\ntotalMemory: 11.17GiB freeMemory: 11.10GiB\r\n2018-08-11 08:50:44.164798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1\r\n2018-08-11 08:50:44.719187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-08-11 08:50:44.719236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1\r\n2018-08-11 08:50:44.719243: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y\r\n2018-08-11 08:50:44.719247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N\r\n2018-08-11 08:50:44.719771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/device:GPU:0 with 10757 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)\r\n2018-08-11 08:50:44.885422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/device:GPU:1 with 10757 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)\r\nINFO:tensorflow:Device is available but not used by distribute strategy: /device:CPU:0\r\nINFO:tensorflow:Configured nccl all-reduce.\r\n2018-08-11 08:50:45.166638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1485] Adding visible gpu devices: 0, 1\r\n2018-08-11 08:50:45.166758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:966] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2018-08-11 08:50:45.166769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:972]      0 1\r\n2018-08-11 08:50:45.166777: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 0:   N Y\r\n2018-08-11 08:50:45.166793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:985] 1:   Y N\r\n2018-08-11 08:50:45.167078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10757 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:04:00.0, compute capability: 3.7)\r\n2018-08-11 08:50:45.167251: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1098] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10757 MB memory) -> physical GPU (device: 1, name: Tesla K80, pci bus id: 0000:05:00.0, compute capability: 3.7)\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:batch_all_reduce invoked for batches size = 34 with algorithm = nccl, num_packs = 1, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 167, in <module>\r\n    tf.app.run()\r\n  File \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/platform/app.py\", line 125, in run\r\n    _sys.exit(main(argv))\r\n  File \"train.py\", line 164, in main\r\n    classifier.train( input_fn=_get_input, max_steps=FLAGS.max_num_steps )\r\n  File \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 343, in train\r\n    loss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1127, in _train_model\r\n    return self._train_model_distributed(input_fn, hooks, saving_listeners)\r\n  File \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1256, in _train_model_distributed\r\n    grouped_estimator_spec.scaffold, self._train_distribution)\r\n  File \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py\", line 1576, in _combine_distributed_scaffold\r\n    init_fn = distribution.group(init_fn)\r\n  File \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/training/distribute.py\", line 1007, in group\r\n    return control_flow_ops.group(value, name=name)\r\n  File \"/home/weinman/virtualenv/tf-master-7b80190d52/local/lib/python2.7/site-packages/tensorflow/python/ops/control_flow_ops.py\", line 3396, in group\r\n    \"'%s' with type '%s'\" % (inp, type(inp)))\r\n**TypeError: Expected tf.group() expected Tensor arguments not '<function <lambda> at 0x7fcfe46a8c08>' with type '<type 'function'>'**"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21590", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21590/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21590/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21590/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21590", "id": 350259677, "node_id": "MDU6SXNzdWUzNTAyNTk2Nzc=", "number": 21590, "title": "All metrics evaluate to 0.0 when using  tf.contrib.estimator.InMemoryEvaluatorHook", "user": {"login": "tavramov", "id": 30814992, "node_id": "MDQ6VXNlcjMwODE0OTky", "avatar_url": "https://avatars2.githubusercontent.com/u/30814992?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tavramov", "html_url": "https://github.com/tavramov", "followers_url": "https://api.github.com/users/tavramov/followers", "following_url": "https://api.github.com/users/tavramov/following{/other_user}", "gists_url": "https://api.github.com/users/tavramov/gists{/gist_id}", "starred_url": "https://api.github.com/users/tavramov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tavramov/subscriptions", "organizations_url": "https://api.github.com/users/tavramov/orgs", "repos_url": "https://api.github.com/users/tavramov/repos", "events_url": "https://api.github.com/users/tavramov/events{/privacy}", "received_events_url": "https://api.github.com/users/tavramov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1166103538, "node_id": "MDU6TGFiZWwxMTY2MTAzNTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/contrib", "name": "contrib", "color": "5319e7", "default": false, "description": "Anything that comes under contrib directory"}, {"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2018-08-14T02:34:21Z", "updated_at": "2019-01-25T21:54:11Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Slight modification to cnn_mnist.py to include `InMemoryEvaluatorHook` . Original code can be found here [here](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/tutorials/layers/cnn_mnist.py)\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:N/A\r\n- **TensorFlow installed from (source or binary)**: binary (i think)\r\n- **TensorFlow version (use command below)**:1.9.0 (with PR#20822)\r\n- **Python version**: 3.5.2\r\n- **Bazel version (if compiling from source)**:N/A\r\n- **GCC/Compiler version (if compiling from source)**:5.4.0\r\n- **CUDA/cuDNN version**:7.5\r\n- **GPU model and memory**: 2x TITAN X (12189MiB) & Quadro P5000 (16273MiB)\r\n- **Exact command to reproduce**:  python3 cnn_mnist.py\r\n\r\n### Describe the problem\r\nWhen evaluating during training with `tf.contrib.estimator.InMemoryEvaluatorHook`, all evaluation metrics are evaluated to 0.0 after the very first time the evaluation hook is triggered. My suspicion is that it is caused by the use of `tf.estimator.inputs.numpy_input_fn`.\r\n\r\n### Source code:\r\nAttached is the script I used. Basically, just added the following line:\r\n` evaluator = tf.contrib.estimator.InMemoryEvaluatorHook(estimator=mnist_classifier, input_fn=eval_input_fn, every_n_iter=50)` and passed the hook to `mnist_classifer.train()`\r\n\r\n[cnn_mnist.txt](https://github.com/tensorflow/tensorflow/files/2285277/cnn_mnist.txt)\r\n\r\n\r\nHere is the relevant output from running the training for 200 steps:\r\n\r\nINFO:tensorflow:Starting evaluation at 2018-08-14-02:15:35\r\nINFO:tensorflow:Graph was finalized.\r\nINFO:tensorflow:Running local_init_op.\r\nINFO:tensorflow:Done running local_init_op.\r\nINFO:tensorflow:Finished evaluation at 2018-08-14-02:15:37\r\nINFO:tensorflow:Saving dict for global step 0: accuracy = 0.0915, global_step = 0, loss = 2.30028\r\nINFO:tensorflow:loss = 2.29529, step = 0\r\n...\r\nINFO:tensorflow:Starting evaluation at 2018-08-14-02:15:37\r\nINFO:tensorflow:Graph was finalized.\r\nINFO:tensorflow:Running local_init_op.\r\nINFO:tensorflow:Done running local_init_op.\r\nINFO:tensorflow:Finished evaluation at 2018-08-14-02:15:37\r\nINFO:tensorflow:Saving dict for global step 50: accuracy = 0.0, global_step = 50, loss = 0.0\r\n...\r\nINFO:tensorflow:Starting evaluation at 2018-08-14-02:15:38\r\nINFO:tensorflow:Graph was finalized.\r\nINFO:tensorflow:Running local_init_op.\r\nINFO:tensorflow:Done running local_init_op.\r\nINFO:tensorflow:Finished evaluation at 2018-08-14-02:15:38\r\nINFO:tensorflow:Saving dict for global step 100: accuracy = 0.0, global_step = 100, loss = 0.0\r\nINFO:tensorflow:global_step/sec: 103.013\r\nINFO:tensorflow:loss = 2.27342, step = 100 (0.971 sec)\r\n...\r\nINFO:tensorflow:Starting evaluation at 2018-08-14-02:15:38\r\nINFO:tensorflow:Graph was finalized.\r\nINFO:tensorflow:Running local_init_op.\r\nINFO:tensorflow:Done running local_init_op.\r\nINFO:tensorflow:Finished evaluation at 2018-08-14-02:15:38\r\nINFO:tensorflow:Saving dict for global step 150: accuracy = 0.0, global_step = 150, loss = 0.0\r\n...\r\nINFO:tensorflow:Starting evaluation at 2018-08-14-02:15:39\r\nINFO:tensorflow:Graph was finalized.\r\nINFO:tensorflow:Running local_init_op.\r\nINFO:tensorflow:Done running local_init_op.\r\nINFO:tensorflow:Finished evaluation at 2018-08-14-02:15:39\r\nINFO:tensorflow:Saving dict for global step 200: accuracy = 0.0, global_step = 200, loss = 0.0\r\n...\r\nINFO:tensorflow:Saving checkpoints for 200 into ./tmp/mnist_convnet_model/model.ckpt.\r\nINFO:tensorflow:Starting evaluation at 2018-08-14-02:15:39\r\nINFO:tensorflow:Graph was finalized.\r\nINFO:tensorflow:Running local_init_op.\r\nINFO:tensorflow:Done running local_init_op.\r\nINFO:tensorflow:Finished evaluation at 2018-08-14-02:15:39\r\nINFO:tensorflow:Saving dict for global step 200: accuracy = 0.0, global_step = 200, loss = 0.0\r\nINFO:tensorflow:Loss for final step: 2.25765.\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\n...\r\nINFO:tensorflow:Starting evaluation at 2018-08-14-02:15:40\r\nINFO:tensorflow:Graph was finalized.\r\nINFO:tensorflow:Restoring parameters from ./tmp/mnist_convnet_model/model.ckpt-200\r\nINFO:tensorflow:Running local_init_op.\r\nINFO:tensorflow:Done running local_init_op.\r\nINFO:tensorflow:Finished evaluation at 2018-08-14-02:15:40\r\nINFO:tensorflow:Saving dict for global step 200: accuracy = 0.2611, global_step = 200, loss = 2.25732\r\nINFO:tensorflow:Saving 'checkpoint_path' summary for global step 200: ./tmp/mnist_convnet_model/model.ckpt-200\r\n{'global_step': 200, 'loss': 2.2573187, 'accuracy': 0.26109999}\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21555", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21555/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21555/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21555/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21555", "id": 349816725, "node_id": "MDU6SXNzdWUzNDk4MTY3MjU=", "number": 21555, "title": "Better  tf.contrib.estimator.early_stopping (Feature request)", "user": {"login": "ElchananHaas", "id": 7143767, "node_id": "MDQ6VXNlcjcxNDM3Njc=", "avatar_url": "https://avatars2.githubusercontent.com/u/7143767?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ElchananHaas", "html_url": "https://github.com/ElchananHaas", "followers_url": "https://api.github.com/users/ElchananHaas/followers", "following_url": "https://api.github.com/users/ElchananHaas/following{/other_user}", "gists_url": "https://api.github.com/users/ElchananHaas/gists{/gist_id}", "starred_url": "https://api.github.com/users/ElchananHaas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ElchananHaas/subscriptions", "organizations_url": "https://api.github.com/users/ElchananHaas/orgs", "repos_url": "https://api.github.com/users/ElchananHaas/repos", "events_url": "https://api.github.com/users/ElchananHaas/events{/privacy}", "received_events_url": "https://api.github.com/users/ElchananHaas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1166103538, "node_id": "MDU6TGFiZWwxMTY2MTAzNTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/contrib", "name": "contrib", "color": "5319e7", "default": false, "description": "Anything that comes under contrib directory"}, {"id": 404586558, "node_id": "MDU6TGFiZWw0MDQ1ODY1NTg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:community%20support", "name": "stat:community support", "color": "f4b400", "default": false, "description": ""}, {"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2018-08-12T14:26:13Z", "updated_at": "2019-01-25T21:49:20Z", "closed_at": null, "author_association": "NONE", "body": "\r\n### System information\r\nN/A\r\n\r\n### Describe the problem\r\nThe current early stopping code doesn't take into account any trends in the loss, and therefore can be thrown off by a single low loss. It would be better to use an exponential moving average of the loss to compute the lowest loss, as that will be less likely to be thrown off by a single very low loss. "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21530", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21530/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21530/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21530/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21530", "id": 349334279, "node_id": "MDU6SXNzdWUzNDkzMzQyNzk=", "number": 21530, "title": "[Bug] Broken Combination: Non-SGD Optimizer, tf.Variable(), and Estimator Framework", "user": {"login": "liuyipei", "id": 4404828, "node_id": "MDQ6VXNlcjQ0MDQ4Mjg=", "avatar_url": "https://avatars0.githubusercontent.com/u/4404828?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liuyipei", "html_url": "https://github.com/liuyipei", "followers_url": "https://api.github.com/users/liuyipei/followers", "following_url": "https://api.github.com/users/liuyipei/following{/other_user}", "gists_url": "https://api.github.com/users/liuyipei/gists{/gist_id}", "starred_url": "https://api.github.com/users/liuyipei/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liuyipei/subscriptions", "organizations_url": "https://api.github.com/users/liuyipei/orgs", "repos_url": "https://api.github.com/users/liuyipei/repos", "events_url": "https://api.github.com/users/liuyipei/events{/privacy}", "received_events_url": "https://api.github.com/users/liuyipei/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 1105108936, "node_id": "MDU6TGFiZWwxMTA1MTA4OTM2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:model", "name": "comp:model", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2018-08-10T00:17:13Z", "updated_at": "2020-02-08T01:12:10Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "The following combination is broken when simultaneously used:\r\n* Optimizer other than SGD\r\n* Estimator framework\r\n* using `tf.Variable` rather than `tf.get_variable`\r\nThe bug might be more specific, since I am basing this directly off of the full setup found in the official resnet example in `models/`\r\n\r\nI have made a 3-line modification to the official resnet example illustrate problem:\r\nhttps://github.com/tensorflow/models/compare/master...liuyipei:BUG_NonSGDOptimizer_Variable_Estimator\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\nI can illustrate the bug with minimal change to an official example.\r\n\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\ncentos-release-7-4.1708.el7.centos.x86_64\r\n- **TensorFlow installed from (source or binary)**:\r\nBinary\r\n- **TensorFlow version (use command below)**:\r\nv1.10.0-0-g656e7a2b34 1.10.0\r\n- **Python version**:\r\n3.4.5\r\n- **CUDA/cuDNN version**:\r\nCUDA 9, cuDNN 7\r\n- **Bazel version**:\r\nN/A\r\n- **Mobile device**:\r\nN/A\r\n- **GPU model and memory**:\r\nNvidia GTX1080\r\n- **Exact command to reproduce**:\r\n```\r\ncd models/official/resnet\r\ngit remote add liuyipei git@github.com:liuyipei/models.git\r\ngit fetch liuyipei\r\ngit checkout liuyipei/BUG_NonSGDOptimizer_Variable_Estimator\r\npython cifar10_download_and_extract.py\r\npython cifar10_main.py\r\n```\r\n\r\n\r\n### Describe the problem\r\nDescribe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.\r\n\r\nI changed 3 lines inside an officially supported model to illustrate my point.\r\nhttps://github.com/tensorflow/models/blob/master/official/resnet/cifar10_main.py\r\nI added a `z` variable. If I use `tf.Variable` directly, an error happens at training time.\r\n```\r\n      z = tf.Variable(0, dtype=tf.float32, trainable=True, name='tf_Variable_direct') # this fails at optimization time\r\n      # z=tf.get_variable(\"tf_get_variable\", [], dtype=tf.float32) #this works!\r\n      inputs = tf.identity(inputs+z, 'final_reduce_mean')\r\n```\r\n\r\nThe error is:\r\n```\r\n  File \"/home/yiliu/gpuenv/lib/python3.4/site-packages/tensorflow/python/training/momentum.py\", line 98, in _apply_dense\r\n    use_nesterov=self._use_nesterov).op\r\n  File \"/home/yiliu/gpuenv/lib/python3.4/site-packages/tensorflow/python/training/gen_training_ops.py\", line 634, in apply_momentum\r\n    name=name)\r\n  File \"/home/yiliu/gpuenv/lib/python3.4/site-packages/tensorflow/python/framework/op_def_library.py\", line 641, in _apply_op_helper\r\n    \"(e.g.: a tf.Variable)\") % (op_type_name, input_name))\r\nTypeError: 'ApplyMomentum' Op requires that input 'accum' be a mutable tensor (e.g.: a tf.Variable)\r\n```\r\n\r\nI have the following additional anecdotal information:\r\n* The bug does not manifest when `GradientDescentOptimizer` is used, presumably because it doesn't involve momentum updates.\r\n* The bug does not manifest itself when I declare the variable using `tf.get_variable`\r\n* I did some more digging (work not shown), but it seems to have something to do with the dtype of the object created directly by `tf.Variable` having dtype `float32_ref` after coming through `optimizer.compute_gradients(loss * loss_scale)` inside `resnet_run_loop.py`. This is unlike the other variables, which have `float32` in that context. Maybe there is some kind of confusion in type checking."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21526", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21526/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21526/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21526/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21526", "id": 349285250, "node_id": "MDU6SXNzdWUzNDkyODUyNTA=", "number": 21526, "title": "Address missing TensorFlow operations to TFLite:", "user": {"login": "suharshs", "id": 1450614, "node_id": "MDQ6VXNlcjE0NTA2MTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/1450614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suharshs", "html_url": "https://github.com/suharshs", "followers_url": "https://api.github.com/users/suharshs/followers", "following_url": "https://api.github.com/users/suharshs/following{/other_user}", "gists_url": "https://api.github.com/users/suharshs/gists{/gist_id}", "starred_url": "https://api.github.com/users/suharshs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suharshs/subscriptions", "organizations_url": "https://api.github.com/users/suharshs/orgs", "repos_url": "https://api.github.com/users/suharshs/repos", "events_url": "https://api.github.com/users/suharshs/events{/privacy}", "received_events_url": "https://api.github.com/users/suharshs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}, {"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}, {"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, {"login": "suharshs", "id": 1450614, "node_id": "MDQ6VXNlcjE0NTA2MTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/1450614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suharshs", "html_url": "https://github.com/suharshs", "followers_url": "https://api.github.com/users/suharshs/followers", "following_url": "https://api.github.com/users/suharshs/following{/other_user}", "gists_url": "https://api.github.com/users/suharshs/gists{/gist_id}", "starred_url": "https://api.github.com/users/suharshs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suharshs/subscriptions", "organizations_url": "https://api.github.com/users/suharshs/orgs", "repos_url": "https://api.github.com/users/suharshs/repos", "events_url": "https://api.github.com/users/suharshs/events{/privacy}", "received_events_url": "https://api.github.com/users/suharshs/received_events", "type": "User", "site_admin": false}, {"login": "tofulawrence", "id": 24887415, "node_id": "MDQ6VXNlcjI0ODg3NDE1", "avatar_url": "https://avatars2.githubusercontent.com/u/24887415?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tofulawrence", "html_url": "https://github.com/tofulawrence", "followers_url": "https://api.github.com/users/tofulawrence/followers", "following_url": "https://api.github.com/users/tofulawrence/following{/other_user}", "gists_url": "https://api.github.com/users/tofulawrence/gists{/gist_id}", "starred_url": "https://api.github.com/users/tofulawrence/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tofulawrence/subscriptions", "organizations_url": "https://api.github.com/users/tofulawrence/orgs", "repos_url": "https://api.github.com/users/tofulawrence/repos", "events_url": "https://api.github.com/users/tofulawrence/events{/privacy}", "received_events_url": "https://api.github.com/users/tofulawrence/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 63, "created_at": "2018-08-09T20:50:08Z", "updated_at": "2020-03-06T21:23:18Z", "closed_at": null, "author_association": "MEMBER", "body": "We track operations that we need add to TensorFlow Lite here:\r\n\r\n- [ ] Conv3d (https://github.com/tensorflow/tensorflow/issues/19658)\r\n- [ ] Quantized TransposeConv (https://github.com/tensorflow/tensorflow/issues/21394)\r\n- [ ] SpaceToBatchND (non-4D) (https://github.com/tensorflow/tensorflow/issues/21266)\r\n- [ ] BatchToSpaceND (non-4D) (https://github.com/tensorflow/tensorflow/issues/21266)\r\n- [ ] SquaredDifference (quantized) (https://github.com/tensorflow/tensorflow/issues/21986)\r\n- [ ] t2t model ops (Abs, All, BatchMatMul, Cos, DatasetToSingleElement, Enter, Exit, Fill, FloorMod, GatherNd, IsFinite, ListDiff, LoopCond, MapDataset, MatrixBandPart, Merge, PaddedBatchDatasetV2, Range, RefEnter, ScatterNd, Switch, TensorSliceDataset, Where, ZerosLike, convert_gradient_to_tensor_HBc3xYw22Mw) (https://github.com/tensorflow/tensorflow/issues/20679)\r\n- [ ] RandomUniform (https://github.com/tensorflow/tensorflow/issues/23651)\r\n- [ ] Quantized Div (https://github.com/tensorflow/tensorflow/issues/21526)\r\n\r\nPlease comment with new operations you may want, we will add them to the list and remove your comment. Thanks!"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21522", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21522/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21522/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21522/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21522", "id": 349226398, "node_id": "MDU6SXNzdWUzNDkyMjYzOTg=", "number": 21522, "title": "Model Parallelism Memory usage issue", "user": {"login": "reger-men", "id": 8779942, "node_id": "MDQ6VXNlcjg3Nzk5NDI=", "avatar_url": "https://avatars0.githubusercontent.com/u/8779942?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reger-men", "html_url": "https://github.com/reger-men", "followers_url": "https://api.github.com/users/reger-men/followers", "following_url": "https://api.github.com/users/reger-men/following{/other_user}", "gists_url": "https://api.github.com/users/reger-men/gists{/gist_id}", "starred_url": "https://api.github.com/users/reger-men/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reger-men/subscriptions", "organizations_url": "https://api.github.com/users/reger-men/orgs", "repos_url": "https://api.github.com/users/reger-men/repos", "events_url": "https://api.github.com/users/reger-men/events{/privacy}", "received_events_url": "https://api.github.com/users/reger-men/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "asimshankar", "id": 16018, "node_id": "MDQ6VXNlcjE2MDE4", "avatar_url": "https://avatars2.githubusercontent.com/u/16018?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asimshankar", "html_url": "https://github.com/asimshankar", "followers_url": "https://api.github.com/users/asimshankar/followers", "following_url": "https://api.github.com/users/asimshankar/following{/other_user}", "gists_url": "https://api.github.com/users/asimshankar/gists{/gist_id}", "starred_url": "https://api.github.com/users/asimshankar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asimshankar/subscriptions", "organizations_url": "https://api.github.com/users/asimshankar/orgs", "repos_url": "https://api.github.com/users/asimshankar/repos", "events_url": "https://api.github.com/users/asimshankar/events{/privacy}", "received_events_url": "https://api.github.com/users/asimshankar/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "asimshankar", "id": 16018, "node_id": "MDQ6VXNlcjE2MDE4", "avatar_url": "https://avatars2.githubusercontent.com/u/16018?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asimshankar", "html_url": "https://github.com/asimshankar", "followers_url": "https://api.github.com/users/asimshankar/followers", "following_url": "https://api.github.com/users/asimshankar/following{/other_user}", "gists_url": "https://api.github.com/users/asimshankar/gists{/gist_id}", "starred_url": "https://api.github.com/users/asimshankar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asimshankar/subscriptions", "organizations_url": "https://api.github.com/users/asimshankar/orgs", "repos_url": "https://api.github.com/users/asimshankar/repos", "events_url": "https://api.github.com/users/asimshankar/events{/privacy}", "received_events_url": "https://api.github.com/users/asimshankar/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2018-08-09T17:46:46Z", "updated_at": "2019-01-25T22:29:42Z", "closed_at": null, "author_association": "NONE", "body": "------------------------\r\n\r\n### System information\r\n- **Have I written custom code**: Yes\r\n- **OS Platform and Distribution**: Linux Ubuntu 16.04\r\n- **Mobile device**: N/A\r\n- **TensorFlow installed from**: From binary\r\n- **TensorFlow version**: 1.9\r\n- **Python version**: 3.6.1\r\n- **Bazel version**: N/A\r\n- **GCC/Compiler version (if compiling from source)**: 5.4.0\r\n- **CUDA/cuDNN version**: 9.0.176\r\n- **GPU model and memory**: Tested on 4X GeForce GTX 1080 with 10GB\r\n- **Exact command to reproduce**: `CUDA_VISIBLE_DEVICES=0,1,2,3 python3 train.py --data-dir=Datasets_Path/cityscapes/ --input-size=\"1000,1000\" --batch-size=1`\r\n\r\n### Describe the problem\r\nI run the above Model training on single GPU and on multiple GPUs and it looks like the memory is being allocated several times. The model size is about 10,7 GB. By distributing over several GPUs the total model size should not be increased. But as you can see it almost triples. Thereby I can not profit from model parallelism. Even a input size of 1200 x 1200 return an OOM error.\r\n\r\nThe following screenshots show the memory usage on different GPUs:\r\n\r\n### On GPU:0\r\n![gpu0](https://user-images.githubusercontent.com/8779942/43915687-c2372af4-9c0b-11e8-8eac-c7d3d28b7844.png)\r\n\r\n\r\n### On GPU:0 and 1\r\n![gpu01](https://user-images.githubusercontent.com/8779942/43915680-bda22de0-9c0b-11e8-957e-79321a8a834b.png)\r\n\r\n\r\n### On GPU:0, 1 and 3\r\n![gpu012](https://user-images.githubusercontent.com/8779942/43915644-a35d67ec-9c0b-11e8-8cd6-e79e948699c4.png)\r\n\r\n\r\n### On GPU:0, 1,2 and 3\r\n![gpu0123](https://user-images.githubusercontent.com/8779942/43915637-9b08e7a6-9c0b-11e8-9621-5e679af4bae6.png)\r\n\r\n\r\n\r\n\r\n### Source code / logs\r\n[Source code](https://github.com/reger-men/PSPNet-Tensorflow-ModelParallelism)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21515", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21515/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21515/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21515/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21515", "id": 349060365, "node_id": "MDU6SXNzdWUzNDkwNjAzNjU=", "number": 21515, "title": "BUG: optimizer.compute_gradients() produces inconsistent gradient with the same training instance and label ", "user": {"login": "EdwardLin2014", "id": 8342812, "node_id": "MDQ6VXNlcjgzNDI4MTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/8342812?v=4", "gravatar_id": "", "url": "https://api.github.com/users/EdwardLin2014", "html_url": "https://github.com/EdwardLin2014", "followers_url": "https://api.github.com/users/EdwardLin2014/followers", "following_url": "https://api.github.com/users/EdwardLin2014/following{/other_user}", "gists_url": "https://api.github.com/users/EdwardLin2014/gists{/gist_id}", "starred_url": "https://api.github.com/users/EdwardLin2014/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/EdwardLin2014/subscriptions", "organizations_url": "https://api.github.com/users/EdwardLin2014/orgs", "repos_url": "https://api.github.com/users/EdwardLin2014/repos", "events_url": "https://api.github.com/users/EdwardLin2014/events{/privacy}", "received_events_url": "https://api.github.com/users/EdwardLin2014/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "michaelisard", "id": 5376757, "node_id": "MDQ6VXNlcjUzNzY3NTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/5376757?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelisard", "html_url": "https://github.com/michaelisard", "followers_url": "https://api.github.com/users/michaelisard/followers", "following_url": "https://api.github.com/users/michaelisard/following{/other_user}", "gists_url": "https://api.github.com/users/michaelisard/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelisard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelisard/subscriptions", "organizations_url": "https://api.github.com/users/michaelisard/orgs", "repos_url": "https://api.github.com/users/michaelisard/repos", "events_url": "https://api.github.com/users/michaelisard/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelisard/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "michaelisard", "id": 5376757, "node_id": "MDQ6VXNlcjUzNzY3NTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/5376757?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelisard", "html_url": "https://github.com/michaelisard", "followers_url": "https://api.github.com/users/michaelisard/followers", "following_url": "https://api.github.com/users/michaelisard/following{/other_user}", "gists_url": "https://api.github.com/users/michaelisard/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelisard/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelisard/subscriptions", "organizations_url": "https://api.github.com/users/michaelisard/orgs", "repos_url": "https://api.github.com/users/michaelisard/repos", "events_url": "https://api.github.com/users/michaelisard/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelisard/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2018-08-09T10:01:21Z", "updated_at": "2019-01-25T22:29:05Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu Server & Window 10\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: v1.8.0-0-g93bc2e2072 & v1.9.0-0-g25c197e023\r\n- **Python version**: 3.6.2\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**: V9.0.178\r\n- **GPU model and memory**: NVIDIA Tesla V100-SXM2-16GB & NVIDIA GeForce GTX 1080 Ti 11GB\r\n- **Exact command to reproduce**:\r\n### Source code / logs\r\n\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\n#########################################################################\r\n## Define Tensorflow Wrapper\r\nprint('Define Tensorflow Wrapper......')\r\ndef weight_variable(shape):\r\n    \"\"\"Create a bias variable with appropriate initialization.\"\"\"\r\n    initial = tf.constant(0.2, shape=shape)\r\n    return tf.Variable(initial)\r\n\r\ndef bias_variable(shape):\r\n    \"\"\"Create a bias variable with appropriate initialization.\"\"\"\r\n    initial = tf.constant(0.1, shape=shape)\r\n    return tf.Variable(initial)\r\n\r\ndef initialize_variable(shape, name):\r\n    with tf.name_scope(name + '_layer'):\r\n        with tf.name_scope('weights'):\r\n            weights = weight_variable(shape)\r\n        with tf.name_scope('biases'):\r\n            biases = bias_variable([1,shape[3],1,1])\r\n        return weights, biases\r\n\r\ndef conv2dLayer(inputs, weights, biases, name, act=tf.nn.relu):\r\n    preactivate = tf.nn.conv2d(inputs, weights, strides=[1,1,1,1], padding='VALID', data_format=\"NCHW\", dilations=[1,1,1,1], name='conv2d') + biases\r\n    return act(preactivate, name='activation')\r\n\r\ndef max_pool_3x3(x, name):\r\n    return tf.nn.max_pool(x, ksize=[1, 1, 3, 3], strides=[1, 1, 3, 3], padding='VALID', data_format=\"NCHW\", name=name)\r\n    \r\n#########################################################################\r\n## Create Neural Network\r\nprint('Create Neural Network......')\r\n# Initial Trainable Parameters\r\nConv1W,Conv1b = initialize_variable([3,3,1,2],'Conv1')\r\nConv2W,Conv2b = initialize_variable([3,3,2,2],'Conv2')\r\nConv3W,Conv3b = initialize_variable([3,3,2,2],'Conv3')\r\nConv4W,Conv4b = initialize_variable([3,3,2,2],'Conv4')\r\nfc1W,fc1b = initialize_variable([39,14,2,372],'fc1')\r\nfc2W,fc2b = initialize_variable([1,1,372,372],'fc2')\r\nfc3W,fc3b = initialize_variable([1,1,372,1],'fc3')\r\n# Placeholder for input and output\r\nx = tf.placeholder(tf.float32, [None,1,372,None], name='xInput')\r\ny_ = tf.placeholder(tf.float32, [None,1,1,None], name='yInput')\r\n# Architecture\r\nConv1 = conv2dLayer(x,Conv1W,Conv1b,'Conv1')\r\nConv2 = conv2dLayer(Conv1,Conv2W,Conv2b,'Conv2')\r\nMaxPool1 = max_pool_3x3(Conv2,'MaxPool1')\r\nConv3 = conv2dLayer(MaxPool1,Conv3W,Conv3b,'Conv3')\r\nConv4 = conv2dLayer(Conv3,Conv4W,Conv4b,'Conv4')\r\nMaxPool2 = max_pool_3x3(Conv4,'MaxPool2')\r\nfc1 = conv2dLayer(MaxPool2,fc1W,fc1b,'fc1')\r\nfc2 = conv2dLayer(fc1,fc2W,fc2b,'fc2')\r\ny = conv2dLayer(fc2,fc3W,fc3b,'fc3',act=tf.identity)\r\n# Define loss\r\ncrossEntropy = tf.nn.sigmoid_cross_entropy_with_logits(labels=y_, logits=y, name='crossEntropy')\r\nlossValue = tf.reduce_mean(crossEntropy, name='lossValue')\r\n# Define optimizer\r\n#optimizer = tf.train.AdadeltaOptimizer(learning_rate=0.001,rho=0.95,epsilon=1e-08,use_locking=False,name='Adadelta')\r\n#optimizer = tf.train.AdagradOptimizer(learning_rate=0.01,initial_accumulator_value=0.1,use_locking=False,name='Adagrad')\r\n#optimizer = tf.train.AdamOptimizer(learning_rate=0.001,beta1=0.9,beta2=0.999,epsilon=1e-08,use_locking=False,name='Adam')\r\n#optimizer = tf.train.MomentumOptimizer(learning_rate=0.01, momentum=0.95, name='nestrov', use_nesterov=True)\r\noptimizer = tf.train.GradientDescentOptimizer(learning_rate=0.01, name='GradientDescent')\r\ngvs = optimizer.compute_gradients(lossValue)\r\ntrain_step = optimizer.apply_gradients(gvs)\r\n\r\n#########################################################################\r\n## Illustrate compute_gradients() random issue\r\nprint('Load x and y input......')\r\ndata = np.load('testGrad.npz')\r\nxInput = data['x']\r\nyInput = data['y']\r\n\r\nprint(\"Session 1\")\r\nwith tf.Session() as sess1:\r\n    sess1.run(tf.global_variables_initializer())\r\n    lossValue_eval1, gvs_eval1 = sess1.run([lossValue,gvs], feed_dict={x:xInput,y_:yInput})\r\n    sess1.run(train_step, feed_dict={x:xInput,y_:yInput})\r\n    lossValue1_eval1, gvs1_eval1, = sess1.run([lossValue,gvs], feed_dict={x:xInput,y_:yInput})\r\n    sess1.close()\r\n\r\nprint(\"Session 2\")\r\nwith tf.Session() as sess2:\r\n    sess2.run(tf.global_variables_initializer())\r\n    lossValue_eval2, gvs_eval2 = sess2.run([lossValue,gvs], feed_dict={x:xInput,y_:yInput})\r\n    sess2.run(train_step, feed_dict={x:xInput,y_:yInput})\r\n    lossValue1_eval2, gvs1_eval2, = sess2.run([lossValue,gvs], feed_dict={x:xInput,y_:yInput})\r\n    sess2.close()\r\n\r\nprint('--------------------------------------------------')\r\nprint('Check whether they have the same values in each session')\r\nprint('Before Training: ')\r\nprint('lossValue? %r' % all(lossValue_eval1==lossValue_eval2))\r\ncheck_gvs_BT = np.zeros((14,2))\r\nfor i in range(14):\r\n    for j in range(2):\r\n        check_gvs_BT[i][j] = all(gvs_eval1[i][j] == gvs_eval2[i][j])\r\nprint('gvs? %r' % all(check_gvs_BT))\r\nprint('After Training: ')\r\nprint('lossValue? %r' % all(lossValue1_eval1==lossValue1_eval2))\r\ncheck_gvs_AT = np.zeros((14,2))\r\nfor i in range(14):\r\n    for j in range(2):\r\n        check_gvs_AT[i][j] = all(gvs1_eval1[i][j] == gvs1_eval2[i][j])\r\nprint('gvs? %r' % all(check_gvs_AT))\r\n\r\ntf.reset_default_graph()\r\n```\r\n\r\n### Describe the problem\r\nBy executing the above code with the fixed training instance and label (which you can download from https://www.dropbox.com/s/828v71z4tm399z2/testGrad.npz?dl=0 ), we can see that the gradient value computed by compute_gradients(),  gvs_eval1[0][0][0,0,0,0] & gvs_eval2[0][0][0,0,0,0] are not always the same in each session. This happens regardless which optimizer you use.\r\n\r\nCorrect me if I have made some stupid mistake in this code. As I have tried simple network architecture (for example, training y = weight * x), and compute_gradients() seems to be working fine. \r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21504", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21504/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21504/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21504/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21504", "id": 348954709, "node_id": "MDU6SXNzdWUzNDg5NTQ3MDk=", "number": 21504, "title": "Linking of rule '//tensorflow/core/grappler/costs:analytical_cost_estimator_test' failed", "user": {"login": "pvn25", "id": 6302707, "node_id": "MDQ6VXNlcjYzMDI3MDc=", "avatar_url": "https://avatars0.githubusercontent.com/u/6302707?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pvn25", "html_url": "https://github.com/pvn25", "followers_url": "https://api.github.com/users/pvn25/followers", "following_url": "https://api.github.com/users/pvn25/following{/other_user}", "gists_url": "https://api.github.com/users/pvn25/gists{/gist_id}", "starred_url": "https://api.github.com/users/pvn25/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pvn25/subscriptions", "organizations_url": "https://api.github.com/users/pvn25/orgs", "repos_url": "https://api.github.com/users/pvn25/repos", "events_url": "https://api.github.com/users/pvn25/events{/privacy}", "received_events_url": "https://api.github.com/users/pvn25/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "shivaniag", "id": 16565716, "node_id": "MDQ6VXNlcjE2NTY1NzE2", "avatar_url": "https://avatars1.githubusercontent.com/u/16565716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shivaniag", "html_url": "https://github.com/shivaniag", "followers_url": "https://api.github.com/users/shivaniag/followers", "following_url": "https://api.github.com/users/shivaniag/following{/other_user}", "gists_url": "https://api.github.com/users/shivaniag/gists{/gist_id}", "starred_url": "https://api.github.com/users/shivaniag/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shivaniag/subscriptions", "organizations_url": "https://api.github.com/users/shivaniag/orgs", "repos_url": "https://api.github.com/users/shivaniag/repos", "events_url": "https://api.github.com/users/shivaniag/events{/privacy}", "received_events_url": "https://api.github.com/users/shivaniag/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "shivaniag", "id": 16565716, "node_id": "MDQ6VXNlcjE2NTY1NzE2", "avatar_url": "https://avatars1.githubusercontent.com/u/16565716?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shivaniag", "html_url": "https://github.com/shivaniag", "followers_url": "https://api.github.com/users/shivaniag/followers", "following_url": "https://api.github.com/users/shivaniag/following{/other_user}", "gists_url": "https://api.github.com/users/shivaniag/gists{/gist_id}", "starred_url": "https://api.github.com/users/shivaniag/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shivaniag/subscriptions", "organizations_url": "https://api.github.com/users/shivaniag/orgs", "repos_url": "https://api.github.com/users/shivaniag/repos", "events_url": "https://api.github.com/users/shivaniag/events{/privacy}", "received_events_url": "https://api.github.com/users/shivaniag/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2018-08-09T02:39:38Z", "updated_at": "2019-09-19T10:55:16Z", "closed_at": null, "author_association": "NONE", "body": "------------------------\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: 1.10.0-rc1\r\n- **Python version**: 2.7.12\r\n- **Bazel version (if compiling from source)**: 0.16.0\r\n- **GCC/Compiler version (if compiling from source)**: 5.4.0\r\n- **CUDA/cuDNN version**: N/A\r\n- **GPU model and memory**: N/A\r\n- **Exact command to reproduce**: bazel build --tool_tag=ijwb:CLion --compilation_mode=dbg --copt=-O0 --copt=-g --strip=never --dynamic_mode=off --curses=no --color=yes --experimental_ui=no --progress_in_terminal_title=no --test_filter=AnalyticalCostEstimatorTest.SimpleTest:AnalyticalCostEstimatorTest/*.SimpleTest:*/AnalyticalCostEstimatorTest.SimpleTest/*:*/AnalyticalCostEstimatorTest/*.SimpleTest --config=monolithic --build_event_binary_file=/tmp/intellij-bep-991f7840-b7e9-4fc1-8f46-b72fcee6be72 --nobuild_event_binary_file_path_conversion -- //tensorflow/core/grappler/costs:analytical_cost_estimator_test\r\n\r\n\r\nI'm trying to run [this](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/grappler/costs/analytical_cost_estimator_test.cc) tensorflow test in debug mode using Bazel on CLion IDE. And, I get this error message:\r\n\r\nERROR: /home/name/tensorflow/tensorflow/core/grappler/costs/BUILD:317:1: Linking of rule '//tensorflow/core/grappler/costs:analytical_cost_estimator_test' failed (Exit 1).\r\ncollect2: error: ld returned 1 exit status\r\nTarget //tensorflow/core/grappler/costs:analytical_cost_estimator_test failed to build\r\n\r\nThe command that is used is:\r\n\r\nbazel build --tool_tag=ijwb:CLion --compilation_mode=dbg --copt=-O0 --copt=-g --strip=never --dynamic_mode=off --curses=no --color=yes --experimental_ui=no --progress_in_terminal_title=no --test_filter=AnalyticalCostEstimatorTest.SimpleTest:AnalyticalCostEstimatorTest/*.SimpleTest:*/AnalyticalCostEstimatorTest.SimpleTest/*:*/AnalyticalCostEstimatorTest/*.SimpleTest --config=monolithic --build_event_binary_file=/tmp/intellij-bep-991f7840-b7e9-4fc1-8f46-b72fcee6be72 --nobuild_event_binary_file_path_conversion -- //tensorflow/core/grappler/costs:analytical_cost_estimator_test\r\n\r\nSame command with --verbose_failures added:\r\n\r\n (cd /home/name/.cache/bazel/_bazel_name/0dcafb4e3b790050f9e05bb5277a4ba3/execroot/org_tensorflow && \\\r\n  exec env - \\\r\n    PATH=/home/name/bin:/home/name/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/usr/local/cuda-8.0/bin:/snap/bin \\\r\n    PWD=/proc/self/cwd \\\r\n    PYTHON_BIN_PATH=/usr/bin/python \\\r\n    PYTHON_LIB_PATH=/usr/local/lib/python2.7/dist-packages \\\r\n    TF_DOWNLOAD_CLANG=0 \\\r\n    TF_NEED_CUDA=0 \\\r\n    TF_NEED_OPENCL_SYCL=0 \\\r\n  /usr/bin/gcc -o bazel-out/k8-dbg/bin/tensorflow/core/grappler/costs/analytical_cost_estimator_test '-Wl,-rpath,$ORIGIN/,-rpath,$ORIGIN/..,-rpath,$ORIGIN/../..,-rpath,$ORIGIN/../../..' -pthread -pthread '-fuse-ld=gold' -Wl,-no-as-needed -Wl,-z,relro,-z,now -B/usr/bin -B/usr/bin -pass-exit-codes -Wl,@bazel-out/k8-dbg/bin/tensorflow/core/grappler/costs/analytical_cost_estimator_test-2.params)."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21491", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21491/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21491/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21491/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21491", "id": 348904395, "node_id": "MDU6SXNzdWUzNDg5MDQzOTU=", "number": 21491, "title": "Consider automatic casting rules for promoting dtypes", "user": {"login": "shoyer", "id": 1217238, "node_id": "MDQ6VXNlcjEyMTcyMzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/1217238?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shoyer", "html_url": "https://github.com/shoyer", "followers_url": "https://api.github.com/users/shoyer/followers", "following_url": "https://api.github.com/users/shoyer/following{/other_user}", "gists_url": "https://api.github.com/users/shoyer/gists{/gist_id}", "starred_url": "https://api.github.com/users/shoyer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shoyer/subscriptions", "organizations_url": "https://api.github.com/users/shoyer/orgs", "repos_url": "https://api.github.com/users/shoyer/repos", "events_url": "https://api.github.com/users/shoyer/events{/privacy}", "received_events_url": "https://api.github.com/users/shoyer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1093464312, "node_id": "MDU6TGFiZWwxMDkzNDY0MzEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:others", "name": "type:others", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tatatodd", "id": 5453737, "node_id": "MDQ6VXNlcjU0NTM3Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5453737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatatodd", "html_url": "https://github.com/tatatodd", "followers_url": "https://api.github.com/users/tatatodd/followers", "following_url": "https://api.github.com/users/tatatodd/following{/other_user}", "gists_url": "https://api.github.com/users/tatatodd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatatodd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatatodd/subscriptions", "organizations_url": "https://api.github.com/users/tatatodd/orgs", "repos_url": "https://api.github.com/users/tatatodd/repos", "events_url": "https://api.github.com/users/tatatodd/events{/privacy}", "received_events_url": "https://api.github.com/users/tatatodd/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tatatodd", "id": 5453737, "node_id": "MDQ6VXNlcjU0NTM3Mzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5453737?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tatatodd", "html_url": "https://github.com/tatatodd", "followers_url": "https://api.github.com/users/tatatodd/followers", "following_url": "https://api.github.com/users/tatatodd/following{/other_user}", "gists_url": "https://api.github.com/users/tatatodd/gists{/gist_id}", "starred_url": "https://api.github.com/users/tatatodd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tatatodd/subscriptions", "organizations_url": "https://api.github.com/users/tatatodd/orgs", "repos_url": "https://api.github.com/users/tatatodd/repos", "events_url": "https://api.github.com/users/tatatodd/events{/privacy}", "received_events_url": "https://api.github.com/users/tatatodd/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2018-08-08T21:48:22Z", "updated_at": "2019-03-12T22:32:52Z", "closed_at": null, "author_association": "MEMBER", "body": "### System information\r\n\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: NA\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: NA\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: NA\r\n- **TensorFlow installed from (source or binary)**: NA\r\n- **TensorFlow version (use command below)**: unknown 1.10.0-rc1\r\n- **Python version**: 3.6\r\n- **Bazel version (if compiling from source)**: NA\r\n- **GCC/Compiler version (if compiling from source)**: NA\r\n- **CUDA/cuDNN version**: NA\r\n- **GPU model and memory**: NA\r\n- **Exact command to reproduce**:\r\n\r\nArithmetic between objects with different dtypes only works with Python scalars, not Tensors:\r\n```\r\n# this works\r\n>>> tf.constant(1.0) * 2\r\n<tf.Tensor: id=4, shape=(), dtype=float32, numpy=2.0>\r\n\r\n# this doesn't\r\n>>> tf.constant(1.0) * tf.constant(2)\r\nInvalidArgumentError: cannot compute Mul as input #0 was expected to be a int32 tensor but is a float tensor [Op:Mul] name: mul/\r\n```\r\n\r\n### Describe the problem\r\n\r\nNumPy has well defined [casting rules](https://docs.scipy.org/doc/numpy/reference/ufuncs.html#casting-rules) for converting between dtypes. If an operation cannot be performed natively on the given dtypes (e.g., `np.add` between float32 and float64), then one or more of the inputs will be promoted to a higher data-type, e.g., float32 -> float64.\r\n\r\nThis is highly convenient, and remains one of the major annoyances when porting NumPy code to TensorFlow. TensorFlow code ends up littered with calls to `tf.cast()`. It's particularly annoying for any use-cases that require types other than float32, e.g., models that use complex numbers, because you can't simply cast every argument to float32.\r\n\r\nAn argument for not implementing this would be that TensorFlow strives to be more explicit than NumPy, and this could lead to unintended performance degradation. But I'm struggling to imagine cases where this would actually be the case. It's also easy to avoid by using explicit casting on everything, which could still be utilized by users who concerned about it. There are lots of areas where NumPy got things wrong by being undisciplined (e.g., indexing rules) but I have not heard any complaints about this one."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21488", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21488/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21488/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/21488/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/21488", "id": 348893459, "node_id": "MDU6SXNzdWUzNDg4OTM0NTk=", "number": 21488, "title": "Tensorflow PIP Package fails to build - AttributeError: module 'pandas' has no attribute 'core'", "user": {"login": "matt-garman", "id": 3482585, "node_id": "MDQ6VXNlcjM0ODI1ODU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3482585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/matt-garman", "html_url": "https://github.com/matt-garman", "followers_url": "https://api.github.com/users/matt-garman/followers", "following_url": "https://api.github.com/users/matt-garman/following{/other_user}", "gists_url": "https://api.github.com/users/matt-garman/gists{/gist_id}", "starred_url": "https://api.github.com/users/matt-garman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/matt-garman/subscriptions", "organizations_url": "https://api.github.com/users/matt-garman/orgs", "repos_url": "https://api.github.com/users/matt-garman/repos", "events_url": "https://api.github.com/users/matt-garman/events{/privacy}", "received_events_url": "https://api.github.com/users/matt-garman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "yifeif", "id": 1192265, "node_id": "MDQ6VXNlcjExOTIyNjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/1192265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yifeif", "html_url": "https://github.com/yifeif", "followers_url": "https://api.github.com/users/yifeif/followers", "following_url": "https://api.github.com/users/yifeif/following{/other_user}", "gists_url": "https://api.github.com/users/yifeif/gists{/gist_id}", "starred_url": "https://api.github.com/users/yifeif/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yifeif/subscriptions", "organizations_url": "https://api.github.com/users/yifeif/orgs", "repos_url": "https://api.github.com/users/yifeif/repos", "events_url": "https://api.github.com/users/yifeif/events{/privacy}", "received_events_url": "https://api.github.com/users/yifeif/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "yifeif", "id": 1192265, "node_id": "MDQ6VXNlcjExOTIyNjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/1192265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yifeif", "html_url": "https://github.com/yifeif", "followers_url": "https://api.github.com/users/yifeif/followers", "following_url": "https://api.github.com/users/yifeif/following{/other_user}", "gists_url": "https://api.github.com/users/yifeif/gists{/gist_id}", "starred_url": "https://api.github.com/users/yifeif/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yifeif/subscriptions", "organizations_url": "https://api.github.com/users/yifeif/orgs", "repos_url": "https://api.github.com/users/yifeif/repos", "events_url": "https://api.github.com/users/yifeif/events{/privacy}", "received_events_url": "https://api.github.com/users/yifeif/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2018-08-08T21:10:27Z", "updated_at": "2019-01-30T13:36:44Z", "closed_at": null, "author_association": "NONE", "body": "This may be a bug in the Python PIP build script(s), or something askew in my environment.  I am trying to build Tensorflow from source, to include AVX/AVX2 support.  It always fails with the error log pasted below.  I have tried the latest git pull over the last week or so (i.e. multiple git pulls, followed by \"bazel clean ; bazel build <options>\".  I have also tried the same with the r1.10 branch.\r\n\r\nThere is [this somewhat similar question on StackOverflow](https://stackoverflow.com/questions/36521691/importing-pandas-gives-error-attributeerror-module-pandas-has-no-attribute-c).  That is more about using Pandas, rather than building Tensorflow.  At any rate I tried all the suggestions to no avail.  And my Pandas is working:\r\n\r\n```\r\n$ python -c \"import pandas as pd ; import pandas.core.ops as ops ; print(pd.__version__)\" && echo $?\r\n0.23.4\r\n0\r\n```\r\n\r\nSystem Details:\r\n-----------------\r\n\r\n  - Have I written custom code: NO\r\n  - OS Platform and Distribution: CentOS Linux 7.4.1708 with Anaconda Python3 distribution\r\n  - Mobile device: N/A\r\n  - TensorFlow installed from: not yet installed, trying to build from source (no build-halting errors during the C/C++ portion of the build)\r\n  - TensorFlow version: latest git pull over the last several days, both master and r1.10 branch\r\n  - Python version: Python 3.6.6 :: Anaconda custom (64-bit)\r\n  - Bazel version (if compiling from source):\r\n```\r\n$ bazel version\r\nBuild label: 0.16.0- (@non-git)\r\nBuild target: bazel-out/k8-opt/bin/src/main/java/com/google/devtools/build/lib/bazel/BazelServer_deploy.jar\r\nBuild time: Tue Jul 31 18:27:17 2018 (1533061637)\r\nBuild timestamp: 1533061637\r\nBuild timestamp as int: 1533061637\r\n```\r\n  - GCC/Compiler version: gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-16)\r\n  - CUDA/cuDNN version: N/A\r\n  - GPU model and memory: N/A\r\n  - Exact command to reproduce:\r\n```\r\n  $ git clone https://github.com/tensorflow/tensorflow.git\r\n  $ cd tensorflow\r\n  $ ./configure # accept all defaults\r\n  $ bazel build -c opt --copt=-mavx --copt=-mavx2 --copt=-mfma --copt=-msse4.1 --copt=-msse4.2 --verbose_failures -k //tensorflow/tools/pip_package:build_pip_package\r\n```\r\n\r\nOutput of tf_env_collect.sh:\r\n------------------------------\r\n\r\n== cat /etc/issue ===============================================\r\nLinux septictank 3.10.0-693.21.1.el7.x86_64 #1 SMP Wed Mar 7 19:03:37 UTC 2018 x\r\n86_64 x86_64 x86_64 GNU/Linux\r\nVERSION=\"7 (Core)\"\r\nVERSION_ID=\"7\"\r\nCENTOS_MANTISBT_PROJECT_VERSION=\"7\"\r\nREDHAT_SUPPORT_PRODUCT_VERSION=\"7\"\r\n\r\n== are we in docker =============================================\r\nNo\r\n\r\n== compiler =====================================================\r\nc++ (GCC) 4.8.5 20150623 (Red Hat 4.8.5-16)\r\nCopyright (C) 2015 Free Software Foundation, Inc.\r\nThis is free software; see the source for copying conditions.  There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n\r\n\r\n== uname -a =====================================================\r\nLinux septictank 3.10.0-693.21.1.el7.x86_64 #1 SMP Wed Mar 7 19:03:37 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n== check pips ===================================================\r\nnumpy                              1.15.0\r\nnumpydoc                           0.8.0\r\nprotobuf                           3.5.2\r\n\r\n== check for virtualenv =========================================\r\nFalse\r\n\r\n== tensorflow import ============================================\r\nTraceback (most recent call last):\r\n  File \"/home/matt/tensorflow/tensorflow/python/platform/self_check.py\", line 2$, in <module>\r\n    from tensorflow.python.platform import build_info\r\nImportError: cannot import name 'build_info'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\n  File \"/home/matt/tensorflow/tensorflow/__init__.py\", line 24, in <module>\r\n    from tensorflow.python import pywrap_tensorflow  # pylint: disable=unused-i$port\r\n  File \"/home/matt/tensorflow/tensorflow/python/__init__.py\", line 49, in <modul\r\ne>\r\n    from tensorflow.python import pywrap_tensorflow\r\n  File \"/home/matt/tensorflow/tensorflow/python/pywrap_tensorflow.py\", line 25,\r\nin <module>\r\n    from tensorflow.python.platform import self_check\r\n  File \"/home/matt/tensorflow/tensorflow/python/platform/self_check.py\", line 27\r\n, in <module>\r\n    raise ImportError(\"Could not import tensorflow. Do not import tensorflow \"\r\nImportError: Could not import tensorflow. Do not import tensorflow from its sour\r\nce directory; change directory to outside the TensorFlow source tree, and relaun\r\nch your Python interpreter from there.\r\n\r\n== env ==========================================================\r\nLD_LIBRARY_PATH is unset\r\nDYLD_LIBRARY_PATH is unset\r\n\r\n== nvidia-smi ===================================================\r\n./tf_env_collect.sh: line 105: nvidia-smi: command not found\r\n\r\n== cuda libs  ===================================================\r\n\r\n\r\nError message from bazel:\r\n-----------------------------\r\n```\r\nERROR: /home/matt/tensorflow/tensorflow/python/estimator/api/BUILD:12:1: Couldn't build file tensorflow/python/estimator/api/__init__.py: Executing genrule //tensorflow/python/estimator/api:estimator_python_api_gen failed (Exit 1): bash failed: error executing command\r\n  (cd /home/matt/.cache/bazel/_bazel_matt/b51f46dcf2ef174fa43a943ad13629f0/execroot/org_tensorflow && \\\r\n  exec env - \\\r\n    PATH=/opt/anaconda3/bin:/opt/anaconda3/bin:/usr/lib64/qt-3.3/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/usr/local/bin:/sbin:/usr/sbin:/usr/local/bin:/sbin:/usr/sbin \\\r\n    PYTHON_BIN_PATH=/opt/anaconda3/bin/python \\\r\n    PYTHON_LIB_PATH=/opt/anaconda3/lib/python3.6/site-packages \\\r\n    TF_DOWNLOAD_CLANG=0 \\\r\n    TF_NEED_CUDA=0 \\\r\n    TF_NEED_OPENCL_SYCL=0 \\\r\n  /bin/bash -c 'source external/bazel_tools/tools/genrule/genrule-setup.sh; bazel-out/host/bin/tensorflow/python/estimator/api/create_tensorflow.python.estimator_api  --apidir=bazel-out/k8-opt/genfiles/tensorflow/python/estimator/api --apiname=estimator --apiversion=2 --package=tensorflow.python.estimator --output_package=tensorflow.python.estimator.api bazel-out/k8-opt/genfiles/tensorflow/python/estimator/api/__init__.py bazel-out/k8-opt/genfiles/tensorflow/python/estimator/api/estimator/__init__.py bazel-out/k8-opt/genfiles/tensorflow/python/estimator/api/estimator/export/__init__.py bazel-out/k8-opt/genfiles/tensorflow/python/estimator/api/estimator/inputs/__init__.py')\r\ntf.estimator package not installed.\r\nTraceback (most recent call last):\r\n  File \"/home/matt/.cache/bazel/_bazel_matt/b51f46dcf2ef174fa43a943ad13629f0/execroot/org_tensorflow/bazel-out/host/bin/tensorflow/python/estimator/api/create_tensorflow.python.estimator_api.runfiles/org_tensorflow/tensorflow/python/tools/api/generator/create_python_api.py\", line 511, in <module>\r\n    main()\r\n  File \"/home/matt/.cache/bazel/_bazel_matt/b51f46dcf2ef174fa43a943ad13629f0/execroot/org_tensorflow/bazel-out/host/bin/tensorflow/python/estimator/api/create_tensorflow.python.estimator_api.runfiles/org_tensorflow/tensorflow/python/tools/api/generator/create_python_api.py\", line 504, in main\r\n    importlib.import_module(args.package)\r\n  File \"/opt/anaconda3/lib/python3.6/importlib/__init__.py\", line 126, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\n  File \"<frozen importlib._bootstrap>\", line 994, in _gcd_import\r\n  File \"<frozen importlib._bootstrap>\", line 971, in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 955, in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 665, in _load_unlocked\r\n  File \"<frozen importlib._bootstrap_external>\", line 678, in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 219, in _call_with_frames_removed\r\n  File \"/home/matt/.cache/bazel/_bazel_matt/b51f46dcf2ef174fa43a943ad13629f0/execroot/org_tensorflow/bazel-out/host/bin/tensorflow/python/estimator/api/create_tensorflow.python.estimator_api.runfiles/org_tensorflow/tensorflow/python/estimator/__init__.py\", line 25, in <module>\r\n    import tensorflow.python.estimator.estimator_lib\r\n  File \"/home/matt/.cache/bazel/_bazel_matt/b51f46dcf2ef174fa43a943ad13629f0/execroot/org_tensorflow/bazel-out/host/bin/tensorflow/python/estimator/api/create_tensorflow.python.estimator_api.runfiles/org_tensorflow/tensorflow/python/estimator/estimator_lib.py\", line 41, in <module>\r\n    from tensorflow.python.estimator.inputs import inputs\r\n  File \"/home/matt/.cache/bazel/_bazel_matt/b51f46dcf2ef174fa43a943ad13629f0/execroot/org_tensorflow/bazel-out/host/bin/tensorflow/python/estimator/api/create_tensorflow.python.estimator_api.runfiles/org_tensorflow/tensorflow/python/estimator/inputs/inputs.py\", line 23, in <module>\r\n    from tensorflow.python.estimator.inputs.pandas_io import pandas_input_fn\r\n  File \"/home/matt/.cache/bazel/_bazel_matt/b51f46dcf2ef174fa43a943ad13629f0/execroot/org_tensorflow/bazel-out/host/bin/tensorflow/python/estimator/api/create_tensorflow.python.estimator_api.runfiles/org_tensorflow/tensorflow/python/estimator/inputs/pandas_io.py\", line 31, in <module>\r\n    import pandas as pd\r\n  File \"/opt/anaconda3/lib/python3.6/site-packages/pandas/__init__.py\", line 42, in <module>\r\n    from pandas.core.api import *\r\n  File \"/opt/anaconda3/lib/python3.6/site-packages/pandas/core/api.py\", line 10, in <module>\r\n    from pandas.core.groupby.groupby import Grouper\r\n  File \"/opt/anaconda3/lib/python3.6/site-packages/pandas/core/groupby/__init__.py\", line 2, in <module>\r\n    from pandas.core.groupby.groupby import (\r\n  File \"/opt/anaconda3/lib/python3.6/site-packages/pandas/core/groupby/groupby.py\", line 49, in <module>\r\n    from pandas.core.frame import DataFrame\r\n  File \"/opt/anaconda3/lib/python3.6/site-packages/pandas/core/frame.py\", line 74, in <module>\r\n    from pandas.core.series import Series\r\n  File \"/opt/anaconda3/lib/python3.6/site-packages/pandas/core/series.py\", line 67, in <module>\r\n    import pandas.core.ops as ops\r\nAttributeError: module 'pandas' has no attribute 'core'\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\n```\r\n"}]