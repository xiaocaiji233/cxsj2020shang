[{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32902", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32902/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32902/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32902/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32902", "id": 499872754, "node_id": "MDU6SXNzdWU0OTk4NzI3NTQ=", "number": 32902, "title": "bug when supplying metadata files for embeddings in tensorboard callback", "user": {"login": "ophiry", "id": 5228696, "node_id": "MDQ6VXNlcjUyMjg2OTY=", "avatar_url": "https://avatars1.githubusercontent.com/u/5228696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ophiry", "html_url": "https://github.com/ophiry", "followers_url": "https://api.github.com/users/ophiry/followers", "following_url": "https://api.github.com/users/ophiry/following{/other_user}", "gists_url": "https://api.github.com/users/ophiry/gists{/gist_id}", "starred_url": "https://api.github.com/users/ophiry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ophiry/subscriptions", "organizations_url": "https://api.github.com/users/ophiry/orgs", "repos_url": "https://api.github.com/users/ophiry/repos", "events_url": "https://api.github.com/users/ophiry/events{/privacy}", "received_events_url": "https://api.github.com/users/ophiry/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-09-29T07:31:11Z", "updated_at": "2020-03-18T14:08:36Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):MacOS\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary):binary\r\n- TensorFlow version (use command below):2.0.0-dev20190927\r\n- Python version: 3.7\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\n\r\n**Describe the current behavior**\r\ngetting the error:\r\n`ValueError: Unrecognized `Embedding` layer names passed to `keras.callbacks.TensorBoard` `embeddings_metadata` argument: dict_keys(['char_embeddings'])`\r\nwhen passing embeddings_metadata to tensorflow.keras.callback.TesnorBoard\r\n**Describe the expected behavior**\r\nuse the metadata in tensorboard\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\nin https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/keras/callbacks.py#L1547\r\n\r\n```\r\n            if layer.name in embedding.metadata_path:\r\n              embedding.metadata_path = self.embeddings_metadata.pop(layer.name)\r\n\r\n```\r\nshould be:\r\n```\r\n            if layer.name in self.embeddings_metadata:\r\n              embedding.metadata_path = self.embeddings_metadata.pop(layer.name)\r\n\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32898", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32898/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32898/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32898/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32898", "id": 499851361, "node_id": "MDU6SXNzdWU0OTk4NTEzNjE=", "number": 32898, "title": "tf.lite not support Merge, RandomUniform, Switch", "user": {"login": "egolearner", "id": 45122959, "node_id": "MDQ6VXNlcjQ1MTIyOTU5", "avatar_url": "https://avatars1.githubusercontent.com/u/45122959?v=4", "gravatar_id": "", "url": "https://api.github.com/users/egolearner", "html_url": "https://github.com/egolearner", "followers_url": "https://api.github.com/users/egolearner/followers", "following_url": "https://api.github.com/users/egolearner/following{/other_user}", "gists_url": "https://api.github.com/users/egolearner/gists{/gist_id}", "starred_url": "https://api.github.com/users/egolearner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/egolearner/subscriptions", "organizations_url": "https://api.github.com/users/egolearner/orgs", "repos_url": "https://api.github.com/users/egolearner/repos", "events_url": "https://api.github.com/users/egolearner/events{/privacy}", "received_events_url": "https://api.github.com/users/egolearner/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-09-29T03:33:41Z", "updated_at": "2019-09-30T08:58:45Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): CentOS 7\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (or github SHA if from source): 1.14.0\r\n\r\n\r\n**Provide the text output from tflite_convert**\r\n\r\n```\r\n2019-09-29 11:27:27.677102: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 4963 operators, 8473 arrays (0 quantized)\r\n2019-09-29 11:27:28.107098: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After Removing unused ops pass 1: 4959 operators, 8467 arrays (0 quantized)\r\n2019-09-29 11:27:28.858936: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 4959 operators, 8467 arrays (0 quantized)\r\n2019-09-29 11:27:29.762413: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 1: 4823 operators, 8044 arrays (0 quantized)\r\n2019-09-29 11:27:30.695850: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before Group bidirectional sequence lstm/rnn: 4823 operators, 8044 arrays (0 quantized)\r\n2019-09-29 11:27:31.376652: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before dequantization graph transformations: 4823 operators, 8044 arrays (0 quantized)\r\n2019-09-29 11:27:31.590536: I tensorflow/lite/toco/allocate_transient_arrays.cc:345] Total transient array allocated size: 19328 bytes, theoretical optimal value: 2048 bytes.\r\n2019-09-29 11:27:31.918181: E tensorflow/lite/toco/toco_tooling.cc:456] We are continually in the process of adding support to TensorFlow Lite for more ops. It would be helpful if you could inform us of how this conversion went by opening a github issue at https://github.com/tensorflow/tensorflow/issues/new?template=40-tflite-op-request.md\r\n and pasting the following:\r\n\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime and are not recognized by TensorFlow. If you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: ADD, CAST, CONCATENATION, FLOOR, FULLY_CONNECTED, GATHER, GREATER_EQUAL, LOGISTIC, MUL, PACK, REDUCE_PROD, RESHAPE, SELECT, SHAPE, SLICE, STRIDED_SLICE, SUM, TILE, UNIQUE, WHERE, ZEROS_LIKE. Here is a list of operators for which you will need custom implementations: Merge, RandomUniform, Switch.\r\nTraceback (most recent call last):\r\n  File \"/home/user/.local/bin/toco_from_protos\", line 11, in <module>\r\n    sys.exit(main())\r\n  File \"/home/user/.local/lib/python3.6/site-packages/tensorflow/lite/toco/python/toco_from_protos.py\", line 59, in main\r\n    app.run(main=execute, argv=[sys.argv[0]] + unparsed)\r\n  File \"/home/user/.local/lib/python3.6/site-packages/tensorflow/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/usr/local/lib/python3.6/site-packages/absl/app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"/usr/local/lib/python3.6/site-packages/absl/app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/home/user/.local/lib/python3.6/site-packages/tensorflow/lite/toco/python/toco_from_protos.py\", line 33, in execute\r\n    output_str = tensorflow_wrap_toco.TocoConvert(model_str, toco_str, input_str)\r\nException: We are continually in the process of adding support to TensorFlow Lite for more ops. It would be helpful if you could inform us of how this conversion went by opening a github issue at https://github.com/tensorflow/tensorflow/issues/new?template=40-tflite-op-request.md\r\n and pasting the following:\r\n\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime and are not recognized by TensorFlow. If you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: ADD, CAST, CONCATENATION, FLOOR, FULLY_CONNECTED, GATHER, GREATER_EQUAL, LOGISTIC, MUL, PACK, REDUCE_PROD, RESHAPE, SELECT, SHAPE, SLICE, STRIDED_SLICE, SUM, TILE, UNIQUE, WHERE, ZEROS_LIKE. Here is a list of operators for which you will need custom implementations: Merge, RandomUniform, Switch.\r\n```\r\n\r\nAlso, please include a link to a GraphDef or the model if possible.\r\n\r\n**Any other info / logs**\r\n\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\n```python\r\nconverter = tf.lite.TFLiteConverter.from_saved_model(\r\n    model_path, input_arrays=input_arrays, output_arrays=output_arrays)\r\nconverter.post_training_quantize=True\r\nconverter.target_ops = [tf.lite.OpsSet.TFLITE_BUILTINS,\r\n                                       tf.lite.OpsSet.SELECT_TF_OPS]\r\ntflite_quantized_model = converter.convert()\r\nopen(\"quantized_model.tflite\", \"wb\").write(tflite_quantized_model)\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32896", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32896/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32896/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32896/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32896", "id": 499848002, "node_id": "MDU6SXNzdWU0OTk4NDgwMDI=", "number": 32896, "title": "How to get cublas handle to run cublas function?", "user": {"login": "7oud", "id": 7981826, "node_id": "MDQ6VXNlcjc5ODE4MjY=", "avatar_url": "https://avatars0.githubusercontent.com/u/7981826?v=4", "gravatar_id": "", "url": "https://api.github.com/users/7oud", "html_url": "https://github.com/7oud", "followers_url": "https://api.github.com/users/7oud/followers", "following_url": "https://api.github.com/users/7oud/following{/other_user}", "gists_url": "https://api.github.com/users/7oud/gists{/gist_id}", "starred_url": "https://api.github.com/users/7oud/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/7oud/subscriptions", "organizations_url": "https://api.github.com/users/7oud/orgs", "repos_url": "https://api.github.com/users/7oud/repos", "events_url": "https://api.github.com/users/7oud/events{/privacy}", "received_events_url": "https://api.github.com/users/7oud/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "timshen91", "id": 1157432, "node_id": "MDQ6VXNlcjExNTc0MzI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1157432?v=4", "gravatar_id": "", "url": "https://api.github.com/users/timshen91", "html_url": "https://github.com/timshen91", "followers_url": "https://api.github.com/users/timshen91/followers", "following_url": "https://api.github.com/users/timshen91/following{/other_user}", "gists_url": "https://api.github.com/users/timshen91/gists{/gist_id}", "starred_url": "https://api.github.com/users/timshen91/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/timshen91/subscriptions", "organizations_url": "https://api.github.com/users/timshen91/orgs", "repos_url": "https://api.github.com/users/timshen91/repos", "events_url": "https://api.github.com/users/timshen91/events{/privacy}", "received_events_url": "https://api.github.com/users/timshen91/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "timshen91", "id": 1157432, "node_id": "MDQ6VXNlcjExNTc0MzI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1157432?v=4", "gravatar_id": "", "url": "https://api.github.com/users/timshen91", "html_url": "https://github.com/timshen91", "followers_url": "https://api.github.com/users/timshen91/followers", "following_url": "https://api.github.com/users/timshen91/following{/other_user}", "gists_url": "https://api.github.com/users/timshen91/gists{/gist_id}", "starred_url": "https://api.github.com/users/timshen91/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/timshen91/subscriptions", "organizations_url": "https://api.github.com/users/timshen91/orgs", "repos_url": "https://api.github.com/users/timshen91/repos", "events_url": "https://api.github.com/users/timshen91/events{/privacy}", "received_events_url": "https://api.github.com/users/timshen91/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-09-29T02:52:32Z", "updated_at": "2019-10-17T06:33:20Z", "closed_at": null, "author_association": "NONE", "body": "I write a custom op using cublas function `cublasCgetrfBatched` and `cublasCgetriBatched`, the functions use cublas handle as a input param, however the `cublasCreate(&handle);` cost nearly 100ms. \r\nI think the TF has already integrate CUBLAS module, `cublasCreate(&handle)` muse have been invoked in the init process, then how to get the handle? An example may be the best!"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32895", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32895/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32895/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32895/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32895", "id": 499843849, "node_id": "MDU6SXNzdWU0OTk4NDM4NDk=", "number": 32895, "title": "Decorated the call methods of tf.keras.Model subclass with @tf.function or not , result is very different", "user": {"login": "payne4handsome", "id": 28085731, "node_id": "MDQ6VXNlcjI4MDg1NzMx", "avatar_url": "https://avatars2.githubusercontent.com/u/28085731?v=4", "gravatar_id": "", "url": "https://api.github.com/users/payne4handsome", "html_url": "https://github.com/payne4handsome", "followers_url": "https://api.github.com/users/payne4handsome/followers", "following_url": "https://api.github.com/users/payne4handsome/following{/other_user}", "gists_url": "https://api.github.com/users/payne4handsome/gists{/gist_id}", "starred_url": "https://api.github.com/users/payne4handsome/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/payne4handsome/subscriptions", "organizations_url": "https://api.github.com/users/payne4handsome/orgs", "repos_url": "https://api.github.com/users/payne4handsome/repos", "events_url": "https://api.github.com/users/payne4handsome/events{/privacy}", "received_events_url": "https://api.github.com/users/payne4handsome/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-09-29T02:09:34Z", "updated_at": "2019-11-04T20:47:08Z", "closed_at": null, "author_association": "NONE", "body": "System information\r\n\r\nOS Platform and Distribution\r\nMac os (10.14.6)\r\nTensorFlow installed from (source or binary):\r\nbinary\r\nTensorFlow version (use command below):\r\n2.0.0rc1\r\nPython version:\r\nPython 3.6.4\r\nI implement a  model with tensorflow keras just copy [official tutorials](https://www.tensorflow.org/tutorials/quickstart/advanced). The code is shown below\r\n\r\n```\r\nimport numpy as np\r\nfrom tensorflow.keras.layers import Dense, Flatten, Conv2D\r\nfrom tensorflow.keras import Model\r\nimport tensorflow as tf\r\nimport time\r\nmnist = tf.keras.datasets.mnist\r\n(x_train, y_train), (x_test, y_test) = mnist.load_data()\r\nx_train, x_test = x_train, x_test\r\ny_train, y_test = y_train , y_test\r\nx_train = x_train[..., tf.newaxis].astype(np.float64)\r\nx_test = x_test[..., tf.newaxis].astype(np.float64)\r\ntrain_ds = tf.data.Dataset.from_tensor_slices(\r\n(x_train, y_train)).shuffle(1000).batch(256)\r\ntest_ds = tf.data.Dataset.from_tensor_slices((x_test, y_test)).batch(256)\r\n\r\nclass MyModel(Model):\r\n    def __init__(self, *args, **kwargs):\r\n        super(MyModel, self).__init__(args, kwargs)\r\n        self.conv1 = Conv2D(32, 3, activation='relu')\r\n        self.flatten = Flatten()\r\n        self.d1 = Dense(128, activation='relu')\r\n        self.d2 = Dense(10, activation='softmax')\r\n        \r\n    def call(self, x):\r\n        x = self.conv1(x)\r\n        x = self.flatten(x)\r\n        x = self.d1(x)\r\n        return self.d2(x)\r\nmodel = MyModel()\r\nmodel.build((512, 28, 28, 1))\r\nloss_object = tf.keras.losses.SparseCategoricalCrossentropy()\r\noptimizer = tf.keras.optimizers.Adam()\r\ntrain_loss = tf.keras.metrics.Mean(name='train_loss')\r\ntrain_accuracy = tf.keras.metrics.SparseCategoricalAccuracy(name='train_accuracy')\r\n\r\ntest_loss = tf.keras.metrics.Mean(name='test_loss')\r\ntest_accuracy = tf.keras.metrics.SparseCategoricalAccuracy(name='test_accuracy')\r\n@tf.function\r\ndef train_step(images, labels):\r\n    with tf.GradientTape() as tape:\r\n        predictions = model(images)\r\n        loss = loss_object(labels, predictions)\r\n    gradients = tape.gradient(loss, model.trainable_variables)\r\n    optimizer.apply_gradients(zip(gradients, model.trainable_variables))\r\n\r\n    train_loss(loss)\r\n    train_accuracy(labels, predictions)\r\n@tf.function\r\ndef test_step(images, labels):\r\n    predictions = model(images)\r\n    t_loss = loss_object(labels, predictions)\r\n\r\n    test_loss(t_loss)\r\n    test_accuracy(labels, predictions)\r\n\r\nEPOCHS = 100\r\n\r\nfor epoch in range(EPOCHS):\r\n    start = time.time()\r\n    for images, labels in train_ds:\r\n        train_step(tf.cast(images, tf.float32), labels)\r\n\r\n    model.reset_metrics()\r\n    for test_images, test_labels in test_ds:\r\n        test_step(tf.cast(test_images, tf.float32), test_labels)\r\n    end = time.time()\r\n    template = 'Epoch {}, Loss: {}, Accuracy: {}, Test Loss: {}, Test Accuracy: {}, cost:{}'\r\n    print(\r\n        template.format(epoch + 1, train_loss.result(),\r\n                        train_accuracy.result() * 100, test_loss.result(),\r\n                        test_accuracy.result() * 100, end -start))\r\n```\r\nThe result show below\r\n```\r\nEpoch 1, Loss: 3.311713457107544, Accuracy: 89.99500274658203, Test Loss: 0.22570940852165222, Test Accuracy: 95.55000305175781, cost:14.249950170516968\r\nEpoch 2, Loss: 1.7273597717285156, Accuracy: 93.3933334350586, Test Loss: 0.18705108761787415, Test Accuracy: 96.28499603271484, cost:13.976628065109253\r\nEpoch 3, Loss: 1.1731806993484497, Accuracy: 95.00333404541016, Test Loss: 0.1706559658050537, Test Accuracy: 96.61333465576172, cost:14.125600099563599\r\nEpoch 4, Loss: 0.8890712261199951, Accuracy: 95.9800033569336, Test Loss: 0.1615695059299469, Test Accuracy: 96.78250122070312, cost:14.998674154281616\r\nEpoch 5, Loss: 0.7157263159751892, Accuracy: 96.64299774169922, Test Loss: 0.15943895280361176, Test Accuracy: 96.91000366210938, cost:14.496413230895996\r\nEpoch 6, Loss: 0.5996174216270447, Accuracy: 97.10027313232422, Test Loss: 0.15636563301086426, Test Accuracy: 97.01667022705078, cost:12.977428197860718\r\nEpoch 7, Loss: 0.5162842273712158, Accuracy: 97.44285583496094, Test Loss: 0.15558230876922607, Test Accuracy: 97.07571411132812, cost:13.014786005020142\r\nEpoch 8, Loss: 0.4553721249103546, Accuracy: 97.66041564941406, Test Loss: 0.1616506278514862, Test Accuracy: 97.0574951171875, cost:14.170269966125488\r\nEpoch 9, Loss: 0.4086601734161377, Accuracy: 97.81925964355469, Test Loss: 0.16302895545959473, Test Accuracy: 97.0955581665039, cost:13.114216804504395\r\nEpoch 10, Loss: 0.3699580430984497, Accuracy: 97.98149871826172, Test Loss: 0.16444820165634155, Test Accuracy: 97.10900115966797, cost:12.783933162689209\r\nEpoch 11, Loss: 0.3377893567085266, Accuracy: 98.12287902832031, Test Loss: 0.1649542897939682, Test Accuracy: 97.1427230834961, cost:12.907387256622314\r\nEpoch 12, Loss: 0.31051450967788696, Accuracy: 98.2509765625, Test Loss: 0.16677971184253693, Test Accuracy: 97.17666625976562, cost:12.56903600692749\r\nEpoch 13, Loss: 0.28760311007499695, Accuracy: 98.35563659667969, Test Loss: 0.168002188205719, Test Accuracy: 97.21846008300781, cost:13.040626049041748\r\nEpoch 14, Loss: 0.26825159788131714, Accuracy: 98.44261932373047, Test Loss: 0.17205245792865753, Test Accuracy: 97.22142791748047, cost:13.130248785018921\r\nEpoch 15, Loss: 0.2515304386615753, Accuracy: 98.51310729980469, Test Loss: 0.17627017199993134, Test Accuracy: 97.23332977294922, cost:12.66043996810913\r\nEpoch 16, Loss: 0.2367033064365387, Accuracy: 98.58124542236328, Test Loss: 0.17778924107551575, Test Accuracy: 97.26062774658203, cost:12.836369037628174\r\nEpoch 17, Loss: 0.2236185222864151, Accuracy: 98.6434326171875, Test Loss: 0.17880629003047943, Test Accuracy: 97.2752914428711, cost:12.845327854156494\r\nEpoch 18, Loss: 0.21163013577461243, Accuracy: 98.706298828125, Test Loss: 0.18086740374565125, Test Accuracy: 97.29389190673828, cost:13.29944920539856\r\nEpoch 19, Loss: 0.20079432427883148, Accuracy: 98.76526641845703, Test Loss: 0.18283464014530182, Test Accuracy: 97.31105041503906, cost:12.92448115348816\r\nEpoch 20, Loss: 0.19131030142307281, Accuracy: 98.81291198730469, Test Loss: 0.18425647914409637, Test Accuracy: 97.32350158691406, cost:12.959301948547363\r\n.....\r\n```\r\n\r\nBut I find can  Decorated the call methods with call method from [this](https://www.tensorflow.org/versions/r2.0/api_docs/python/tf/function#used_in_the_tutorials).\r\n\r\nso I add annotation @tf.function to call method with above code(The rest of the code remains unchanged), just like this\r\n```\r\n   @tf.function\r\n    def call(self, x):\r\n        x = self.conv1(x)\r\n        x = self.flatten(x)\r\n        x = self.d1(x)\r\n        return self.d2(x)\r\n```\r\nThe result show below\r\n```\r\nEpoch 1, Loss: 11.509495735168457, Accuracy: 28.50666618347168, Test Loss: 11.525819778442383, Test Accuracy: 28.400001525878906, cost:14.542086839675903\r\nEpoch 2, Loss: 11.499279022216797, Accuracy: 28.60249900817871, Test Loss: 11.579718589782715, Test Accuracy: 28.064998626708984, cost:13.102718114852905\r\nEpoch 3, Loss: 11.471456527709961, Accuracy: 28.78444480895996, Test Loss: 11.532645225524902, Test Accuracy: 28.369998931884766, cost:13.346691846847534\r\nEpoch 4, Loss: 11.456918716430664, Accuracy: 28.886667251586914, Test Loss: 11.518753051757812, Test Accuracy: 28.497499465942383, cost:13.706462860107422\r\nEpoch 5, Loss: 11.445549011230469, Accuracy: 28.961334228515625, Test Loss: 11.492920875549316, Test Accuracy: 28.6560001373291, cost:13.56296968460083\r\nEpoch 6, Loss: 11.424226760864258, Accuracy: 29.0897216796875, Test Loss: 11.270418167114258, Test Accuracy: 30.030000686645508, cost:13.60814118385315\r\nEpoch 7, Loss: 11.216507911682129, Accuracy: 30.37714385986328, Test Loss: 11.099614143371582, Test Accuracy: 31.09000015258789, cost:13.579961061477661\r\nEpoch 8, Loss: 11.050827980041504, Accuracy: 31.407499313354492, Test Loss: 10.950920104980469, Test Accuracy: 32.01874923706055, cost:13.574744701385498\r\nEpoch 9, Loss: 10.918838500976562, Accuracy: 32.227962493896484, Test Loss: 10.83558464050293, Test Accuracy: 32.7400016784668, cost:12.771528959274292\r\nEpoch 10, Loss: 10.808745384216309, Accuracy: 32.91266632080078, Test Loss: 10.74200439453125, Test Accuracy: 33.32600021362305, cost:12.579218864440918\r\nEpoch 11, Loss: 10.719698905944824, Accuracy: 33.46500015258789, Test Loss: 10.672236442565918, Test Accuracy: 33.759090423583984, cost:12.781628131866455\r\nEpoch 12, Loss: 10.644211769104004, Accuracy: 33.93402862548828, Test Loss: 10.609025955200195, Test Accuracy: 34.154998779296875, cost:13.060226202011108\r\nEpoch 13, Loss: 10.57997989654541, Accuracy: 34.33307647705078, Test Loss: 10.551304817199707, Test Accuracy: 34.51692199707031, cost:13.11635136604309\r\nEpoch 14, Loss: 10.525317192077637, Accuracy: 34.671546936035156, Test Loss: 10.500534057617188, Test Accuracy: 34.834999084472656, cost:13.43892216682434\r\nEpoch 15, Loss: 10.476855278015137, Accuracy: 34.972442626953125, Test Loss: 10.458395957946777, Test Accuracy: 35.099334716796875, cost:13.528913021087646\r\nEpoch 16, Loss: 10.435961723327637, Accuracy: 35.22645950317383, Test Loss: 10.421695709228516, Test Accuracy: 35.329376220703125, cost:13.542529821395874\r\nEpoch 17, Loss: 10.397627830505371, Accuracy: 35.46509552001953, Test Loss: 10.387943267822266, Test Accuracy: 35.541175842285156, cost:12.953328132629395\r\nEpoch 18, Loss: 10.317543983459473, Accuracy: 35.95990753173828, Test Loss: 10.273320198059082, Test Accuracy: 36.2488899230957, cost:13.799224138259888\r\nEpoch 19, Loss: 10.211501121520996, Accuracy: 36.61640167236328, Test Loss: 10.166360855102539, Test Accuracy: 36.910526275634766, cost:13.552597045898438\r\nEpoch 20, Loss: 10.113394737243652, Accuracy: 37.22416687011719, Test Loss: 10.071305274963379, Test Accuracy: 37.49850082397461, cost:12.61729907989502\r\n......\r\n``` \r\nWhen you compare these two results, The first code is obviously better than the second. **I've done many experiments, and the results are the same**. The first get better acc and loss just after one epoch, but the second will iterated many time from a not so good result and finally can get a better result.\r\n\r\nso my question are :\r\n(1) What causes these two different results\uff1f because I have added @tf.function annotation to the method train_step, so whether I add  @tf.function annotation to call method or not , the result should the same.\r\n(2) tensorflow keras will run with graph model automatic\uff0cwhy add  @tf.function annotation to the call method in [this api doc](https://www.tensorflow.org/versions/r2.0/api_docs/python/tf/function#used_in_the_tutorials)"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32879", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32879/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32879/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32879/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32879", "id": 499480360, "node_id": "MDU6SXNzdWU0OTk0ODAzNjA=", "number": 32879, "title": "I want a example code to use the embedding projector in tensorboard by tensorflow-2.0.", "user": {"login": "jiawei6636", "id": 24591769, "node_id": "MDQ6VXNlcjI0NTkxNzY5", "avatar_url": "https://avatars2.githubusercontent.com/u/24591769?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jiawei6636", "html_url": "https://github.com/jiawei6636", "followers_url": "https://api.github.com/users/jiawei6636/followers", "following_url": "https://api.github.com/users/jiawei6636/following{/other_user}", "gists_url": "https://api.github.com/users/jiawei6636/gists{/gist_id}", "starred_url": "https://api.github.com/users/jiawei6636/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jiawei6636/subscriptions", "organizations_url": "https://api.github.com/users/jiawei6636/orgs", "repos_url": "https://api.github.com/users/jiawei6636/repos", "events_url": "https://api.github.com/users/jiawei6636/events{/privacy}", "received_events_url": "https://api.github.com/users/jiawei6636/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 284285184, "node_id": "MDU6TGFiZWwyODQyODUxODQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tensorboard", "name": "comp:tensorboard", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "bileschi", "id": 547150, "node_id": "MDQ6VXNlcjU0NzE1MA==", "avatar_url": "https://avatars1.githubusercontent.com/u/547150?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bileschi", "html_url": "https://github.com/bileschi", "followers_url": "https://api.github.com/users/bileschi/followers", "following_url": "https://api.github.com/users/bileschi/following{/other_user}", "gists_url": "https://api.github.com/users/bileschi/gists{/gist_id}", "starred_url": "https://api.github.com/users/bileschi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bileschi/subscriptions", "organizations_url": "https://api.github.com/users/bileschi/orgs", "repos_url": "https://api.github.com/users/bileschi/repos", "events_url": "https://api.github.com/users/bileschi/events{/privacy}", "received_events_url": "https://api.github.com/users/bileschi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "bileschi", "id": 547150, "node_id": "MDQ6VXNlcjU0NzE1MA==", "avatar_url": "https://avatars1.githubusercontent.com/u/547150?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bileschi", "html_url": "https://github.com/bileschi", "followers_url": "https://api.github.com/users/bileschi/followers", "following_url": "https://api.github.com/users/bileschi/following{/other_user}", "gists_url": "https://api.github.com/users/bileschi/gists{/gist_id}", "starred_url": "https://api.github.com/users/bileschi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bileschi/subscriptions", "organizations_url": "https://api.github.com/users/bileschi/orgs", "repos_url": "https://api.github.com/users/bileschi/repos", "events_url": "https://api.github.com/users/bileschi/events{/privacy}", "received_events_url": "https://api.github.com/users/bileschi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-09-27T14:30:52Z", "updated_at": "2020-01-31T09:04:36Z", "closed_at": null, "author_association": "NONE", "body": "I want a example code to use the embedding projector in tensorboard by tensorflow-2.0.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32873", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32873/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32873/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32873/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32873", "id": 499383309, "node_id": "MDU6SXNzdWU0OTkzODMzMDk=", "number": 32873, "title": "XLA bug w/ Keras: \"Node name contains invalid characters\"", "user": {"login": "nsmetanin", "id": 764902, "node_id": "MDQ6VXNlcjc2NDkwMg==", "avatar_url": "https://avatars1.githubusercontent.com/u/764902?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nsmetanin", "html_url": "https://github.com/nsmetanin", "followers_url": "https://api.github.com/users/nsmetanin/followers", "following_url": "https://api.github.com/users/nsmetanin/following{/other_user}", "gists_url": "https://api.github.com/users/nsmetanin/gists{/gist_id}", "starred_url": "https://api.github.com/users/nsmetanin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nsmetanin/subscriptions", "organizations_url": "https://api.github.com/users/nsmetanin/orgs", "repos_url": "https://api.github.com/users/nsmetanin/repos", "events_url": "https://api.github.com/users/nsmetanin/events{/privacy}", "received_events_url": "https://api.github.com/users/nsmetanin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1133285679, "node_id": "MDU6TGFiZWwxMTMzMjg1Njc5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:xla", "name": "comp:xla", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-09-27T11:07:21Z", "updated_at": "2020-03-13T15:09:08Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code: yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04\r\n- TensorFlow installed from (source or binary): pip\r\n- TensorFlow version (use command below): tensorflow-gpu==1.14.0+nv\r\n- Python version: 3.6.8\r\n- CUDA/cuDNN version: 10.1\r\n- GPU model and memory: RTX 2080 Ti, NVIDIA Driver 418.43\r\n\r\n**Describe the current behavior**\r\n\r\nShows the warning at the predict time:\r\n```2019-09-27 11:02:42.377419: W tensorflow/core/common_runtime/process_function_library_runtime.cc:667] Ignoring multi-device function optimization failure: Invalid argument: Node '_arg_segments_ids_input_0_1_0_arg': Node name contains invalid characters```\r\n\r\nAnd doesn't enable XLA optimizations as I can see (performance doesn't improve)\r\n\r\n**Describe the expected behavior**\r\n\r\nThere should be no problem at all.\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\nOccured in a real-case keras-bert based code, but reproduces in the following code:\r\n\r\n```\r\nimport numpy as np\r\nimport tensorflow as tf\r\nfrom tensorflow.keras.backend import set_session\r\nfrom tensorflow.keras.layers import Input, Embedding, Add\r\nfrom tensorflow.keras.models import Model\r\n\r\nconfig = tf.ConfigProto()\r\nconfig.graph_options.optimizer_options.global_jit_level = tf.OptimizerOptions.ON_1\r\nset_session(tf.Session(config=config))\r\n\r\nseq_len = 80\r\nbatch_size=5000\r\n\r\ntokens_ids_input = Input(shape=(seq_len, ), dtype='int32', name='tokens_ids_input')\r\nsegments_ids_input = Input(shape=(seq_len, ), dtype='int32', name='segments_ids_input')\r\n\r\noutput = Add()([Embedding(input_dim=5000, output_dim=16)(tokens_ids_input), Embedding(input_dim=2, output_dim=16)(segments_ids_input)])\r\n\r\nmodel = Model(inputs=[tokens_ids_input, segments_ids_input], outputs=[output])\r\n\r\nmodel.predict([np.zeros((batch_size, seq_len)), np.zeros((batch_size, seq_len))])\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32868", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32868/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32868/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32868/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32868", "id": 499322876, "node_id": "MDU6SXNzdWU0OTkzMjI4NzY=", "number": 32868, "title": "Combo TPU/TFRecords for model.evaluate is not working", "user": {"login": "anhmeow", "id": 55739241, "node_id": "MDQ6VXNlcjU1NzM5MjQx", "avatar_url": "https://avatars2.githubusercontent.com/u/55739241?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anhmeow", "html_url": "https://github.com/anhmeow", "followers_url": "https://api.github.com/users/anhmeow/followers", "following_url": "https://api.github.com/users/anhmeow/following{/other_user}", "gists_url": "https://api.github.com/users/anhmeow/gists{/gist_id}", "starred_url": "https://api.github.com/users/anhmeow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anhmeow/subscriptions", "organizations_url": "https://api.github.com/users/anhmeow/orgs", "repos_url": "https://api.github.com/users/anhmeow/repos", "events_url": "https://api.github.com/users/anhmeow/events{/privacy}", "received_events_url": "https://api.github.com/users/anhmeow/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097541661, "node_id": "MDU6TGFiZWwxMDk3NTQxNjYx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tpus", "name": "comp:tpus", "color": "0052cc", "default": false, "description": "tpu, tpuestimator"}, {"id": 1133285679, "node_id": "MDU6TGFiZWwxMTMzMjg1Njc5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:xla", "name": "comp:xla", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rxsang", "id": 6399870, "node_id": "MDQ6VXNlcjYzOTk4NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6399870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rxsang", "html_url": "https://github.com/rxsang", "followers_url": "https://api.github.com/users/rxsang/followers", "following_url": "https://api.github.com/users/rxsang/following{/other_user}", "gists_url": "https://api.github.com/users/rxsang/gists{/gist_id}", "starred_url": "https://api.github.com/users/rxsang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rxsang/subscriptions", "organizations_url": "https://api.github.com/users/rxsang/orgs", "repos_url": "https://api.github.com/users/rxsang/repos", "events_url": "https://api.github.com/users/rxsang/events{/privacy}", "received_events_url": "https://api.github.com/users/rxsang/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rxsang", "id": 6399870, "node_id": "MDQ6VXNlcjYzOTk4NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6399870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rxsang", "html_url": "https://github.com/rxsang", "followers_url": "https://api.github.com/users/rxsang/followers", "following_url": "https://api.github.com/users/rxsang/following{/other_user}", "gists_url": "https://api.github.com/users/rxsang/gists{/gist_id}", "starred_url": "https://api.github.com/users/rxsang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rxsang/subscriptions", "organizations_url": "https://api.github.com/users/rxsang/orgs", "repos_url": "https://api.github.com/users/rxsang/repos", "events_url": "https://api.github.com/users/rxsang/events{/privacy}", "received_events_url": "https://api.github.com/users/rxsang/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-09-27T08:56:43Z", "updated_at": "2019-10-16T20:57:50Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Google Colab\r\n- TensorFlow installed from (source or binary): \r\n- TensorFlow version (use command below): 1.14\r\n- Python version: 3.6.8\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory: TPU Colab\r\n\r\n**Describe the current behavior**\r\nOn a TPU (colab) running model.evaluate on a tf.data.Dataset build with TFRecords throw :\r\nCompilation failure: Dynamic Spatial reduce window is not supported: %reduce-window.21 = f32[1,127,127,3]{3,2,1,0} reduce-window(f32[1,256,256,3]{3,2,1,0} %reshape.12, f32[] %constant.16), window={size=1x3x3x1 stride=1x2x2x1}, to_apply=%max_F32.17, metadata={op_type=\"MaxPool\" op_name=\"max_pooling2d_4/MaxPool\"}\r\n\tTPU compilation failed\r\n\r\nThe fit method work perfectly with the same dataset.\r\nEvaluation working perfectly if i rebuild the model and load the weights on a CPU/GPU instance.\r\n\r\nI don't have this issue on TPU if the tf.data.Dataset is not built from TFRecords\r\n\r\n**Describe the expected behavior**\r\nmodel.evaluate should work and provide a result close from the last fit iteration\r\n\r\n**Code to reproduce the issue**\r\n\r\nPut it on Colab and replace GOOGLE_BUCKET_TO_DEFINE by a real bucket (2 occurrences)\r\n\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\n#get a image as input data for model : tensorflow logo\r\n!curl https://avatars0.githubusercontent.com/u/15658638?s=256 --output tensor_logo.png\r\n\r\n#build 8 tfrecords based on the logo downloaded\r\ndef build_tf_records():\r\n  def serialize_example_pyfunction(image, label):\r\n    feature = {\r\n        'image': tf.train.Feature(bytes_list=tf.train.BytesList(value=[image.numpy()])),\r\n        'label': tf.train.Feature(int64_list=tf.train.Int64List(value=[label.numpy()]))\r\n    }\r\n    example_proto = tf.train.Example(features=tf.train.Features(feature=feature))\r\n    return example_proto.SerializeToString()\r\n\r\n  def tf_serialize_example(image, label):\r\n    tf_string = tf.py_function(\r\n      serialize_example_pyfunction,\r\n      (image, label),  # pass these args to the above function.\r\n      tf.string)      # the return type is `tf.string`.\r\n    return tf.reshape(tf_string, ())# The result is a scalar\r\n\r\n  dataset = tf.data.Dataset.from_tensor_slices(['/content/tensor_logo.png' for x in range(8)])\r\n  dataset = dataset.map(lambda x : (tf.read_file(x), 0))\r\n  dataset = dataset.map(tf_serialize_example)\r\n  return dataset\r\n\r\n#write tf records to disc and move on a google bucket\r\nwith tf.Session() as sess:\r\n  filename = 'tfrecord.test'\r\n  writer = tf.data.experimental.TFRecordWriter(filename)\r\n  writting = writer.write(build_tf_records())\r\n  sess.run(writting)\r\n\r\n!ls\r\n\r\nfrom google.colab import auth\r\nauth.authenticate_user()\r\n\r\n!gsutil cp tfrecord.test gs://GOOGLE_BUCKET_TO_DEFINE/\r\n\r\n# the aim is to quickly build 8 items (x, y=0) with x of shape (256, 256, 3)\r\ndef train_input_fn_dummy_data():\r\n  dataset = tf.data.Dataset.from_tensor_slices(([0 for x in range(8)]))\r\n  dataset = dataset.map(lambda x : (tf.random.normal((256, 256, 3)), [0]))\r\n  dataset = dataset.batch(8)\r\n  return dataset\r\n  \r\n\r\ndef train_input_fn_from_tf_records():\r\n  # Create a description of the features.\r\n  feature_description = {\r\n    'image': tf.FixedLenFeature([], tf.string),\r\n    'label': tf.FixedLenFeature([], tf.int64, default_value=0)\r\n  }\r\n\r\n  def _parse_function(example_proto):\r\n    # Parse the input tf.Example proto using the dictionary above.\r\n    return tf.parse_single_example(example_proto, feature_description)\r\n\r\n  def _process_string_image(dic):\r\n    image_string = dic['image']\r\n    image_decoded = tf.image.decode_png(image_string, channels=3)\r\n    image_decoded = tf.cast(image_decoded, tf.float32)/255.\r\n    return image_decoded, tf.cast([dic['label']], tf.int32)\r\n\r\n  list_files = tf.data.Dataset.list_files('gs://GOOGLE_BUCKET_TO_DEFINE/tfrecord.test')\r\n  raw_tfrecords = tf.data.TFRecordDataset(list_files)\r\n  files_as_dict = raw_tfrecords.map(_parse_function)\r\n  files = files_as_dict.map(_process_string_image)\r\n  files = files.batch(8, drop_remainder=True)\r\n  \r\n  return files\r\n\r\n#basic check to compare train_input_fn_dummy_data, train_input_fn_from_tf_records\r\n#can't be run after TPU initialisation\r\nwith tf.Session() as sess:\r\n  batch = train_input_fn_dummy_data().make_one_shot_iterator().get_next()\r\n  while True:\r\n      try:\r\n          records = sess.run(batch)\r\n          print('shape of dummy items :', records[0].shape, records[1].shape)\r\n      except tf.errors.OutOfRangeError: break\r\n  batch = train_input_fn_from_tf_records().make_one_shot_iterator().get_next()\r\n  while True:\r\n      try:\r\n          records = sess.run(batch)\r\n          print('shape of tfrecords items :', records[0].shape, records[1].shape)\r\n      except tf.errors.OutOfRangeError: break\r\n\r\n##shape of dummy items : (8, 256, 256, 3) (8, 1)\r\n##shape of tfrecords items : (8, 256, 256, 3) (8, 1)\r\n\r\n\r\n#initialize tpu only once\r\nif not('strategy' in globals()):\r\n  resolver = tf.contrib.cluster_resolver.TPUClusterResolver()\r\n  tf.contrib.distribute.initialize_tpu_system(resolver)\r\n  strategy = tf.contrib.distribute.TPUStrategy(resolver)\r\n\r\n#build model and compile\r\nwith strategy.scope():\r\n  inputs = tf.keras.layers.Input(shape=(256, 256, 3))\r\n  x = tf.keras.layers.MaxPooling2D((3, 3), strides=(2, 2))(inputs)\r\n  output = tf.keras.layers.GlobalAveragePooling2D()(x)\r\n  output = tf.keras.layers.Dense(1, activation = 'sigmoid')(output)\r\n  model = tf.keras.Model(inputs=inputs, outputs=output)\r\n  model.compile('adam', loss='binary_crossentropy', metrics=['binary_accuracy'])\r\n\r\nmodel.summary()\r\n\r\n# fit the model, no issue\r\nprint('train dummy')\r\nmodel.fit(train_input_fn_dummy_data(), epochs= 1, steps_per_epoch=1)\r\nprint('train tfrecords')\r\nmodel.fit(train_input_fn_from_tf_records(), epochs= 1, steps_per_epoch=1)\r\nprint('evaluate dummy')\r\nmodel.evaluate(train_input_fn_dummy_data(), steps=1)\r\nprint('evaluate tfrecords')\r\nmodel.evaluate(train_input_fn_from_tf_records(), steps=1)\r\n\r\n##train dummy\r\n##WARNING:tensorflow:Expected a shuffled dataset but input dataset `x` is not shuffled. ##Please invoke `shuffle()` on input dataset.\r\n##WARNING:tensorflow:From /usr/local/lib/python3.6/dist-##packages/tensorflow/python/keras/engine/training_distributed.py:411: Variable.load (from ##tensorflow.python.ops.variables) is deprecated and will be removed in a future version.\r\n##Instructions for updating:\r\n##Prefer Variable.assign which has equivalent behavior in 2.X.\r\n##1/1 [==============================] - 0s 397ms/step - loss: 0.3180 - ##binary_accuracy: 1.0000\r\n##train tfrecords\r\n##1/1 [==============================] - 1s 786ms/step - loss: 0.4993 - ##binary_accuracy: 1.0000\r\n##evaluate dummy\r\n##1/1 [==============================] - 1s 1s/step\r\n##1/1 [==============================] - 1s 1s/step\r\n##evaluate tfrecords\r\n##---------------------------------------------------------------------------\r\n##UnimplementedError                        Traceback (most recent call last)\r\n##/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _do_call(self, ##fn, *args)\r\n##   1355     try:\r\n##-> 1356       return fn(*args)\r\n##   1357     except errors.OpError as e:\r\n##\r\n##10 frames\r\n##UnimplementedError: From /job:worker/replica:0/task:0:\r\n##Compilation failure: Dynamic Spatial reduce window is not supported: %reduce-window.21 ##= f32[1,127,127,3]{3,2,1,0} reduce-window(f32[1,256,256,3]{3,2,1,0} %reshape.12, f32[] ##%constant.16), window={size=1x3x3x1 stride=1x2x2x1}, to_apply=%max_F32.17, ##metadata=##{op_type=\"MaxPool\" op_name=\"max_pooling2d_4/MaxPool\"}\r\n##\tTPU compilation failed\r\n##\t [[{{node TPUReplicateMetadata_3}}]]\r\n##\r\n##During handling of the above exception, another exception occurred:\r\n\r\n\r\n```\r\n**Other info / logs**\r\n\r\nThe fit method work perfectly with the same dataset.\r\nEvaluation working perfectly if i rebuild the model and load the weights on a CPU/GPU instance.\r\n\r\nI don't have this issue on TPU if the tf.data.Dataset is not built from TFRecords\r\n\r\nFull StackTrace : \r\nUnimplementedError                        Traceback (most recent call last)\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _do_call(self, fn, *args)\r\n   1355     try:\r\n-> 1356       return fn(*args)\r\n   1357     except errors.OpError as e:\r\n\r\n10 frames\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _run_fn(feed_dict, fetch_list, target_list, options, run_metadata)\r\n   1340       return self._call_tf_sessionrun(\r\n-> 1341           options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1342 \r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _call_tf_sessionrun(self, options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1428         self._session, options, feed_dict, fetch_list, target_list,\r\n-> 1429         run_metadata)\r\n   1430 \r\n\r\nUnimplementedError: From /job:worker/replica:0/task:0:\r\nCompilation failure: Dynamic Spatial reduce window is not supported: %reduce-window.21 = f32[1,127,127,3]{3,2,1,0} reduce-window(f32[1,256,256,3]{3,2,1,0} %reshape.12, f32[] %constant.16), window={size=1x3x3x1 stride=1x2x2x1}, to_apply=%max_F32.17, metadata={op_type=\"MaxPool\" op_name=\"max_pooling2d_4/MaxPool\"}\r\n\tTPU compilation failed\r\n\t [[{{node TPUReplicateMetadata_3}}]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nUnimplementedError                        Traceback (most recent call last)\r\n<ipython-input-8-22e1b9ed9dfe> in <module>()\r\n      6 model.evaluate(train_input_fn_dummy_data(), steps=1)\r\n      7 print('evaluate tfrecords')\r\n----> 8 model.evaluate(train_input_fn_from_tf_records(), steps=1)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/training.py in evaluate(self, x, y, batch_size, verbose, sample_weight, steps, callbacks, max_queue_size, workers, use_multiprocessing)\r\n    902             sample_weight=sample_weight,\r\n    903             steps=steps,\r\n--> 904             callbacks=callbacks)\r\n    905 \r\n    906     batch_size = self._validate_or_infer_batch_size(batch_size, steps, x)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/training_distributed.py in evaluate_distributed(model, x, y, batch_size, verbose, sample_weight, steps, callbacks)\r\n    168   if distributed_training_utils.is_tpu_strategy(model._distribution_strategy):\r\n    169     return experimental_tpu_test_loop(\r\n--> 170         model, dataset, verbose=verbose, steps=steps, callbacks=callbacks)\r\n    171   else:\r\n    172     return training_arrays.test_loop(\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/training_distributed.py in experimental_tpu_test_loop(model, dataset, verbose, steps, callbacks)\r\n    562     callbacks._call_batch_hook(mode, 'begin', current_step, batch_logs)\r\n    563     try:\r\n--> 564       _, batch_outs = K.batch_get_value([test_op, output_tensors])\r\n    565     except errors.OutOfRangeError:\r\n    566       warning_msg = 'Make sure that your dataset can generate at least '\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/backend.py in batch_get_value(tensors)\r\n   3008     raise RuntimeError('Cannot get value inside Tensorflow graph function.')\r\n   3009   if tensors:\r\n-> 3010     return get_session(tensors).run(tensors)\r\n   3011   else:\r\n   3012     return []\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in run(self, fetches, feed_dict, options, run_metadata)\r\n    948     try:\r\n    949       result = self._run(None, fetches, feed_dict, options_ptr,\r\n--> 950                          run_metadata_ptr)\r\n    951       if run_metadata:\r\n    952         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\r\n   1171     if final_fetches or final_targets or (handle and feed_dict_tensor):\r\n   1172       results = self._do_run(handle, final_targets, final_fetches,\r\n-> 1173                              feed_dict_tensor, options, run_metadata)\r\n   1174     else:\r\n   1175       results = []\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\r\n   1348     if handle is None:\r\n   1349       return self._do_call(_run_fn, feeds, fetches, targets, options,\r\n-> 1350                            run_metadata)\r\n   1351     else:\r\n   1352       return self._do_call(_prun_fn, handle, feeds, fetches)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _do_call(self, fn, *args)\r\n   1368           pass\r\n   1369       message = error_interpolation.interpolate(message, self._graph)\r\n-> 1370       raise type(e)(node_def, op, message)\r\n   1371 \r\n   1372   def _extend_graph(self):\r\n\r\nUnimplementedError: From /job:worker/replica:0/task:0:\r\nCompilation failure: Dynamic Spatial reduce window is not supported: %reduce-window.21 = f32[1,127,127,3]{3,2,1,0} reduce-window(f32[1,256,256,3]{3,2,1,0} %reshape.12, f32[] %constant.16), window={size=1x3x3x1 stride=1x2x2x1}, to_apply=%max_F32.17, metadata={op_type=\"MaxPool\" op_name=\"max_pooling2d_4/MaxPool\"}\r\n\tTPU compilation failed\r\n\t [[node TPUReplicateMetadata_3 (defined at <ipython-input-8-22e1b9ed9dfe>:8) ]]\r\n\r\nOriginal stack trace for 'TPUReplicateMetadata_3':\r\n  File \"/usr/lib/python3.6/runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"/usr/lib/python3.6/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py\", line 16, in <module>\r\n    app.launch_new_instance()\r\n  File \"/usr/local/lib/python3.6/dist-packages/traitlets/config/application.py\", line 658, in launch_instance\r\n    app.start()\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel/kernelapp.py\", line 477, in start\r\n    ioloop.IOLoop.instance().start()\r\n  File \"/usr/local/lib/python3.6/dist-packages/tornado/ioloop.py\", line 832, in start\r\n    self._run_callback(self._callbacks.popleft())\r\n  File \"/usr/local/lib/python3.6/dist-packages/tornado/ioloop.py\", line 605, in _run_callback\r\n    ret = callback()\r\n  File \"/usr/local/lib/python3.6/dist-packages/tornado/stack_context.py\", line 277, in null_wrapper\r\n    return fn(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/zmq/eventloop/zmqstream.py\", line 536, in <lambda>\r\n    self.io_loop.add_callback(lambda : self._handle_events(self.socket, 0))\r\n  File \"/usr/local/lib/python3.6/dist-packages/zmq/eventloop/zmqstream.py\", line 450, in _handle_events\r\n    self._handle_recv()\r\n  File \"/usr/local/lib/python3.6/dist-packages/zmq/eventloop/zmqstream.py\", line 480, in _handle_recv\r\n    self._run_callback(callback, msg)\r\n  File \"/usr/local/lib/python3.6/dist-packages/zmq/eventloop/zmqstream.py\", line 432, in _run_callback\r\n    callback(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tornado/stack_context.py\", line 277, in null_wrapper\r\n    return fn(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel/kernelbase.py\", line 283, in dispatcher\r\n    return self.dispatch_shell(stream, msg)\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel/kernelbase.py\", line 235, in dispatch_shell\r\n    handler(stream, idents, msg)\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel/kernelbase.py\", line 399, in execute_request\r\n    user_expressions, allow_stdin)\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel/ipkernel.py\", line 196, in do_execute\r\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel/zmqshell.py\", line 533, in run_cell\r\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 2718, in run_cell\r\n    interactivity=interactivity, compiler=compiler, result=result)\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 2828, in run_ast_nodes\r\n    if self.run_code(code, result):\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 2882, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-8-22e1b9ed9dfe>\", line 8, in <module>\r\n    model.evaluate(train_input_fn_from_tf_records(), steps=1)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/training.py\", line 904, in evaluate\r\n    callbacks=callbacks)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/training_distributed.py\", line 170, in evaluate_distributed\r\n    model, dataset, verbose=verbose, steps=steps, callbacks=callbacks)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/training_distributed.py\", line 520, in experimental_tpu_test_loop\r\n    _test_step_fn, args=(test_input_data,))\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/distribute/tpu_strategy.py\", line 249, in experimental_run_v2\r\n    return _tpu_run(self, fn, args, kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/distribute/tpu_strategy.py\", line 196, in _tpu_run\r\n    maximum_shapes=maximum_shapes)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/tpu/tpu.py\", line 592, in replicate\r\n    maximum_shapes=maximum_shapes)[1]\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/tpu/tpu.py\", line 854, in split_compile_and_replicate\r\n    num_replicas=num_replicas, use_tpu=use_tpu, **metadata_kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/gen_tpu_ops.py\", line 6039, in tpu_replicate_metadata\r\n    name=name)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/op_def_library.py\", line 788, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/util/deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/ops.py\", line 3616, in create_op\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/ops.py\", line 2005, in __init__\r\n    self._traceback = tf_stack.extract_stack()"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32866", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32866/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32866/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32866/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32866", "id": 499312381, "node_id": "MDU6SXNzdWU0OTkzMTIzODE=", "number": 32866, "title": "The use of tflite Model of C3D Network in Android ", "user": {"login": "zxj11838", "id": 35714793, "node_id": "MDQ6VXNlcjM1NzE0Nzkz", "avatar_url": "https://avatars0.githubusercontent.com/u/35714793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zxj11838", "html_url": "https://github.com/zxj11838", "followers_url": "https://api.github.com/users/zxj11838/followers", "following_url": "https://api.github.com/users/zxj11838/following{/other_user}", "gists_url": "https://api.github.com/users/zxj11838/gists{/gist_id}", "starred_url": "https://api.github.com/users/zxj11838/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zxj11838/subscriptions", "organizations_url": "https://api.github.com/users/zxj11838/orgs", "repos_url": "https://api.github.com/users/zxj11838/repos", "events_url": "https://api.github.com/users/zxj11838/events{/privacy}", "received_events_url": "https://api.github.com/users/zxj11838/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "renjie-liu", "id": 36247193, "node_id": "MDQ6VXNlcjM2MjQ3MTkz", "avatar_url": "https://avatars3.githubusercontent.com/u/36247193?v=4", "gravatar_id": "", "url": "https://api.github.com/users/renjie-liu", "html_url": "https://github.com/renjie-liu", "followers_url": "https://api.github.com/users/renjie-liu/followers", "following_url": "https://api.github.com/users/renjie-liu/following{/other_user}", "gists_url": "https://api.github.com/users/renjie-liu/gists{/gist_id}", "starred_url": "https://api.github.com/users/renjie-liu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/renjie-liu/subscriptions", "organizations_url": "https://api.github.com/users/renjie-liu/orgs", "repos_url": "https://api.github.com/users/renjie-liu/repos", "events_url": "https://api.github.com/users/renjie-liu/events{/privacy}", "received_events_url": "https://api.github.com/users/renjie-liu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "renjie-liu", "id": 36247193, "node_id": "MDQ6VXNlcjM2MjQ3MTkz", "avatar_url": "https://avatars3.githubusercontent.com/u/36247193?v=4", "gravatar_id": "", "url": "https://api.github.com/users/renjie-liu", "html_url": "https://github.com/renjie-liu", "followers_url": "https://api.github.com/users/renjie-liu/followers", "following_url": "https://api.github.com/users/renjie-liu/following{/other_user}", "gists_url": "https://api.github.com/users/renjie-liu/gists{/gist_id}", "starred_url": "https://api.github.com/users/renjie-liu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/renjie-liu/subscriptions", "organizations_url": "https://api.github.com/users/renjie-liu/orgs", "repos_url": "https://api.github.com/users/renjie-liu/repos", "events_url": "https://api.github.com/users/renjie-liu/events{/privacy}", "received_events_url": "https://api.github.com/users/renjie-liu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2019-09-27T08:33:48Z", "updated_at": "2019-10-29T03:19:23Z", "closed_at": null, "author_association": "NONE", "body": "I use a model of C3D network training to convert to a tflite format; \r\nuse in the android project available at:\r\nhttps://github.com/tensorflow/examples/tree/master/lite/examples/image_classification/android\r\nThe following question arises: is android not currently supported Con3D? 5D data?\r\n\r\nE/tensorflow: CameraActivity: Exception!\r\n    java.lang.IllegalStateException: Internal error: Unexpected failure when preparing tensor allocations: tensorflow/lite/kernels/strided_slice.cc StridedSlice op only supports 1D-4D input arrays.\r\n    Node number 0 (STRIDED_SLICE) failed to prepare.\r\n    \r\n        at org.tensorflow.lite.NativeInterpreterWrapper.allocateTensors(Native Method)\r\n        at org.tensorflow.lite.NativeInterpreterWrapper.init(NativeInterpreterWrapper.java:96)\r\n        at org.tensorflow.lite.NativeInterpreterWrapper.<init>(NativeInterpreterWrapper.java:61)\r\n        at org.tensorflow.lite.Interpreter.<init>(Interpreter.java:224)\r\n        at org.tensorflow.lite.examples.classification.tflite.Classifier.<init>(Classifier.java:189)\r\n        at org.tensorflow.lite.examples.classification.tflite.ClassifierFloatMobileNet.<init>(ClassifierFloatMobileNet.java:41)\r\n        at org.tensorflow.lite.examples.classification.tflite.Classifier.create(Classifier.java:100)\r\n        at org.tensorflow.lite.examples.classification.ClassifierActivity.recreateClassifier(ClassifierActivity.java:168)\r\n        at org.tensorflow.lite.examples.classification.ClassifierActivity.onPreviewSizeChosen(ClassifierActivity.java:71)\r\n        at org.tensorflow.lite.examples.classification.CameraActivity.onPreviewFrame(CameraActivity.java:232)\r\n        at android.hardware.Camera$EventHandler.handleMessage(Camera.java:1261)\r\n        at android.os.Handler.dispatchMessage(Handler.java:110)\r\n        at android.os.Looper.loop(Looper.java:203)\r\n        at android.app.ActivityThread.main(ActivityThread.java:6406)\r\n        at java.lang.reflect.Method.invoke(Native Method)\r\n        at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1113)\r\n        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:974)\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32857", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32857/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32857/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32857/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32857", "id": 499222615, "node_id": "MDU6SXNzdWU0OTkyMjI2MTU=", "number": 32857, "title": "TFLite Reshape not supporting resizeInputTensor with -1", "user": {"login": "tobyclh", "id": 12501995, "node_id": "MDQ6VXNlcjEyNTAxOTk1", "avatar_url": "https://avatars3.githubusercontent.com/u/12501995?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tobyclh", "html_url": "https://github.com/tobyclh", "followers_url": "https://api.github.com/users/tobyclh/followers", "following_url": "https://api.github.com/users/tobyclh/following{/other_user}", "gists_url": "https://api.github.com/users/tobyclh/gists{/gist_id}", "starred_url": "https://api.github.com/users/tobyclh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tobyclh/subscriptions", "organizations_url": "https://api.github.com/users/tobyclh/orgs", "repos_url": "https://api.github.com/users/tobyclh/repos", "events_url": "https://api.github.com/users/tobyclh/events{/privacy}", "received_events_url": "https://api.github.com/users/tobyclh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-09-27T04:04:21Z", "updated_at": "2019-09-27T05:36:20Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: Pixel 3, Pixel 2\r\n- TensorFlow installed from (source or binary): Anaconda\r\n- TensorFlow version (use command below): 1.14\r\n- Python version: 3.7\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: 10\r\n- GPU model and memory:\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nI am trying to deploy Deepspeech 2 with `tf.lite.experimental.nn.bidirectional_dynamic_rnn` on android. Inside the inference since the input audio is of dynamic length, I try to call `resizeInputTensor` in the c++ api on Android to match the length of the audio, which throws \r\n`tensorflow/contrib/lite/kernels/reshape.cc:58 num_input_elements != num_output_elements`\r\nsimilar to #23600. In the inference code there is a line of `reshape` which is from [-1, 1, 38, 25] to   [-1, 1, 38*25], (note that it collapses the fourth dimension but doesn't do anything with the batch dimension. After reading the source code for `reshape.cc` it seems like even if the batch size is indicated as -1, during conversion the batch size is explicitly computed and stored in the model, which is the main cause of this bug.\r\n\r\n**Describe the expected behavior**\r\n`reshape` conversion recomputes the reshape size whenever `resizeInputTensor` is called. \r\n \r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n```\r\nstd::vector<int> sizes = {1, 240, 240, 3};\r\n\r\ninterpreter_->ResizeInputTensor(interpreter_->inputs()[0], sizes);\r\n\r\nif (interpreter_->AllocateTensors() != kTfLiteOk) {\r\n    LOG(INFO) << \"Failed to allocate tensors!\" << \"\\n\";\r\n    return false;\r\n```\r\nGiven that interpreter_ contains resizeops with -1 specified.\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32855", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32855/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32855/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32855/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32855", "id": 499197750, "node_id": "MDU6SXNzdWU0OTkxOTc3NTA=", "number": 32855, "title": "Hash mismatch", "user": {"login": "baqwas", "id": 7071255, "node_id": "MDQ6VXNlcjcwNzEyNTU=", "avatar_url": "https://avatars1.githubusercontent.com/u/7071255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/baqwas", "html_url": "https://github.com/baqwas", "followers_url": "https://api.github.com/users/baqwas/followers", "following_url": "https://api.github.com/users/baqwas/following{/other_user}", "gists_url": "https://api.github.com/users/baqwas/gists{/gist_id}", "starred_url": "https://api.github.com/users/baqwas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/baqwas/subscriptions", "organizations_url": "https://api.github.com/users/baqwas/orgs", "repos_url": "https://api.github.com/users/baqwas/repos", "events_url": "https://api.github.com/users/baqwas/events{/privacy}", "received_events_url": "https://api.github.com/users/baqwas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1194756584, "node_id": "MDU6TGFiZWwxMTk0NzU2NTg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20raspberry%20pi", "name": "subtype: raspberry pi", "color": "b619ea", "default": false, "description": "Raspberry Pi Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-09-27T02:15:24Z", "updated_at": "2019-09-27T08:55:01Z", "closed_at": null, "author_association": "NONE", "body": "<em>Cannot install tensorflow on Raspberry Pi 0W v1.3 owing to hash mismatch. tag:bug_template</em>\r\n\r\n**System information**\r\n\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Raspbian Buster\r\n- TensorFlow installed from (source or binary): using pip\r\n- TensorFlow version (use command below): n/a; not installed yet\r\n- Python version: 3.7\r\n\r\n**Describe the current behavior**\r\nHash mismatch for \r\nhttps://www.piwheels.org/simple/tensorflow/tensorflow-1.13.1-cp37-none-linux_armv6l.whl#sha256=25f4ff027beec1e568baf8e90a07bad59d354560533d6b37318b9efeb70beeb1:\r\n**Describe the expected behavior**\r\nExpected sha256 25f4ff027beec1e568baf8e90a07bad59d354560533d6b37318b9efeb70beeb1\r\n\r\n**Code to reproduce the issue**\r\nGot        3aad2c162168a62adae30e226bcddfef74e5db1ca98bec1383958fb580e67123\r\n\r\n```\r\n$ python3 -m pip install tensorflow\r\nLooking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple\r\nCollecting tensorflow\r\n  Downloading https://www.piwheels.org/simple/tensorflow/tensorflow-1.13.1-cp37-none-linux_armv6l.whl (87.1MB)\r\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 87.1MB 644bytes/s \r\nTHESE PACKAGES DO NOT MATCH THE HASHES FROM THE REQUIREMENTS FILE. If you have updated the package versions, please update the hashes. Otherwise, examine the package contents carefully; someone may have tampered with them.\r\n    tensorflow from https://www.piwheels.org/simple/tensorflow/tensorflow-1.13.1-cp37-none-linux_armv6l.whl#sha256=25f4ff027beec1e568baf8e90a07bad59d354560533d6b37318b9efeb70beeb1:\r\n        Expected sha256 25f4ff027beec1e568baf8e90a07bad59d354560533d6b37318b9efeb70beeb1\r\n             Got        3aad2c162168a62adae30e226bcddfef74e5db1ca98bec1383958fb580e67123\r\n\r\n$ \r\n```\r\nThanks for any guidance on resolving the issue.\r\n\r\nKind regards.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32844", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32844/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32844/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32844/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32844", "id": 499004171, "node_id": "MDU6SXNzdWU0OTkwMDQxNzE=", "number": 32844, "title": "RPi0W - no go", "user": {"login": "baqwas", "id": 7071255, "node_id": "MDQ6VXNlcjcwNzEyNTU=", "avatar_url": "https://avatars1.githubusercontent.com/u/7071255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/baqwas", "html_url": "https://github.com/baqwas", "followers_url": "https://api.github.com/users/baqwas/followers", "following_url": "https://api.github.com/users/baqwas/following{/other_user}", "gists_url": "https://api.github.com/users/baqwas/gists{/gist_id}", "starred_url": "https://api.github.com/users/baqwas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/baqwas/subscriptions", "organizations_url": "https://api.github.com/users/baqwas/orgs", "repos_url": "https://api.github.com/users/baqwas/repos", "events_url": "https://api.github.com/users/baqwas/events{/privacy}", "received_events_url": "https://api.github.com/users/baqwas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-09-26T16:55:40Z", "updated_at": "2019-09-27T05:21:10Z", "closed_at": null, "author_association": "NONE", "body": "<em>Using instructions at [https://www.tensorflow.org/lite/guide/build_rpi](https://www.tensorflow.org/lite/guide/build_rpi )for installation on Raspberry Pi Zero W v1.3. Perhaps impractical owing to ARMv6 processor rev 7 (v6l)</em>\r\n\r\n**System information**\r\nprocessor\t: 0\r\nmodel name\t: ARMv6-compatible processor rev 7 (v6l)\r\nBogoMIPS\t: 697.95\r\nFeatures\t: half thumb fastmult vfp edsp java tls \r\nCPU implementer\t: 0x41\r\nCPU architecture: 7\r\nCPU variant\t: 0x0\r\nCPU part\t: 0xb76\r\nCPU revision\t: 7\r\n\r\nHardware\t: BCM2835\r\nRevision\t: 9000c1\r\n\r\n- Linux 4.19.66+ #1253 Thu Aug 15 11:37:30 BST 2019 armv6l GNU/Linux\r\n\r\n- TensorFlow installed from (source or binary): [source](https://github.com/tensorflow/tensorflow))\r\n- TensorFlow version: sorry, don't know :(\r\n- Python version: 3.7\r\n- Installed using virtualenv? pip? conda?: [script](./tensorflow/lite/tools/make/download_dependencies.sh)\r\n- Bazel version (if compiling from source): n/a\r\n- GCC/Compiler version (if compiling from source): gcc as in Raspbian Buster (no user mods)\r\n- CUDA/cuDNN version: n/a\r\n- GPU model and memory:\r\n\r\n```\r\nMemTotal:         443080 kB\r\nMemFree:          160252 kB\r\nMemAvailable:     327036 kB\r\n```\r\n\r\n**Describe the problem**\r\n\r\n**sh\r\n+ set -e\r\n+++ dirname ./tensorflow/lite/tools/make/build_rpi_lib.sh\r\n++ cd ./tensorflow/lite/tools/make\r\n++ pwd\r\n+ SCRIPT_DIR=/home/pi/projects/tensorflow/tensorflow/lite/tools/make\r\n+ TENSORFLOW_DIR=/home/pi/projects/tensorflow/tensorflow/lite/tools/make/../../../..\r\n+ make -j 4 TARGET=rpi -C /home/pi/projects/tensorflow/tensorflow/lite/tools/make/../../../.. -f tensorflow/lite/tools/make/Makefile\r\nmake: Entering directory '/home/pi/projects/tensorflow'\r\nmake: Nothing to be done for 'all'.\r\nmake: Leaving directory '/home/pi/projects/tensorflow'\r\n**\r\n\r\n**Any other info / logs**\r\nWill be glad to provide any upon specific request because I really don't know what is happening beneath the covers of the installation script\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32841", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32841/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32841/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32841/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32841", "id": 498906288, "node_id": "MDU6SXNzdWU0OTg5MDYyODg=", "number": 32841, "title": "Problems running mnist_estimator in distributed mode", "user": {"login": "shahriar49", "id": 17579773, "node_id": "MDQ6VXNlcjE3NTc5Nzcz", "avatar_url": "https://avatars0.githubusercontent.com/u/17579773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shahriar49", "html_url": "https://github.com/shahriar49", "followers_url": "https://api.github.com/users/shahriar49/followers", "following_url": "https://api.github.com/users/shahriar49/following{/other_user}", "gists_url": "https://api.github.com/users/shahriar49/gists{/gist_id}", "starred_url": "https://api.github.com/users/shahriar49/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shahriar49/subscriptions", "organizations_url": "https://api.github.com/users/shahriar49/orgs", "repos_url": "https://api.github.com/users/shahriar49/repos", "events_url": "https://api.github.com/users/shahriar49/events{/privacy}", "received_events_url": "https://api.github.com/users/shahriar49/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "yuefengz", "id": 1647833, "node_id": "MDQ6VXNlcjE2NDc4MzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/1647833?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yuefengz", "html_url": "https://github.com/yuefengz", "followers_url": "https://api.github.com/users/yuefengz/followers", "following_url": "https://api.github.com/users/yuefengz/following{/other_user}", "gists_url": "https://api.github.com/users/yuefengz/gists{/gist_id}", "starred_url": "https://api.github.com/users/yuefengz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yuefengz/subscriptions", "organizations_url": "https://api.github.com/users/yuefengz/orgs", "repos_url": "https://api.github.com/users/yuefengz/repos", "events_url": "https://api.github.com/users/yuefengz/events{/privacy}", "received_events_url": "https://api.github.com/users/yuefengz/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "yuefengz", "id": 1647833, "node_id": "MDQ6VXNlcjE2NDc4MzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/1647833?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yuefengz", "html_url": "https://github.com/yuefengz", "followers_url": "https://api.github.com/users/yuefengz/followers", "following_url": "https://api.github.com/users/yuefengz/following{/other_user}", "gists_url": "https://api.github.com/users/yuefengz/gists{/gist_id}", "starred_url": "https://api.github.com/users/yuefengz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yuefengz/subscriptions", "organizations_url": "https://api.github.com/users/yuefengz/orgs", "repos_url": "https://api.github.com/users/yuefengz/repos", "events_url": "https://api.github.com/users/yuefengz/events{/privacy}", "received_events_url": "https://api.github.com/users/yuefengz/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 16, "created_at": "2019-09-26T14:03:12Z", "updated_at": "2020-01-16T01:25:54Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 1.12\r\n- Python version: 3.6.5\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source): N/A\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: N/A\r\n\r\n**Describe the current behavior**\r\nRunning below code that I found in many pages on the net, I faced some problems:\r\n\r\n```\r\nimport json\r\nimport os\r\nimport tensorflow as tf\r\nfrom tensorflow.contrib.learn.python.learn.datasets.mnist import read_data_sets\r\ndata_dir = '.\\\\MNIST_data'\r\nlog_dir = '.\\log_dist'\r\nbatch_size = 512\r\ntf.logging.set_verbosity(tf.logging.INFO)\r\n\r\ndef keras_model(lr, decay):\r\n    \"\"\"Return a CNN Keras model\"\"\"\r\n    input_tensor = tf.keras.layers.Input(shape=(784,), name='input')\r\n\r\n    temp = tf.keras.layers.Reshape([28, 28, 1], name='input_image')(input_tensor)\r\n    for i, n_units in enumerate([32, 64]):\r\n        temp = tf.keras.layers.Conv2D(n_units, kernel_size=3, strides=(2, 2),\r\n                                      activation='relu', name='cnn'+str(i))(temp)\r\n        temp = tf.keras.layers.Dropout(0.5, name='dropout'+str(i))(temp)\r\n    temp = tf.keras.layers.GlobalAvgPool2D(name='average')(temp)\r\n    output = tf.keras.layers.Dense(10, activation='softmax', name='output')(temp)\r\n\r\n    model = tf.keras.models.Model(inputs=input_tensor, outputs=output)\r\n    optimizer = tf.keras.optimizers.Adam(lr=lr, decay=decay)\r\n    model.compile(optimizer=optimizer, loss='sparse_categorical_crossentropy', metrics=['accuracy'])\r\n    print(model.summary())\r\n    return model\r\n\r\n\r\ndef main():\r\n    \"\"\"Main function\"\"\"\r\n    data = read_data_sets(data_dir,\r\n                          one_hot=False,\r\n                          fake_data=False)\r\n    model = keras_model(lr=0.001, decay=0.001)\r\n    config = tf.estimator.RunConfig(\r\n                model_dir=log_dir,\r\n                save_summary_steps=1,\r\n                save_checkpoints_steps=100)\r\n    estimator = tf.keras.estimator.model_to_estimator(model, model_dir=log_dir, config=config)\r\n\r\n    train_input_fn = tf.estimator.inputs.numpy_input_fn(\r\n                         x={'input': data.train.images},\r\n                         y=data.train.labels,\r\n                         num_epochs=None,   # run forever\r\n                         batch_size=batch_size,\r\n                         shuffle=True)\r\n    eval_input_fn = tf.estimator.inputs.numpy_input_fn(\r\n                         x={'input': data.test.images},\r\n                         y=data.test.labels,\r\n                         num_epochs=1,\r\n                         shuffle=False)\r\n\r\n    train_spec = tf.estimator.TrainSpec(input_fn=train_input_fn,\r\n                                        max_steps=2000)\r\n    eval_spec = tf.estimator.EvalSpec(input_fn=eval_input_fn,\r\n                                      #throttle_secs=1,\r\n                                      steps=None    # until the end of evaluation data\r\n                                      )\r\n\r\n    evaluate_result = tf.estimator.train_and_evaluate(estimator, train_spec, eval_spec)\r\n    print(\"Evaluation results:\")\r\n    for key in evaluate_result[0].keys():\r\n        print(\"   {}: {}\".format(key, evaluate_result[0][key]))\r\n```\r\n\r\nAnd then the rest of the code just included the TF_CONFIG definition for chief, worker and ps. I faced below issues:\r\n\r\n- I was able to run this code on Tensorflow 1.12 but not on Tensorflow 1.13, where I got the error `ValueError: Can not squeeze dim[1], expected a dimension of 1, got 10 for 'metrics/acc/remove_squeezable_dimensions/Squeeze' (op: 'Squeeze') with input shapes: [512,10]`. What is the reason?\r\n- I could get evaluation results printed at the end of training when I was running program in non-distributed mode, but I get below error when it tries to print the final evaluation results in distributed mode:\r\n```\r\nTraceback (most recent call last):\r\n  File \"mnist_estimator.py\", line 81, in <module>\r\n    main()\r\n  File \"mnist_estimator.py\", line 62, in main\r\n    for key in evaluate_result[0].keys():\r\nTypeError: 'NoneType' object is not subscriptable\r\n```\r\n- The final loss for distributed learning was higher than non-distributed learning (for the same number of training steps). What can be the reason? Is it the nature of distribution?\r\n- When running in distributed mode, the chief or worker are not waiting for the other party to start and immediately starts training (when the other party joins they do the task together, though). I thought they should wait for each other to be ready (as it was in my previous experiences with Tensorflow distributed training), isn't it?\r\n- What I read in Tensorflow-related pages about data-parallelism is that there are the same copies of code for different servers except in assignment in TF_CONFIG. The chief synchronizes the parameters update and parameter servers keeps the parameters, but I don't clearly understand who split the data between different workers. Is there just one copy at the chief server and it will split the data and send batches to the workers, or the workers each have a local copy of data and do the splitting and skip some data themselves?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32821", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32821/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32821/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32821/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32821", "id": 498506654, "node_id": "MDU6SXNzdWU0OTg1MDY2NTQ=", "number": 32821, "title": "Optimizer Fails to Run in Compatibility Mode (tested for Adam and Gradient Descent)", "user": {"login": "TimCapes", "id": 1132145, "node_id": "MDQ6VXNlcjExMzIxNDU=", "avatar_url": "https://avatars3.githubusercontent.com/u/1132145?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TimCapes", "html_url": "https://github.com/TimCapes", "followers_url": "https://api.github.com/users/TimCapes/followers", "following_url": "https://api.github.com/users/TimCapes/following{/other_user}", "gists_url": "https://api.github.com/users/TimCapes/gists{/gist_id}", "starred_url": "https://api.github.com/users/TimCapes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TimCapes/subscriptions", "organizations_url": "https://api.github.com/users/TimCapes/orgs", "repos_url": "https://api.github.com/users/TimCapes/repos", "events_url": "https://api.github.com/users/TimCapes/events{/privacy}", "received_events_url": "https://api.github.com/users/TimCapes/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-09-25T20:29:47Z", "updated_at": "2019-10-01T17:42:53Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Mac 10.12.6\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:N/A\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version (use command below): 2.0.0-rc1\r\n- Python version:3.7.1\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source): N/A\r\n- CUDA/cuDNN version: N/A (CPU)\r\n- GPU model and memory:N/A (CPU)\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nOptimizer increments the global step by 1 and stops without changing the network.\r\n**Describe the expected behavior**\r\nOptimizer runs metric to convergence\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n```python\r\nimport tensorflow.compat.v1 as tf\r\nimport numpy as np\r\ntf.disable_v2_behavior()\r\ntf.disable_eager_execution()\r\ninput = tf.placeholder(dtype=tf.float32, shape=(None,28,28), name=\"input\")\r\nreshape = tf.reshape(input, [tf.shape(input)[0],784])\r\nw1 = tf.Variable(tf.random_normal([128,784], dtype=tf.float32), name=\"w1\")\r\nb1 = tf.Variable(tf.random_normal([128], dtype=tf.float32), name=\"b1\")\r\nlayer_one_unbiased = tf.matmul(w1,tf.transpose(reshape))\r\nlayer_one_biased = tf.add(tf.transpose(layer_one_unbiased),b1)\r\nactivated_layer_one = tf.nn.relu(layer_one_biased)\r\nw2 = tf.Variable(tf.random_normal([10,128]), dtype=tf.float32, name=\"w2\")\r\nb2 = tf.Variable(tf.random_normal([10], dtype=tf.float32, name=\"b2\"))\r\nlayer_two_unbiased = tf.matmul(w2,tf.transpose(activated_layer_one))\r\nlayer_two_biased = tf.add(tf.transpose(layer_two_unbiased), b2)\r\nlabels= tf.placeholder(dtype=tf.int32, shape=(None))\r\nloss = tf.nn.sparse_softmax_cross_entropy_with_logits(labels=labels, logits=layer_two_biased)\r\nglobal_step = tf.Variable(0, name='global_step', trainable=False)\r\n#optimizer = tf.train.AdamOptimizer(learning_rate=1e-4)\r\noptimizer = tf.train.GradientDescentOptimizer(0.1)\r\ntrain = optimizer.minimize(loss, global_step=global_step, var_list=tf.get_collection(tf.GraphKeys.TRAINABLE_VARIABLES))\r\n\r\npredictions = tf.nn.softmax(layer_two_biased, name=\"final\")\r\n#label_acc = tf.one_hot(labels,10)\r\n#accuracy = 1 - tf.norm(tf.subtract(predictions,label_acc), axis=1)/2\r\nacc, acc_op = tf.metrics.accuracy(tf.argmax(predictions,1), labels)\r\n#accuracy_averaged = tf.math.reduce_mean(accuracy)\r\n\r\nfashion_mnist = tf.keras.datasets.fashion_mnist\r\n(train_images, train_labels), (test_images, test_labels) = fashion_mnist.load_data()\r\nclass_names = ['T-shirt/top', 'Trouser', 'Pullover', 'Dress', 'Coat',\r\n               'Sandal', 'Shirt', 'Sneaker', 'Bag', 'Ankle boot']\r\ntrain_images = train_images/255.0\r\ntest_images = test_images/255.0\r\nprint(tf.get_collection(tf.GraphKeys.TRAINABLE_VARIABLES))\r\n\r\nsess = tf.Session()\r\nsess.run(tf.global_variables_initializer())\r\nsess.run(tf.local_variables_initializer())\r\nfeed_dict = {input: train_images, labels: train_labels}\r\nprint(sess.run([loss,train,acc_op, global_step],feed_dict=feed_dict))\r\n\r\nfeed_dict2 = {input: test_images, labels: test_labels}\r\nprint(\"Test accuracy\", sess.run(acc_op, feed_dict = feed_dict2))\r\nprint(\"Training accuracy\",sess.run(acc_op, feed_dict = feed_dict))\r\nsaver =tf.train.Saver()\r\nsave_path = saver.save(sess, \"model.ckpt\")\r\n```\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\nCode successfully runs so no error occurs but output of global step value is 1. Note that this network matches the fashion mnist network but is just using tf instead of tf.keras.layers to encode the layers."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32817", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32817/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32817/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32817/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32817", "id": 498396406, "node_id": "MDU6SXNzdWU0OTgzOTY0MDY=", "number": 32817, "title": "Re-emerged Issue #31509 - BaseCollectiveExecutor::StartAbort Out of range:", "user": {"login": "oracle3001", "id": 20092212, "node_id": "MDQ6VXNlcjIwMDkyMjEy", "avatar_url": "https://avatars1.githubusercontent.com/u/20092212?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oracle3001", "html_url": "https://github.com/oracle3001", "followers_url": "https://api.github.com/users/oracle3001/followers", "following_url": "https://api.github.com/users/oracle3001/following{/other_user}", "gists_url": "https://api.github.com/users/oracle3001/gists{/gist_id}", "starred_url": "https://api.github.com/users/oracle3001/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oracle3001/subscriptions", "organizations_url": "https://api.github.com/users/oracle3001/orgs", "repos_url": "https://api.github.com/users/oracle3001/repos", "events_url": "https://api.github.com/users/oracle3001/events{/privacy}", "received_events_url": "https://api.github.com/users/oracle3001/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 37, "created_at": "2019-09-25T16:31:29Z", "updated_at": "2020-03-11T16:13:42Z", "closed_at": null, "author_association": "NONE", "body": "The previous issue described in #31509 was fixed, but I am now experiencing exactly the same issue  with all the same setup using the latest nightly build of TF2.0 when using tf.keras.optimizers.Adam"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32816", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32816/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32816/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32816/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32816", "id": 498373081, "node_id": "MDU6SXNzdWU0OTgzNzMwODE=", "number": 32816, "title": "huge runtime increase for keras converted tflite on some android devices", "user": {"login": "SanthoshRajendiran", "id": 41156980, "node_id": "MDQ6VXNlcjQxMTU2OTgw", "avatar_url": "https://avatars3.githubusercontent.com/u/41156980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SanthoshRajendiran", "html_url": "https://github.com/SanthoshRajendiran", "followers_url": "https://api.github.com/users/SanthoshRajendiran/followers", "following_url": "https://api.github.com/users/SanthoshRajendiran/following{/other_user}", "gists_url": "https://api.github.com/users/SanthoshRajendiran/gists{/gist_id}", "starred_url": "https://api.github.com/users/SanthoshRajendiran/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SanthoshRajendiran/subscriptions", "organizations_url": "https://api.github.com/users/SanthoshRajendiran/orgs", "repos_url": "https://api.github.com/users/SanthoshRajendiran/repos", "events_url": "https://api.github.com/users/SanthoshRajendiran/events{/privacy}", "received_events_url": "https://api.github.com/users/SanthoshRajendiran/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-09-25T15:47:59Z", "updated_at": "2019-10-01T06:04:14Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: Honor Play (COR-AL00) and Poco F1\r\n- TensorFlow installed from (source or binary): Source\r\n- TensorFlow version (use command below): Tested on various versions(1.14, 1.15rc1, 2.0rc1)\r\n- Python version: 3.6\r\n- Bazel version (if compiling from source): NIL\r\n- GCC/Compiler version (if compiling from source): NIL\r\n- CUDA/cuDNN version: NIL\r\n- GPU model and memory: NIL\r\n\r\n**Describe the current behavior**\r\nHonor Play and POCO F1 phones give nearly same performance for TFLite models converted using TensorFlow (.pb) to TFLite whereas TFLite model converted using Keras (h5) to TFLite is behaving strange i.e. runtime on HonorPlay(COR-AL00) is 3 times higher than POCOF1.\r\n \r\nExample:  \r\nMobilenet-Unet (converted from keras(h5) to tflite)\r\nAverage model runtime of mobilenet-unet(Poco): 60ms\r\nAverage model runtime of mobilenet-unet(Honor): 180ms\r\n\r\nSimple - Unet (converted from tensorflow(pb) to tflite)\r\nAverage model runtime of unet(Poco): 50ms\r\nAverage model runtime of unet(Honor): 60ms\r\n\r\n**Describe the expected behavior**\r\nSame runtime for models with same architecture, no matter whether it is keras(h5) converted to tflite, or pb converted to tflite.\r\n\r\n**Code to reproduce the issue**\r\nOfficial Benchmark tool test and android integration test (Benchmark version- 1.14, and Android(tflite gpu delegate-nightly)\r\n\r\n**Other info / logs**\r\nThe base keras(h5) model has been created using pure keras, not tf-keras.\r\n\r\n**### Benchmark tool results for sample model (google drive link attached):**\r\n\r\n**### HONOR PLAY RESULTS**\r\nSTARTING!\r\nMin num runs: [50]\r\nMin runs duration (seconds): [1]\r\nInter-run delay (seconds): [-1]\r\nNum threads: [1]\r\nBenchmark name: []\r\nOutput prefix: []\r\nMin warmup runs: [1]\r\nMin warmup runs duration (seconds): [0.5]\r\nGraph: [/data/local/tmp/testing_mobilenet_sigmoid_divtry_tf15_1.tflite]\r\nInput layers: []\r\nInput shapes: []\r\nUse nnapi : [0]\r\nUse legacy nnapi : [0]\r\nUse gpu : [1]\r\nAllow fp16 : [0]\r\nEnable op profiling: [0]\r\nLoaded model /data/local/tmp/testing_mobilenet_sigmoid_divtry_tf15_1.tflite\r\nresolved reporter\r\nINFO: Initialized TensorFlow Lite runtime.\r\nINFO: Created TensorFlow Lite delegate for GPU.\r\nERROR: Next operations are not supported by GPU delegate:\r\nCAST: Operation is not supported.\r\nDIV: Expected 2 input tensor(s), but node has 1 runtime input(s).\r\nRESHAPE: \r\nFirst 93 operations will run on the GPU, and the remaining 3 on the CPU.\r\nApplied GPU delegate.\r\nInitialized session in 894.605ms\r\nRunning benchmark for at least 1 iterations and at least 0.5 seconds\r\ncount=3 first=227955 curr=174845 min=174845 max=227955 avg=204373 std=22086\r\n\r\nRunning benchmark for at least 50 iterations and at least 1 seconds\r\ncount=50 first=148625 curr=101260 min=97334 max=148625 avg=103508 std=7440\r\n\r\nAverage inference timings in us: Warmup: 204373, Init: 894605, no stats: 103508\r\n\r\n**### POCO F1 RESULTS** \r\nSTARTING!\r\nMin num runs: [50]\r\nMin runs duration (seconds): [1]\r\nInter-run delay (seconds): [-1]\r\nNum threads: [1]\r\nBenchmark name: []\r\nOutput prefix: []\r\nMin warmup runs: [1]\r\nMin warmup runs duration (seconds): [0.5]\r\nGraph: [/data/local/tmp/testing_mobilenet_sigmoid_divtry_tf15_1.tflite]\r\nInput layers: []\r\nInput shapes: []\r\nUse nnapi : [0]\r\nUse legacy nnapi : [0]\r\nUse gpu : [1]\r\nAllow fp16 : [0]\r\nEnable op profiling: [0]\r\nLoaded model /data/local/tmp/testing_mobilenet_sigmoid_divtry_tf15_1.tflite\r\nresolved reporter\r\nINFO: Initialized TensorFlow Lite runtime.\r\nINFO: Created TensorFlow Lite delegate for GPU.\r\nERROR: Next operations are not supported by GPU delegate:\r\nCAST: Operation is not supported.\r\nDIV: Expected 2 input tensor(s), but node has 1 runtime input(s).\r\nRESHAPE: \r\nFirst 93 operations will run on the GPU, and the remaining 3 on the CPU.\r\nApplied GPU delegate.\r\nInitialized session in 612.655ms\r\nRunning benchmark for at least 1 iterations and at least 0.5 seconds\r\ncount=15 first=75811 curr=30928 min=30909 max=75811 avg=34068.6 std=11156\r\n\r\nRunning benchmark for at least 50 iterations and at least 1 seconds\r\ncount=50 first=31179 curr=31509 min=30836 max=32212 avg=31148.3 std=261\r\n\r\nAverage inference timings in us: Warmup: 34068.6, Init: 612655, no stats: 31148.3\r\n\r\n**### SAMPLE MODEL**\r\n[https://drive.google.com/file/d/1PvvoIzfrzLY8VNw5wTdpA6hxOFw_Ri9B/view?usp=sharing](https://drive.google.com/file/d/1PvvoIzfrzLY8VNw5wTdpA6hxOFw_Ri9B/view?usp=sharing)"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32810", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32810/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32810/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32810/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32810", "id": 498179818, "node_id": "MDU6SXNzdWU0OTgxNzk4MTg=", "number": 32810, "title": "Send/Recv of collective_ops hangs in a distributed environment ", "user": {"login": "whhu", "id": 15683619, "node_id": "MDQ6VXNlcjE1NjgzNjE5", "avatar_url": "https://avatars3.githubusercontent.com/u/15683619?v=4", "gravatar_id": "", "url": "https://api.github.com/users/whhu", "html_url": "https://github.com/whhu", "followers_url": "https://api.github.com/users/whhu/followers", "following_url": "https://api.github.com/users/whhu/following{/other_user}", "gists_url": "https://api.github.com/users/whhu/gists{/gist_id}", "starred_url": "https://api.github.com/users/whhu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/whhu/subscriptions", "organizations_url": "https://api.github.com/users/whhu/orgs", "repos_url": "https://api.github.com/users/whhu/repos", "events_url": "https://api.github.com/users/whhu/events{/privacy}", "received_events_url": "https://api.github.com/users/whhu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "dubey", "id": 2314265, "node_id": "MDQ6VXNlcjIzMTQyNjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/2314265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dubey", "html_url": "https://github.com/dubey", "followers_url": "https://api.github.com/users/dubey/followers", "following_url": "https://api.github.com/users/dubey/following{/other_user}", "gists_url": "https://api.github.com/users/dubey/gists{/gist_id}", "starred_url": "https://api.github.com/users/dubey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dubey/subscriptions", "organizations_url": "https://api.github.com/users/dubey/orgs", "repos_url": "https://api.github.com/users/dubey/repos", "events_url": "https://api.github.com/users/dubey/events{/privacy}", "received_events_url": "https://api.github.com/users/dubey/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "dubey", "id": 2314265, "node_id": "MDQ6VXNlcjIzMTQyNjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/2314265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dubey", "html_url": "https://github.com/dubey", "followers_url": "https://api.github.com/users/dubey/followers", "following_url": "https://api.github.com/users/dubey/following{/other_user}", "gists_url": "https://api.github.com/users/dubey/gists{/gist_id}", "starred_url": "https://api.github.com/users/dubey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dubey/subscriptions", "organizations_url": "https://api.github.com/users/dubey/orgs", "repos_url": "https://api.github.com/users/dubey/repos", "events_url": "https://api.github.com/users/dubey/events{/privacy}", "received_events_url": "https://api.github.com/users/dubey/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-09-25T09:58:40Z", "updated_at": "2019-09-26T22:53:36Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code: Yes\r\n- OS Platform and Distribution: Linux CentOS 7.6.1810\r\n- Mobile device if the issue happens on mobile device: No\r\n- TensorFlow installed from: Binary\r\n- TensorFlow version: v1.13.1-0-g6612da8951\r\n- Python version: 3.6.8\r\n- Bazel version: None\r\n- GCC/Compiler version: None\r\n- CUDA/cuDNN version: None\r\n- GPU model and memory: None\r\n\r\n**Describe the current behavior**\r\n\r\nThe monitored session hangs in there fetching the send/recv tensors of `collective_ops`. The same code works well for fetching `all_reduce` tensors.\r\n\r\n**Describe the expected behavior**\r\n\r\nThe send/recv tensors `tensors` gives proper answer on all workers.\r\n\r\n**Code to reproduce the issue**\r\n```python\r\n\"\"\"Illustrate send/recv in collective_ops\"\"\"\r\n\r\nMP_METHOD = 'fork'  # 'fork' (UNIX), 'spawn' (WINDOWS);\r\nNUM_PROCESSES = 2\r\nJOB = 'worker'\r\n\r\ndef process_fn(hosts, task_index):\r\n    \"\"\"process fn\"\"\"\r\n    import time\r\n    import tensorflow as tf\r\n    from tensorflow.python.ops import collective_ops\r\n\r\n    cluster_spec = tf.train.ClusterSpec({JOB: hosts})\r\n    host_devices = list()\r\n    for task, _ in enumerate(hosts):\r\n        host_devices.append(tf.DeviceSpec(\r\n            job=JOB, replica=0, task=task, device_type='cpu', device_index=0))\r\n    chief_host_device = host_devices[0]\r\n\r\n    # unconfigured collective_group_leader make each worker the leader\r\n    # '/replica:0' is necessary in the configuration.\r\n    collective_group_leader, _, _ = \\\r\n        chief_host_device.to_string().partition('/device')\r\n    config = tf.ConfigProto()\r\n    config.experimental.collective_group_leader = collective_group_leader\r\n    server = tf.train.Server(cluster_spec, config=config,\r\n                             job_name=JOB, task_index=task_index)\r\n    run_options = tf.RunOptions()\r\n    run_options.experimental.collective_graph_key = 1\r\n    with tf.Graph().as_default():\r\n        weights = list()\r\n        tensors = list()\r\n        instance_key = 1\r\n        for task, device in enumerate(host_devices):\r\n            with tf.device(device), tf.variable_scope('{}{}'.format(JOB, task)):\r\n                weight = tf.get_variable('weight', shape=[])\r\n                weights.append(weight)\r\n\r\n                # send/recv\r\n                if task == task_index:\r\n                    tensor = collective_ops.broadcast_send(\r\n                        weight, weight.shape, weight.dtype,\r\n                        len(hosts), 1, instance_key)\r\n                else:\r\n                    tensor = collective_ops.broadcast_recv(\r\n                        weight.shape, weight.dtype,\r\n                        len(hosts), 1, instance_key)\r\n                tensors.append(tensor)\r\n                instance_key += 1\r\n\r\n#                # allreduce\r\n#                if task == task_index:\r\n#                    tensor = collective_ops.all_reduce(\r\n#                        weight, len(hosts), 0, instance_key, 'Add', 'Div')\r\n#                    tensors.append(tensor)\r\n#                    instance_key += 1\r\n\r\n        if task_index == 0:\r\n            session_creator = tf.train.ChiefSessionCreator(\r\n                master=server.target)\r\n        else:\r\n            session_creator = tf.train.WorkerSessionCreator(\r\n                master=server.target)\r\n        with tf.train.MonitoredSession(session_creator=session_creator) \\\r\n                as mon_sess:\r\n            print('task {} running.'.format(task_index))\r\n            result_weights = mon_sess.run(weights, options=run_options)\r\n            print('task {} sense {}'.format(task_index, result_weights))\r\n            result_tensors = mon_sess.run(tensors, options=run_options)\r\n            print('task {} broadcast {}'.format(task_index, result_tensors))\r\n            time.sleep(10)\r\n\r\ndef start_process():\r\n    \"\"\"start process\"\"\"\r\n    import time\r\n    import multiprocessing as mp\r\n\r\n    port = 60000\r\n    host_fmt = 'localhost:{}'\r\n    hosts = list()\r\n    for process_index in range(NUM_PROCESSES):\r\n        hosts.append(host_fmt.format(port + process_index))\r\n    mp_ctx = mp.get_context(MP_METHOD)\r\n    processes = list()\r\n    for process_index in range(NUM_PROCESSES):\r\n        process = mp_ctx.Process(target=process_fn,\r\n                                 args=(hosts, process_index,))\r\n        processes.append(process)\r\n        process.start()\r\n        time.sleep(0.1)\r\n    for process in processes:\r\n        process.join()\r\n\r\nif __name__ == '__main__':\r\n    start_process()\r\n```\r\n\r\n**Other info / logs**\r\n```console\r\n(tf-1.13-py3) [huwh1@huwh1-centos worksync]$ python tf_distribute_collective_ops_sendrecv.py \r\n2019-09-25 17:46:29.612863: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2019-09-25 17:46:29.625630: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3408000000 Hz\r\n2019-09-25 17:46:29.625962: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x2c2e220 executing computations on platform Host. Devices:\r\n2019-09-25 17:46:29.625984: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>\r\n2019-09-25 17:46:29.627731: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:252] Initialize GrpcChannelCache for job worker -> {0 -> localhost:60000, 1 -> localhost:60001}\r\n2019-09-25 17:46:29.628640: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:391] Started server with target: grpc://localhost:60000\r\nWARNING:tensorflow:From /home/huwh1/virtualenv/tf-1.13-py3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nColocations handled automatically by placer.\r\n2019-09-25 17:46:29.696555: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2019-09-25 17:46:29.709593: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3408000000 Hz\r\n2019-09-25 17:46:29.709906: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x2c2e410 executing computations on platform Host. Devices:\r\n2019-09-25 17:46:29.709932: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>\r\n2019-09-25 17:46:29.711328: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:252] Initialize GrpcChannelCache for job worker -> {0 -> localhost:60000, 1 -> localhost:60001}\r\n2019-09-25 17:46:29.712186: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:391] Started server with target: grpc://localhost:60001\r\nWARNING:tensorflow:From /home/huwh1/virtualenv/tf-1.13-py3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nColocations handled automatically by placer.\r\n2019-09-25 17:46:29.741447: I tensorflow/core/distributed_runtime/master_session.cc:1192] Start master session 22dc988b8d402f7f with config: experimental { collective_group_leader: \"/job:worker/replica:0/task:0\" }\r\ntask 0 running.\r\ntask 0 sense [-0.30021727, -0.797495]\r\n2019-09-25 17:46:29.798887: I tensorflow/core/distributed_runtime/master_session.cc:1192] Start master session bedba16e0ccc4c27 with config: experimental { collective_group_leader: \"/job:worker/replica:0/task:0\" }\r\ntask 1 running.\r\n2019-09-25 17:46:29.820772: I tensorflow/core/distributed_runtime/base_rendezvous_mgr.cc:159] Skipping rendezvous re-initialization.\r\n2019-09-25 17:46:29.820874: I tensorflow/core/distributed_runtime/base_rendezvous_mgr.cc:159] Skipping rendezvous re-initialization.\r\n2019-09-25 17:46:29.821341: W tensorflow/core/common_runtime/base_collective_executor.cc:203] BaseCollectiveExecutor::StartAbort Aborted: Cleanup 70896605979375878\r\n\t [[{{node worker1/CollectiveBcastRecv}}]]\r\ntask 1 sense [-0.30021727, -0.797495]\r\n```\r\nThere is a related issue #31913, which can be solved by specifying the `experimental.collective_group_leader` in [tf.ConfigProto](https://www.tensorflow.org/api_docs/python/tf/ConfigProto/Experimental#collective_group_leader).\r\nAn info about `rendezvous re-initialization` and a warning about`BaseCollectiveExecutor` are raised from the `send/recv`. Nevertheless, the script works fine for the commented `allreduce`. "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32809", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32809/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32809/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32809/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32809", "id": 498177470, "node_id": "MDU6SXNzdWU0OTgxNzc0NzA=", "number": 32809, "title": "TF 2.0 Feature: Flops calculation", "user": {"login": "pzobel", "id": 19208659, "node_id": "MDQ6VXNlcjE5MjA4NjU5", "avatar_url": "https://avatars2.githubusercontent.com/u/19208659?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pzobel", "html_url": "https://github.com/pzobel", "followers_url": "https://api.github.com/users/pzobel/followers", "following_url": "https://api.github.com/users/pzobel/following{/other_user}", "gists_url": "https://api.github.com/users/pzobel/gists{/gist_id}", "starred_url": "https://api.github.com/users/pzobel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pzobel/subscriptions", "organizations_url": "https://api.github.com/users/pzobel/orgs", "repos_url": "https://api.github.com/users/pzobel/repos", "events_url": "https://api.github.com/users/pzobel/events{/privacy}", "received_events_url": "https://api.github.com/users/pzobel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 1097548274, "node_id": "MDU6TGFiZWwxMDk3NTQ4Mjc0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tfdbg", "name": "comp:tfdbg", "color": "0052cc", "default": false, "description": "tf debugger"}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "qiuminxu", "id": 3082188, "node_id": "MDQ6VXNlcjMwODIxODg=", "avatar_url": "https://avatars3.githubusercontent.com/u/3082188?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qiuminxu", "html_url": "https://github.com/qiuminxu", "followers_url": "https://api.github.com/users/qiuminxu/followers", "following_url": "https://api.github.com/users/qiuminxu/following{/other_user}", "gists_url": "https://api.github.com/users/qiuminxu/gists{/gist_id}", "starred_url": "https://api.github.com/users/qiuminxu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qiuminxu/subscriptions", "organizations_url": "https://api.github.com/users/qiuminxu/orgs", "repos_url": "https://api.github.com/users/qiuminxu/repos", "events_url": "https://api.github.com/users/qiuminxu/events{/privacy}", "received_events_url": "https://api.github.com/users/qiuminxu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "qiuminxu", "id": 3082188, "node_id": "MDQ6VXNlcjMwODIxODg=", "avatar_url": "https://avatars3.githubusercontent.com/u/3082188?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qiuminxu", "html_url": "https://github.com/qiuminxu", "followers_url": "https://api.github.com/users/qiuminxu/followers", "following_url": "https://api.github.com/users/qiuminxu/following{/other_user}", "gists_url": "https://api.github.com/users/qiuminxu/gists{/gist_id}", "starred_url": "https://api.github.com/users/qiuminxu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qiuminxu/subscriptions", "organizations_url": "https://api.github.com/users/qiuminxu/orgs", "repos_url": "https://api.github.com/users/qiuminxu/repos", "events_url": "https://api.github.com/users/qiuminxu/events{/privacy}", "received_events_url": "https://api.github.com/users/qiuminxu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2019-09-25T09:54:35Z", "updated_at": "2020-01-22T15:16:34Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): TF 2.0 RC2\r\n- Are you willing to contribute it (Yes/No):\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\nI am missing the opportunity to compute the number of floating point operations of a tf.keras Model in TF 2.0. \r\nIn TF 1.x tf.profiler was available [see here](https://stackoverflow.com/questions/45085938) but I can find anything equivalent for TF 2.0 yet.\r\n\r\n**Will this change the current api? How?**\r\n\r\n**Who will benefit with this feature?**\r\n\r\nEverbody interested in the computational complexity of a TensorFlow model.\r\n\r\n**Any Other info.**\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32808", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32808/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32808/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32808/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32808", "id": 498163893, "node_id": "MDU6SXNzdWU0OTgxNjM4OTM=", "number": 32808, "title": "Why the communication of distributed training not hidden when using XLA?", "user": {"login": "zhuhong", "id": 5318606, "node_id": "MDQ6VXNlcjUzMTg2MDY=", "avatar_url": "https://avatars2.githubusercontent.com/u/5318606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zhuhong", "html_url": "https://github.com/zhuhong", "followers_url": "https://api.github.com/users/zhuhong/followers", "following_url": "https://api.github.com/users/zhuhong/following{/other_user}", "gists_url": "https://api.github.com/users/zhuhong/gists{/gist_id}", "starred_url": "https://api.github.com/users/zhuhong/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zhuhong/subscriptions", "organizations_url": "https://api.github.com/users/zhuhong/orgs", "repos_url": "https://api.github.com/users/zhuhong/repos", "events_url": "https://api.github.com/users/zhuhong/events{/privacy}", "received_events_url": "https://api.github.com/users/zhuhong/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 1133285679, "node_id": "MDU6TGFiZWwxMTMzMjg1Njc5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:xla", "name": "comp:xla", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-09-25T09:30:03Z", "updated_at": "2020-01-11T05:19:51Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): None\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): nvcr.io/nvidia/tensorflow:19.03-py3 ; \r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): \r\n\r\n\r\n- TensorFlow version (use command below):  tf 1.13.1 ; \r\n- Python version:\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\n\r\n Recently, we have designed a tool to monitor the communication of distributed training process in microsecond. As we all know that the commnuication is hidden in the back-propagation progress; and that's true in my monitoring, like the yellow line in the figure below, that is with XLA disabled. But when we enable the XLA, the traffic between GPU is suspend until the finish of the back-propagation in my figure (blue line). So, is there anyone can help me to figure out the principle behind this phenomenon. Since the traffic can not be hidden in the back-propagation progress, the requirement of the bandwidth for the hardware, like nv-link in the server or infiniband network between servers goes up a lot. \r\n\r\n![\u4e0b\u8f7d (3)](https://user-images.githubusercontent.com/5318606/65588391-0ad2a980-dfba-11e9-8c70-1815edc17bce.png)\r\n\r\n\r\n**Describe the expected behavior**\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32802", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32802/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32802/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32802/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32802", "id": 498090486, "node_id": "MDU6SXNzdWU0OTgwOTA0ODY=", "number": 32802, "title": "Problem to transform an custom efficient-net with an unofficial API to tf-lite version", "user": {"login": "momo1986", "id": 34225874, "node_id": "MDQ6VXNlcjM0MjI1ODc0", "avatar_url": "https://avatars2.githubusercontent.com/u/34225874?v=4", "gravatar_id": "", "url": "https://api.github.com/users/momo1986", "html_url": "https://github.com/momo1986", "followers_url": "https://api.github.com/users/momo1986/followers", "following_url": "https://api.github.com/users/momo1986/following{/other_user}", "gists_url": "https://api.github.com/users/momo1986/gists{/gist_id}", "starred_url": "https://api.github.com/users/momo1986/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/momo1986/subscriptions", "organizations_url": "https://api.github.com/users/momo1986/orgs", "repos_url": "https://api.github.com/users/momo1986/repos", "events_url": "https://api.github.com/users/momo1986/events{/privacy}", "received_events_url": "https://api.github.com/users/momo1986/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1162044565, "node_id": "MDU6TGFiZWwxMTYyMDQ0NTY1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.12", "name": "TF 1.12", "color": "c2e0c6", "default": false, "description": "Issues related to TF 1.12"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "xunkai55", "id": 4828553, "node_id": "MDQ6VXNlcjQ4Mjg1NTM=", "avatar_url": "https://avatars2.githubusercontent.com/u/4828553?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xunkai55", "html_url": "https://github.com/xunkai55", "followers_url": "https://api.github.com/users/xunkai55/followers", "following_url": "https://api.github.com/users/xunkai55/following{/other_user}", "gists_url": "https://api.github.com/users/xunkai55/gists{/gist_id}", "starred_url": "https://api.github.com/users/xunkai55/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xunkai55/subscriptions", "organizations_url": "https://api.github.com/users/xunkai55/orgs", "repos_url": "https://api.github.com/users/xunkai55/repos", "events_url": "https://api.github.com/users/xunkai55/events{/privacy}", "received_events_url": "https://api.github.com/users/xunkai55/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "xunkai55", "id": 4828553, "node_id": "MDQ6VXNlcjQ4Mjg1NTM=", "avatar_url": "https://avatars2.githubusercontent.com/u/4828553?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xunkai55", "html_url": "https://github.com/xunkai55", "followers_url": "https://api.github.com/users/xunkai55/followers", "following_url": "https://api.github.com/users/xunkai55/following{/other_user}", "gists_url": "https://api.github.com/users/xunkai55/gists{/gist_id}", "starred_url": "https://api.github.com/users/xunkai55/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xunkai55/subscriptions", "organizations_url": "https://api.github.com/users/xunkai55/orgs", "repos_url": "https://api.github.com/users/xunkai55/repos", "events_url": "https://api.github.com/users/xunkai55/events{/privacy}", "received_events_url": "https://api.github.com/users/xunkai55/received_events", "type": "User", "site_admin": false}, {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, {"login": "wangtz", "id": 34290063, "node_id": "MDQ6VXNlcjM0MjkwMDYz", "avatar_url": "https://avatars1.githubusercontent.com/u/34290063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wangtz", "html_url": "https://github.com/wangtz", "followers_url": "https://api.github.com/users/wangtz/followers", "following_url": "https://api.github.com/users/wangtz/following{/other_user}", "gists_url": "https://api.github.com/users/wangtz/gists{/gist_id}", "starred_url": "https://api.github.com/users/wangtz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wangtz/subscriptions", "organizations_url": "https://api.github.com/users/wangtz/orgs", "repos_url": "https://api.github.com/users/wangtz/repos", "events_url": "https://api.github.com/users/wangtz/events{/privacy}", "received_events_url": "https://api.github.com/users/wangtz/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2019-09-25T07:03:47Z", "updated_at": "2019-12-03T14:03:17Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (Linux Ubuntu 18.04):\r\n- TensorFlow installed from source:\r\n- TensorFlow version (1.12):\r\n- Keras version (2.2.4)\r\n\r\n\r\nHello, I use this Keras-repository to deploy my efficient-net-model for specific application.\r\nhttps://github.com/titu1994/keras-efficientnets\r\n\r\nI want to transform the h5-file to tflite and met some problems.\r\n\r\nMy code is:\r\n```\r\nimport tensorflow as tf\r\nimport keras\r\nimport h5py\r\nimport keras_efficientnets\r\nfrom custom_objects import EfficientNetConvInitializer\r\nfrom custom_objects import EfficientNetDenseInitializer\r\nfrom custom_objects import Swish, DropConnect\r\nif __name__ == \"__main__\":\r\n    debugger = EfficientNetConvInitializer()\r\n    converter = tf.contrib.lite.TFLiteConverter.from_keras_model_file(\"efficient_net_v1_190925.h5\")\r\n    converter.optimizations = [tf.contrib.lite.Optimize.OPTIMIZE_FOR_SIZE]\r\n    tflite_model = converter.convert()\r\n    open(\"efficient_net_wrap_finger.tflite\", \"wb\").write(tflite_model)\r\n```\r\nMy problem is:\r\n\r\n> Using TensorFlow backend.\r\n> Traceback (most recent call last):\r\n>   File \"model_convert.py\", line 10, in <module>\r\n>     converter = tf.contrib.lite.TFLiteConverter.from_keras_model_file(\"efficient_net_v1_190925.h5\")\r\n>   File \"/root/anaconda3/lib/python3.6/site-packages/tensorflow/contrib/lite/python/lite.py\", line 368, in from_keras_model_file\r\n>     keras_model = _keras.models.load_model(model_file)\r\n>   File \"/root/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/engine/saving.py\", line 230, in load_model\r\n>     model = model_from_config(model_config, custom_objects=custom_objects)\r\n>   File \"/root/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/engine/saving.py\", line 310, in model_from_config\r\n>     return deserialize(config, custom_objects=custom_objects)\r\n>   File \"/root/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/layers/serialization.py\", line 64, in deserialize\r\n>     printable_module_name='layer')\r\n>   File \"/root/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/utils/generic_utils.py\", line 173, in deserialize_keras_object\r\n>     list(custom_objects.items())))\r\n>   File \"/root/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/engine/network.py\", line 1292, in from_config\r\n>     process_layer(layer_data)\r\n>   File \"/root/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/engine/network.py\", line 1278, in process_layer\r\n>     layer = deserialize_layer(layer_data, custom_objects=custom_objects)\r\n>   File \"/root/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/layers/serialization.py\", line 64, in deserialize\r\n>     printable_module_name='layer')\r\n>   File \"/root/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/utils/generic_utils.py\", line 175, in deserialize_keras_object\r\n>     return cls.from_config(config['config'])\r\n>   File \"/root/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/engine/base_layer.py\", line 1606, in from_config\r\n>     return cls(**config)\r\n>   File \"/root/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/layers/convolutional.py\", line 488, in __init__\r\n>     kernel_initializer=initializers.get(kernel_initializer),\r\n>   File \"/root/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/initializers.py\", line 155, in get\r\n>     return deserialize(identifier)\r\n>   File \"/root/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/initializers.py\", line 147, in deserialize\r\n>     printable_module_name='initializer')\r\n>   File \"/root/anaconda3/lib/python3.6/site-packages/tensorflow/python/keras/utils/generic_utils.py\", line 163, in deserialize_keras_object\r\n>     raise ValueError('Unknown ' + printable_module_name + ': ' + class_name)\r\n> ValueError: Unknown initializer: EfficientNetConvInitializer\r\n\r\nWhat is the root-cause for this problem?\r\n\r\nCan I clarify that keras-efficient-net API is not compatible with official tensorflow lite support?\r\nIs there any work-around that I can build an efficent-net and depoly on my mobile device?\r\n\r\nThanks & Regards!"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32799", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32799/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32799/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32799/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32799", "id": 498069388, "node_id": "MDU6SXNzdWU0OTgwNjkzODg=", "number": 32799, "title": "Inconsistency between keras model.predict() and model.call()", "user": {"login": "nikhil-mathew-td", "id": 55779386, "node_id": "MDQ6VXNlcjU1Nzc5Mzg2", "avatar_url": "https://avatars1.githubusercontent.com/u/55779386?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikhil-mathew-td", "html_url": "https://github.com/nikhil-mathew-td", "followers_url": "https://api.github.com/users/nikhil-mathew-td/followers", "following_url": "https://api.github.com/users/nikhil-mathew-td/following{/other_user}", "gists_url": "https://api.github.com/users/nikhil-mathew-td/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikhil-mathew-td/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikhil-mathew-td/subscriptions", "organizations_url": "https://api.github.com/users/nikhil-mathew-td/orgs", "repos_url": "https://api.github.com/users/nikhil-mathew-td/repos", "events_url": "https://api.github.com/users/nikhil-mathew-td/events{/privacy}", "received_events_url": "https://api.github.com/users/nikhil-mathew-td/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-09-25T06:10:08Z", "updated_at": "2019-12-23T08:20:39Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04.1\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): v2.0.0-rc0-101-gd2d2566 2.0.0-rc1\r\n- Python version: Python 3.7.4\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source): N/A\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: N/A\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\n\r\nI am trying to extract the features generated by the model's DenseFeatures layer by creating a new model based on the inputs of the original model and the outputs of the DenseFeature layers. When using this submodel I notice an inconsistency between model.call() and model.predict(). If we provide extra columns to the model in model.predict() the model behaves reliably by processing the inputs using keras.engine.training_utils.standardize_input_data(). However if model.call() is used this doesn't happen and the model orders the columns based on alphabetical order as per nest.flatten(), thus the model crashes with the type cast exception if the extra columns are of a different format. Please see the code provided to reproduce this issue. I can work around this by using the predict() method. \r\n\r\n**Describe the expected behavior**\r\n\r\nExpected behaviour is that the two methods to use a model are consistent. The model.call() processes the inputs using the standardize_input_data() method to ensure the input data is as expected.\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n```\r\nimport urllib.request as request\r\nimport tensorflow as tf\r\nimport pandas as pd\r\n\r\n\r\ndef download_data(download_path: str):\r\n    url = 'https://archive.ics.uci.edu/ml/machine-learning-databases/heart-disease/processed.cleveland.data'\r\n    header_line = 'age,sex,cp,trestbps,chol,fbs,restecg,thalach,exang,oldpeak,slope,ca,thal,target\\n'\r\n\r\n    # Download the data and add the column headers\r\n    request.urlretrieve(url, 'heart.data')\r\n    with open(download_path, 'w') as output:\r\n        output.write(header_line)\r\n        with open('heart.data', 'r') as input_data:\r\n            output.writelines(input_data.readlines())\r\n\r\n\r\ndef preprocess_df(df, categorical_columns):\r\n    \"\"\"Ensure categorical columns are treated as string inputs\"\"\"\r\n    col_types = {key : str for key in categorical_columns.keys()}\r\n    df = df.astype(col_types)\r\n    return df\r\n\r\n\r\ndef df_to_dataset(dataframe, target_column='target', shuffle=True, batch_size=5):\r\n    \"\"\"Dataset preparation code from the tensorflow tutorial\"\"\"\r\n    dataframe = dataframe.copy()\r\n    labels = dataframe.pop(target_column)\r\n    ds = tf.data.Dataset.from_tensor_slices((dict(dataframe), tf.one_hot(labels, depth=2)))\r\n    if shuffle:\r\n        ds = ds.shuffle(buffer_size=len(dataframe))\r\n    ds = ds.batch(batch_size)\r\n    return ds\r\n\r\n\r\nif __name__ == '__main__':\r\n\r\n    # Download dataset\r\n    data_path = 'heart.csv'\r\n    download_data(data_path)\r\n    df = pd.read_csv(data_path)\r\n\r\n    # Setup feature columns\r\n    numeric_columns = [\"age\", \"chol\"]\r\n    categorical_columns = {\"thal\": df['thal'].unique()}\r\n    feature_columns = {}\r\n    inputs = {}\r\n    for feature_name in numeric_columns:\r\n        feature_columns[feature_name] = tf.feature_column.numeric_column(feature_name)\r\n        inputs[feature_name] = tf.keras.Input(name=feature_name, shape=(), dtype=tf.float32)\r\n\r\n    for feature_name, vocab in categorical_columns.items():\r\n        vocab.sort()\r\n        cat_col = tf.feature_column.categorical_column_with_vocabulary_list(feature_name, vocab)\r\n        feature_columns[feature_name] = tf.feature_column.indicator_column(cat_col)\r\n        inputs[feature_name] = tf.keras.Input(name=feature_name, shape=(), dtype=tf.string)\r\n\r\n    # Prepare input data\r\n    df = preprocess_df(df, categorical_columns)\r\n    batch_size = 5  # A small batch sized is used for demonstration purposes\r\n    train_ds = df_to_dataset(df, target_column='target', batch_size=batch_size)\r\n\r\n    # Create Model\r\n    input_tensors = []\r\n    feature_names = list(feature_columns.keys())\r\n    feature_names.sort()\r\n    for column_name in feature_names:\r\n        features = feature_columns[column_name]\r\n        x = tf.keras.layers.DenseFeatures(features, name=f'{column_name}_feature')(inputs)\r\n        input_tensors.append(x)\r\n\r\n    x = tf.keras.layers.Concatenate()(input_tensors)\r\n    x = tf.keras.layers.Dense(units=24, activation='relu', name='dense_0')(x)\r\n    x = tf.keras.layers.Dense(units=24, activation='relu', name='dense_1')(x)\r\n    y_pred = tf.keras.layers.Dense(units=2, activation='softmax', name='output_layer')(x)\r\n    model = tf.keras.Model(inputs=inputs, outputs=y_pred)\r\n\r\n    model.compile(optimizer=tf.keras.optimizers.Adam(),\r\n                  loss=tf.keras.losses.CategoricalCrossentropy(),\r\n                  metrics=['accuracy'],\r\n                  run_eagerly=True)\r\n\r\n    model.summary()\r\n    model.fit(train_ds, epochs=1)\r\n\r\n    # Create a new keras model to extract the features\r\n    # the actual model is using.\r\n    outputs = []\r\n    for column_name in feature_names:\r\n        outputs.append(model.get_layer(f'{column_name}_feature').output)\r\n\r\n    feature_extractor = tf.keras.Model(model.input, outputs)\r\n\r\n    for i, (X, _) in enumerate(train_ds):\r\n\r\n        # Predict works as it calls keras.engine.training_utils.standardize_input_data() internally\r\n        # this modifies the input so that if extra columns are passed they are removed and column\r\n        # order is changed as per the model inputs specified.\r\n        # out = feature_extractor.predict(X)\r\n\r\n        # Model call() doesn't use the above util method and thus fails\r\n        # as the ordering of the input columns doesn't match the input\r\n        out = feature_extractor(X)\r\n        print(out)\r\n```\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n```\r\nTraceback (most recent call last):\r\n  File \"check_model_clone_4.py\", line 103, in <module>\r\n    out = feature_extractor(X)\r\n  File \"/home/user/anaconda3/envs/rc1/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/base_layer.py\", line 891, in __call__\r\n    outputs = self.call(cast_inputs, *args, **kwargs)\r\n  File \"/home/user/anaconda3/envs/rc1/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/network.py\", line 707, in call\r\n    convert_kwargs_to_constants=base_layer_utils.call_context().saving)\r\n  File \"/home/user/anaconda3/envs/rc1/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/network.py\", line 859, in _run_internal_graph\r\n    output_tensors = layer(computed_tensors, **kwargs)\r\n  File \"/home/user/anaconda3/envs/rc1/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/base_layer.py\", line 891, in __call__\r\n    outputs = self.call(cast_inputs, *args, **kwargs)\r\n  File \"/home/user/anaconda3/envs/rc1/lib/python3.7/site-packages/tensorflow_core/python/feature_column/dense_features.py\", line 133, in call\r\n    self._state_manager)\r\n  File \"/home/user/anaconda3/envs/rc1/lib/python3.7/site-packages/tensorflow_core/python/feature_column/feature_column_v2.py\", line 4357, in get_dense_tensor\r\n    return transformation_cache.get(self, state_manager)\r\n  File \"/home/user/anaconda3/envs/rc1/lib/python3.7/site-packages/tensorflow_core/python/feature_column/feature_column_v2.py\", line 2608, in get\r\n    transformed = column.transform_feature(self, state_manager)\r\n  File \"/home/user/anaconda3/envs/rc1/lib/python3.7/site-packages/tensorflow_core/python/feature_column/feature_column_v2.py\", line 4296, in transform_feature\r\n    transformation_cache, state_manager)\r\n  File \"/home/user/anaconda3/envs/rc1/lib/python3.7/site-packages/tensorflow_core/python/feature_column/feature_column_v2.py\", line 3771, in get_sparse_tensors\r\n    transformation_cache.get(self, state_manager), None)\r\n  File \"/home/user/anaconda3/envs/rc1/lib/python3.7/site-packages/tensorflow_core/python/feature_column/feature_column_v2.py\", line 2608, in get\r\n    transformed = column.transform_feature(self, state_manager)\r\n  File \"/home/user/anaconda3/envs/rc1/lib/python3.7/site-packages/tensorflow_core/python/feature_column/feature_column_v2.py\", line 3749, in transform_feature\r\n    return self._transform_input_tensor(input_tensor, state_manager)\r\n  File \"/home/user/anaconda3/envs/rc1/lib/python3.7/site-packages/tensorflow_core/python/feature_column/feature_column_v2.py\", line 3726, in _transform_input_tensor\r\n    prefix='column_name: {} input_tensor'.format(self.key))\r\n  File \"/home/user/anaconda3/envs/rc1/lib/python3.7/site-packages/tensorflow_core/python/feature_column/utils.py\", line 58, in assert_string_or_int\r\n    '{} dtype must be string or integer. dtype: {}.'.format(prefix, dtype))\r\nValueError: column_name: thal input_tensor dtype must be string or integer. dtype: <dtype: 'float32'>.\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32796", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32796/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32796/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32796/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32796", "id": 497997069, "node_id": "MDU6SXNzdWU0OTc5OTcwNjk=", "number": 32796, "title": "When does tensorflow lite support 3d cnn?", "user": {"login": "Jessespace", "id": 24760248, "node_id": "MDQ6VXNlcjI0NzYwMjQ4", "avatar_url": "https://avatars0.githubusercontent.com/u/24760248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jessespace", "html_url": "https://github.com/Jessespace", "followers_url": "https://api.github.com/users/Jessespace/followers", "following_url": "https://api.github.com/users/Jessespace/following{/other_user}", "gists_url": "https://api.github.com/users/Jessespace/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jessespace/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jessespace/subscriptions", "organizations_url": "https://api.github.com/users/Jessespace/orgs", "repos_url": "https://api.github.com/users/Jessespace/repos", "events_url": "https://api.github.com/users/Jessespace/events{/privacy}", "received_events_url": "https://api.github.com/users/Jessespace/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-09-25T01:19:40Z", "updated_at": "2019-11-15T21:51:09Z", "closed_at": null, "author_association": "NONE", "body": "\r\nI trained 3d cnn network on tensorflow, now I want to port to Android phone, but browsed the document and found that tensorflow-lite does not support 3d cnn operation, when will it support it?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32793", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32793/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32793/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32793/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32793", "id": 497974244, "node_id": "MDU6SXNzdWU0OTc5NzQyNDQ=", "number": 32793, "title": "device_lib.list_local_devices() InvalidArgumentError: Invalid device ordinal value (1). Valid range is [0, 0].", "user": {"login": "shun-lin", "id": 16867893, "node_id": "MDQ6VXNlcjE2ODY3ODkz", "avatar_url": "https://avatars0.githubusercontent.com/u/16867893?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shun-lin", "html_url": "https://github.com/shun-lin", "followers_url": "https://api.github.com/users/shun-lin/followers", "following_url": "https://api.github.com/users/shun-lin/following{/other_user}", "gists_url": "https://api.github.com/users/shun-lin/gists{/gist_id}", "starred_url": "https://api.github.com/users/shun-lin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shun-lin/subscriptions", "organizations_url": "https://api.github.com/users/shun-lin/orgs", "repos_url": "https://api.github.com/users/shun-lin/repos", "events_url": "https://api.github.com/users/shun-lin/events{/privacy}", "received_events_url": "https://api.github.com/users/shun-lin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 1133285679, "node_id": "MDU6TGFiZWwxMTMzMjg1Njc5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:xla", "name": "comp:xla", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, {"login": "cheshire", "id": 348959, "node_id": "MDQ6VXNlcjM0ODk1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/348959?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cheshire", "html_url": "https://github.com/cheshire", "followers_url": "https://api.github.com/users/cheshire/followers", "following_url": "https://api.github.com/users/cheshire/following{/other_user}", "gists_url": "https://api.github.com/users/cheshire/gists{/gist_id}", "starred_url": "https://api.github.com/users/cheshire/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cheshire/subscriptions", "organizations_url": "https://api.github.com/users/cheshire/orgs", "repos_url": "https://api.github.com/users/cheshire/repos", "events_url": "https://api.github.com/users/cheshire/events{/privacy}", "received_events_url": "https://api.github.com/users/cheshire/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 22, "created_at": "2019-09-24T23:40:45Z", "updated_at": "2020-02-12T16:04:58Z", "closed_at": null, "author_association": "NONE", "body": "\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): gLinux\r\n- TensorFlow installed from (source or binary): pip3 installed\r\n- TensorFlow version (use command below): 2.0.0-rc1\r\n- Python version: 3.6.2\r\n- CUDA/cuDNN version: 10.0, 7.6.3\r\n- GPU model and memory:\r\n\r\noutput of ```nvidia-smi``` from the terminal:\r\n```\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 430.34       Driver Version: 430.34       CUDA Version: 10.1     |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  Quadro P1000        Off  | 00000000:65:00.0  On |                  N/A |\r\n| 37%   52C    P0    N/A /  N/A |   1289MiB /  4037MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n|   1  TITAN RTX           Off  | 00000000:B3:00.0 Off |                  N/A |\r\n| 41%   29C    P8    14W / 280W |   1155MiB / 24220MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n```\r\n\r\nNOTE: in the above output it shows that it is using ```CUDA Version: 10.``` but my ```LD_LIBRARY_PATH``` environment variable is pointing to CUDA 10.0.\r\n\r\nSnippet of code that cause the problem:\r\n```python\r\nimport tensorflow as tf\r\nfrom tensorflow.python.client import device_lib\r\n\r\ndevice_lib.list_local_devices()\r\n```\r\n\r\nerror message:\r\n```\r\n---------------------------------------------------------------------------\r\nInvalidArgumentError                      Traceback (most recent call last)\r\n<ipython-input-2-b6f1169dc7e5> in <module>\r\n     2 from tensorflow.python.client import device_lib\r\n     3 \r\n---> 4 device_lib.list_local_devices()\r\n\r\n~/.local/lib/python3.6/site-packages/tensorflow_core/python/client/device_lib.py in list_local_devices(session_config)\r\n     39   return [\r\n     40       _convert(s)\r\n---> 41       for s in pywrap_tensorflow.list_devices(session_config=session_config)\r\n     42   ]\r\n\r\n~/.local/lib/python3.6/site-packages/tensorflow_core/python/pywrap_tensorflow_internal.py in list_devices(session_config)\r\n   2247     return ListDevicesWithSessionConfig(session_config.SerializeToString())\r\n   2248   else:\r\n-> 2249     return ListDevices()\r\n   2250 \r\n   2251 \r\n\r\nInvalidArgumentError: Invalid device ordinal value (1). Valid range is [0, 0].\r\n\twhile setting up XLA_GPU_JIT device number 1\r\n```\r\n\r\nPotential cause and current workaround:\r\nIn the terminal output I notice that because the Quadro P1000  in my workstation only has 5 multiprocessor and so by default tf will not use it (minimum 8), so I added the following line to my ```.bashrc```\r\n\r\n```\r\nexport TF_MIN_GPU_MULTIPROCESSOR_COUNT=5\r\n```\r\n\r\nand run ```source .bashrc``` and it works. Another potential solution if I don't want to set the min GPU Multiprocessor count I can remove the Quadro P1000 from my workstation. I suspect that there is an inconsistency within list_local_devices() that fetch all GPUs in the workstation but didn't update base on min gpu multiprocessor count rule. So I run another experiment to see if I can reproduce the error after setting ```TF_MIN_GPU_MULTIPROCESSOR_COUNT``` to 5\r\n\r\nThe below code will reproduce the same error:\r\n\r\n```python\r\nimport tensorflow as tf\r\nfrom tensorflow.python.client import device_lib\r\n\r\ngpus = tf.config.experimental.list_physical_devices('GPU')\r\ntf.config.experimental.set_visible_devices(gpus[0], 'GPU')\r\ndevice_lib.list_local_devices()\r\n```\r\nThis will produce the same error but if we call ```device_lib.list_local_devices()``` before calling ```tf.config.experimental.set_visible_devices(gpus[0], 'GPU')``` and then we call ```device_lib.list_local_devices()``` again, there is no error. I suspect that maybe setting device to visible may interact weirdly with list_local_devices().\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32791", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32791/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32791/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32791/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32791", "id": 497942245, "node_id": "MDU6SXNzdWU0OTc5NDIyNDU=", "number": 32791, "title": "Mixnet graph freezing issue", "user": {"login": "dhananjaisharma10", "id": 31407075, "node_id": "MDQ6VXNlcjMxNDA3MDc1", "avatar_url": "https://avatars3.githubusercontent.com/u/31407075?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dhananjaisharma10", "html_url": "https://github.com/dhananjaisharma10", "followers_url": "https://api.github.com/users/dhananjaisharma10/followers", "following_url": "https://api.github.com/users/dhananjaisharma10/following{/other_user}", "gists_url": "https://api.github.com/users/dhananjaisharma10/gists{/gist_id}", "starred_url": "https://api.github.com/users/dhananjaisharma10/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dhananjaisharma10/subscriptions", "organizations_url": "https://api.github.com/users/dhananjaisharma10/orgs", "repos_url": "https://api.github.com/users/dhananjaisharma10/repos", "events_url": "https://api.github.com/users/dhananjaisharma10/events{/privacy}", "received_events_url": "https://api.github.com/users/dhananjaisharma10/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gargn", "id": 1900612, "node_id": "MDQ6VXNlcjE5MDA2MTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1900612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gargn", "html_url": "https://github.com/gargn", "followers_url": "https://api.github.com/users/gargn/followers", "following_url": "https://api.github.com/users/gargn/following{/other_user}", "gists_url": "https://api.github.com/users/gargn/gists{/gist_id}", "starred_url": "https://api.github.com/users/gargn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gargn/subscriptions", "organizations_url": "https://api.github.com/users/gargn/orgs", "repos_url": "https://api.github.com/users/gargn/repos", "events_url": "https://api.github.com/users/gargn/events{/privacy}", "received_events_url": "https://api.github.com/users/gargn/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gargn", "id": 1900612, "node_id": "MDQ6VXNlcjE5MDA2MTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1900612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gargn", "html_url": "https://github.com/gargn", "followers_url": "https://api.github.com/users/gargn/followers", "following_url": "https://api.github.com/users/gargn/following{/other_user}", "gists_url": "https://api.github.com/users/gargn/gists{/gist_id}", "starred_url": "https://api.github.com/users/gargn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gargn/subscriptions", "organizations_url": "https://api.github.com/users/gargn/orgs", "repos_url": "https://api.github.com/users/gargn/repos", "events_url": "https://api.github.com/users/gargn/events{/privacy}", "received_events_url": "https://api.github.com/users/gargn/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2019-09-24T21:51:55Z", "updated_at": "2019-11-23T03:51:25Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): pip\r\n- TensorFlow version (use command below): 1.14.0\r\n- Python version: 3.7.4\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source): N/A\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: N/A\r\n\r\n**Describe the current behavior**\r\nI have been trying to covert the [Mixnet](https://github.com/tensorflow/tpu/tree/master/models/official/mnasnet/mixnet) model to Core ML using the [tfcoreml](https://github.com/tf-coreml/tf-coreml) converter. I froze the graph, then tried converting it, and that's when I get thrown with the following error:\r\n```\r\n1199 ops in the final graph.\r\n\r\nLoading the TF graph...\r\nGraph Loaded.\r\nNow finding ops in the TF graph that can be dropped for inference\r\nCollecting all the 'Const' ops from the graph, by running it....\r\n---------------------------------------------------------------------------\r\nOutOfRangeError                           Traceback (most recent call last)\r\n~/anaconda3/envs/tf/lib/python3.7/site-packages/tensorflow/python/client/session.py in _do_call(self, fn, *args)\r\n   1355     try:\r\n-> 1356       return fn(*args)\r\n   1357     except errors.OpError as e:\r\n\r\n~/anaconda3/envs/tf/lib/python3.7/site-packages/tensorflow/python/client/session.py in _run_fn(feed_dict, fetch_list, target_list, options, run_metadata)\r\n   1340       return self._call_tf_sessionrun(\r\n-> 1341           options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1342 \r\n\r\n~/anaconda3/envs/tf/lib/python3.7/site-packages/tensorflow/python/client/session.py in _call_tf_sessionrun(self, options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1428         self._session, options, feed_dict, fetch_list, target_list,\r\n-> 1429         run_metadata)\r\n   1430 \r\n\r\nOutOfRangeError: Node 'mixnet-s/mixnet_model/stem/batch_normalization/FusedBatchNormV3' (type: 'Add', num of outputs: 1) does not have output 5\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nOutOfRangeError                           Traceback (most recent call last)\r\n<ipython-input-12-6b7b8d71599d> in <module>\r\n     48                      mlmodel_path=ml_model,\r\n     49                      output_feature_names=['logits'],\r\n---> 50                      input_name_shape_dict={})\r\n\r\n~/anaconda3/envs/tf/lib/python3.7/site-packages/tfcoreml/_tf_coreml_converter.py in convert(tf_model_path, mlmodel_path, output_feature_names, input_name_shape_dict, image_input_names, is_bgr, red_bias, green_bias, blue_bias, gray_bias, image_scale, class_labels, predicted_feature_name, predicted_probabilities_output, add_custom_layers, custom_conversion_functions, use_coreml_3)\r\n    619       predicted_probabilities_output=predicted_probabilities_output,\r\n    620       add_custom_layers=add_custom_layers,\r\n--> 621       custom_conversion_functions=custom_conversion_functions)\r\n\r\n~/anaconda3/envs/tf/lib/python3.7/site-packages/tfcoreml/_tf_coreml_converter.py in _convert_pb_to_mlmodel(tf_model_path, mlmodel_path, output_feature_names, input_name_shape_dict, image_input_names, is_bgr, red_bias, green_bias, blue_bias, gray_bias, image_scale, class_labels, predicted_feature_name, predicted_probabilities_output, add_custom_layers, custom_conversion_functions)\r\n    260     else:\r\n    261       const_tensor_names = []\r\n--> 262     tensors_evaluated = sess.run(tensors, feed_dict=input_feed_dict)\r\n    263     for i in range(len(tensor_names)):\r\n    264       if tensor_names[i] not in SHAPE_DICT:\r\n\r\n~/anaconda3/envs/tf/lib/python3.7/site-packages/tensorflow/python/client/session.py in run(self, fetches, feed_dict, options, run_metadata)\r\n    948     try:\r\n    949       result = self._run(None, fetches, feed_dict, options_ptr,\r\n--> 950                          run_metadata_ptr)\r\n    951       if run_metadata:\r\n    952         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\r\n\r\n~/anaconda3/envs/tf/lib/python3.7/site-packages/tensorflow/python/client/session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\r\n   1171     if final_fetches or final_targets or (handle and feed_dict_tensor):\r\n   1172       results = self._do_run(handle, final_targets, final_fetches,\r\n-> 1173                              feed_dict_tensor, options, run_metadata)\r\n   1174     else:\r\n   1175       results = []\r\n\r\n~/anaconda3/envs/tf/lib/python3.7/site-packages/tensorflow/python/client/session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\r\n   1348     if handle is None:\r\n   1349       return self._do_call(_run_fn, feeds, fetches, targets, options,\r\n-> 1350                            run_metadata)\r\n   1351     else:\r\n   1352       return self._do_call(_prun_fn, handle, feeds, fetches)\r\n\r\n~/anaconda3/envs/tf/lib/python3.7/site-packages/tensorflow/python/client/session.py in _do_call(self, fn, *args)\r\n   1368           pass\r\n   1369       message = error_interpolation.interpolate(message, self._graph)\r\n-> 1370       raise type(e)(node_def, op, message)\r\n   1371 \r\n   1372   def _extend_graph(self):\r\n\r\nOutOfRangeError: Node 'mixnet-s/mixnet_model/stem/batch_normalization/FusedBatchNormV3' (type: 'Add', num of outputs: 1) does not have output 5\r\n\r\n```\r\nI presume this is an issue with the way I am freezing the graph. The checkpoint was taken from the official [Mixnet](https://github.com/tensorflow/tpu/tree/master/models/official/mnasnet/mixnet) implementation. I am relatively new to TF and am still learning. Please help me resolve this issue and let me know in case further information is needed. Suggestions for converting to Core ML are also welcome. Thanks in advance!\r\n\r\n**Code to reproduce the issue**\r\nYou might have to install TF 1.14.0\r\n```python\r\nimport tensorflow as tf\r\nimport tfcoreml as tf_converter\r\nfrom tensorflow.compat.v1 import graph_util\r\n\r\ntf.logging.set_verbosity(tf.logging.ERROR)\r\n\r\n# Download the checkpoint\r\nmodel_name = 'mixnet-s'\r\n!wget https://storage.googleapis.com/cloud-tpu-checkpoints/mixnet/{model_name}.tar.gz -O {model_name}.tar.gz\r\n!tar -zxvf {model_name}.tar.gz\r\nckpt_dir = model_name\r\n\r\ndef _freeze_graph(model_folder):\r\n    # Retrieve the checkpoint fullpath\r\n    checkpoint = tf.train.get_checkpoint_state(model_folder)\r\n    input_checkpoint = checkpoint.model_checkpoint_path\r\n    \r\n    # File fullname of the freezed graph\r\n    absolute_model_folder = \"/\".join(input_checkpoint.split('/')[:-1])\r\n    output_graph = absolute_model_folder + \"/model.pb\"\r\n\r\n    # Before exporting the graph, get the output nodes\r\n    output_node_names = \"logits\"\r\n\r\n    # Clear devices to allow TF to control on which device it will load operations\r\n    clear_devices = True\r\n    \r\n    # Import the meta graph and retrieve a Saver\r\n    saver = tf.train.import_meta_graph(input_checkpoint + '.meta',\r\n                                       clear_devices=clear_devices)\r\n\r\n    # Retrieve the protobuf graph definition\r\n    graph = tf.get_default_graph()\r\n    input_graph_def = graph.as_graph_def()\r\n    \r\n    # Start a session and restore the graph weights\r\n    with tf.Session() as sess:\r\n        saver.restore(sess, input_checkpoint)\r\n\r\n        # Use a built-in TF helper to export variables to constants\r\n        output_graph_def = graph_util.convert_variables_to_constants(\r\n            sess,\r\n            input_graph_def, \r\n            output_node_names.split(\",\")\r\n        ) \r\n\r\n        # Serialize and dump the output graph to the filesystem\r\n        with tf.gfile.GFile(output_graph, \"wb\") as f:\r\n            f.write(output_graph_def.SerializeToString())\r\n        print(\"%d ops in the final graph.\" % len(output_graph_def.node))\r\n\r\n_freeze_graph(ckpt_dir)\r\n\r\nml_model = 'mixnet-s/mixnet_core.mlmodel'\r\nfrozen_model = 'mixnet-s/model.pb'\r\n\r\ntf_converter.convert(tf_model_path=frozen_model,\r\n                     mlmodel_path=ml_model,\r\n                     output_feature_names=['logits'],\r\n                     input_name_shape_dict={})\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32787", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32787/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32787/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32787/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32787", "id": 497870376, "node_id": "MDU6SXNzdWU0OTc4NzAzNzY=", "number": 32787, "title": "Noisy loss in distributed training", "user": {"login": "shahriar49", "id": 17579773, "node_id": "MDQ6VXNlcjE3NTc5Nzcz", "avatar_url": "https://avatars0.githubusercontent.com/u/17579773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shahriar49", "html_url": "https://github.com/shahriar49", "followers_url": "https://api.github.com/users/shahriar49/followers", "following_url": "https://api.github.com/users/shahriar49/following{/other_user}", "gists_url": "https://api.github.com/users/shahriar49/gists{/gist_id}", "starred_url": "https://api.github.com/users/shahriar49/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shahriar49/subscriptions", "organizations_url": "https://api.github.com/users/shahriar49/orgs", "repos_url": "https://api.github.com/users/shahriar49/repos", "events_url": "https://api.github.com/users/shahriar49/events{/privacy}", "received_events_url": "https://api.github.com/users/shahriar49/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 17, "created_at": "2019-09-24T19:05:21Z", "updated_at": "2019-10-09T20:57:31Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 1.12 & 1.13\r\n- Python version: 3.6.5\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source): N/A\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: N/A\r\n\r\n**Describe the current behavior**\r\nI am working on distributed learning in tensorflow through estimators API using below simple code template:\r\n\r\n```\r\nrunConfig = tf.estimator.RunConfig(session_config=config, \r\n                                model_dir=log_dir,\r\n                                save_summary_steps=1,\r\n                                save_checkpoints_steps=train_steps)\r\nestimator = tf.keras.estimator.model_to_estimator(model, model_dir=log_dir, config=runConfig) \r\ntrain_spec = tf.estimator.TrainSpec(input_fn=lambda: read_dataset(...), max_steps=...) \r\neval_spec = tf.estimator.EvalSpec(input_fn=lambda: read_dataset(...), start_delay_secs=1,\r\n                                throttle_secs=1, steps=None) \r\ntf.estimator.train_and_evaluate(estimator, train_spec, eval_spec)\r\n```\r\n\r\nMy model is defined as a simple 2-layer LSTM model in keras, and read_dataset() functions return datasets that I use for training and validation purposes.  The training/validation data files  and model directory are set in a shared place available to all workers. The whole code is exactly the same for servers (ps, chief, and worker) except the task setting in TF_CONFIG.\r\nWhen I train model in single-worker configuration, the loss graph I see in tensorboard is gradually downward and reasonable.\r\n\r\n![single](https://user-images.githubusercontent.com/17579773/65541564-975a6a80-dedb-11e9-9a56-f77d2b5906a8.jpg)\r\n\r\nWhen using two machines of one chief and one worker, the total run time is less (as expected) but the loss graph is very noisy and higher than single-server case.\r\n\r\n![double](https://user-images.githubusercontent.com/17579773/65541692-d092da80-dedb-11e9-96bc-a3a3b0f0d92e.jpg)\r\n\r\nI expected to see the same performance in both cases, but it seems that training in the second server ruins the situation. Is there any special provision/setting/additional code that I should include in my work?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32786", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32786/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32786/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32786/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32786", "id": 497839430, "node_id": "MDU6SXNzdWU0OTc4Mzk0MzA=", "number": 32786, "title": "Keras Layer.compute_output_shape calls `build` with wrong input shape", "user": {"login": "drasmuss", "id": 1952220, "node_id": "MDQ6VXNlcjE5NTIyMjA=", "avatar_url": "https://avatars1.githubusercontent.com/u/1952220?v=4", "gravatar_id": "", "url": "https://api.github.com/users/drasmuss", "html_url": "https://github.com/drasmuss", "followers_url": "https://api.github.com/users/drasmuss/followers", "following_url": "https://api.github.com/users/drasmuss/following{/other_user}", "gists_url": "https://api.github.com/users/drasmuss/gists{/gist_id}", "starred_url": "https://api.github.com/users/drasmuss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/drasmuss/subscriptions", "organizations_url": "https://api.github.com/users/drasmuss/orgs", "repos_url": "https://api.github.com/users/drasmuss/repos", "events_url": "https://api.github.com/users/drasmuss/events{/privacy}", "received_events_url": "https://api.github.com/users/drasmuss/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-09-24T17:59:01Z", "updated_at": "2019-09-27T19:47:09Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 2.0.0rc2\r\n- Python version: 3.6.8\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source): N/A\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: N/A\r\n\r\n**Describe the current behavior**\r\n\r\nWhen using `Layer.compute_output_shape` or `Layer.compute_output_signature` on a Layer with a `build` function, the `build(input_shape=...)` argument is always set to None.\r\n\r\n**Describe the expected behavior**\r\n\r\nThe `input_shape` should be set to the shape passed to `compute_output_shape`.\r\n\r\n**Code to reproduce the issue**\r\n``` python\r\nimport tensorflow as tf\r\n\r\nshape = (1, 2)\r\n\r\n\r\nclass MyLayer(tf.keras.layers.Layer):\r\n    def build(self, input_shape):\r\n        print(input_shape)\r\n        assert input_shape == shape\r\n\r\n    def call(self, inputs):\r\n        return inputs\r\n\r\n\r\nlayer = MyLayer()\r\nlayer.compute_output_shape(shape)\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32783", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32783/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32783/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32783/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32783", "id": 497748530, "node_id": "MDU6SXNzdWU0OTc3NDg1MzA=", "number": 32783, "title": "GELU activation Functions?", "user": {"login": "bwindsor22", "id": 25360076, "node_id": "MDQ6VXNlcjI1MzYwMDc2", "avatar_url": "https://avatars0.githubusercontent.com/u/25360076?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bwindsor22", "html_url": "https://github.com/bwindsor22", "followers_url": "https://api.github.com/users/bwindsor22/followers", "following_url": "https://api.github.com/users/bwindsor22/following{/other_user}", "gists_url": "https://api.github.com/users/bwindsor22/gists{/gist_id}", "starred_url": "https://api.github.com/users/bwindsor22/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bwindsor22/subscriptions", "organizations_url": "https://api.github.com/users/bwindsor22/orgs", "repos_url": "https://api.github.com/users/bwindsor22/repos", "events_url": "https://api.github.com/users/bwindsor22/events{/privacy}", "received_events_url": "https://api.github.com/users/bwindsor22/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-09-24T15:04:20Z", "updated_at": "2019-11-01T14:52:34Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): TF 2.0.\r\n\r\n- Are you willing to contribute it (Yes/No):\r\nYes, pending review, I would be happy to write this in.\r\n\r\n**Describe the feature and the current behavior/state.**\r\nCreate a high-level API implementing the GELU activation function.  This was the activation function used in BERT[0], and the GELU authors prove its success on  a number of benchmarks like CIFAR-10[1].\r\n\r\nGelu is not mentioned in a search on tensorflow.org[2]. \r\n\r\n[0] \"We use a gelu activation (Hendrycks and Gimpel, 2016) rather than the standard relu, following OpenAI GPT.\" https://arxiv.org/pdf/1810.04805.pdf\r\n[1]\"Ultimately, the GELU obtains a median error rate of 7.89%, the ReLU obtains 8.16%, and the ELU obtains 8.41%.\"  https://arxiv.org/pdf/1606.08415.pdf\r\n[2] https://www.tensorflow.org/s/results?q=gelu\r\n\r\n**Will this change the current api? How?**\r\nYes, this would expand the API. A good way to implement it would be adding to activations.py [3] The implementation used in BERT, which may need some modification, is here [4].\r\n\r\n[3] https://github.com/tensorflow/tensorflow/blob/00fad90125b18b80fe054de1055770cfb8fe4ba3/tensorflow/python/keras/activations.py\r\n[4] https://github.com/google-research/bert/blob/master/modeling.py#L264\r\n\r\n**Who will benefit with this feature?**\r\nAll developers writing custom layers, particularly those using keras.layers.Dense. \r\n\r\nAfter implementing, we will not have to worry about any optimization problems which may come from mixing activation functions training on top of BERT models.\r\n\r\n**Any Other info.**\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32780", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32780/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32780/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32780/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32780", "id": 497699959, "node_id": "MDU6SXNzdWU0OTc2OTk5NTk=", "number": 32780, "title": "How to use Tensorflowlite SDK with iOS 8", "user": {"login": "swati-daffodilsw", "id": 22368832, "node_id": "MDQ6VXNlcjIyMzY4ODMy", "avatar_url": "https://avatars3.githubusercontent.com/u/22368832?v=4", "gravatar_id": "", "url": "https://api.github.com/users/swati-daffodilsw", "html_url": "https://github.com/swati-daffodilsw", "followers_url": "https://api.github.com/users/swati-daffodilsw/followers", "following_url": "https://api.github.com/users/swati-daffodilsw/following{/other_user}", "gists_url": "https://api.github.com/users/swati-daffodilsw/gists{/gist_id}", "starred_url": "https://api.github.com/users/swati-daffodilsw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/swati-daffodilsw/subscriptions", "organizations_url": "https://api.github.com/users/swati-daffodilsw/orgs", "repos_url": "https://api.github.com/users/swati-daffodilsw/repos", "events_url": "https://api.github.com/users/swati-daffodilsw/events{/privacy}", "received_events_url": "https://api.github.com/users/swati-daffodilsw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "yyoon", "id": 1309817, "node_id": "MDQ6VXNlcjEzMDk4MTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1309817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yyoon", "html_url": "https://github.com/yyoon", "followers_url": "https://api.github.com/users/yyoon/followers", "following_url": "https://api.github.com/users/yyoon/following{/other_user}", "gists_url": "https://api.github.com/users/yyoon/gists{/gist_id}", "starred_url": "https://api.github.com/users/yyoon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yyoon/subscriptions", "organizations_url": "https://api.github.com/users/yyoon/orgs", "repos_url": "https://api.github.com/users/yyoon/repos", "events_url": "https://api.github.com/users/yyoon/events{/privacy}", "received_events_url": "https://api.github.com/users/yyoon/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "yyoon", "id": 1309817, "node_id": "MDQ6VXNlcjEzMDk4MTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1309817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yyoon", "html_url": "https://github.com/yyoon", "followers_url": "https://api.github.com/users/yyoon/followers", "following_url": "https://api.github.com/users/yyoon/following{/other_user}", "gists_url": "https://api.github.com/users/yyoon/gists{/gist_id}", "starred_url": "https://api.github.com/users/yyoon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yyoon/subscriptions", "organizations_url": "https://api.github.com/users/yyoon/orgs", "repos_url": "https://api.github.com/users/yyoon/repos", "events_url": "https://api.github.com/users/yyoon/events{/privacy}", "received_events_url": "https://api.github.com/users/yyoon/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-09-24T13:46:46Z", "updated_at": "2020-03-06T01:14:06Z", "closed_at": null, "author_association": "NONE", "body": "Hello @petewarden ,\r\n\r\nI want to support tensorlowlite to my existing project which is having iOS 8 min target. But I am getting error while including it using pod targeted OS version does not support use of thread local variables in __ZNK6tflite13eigen_support12_GLOBAL__N_122EigenThreadPoolWrapper15CurrentThreadIdEv for architecture\r\n\r\nCan anyone help me how to fix this issue?\r\nAny help is appreciable.\r\n\r\nThanks\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32771", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32771/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32771/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32771/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32771", "id": 497561430, "node_id": "MDU6SXNzdWU0OTc1NjE0MzA=", "number": 32771, "title": "TensorFlow is broken, unusable on Raspberry Pi", "user": {"login": "FlorinAndrei", "id": 901867, "node_id": "MDQ6VXNlcjkwMTg2Nw==", "avatar_url": "https://avatars1.githubusercontent.com/u/901867?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FlorinAndrei", "html_url": "https://github.com/FlorinAndrei", "followers_url": "https://api.github.com/users/FlorinAndrei/followers", "following_url": "https://api.github.com/users/FlorinAndrei/following{/other_user}", "gists_url": "https://api.github.com/users/FlorinAndrei/gists{/gist_id}", "starred_url": "https://api.github.com/users/FlorinAndrei/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FlorinAndrei/subscriptions", "organizations_url": "https://api.github.com/users/FlorinAndrei/orgs", "repos_url": "https://api.github.com/users/FlorinAndrei/repos", "events_url": "https://api.github.com/users/FlorinAndrei/events{/privacy}", "received_events_url": "https://api.github.com/users/FlorinAndrei/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, {"login": "terryheo", "id": 2908505, "node_id": "MDQ6VXNlcjI5MDg1MDU=", "avatar_url": "https://avatars2.githubusercontent.com/u/2908505?v=4", "gravatar_id": "", "url": "https://api.github.com/users/terryheo", "html_url": "https://github.com/terryheo", "followers_url": "https://api.github.com/users/terryheo/followers", "following_url": "https://api.github.com/users/terryheo/following{/other_user}", "gists_url": "https://api.github.com/users/terryheo/gists{/gist_id}", "starred_url": "https://api.github.com/users/terryheo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/terryheo/subscriptions", "organizations_url": "https://api.github.com/users/terryheo/orgs", "repos_url": "https://api.github.com/users/terryheo/repos", "events_url": "https://api.github.com/users/terryheo/events{/privacy}", "received_events_url": "https://api.github.com/users/terryheo/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-09-24T09:14:49Z", "updated_at": "2020-03-18T18:19:21Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes, code is pasted below\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Raspbian Buster\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: Raspberry Pi 4 with 4 GB RAM\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 1.13.1\r\n- Python version: 3.7.3\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source): N/A\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: N/A\r\n\r\nOn Windows I use python-3.7.4 with TensorFlow 1.13.1, 1.14.0 and 2.0.0rc1\r\n\r\n**Describe the current behavior**\r\nI train a model on Windows (gen_test_train_data.py, then train_model.py), using the same TF version that's available on RPi. I can test the model on Windows just fine using model_visual_test.py.\r\nIf I transfer the model to the RPi, I cannot load it. I get mysterious errors when running model_visual_test.py:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"model_visual_test.py\", line 16, in <module>\r\n    model = keras.models.load_model('saved_model.h5')\r\n  File \"/home/pi/.local/lib/python3.7/site-packages/tensorflow_core/python/keras/saving/save.py\", line 140, in load_model\r\n    loader_impl.parse_saved_model(filepath)\r\n  File \"/home/pi/.local/lib/python3.7/site-packages/tensorflow_core/python/saved_model/loader_impl.py\", line 83, in parse_saved_model\r\n    constants.SAVED_MODEL_FILENAME_PB))\r\nOSError: SavedModel file does not exist at: saved_model.h5/{saved_model.pbtxt|saved_model.pb}\r\n```\r\n\r\nIt doesn't work even if I train the model on the RPi, by running gen_test_train_data.py, then run train_model.py, which takes forever. It completes training, but then it fails to load with\r\n\r\n```\r\nTrain on 8000 samples\r\n8000/8000 [==============================] - 1305s 163ms/sample - loss: 0.5675 - acc: 0.8609\r\nTraceback (most recent call last):\r\n  File \"train_model.py\", line 122, in <module>\r\n    keras.models.save_model(model, 'saved_model.h5')\r\n  File \"/home/pi/.local/lib/python3.7/site-packages/tensorflow_core/python/keras/saving/save.py\", line 104, in save_model\r\n    model, filepath, overwrite, include_optimizer)\r\n  File \"/home/pi/.local/lib/python3.7/site-packages/tensorflow_core/python/keras/saving/hdf5_format.py\", line 73, in save_model_to_hdf5\r\n    raise ImportError('`save_model` requires h5py.')\r\nImportError: `save_model` requires h5py.\r\n```\r\n\r\nNo, that's wrong. I do have the h5 module installed on the Raspberry Pi:\r\n\r\n```\r\n$ pip3 list --user | grep h5\r\nh5py                 2.10.0\r\n```\r\n\r\nIn other words, a model trained on the RPi fails to load on the RPi. A model trained on Win10 runs fine on Win10, but fails to load on the RPi. This is with a code that works perfect on Windows 10 and macOS with all kinds of TF versions between 1.13.1 and 2.0.0rc1, GPU or CPU versions.\r\n\r\n**Describe the expected behavior**\r\nI mean, it should just work, shouldn't it? Why is this so hard?\r\n\r\n**Code to reproduce the issue**\r\nhttps://github.com/FlorinAndrei/TensorAim/tree/tf-bug-report\r\nRun gen_test_train_data.py. Then on that run train_model.py. It fails to run its own model, generated on RPi.\r\nOr run gen_test_train_data.py on Windows, run train_model.py on Windows, transfer the model on the RPi, then run model_visual_test.py on it. It will fail to load.\r\nI will leave this branch untouched so you can test the bug report.\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32765", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32765/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32765/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32765/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32765", "id": 497493579, "node_id": "MDU6SXNzdWU0OTc0OTM1Nzk=", "number": 32765, "title": "A question about tensorflow lite", "user": {"login": "GGGWB", "id": 46663249, "node_id": "MDQ6VXNlcjQ2NjYzMjQ5", "avatar_url": "https://avatars0.githubusercontent.com/u/46663249?v=4", "gravatar_id": "", "url": "https://api.github.com/users/GGGWB", "html_url": "https://github.com/GGGWB", "followers_url": "https://api.github.com/users/GGGWB/followers", "following_url": "https://api.github.com/users/GGGWB/following{/other_user}", "gists_url": "https://api.github.com/users/GGGWB/gists{/gist_id}", "starred_url": "https://api.github.com/users/GGGWB/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/GGGWB/subscriptions", "organizations_url": "https://api.github.com/users/GGGWB/orgs", "repos_url": "https://api.github.com/users/GGGWB/repos", "events_url": "https://api.github.com/users/GGGWB/events{/privacy}", "received_events_url": "https://api.github.com/users/GGGWB/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-09-24T06:51:20Z", "updated_at": "2019-09-26T21:05:34Z", "closed_at": null, "author_association": "NONE", "body": " I am a machine learning beginner. And I want to know the scale of neural networks and and the number of parameters that tensorflow lite can support  so far, because I have not found a similar answer elsewhere. I look forward to your answer."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32764", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32764/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32764/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32764/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32764", "id": 497477379, "node_id": "MDU6SXNzdWU0OTc0NzczNzk=", "number": 32764, "title": "ValueError when passing tensors to keras subclass model calls", "user": {"login": "sghoshjr", "id": 30474432, "node_id": "MDQ6VXNlcjMwNDc0NDMy", "avatar_url": "https://avatars0.githubusercontent.com/u/30474432?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sghoshjr", "html_url": "https://github.com/sghoshjr", "followers_url": "https://api.github.com/users/sghoshjr/followers", "following_url": "https://api.github.com/users/sghoshjr/following{/other_user}", "gists_url": "https://api.github.com/users/sghoshjr/gists{/gist_id}", "starred_url": "https://api.github.com/users/sghoshjr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sghoshjr/subscriptions", "organizations_url": "https://api.github.com/users/sghoshjr/orgs", "repos_url": "https://api.github.com/users/sghoshjr/repos", "events_url": "https://api.github.com/users/sghoshjr/events{/privacy}", "received_events_url": "https://api.github.com/users/sghoshjr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mdanatg", "id": 26628547, "node_id": "MDQ6VXNlcjI2NjI4NTQ3", "avatar_url": "https://avatars1.githubusercontent.com/u/26628547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mdanatg", "html_url": "https://github.com/mdanatg", "followers_url": "https://api.github.com/users/mdanatg/followers", "following_url": "https://api.github.com/users/mdanatg/following{/other_user}", "gists_url": "https://api.github.com/users/mdanatg/gists{/gist_id}", "starred_url": "https://api.github.com/users/mdanatg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mdanatg/subscriptions", "organizations_url": "https://api.github.com/users/mdanatg/orgs", "repos_url": "https://api.github.com/users/mdanatg/repos", "events_url": "https://api.github.com/users/mdanatg/events{/privacy}", "received_events_url": "https://api.github.com/users/mdanatg/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mdanatg", "id": 26628547, "node_id": "MDQ6VXNlcjI2NjI4NTQ3", "avatar_url": "https://avatars1.githubusercontent.com/u/26628547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mdanatg", "html_url": "https://github.com/mdanatg", "followers_url": "https://api.github.com/users/mdanatg/followers", "following_url": "https://api.github.com/users/mdanatg/following{/other_user}", "gists_url": "https://api.github.com/users/mdanatg/gists{/gist_id}", "starred_url": "https://api.github.com/users/mdanatg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mdanatg/subscriptions", "organizations_url": "https://api.github.com/users/mdanatg/orgs", "repos_url": "https://api.github.com/users/mdanatg/repos", "events_url": "https://api.github.com/users/mdanatg/events{/privacy}", "received_events_url": "https://api.github.com/users/mdanatg/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2019-09-24T06:10:15Z", "updated_at": "2019-11-04T18:38:40Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10 / Linux Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: Not tested\r\n- TensorFlow installed from (source or binary): Binary\r\n- TensorFlow version (use command below): 2.0.0-rc0 / rc1 / rc2\r\n- Python version: 3.7.4\r\n- Bazel version (if compiling from source): NA\r\n- GCC/Compiler version (if compiling from source): NA\r\n- CUDA/cuDNN version: 10.0 / 7.6.3\r\n- GPU model and memory: Quadro K620\r\n\r\n**Describe the current behavior**\r\nUsing conditional statements on tensors passed to keras subclassed models without `@tf.function` decorator leads to ValueError Exception\r\n` ValueError: Incompatible shapes between op input and calculated input gradient.  Forward operation: Identity.  Input index: 0. Original input shape: (64, 1024).  Calculated input gradient shape: (32, 1024)`\r\nNeither `tf.cond` or python's if statement work without decorator.\r\n\r\nThe Model works fine if the call function is decorated with `@tf.function` decorator.\r\nPassing Python Boolean values instead of `tf.constant(True)` works fine, with and without `@tf.function` decorator.\r\n  \r\n**EDIT**: Eager mode works fine. (without any `@tf.function`)\r\n\r\n**Describe the expected behavior**\r\nThe model should work without mandating `@tf.function` decorator. See the code for details.\r\n\r\n**Code to reproduce the issue**\r\nCode that reproduces the problem. [Colab Link](https://colab.research.google.com/drive/1zNGK5sc3JVVveg-5Fe3JE0MVqxgd6h6d)\r\n\r\n**Other info / logs**\r\n\r\n    ValueError: in converted code:\r\n\r\n    <ipython-input-26-76bba83ea439>:12 train_step  *\r\n        gradients_mdan = tape.gradient(model_loss, model.trainable_variables)\r\n    /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/eager/backprop.py:1014 gradient\r\n        unconnected_gradients=unconnected_gradients)\r\n    /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/eager/imperative_grad.py:76 imperative_grad\r\n        compat.as_str(unconnected_gradients.value))\r\n    /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/eager/backprop.py:138 _gradient_function\r\n        return grad_fn(mock_op, *out_grads)\r\n    /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/ops/cond_v2.py:120 _IfGrad\r\n        true_graph, grads, util.unique_grad_fn_name(true_graph.name))\r\n    /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/ops/cond_v2.py:395 _create_grad_func\r\n        func_graph=_CondGradFuncGraph(name, func_graph))\r\n    /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/func_graph.py:915 func_graph_from_py_func\r\n        func_outputs = python_func(*func_args, **func_kwargs)\r\n    /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/ops/cond_v2.py:394 <lambda>\r\n        lambda: _grad_fn(func_graph, grads), [], {},\r\n    /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/ops/cond_v2.py:373 _grad_fn\r\n        src_graph=func_graph)\r\n    /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/ops/gradients_util.py:714 _GradientsHelper\r\n        (op.name, i, t_in.shape, in_grad.shape))\r\n\r\n    ValueError: Incompatible shapes between op input and calculated input gradient.  Forward operation: Identity.  Input index: 0. Original input shape: (64, 1024).  Calculated input gradient shape: (32, 1024)"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32763", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32763/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32763/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32763/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32763", "id": 497476776, "node_id": "MDU6SXNzdWU0OTc0NzY3NzY=", "number": 32763, "title": "tf.sparse.reduce_sum slower/less memory efficient than (unsorted_)segment_sum", "user": {"login": "jackd", "id": 659115, "node_id": "MDQ6VXNlcjY1OTExNQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/659115?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jackd", "html_url": "https://github.com/jackd", "followers_url": "https://api.github.com/users/jackd/followers", "following_url": "https://api.github.com/users/jackd/following{/other_user}", "gists_url": "https://api.github.com/users/jackd/gists{/gist_id}", "starred_url": "https://api.github.com/users/jackd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jackd/subscriptions", "organizations_url": "https://api.github.com/users/jackd/orgs", "repos_url": "https://api.github.com/users/jackd/repos", "events_url": "https://api.github.com/users/jackd/events{/privacy}", "received_events_url": "https://api.github.com/users/jackd/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-09-24T06:08:28Z", "updated_at": "2019-09-25T08:31:33Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes (below)\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): **ubuntu 16.04**\r\n- TensorFlow installed from (source or binary): **binary**\r\n- TensorFlow version (use command below): **v1.12.1-9365-gff401a6 1.15.0-dev20190821**\r\n- Python version: **3.6.9**\r\n- CUDA/cuDNN version: **10.0** / ??\r\n- GPU model and memory: **GTX-1070**\r\n\r\n**Current behavior**\r\n`tf.sparse.reduce_sum` (result of a custom kernel) **50-200x slower** and 2-5x less memory efficient compared to `tf.math.unsorted_segment_sum` implementation.\r\n\r\n**Describe the expected behavior**\r\nCustom kernel performance should be no worse than implementations in terms of other operations.\r\n\r\n**Code to reproduce the issue**\r\nA very basic implementation (without support for rank > 2 or multiple summation axes) is as follows.\r\n```python\r\ndef seg_sum(sp, axis=1, ordered=False):\r\n    \"\"\"\r\n    math.(unsorted_)segment_sum.\r\n\r\n    Args:\r\n        sp: rank 2 sparse tensor\r\n        axis: int, axis along which to sum\r\n        ordered: if True, other axis indices are assumed to be ascending.\r\n\r\n    Returns:\r\n        rank 1 dense tensor equivalent to tf.sparse.reduce_sum(sp, axis=axis)\r\n    \"\"\"\r\n    if sp.shape.ndims != 2:\r\n        raise NotImplementedError\r\n    other_axis = 0 if axis in (1, -1) else 1\r\n    if ordered:\r\n        return tf.math.segment_sum(sp.values, sp.indices[:, other_axis])\r\n    else:\r\n        return tf.math.unsorted_segment_sum(sp.values,\r\n                                            sp.indices[:, other_axis],\r\n                                            sp.dense_shape[other_axis])\r\n```\r\nExtending this to support full functionality should not be difficult.\r\n\r\nBasic testing/benchmarking script:\r\n```python\r\nfrom __future__ import absolute_import\r\nfrom __future__ import division\r\nfrom __future__ import print_function\r\n\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\n\r\ndef get_data(dense_shape, mean_edges=100, seed=123):\r\n    \"\"\"Generate random sparse matrix data.\"\"\"\r\n    N, M = dense_shape\r\n    r = np.random.RandomState(seed)\r\n\r\n    num_edges = int(mean_edges * N)\r\n\r\n    flat_index = (r.uniform(size=num_edges) * N * M).astype(np.int64)\r\n    # flat_index = np.concatenate([flat_index, np.arange(0, N * M, M)], axis=0)\r\n    flat_index = np.array(sorted(set(flat_index)), dtype=np.int64)\r\n    i, j = np.unravel_index(flat_index, (N, M))  # pylint: disable=unbalanced-tuple-unpacking\r\n    sparse_indices = np.stack((i, j), axis=-1)\r\n    weights = np.random.uniform(size=(i.shape[0],)).astype(np.float32)\r\n    return sparse_indices, weights\r\n\r\n\r\ndef sparse_sum(sp, axis=1):\r\n    \"\"\"sparse.reduce_sum.\"\"\"\r\n    return tf.sparse.reduce_sum(sp, axis=axis)\r\n\r\n\r\ndef sparse_sum2(sp, axis=1):\r\n    \"\"\"sparse.reduce_sum_sparse -> to_dense.\"\"\"\r\n    return tf.sparse.to_dense(tf.sparse.reduce_sum_sparse(sp, axis=axis))\r\n\r\n\r\ndef seg_sum(sp, axis=1, ordered=False):\r\n    \"\"\"\r\n    math.(unsorted_)segment_sum.\r\n\r\n    Args:\r\n        sp: rank 2 sparse tensor\r\n        axis: int, axis along which to sum\r\n        ordered: if True, other axis indices are assumed to be ascending.\r\n\r\n    Returns:\r\n        rank 1 dense tensor equivalent to tf.sparse.reduce_sum(sp, axis=axis)\r\n    \"\"\"\r\n    if sp.shape.ndims != 2:\r\n        raise NotImplementedError\r\n    other_axis = 0 if axis in (1, -1) else 1\r\n    if ordered:\r\n        return tf.math.segment_sum(sp.values, sp.indices[:, other_axis])\r\n    else:\r\n        return tf.math.unsorted_segment_sum(sp.values,\r\n                                            sp.indices[:, other_axis],\r\n                                            sp.dense_shape[other_axis])\r\n\r\n\r\ndef compare(dense_shape, axis=1, ordered=False, **kwargs):\r\n    sparse_indices, weights = get_data(dense_shape, **kwargs)\r\n    sparse_indices = tf.constant(sparse_indices, dtype=tf.int64)\r\n    weights = tf.constant(weights, dtype=tf.float32)\r\n    sp = tf.SparseTensor(sparse_indices, weights, dense_shape)\r\n    sparse = sparse_sum(sp, axis=axis)\r\n    sparse2 = sparse_sum2(sp, axis=axis)\r\n    seg = seg_sum(sp, axis=axis, ordered=ordered)\r\n    sparse_grad, = tf.gradients(sparse, weights)\r\n    # sparse2_grad, = tf.gradients(sparse2, weights)\r\n    seg_grad, = tf.gradients(seg, weights)\r\n    err = tf.reduce_max(tf.abs(seg - sparse))\r\n    shape_err = tf.reduce_max(tf.abs(tf.shape(sparse) - tf.shape(seg)))\r\n    err2 = tf.reduce_max(tf.abs(seg - sparse2))\r\n    shape_err2 = tf.reduce_max(tf.abs(tf.shape(sparse2) - tf.shape(seg)))\r\n    grad_err = tf.reduce_max(tf.abs(sparse_grad - seg_grad))\r\n    # grad_err2 = tf.reduce_max(tf.abs(sparse2_grad - seg_grad))\r\n\r\n    with tf.Session() as sess:\r\n        err, shape_err, err2, shape_err2, grad_err = sess.run(\r\n            (err, shape_err, err2, shape_err2, grad_err))\r\n    assert (err < 1e-4)\r\n    assert (shape_err == 0)\r\n    assert (shape_err2 == 0)\r\n    assert (grad_err < 1e-4)\r\n    return err\r\n\r\n\r\ndef run_benchmarks(dense_shape, axis=1, ordered=False, **kwargs):\r\n    sparse_indices, weights = get_data(dense_shape, **kwargs)\r\n    sparse_indices = tf.constant(sparse_indices, dtype=tf.int64)\r\n    weights = tf.constant(weights, dtype=tf.float32)\r\n    sp = tf.SparseTensor(sparse_indices, weights, dense_shape)\r\n    sparse = sparse_sum(sp, axis=axis)\r\n    sparse_grad, = tf.gradients(sparse, weights)\r\n\r\n    seg = seg_sum(sp, axis=axis, ordered=ordered)\r\n    seg_grad = tf.gradients(seg, weights)\r\n\r\n    sparse2 = sparse_sum2(sp, axis=axis)\r\n    # sparse2_grad, = tf.gradients(sparse2, weights)\r\n    # print(sparse2_grad)\r\n    names = []\r\n    time = []\r\n    mem = []\r\n\r\n    def update(name, result):\r\n        time.append(result['wall_time'])\r\n        mem.append(result['extras']['allocator_maximum_num_bytes_GPU_0_bfc'])\r\n        names.append(name)\r\n\r\n    with tf.Session() as sess:\r\n        print('------------------')\r\n        print('----- SPARSE -----')\r\n        bm = tf.test.Benchmark()\r\n        result = bm.run_op_benchmark(sess, (sparse, sparse_grad))\r\n        update('sparse', result)\r\n        # # no gradients to sparse2 - unfair comparison\r\n        print('------------------')\r\n        print('----- SPARSE2 -----')\r\n        bm = tf.test.Benchmark()\r\n        result = bm.run_op_benchmark(sess, (sparse2,))\r\n        update('sparse2', result)\r\n        print('------------------')\r\n        print('----- SEG ----')\r\n        bm = tf.test.Benchmark()\r\n        result = bm.run_op_benchmark(sess, (seg, seg_grad))\r\n        update('seg', result)\r\n\r\n    time = np.array(time)\r\n    i = np.argmin(time)\r\n    best_time = time[i]\r\n    print('Fastest:  {}, {}'.format(names[i], best_time))\r\n\r\n    mem = np.array(mem)\r\n    j = np.argmin(mem)\r\n    best_mem = mem[j]\r\n    print('Smallest: {}, {:.2f}mb'.format(names[j], best_mem / (1024**2)))\r\n\r\n    print('rel time, rel mem, name')\r\n    for name, t, m in zip(names, time, mem):\r\n        print('{:.3f}, {:.3f}, {}'.format(t / best_time, m / best_mem, name))\r\n    return time, mem, names\r\n\r\n\r\naxis = 0\r\nordered = False\r\ndense_shape = (int(1e4), int(1e6))\r\ncompare(axis=axis, dense_shape=dense_shape, ordered=ordered)\r\nrun_benchmarks(axis=axis, dense_shape=dense_shape, ordered=ordered)\r\n\r\n```\r\n\r\n**Other info / logs**\r\n```\r\n------------------\r\n----- SPARSE -----\r\n2019-09-24 16:03:05.305709: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.\r\nentry {\r\n  name: \"TensorFlowBenchmark.run_op_benchmark\"\r\n  iters: 10\r\n  wall_time: 0.2983849048614502\r\n  extras {\r\n    key: \"allocator_maximum_num_bytes_GPU_0_bfc\"\r\n    value {\r\n      double_value: 23998744.0\r\n    }\r\n  }\r\n  extras {\r\n    key: \"allocator_maximum_num_bytes_cpu\"\r\n    value {\r\n      double_value: 4000000.0\r\n    }\r\n  }\r\n  extras {\r\n    key: \"allocator_maximum_num_bytes_gpu_host_bfc\"\r\n    value {\r\n      double_value: 4.0\r\n    }\r\n  }\r\n}\r\n\r\n------------------\r\n----- SPARSE2 -----\r\nentry {\r\n  name: \"TensorFlowBenchmark.run_op_benchmark\"\r\n  iters: 10\r\n  wall_time: 0.32063305377960205\r\n  extras {\r\n    key: \"allocator_maximum_num_bytes_GPU_0_bfc\"\r\n    value {\r\n      double_value: 19998956.0\r\n    }\r\n  }\r\n  extras {\r\n    key: \"allocator_maximum_num_bytes_cpu\"\r\n    value {\r\n      double_value: 11582884.0\r\n    }\r\n  }\r\n}\r\n\r\n------------------\r\n----- SEG ----\r\nentry {\r\n  name: \"TensorFlowBenchmark.run_op_benchmark\"\r\n  iters: 10\r\n  wall_time: 0.0016645193099975586\r\n  extras {\r\n    key: \"allocator_maximum_num_bytes_GPU_0_bfc\"\r\n    value {\r\n      double_value: 7999788.0\r\n    }\r\n  }\r\n}\r\n\r\nFastest:  seg, 0.0016645193099975586\r\nSmallest: seg, 7.63mb\r\nrel time, rel mem, name\r\n179.262, 3.000, sparse\r\n192.628, 2.500, sparse2\r\n1.000, 1.000, seg\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32761", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32761/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32761/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32761/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32761", "id": 497448845, "node_id": "MDU6SXNzdWU0OTc0NDg4NDU=", "number": 32761, "title": " keras.metrics.Accuracy != keras.metrics.accuracy", "user": {"login": "rodrigob", "id": 65367, "node_id": "MDQ6VXNlcjY1MzY3", "avatar_url": "https://avatars0.githubusercontent.com/u/65367?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rodrigob", "html_url": "https://github.com/rodrigob", "followers_url": "https://api.github.com/users/rodrigob/followers", "following_url": "https://api.github.com/users/rodrigob/following{/other_user}", "gists_url": "https://api.github.com/users/rodrigob/gists{/gist_id}", "starred_url": "https://api.github.com/users/rodrigob/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rodrigob/subscriptions", "organizations_url": "https://api.github.com/users/rodrigob/orgs", "repos_url": "https://api.github.com/users/rodrigob/repos", "events_url": "https://api.github.com/users/rodrigob/events{/privacy}", "received_events_url": "https://api.github.com/users/rodrigob/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-09-24T04:31:45Z", "updated_at": "2019-11-07T00:49:20Z", "closed_at": null, "author_association": "NONE", "body": "The following test \r\n```\r\n@test_util.run_all_in_graph_and_eager_modes\r\nclass KerasAccuracyTest(test.TestCase):\r\n\r\n def test_accuracy_vs_accuracy(self):\r\n    y_true = constant_op.constant([1, 0, 1])\r\n    y_pred = constant_op.constant([0.8, 0.1, 0.9])\r\n    ret_a_tensor = metrics.accuracy(y_true, y_pred)\r\n    ret_a = np.mean(self.evaluate(ret_a_tensor))\r\n    \r\n    acc_obj = metrics.Accuracy(name='my_acc')\r\n    self.evaluate(variables.variables_initializer(acc_obj.variables))\r\n    update_op = acc_obj.update_state(y_true, y_pred)\r\n    self.evaluate(update_op)\r\n    ret_b = self.evaluate(acc_obj.result())\r\n    self.assertEqual(ret_a, ret_b)\r\n```\r\n\r\ndoes not pass because \r\nhttps://github.com/tensorflow/tensorflow/blob/3d5e79e08ae299812e0eaf6183f4886591e932bd/tensorflow/python/keras/metrics.py#L576-L577\r\n\r\nseems to be doing two casts they should not.\r\n\r\nAlso it is unclear to me what is the expected value for `ret_a` (which I would have understood to be 1, but currently returns 1/3).\r\n\r\n\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32760", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32760/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32760/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32760/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32760", "id": 497435403, "node_id": "MDU6SXNzdWU0OTc0MzU0MDM=", "number": 32760, "title": "TensorFlow Lite save  from_session error", "user": {"login": "linyia01", "id": 28997848, "node_id": "MDQ6VXNlcjI4OTk3ODQ4", "avatar_url": "https://avatars2.githubusercontent.com/u/28997848?v=4", "gravatar_id": "", "url": "https://api.github.com/users/linyia01", "html_url": "https://github.com/linyia01", "followers_url": "https://api.github.com/users/linyia01/followers", "following_url": "https://api.github.com/users/linyia01/following{/other_user}", "gists_url": "https://api.github.com/users/linyia01/gists{/gist_id}", "starred_url": "https://api.github.com/users/linyia01/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/linyia01/subscriptions", "organizations_url": "https://api.github.com/users/linyia01/orgs", "repos_url": "https://api.github.com/users/linyia01/repos", "events_url": "https://api.github.com/users/linyia01/events{/privacy}", "received_events_url": "https://api.github.com/users/linyia01/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-09-24T03:36:37Z", "updated_at": "2020-02-21T18:43:18Z", "closed_at": null, "author_association": "NONE", "body": "xs = tf.placeholder(tf.float32, [10, datalen], name='input')\r\npredic_val = tf.argmax(graph, 1, name='output')\r\nconverter = tf.lite.TFLiteConverter.from_session(sess, [xs], [predic_val])\r\ntflite_model = converter.convert()\r\nopen('%s/twave_%d.lite' % (path,i), \"wb\").write(tflite_model)\r\n\r\n\r\n\r\n2019-09-24 11:30:42.542541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2019-09-24 11:30:42.542549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 \r\n2019-09-24 11:30:42.542557: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N \r\n2019-09-24 11:30:42.546249: E tensorflow/core/grappler/grappler_item_builder.cc:656] Init node is_training/Assign doesn't exist in graph\r\nSee console for info.\r\n2019-09-24 11:30:46.310416: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 153 operators, 209 arrays (0 quantized)\r\n2019-09-24 11:30:46.311793: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 153 operators, 209 arrays (0 quantized)\r\n2019-09-24 11:30:46.311861: F ./tensorflow/lite/toco/model.h:352] Check failed: dims_.size() > i (0 vs. 0)\r\nFatal Python error: Aborted\r\n\r\nCurrent thread 0x00007fb218c41740 (most recent call first):\r\n  File \"/opt/python366/lib/python3.6/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 52 in execute\r\n  File \"/opt/python366/lib/python3.6/site-packages/absl/app.py\", line 250 in _run_main\r\n  File \"/opt/python366/lib/python3.6/site-packages/absl/app.py\", line 299 in run\r\n  File \"/opt/python366/lib/python3.6/site-packages/tensorflow_core/python/platform/app.py\", line 40 in run\r\n  File \"/opt/python366/lib/python3.6/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 89 in main\r\n  File \"/opt/python366/bin/toco_from_protos\", line 10 in <module>\r\n\r\n\r\n\r\n2019-09-24 11:31:03.164355: W tensorflow/core/kernels/queue_base.cc:277] _4_batch/fifo_queue: Skipping cancelled enqueue attempt with queue not closed\r\n2019-09-24 11:31:03.164499: W tensorflow/core/kernels/queue_base.cc:277] _0_input_producer: Skipping cancelled enqueue attempt with queue not closed\r\n2019-09-24 11:31:03.164595: W tensorflow/core/kernels/queue_base.cc:277] _3_input_producer_1: Skipping cancelled enqueue attempt with queue not closed\r\n2019-09-24 11:31:03.164863: W tensorflow/core/kernels/queue_base.cc:277] _1_shuffle_batch/random_shuffle_queue: Skipping cancelled enqueue attempt with queue not closed\r\n2019-09-24 11:31:03.164932: W tensorflow/core/kernels/queue_base.cc:277] _1_shuffle_batch/random_shuffle_queue: Skipping cancelled enqueue attempt with queue not closed\r\n2019-09-24 11:31:03.164955: W tensorflow/core/kernels/queue_base.cc:277] _1_shuffle_batch/random_shuffle_queue: Skipping cancelled enqueue attempt with queue not closed\r\n2019-09-24 11:31:03.164971: W tensorflow/core/kernels/queue_base.cc:277] _1_shuffle_batch/random_shuffle_queue: Skipping cancelled enqueue attempt with queue not closed\r\n2019-09-24 11:31:03.164986: W tensorflow/core/kernels/queue_base.cc:277] _1_shuffle_batch/random_shuffle_queue: Skipping cancelled enqueue attempt with queue not closed\r\nINFO:tensorflow:Error reported to Coordinator: <class 'tensorflow.python.framework.errors_impl.CancelledError'>, Enqueue operation was cancelled"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32759", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32759/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32759/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32759/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32759", "id": 497420815, "node_id": "MDU6SXNzdWU0OTc0MjA4MTU=", "number": 32759, "title": "call custom op using c++", "user": {"login": "7oud", "id": 7981826, "node_id": "MDQ6VXNlcjc5ODE4MjY=", "avatar_url": "https://avatars0.githubusercontent.com/u/7981826?v=4", "gravatar_id": "", "url": "https://api.github.com/users/7oud", "html_url": "https://github.com/7oud", "followers_url": "https://api.github.com/users/7oud/followers", "following_url": "https://api.github.com/users/7oud/following{/other_user}", "gists_url": "https://api.github.com/users/7oud/gists{/gist_id}", "starred_url": "https://api.github.com/users/7oud/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/7oud/subscriptions", "organizations_url": "https://api.github.com/users/7oud/orgs", "repos_url": "https://api.github.com/users/7oud/repos", "events_url": "https://api.github.com/users/7oud/events{/privacy}", "received_events_url": "https://api.github.com/users/7oud/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "yifeif", "id": 1192265, "node_id": "MDQ6VXNlcjExOTIyNjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/1192265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yifeif", "html_url": "https://github.com/yifeif", "followers_url": "https://api.github.com/users/yifeif/followers", "following_url": "https://api.github.com/users/yifeif/following{/other_user}", "gists_url": "https://api.github.com/users/yifeif/gists{/gist_id}", "starred_url": "https://api.github.com/users/yifeif/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yifeif/subscriptions", "organizations_url": "https://api.github.com/users/yifeif/orgs", "repos_url": "https://api.github.com/users/yifeif/repos", "events_url": "https://api.github.com/users/yifeif/events{/privacy}", "received_events_url": "https://api.github.com/users/yifeif/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "yifeif", "id": 1192265, "node_id": "MDQ6VXNlcjExOTIyNjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/1192265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yifeif", "html_url": "https://github.com/yifeif", "followers_url": "https://api.github.com/users/yifeif/followers", "following_url": "https://api.github.com/users/yifeif/following{/other_user}", "gists_url": "https://api.github.com/users/yifeif/gists{/gist_id}", "starred_url": "https://api.github.com/users/yifeif/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yifeif/subscriptions", "organizations_url": "https://api.github.com/users/yifeif/orgs", "repos_url": "https://api.github.com/users/yifeif/repos", "events_url": "https://api.github.com/users/yifeif/events{/privacy}", "received_events_url": "https://api.github.com/users/yifeif/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-09-24T02:34:38Z", "updated_at": "2019-10-28T11:29:36Z", "closed_at": null, "author_association": "NONE", "body": "I built a very simple custom op `zero_out` and try to run it using c++, the question is how to call this op, there is no doc about it.\r\n\r\ncode of custom op `zero_out`\r\n```\r\n#include \"tensorflow/core/framework/op.h\"\r\n#include \"tensorflow/core/framework/shape_inference.h\"\r\n#include \"tensorflow/core/framework/op_kernel.h\"\r\nusing namespace tensorflow;\r\n\r\nREGISTER_OP(\"ZeroOut\")\r\n.Input(\"to_zero: float\")\r\n.Output(\"zeroed: float\")\r\n.SetShapeFn([](::tensorflow::shape_inference::InferenceContext* c) {\r\nc->set_output(0, c->input(0));\r\nreturn Status::OK();\r\n});\r\n\r\nclass ZeroOutOp : public OpKernel {\r\npublic:\r\n    explicit ZeroOutOp(OpKernelConstruction* context) : OpKernel(context) {}\r\n\r\n    void Compute(OpKernelContext* context) override {\r\n        const Tensor& input_tensor = context->input(0);\r\n        auto input = input_tensor.flat<float>();\r\n        Tensor* output_tensor = NULL;\r\n        OP_REQUIRES_OK(context, context->allocate_output(0, input_tensor.shape(),                                                     &output_tensor));\r\n        auto output_flat = output_tensor->flat<float>();\r\n        const int N = input.size();\r\n        for (int i = 1; i < N; i++)\r\n            output_flat(i) = 0;\r\n        if (N > 0) output_flat(0) = input(0);\r\n    }\r\n};\r\n\r\nREGISTER_KERNEL_BUILDER(Name(\"ZeroOut\").Device(DEVICE_CPU), ZeroOutOp);\r\n```\r\nAfter building, I got `zero_out.so`, then I load the lib using c++\r\n```\r\n    TF_Status* status_load = TF_NewStatus();\r\n    TF_Library* lib_handle = TF_LoadLibrary(\"libzero_out.so\", status_load);\r\n    TF_Code code = TF_GetCode(status_load);\r\n    cout << \"code: \" << code << endl;  // output: 0\r\n\r\n    TF_Buffer op_list_buf = TF_GetOpList(lib_handle);\r\n    tensorflow::OpList op_list;\r\n    op_list.ParseFromArray(op_list_buf.data, op_list_buf.length);\r\n    cout << \"oplist size = \" << op_list.op_size() << endl;    // output: 1\r\n    cout << \"oplist name = \" << op_list.op(0).name() << endl;    // output: ZeroOut\r\n```\r\nI think the op should have been registered, then how to invoke the op function, Could you give some examples or code snippet?\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32730", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32730/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32730/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32730/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32730", "id": 497127554, "node_id": "MDU6SXNzdWU0OTcxMjc1NTQ=", "number": 32730, "title": "tf.nn.relu on nan inputs returns zeros on GPU", "user": {"login": "msoelch", "id": 6438560, "node_id": "MDQ6VXNlcjY0Mzg1NjA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6438560?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msoelch", "html_url": "https://github.com/msoelch", "followers_url": "https://api.github.com/users/msoelch/followers", "following_url": "https://api.github.com/users/msoelch/following{/other_user}", "gists_url": "https://api.github.com/users/msoelch/gists{/gist_id}", "starred_url": "https://api.github.com/users/msoelch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msoelch/subscriptions", "organizations_url": "https://api.github.com/users/msoelch/orgs", "repos_url": "https://api.github.com/users/msoelch/repos", "events_url": "https://api.github.com/users/msoelch/events{/privacy}", "received_events_url": "https://api.github.com/users/msoelch/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-09-23T14:19:09Z", "updated_at": "2019-09-24T05:52:09Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes, see minimal example code section below.\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 1.13.1 and 1.14.0\r\n- Python version: 3.6.5\r\n- CUDA/cuDNN version: 10.0, 7.6.3\r\n- GPU model and memory: GeForce GTX 1080 (8GB)\r\n\r\n**Describe the current behavior**\r\nThe behavior of `tf.nn.relu` when fed with `nan`-valued inputs is inconsistent:\r\n- if the input is a constant tensor, `relu` returns `nan`.\r\n- if the input is a variable tensor (like `nan` wrapped into `tf.Variable` or multiplied by a random tensor), it returns zeros.\r\n\r\nThis behavior can only be observed on the GPU. On the CPU, `relu` consistently returns `nan`. The behavior on the CPU is also consistent with other activation functions.\r\n\r\n\r\n**Describe the expected behavior**\r\n`tf.nn.relu` should handle `nan` inputs from all sources consistently. To keep consistency with other activation functions, it should return `nan` in all cases.\r\n\r\n\r\n**Code to reproduce the issue**\r\nThe assertions below all pass. The second and third assertion (the `not` assertions) would be expected to fail.\r\n```python\r\nx1 = tf.nn.relu(np.nan)\r\nx2 = tf.nn.relu(np.nan * tf.random_normal(shape=[]))\r\nx3 = tf.nn.relu(tf.Variable(np.nan))\r\n\r\nwith tf.device(\"/cpu:0\"):\r\n    x1_cpu = tf.nn.relu(np.nan)\r\n    x2_cpu = tf.nn.relu(np.nan * tf.random_normal(shape=[]))\r\n    x3_cpu = tf.nn.relu(tf.Variable(np.nan))\r\n\r\nwith tf.Session() as sess:\r\n    sess.run(tf.global_variables_initializer())\r\n\r\n    assert np.all(np.isnan(sess.run(x1)))\r\n    assert not np.any(np.isnan(sess.run(x2)))  # should fail but does not\r\n    assert not np.any(np.isnan(sess.run(x3)))  # should fail but does not\r\n\r\n    assert np.all(np.allclose(sess.run(x2), 0.0))\r\n    assert np.all(np.allclose(sess.run(x3), 0.0))\r\n\r\n    assert np.all(np.isnan(sess.run(x1_cpu)))\r\n    assert np.all(np.isnan(sess.run(x2_cpu)))\r\n    assert np.all(np.isnan(sess.run(x3_cpu)))\r\n```\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32720", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32720/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32720/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32720/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32720", "id": 496839582, "node_id": "MDU6SXNzdWU0OTY4Mzk1ODI=", "number": 32720, "title": "tensorflow.python.framework.errors_impl.InvalidArgumentError: Retval[0] does not have value with BatchNorm and Map_fn", "user": {"login": "gstoica27", "id": 14844582, "node_id": "MDQ6VXNlcjE0ODQ0NTgy", "avatar_url": "https://avatars1.githubusercontent.com/u/14844582?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gstoica27", "html_url": "https://github.com/gstoica27", "followers_url": "https://api.github.com/users/gstoica27/followers", "following_url": "https://api.github.com/users/gstoica27/following{/other_user}", "gists_url": "https://api.github.com/users/gstoica27/gists{/gist_id}", "starred_url": "https://api.github.com/users/gstoica27/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gstoica27/subscriptions", "organizations_url": "https://api.github.com/users/gstoica27/orgs", "repos_url": "https://api.github.com/users/gstoica27/repos", "events_url": "https://api.github.com/users/gstoica27/events{/privacy}", "received_events_url": "https://api.github.com/users/gstoica27/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-09-22T22:09:34Z", "updated_at": "2019-10-06T06:23:11Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\nAny help would be very greatly appreciated! Thanks!\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04.06 & OSX 10.14.6\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 1.14 on both os's, tf-gpu on ubuntu\r\n- Python version: 3.7\r\n- CUDA/cuDNN version: (ubuntu only) 10.1\r\n- GPU model and memory: Titan X Pascal\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nApplying batch normalization on top of batchwise tf.map_fn results in retval[0] error.  Note that this fails even when tf.map_fn operates over convolution filters. In this latter case, we have a different filter for each batch element, and so cannot apply the normal tf.conv functions without a map.\r\n\r\n**Describe the expected behavior**\r\nApplying batch normalization on top of batchwise tf.map_fn should pass without issue, as in this case it should emulate batchwise matmul.\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\nBelow is the code. Alternatively, it can be found in this txt file:\r\n[run_dummy.txt](https://github.com/tensorflow/tensorflow/files/3643105/run_dummy.txt)\r\n\r\n\r\n\r\n```python3\r\nimport tensorflow as tf\r\n\r\n\r\nclass DummyModelRunner(object):\r\n    def __init__(self):\r\n        self.optimizer = tf.train.AdamOptimizer()\r\n\r\n        with tf.variable_scope('Dummy_Vars', use_resource=True):\r\n            self.variables = self.create_variables()\r\n\r\n        self.is_train = tf.placeholder_with_default(False, shape=[], name='is_train')\r\n\r\n        self.batch_inputs = tf.ones(shape=[256, 10], dtype=tf.float32, name='e1_embs')\r\n        actual_answers = tf.ones(shape=[256, 10, 5], dtype=tf.float32, name='actual_answers')\r\n        targets = tf.ones(shape=[256, 5], dtype=tf.float32, name='targets')\r\n\r\n        self.batch_outputs = self.create_predictions(input_embs=self.batch_inputs)\r\n\r\n        self.predictions = self.compute_likelihoods(self.batch_outputs, actual_answers)\r\n\r\n        self.loss = self.create_loss(self.predictions, targets)\r\n\r\n        # The following control dependency is needed in order for batch\r\n        # normalization to work correctly.\r\n        self.update_ops = tf.get_collection(tf.GraphKeys.UPDATE_OPS)\r\n        with tf.control_dependencies(self.update_ops):\r\n            self.train_op = self.optimizer.minimize(self.loss)\r\n            gradients, variables = zip(*self.optimizer.compute_gradients(self.loss))\r\n            gradients, _ = tf.clip_by_global_norm(gradients, 5.0)\r\n            self.train_op = self.optimizer.apply_gradients(zip(gradients, variables))\r\n\r\n    def create_variables(self):\r\n        \"\"\"\r\n        create all network variables\r\n        :return: all variable dictionary\r\n        \"\"\"\r\n        weight = tf.get_variable(name='DummyWeight',\r\n                                 shape=[10, 10],\r\n                                 dtype=tf.float32,\r\n                                 initializer=tf.contrib.layers.xavier_initializer())\r\n        bias = tf.get_variable(name='DummyBiasRel',\r\n                               shape=[1, 10],\r\n                               dtype=tf.float32,\r\n                               initializer=tf.zeros_initializer())\r\n\r\n        variables = {'weights': weight,\r\n                     'biases': bias}\r\n\r\n        return variables\r\n\r\n\r\n    def create_predictions(self, input_embs):\r\n        weight, bias = self.variables['weights'], self.variables['biases']\r\n        is_train_batch_norm = self.is_train\r\n\r\n        def matmul(pair):\r\n            input_tensor = pair[0][None]\r\n            projection_tensor = pair[1]\r\n            projection = tf.matmul(input_tensor, projection_tensor)[0]\r\n            return (projection, tf.zeros([]))\r\n\r\n        output = tf.reshape(input_embs, [tf.shape(input_embs)[0], -1])\r\n        # Next two lines cause problem\r\n        weight = tf.broadcast_to(weight, [256, 10, 10])\r\n        output = tf.map_fn(fn=matmul, elems=(output, weight))[0] + bias\r\n\r\n        output = tf.layers.batch_normalization(output, momentum=.1, reuse=tf.AUTO_REUSE,\r\n                                               training=is_train_batch_norm, fused=True,\r\n                                               name='DummyBatchNorm')\r\n\r\n        return output\r\n\r\n    def compute_likelihoods(self, input_vectors, actual_answers):\r\n        with tf.name_scope('output_layer'):\r\n\r\n            predictions = tf.matmul(input_vectors[:, None, :], actual_answers)[:, 0, :]\r\n\r\n        return predictions\r\n\r\n    def create_loss(self, predictions, targets):\r\n        with tf.name_scope('loss'):\r\n            loss = tf.reduce_sum(\r\n                tf.compat.v1.losses.sigmoid_cross_entropy(targets, predictions),\r\n                name='loss')\r\n        return loss\r\n\r\n\r\nif __name__ == '__main__':\r\n    # Create the model.\r\n    # Can be /GPU:0 for ubuntu\r\n    with tf.device('/CPU:0'):\r\n        # We are using resource variables because due to some implementation details, this allows us to\r\n        # better utilize GPUs while training.\r\n        with tf.variable_scope('variables', use_resource=True):\r\n\r\n            model = DummyModelRunner()\r\n\r\n    # Create a TensorFlow session and start training.\r\n    config = tf.ConfigProto(allow_soft_placement=True)\r\n    config.gpu_options.allow_growth = True\r\n    session = tf.Session(config=config)\r\n    saver = tf.train.Saver()\r\n\r\n    # Initialize the values of all variables and the train dataset iterator.\r\n    session.run(tf.global_variables_initializer())\r\n\r\n    for step in range(100):\r\n        # print('Hi!')\r\n        feed_dict = {model.is_train: True}\r\n\r\n        loss, _ = session.run((model.loss, model.train_op), feed_dict)\r\n\r\n        print(loss)\r\n        exit()\r\n```\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\nTraceback below (deprecation warning's excluded. Please let me know if I should include those as well):\r\nTraceback (most recent call last):\r\n  File \"/Users/georgestoica/Desktop/Research/venvs/rl_3.7/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1356, in _do_call\r\n    return fn(*args)\r\n  File \"/Users/georgestoica/Desktop/Research/venvs/rl_3.7/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1341, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"/Users/georgestoica/Desktop/Research/venvs/rl_3.7/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1429, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Retval[0] does not have value\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/georgestoica/Desktop/Research/new_exploration/src/qa_cpg/run_cpg_minimal.py\", line 111, in <module>\r\n    loss, _ = session.run((model.loss, model.train_op), feed_dict)\r\n  File \"/Users/georgestoica/Desktop/Research/venvs/rl_3.7/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 950, in run\r\n    run_metadata_ptr)\r\n  File \"/Users/georgestoica/Desktop/Research/venvs/rl_3.7/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1173, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/Users/georgestoica/Desktop/Research/venvs/rl_3.7/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1350, in _do_run\r\n    run_metadata)\r\n  File \"/Users/georgestoica/Desktop/Research/venvs/rl_3.7/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1370, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Retval[0] does not have value\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32712", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32712/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32712/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32712/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32712", "id": 496672474, "node_id": "MDU6SXNzdWU0OTY2NzI0NzQ=", "number": 32712, "title": "TPUStrategy.make_dataset_iterator does not work for a Dataset created by tf.data.Dataset.from_generator", "user": {"login": "tsc2017", "id": 27691661, "node_id": "MDQ6VXNlcjI3NjkxNjYx", "avatar_url": "https://avatars1.githubusercontent.com/u/27691661?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tsc2017", "html_url": "https://github.com/tsc2017", "followers_url": "https://api.github.com/users/tsc2017/followers", "following_url": "https://api.github.com/users/tsc2017/following{/other_user}", "gists_url": "https://api.github.com/users/tsc2017/gists{/gist_id}", "starred_url": "https://api.github.com/users/tsc2017/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tsc2017/subscriptions", "organizations_url": "https://api.github.com/users/tsc2017/orgs", "repos_url": "https://api.github.com/users/tsc2017/repos", "events_url": "https://api.github.com/users/tsc2017/events{/privacy}", "received_events_url": "https://api.github.com/users/tsc2017/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 1097541661, "node_id": "MDU6TGFiZWwxMDk3NTQxNjYx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tpus", "name": "comp:tpus", "color": "0052cc", "default": false, "description": "tpu, tpuestimator"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rxsang", "id": 6399870, "node_id": "MDQ6VXNlcjYzOTk4NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6399870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rxsang", "html_url": "https://github.com/rxsang", "followers_url": "https://api.github.com/users/rxsang/followers", "following_url": "https://api.github.com/users/rxsang/following{/other_user}", "gists_url": "https://api.github.com/users/rxsang/gists{/gist_id}", "starred_url": "https://api.github.com/users/rxsang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rxsang/subscriptions", "organizations_url": "https://api.github.com/users/rxsang/orgs", "repos_url": "https://api.github.com/users/rxsang/repos", "events_url": "https://api.github.com/users/rxsang/events{/privacy}", "received_events_url": "https://api.github.com/users/rxsang/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rxsang", "id": 6399870, "node_id": "MDQ6VXNlcjYzOTk4NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6399870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rxsang", "html_url": "https://github.com/rxsang", "followers_url": "https://api.github.com/users/rxsang/followers", "following_url": "https://api.github.com/users/rxsang/following{/other_user}", "gists_url": "https://api.github.com/users/rxsang/gists{/gist_id}", "starred_url": "https://api.github.com/users/rxsang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rxsang/subscriptions", "organizations_url": "https://api.github.com/users/rxsang/orgs", "repos_url": "https://api.github.com/users/rxsang/repos", "events_url": "https://api.github.com/users/rxsang/events{/privacy}", "received_events_url": "https://api.github.com/users/rxsang/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2019-09-21T16:10:51Z", "updated_at": "2020-02-18T21:44:56Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Colab default environment\r\n- TensorFlow installed from (source or binary): Colab  default\r\n- TensorFlow version (use command below): 1.14\r\n- Python version: Python 3\r\n\r\n**Describe the current behavior**\r\nI first create a Dataset with an iterator, then create a TPU iterator with the Dataset. After that, the iterator is used as the second input of `TPUStrategy.experimental_run`. As I run the output of `experimental_run`,  an error occurs:\r\n```\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _run_fn(feed_dict, fetch_list, target_list, options, run_metadata)\r\n   1340       return self._call_tf_sessionrun(\r\n-> 1341           options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1342 \r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _call_tf_sessionrun(self, options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1428         self._session, options, feed_dict, fetch_list, target_list,\r\n-> 1429         run_metadata)\r\n   1430 \r\n\r\nAbortedError: Session 5c40387f44056164 is not found.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nAbortedError                              Traceback (most recent call last)\r\n<ipython-input-7-b0bded0c272b> in <module>()\r\n     18     # Custom training loop\r\n     19     session.run(train_iterator_init)\r\n---> 20     session.run(dist_train)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in run(self, fetches, feed_dict, options, run_metadata)\r\n    948     try:\r\n    949       result = self._run(None, fetches, feed_dict, options_ptr,\r\n--> 950                          run_metadata_ptr)\r\n    951       if run_metadata:\r\n    952         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\r\n   1171     if final_fetches or final_targets or (handle and feed_dict_tensor):\r\n   1172       results = self._do_run(handle, final_targets, final_fetches,\r\n-> 1173                              feed_dict_tensor, options, run_metadata)\r\n   1174     else:\r\n   1175       results = []\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\r\n   1348     if handle is None:\r\n   1349       return self._do_call(_run_fn, feeds, fetches, targets, options,\r\n-> 1350                            run_metadata)\r\n   1351     else:\r\n   1352       return self._do_call(_prun_fn, handle, feeds, fetches)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _do_call(self, fn, *args)\r\n   1368           pass\r\n   1369       message = error_interpolation.interpolate(message, self._graph)\r\n-> 1370       raise type(e)(node_def, op, message)\r\n   1371 \r\n   1372   def _extend_graph(self):\r\n\r\nAbortedError: Session 5c40387f44056164 is not found.\r\n```\r\n**Describe the expected behavior**\r\nRun without error.\r\n**Code to reproduce the issue**\r\n```\r\nimport os\r\nimport pprint\r\nimport tensorflow as tf\r\nimport numpy as np\r\nresolver = tf.contrib.cluster_resolver.TPUClusterResolver('grpc://' + os.environ['COLAB_TPU_ADDR'])\r\ntf.contrib.distribute.initialize_tpu_system(resolver)\r\nstrategy = tf.contrib.distribute.TPUStrategy(resolver)\r\n\r\ndef my_generator():\r\n    for i in range(100):\r\n      x = np.random.rand(28,28).astype('float32')\r\n      y = np.zeros([], dtype='int32')\r\n      yield x,y\r\n\r\ndef train_fn(inputs):\r\n    return inputs[0]\r\n\r\nwith strategy.scope():\r\n  config = tf.ConfigProto()\r\n  config.allow_soft_placement = True\r\n  cluster_spec = resolver.cluster_spec()\r\n  if cluster_spec:\r\n    config.cluster_def.CopyFrom(cluster_spec.as_cluster_def())\r\n  print('Starting training...')\r\n  # Do all the computations inside a Session (as opposed to doing eager mode)\r\n  with tf.Session(target=resolver.master(), config=config) as session:  \r\n    #train_dataset = tf.data.Dataset.from_tensor_slices((x_train, y_train)).batch(8, drop_remainder=True)\r\n    train_dataset = tf.data.Dataset.from_generator(my_generator, ('float32', 'int32'), ([28,28], [])).batch(8, drop_remainder=True)\r\n    train_iterator = strategy.make_dataset_iterator(train_dataset)\r\n    train_iterator_init = train_iterator.initialize()\r\n    dist_train = strategy.experimental_run(train_fn, train_iterator).values\r\n\r\n    # Custom training loop\r\n    session.run(train_iterator_init)\r\n    session.run(dist_train)\r\n```\r\nThis snippet of code is a simplified version of  [this Colab notebook](https://colab.research.google.com/github/tensorflow/docs/blob/r2.0rc/site/en/tutorials/distribute/tpu_custom_training.ipynb).  The original `tf.data.Dataset.from_tensor_slices` works fine but  `tf.data.Dataset.from_generator` fails.\r\n\r\nAt the same time, I provide a [Colab notebook](https://colab.research.google.com/drive/1SNCAPKRcF_9XCSunRYvb6rGWkOcrweuN) for reproducing this issue.\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32697", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32697/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32697/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32697/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32697", "id": 496506720, "node_id": "MDU6SXNzdWU0OTY1MDY3MjA=", "number": 32697, "title": "In Windows, use of fit_generator and evaluate_generator result in \"builtins.TypeError: 'NoneType' object is not subscriptable\"", "user": {"login": "isaacgerg", "id": 11971499, "node_id": "MDQ6VXNlcjExOTcxNDk5", "avatar_url": "https://avatars0.githubusercontent.com/u/11971499?v=4", "gravatar_id": "", "url": "https://api.github.com/users/isaacgerg", "html_url": "https://github.com/isaacgerg", "followers_url": "https://api.github.com/users/isaacgerg/followers", "following_url": "https://api.github.com/users/isaacgerg/following{/other_user}", "gists_url": "https://api.github.com/users/isaacgerg/gists{/gist_id}", "starred_url": "https://api.github.com/users/isaacgerg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/isaacgerg/subscriptions", "organizations_url": "https://api.github.com/users/isaacgerg/orgs", "repos_url": "https://api.github.com/users/isaacgerg/repos", "events_url": "https://api.github.com/users/isaacgerg/events{/privacy}", "received_events_url": "https://api.github.com/users/isaacgerg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-09-20T19:14:54Z", "updated_at": "2019-09-30T06:23:07Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\nYes, provided lower in the post.\r\n\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\nWindows 7, Python 3.7, tensorflow 1.13.1\r\n\r\n- TensorFlow installed from (source or binary):\r\nvia pip\r\n\r\n- TensorFlow version (use command below): 1.13,1\r\n\r\n- Python version: 3.7\r\n- CUDA/cuDNN version: 10\r\n- GPU model and memory: RTX\r\n\r\n**Describe the current behavior**\r\nIn Windows, when run on a GPU, the provided code results in th following error:\r\n```\r\nFile \"c:\\python37\\Lib\\threading.py\", line 885, in _bootstrap\r\n  self._bootstrap_inner()\r\nFile \"c:\\python37\\Lib\\threading.py\", line 917, in _bootstrap_inner\r\n  self.run()\r\nFile \"c:\\python37\\Lib\\threading.py\", line 865, in run\r\n  self._target(*self._args, **self._kwargs)\r\nFile \"c:\\python37\\Lib\\multiprocessing\\pool.py\", line 121, in worker\r\n  result = (True, func(*args, **kwds))\r\nFile \"c:\\python37\\Lib\\site-packages\\tensorflow\\python\\keras\\utils\\data_utils.py\", line 445, in get_index\r\n  return _SHARED_SEQUENCES[uid][i]\r\n\r\nbuiltins.TypeError: 'NoneType' object is not subscriptable\r\n```\r\n\r\n**Describe the expected behavior**\r\nNo error\r\n\r\n**Code to reproduce the issue**\r\n```\r\n# system imports\r\nimport os\r\nimport random\r\n\r\n# lib imports\r\nimport matplotlib.pyplot as plt\r\nimport numpy as np\r\nimport scipy as sp\r\nimport cv2\r\nimport tensorflow as tf\r\nimport sklearn\r\nimport sklearn.metrics\r\nimport tqdm\r\nimport tensorflow as tf\r\nimport os\r\n\r\nimport matplotlib.pyplot as plt\r\n\r\nEPS = np.finfo(float).eps\r\n\r\n#=====================================================================================================================================================\r\n# Input parameters\r\n#-----------------------------------------------------------------------------------------------------------------------------------------------------\r\nbatchSize = 16\r\nimageSize = 335\r\ntileSize = 256\r\n\r\n#-----------------------------------------------------------------------------------------------------------------------------------------------------\r\ndef unet(numCoefs, input_size = (192,192,1), shrinkFactor = 1, name = ''):\r\n    inputs = tf.keras.layers.Input(input_size)\r\n    conv1 = tf.keras.layers.Conv2D(64//shrinkFactor, 3, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(inputs)\r\n    conv1 = tf.keras.layers.Conv2D(64//shrinkFactor, 3, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(conv1)\r\n    pool1 = tf.keras.layers.MaxPooling2D(pool_size=(2, 2), strides=(2,2))(conv1)\r\n    conv2 = tf.keras.layers.Conv2D(128//shrinkFactor, 3, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(pool1)\r\n    conv2 = tf.keras.layers.Conv2D(128//shrinkFactor, 3, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(conv2)\r\n    pool2 = tf.keras.layers.MaxPooling2D(pool_size=(2, 2), strides=(2,2))(conv2)    \r\n    conv3 = tf.keras.layers.Conv2D(256//shrinkFactor, 3, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(pool2)\r\n    conv3 = tf.keras.layers.Conv2D(256//shrinkFactor, 3, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(conv3)\r\n    pool3 = tf.keras.layers.MaxPooling2D(pool_size=(2, 2), strides=(2,2))(conv3)    \r\n    conv4 = tf.keras.layers.Conv2D(512//shrinkFactor, 3, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(pool3)\r\n    conv4 = tf.keras.layers.Conv2D(512//shrinkFactor, 3, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(conv4)\r\n    drop4 = tf.keras.layers.Dropout(0.0)(conv4)\r\n    pool4 = tf.keras.layers.MaxPooling2D(pool_size=(2, 2), strides=(2,2))(drop4)    \r\n\r\n    conv5 = tf.keras.layers.Conv2D(1024//shrinkFactor, 3, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(pool4)\r\n    conv5 = tf.keras.layers.Conv2D(1024//shrinkFactor, 3, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal', name='code_'+name)(conv5)\r\n    drop5 = tf.keras.layers.Dropout(0.0)(conv5)\r\n    \r\n    up6 = tf.keras.layers.Conv2D(512//shrinkFactor, 2, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(tf.keras.layers.UpSampling2D(size = (2,2), interpolation='bilinear')(drop5))\r\n    merge6 = tf.keras.layers.concatenate([drop4,up6], axis = 3)\r\n    conv6 = tf.keras.layers.Conv2D(512//shrinkFactor, 3, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(merge6)\r\n    conv6 = tf.keras.layers.Conv2D(512//shrinkFactor, 3, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(conv6)\r\n\r\n    up7 = tf.keras.layers.Conv2D(192//shrinkFactor, 2, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(tf.keras.layers.UpSampling2D(size = (2,2), interpolation='bilinear')(conv6))\r\n    merge7 = tf.keras.layers.concatenate([conv3,up7], axis = 3)\r\n    conv7 = tf.keras.layers.Conv2D(192//shrinkFactor, 3, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(merge7)\r\n    conv7 = tf.keras.layers.Conv2D(192//shrinkFactor, 3, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(conv7)\r\n\r\n    up8 = tf.keras.layers.Conv2D(128//shrinkFactor, 2, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(tf.keras.layers.UpSampling2D(size = (2,2), interpolation='bilinear')(conv7))\r\n    merge8 = tf.keras.layers.concatenate([conv2,up8], axis = 3)\r\n    conv8 = tf.keras.layers.Conv2D(128//shrinkFactor, 3, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(merge8)\r\n    conv8 = tf.keras.layers.Conv2D(128//shrinkFactor, 3, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(conv8)\r\n\r\n    up9 = tf.keras.layers.Conv2D(64//shrinkFactor, 2, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(tf.keras.layers.UpSampling2D(size = (2,2), interpolation='bilinear')(conv8))\r\n    merge9 = tf.keras.layers.concatenate([conv1,up9], axis = 3)\r\n    conv9 = tf.keras.layers.Conv2D(64//shrinkFactor, 3, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(merge9)\r\n    conv9 = tf.keras.layers.Conv2D(64//shrinkFactor, 3, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(conv9)\r\n    conv9 = tf.keras.layers.Conv2D(2, 3, activation = 'relu', padding = 'same', kernel_initializer = 'he_normal')(conv9)\r\n    conv10 = tf.keras.layers.Conv2D(1, 1, activation = 'relu')(conv9)\r\n    \r\n    r = tf.keras.layers.Lambda(lambda x: (x - tf.keras.backend.min(x)) / (tf.keras.backend.max(x) - tf.keras.backend.min(x)), name = 'reconstruction_'+name)(conv10)\r\n\r\n    model = tf.keras.models.Model(inputs, r)\r\n    \r\n    return model\r\n#-----------------------------------------------------------------------------------------------------------------------------------------------------\r\ndef buildModel():           \r\n    numCoefs = 3\r\n    reconstruction = unet(numCoefs, input_size=(256,256,1), shrinkFactor=4)\r\n    model = tf.keras.models.Model(reconstruction.inputs[0], reconstruction.outputs[0])\r\n        \r\n    return model\r\n#-----------------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\n#=====================================================================================================================================================\r\n# Define and create generators\r\n#-----------------------------------------------------------------------------------------------------------------------------------------------------\r\nclass TrainGenerator(tf.keras.utils.Sequence):\r\n    #-------------------------------------------------------------------------------------------------------------------------------------------------\r\n    def __init__(self, batchSize, tileSize, imageSize):        \r\n        self._batchSize = batchSize\r\n        self._imageSize = imageSize\r\n        self._tileSize = tileSize\r\n        self._numFiles = 1000\r\n        return\r\n    #\r\n    #-------------------------------------------------------------------------------------------------------------------------------------------------\r\n    def next(self):\r\n        return self.__getitem__(0)\r\n    #-------------------------------------------------------------------------------------------------------------------------------------------------\r\n    def __getitem__(self, idx):\r\n        # idx intentionally not used\r\n        return self._next()\r\n    #\r\n    #-------------------------------------------------------------------------------------------------------------------------------------------------\r\n    # Returns number of steps/iterations to perform to go through all the data once\r\n    def getStepsPerEpoch(self):\r\n        return self._numFiles // self._batchSize \r\n    #-------------------------------------------------------------------------------------------------------------------------------------------------\r\n    def __len__(self):\r\n        return self.getStepsPerEpoch()\r\n    #\r\n    #-------------------------------------------------------------------------------------------------------------------------------------------------\r\n    # Returns a batch of data.    \r\n    def _next(self):         \r\n        xRaw = np.zeros((self._batchSize, self._imageSize, self._imageSize, 1), dtype='complex64')\r\n        # Prep for net input\r\n        x = np.zeros((self._batchSize, self._tileSize, self._tileSize, 1), dtype='float32')\r\n        xSlc = np.zeros((self._batchSize, self._tileSize, self._tileSize, 1), dtype='complex64')\r\n        xDefocus = np.zeros((self._batchSize, self._tileSize, self._tileSize, 1), dtype='float32')\r\n        y = np.zeros(self._batchSize)        \r\n                \r\n        for k in range(self._batchSize):\r\n            y[k] = 1\r\n        #              \r\n        \r\n        # More augmentation\r\n        for k in range(self._batchSize):                   \r\n            # Random Crops\r\n            crop = self._imageSize - self._tileSize            \r\n            startX = np.random.randint(crop)\r\n            startY = np.random.randint(crop)\r\n            slc = xRaw[k, startX:startX + self._tileSize, startY:startY + self._tileSize, 0]     \r\n            x[k, :,:, 0] = 0                \r\n        #\r\n\r\n        return xDefocus, x\r\n    #-------------------------------------------------------------------------------------------------------------------------------------------------\r\n#-----------------------------------------------------------------------------------------------------------------------------------------------------\r\nclass TestGenerator(tf.keras.utils.Sequence):\r\n    #-------------------------------------------------------------------------------------------------------------------------------------------------\r\n    def __init__(self, batchSize, tileSize = 256, imageSize = 335):        \r\n        self._batchSize = batchSize\r\n        self._tileSize = tileSize\r\n        self._imageSize = imageSize       \r\n        self._numFiles = 5000\r\n        return\r\n    #-------------------------------------------------------------------------------------------------------------------------------------------------    \r\n    def __len__(self):\r\n        return self.getStepsPerEpoch()    \r\n    #-------------------------------------------------------------------------------------------------------------------------------------------------\r\n    # Returns number of steps/iterations to perform to go through all the data once\r\n    def getStepsPerEpoch(self):\r\n        return self._numFiles // self._batchSize\r\n    #\r\n    #-------------------------------------------------------------------------------------------------------------------------------------------------\r\n    def __getitem__(self, idx):        \r\n        return self.next(idx)\r\n    #    \r\n    #-------------------------------------------------------------------------------------------------------------------------------------------------\r\n    # Returns batch sized used to iniitalize\r\n    def getBatchSize(self):\r\n        return self._batchSize    \r\n    #-------------------------------------------------------------------------------------------------------------------------------------------------\r\n    # Returns a batch of data.\r\n    def next(self, batch_id):\r\n        xs = np.zeros((self._batchSize, self._tileSize , self._tileSize , 1), dtype='float32')\r\n        xSlc = np.zeros((self._batchSize, self._tileSize , self._tileSize , 1), dtype='complex64')\r\n        ys = np.zeros(self._batchSize)\r\n        xsOrig = np.zeros((self._batchSize, self._tileSize , self._tileSize , 1), dtype='float32')                   \r\n\r\n        masterOffset = (self._imageSize -self._tileSize )//2\r\n        center = [self._imageSize //2, self._imageSize //2]\r\n        for k in range(self._batchSize):            \r\n            tile = np.zeros((335,335))\r\n            \r\n            # Center  Crops\r\n            crop = self._imageSize  - self._tileSize             \r\n            startX = crop//2\r\n            startY = crop//2\r\n            slc = tile[startX:startX + self._tileSize , startY:startY + self._tileSize]                                     \r\n\r\n            # Label\r\n            ys[k] = 1\r\n            \r\n        #\r\n        \r\n        return xs, xsOrig\r\n    #-------------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\n#-----------------------------------------------------------------------------------------------------------------------------------------------------\r\ndef main():\r\n   \r\n    #-----------------------------------------------------------------------------------------------------------------------------------------------------\r\n    # So many random seeds\r\n    random.seed(1)\r\n    np.random.seed(1)\r\n    tf.random.set_random_seed(1)\r\n    \r\n    #=====================================================================================================================================================\r\n    # Create output folder of model\r\n    #-----------------------------------------------------------------------------------------------------------------------------------------------------          \r\n    # Create our two generators\r\n    trainGenerator = TrainGenerator(batchSize, 256, 335)    \r\n    testGenerator = TestGenerator(batchSize, 256, 335)\r\n        \r\n    #-----------------------------------------------------------------------------------------------------------------------------------------------------\r\n    # Build model\r\n    model = buildModel()\r\n    model.summary()\r\n    \r\n    #-----------------------------------------------------------------------------------------------------------------------------------------------------\r\n    # Log the model traincompileing parameters\r\n    stepsPerEpochTrain = int(trainGenerator.getStepsPerEpoch())\r\n    stepsPerEpochTest = testGenerator.getStepsPerEpoch()\r\n    print('=== Fitting Model ===')\r\n    print(' Batch size:                  {0}'.format(batchSize))\r\n    print(' Steps per training epoch:    {0}'.format(stepsPerEpochTrain))    \r\n    print(' Steps per testing epoch:     {0}'.format(stepsPerEpochTest))\r\n    #-----------------------------------------------------------------------------------------------------------------------------------------------------\r\n    \r\n    #=====================================================================================================================================================\r\n    # Begin training            \r\n    model.compile(optimizer = tf.keras.optimizers.RMSprop(lr=1e-3), loss = 'mse')    \r\n    \r\n    for epoch in range(0,9999):\r\n        print('========== Epoch {0} =========='.format(epoch))\r\n        \r\n        #-------------------------------------------------------------------------------------------------------------------------------------------------\r\n        # Train the model\r\n        history = model.fit_generator(trainGenerator, workers=5)         \r\n        trainError = history.history['loss'][0]\r\n    \r\n        #-------------------------------------------------------------------------------------------------------------------------------------------------  \r\n        # Dump out mosaic from a batch\r\n        x,y = testGenerator.next(1)\r\n               \r\n        #-------------------------------------------------------------------------------------------------------------------------------------------------\r\n        # Test the model    \r\n        r = model.evaluate_generator(trainGenerator, workers=5, verbose=1)  # idg Leaving this here for postarity. maybe keras will work someday.\r\n\r\n        # Compute test loss\r\n        test_err = np.mean(r)    \r\n    # end training epoch\r\n    return\r\n#-----------------------------------------------------------------------------------------------------------------------------------------------------\r\n  \r\nif __name__== \"__main__\":\r\n    main()\r\n\r\n    print('done')\r\n```\r\n\r\nThis code will spit out Nan's but that is okay.  Its just to address the point.  In windows, the error you will get after the first epoch is:\r\n```\r\nFile \"c:\\python37\\Lib\\threading.py\", line 885, in _bootstrap\r\n  self._bootstrap_inner()\r\nFile \"c:\\python37\\Lib\\threading.py\", line 917, in _bootstrap_inner\r\n  self.run()\r\nFile \"c:\\python37\\Lib\\threading.py\", line 865, in run\r\n  self._target(*self._args, **self._kwargs)\r\nFile \"c:\\python37\\Lib\\multiprocessing\\pool.py\", line 121, in worker\r\n  result = (True, func(*args, **kwds))\r\nFile \"c:\\python37\\Lib\\site-packages\\tensorflow\\python\\keras\\utils\\data_utils.py\", line 445, in get_index\r\n  return _SHARED_SEQUENCES[uid][i]\r\n\r\nbuiltins.TypeError: 'NoneType' object is not subscriptable\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32696", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32696/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32696/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32696/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32696", "id": 496506066, "node_id": "MDU6SXNzdWU0OTY1MDYwNjY=", "number": 32696, "title": "[TF1.14] Network compiles localy but not on TPU with error 'InvalidArgumentError: Undeclared output of TPU computation.'", "user": {"login": "nsantavas", "id": 37878833, "node_id": "MDQ6VXNlcjM3ODc4ODMz", "avatar_url": "https://avatars2.githubusercontent.com/u/37878833?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nsantavas", "html_url": "https://github.com/nsantavas", "followers_url": "https://api.github.com/users/nsantavas/followers", "following_url": "https://api.github.com/users/nsantavas/following{/other_user}", "gists_url": "https://api.github.com/users/nsantavas/gists{/gist_id}", "starred_url": "https://api.github.com/users/nsantavas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nsantavas/subscriptions", "organizations_url": "https://api.github.com/users/nsantavas/orgs", "repos_url": "https://api.github.com/users/nsantavas/repos", "events_url": "https://api.github.com/users/nsantavas/events{/privacy}", "received_events_url": "https://api.github.com/users/nsantavas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-09-20T19:13:10Z", "updated_at": "2019-10-03T21:48:46Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Custom\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Debian\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 1.14\r\n- Python version: 3\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory: TPU \r\n\r\nI created a DenseNet, which I succesfully compile it locally with GPU, but when I try to compile on  a TPU device, the following error appears\r\n```\r\nTraceback (most recent call last):\r\n  File \"attention_dense.py\", line 258, in <module>\r\n    model.fit(get_training_dataset(), validation_data=get_validation_dataset(),  initial_epoch=0, steps_per_epoch=steps_per_epoch ,validation_steps=val_steps, epochs=EPOCHS, verbose=1, callbacks=clbk)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/engine/training.py\", line 649, in fit\r\n    validation_freq=validation_freq)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/engine/training_distributed.py\", line 128, in fit_distributed\r\n    validation_freq=validation_freq)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/engine/training_distributed.py\", line 395, in experimental_tpu_fit_loop\r\n    callbacks._call_begin_hook(mode)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/callbacks.py\", line 262, in _call_begin_hook\r\n    self.on_train_begin()\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/callbacks.py\", line 378, in on_train_begin\r\n    callback.on_train_begin(logs)\r\n  File \"/home/frank_lab/clr.py\", line 122, in on_train_begin\r\n    K.set_value(self.model.optimizer.lr, self.base_lr)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/backend.py\", line 3038, in set_value\r\n    get_session().run(assign_op, feed_dict={assign_placeholder: value})\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/backend.py\", line 462, in get_session\r\n    _initialize_variables(session)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/keras/backend.py\", line 879, in _initialize_variables\r\n    [variables_module.is_variable_initialized(v) for v in candidate_vars])\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 950, in run\r\n    run_metadata_ptr)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1173, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1350, in _do_run\r\n    run_metadata)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/client/session.py\", line 1370, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Undeclared output of TPU computation. A common cause of this error is variable initializers that depend on the TPU computation. Edge: node dense_1_2/re_lu_1/Relu (defined at attention_dense.py:258) :0 -> node tf_op_layer_add/add (defined at attention_dense.py:258) :0\r\n```\r\nThe code is the following\r\n\r\n```\r\ndef conv(input, kernel, filt, stride, dilation, pad='same'):\r\n    x = layers.Conv2D(filters=filt, kernel_size=kernel, strides=stride, dilation_rate=dilation, padding=pad, kernel_regularizer=tf.keras.regularizers.l2(l=0.01))(input)\r\n    return x\r\n\r\ndef conv_down(input, filters):\r\n    x = conv(input, 3, filters, 2 ,1)\r\n    x = layers.BatchNormalization(axis=-1, fused=True)(x)\r\n    x = layers.LeakyReLU(alpha=0.1)(x) \r\n    return x\r\n\r\ndef conv_block(input, filters, stride=1, dilation=2, pad='same', bottleneck=True):\r\n    x = layers.BatchNormalization(axis=-1, fused=True)(input)\r\n    x = layers.LeakyReLU(alpha=0.1)(x) \r\n    if bottleneck:\r\n        x = conv(x, kernel=1, filt=(filters*4), dilation=dilation, stride=1, pad=pad)\r\n        x = layers.BatchNormalization(axis=-1, fused=True)(x)\r\n        x = layers.LeakyReLU(alpha=0.1)(x) \r\n    x = conv(x, kernel=3, filt=filters, stride=stride, dilation=dilation, pad=pad)\r\n    return x\r\n\r\ndef dense_block(x, filters, layers, bottleneck=True):\r\n    x_list = [x]\r\n    for i in range(layers):\r\n        cb = conv_block(x, filters, dilation=2, bottleneck=True)\r\n        x_list.append(cb)\r\n        x = tf.keras.layers.concatenate([x, cb], axis=-1)\r\n        x = attention(x)\r\n    return x\r\n\r\ndef transition_block(input, filters, att=True):\r\n    x = layers.BatchNormalization(axis=-1, fused=True)(input)\r\n    x = layers.LeakyReLU(alpha=0.1)(x) \r\n    x = conv(x, kernel=1, filt=filters, stride=1, dilation=2, pad='same')\r\n    x = layers.AveragePooling2D((2,2), strides=(2,2))(x)\r\n    if att:\r\n        x = attention(x)\r\n    return x\r\n    \r\ndef attention(input):\r\n    x = channel_att(input)\r\n    x = spatial_att(x)\r\n    return x\r\n    \r\ndef channel_att(input, ratio=8):\r\n    channel = input.get_shape()[-1]\r\n    ####\r\n    avg_pool = tf.keras.layers.GlobalAveragePooling2D()(input)\r\n    avg_pool = tf.keras.layers.Reshape((1,1,channel))(avg_pool)\r\n    max_pool = tf.keras.layers.GlobalMaxPooling2D()(input)\r\n    max_pool = tf.keras.layers.Reshape((1,1,channel))(max_pool)\r\n    ####\r\n    mlp_0 = layers.Dense(units=channel//ratio, activation=layers.ReLU())\r\n    mlp_1 = layers.Dense(units=channel, activation=layers.ReLU())\r\n    avg_ = mlp_1(mlp_0(avg_pool))\r\n    max_ = mlp_1(mlp_0(max_pool))\r\n    scale = keras.activations.sigmoid(avg_+max_)\r\n    return input*scale\r\n\r\ndef spatial_att(input, kernel=7):\r\n    avg_pool = tf.math.reduce_mean(input, axis=[3], keepdims=True)\r\n    max_pool = tf.math.reduce_max(input, axis=[3], keepdims=True)\r\n    concat = tf.concat([avg_pool, max_pool], axis=3)\r\n    concat = layers.Conv2D(filters=1, kernel_size=kernel, padding='same',use_bias=False)(concat)\r\n    concat = keras.activations.sigmoid(concat)\r\n    return input*concat\r\n\r\n\r\ndef create_model():\r\n    Input = layers.Input(shape=(540, 540, 3))\r\n    x = conv(Input, kernel=3, filt=64, stride=1, dilation=2)\r\n    for i in range(8):\r\n        x = dense_block(x, filters=128, layers=3, bottleneck=True)\r\n        x = transition_block(x, filters=128, att=True)\r\n    x = dense_block(x, filters=128, layers=4, bottleneck=True)\r\n    x = layers.BatchNormalization(axis=-1, fused=True)(x)\r\n    x = conv(x, kernel=1, filt=45, stride=1, dilation=1)\r\n    model = tf.keras.Model(inputs=Input, outputs=x)\r\n    model.compile(optimizer=keras.optimizers.SGD(), loss=custom_loss)\r\n    return model\r\n\r\nwith tpu_strategy.scope():\r\n    model=create_model()\r\n\r\nmodel.fit(get_training_dataset(), validation_data=get_validation_dataset(),  initial_epoch=0, steps_per_epoch=steps_per_epoch ,validation_steps=val_steps, epochs=EPOCHS, verbose=1, callbacks=clbk)\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32691", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32691/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32691/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32691/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32691", "id": 496433654, "node_id": "MDU6SXNzdWU0OTY0MzM2NTQ=", "number": 32691, "title": "TF 1.14.0 training crashes with unimplemented Conv2D errors (works fine in TF 1.13.2)", "user": {"login": "mschonwe", "id": 101855, "node_id": "MDQ6VXNlcjEwMTg1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/101855?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mschonwe", "html_url": "https://github.com/mschonwe", "followers_url": "https://api.github.com/users/mschonwe/followers", "following_url": "https://api.github.com/users/mschonwe/following{/other_user}", "gists_url": "https://api.github.com/users/mschonwe/gists{/gist_id}", "starred_url": "https://api.github.com/users/mschonwe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mschonwe/subscriptions", "organizations_url": "https://api.github.com/users/mschonwe/orgs", "repos_url": "https://api.github.com/users/mschonwe/repos", "events_url": "https://api.github.com/users/mschonwe/events{/privacy}", "received_events_url": "https://api.github.com/users/mschonwe/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "reedwm", "id": 6510203, "node_id": "MDQ6VXNlcjY1MTAyMDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6510203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedwm", "html_url": "https://github.com/reedwm", "followers_url": "https://api.github.com/users/reedwm/followers", "following_url": "https://api.github.com/users/reedwm/following{/other_user}", "gists_url": "https://api.github.com/users/reedwm/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedwm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedwm/subscriptions", "organizations_url": "https://api.github.com/users/reedwm/orgs", "repos_url": "https://api.github.com/users/reedwm/repos", "events_url": "https://api.github.com/users/reedwm/events{/privacy}", "received_events_url": "https://api.github.com/users/reedwm/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "reedwm", "id": 6510203, "node_id": "MDQ6VXNlcjY1MTAyMDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6510203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedwm", "html_url": "https://github.com/reedwm", "followers_url": "https://api.github.com/users/reedwm/followers", "following_url": "https://api.github.com/users/reedwm/following{/other_user}", "gists_url": "https://api.github.com/users/reedwm/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedwm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedwm/subscriptions", "organizations_url": "https://api.github.com/users/reedwm/orgs", "repos_url": "https://api.github.com/users/reedwm/repos", "events_url": "https://api.github.com/users/reedwm/events{/privacy}", "received_events_url": "https://api.github.com/users/reedwm/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 14, "created_at": "2019-09-20T16:06:43Z", "updated_at": "2020-01-03T11:56:43Z", "closed_at": null, "author_association": "NONE", "body": "**Environment**\r\n- Ubuntu 16.04:\r\n- Docker based tensorflow/tensorflow:1.14.0-gpu\r\n- tensor2tensor==1.14.0 (pip installed in container)\r\n- Python 2.7\r\n- CUDA/cuDNN version: 10/7 (defaults from docker image)\r\n- GPUs (tested on many from 1080 to RTX Titan)\r\n\r\n**Issue**\r\nChange in Tensorflow has broken tensor2tensor librispeech training.\r\n\r\nRunning librispeech training crashes with Unimplemented Conv2D errors.\r\n```\r\n  (0) Unimplemented:  The Conv2D op currently only supports the NHWC tensor format on the CPU. The op was given the format: NCHW\r\n         [[{{node Conv2D}}]]\r\n  (1) Unimplemented:  The Conv2D op currently only supports the NHWC tensor format on the CPU. The op was given the format: NCHW\r\n         [[{{node Conv2D}}]]\r\n         [[Shape_3/_8]]\r\n```\r\n\r\n**Expected behavior**\r\nThis works fine in earlier versions of Tensorflow (e.g. 1.13.2).\r\n\r\n**Code to reproduce the issue**\r\nVia Nvidia Docker Hub\r\nrun tensorflow/tensorflow:1.14.0-gpu\r\npip install tensorflow-hub && pip install tensor2tensor\r\napt-get update && apt-get install sox\r\n`t2t-trainer --problem=librispeech_clean_small --model=transformer --output_dir=/models/JUNK --data_dir=/data/ --save_checkpoints_secs=1800 --schedule=train --hparams_set=transformer_librispeech`\r\n(note: sox and --generate are only needed once, to prep the dataset)\r\n\r\n**Other info / logs**\r\nRelated to closed issue #32017."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32687", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32687/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32687/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32687/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32687", "id": 496263751, "node_id": "MDU6SXNzdWU0OTYyNjM3NTE=", "number": 32687, "title": "CocoaPods could not find compatible version for pod 'TensorFlowLiteSwift'- with iOS 8 deployment target", "user": {"login": "parascse", "id": 13555198, "node_id": "MDQ6VXNlcjEzNTU1MTk4", "avatar_url": "https://avatars0.githubusercontent.com/u/13555198?v=4", "gravatar_id": "", "url": "https://api.github.com/users/parascse", "html_url": "https://github.com/parascse", "followers_url": "https://api.github.com/users/parascse/followers", "following_url": "https://api.github.com/users/parascse/following{/other_user}", "gists_url": "https://api.github.com/users/parascse/gists{/gist_id}", "starred_url": "https://api.github.com/users/parascse/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/parascse/subscriptions", "organizations_url": "https://api.github.com/users/parascse/orgs", "repos_url": "https://api.github.com/users/parascse/repos", "events_url": "https://api.github.com/users/parascse/events{/privacy}", "received_events_url": "https://api.github.com/users/parascse/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "yyoon", "id": 1309817, "node_id": "MDQ6VXNlcjEzMDk4MTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1309817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yyoon", "html_url": "https://github.com/yyoon", "followers_url": "https://api.github.com/users/yyoon/followers", "following_url": "https://api.github.com/users/yyoon/following{/other_user}", "gists_url": "https://api.github.com/users/yyoon/gists{/gist_id}", "starred_url": "https://api.github.com/users/yyoon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yyoon/subscriptions", "organizations_url": "https://api.github.com/users/yyoon/orgs", "repos_url": "https://api.github.com/users/yyoon/repos", "events_url": "https://api.github.com/users/yyoon/events{/privacy}", "received_events_url": "https://api.github.com/users/yyoon/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "yyoon", "id": 1309817, "node_id": "MDQ6VXNlcjEzMDk4MTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1309817?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yyoon", "html_url": "https://github.com/yyoon", "followers_url": "https://api.github.com/users/yyoon/followers", "following_url": "https://api.github.com/users/yyoon/following{/other_user}", "gists_url": "https://api.github.com/users/yyoon/gists{/gist_id}", "starred_url": "https://api.github.com/users/yyoon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yyoon/subscriptions", "organizations_url": "https://api.github.com/users/yyoon/orgs", "repos_url": "https://api.github.com/users/yyoon/repos", "events_url": "https://api.github.com/users/yyoon/events{/privacy}", "received_events_url": "https://api.github.com/users/yyoon/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-09-20T10:02:48Z", "updated_at": "2020-03-06T04:04:43Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary):\r\n- TensorFlow version:\r\n- Python version:\r\n- Installed using virtualenv? pip? conda?:\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\n\r\n\r\n**Describe the problem**\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32684", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32684/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32684/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32684/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32684", "id": 496228673, "node_id": "MDU6SXNzdWU0OTYyMjg2NzM=", "number": 32684, "title": "Arguments formatting error in 1.15 keras.model.save docs + incorrect model format info/docstring mismatch?", "user": {"login": "jubjamie", "id": 25011496, "node_id": "MDQ6VXNlcjI1MDExNDk2", "avatar_url": "https://avatars3.githubusercontent.com/u/25011496?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jubjamie", "html_url": "https://github.com/jubjamie", "followers_url": "https://api.github.com/users/jubjamie/followers", "following_url": "https://api.github.com/users/jubjamie/following{/other_user}", "gists_url": "https://api.github.com/users/jubjamie/gists{/gist_id}", "starred_url": "https://api.github.com/users/jubjamie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jubjamie/subscriptions", "organizations_url": "https://api.github.com/users/jubjamie/orgs", "repos_url": "https://api.github.com/users/jubjamie/repos", "events_url": "https://api.github.com/users/jubjamie/events{/privacy}", "received_events_url": "https://api.github.com/users/jubjamie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "lamberta", "id": 43051, "node_id": "MDQ6VXNlcjQzMDUx", "avatar_url": "https://avatars2.githubusercontent.com/u/43051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lamberta", "html_url": "https://github.com/lamberta", "followers_url": "https://api.github.com/users/lamberta/followers", "following_url": "https://api.github.com/users/lamberta/following{/other_user}", "gists_url": "https://api.github.com/users/lamberta/gists{/gist_id}", "starred_url": "https://api.github.com/users/lamberta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lamberta/subscriptions", "organizations_url": "https://api.github.com/users/lamberta/orgs", "repos_url": "https://api.github.com/users/lamberta/repos", "events_url": "https://api.github.com/users/lamberta/events{/privacy}", "received_events_url": "https://api.github.com/users/lamberta/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "lamberta", "id": 43051, "node_id": "MDQ6VXNlcjQzMDUx", "avatar_url": "https://avatars2.githubusercontent.com/u/43051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lamberta", "html_url": "https://github.com/lamberta", "followers_url": "https://api.github.com/users/lamberta/followers", "following_url": "https://api.github.com/users/lamberta/following{/other_user}", "gists_url": "https://api.github.com/users/lamberta/gists{/gist_id}", "starred_url": "https://api.github.com/users/lamberta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lamberta/subscriptions", "organizations_url": "https://api.github.com/users/lamberta/orgs", "repos_url": "https://api.github.com/users/lamberta/repos", "events_url": "https://api.github.com/users/lamberta/events{/privacy}", "received_events_url": "https://api.github.com/users/lamberta/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-09-20T08:50:31Z", "updated_at": "2019-09-27T20:18:28Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "## URL(s) with the issue: https://www.tensorflow.org/versions/r1.15/api_docs/python/tf/keras/Model#save\r\n\r\n## Description of issue (what needs changing):\r\n[1.15 branch]\r\nIt appears that the docstring of keras.model.save does not match the docs in 1.15.\r\n\r\nContent is different I think.\r\n\r\nThe bullet points for the input arguments for the save method are not formatted making it hard to read (although this may be poor formatting on the current source for the documentation as the docstring appears to be correctly formatted.).\r\n\r\nA side effect of this is that it also appears that the docs conflicts with the release notes that say the default format is as a `Tensorflow SavedModel ('tf')` however the docs say that the `tf` option is disabled implying that only `.h5` formats can be saved which is contradictory. An update of the docs from the seemingly correct docstring may fix this.\r\n\r\n### Correct links\r\n\r\nThe source code link appears to be correct despite the docstring not matching that of the website docs.\r\n\r\n### Parameters defined\r\n\r\nFormatting issue and also not updated.\r\n\r\n### Returns defined\r\n\r\nDepends on model format.\r\n\r\n### Raises listed and defined\r\n\r\nDepends on model format.\r\n\r\n### Submit a pull request?\r\n\r\nI don't quite understand why this has happened so no.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32675", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32675/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32675/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32675/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32675", "id": 496060391, "node_id": "MDU6SXNzdWU0OTYwNjAzOTE=", "number": 32675, "title": "Equivalent of Torch EmbeddingBag", "user": {"login": "Enumaris", "id": 34777557, "node_id": "MDQ6VXNlcjM0Nzc3NTU3", "avatar_url": "https://avatars3.githubusercontent.com/u/34777557?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Enumaris", "html_url": "https://github.com/Enumaris", "followers_url": "https://api.github.com/users/Enumaris/followers", "following_url": "https://api.github.com/users/Enumaris/following{/other_user}", "gists_url": "https://api.github.com/users/Enumaris/gists{/gist_id}", "starred_url": "https://api.github.com/users/Enumaris/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Enumaris/subscriptions", "organizations_url": "https://api.github.com/users/Enumaris/orgs", "repos_url": "https://api.github.com/users/Enumaris/repos", "events_url": "https://api.github.com/users/Enumaris/events{/privacy}", "received_events_url": "https://api.github.com/users/Enumaris/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-09-19T22:46:35Z", "updated_at": "2019-09-26T18:01:49Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): 1.14\r\n- Are you willing to contribute it (Yes/No): No\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nCurrently Tensorflow has only tf.nn.embedding_lookup (which, I believe in the backend uses a tf.gather operation). Torch has a torch.nn.EmbeddingBag class which gathers and combines embeddings in specified ways. It allows for a weighted summation of embeddings which they say is much more efficient than getting the embeddings, multiplying (broadcasting) a set of weights across them, and then reduce-summing them. \r\n\r\nI am trying to implement product-key memory layers (https://arxiv.org/pdf/1907.05242.pdf) in tensorflow but they are running very slowly for me - roughly 50% slower than an equivalent BERT-Base sized model without product-key memory layers. Looking at the debugging results, I find that the operations of tf.nn.embedding_lookup, the broadcasted multiplication between scores and values, and the tf.math.reduce_sum operation are taking up a lot of time. A more efficient implementation that performs these operations in one go should reduce the time it takes to run these layers. All product-key memory layers which have a weighted summation of some memory values should benefit from this optimization. \r\n\r\nFor a concrete example pseudocode in tensorflow I have to do these operations:\r\n\r\nquery = tf.Tensor()\r\nkey = tf.Tensor()\r\nvalues = tf.get_variable()\r\nscores, indices = get_scores_and_indices(query,key)\r\nattended_values = tf.nn.embedding_lookup(values,indices)\r\noutput = tf.math.reduce_sum(scores*attended_values)  \r\n\r\nOn torch, you could do\r\nquery = torch.Tensor()\r\nkey = torch.Tensor()\r\nvalues = torch.nn.EmbeddingBag()\r\nscores, indices = get_scores_and_indices(query,key)\r\noutput = values(indices, per_sample_weights=scores)\r\n\r\nTorch claims that using an EmbeddingBag is much more efficient than using a simple Embedding+weighted sum operation. And this does indeed appear to be the case. \r\n \r\n**Will this change the current api? How?**\r\nIt will add new functionality in a tf.nn.embedding_bag_lookup() method\r\n\r\n**Who will benefit with this feature?**\r\nAnybody who wants to implement query-key memory layers based on values saved in embeddings. \r\n\r\n**Any Other info.**\r\nThe closest thing I could find to this was tf.nn.embedding_lookup_sparse, but that method requires the indices and scores to be sparse tensors and then just uses a tf.nn.embedding_lookup with some broadcast multiplication and reduce_sum in the backend anyhow. "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32674", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32674/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32674/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32674/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32674", "id": 496048761, "node_id": "MDU6SXNzdWU0OTYwNDg3NjE=", "number": 32674, "title": "Tensorflow Java API and @tf.function signatures", "user": {"login": "bqm", "id": 2635923, "node_id": "MDQ6VXNlcjI2MzU5MjM=", "avatar_url": "https://avatars0.githubusercontent.com/u/2635923?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bqm", "html_url": "https://github.com/bqm", "followers_url": "https://api.github.com/users/bqm/followers", "following_url": "https://api.github.com/users/bqm/following{/other_user}", "gists_url": "https://api.github.com/users/bqm/gists{/gist_id}", "starred_url": "https://api.github.com/users/bqm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bqm/subscriptions", "organizations_url": "https://api.github.com/users/bqm/orgs", "repos_url": "https://api.github.com/users/bqm/repos", "events_url": "https://api.github.com/users/bqm/events{/privacy}", "received_events_url": "https://api.github.com/users/bqm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 1351587946, "node_id": "MDU6TGFiZWwxMzUxNTg3OTQ2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/java", "name": "java", "color": "095372", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sjamesr", "id": 4641539, "node_id": "MDQ6VXNlcjQ2NDE1Mzk=", "avatar_url": "https://avatars0.githubusercontent.com/u/4641539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sjamesr", "html_url": "https://github.com/sjamesr", "followers_url": "https://api.github.com/users/sjamesr/followers", "following_url": "https://api.github.com/users/sjamesr/following{/other_user}", "gists_url": "https://api.github.com/users/sjamesr/gists{/gist_id}", "starred_url": "https://api.github.com/users/sjamesr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sjamesr/subscriptions", "organizations_url": "https://api.github.com/users/sjamesr/orgs", "repos_url": "https://api.github.com/users/sjamesr/repos", "events_url": "https://api.github.com/users/sjamesr/events{/privacy}", "received_events_url": "https://api.github.com/users/sjamesr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sjamesr", "id": 4641539, "node_id": "MDQ6VXNlcjQ2NDE1Mzk=", "avatar_url": "https://avatars0.githubusercontent.com/u/4641539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sjamesr", "html_url": "https://github.com/sjamesr", "followers_url": "https://api.github.com/users/sjamesr/followers", "following_url": "https://api.github.com/users/sjamesr/following{/other_user}", "gists_url": "https://api.github.com/users/sjamesr/gists{/gist_id}", "starred_url": "https://api.github.com/users/sjamesr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sjamesr/subscriptions", "organizations_url": "https://api.github.com/users/sjamesr/orgs", "repos_url": "https://api.github.com/users/sjamesr/repos", "events_url": "https://api.github.com/users/sjamesr/events{/privacy}", "received_events_url": "https://api.github.com/users/sjamesr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-09-19T22:06:33Z", "updated_at": "2019-11-28T08:12:00Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes.\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): CentOS 7\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version (use command below): 1.14\r\n- Python version: 3.7\r\n- Bazel version (if compiling from source): 25.1\r\n- GCC/Compiler version (if compiling from source): 7.3\r\n\r\n**Describe the current behavior**\r\n\r\nThe current Tensorflow Java API (1.14 or 2.0) doesn't seem to be able to do inference on Tensorflow nodes created within a `@tf.function` signature. \r\n\r\nOn a related note, https://github.com/tensorflow/community/blob/master/rfcs/20180918-functions-not-sessions-20.md mentions that Java is planning to stay `Session` centric. Ideally, a signature inference centric API would be a good way to solve this issue and would be a good addition to the existing Java API.\r\n\r\nConcretely, here is the Python snippet defining a `request` and `response` (full Python code attached at the bottom of this ticket):\r\n```\r\n  @tf.function(input_signature=[tf.TensorSpec(shape=[None, None], name=\"serving\")])\r\n  def serve(self, request):\r\n    features = tf.identity(self.input_receiver(request), name='request')\r\n    output = self.call(features)\r\n    response = tf.identity(self.response_receiver(output), name='response')\r\n    return response\r\n```\r\nAfter exporting my model to a `SavedModelBundle` and  trying to do some prediction in Java via the `Session.runner()` API, I am getting:\r\n```\r\njava.lang.IllegalArgumentException: No Operation named [request] in the Graph\r\n  at org.tensorflow.Session$Runner.operationByName(Session.java:380)\r\n  at org.tensorflow.Session$Runner.parseOutput(Session.java:394)\r\n  at org.tensorflow.Session$Runner.feed(Session.java:131)\r\n  ... 34 elided\r\n```\r\nwhere `request` is defined within a `@tf.function`.\r\n\r\n**Describe the expected behavior**\r\n\r\nI would expect to not have a runtime failure at inference time on the JVM: either `operationByName` would recognize the `request:0` node or another Java API would exist to fulfill my requirements.\r\n\r\n**Code to reproduce the issue**\r\n\r\nPython code (model creation):\r\n```\r\nimport tensorflow as tf\r\nfrom tensorflow.keras import layers\r\n\r\n\r\nclass MnistModel(tf.keras.Model):\r\n  def __init__(self):\r\n    super().__init__()\r\n    self.first_dense = layers.Dense(64, input_shape=(784,), activation='relu', name='dense_1')\r\n    self.out = layers.Dense(10, activation='softmax', name='predictions')\r\n\r\n  def call(self, inp):\r\n    f_dense = self.first_dense(inp)\r\n    s_dense = self.out(f_dense)\r\n    return s_dense\r\n\r\n  def input_receiver(self, inp):\r\n    return inp\r\n\r\n  def response_receiver(self, output):\r\n    return output\r\n\r\n  @tf.function(input_signature=[tf.TensorSpec(shape=[None, None], name=\"serving\")])\r\n  def serve(self, request):\r\n    features = tf.identity(self.input_receiver(request), name='request')\r\n    output = self.call(features)\r\n    response = tf.identity(self.response_receiver(output), name='response')\r\n    return response\r\n\r\nmodel = MnistModel()\r\n\r\n(x_train, y_train), (x_test, y_test) = keras.datasets.mnist.load_data()\r\nx_train = x_train.reshape(60000, 784).astype('float32') / 255\r\nx_test = x_test.reshape(10000, 784).astype('float32') / 255\r\n\r\nmodel.compile(loss='sparse_categorical_crossentropy',\r\n              optimizer=keras.optimizers.RMSprop())\r\nhistory = model.fit(x_train, y_train,\r\n                    batch_size=64,\r\n                    epochs=1)\r\n\r\nkeras.experimental.export_saved_model(model, 'local_path', serving_only=True)\r\n```\r\n\r\nJVM / Scala code (inference code):\r\n```\r\nimport org.tensorflow.{SavedModelBundle, Session, Tensor}\r\nimport java.nio.ByteBuffer\r\nimport java.lang.{Float => JFloat}\r\n\r\nval savedModelBundle = SavedModelBundle.load(\"local_path\", \"serve\")\r\n\r\nval session = savedModelBundle.session()\r\n\r\nval byteBuffer = ByteBuffer.allocate(784*4)\r\n\r\nval tensor = Tensor.create(\r\n    classOf[JFloat],\r\n    Array(784),\r\n    byteBuffer)\r\n\r\nsession.runner()\r\n  .feed(\"request:0\", tensor)\r\n  .fetch(\"output:0\")\r\n  .run()\r\n\r\ntensor.close()\r\nbyteBuffer.close()\r\n```\r\n\r\nI am getting the following error:\r\n```\r\njava.lang.IllegalArgumentException: No Operation named [request] in the Graph\r\n  at org.tensorflow.Session$Runner.operationByName(Session.java:380)\r\n  at org.tensorflow.Session$Runner.parseOutput(Session.java:394)\r\n  at org.tensorflow.Session$Runner.feed(Session.java:131)\r\n  ... 34 elided\r\n```\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32655", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32655/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32655/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32655/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32655", "id": 495756539, "node_id": "MDU6SXNzdWU0OTU3NTY1Mzk=", "number": 32655, "title": "Unable to load tensorflow model in Java that was originally created in python (file not found exception)", "user": {"login": "maxx2803", "id": 34124907, "node_id": "MDQ6VXNlcjM0MTI0OTA3", "avatar_url": "https://avatars3.githubusercontent.com/u/34124907?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maxx2803", "html_url": "https://github.com/maxx2803", "followers_url": "https://api.github.com/users/maxx2803/followers", "following_url": "https://api.github.com/users/maxx2803/following{/other_user}", "gists_url": "https://api.github.com/users/maxx2803/gists{/gist_id}", "starred_url": "https://api.github.com/users/maxx2803/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maxx2803/subscriptions", "organizations_url": "https://api.github.com/users/maxx2803/orgs", "repos_url": "https://api.github.com/users/maxx2803/repos", "events_url": "https://api.github.com/users/maxx2803/events{/privacy}", "received_events_url": "https://api.github.com/users/maxx2803/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "nsthorat", "id": 1100749, "node_id": "MDQ6VXNlcjExMDA3NDk=", "avatar_url": "https://avatars0.githubusercontent.com/u/1100749?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nsthorat", "html_url": "https://github.com/nsthorat", "followers_url": "https://api.github.com/users/nsthorat/followers", "following_url": "https://api.github.com/users/nsthorat/following{/other_user}", "gists_url": "https://api.github.com/users/nsthorat/gists{/gist_id}", "starred_url": "https://api.github.com/users/nsthorat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nsthorat/subscriptions", "organizations_url": "https://api.github.com/users/nsthorat/orgs", "repos_url": "https://api.github.com/users/nsthorat/repos", "events_url": "https://api.github.com/users/nsthorat/events{/privacy}", "received_events_url": "https://api.github.com/users/nsthorat/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nsthorat", "id": 1100749, "node_id": "MDQ6VXNlcjExMDA3NDk=", "avatar_url": "https://avatars0.githubusercontent.com/u/1100749?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nsthorat", "html_url": "https://github.com/nsthorat", "followers_url": "https://api.github.com/users/nsthorat/followers", "following_url": "https://api.github.com/users/nsthorat/following{/other_user}", "gists_url": "https://api.github.com/users/nsthorat/gists{/gist_id}", "starred_url": "https://api.github.com/users/nsthorat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nsthorat/subscriptions", "organizations_url": "https://api.github.com/users/nsthorat/orgs", "repos_url": "https://api.github.com/users/nsthorat/repos", "events_url": "https://api.github.com/users/nsthorat/events{/privacy}", "received_events_url": "https://api.github.com/users/nsthorat/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-09-19T12:05:10Z", "updated_at": "2019-09-26T17:46:49Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): _Yes_\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): _Windows 10 Version 1903_\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: _/_\r\n- TensorFlow installed from (source or binary): _installed via pip in virtualenv_\r\n- TensorFlow version (use command below): _1.14_\r\n- Python version: _3.7_\r\n- Bazel version (if compiling from source): _/_\r\n- GCC/Compiler version (if compiling from source): _/_\r\n- CUDA/cuDNN version: 10.0\r\n- GPU model and memory: Nvidia GTX 1050 Ti (3 GB)\r\n\r\n**Describe the current behavior**\r\nI train a neural network. After training, I want to export my model in order to use it in Java for predictions. Unfortunately, it always displays an error while trying to load the model in Java, saying the file cannot be found (see error message below). I checked the path a hundred times and made sure via the built-in Java methods that the files exist and I have the rights to read them.\r\n\r\n**Describe the expected behavior**\r\nI expect the model to be loaded in order to use it for predictions within my native Java code.\r\n\r\n**Code to reproduce the issue**\r\nBelow this you can see the Python code to export the model.\r\n\r\n```\r\ntf.saved_model.simple_save(sess,\r\n                           path_graph_model_export_dir,\r\n                           inputs=model_inputs, outputs={'sim': similarity})\r\n```\r\n\r\nThis is the structure of the exported directory.\r\n\r\n```\r\nsaved_model\r\n---- saved_model.pb\r\n---- variables\r\n-------- variables.data-00000-of-00001\r\n-------- variables.index\r\n```\r\n\r\nAnd the code in Java to load the model..\r\n\r\n```\r\nSavedModelBundle model = SavedModelBundle.load(modelPath, \"serve\")\r\n```\r\n\r\nresults in this exception.\r\n\r\n```\r\n2019-09-17 10:59:03.905538: I tensorflow/cc/saved_model/reader.cc:31] Reading SavedModel from: saved_model\r\n2019-09-17 10:59:03.905997: I tensorflow/cc/saved_model/loader.cc:311] SavedModel load for tags { serve }; Status: fail. Took 457 microseconds.\r\norg.tensorflow.TensorFlowException: Could not find SavedModel .pb or .pbtxt at supplied export directory path: saved_model\r\n```\r\n\r\n**Other info / logs**\r\nI use a tensorflow graph built with Sonnet (version 1.34) but I don't think this is an issue as Sonnet only assists in building more complex graphs.\r\nTensorboard model log: [tensorboard.zip](https://github.com/tensorflow/tensorflow/files/3631054/tensorboard.zip)\r\nSaved model folder: [saved_model.zip](https://github.com/tensorflow/tensorflow/files/3631055/saved_model.zip)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32653", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32653/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32653/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32653/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32653", "id": 495735638, "node_id": "MDU6SXNzdWU0OTU3MzU2Mzg=", "number": 32653, "title": "Keras model.save() is extremely slow under MirroredStrategy context when keras.layers.BatchNormalization is in use.", "user": {"login": "bearsroom", "id": 6884714, "node_id": "MDQ6VXNlcjY4ODQ3MTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/6884714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bearsroom", "html_url": "https://github.com/bearsroom", "followers_url": "https://api.github.com/users/bearsroom/followers", "following_url": "https://api.github.com/users/bearsroom/following{/other_user}", "gists_url": "https://api.github.com/users/bearsroom/gists{/gist_id}", "starred_url": "https://api.github.com/users/bearsroom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bearsroom/subscriptions", "organizations_url": "https://api.github.com/users/bearsroom/orgs", "repos_url": "https://api.github.com/users/bearsroom/repos", "events_url": "https://api.github.com/users/bearsroom/events{/privacy}", "received_events_url": "https://api.github.com/users/bearsroom/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 14, "created_at": "2019-09-19T11:18:28Z", "updated_at": "2020-01-29T02:20:03Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code: yes, the training script is written from scratch but the network resnet_v1.5-50 is copied from official example tensorflow/models\r\n- OS Platform and Distribution: Linux Debian 9\r\n- TensorFlow installed from (source or binary): yes\r\n- GCC version for compiling: gcc 6.3 git commit 1eea9f905c4b4ac4844855eb64e2f9e415babe56\r\n- TensorFlow version (use command below): 1.15\r\n- Python version: python 3.5\r\n- CUDA/cuDNN version: cuda 10.0 cudnn 7.6.2.24\r\n- GPU model and memory: V100 32GB\r\n\r\n**Describe the current behavior**\r\nI try to use keras API for image classification model training and I'm testing the performance of `MirroredStrategy`. Everything works ordinarily except for keras model saving, which is extremely slow. Typically saving a model with resnet_v1.5-50 as backbone can elapsed hundreds of seconds.\r\n\r\nHere's the saving time for each layers in resnet_v1.5-50, I found that saving `keras.layers.BatchNormalization` is the bottleneck:\r\n```\r\nLayer res5c_branch2b K.batch_get_value() for weight aggregation elapsed 0.00420689582824707s\r\nSave layer res5c_branch2b weights elapsed 0.010241508483886719s\r\nLayer bn5c_branch2b K.batch_get_value() for weight aggregation elapsed 6.323298692703247s\r\nSave layer bn5c_branch2b weights elapsed 6.325744867324829s\r\nLayer activation_47 K.batch_get_value() for weight aggregation elapsed 3.337860107421875e-05s\r\nSave layer activation_47 weights elapsed 0.002166748046875s\r\n```\r\nAfter checking source codes of `BatchNormalization` and `MirroredStrategy`, I guess this bottleneck may be caused by synchronization between multiple replicas for parameters `moving_mean` and `moving_variance`. These two parameters use `SyncOnReadVariable` with `aggregation=VariableAggregation.MEAN` under `MirroredStrategy` context, and saving these two parameters needs synchronization, which is slow in my runtime environment.\r\n\r\nThe source codes which may be related to this problem:\r\nhttps://github.com/tensorflow/tensorflow/blob/r1.15/tensorflow/python/keras/layers/normalization.py#L393\r\nhttps://github.com/tensorflow/tensorflow/blob/r1.15/tensorflow/python/distribute/values.py#L1230\r\nhttps://github.com/tensorflow/tensorflow/blob/r1.15/tensorflow/python/distribute/values.py#L1151\r\nhttps://github.com/tensorflow/tensorflow/blob/r1.15/tensorflow/python/distribute/mirrored_strategy.py#L524\r\nhttps://github.com/tensorflow/tensorflow/blob/r1.15/tensorflow/python/distribute/mirrored_strategy.py#L734\r\n\r\nrelated issue: https://github.com/keras-team/keras/issues/9298\r\n\r\nI didn't test tensorflow 2.0 version, but I found no changes in terms of `moving_mean`, `moving_variance` and `SyncOnReadVariable`, so I guess this problem may still exists in 2.0 version.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32650", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32650/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32650/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32650/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32650", "id": 495674842, "node_id": "MDU6SXNzdWU0OTU2NzQ4NDI=", "number": 32650, "title": "Converting unsupported operation ??", "user": {"login": "ucasiggcas", "id": 35590066, "node_id": "MDQ6VXNlcjM1NTkwMDY2", "avatar_url": "https://avatars0.githubusercontent.com/u/35590066?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ucasiggcas", "html_url": "https://github.com/ucasiggcas", "followers_url": "https://api.github.com/users/ucasiggcas/followers", "following_url": "https://api.github.com/users/ucasiggcas/following{/other_user}", "gists_url": "https://api.github.com/users/ucasiggcas/gists{/gist_id}", "starred_url": "https://api.github.com/users/ucasiggcas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ucasiggcas/subscriptions", "organizations_url": "https://api.github.com/users/ucasiggcas/orgs", "repos_url": "https://api.github.com/users/ucasiggcas/repos", "events_url": "https://api.github.com/users/ucasiggcas/events{/privacy}", "received_events_url": "https://api.github.com/users/ucasiggcas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2019-09-19T09:16:49Z", "updated_at": "2020-03-04T22:05:35Z", "closed_at": null, "author_association": "NONE", "body": "- OS Platform and Distribution ( Linux Ubuntu 18.04):\r\n- TensorFlow installed from (source):\r\n- TensorFlow version (https://github.com/tensorflow/tensorflow):\r\n\r\n\r\n`tensorflow-master$ bazel-bin/tensorflow/lite/toco/toco --input_file=../my_freeze12xshell.pb --output_file=../my12.tflite --output_format=TFLITE --input_shapes=2,4,513 --input_arrays=x_mixed --output_arrays=y_out1,y_out2 --inference_type=QUANTIZED_UINT8 --inference_input_type=FLOAT --std_dev_values=1 --mean_values=0`\r\n\r\nmy pb file is here\r\n\r\n[my_freeze12xshell.zip](https://github.com/tensorflow/tensorflow/files/3630369/my_freeze12xshell.zip)\r\n\r\nany one could help me ?\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32627", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32627/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32627/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32627/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32627", "id": 495354267, "node_id": "MDU6SXNzdWU0OTUzNTQyNjc=", "number": 32627, "title": " Support for 32 bits architecture #32315 ", "user": {"login": "steffanjensen", "id": 13394970, "node_id": "MDQ6VXNlcjEzMzk0OTcw", "avatar_url": "https://avatars3.githubusercontent.com/u/13394970?v=4", "gravatar_id": "", "url": "https://api.github.com/users/steffanjensen", "html_url": "https://github.com/steffanjensen", "followers_url": "https://api.github.com/users/steffanjensen/followers", "following_url": "https://api.github.com/users/steffanjensen/following{/other_user}", "gists_url": "https://api.github.com/users/steffanjensen/gists{/gist_id}", "starred_url": "https://api.github.com/users/steffanjensen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/steffanjensen/subscriptions", "organizations_url": "https://api.github.com/users/steffanjensen/orgs", "repos_url": "https://api.github.com/users/steffanjensen/repos", "events_url": "https://api.github.com/users/steffanjensen/events{/privacy}", "received_events_url": "https://api.github.com/users/steffanjensen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2019-09-18T17:18:40Z", "updated_at": "2019-11-14T18:33:27Z", "closed_at": null, "author_association": "NONE", "body": "Several users are still using Python32 bits and they cannot install TensorFlow. For them, pip install TensorFlow fails as no wheel matches the tags expected by their environment (to debug, pip debug --verbose shows only tags that don't math the filenames of our wheels).\r\n\r\nThere is some requests to support 32 bits, see for example #31431\r\n\r\nThis is not going to be easy as we need to also compile the C++ codebase in 32 bits mode and that would cause issues with code written assuming types have a certain bit width.\r\n\r\nThere is no change in the user visible API, just a new set of wheels to support more users.\r\n\r\nOpening this to reference in all similar issues.\r\n\r\nAfter closing my thread, i just reopen it. Google employees trying to tell me this is not the roadmap for the tool. The day i am going to care about a Google employee opinion is the day hell froze. \r\n\r\nIf you close this issue I will keep posting daily, until issue is fixed. \r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32624", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32624/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32624/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32624/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32624", "id": 495337936, "node_id": "MDU6SXNzdWU0OTUzMzc5MzY=", "number": 32624, "title": "Inference in C++ Tensorflow: Session->Run hangs when ran with input and output parameters supplied", "user": {"login": "amitpandey2194", "id": 26887110, "node_id": "MDQ6VXNlcjI2ODg3MTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/26887110?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amitpandey2194", "html_url": "https://github.com/amitpandey2194", "followers_url": "https://api.github.com/users/amitpandey2194/followers", "following_url": "https://api.github.com/users/amitpandey2194/following{/other_user}", "gists_url": "https://api.github.com/users/amitpandey2194/gists{/gist_id}", "starred_url": "https://api.github.com/users/amitpandey2194/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amitpandey2194/subscriptions", "organizations_url": "https://api.github.com/users/amitpandey2194/orgs", "repos_url": "https://api.github.com/users/amitpandey2194/repos", "events_url": "https://api.github.com/users/amitpandey2194/events{/privacy}", "received_events_url": "https://api.github.com/users/amitpandey2194/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1162044565, "node_id": "MDU6TGFiZWwxMTYyMDQ0NTY1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.12", "name": "TF 1.12", "color": "c2e0c6", "default": false, "description": "Issues related to TF 1.12"}, {"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ezhulenev", "id": 1174378, "node_id": "MDQ6VXNlcjExNzQzNzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/1174378?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezhulenev", "html_url": "https://github.com/ezhulenev", "followers_url": "https://api.github.com/users/ezhulenev/followers", "following_url": "https://api.github.com/users/ezhulenev/following{/other_user}", "gists_url": "https://api.github.com/users/ezhulenev/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezhulenev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezhulenev/subscriptions", "organizations_url": "https://api.github.com/users/ezhulenev/orgs", "repos_url": "https://api.github.com/users/ezhulenev/repos", "events_url": "https://api.github.com/users/ezhulenev/events{/privacy}", "received_events_url": "https://api.github.com/users/ezhulenev/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ezhulenev", "id": 1174378, "node_id": "MDQ6VXNlcjExNzQzNzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/1174378?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezhulenev", "html_url": "https://github.com/ezhulenev", "followers_url": "https://api.github.com/users/ezhulenev/followers", "following_url": "https://api.github.com/users/ezhulenev/following{/other_user}", "gists_url": "https://api.github.com/users/ezhulenev/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezhulenev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezhulenev/subscriptions", "organizations_url": "https://api.github.com/users/ezhulenev/orgs", "repos_url": "https://api.github.com/users/ezhulenev/repos", "events_url": "https://api.github.com/users/ezhulenev/events{/privacy}", "received_events_url": "https://api.github.com/users/ezhulenev/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-09-18T16:41:39Z", "updated_at": "2019-10-14T17:53:21Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 18.04):\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): Source C++ API\r\n- TensorFlow version (use command below):1.12.0\r\n- Python version:3.6.7\r\n- Bazel version (if compiling from source):0.18.1\r\n- GCC/Compiler version (if compiling from source):7.4.0\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nI trained a FasterRCNN for point detection using TensorFlow and its python API. I was able to do the inference successfully in the same without any issues.\r\nNow for production requirements, I need to build a standalone application or library which can perform the inference in C++.\r\n\r\nIn order to achieve that I successfully managed to build the TensorFlow library from scratch for C++ API and ran a few test programs.\r\n\r\nSteps followed for inference on my trained model:\r\n\r\n 1. Method #1: freeze the graph to *.pb file using modified [freeze_graph.py][1] and restore it.\r\n 2. Method #2: Directly restore from checkpoint using MetaGraphDef and ReadBinaryProto.\r\n\r\nI tried both the methods and the loading of the model seems to happen without any error. I printed the node names as well.\r\n\r\nAfter loading the graph I created a handler for image input, previously the input during training was getting handled by QueueRunner, but because it's just inference I created the handler myself with appropriate modifications to it as can be seen below.\r\n\r\n        Status fasterRcnn::CreateGraphForImage(bool unstack)\r\n    {\r\n        fileNameVar=Placeholder(iRoot.WithOpName(\"input\"),DT_STRING);\r\n        auto fileReader=ReadFile(iRoot.WithOpName(\"fileReader\"),fileNameVar);\r\n        auto imageReader=DecodeJpeg(iRoot.WithOpName(\"jpegReader\"),fileReader,DecodeJpeg::Channels(imageChannels));\r\n        auto floatCaster=Cast(iRoot.WithOpName(\"floatCaster\"),imageReader,DT_FLOAT);\r\n        auto dimsExpander=ExpandDims(iRoot.WithOpName(\"dim\"),floatCaster,0);\r\n        //auto resized=ResizeBilinear(iRoot.WithOpName(\"size\"),dimsExpander,Const(iRoot,{imageSide,imageSide}));\r\n        //auto div=Div(iRoot.WithOpName(\"normalized\"),resized,{255.f});\r\n        imageTensorVar=dimsExpander;//div;\r\n        return iRoot.status();\r\n\r\n    }\r\nNOTE: iRoot is the private variable of fasterRcnn class-> Scope used by the graph for loading images into tensors\r\n\r\n \r\n\r\n       class fasterRcnn\r\n    {\r\n    private:\r\n        Scope iRoot;//graph for loading images into tensors\r\n        const int imageSide;\r\n        const int imageChannels;//rgb\r\n        //load image vars\r\n        Output fileNameVar;\r\n        Output imageTensorVar;\r\n        //\r\n        std::unique_ptr<Session> fSession;//file session\r\n        std::unique_ptr<GraphDef> graphDef;\r\n    public:\r\n        fasterRcnn(int side,int channels):iRoot(Scope::NewRootScope()),imageSide(side),imageChannels(channels){}\r\n        Status CreateGraphForImage(bool unstack);\r\n        Status LoadSavedModel(string &fileName);//via frozen graph\r\n        Status LoadSavedModel(std::string graph_fn,std::string checkpoint_fn);//via checkpoints\r\n        Status PredictFromFrozen(Tensor &image,int&results);//\r\n        Status ReadTensorFromImageFile(string& file_name, Tensor& outTensor);\r\n        Status ReadFileTensors(string& folder_name,vector<Tensor>& file_tensors);\r\n    \r\n    };\r\n\r\n**Now the when the time comes for Prediction when I run Session->Run with particular input node name and output node name the program hangs**:\r\n\r\n    Status fasterRcnn::PredictFromFrozen(Tensor& image, int& result)\r\n    {\r\n        vector<Tensor> outTensors;\r\n        cout<<\"Prediction about to start\"<<endl;\r\n        TF_CHECK_OK(fSession->Run({{\"fasterrcnn/truncated_base_network/sub\",image}},{\"fasterrcnn/rcnn/rcnn_proposal/GatherV2_1\"},{},&outTensors));\r\n        cout<<\"Prediction done\"<<endl;\r\n        auto output_c = outTensors[0].scalar<float>();\r\n        for (int i=0;i<outTensors.size();i++)\r\n        {\r\n            cout << \"Output dimension of the image\" << outTensors[i].DebugString()<<\"\\n\";\r\n        }\r\n        cout << \"Output dimension of the image\" << outTensors[0].DebugString()<<\"\\n\";\r\n        return Status::OK();\r\n    }\r\n\r\n**TF_CHECK_OK(fSession->Run({{\"fasterrcnn/truncated_base_network/sub\",image}},{\"fasterrcnn/rcnn/rcnn_proposal/GatherV2_1\"},{},&outTensors));**\r\n\r\n***It hangs at the above statement.***\r\n\r\n**Up until a few Debug thoughts:**\r\n\r\n 1. I thought maybe the QueueRunner might be creating the issue, but according to [this answer][2] I handled that as I created the image handler graph.\r\n 2. I thought maybe I didn't freeze the graph well, that's I loaded directly from the checkpoints, but still, it hangs.\r\n 3. The input to the VGG_16 truncated network in graph expects a 4D float tensor, which I am providing, double-checked that.\r\n\r\n\r\n\r\n**Links to Code and Graph:**\r\n\r\n 1. [CodeBase and GraphPng and GIF hosted on GDrive][3]\r\n\r\n**Question:**\r\n\r\n 1. Is there any step that I missing, for successful inferencing in C++.\r\n 2. How to verify if my input and output node names are correct? I referred to the python code and they seem right.\r\n 3. Any steps for debugging that I should follow to provide more info on this?\r\n\r\n  [1]: https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/tools/freeze_graph.py\r\n  [2]: https://stackoverflow.com/a/35346656/8250471\r\n  [3]: https://drive.google.com/drive/folders/1iO7JIitD_BfHnnLqgzvUygFwAAW6v_5G?usp=sharing\r\n\r\n**Describe the expected behavior**\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32620", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32620/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32620/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32620/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32620", "id": 495297380, "node_id": "MDU6SXNzdWU0OTUyOTczODA=", "number": 32620, "title": "Use tf.Tensor as input to tf.io.gfile.GFile", "user": {"login": "remydubois", "id": 18008405, "node_id": "MDQ6VXNlcjE4MDA4NDA1", "avatar_url": "https://avatars0.githubusercontent.com/u/18008405?v=4", "gravatar_id": "", "url": "https://api.github.com/users/remydubois", "html_url": "https://github.com/remydubois", "followers_url": "https://api.github.com/users/remydubois/followers", "following_url": "https://api.github.com/users/remydubois/following{/other_user}", "gists_url": "https://api.github.com/users/remydubois/gists{/gist_id}", "starred_url": "https://api.github.com/users/remydubois/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/remydubois/subscriptions", "organizations_url": "https://api.github.com/users/remydubois/orgs", "repos_url": "https://api.github.com/users/remydubois/repos", "events_url": "https://api.github.com/users/remydubois/events{/privacy}", "received_events_url": "https://api.github.com/users/remydubois/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-09-18T15:24:25Z", "updated_at": "2019-11-15T23:42:09Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using): 2.0.0rc1\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nCurrently, file readers such as `tf.io.gfile.GFile` expect plain strings as input. As a consequence, one can hardly use those file readers inside `tf.data.Dataset` pipelines which yield string Tensors (typically through `tf.data.Dataset.list_files`)\r\n\r\nDoing so raises `TypeError: Expected binary or unicode string, got <tf.Tensor 'EagerPyFunc:0' shape=<unknown> dtype=string>`, at the line `compat.as_bytes(self.__name)` (tensorflow_core/python/lib/io/file_io.py:84).\r\n\r\n**Will this change the current api? How?**\r\nFrom a user point of view, the current API would not see any significant changes.\r\n\r\n**Who will benefit with this feature?**\r\nAny one eager to read custom file formats, where it is for instance needed to decode part of the header file (first few bytes) to decode the actual content. For instance, image formats such as TIFF where the dtype and the image shape are encoded inside the header.\r\n\r\nBelow pipelines would then be easier to build:\r\n```\r\nfiles = tf.data.Dataset.list_files('/**/regex*')\r\ntensors = files.map(MyCustomReader)\r\n```\r\n\r\n**Any Other info.**\r\nSee below an example of such custom format file reader:\r\n\r\n```\r\nimport tensorflow as tf\r\n\r\n@tf.function\r\ndef CustomReader(path):\r\n    # path must here a string in the current API\r\n    with tf.io.gfile.GFile(name=path, mode='rb') as f:\r\n        \r\n        # Shape information is encoded  on 16 bytes starting at position 40\r\n        f.seek(40)\r\n        shape = tf.io.decode_raw(f.read(16), out_type=tf.int16)\r\n        shape = tf.cast(shape, tf.int32)\r\n       \r\n        # dtype information is encoded on 2 bytes at position 70\r\n        f.seek(70)\r\n        dtype = tf.io.decode_raw(f.read(2), out_type=tf.int16)[0]\r\n\r\n        # tensor values populate the  rest of the buffer\r\n        values = tf.io.decode_raw(f.read(-1), out_type=dtype)\r\n        tensor = tf.reshape(values, shape)\r\n\r\n        return tensor\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32618", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32618/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32618/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32618/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32618", "id": 495250679, "node_id": "MDU6SXNzdWU0OTUyNTA2Nzk=", "number": 32618, "title": "Use of fit_generator and evaluate_generator result in \"builtins.TypeError: 'NoneType' object is not subscriptable\"", "user": {"login": "isaacgerg", "id": 11971499, "node_id": "MDQ6VXNlcjExOTcxNDk5", "avatar_url": "https://avatars0.githubusercontent.com/u/11971499?v=4", "gravatar_id": "", "url": "https://api.github.com/users/isaacgerg", "html_url": "https://github.com/isaacgerg", "followers_url": "https://api.github.com/users/isaacgerg/followers", "following_url": "https://api.github.com/users/isaacgerg/following{/other_user}", "gists_url": "https://api.github.com/users/isaacgerg/gists{/gist_id}", "starred_url": "https://api.github.com/users/isaacgerg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/isaacgerg/subscriptions", "organizations_url": "https://api.github.com/users/isaacgerg/orgs", "repos_url": "https://api.github.com/users/isaacgerg/repos", "events_url": "https://api.github.com/users/isaacgerg/events{/privacy}", "received_events_url": "https://api.github.com/users/isaacgerg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-09-18T14:08:07Z", "updated_at": "2019-11-13T06:02:01Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\nhttps://colab.research.google.com/gist/isaacgerg/03717f55f020f36aa7b5138fc04cfc43/tf-keras-generator-issue.ipynb\r\n\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\nWindows 7, Python 3.7, tensorflow 1.13.1\r\n\r\n- TensorFlow installed from (source or binary):\r\nvia pip\r\n\r\n- TensorFlow version (use command below): 1.13,1\r\n\r\n- Python version: 3.7\r\n- CUDA/cuDNN version: 10\r\n- GPU model and memory: RTX\r\n\r\n**Describe the current behavior**\r\n```\r\nThe code in the colab, when run on a GPU, results in teh following error:\r\nFile \"c:\\python37\\Lib\\threading.py\", line 885, in _bootstrap\r\n  self._bootstrap_inner()\r\nFile \"c:\\python37\\Lib\\threading.py\", line 917, in _bootstrap_inner\r\n  self.run()\r\nFile \"c:\\python37\\Lib\\threading.py\", line 865, in run\r\n  self._target(*self._args, **self._kwargs)\r\nFile \"c:\\python37\\Lib\\multiprocessing\\pool.py\", line 121, in worker\r\n  result = (True, func(*args, **kwds))\r\nFile \"c:\\python37\\Lib\\site-packages\\tensorflow\\python\\keras\\utils\\data_utils.py\", line 445, in get_index\r\n  return _SHARED_SEQUENCES[uid][i]\r\n\r\nbuiltins.TypeError: 'NoneType' object is not subscriptable\r\n```\r\n\r\n**Describe the expected behavior**\r\nNo error\r\n\r\n**Code to reproduce the issue**\r\nSee colab link in description.  This is the offending code.  It only appears to happen on windows.  I am unsure in colab how to select a windows based environment.\r\n\r\nEDIT 1: Added windows caveat."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32609", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32609/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32609/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32609/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32609", "id": 495045767, "node_id": "MDU6SXNzdWU0OTUwNDU3Njc=", "number": 32609, "title": "Support for TensorForest", "user": {"login": "gd12345", "id": 20239559, "node_id": "MDQ6VXNlcjIwMjM5NTU5", "avatar_url": "https://avatars1.githubusercontent.com/u/20239559?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gd12345", "html_url": "https://github.com/gd12345", "followers_url": "https://api.github.com/users/gd12345/followers", "following_url": "https://api.github.com/users/gd12345/following{/other_user}", "gists_url": "https://api.github.com/users/gd12345/gists{/gist_id}", "starred_url": "https://api.github.com/users/gd12345/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gd12345/subscriptions", "organizations_url": "https://api.github.com/users/gd12345/orgs", "repos_url": "https://api.github.com/users/gd12345/repos", "events_url": "https://api.github.com/users/gd12345/events{/privacy}", "received_events_url": "https://api.github.com/users/gd12345/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-09-18T07:41:00Z", "updated_at": "2019-10-07T22:26:47Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution Linux Ubuntu 18.04\r\n- TensorFlow installed from binary\r\n- TensorFlow version 1.14\r\n\r\nText from TFLite converter:\r\n\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime. If those are native TensorFlow operators, you might be able to use the extended runtime by passing --enable_select_tf_ops, or by setting target_ops=TFLITE_BUILTINS,SELECT_TF_OPS when calling tf.lite.TFLiteConverter(). Otherwise, if you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: ARG_MAX, DIV, PACK, SUM. Here is a list of operators for which you will need custom implementations: DecisionTreeResourceHandleOp, TreePredictionsV4.\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32606", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32606/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32606/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32606/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32606", "id": 494971384, "node_id": "MDU6SXNzdWU0OTQ5NzEzODQ=", "number": 32606, "title": "[model_to_estimator] estimator not evaluate all outputs defined in keras model but only one", "user": {"login": "Jasonnor", "id": 7609173, "node_id": "MDQ6VXNlcjc2MDkxNzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/7609173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jasonnor", "html_url": "https://github.com/Jasonnor", "followers_url": "https://api.github.com/users/Jasonnor/followers", "following_url": "https://api.github.com/users/Jasonnor/following{/other_user}", "gists_url": "https://api.github.com/users/Jasonnor/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jasonnor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jasonnor/subscriptions", "organizations_url": "https://api.github.com/users/Jasonnor/orgs", "repos_url": "https://api.github.com/users/Jasonnor/repos", "events_url": "https://api.github.com/users/Jasonnor/events{/privacy}", "received_events_url": "https://api.github.com/users/Jasonnor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-09-18T03:47:59Z", "updated_at": "2019-09-19T08:52:12Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):  Linux Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 1.13.1\r\n- Python version: 3.5.2\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: CUDA 10.0\r\n- GPU model and memory: \r\n\r\n**Describe the current behavior**\r\nWhen using keras model with **multiple outputs**, and convert it to estimator by `model_to_estimator`, it only evaluate one output by `estimator.evaluate` or `tf.estimator.train_and_evaluate`. \r\nAnd don't know which output it evaluate (it doesn't display output name but only metrics name).\r\n\r\n**Describe the expected behavior**\r\nIt should only evaluate all outputs defined in keras model, not only pick one.\r\n\r\n**Code to reproduce the issue**\r\nA example here:\r\n```python\r\n    ...\r\n\r\n    model = tf.keras.Model(inputs=input_layer, outputs=[output_layer1, output_layer2])\r\n\r\n    model.compile(optimizer=optimizer_builder.build(config.optimizer),\r\n                  loss={\r\n                      'output_layer1': 'sparse_categorical_crossentropy',\r\n                      'output_layer2': 'sparse_categorical_crossentropy'},\r\n                  metrics={\r\n                      'output_layer1': 'accuracy',\r\n                      'output_layer2': 'accuracy'})\r\n\r\n    estimator = tf.keras.estimator.model_to_estimator(\r\n        keras_model=model,\r\n        config=run_config,\r\n    )\r\n    train_spec = tf.estimator.TrainSpec(\r\n        input_fn=lambda: train_input_fn(config))\r\n    eval_spec = tf.estimator.EvalSpec(\r\n        input_fn=lambda: eval_input_fn(config))\r\n    tf.estimator.train_and_evaluate(estimator, train_spec, eval_spec)\r\n\r\n    # Only evaluate one output and don't know which output it evaluate\r\n```\r\n\r\n**Other info / logs**\r\ntf log here, except two outputs log, but only get one:\r\n```\r\n# Training is OK\r\nINFO:tensorflow:global_step/sec: 1.02106\r\nINFO:tensorflow:loss = 0.16959098, step = 33600 (97.938 sec)\r\nINFO:tensorflow:global_step/sec: 0.943188\r\nINFO:tensorflow:loss = 0.17629223, step = 33700 (106.023 sec)\r\nINFO:tensorflow:global_step/sec: 0.848641\r\nINFO:tensorflow:loss = 0.1101246, step = 33800 (117.835 sec)\r\nINFO:tensorflow:global_step/sec: 0.852682\r\nINFO:tensorflow:loss = 0.104427785, step = 33900 (117.277 sec)\r\nINFO:tensorflow:Saving checkpoints for 34000 into /summary/model.ckpt.\r\n...\r\n\r\n# Evaluating only evaluate one output\r\nINFO:tensorflow:Running local_init_op.\r\nINFO:tensorflow:Done running local_init_op.\r\nINFO:tensorflow:Evaluation [150/1500]\r\nINFO:tensorflow:Finished evaluation at 2019-09-17-14:14:45\r\nINFO:tensorflow:Saving dict for global step 34000: accuracy = 0.6914724, sparse_categorical_crossentropy = 1.0857606, global_step = 34000, loss = 1.1107497\r\n```\r\n\r\nTensorBoard except two outputs scalar, but only get one:\r\n![2019-09-18 11 27 54](https://user-images.githubusercontent.com/7609173/65105491-aaff6000-da07-11e9-916f-473ba7847ba6.png)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32603", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32603/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32603/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32603/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32603", "id": 494950664, "node_id": "MDU6SXNzdWU0OTQ5NTA2NjQ=", "number": 32603, "title": "[model_to_estimator] summary in keras loss/metrics function get duplicate scalars with same value in TensorBoard", "user": {"login": "Jasonnor", "id": 7609173, "node_id": "MDQ6VXNlcjc2MDkxNzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/7609173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jasonnor", "html_url": "https://github.com/Jasonnor", "followers_url": "https://api.github.com/users/Jasonnor/followers", "following_url": "https://api.github.com/users/Jasonnor/following{/other_user}", "gists_url": "https://api.github.com/users/Jasonnor/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jasonnor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jasonnor/subscriptions", "organizations_url": "https://api.github.com/users/Jasonnor/orgs", "repos_url": "https://api.github.com/users/Jasonnor/repos", "events_url": "https://api.github.com/users/Jasonnor/events{/privacy}", "received_events_url": "https://api.github.com/users/Jasonnor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 284285184, "node_id": "MDU6TGFiZWwyODQyODUxODQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tensorboard", "name": "comp:tensorboard", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "nfelt", "id": 710113, "node_id": "MDQ6VXNlcjcxMDExMw==", "avatar_url": "https://avatars0.githubusercontent.com/u/710113?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nfelt", "html_url": "https://github.com/nfelt", "followers_url": "https://api.github.com/users/nfelt/followers", "following_url": "https://api.github.com/users/nfelt/following{/other_user}", "gists_url": "https://api.github.com/users/nfelt/gists{/gist_id}", "starred_url": "https://api.github.com/users/nfelt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nfelt/subscriptions", "organizations_url": "https://api.github.com/users/nfelt/orgs", "repos_url": "https://api.github.com/users/nfelt/repos", "events_url": "https://api.github.com/users/nfelt/events{/privacy}", "received_events_url": "https://api.github.com/users/nfelt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nfelt", "id": 710113, "node_id": "MDQ6VXNlcjcxMDExMw==", "avatar_url": "https://avatars0.githubusercontent.com/u/710113?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nfelt", "html_url": "https://github.com/nfelt", "followers_url": "https://api.github.com/users/nfelt/followers", "following_url": "https://api.github.com/users/nfelt/following{/other_user}", "gists_url": "https://api.github.com/users/nfelt/gists{/gist_id}", "starred_url": "https://api.github.com/users/nfelt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nfelt/subscriptions", "organizations_url": "https://api.github.com/users/nfelt/orgs", "repos_url": "https://api.github.com/users/nfelt/repos", "events_url": "https://api.github.com/users/nfelt/events{/privacy}", "received_events_url": "https://api.github.com/users/nfelt/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-09-18T02:31:01Z", "updated_at": "2019-09-27T03:29:12Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):  Linux Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 1.13.1\r\n- Python version: 3.5.2\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: CUDA 10.0\r\n- GPU model and memory: \r\n\r\n**Describe the current behavior**\r\nUsing tf.summary.scalar in keras loss/metrics function, then use model_to_estimator to convert keras model to estimator, tensorboard get duplicate scalars with totally same value. (e.g., `metrics/accuracy/train` and `metrics/accuracy/train_1`)\r\n\r\n**Describe the expected behavior**\r\nIt should only summary one scalar.\r\n\r\n**Code to reproduce the issue**\r\nA example here:\r\n```python\r\n    ...\r\n\r\n    model = tf.keras.Model(inputs=input_layer, outputs=[output_layer1, output_layer2])\r\n\r\n    def accuracy(y_true, y_pred):\r\n        y_pred, y_true = reshape_keras_tensor(y_pred, y_true)\r\n        acc = tf.reduce_mean(\r\n            tf.cast(tf.equal(tf.cast(y_true, tf.int64), tf.argmax(input=y_pred, axis=1)), tf.float32))\r\n        # Where I summary, without this line, it will not summary anything during training\r\n        tf.summary.scalar('train', acc)\r\n        return acc\r\n\r\n    def total_loss(y_true, y_pred):\r\n        y_pred, y_true = reshape_keras_tensor(y_pred, y_true)\r\n        loss =  tf.nn.sparse_softmax_cross_entropy_with_logits(\r\n            labels=y_true,\r\n            logits=y_pred)\r\n        loss = tf.reduce_mean(cross_entropy)\r\n        # Where I summary, without this line, it will not summary anything during training\r\n        tf.summary.scalar('train', loss)\r\n        return loss\r\n\r\n    ...\r\n\r\n    model.compile(optimizer=optimizer_builder.build(config.optimizer),\r\n                  loss={output_layer1: total_loss},\r\n                  metrics={output_layer1: accuracy})\r\n\r\n    estimator = tf.keras.estimator.model_to_estimator(\r\n        keras_model=model,\r\n        config=run_config,\r\n    )\r\n    train_spec = tf.estimator.TrainSpec(\r\n        input_fn=lambda: train_input_fn(config))\r\n    eval_spec = tf.estimator.EvalSpec(\r\n        input_fn=lambda: eval_input_fn(config))\r\n    tf.estimator.train_and_evaluate(estimator, train_spec, eval_spec)\r\n```\r\n\r\n**Other info / logs**\r\nTensorBoard with duplicate scalars:\r\n![2019-09-18 10 28 17](https://user-images.githubusercontent.com/7609173/65102919-27da0c00-d9ff-11e9-8a46-6d00ea39a4eb.png)\r\n![2019-09-18 10 27 56](https://user-images.githubusercontent.com/7609173/65102920-2872a280-d9ff-11e9-9d85-b626593688a7.png)\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32601", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32601/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32601/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32601/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32601", "id": 494941688, "node_id": "MDU6SXNzdWU0OTQ5NDE2ODg=", "number": 32601, "title": "Is there any documents of TF Core", "user": {"login": "KANGRuipeng", "id": 17191047, "node_id": "MDQ6VXNlcjE3MTkxMDQ3", "avatar_url": "https://avatars1.githubusercontent.com/u/17191047?v=4", "gravatar_id": "", "url": "https://api.github.com/users/KANGRuipeng", "html_url": "https://github.com/KANGRuipeng", "followers_url": "https://api.github.com/users/KANGRuipeng/followers", "following_url": "https://api.github.com/users/KANGRuipeng/following{/other_user}", "gists_url": "https://api.github.com/users/KANGRuipeng/gists{/gist_id}", "starred_url": "https://api.github.com/users/KANGRuipeng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/KANGRuipeng/subscriptions", "organizations_url": "https://api.github.com/users/KANGRuipeng/orgs", "repos_url": "https://api.github.com/users/KANGRuipeng/repos", "events_url": "https://api.github.com/users/KANGRuipeng/events{/privacy}", "received_events_url": "https://api.github.com/users/KANGRuipeng/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2019-09-18T01:52:35Z", "updated_at": "2019-10-17T03:18:50Z", "closed_at": null, "author_association": "NONE", "body": "Such as:\r\n\r\n1. Global Flow Chart of Tensorflow\r\n2. Graph modify for Model Optimization(Insert an op in backend)\r\n3.  Basic Data Structure(Data management)\r\n4. Detail of Communication for Distribute Strategy"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32571", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32571/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32571/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32571/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32571", "id": 494365519, "node_id": "MDU6SXNzdWU0OTQzNjU1MTk=", "number": 32571, "title": "Expose core/kernels/linalg_ops_common to user_ops", "user": {"login": "csbrown", "id": 1459444, "node_id": "MDQ6VXNlcjE0NTk0NDQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/1459444?v=4", "gravatar_id": "", "url": "https://api.github.com/users/csbrown", "html_url": "https://github.com/csbrown", "followers_url": "https://api.github.com/users/csbrown/followers", "following_url": "https://api.github.com/users/csbrown/following{/other_user}", "gists_url": "https://api.github.com/users/csbrown/gists{/gist_id}", "starred_url": "https://api.github.com/users/csbrown/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/csbrown/subscriptions", "organizations_url": "https://api.github.com/users/csbrown/orgs", "repos_url": "https://api.github.com/users/csbrown/repos", "events_url": "https://api.github.com/users/csbrown/events{/privacy}", "received_events_url": "https://api.github.com/users/csbrown/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-09-17T02:24:18Z", "updated_at": "2019-09-20T18:31:09Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version r1.14:\r\n- Are you willing to contribute it (Yes/No): No.\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\nExpose core/kernels/linalg_ops_common to user applications in core/user_ops.\r\n\r\n**Will this change the current api? How?**\r\n\r\nIt will allow user ops to access [`class LinearAlgebraOp : public OpKernel`](https://github.com/tensorflow/tensorflow/blob/512a3c3a6c0b36f6750394103b7eb316fe4ce853/tensorflow/core/kernels/linalg_ops_common.h#L40)\r\n\r\n**Who will benefit with this feature?**\r\n\r\nUsers writing their own broadcasting ops.\r\n\r\n**Any Other info.**\r\n\r\n[here's an explanation of the whole thing](https://stackoverflow.com/questions/57912754/linking-into-the-tensorflow-framework-libraries/57966486#57966486)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32569", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32569/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32569/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32569/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32569", "id": 494352966, "node_id": "MDU6SXNzdWU0OTQzNTI5NjY=", "number": 32569, "title": "TF GPU doesn't recognise 2nd GPUs", "user": {"login": "cyrus2018", "id": 45702408, "node_id": "MDQ6VXNlcjQ1NzAyNDA4", "avatar_url": "https://avatars3.githubusercontent.com/u/45702408?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cyrus2018", "html_url": "https://github.com/cyrus2018", "followers_url": "https://api.github.com/users/cyrus2018/followers", "following_url": "https://api.github.com/users/cyrus2018/following{/other_user}", "gists_url": "https://api.github.com/users/cyrus2018/gists{/gist_id}", "starred_url": "https://api.github.com/users/cyrus2018/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cyrus2018/subscriptions", "organizations_url": "https://api.github.com/users/cyrus2018/orgs", "repos_url": "https://api.github.com/users/cyrus2018/repos", "events_url": "https://api.github.com/users/cyrus2018/events{/privacy}", "received_events_url": "https://api.github.com/users/cyrus2018/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-09-17T01:27:20Z", "updated_at": "2019-10-08T11:34:10Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10 pro\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary):\r\n- TensorFlow version (use command below): 1.14 GPU\r\n- Python version: 3.7 64 bit\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: 10.1\r\n- GPU model and memory: RTX 1070 (8GB) and GTX 1050 (2GB) , 32 GB Ram, Core i7 9700 k\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nTF GPu wont identify two GPUs, only GPU 0 appears\r\n\r\n**Describe the expected behavior**\r\nI want to see GPU0 and GPU 1 when run the device list command\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\nAfter I install all, The TF GPU does not recognise my 2nd GPU (Nvidia GTX 1050) as GPU:01\r\n![1](https://user-images.githubusercontent.com/45702408/65003983-57204880-d92d-11e9-8706-45c0f98179b1.JPG)\r\nI can switch to that GPU, using Cuda visible devices, however can not use two GPUs  (for multi GPU calculations), any recommendations? \r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32564", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32564/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32564/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32564/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32564", "id": 494284575, "node_id": "MDU6SXNzdWU0OTQyODQ1NzU=", "number": 32564, "title": "model.add_loss no longer works for tf.image.ssim_multiscale in tf 2.1", "user": {"login": "isaacgerg", "id": 11971499, "node_id": "MDQ6VXNlcjExOTcxNDk5", "avatar_url": "https://avatars0.githubusercontent.com/u/11971499?v=4", "gravatar_id": "", "url": "https://api.github.com/users/isaacgerg", "html_url": "https://github.com/isaacgerg", "followers_url": "https://api.github.com/users/isaacgerg/followers", "following_url": "https://api.github.com/users/isaacgerg/following{/other_user}", "gists_url": "https://api.github.com/users/isaacgerg/gists{/gist_id}", "starred_url": "https://api.github.com/users/isaacgerg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/isaacgerg/subscriptions", "organizations_url": "https://api.github.com/users/isaacgerg/orgs", "repos_url": "https://api.github.com/users/isaacgerg/repos", "events_url": "https://api.github.com/users/isaacgerg/events{/privacy}", "received_events_url": "https://api.github.com/users/isaacgerg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2019-09-16T21:24:16Z", "updated_at": "2020-03-13T10:46:04Z", "closed_at": null, "author_association": "NONE", "body": "This tf.keras code was valid in tf 1.13.1:\r\n\r\n`model.add_loss(tf.image.ssim_multiscale(reconstruction.inputs[0], reconstruction.outputs[0], 1.0))`\r\nwith types of reconstruction.inputs[0], reconstruction.outputs[0] being:\r\n```\r\n(<tf.Tensor 'input_1:0' shape=(?, 256, 256, 1) dtype=float32>,\r\n <tf.Tensor 'reconstruction_/truediv:0' shape=(?, 256, 256, 1) dtype=float32>)\r\n```\r\n\r\nbut is no longer valid in tf 1.14.0 or 1.15.0rc0:\r\n\r\n```\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.\r\n(0) Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,256,256,1]\r\n[[{{node input_1}}]]\r\n[[MS-SSIM_1/Scale1/cond/Pad/paddings/_3891]]\r\n(1) Invalid argument: You must feed a value for placeholder tensor 'input_1' with dtype float and shape [?,256,256,1]\r\n[[{{node input_1}}]]\r\n0 successful operations.\r\n0 derived errors ignored.\r\n```\r\n\r\nI can not find any documentation on this change or how to fix it in the newer tf versions."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32557", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32557/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32557/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32557/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32557", "id": 494173995, "node_id": "MDU6SXNzdWU0OTQxNzM5OTU=", "number": 32557, "title": "python kernel restart when training xgboost estimator", "user": {"login": "netskink", "id": 4422172, "node_id": "MDQ6VXNlcjQ0MjIxNzI=", "avatar_url": "https://avatars0.githubusercontent.com/u/4422172?v=4", "gravatar_id": "", "url": "https://api.github.com/users/netskink", "html_url": "https://github.com/netskink", "followers_url": "https://api.github.com/users/netskink/followers", "following_url": "https://api.github.com/users/netskink/following{/other_user}", "gists_url": "https://api.github.com/users/netskink/gists{/gist_id}", "starred_url": "https://api.github.com/users/netskink/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/netskink/subscriptions", "organizations_url": "https://api.github.com/users/netskink/orgs", "repos_url": "https://api.github.com/users/netskink/repos", "events_url": "https://api.github.com/users/netskink/events{/privacy}", "received_events_url": "https://api.github.com/users/netskink/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, {"login": "yhliang2018", "id": 36285763, "node_id": "MDQ6VXNlcjM2Mjg1NzYz", "avatar_url": "https://avatars1.githubusercontent.com/u/36285763?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yhliang2018", "html_url": "https://github.com/yhliang2018", "followers_url": "https://api.github.com/users/yhliang2018/followers", "following_url": "https://api.github.com/users/yhliang2018/following{/other_user}", "gists_url": "https://api.github.com/users/yhliang2018/gists{/gist_id}", "starred_url": "https://api.github.com/users/yhliang2018/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yhliang2018/subscriptions", "organizations_url": "https://api.github.com/users/yhliang2018/orgs", "repos_url": "https://api.github.com/users/yhliang2018/repos", "events_url": "https://api.github.com/users/yhliang2018/events{/privacy}", "received_events_url": "https://api.github.com/users/yhliang2018/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 32, "created_at": "2019-09-16T17:13:28Z", "updated_at": "2020-02-21T18:43:14Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- I am using a  stock example script provided in TensorFlow):\r\nhttps://www.tensorflow.org/beta/tutorials/estimators/boosted_trees_model_understanding\r\n\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\ndebian linux intel x86_64 \r\n\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\nNA\r\n\r\n- TensorFlow installed from (source or binary):\r\nbinary via\r\npip install of tf2.0.0.rc1\r\n\r\n- TensorFlow version (use command below):\r\ntf2.0.0.rc1\r\n\r\n- Python version:\r\n3.7.4\r\n\r\n- CUDA/cuDNN version:\r\nHow to determine?\r\n- GPU model and memory:\r\nGeForce RTX 2070 8GB\r\n\r\nv2.0.0-rc0-101-gd2d2566 2.0.0-rc1\r\n\r\n\r\n> == check python ===================================================\r\n> python version: 3.7.4\r\n> python branch: \r\n> python build version: ('default', 'Aug 13 2019 20:35:49')\r\n> python compiler version: GCC 7.3.0\r\n> python implementation: CPython\r\n> \r\n> \r\n> == check os platform ===============================================\r\n> os: Linux\r\n> os kernel version: #1 SMP Debian 4.19.37-5+deb10u2 (2019-08-08)\r\n> os release version: 4.19.0-5-amd64\r\n> os platform: Linux-4.19.0-5-amd64-x86_64-with-debian-10.1\r\n> linux distribution: ('debian', '10.1', '')\r\n> linux os distribution: ('debian', '10.1', '')\r\n> mac version: ('', ('', '', ''), '')\r\n> uname: uname_result(system='Linux', node='gsd', release='4.19.0-5-amd64', version='#1 SMP Debian 4.19.37-5+deb10u2 (2019-08-08)', machine='x86_64', processor='')\r\n> architecture: ('64bit', '')\r\n> machine: x86_64\r\n> \r\n> \r\n> == are we in docker =============================================\r\n> No\r\n> \r\n> == compiler =====================================================\r\n> c++ (Debian 8.3.0-6) 8.3.0\r\n> Copyright (C) 2018 Free Software Foundation, Inc.\r\n> This is free software; see the source for copying conditions.  There is NO\r\n> warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n> \r\n> \r\n> == check pips ===================================================\r\n> numpy                1.17.2              \r\n> protobuf             3.9.1               \r\n> tensorflow           2.0.0rc1            \r\n> \r\n> == check for virtualenv =========================================\r\n> False\r\n> \r\n> == tensorflow import ============================================\r\n> tf.version.VERSION = 2.0.0-rc1\r\n> tf.version.GIT_VERSION = v2.0.0-rc0-101-gd2d2566\r\n> tf.version.COMPILER_VERSION = 7.3.1 20180303\r\n>      22191:\tfind library=libpthread.so.0 [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/bin/../lib/tls/haswell/x86_64:/home/davis/anaconda3/envs/py3tf2/bin/../lib/tls/haswell:/home/davis/anaconda3/envs/py3tf2/bin/../lib/tls/x86_64:/home/davis/anaconda3/envs/py3tf2/bin/../lib/tls:/home/davis/anaconda3/envs/py3tf2/bin/../lib/haswell/x86_64:/home/davis/anaconda3/envs/py3tf2/bin/../lib/haswell:/home/davis/anaconda3/envs/py3tf2/bin/../lib/x86_64:/home/davis/anaconda3/envs/py3tf2/bin/../lib\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/bin/python)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/bin/../lib/tls/haswell/x86_64/libpthread.so.0\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/bin/../lib/tls/haswell/libpthread.so.0\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/bin/../lib/tls/x86_64/libpthread.so.0\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/bin/../lib/tls/libpthread.so.0\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/bin/../lib/haswell/x86_64/libpthread.so.0\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/bin/../lib/haswell/libpthread.so.0\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/bin/../lib/x86_64/libpthread.so.0\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/bin/../lib/libpthread.so.0\r\n>      22191:\t search cache=/etc/ld.so.cache\r\n>      22191:\t  trying file=/lib/x86_64-linux-gnu/libpthread.so.0\r\n>      22191:\t\r\n>      22191:\tfind library=libc.so.6 [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/bin/../lib\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/bin/python)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/bin/../lib/libc.so.6\r\n>      22191:\t search cache=/etc/ld.so.cache\r\n>      22191:\t  trying file=/lib/x86_64-linux-gnu/libc.so.6\r\n>      22191:\t\r\n>      22191:\tfind library=libdl.so.2 [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/bin/../lib\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/bin/python)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/bin/../lib/libdl.so.2\r\n>      22191:\t search cache=/etc/ld.so.cache\r\n>      22191:\t  trying file=/lib/x86_64-linux-gnu/libdl.so.2\r\n>      22191:\t\r\n>      22191:\tfind library=libutil.so.1 [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/bin/../lib\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/bin/python)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/bin/../lib/libutil.so.1\r\n>      22191:\t search cache=/etc/ld.so.cache\r\n>      22191:\t  trying file=/lib/x86_64-linux-gnu/libutil.so.1\r\n>      22191:\t\r\n>      22191:\tfind library=librt.so.1 [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/bin/../lib\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/bin/python)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/bin/../lib/librt.so.1\r\n>      22191:\t search cache=/etc/ld.so.cache\r\n>      22191:\t  trying file=/lib/x86_64-linux-gnu/librt.so.1\r\n>      22191:\t\r\n>      22191:\tfind library=libm.so.6 [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/bin/../lib\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/bin/python)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/bin/../lib/libm.so.6\r\n>      22191:\t search cache=/etc/ld.so.cache\r\n>      22191:\t  trying file=/lib/x86_64-linux-gnu/libm.so.6\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /lib/x86_64-linux-gnu/libpthread.so.0\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /lib/x86_64-linux-gnu/libc.so.6\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /lib/x86_64-linux-gnu/libm.so.6\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /lib/x86_64-linux-gnu/librt.so.1\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /lib/x86_64-linux-gnu/libutil.so.1\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /lib/x86_64-linux-gnu/libdl.so.2\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tinitialize program: /home/davis/anaconda3/envs/py3tf2/bin/python\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\ttransferring control: /home/davis/anaconda3/envs/py3tf2/bin/python\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_heapq.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_opcode.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\tfind library=libffi.so.6 [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../tls/haswell/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../tls/haswell:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../tls/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../tls:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../haswell/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../haswell:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../..\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_ctypes.cpython-37m-x86_64-linux-gnu.so)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../tls/haswell/x86_64/libffi.so.6\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../tls/haswell/libffi.so.6\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../tls/x86_64/libffi.so.6\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../tls/libffi.so.6\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../haswell/x86_64/libffi.so.6\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../haswell/libffi.so.6\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../x86_64/libffi.so.6\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../libffi.so.6\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../libffi.so.6\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_ctypes.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_struct.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\tfind library=libmkl_rt.so [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../tls/haswell/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../tls/haswell:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../tls/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../tls:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../haswell/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../haswell:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../..\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/_mklinit.cpython-37m-x86_64-linux-gnu.so)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../tls/haswell/x86_64/libmkl_rt.so\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../tls/haswell/libmkl_rt.so\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../tls/x86_64/libmkl_rt.so\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../tls/libmkl_rt.so\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../haswell/x86_64/libmkl_rt.so\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../haswell/libmkl_rt.so\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../x86_64/libmkl_rt.so\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../libmkl_rt.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../libmkl_rt.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/_mklinit.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/_mklinit.cpython-37m-x86_64-linux-gnu.so: error: symbol lookup error: undefined symbol: omp_get_num_threads (fatal)\r\n>      22191:\tfind library=libiomp5.so [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../..\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/_mklinit.cpython-37m-x86_64-linux-gnu.so)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../libiomp5.so\r\n>      22191:\t\r\n>      22191:\tfind library=libgcc_s.so.1 [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/bin/../lib\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/bin/python)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/bin/../lib/libgcc_s.so.1\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/bin/../lib/libgcc_s.so.1\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../libiomp5.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/core/_multiarray_umath.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/math.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_datetime.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_pickle.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/core/_multiarray_tests.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/linalg/lapack_lite.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/linalg/_umath_linalg.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\tfind library=libz.so.1 [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../..\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_ctypes.cpython-37m-x86_64-linux-gnu.so)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../libz.so.1\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../libz.so.1\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/zlib.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_bz2.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\tfind library=liblzma.so.5 [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../..\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_ctypes.cpython-37m-x86_64-linux-gnu.so)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../liblzma.so.5\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../liblzma.so.5\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_lzma.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/grp.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_decimal.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/fft/fftpack_lite.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/mkl_fft/_pydfti.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/random/mtrand.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\tfind library=libcrypto.so.1.1 [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../..\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_ctypes.cpython-37m-x86_64-linux-gnu.so)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../libcrypto.so.1.1\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../libcrypto.so.1.1\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_hashlib.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_blake2.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_sha3.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_bisect.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_random.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../libmkl_core.so\r\n>      22191:\t\r\n>      22191:\tfind library=libittnotify.so [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/bin/../lib\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/bin/python)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/bin/../lib/libittnotify.so\r\n>      22191:\t search cache=/etc/ld.so.cache\r\n>      22191:\t search path=/lib/x86_64-linux-gnu/tls/haswell/x86_64:/lib/x86_64-linux-gnu/tls/haswell:/lib/x86_64-linux-gnu/tls/x86_64:/lib/x86_64-linux-gnu/tls:/lib/x86_64-linux-gnu/haswell/x86_64:/lib/x86_64-linux-gnu/haswell:/lib/x86_64-linux-gnu/x86_64:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu/tls/haswell/x86_64:/usr/lib/x86_64-linux-gnu/tls/haswell:/usr/lib/x86_64-linux-gnu/tls/x86_64:/usr/lib/x86_64-linux-gnu/tls:/usr/lib/x86_64-linux-gnu/haswell/x86_64:/usr/lib/x86_64-linux-gnu/haswell:/usr/lib/x86_64-linux-gnu/x86_64:/usr/lib/x86_64-linux-gnu:/lib/tls/haswell/x86_64:/lib/tls/haswell:/lib/tls/x86_64:/lib/tls:/lib/haswell/x86_64:/lib/haswell:/lib/x86_64:/lib:/usr/lib/tls/haswell/x86_64:/usr/lib/tls/haswell:/usr/lib/tls/x86_64:/usr/lib/tls:/usr/lib/haswell/x86_64:/usr/lib/haswell:/usr/lib/x86_64:/usr/lib\t\t(system search path)\r\n>      22191:\t  trying file=/lib/x86_64-linux-gnu/tls/haswell/x86_64/libittnotify.so\r\n>      22191:\t  trying file=/lib/x86_64-linux-gnu/tls/haswell/libittnotify.so\r\n>      22191:\t  trying file=/lib/x86_64-linux-gnu/tls/x86_64/libittnotify.so\r\n>      22191:\t  trying file=/lib/x86_64-linux-gnu/tls/libittnotify.so\r\n>      22191:\t  trying file=/lib/x86_64-linux-gnu/haswell/x86_64/libittnotify.so\r\n>      22191:\t  trying file=/lib/x86_64-linux-gnu/haswell/libittnotify.so\r\n>      22191:\t  trying file=/lib/x86_64-linux-gnu/x86_64/libittnotify.so\r\n>      22191:\t  trying file=/lib/x86_64-linux-gnu/libittnotify.so\r\n>      22191:\t  trying file=/usr/lib/x86_64-linux-gnu/tls/haswell/x86_64/libittnotify.so\r\n>      22191:\t  trying file=/usr/lib/x86_64-linux-gnu/tls/haswell/libittnotify.so\r\n>      22191:\t  trying file=/usr/lib/x86_64-linux-gnu/tls/x86_64/libittnotify.so\r\n>      22191:\t  trying file=/usr/lib/x86_64-linux-gnu/tls/libittnotify.so\r\n>      22191:\t  trying file=/usr/lib/x86_64-linux-gnu/haswell/x86_64/libittnotify.so\r\n>      22191:\t  trying file=/usr/lib/x86_64-linux-gnu/haswell/libittnotify.so\r\n>      22191:\t  trying file=/usr/lib/x86_64-linux-gnu/x86_64/libittnotify.so\r\n>      22191:\t  trying file=/usr/lib/x86_64-linux-gnu/libittnotify.so\r\n>      22191:\t  trying file=/lib/tls/haswell/x86_64/libittnotify.so\r\n>      22191:\t  trying file=/lib/tls/haswell/libittnotify.so\r\n>      22191:\t  trying file=/lib/tls/x86_64/libittnotify.so\r\n>      22191:\t  trying file=/lib/tls/libittnotify.so\r\n>      22191:\t  trying file=/lib/haswell/x86_64/libittnotify.so\r\n>      22191:\t  trying file=/lib/haswell/libittnotify.so\r\n>      22191:\t  trying file=/lib/x86_64/libittnotify.so\r\n>      22191:\t  trying file=/lib/libittnotify.so\r\n>      22191:\t  trying file=/usr/lib/tls/haswell/x86_64/libittnotify.so\r\n>      22191:\t  trying file=/usr/lib/tls/haswell/libittnotify.so\r\n>      22191:\t  trying file=/usr/lib/tls/x86_64/libittnotify.so\r\n>      22191:\t  trying file=/usr/lib/tls/libittnotify.so\r\n>      22191:\t  trying file=/usr/lib/haswell/x86_64/libittnotify.so\r\n>      22191:\t  trying file=/usr/lib/haswell/libittnotify.so\r\n>      22191:\t  trying file=/usr/lib/x86_64/libittnotify.so\r\n>      22191:\t  trying file=/usr/lib/libittnotify.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../libmkl_intel_thread.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../libmkl_intel_lp64.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../libmkl_avx2.so\r\n>      22191:\t\r\n>      22191:\tfind library=libtensorflow_framework.so.2 [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/tls/haswell/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/tls/haswell:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/tls/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/tls:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/haswell/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/haswell:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/tls/haswell/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/tls/haswell:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/tls/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/tls:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/haswell/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/haswell:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../tls/haswell/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../tls/haswell:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../tls/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../tls:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../haswell/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../haswell:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/..\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/tls/haswell/x86_64/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/tls/haswell/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/tls/x86_64/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/tls/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/haswell/x86_64/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/haswell/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/x86_64/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../../_solib_local/_U_S_Stensorflow_Spython_C_Upywrap_Utensorflow_Uinternal.so___Utensorflow/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/tls/haswell/x86_64/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/tls/haswell/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/tls/x86_64/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/tls/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/haswell/x86_64/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/haswell/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/x86_64/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../tls/haswell/x86_64/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../tls/haswell/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../tls/x86_64/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../tls/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../haswell/x86_64/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../haswell/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../x86_64/libtensorflow_framework.so.2\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../libtensorflow_framework.so.2\r\n>      22191:\t\r\n>      22191:\tfind library=libstdc++.so.6 [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/..\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/libstdc++.so.6\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../libstdc++.so.6\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/bin/../lib\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/bin/python)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/bin/../lib/libstdc++.so.6\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/bin/../lib/libstdc++.so.6\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../libtensorflow_framework.so.2\r\n>      22191:\t\r\n>      22191:\tfind library=libhdfs.so [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/..\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../libhdfs.so\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/..\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/libhdfs.so\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../libhdfs.so\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/bin/../lib\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/bin/python)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/bin/../lib/libhdfs.so\r\n>      22191:\t search cache=/etc/ld.so.cache\r\n>      22191:\t search path=/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/lib:/usr/lib\t\t(system search path)\r\n>      22191:\t  trying file=/lib/x86_64-linux-gnu/libhdfs.so\r\n>      22191:\t  trying file=/usr/lib/x86_64-linux-gnu/libhdfs.so\r\n>      22191:\t  trying file=/lib/libhdfs.so\r\n>      22191:\t  trying file=/usr/lib/libhdfs.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/binascii.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_posixsubprocess.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/select.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/pyexpat.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_socket.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_csv.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/fcntl.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/termios.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/framework/fast_tensor_util.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_queue.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/wrapt/_wrappers.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_json.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\tfind library=libssl.so.1.1 [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../..\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_ctypes.cpython-37m-x86_64-linux-gnu.so)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../libssl.so.1.1\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../libssl.so.1.1\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_ssl.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/array.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\tfind library=libhdf5-978d01a9.so.103.0.0 [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/tls/haswell/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/tls/haswell:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/tls/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/tls:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/haswell/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/haswell:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/_errors.cpython-37m-x86_64-linux-gnu.so)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/tls/haswell/x86_64/libhdf5-978d01a9.so.103.0.0\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/tls/haswell/libhdf5-978d01a9.so.103.0.0\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/tls/x86_64/libhdf5-978d01a9.so.103.0.0\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/tls/libhdf5-978d01a9.so.103.0.0\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/haswell/x86_64/libhdf5-978d01a9.so.103.0.0\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/haswell/libhdf5-978d01a9.so.103.0.0\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/x86_64/libhdf5-978d01a9.so.103.0.0\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/libhdf5-978d01a9.so.103.0.0\r\n>      22191:\t\r\n>      22191:\tfind library=libhdf5_hl-db841637.so.100.1.1 [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/_errors.cpython-37m-x86_64-linux-gnu.so)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/libhdf5_hl-db841637.so.100.1.1\r\n>      22191:\t\r\n>      22191:\tfind library=libsz-1c7dd0cf.so.2.0.1 [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./tls/haswell/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./tls/haswell:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./tls/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./tls:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./haswell/x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./haswell:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./x86_64:/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/.\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/libhdf5-978d01a9.so.103.0.0)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./tls/haswell/x86_64/libsz-1c7dd0cf.so.2.0.1\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./tls/haswell/libsz-1c7dd0cf.so.2.0.1\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./tls/x86_64/libsz-1c7dd0cf.so.2.0.1\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./tls/libsz-1c7dd0cf.so.2.0.1\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./haswell/x86_64/libsz-1c7dd0cf.so.2.0.1\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./haswell/libsz-1c7dd0cf.so.2.0.1\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./x86_64/libsz-1c7dd0cf.so.2.0.1\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./libsz-1c7dd0cf.so.2.0.1\r\n>      22191:\t\r\n>      22191:\tfind library=libaec-2147abcd.so.0.0.4 [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/.\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/libhdf5-978d01a9.so.103.0.0)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./libaec-2147abcd.so.0.0.4\r\n>      22191:\t\r\n>      22191:\tfind library=libz-a147dcb0.so.1.2.3 [0]; searching\r\n>      22191:\t search path=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/.\t\t(RPATH from file /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/libhdf5-978d01a9.so.103.0.0)\r\n>      22191:\t  trying file=/home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./libz-a147dcb0.so.1.2.3\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./libz-a147dcb0.so.1.2.3\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./libaec-2147abcd.so.0.0.4\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./libsz-1c7dd0cf.so.2.0.1\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/libhdf5-978d01a9.so.103.0.0\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/libhdf5_hl-db841637.so.100.1.1\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/_errors.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/defs.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/_objects.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/_conv.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5r.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5t.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/utils.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22192:\tfind library=libc.so.6 [0]; searching\r\n>      22192:\t search cache=/etc/ld.so.cache\r\n>      22192:\t  trying file=/lib/x86_64-linux-gnu/libc.so.6\r\n>      22192:\t\r\n>      22192:\t\r\n>      22192:\tcalling init: /lib/x86_64-linux-gnu/libc.so.6\r\n>      22192:\t\r\n>      22192:\t\r\n>      22192:\tinitialize program: /bin/sh\r\n>      22192:\t\r\n>      22192:\t\r\n>      22192:\ttransferring control: /bin/sh\r\n>      22192:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5z.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5a.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5s.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5p.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5ac.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/_proxy.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5d.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5ds.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5f.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5g.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5i.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5fd.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5pl.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5o.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5l.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/lite/experimental/microfrontend/python/ops/_audio_microfrontend_op.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/conversion.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/c_timestamp.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/nattype.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/np_datetime.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/timezones.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/tzconversion.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/timedeltas.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/offsets.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/ccalendar.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/strptime.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/fields.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/parsing.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/period.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/frequencies.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/timestamps.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/resolution.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/hashtable.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/missing.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/lib.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslib.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/algos.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/interval.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/properties.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/hashing.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/ops.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/index.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/join.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/sparse.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/indexing.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/internals.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/unicodedata.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/mmap.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/reshape.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/window.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/skiplist.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/groupby.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/reduction.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/parsers.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/json.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/writers.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/util/_move.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/io/msgpack/_packer.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/io/msgpack/_unpacker.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling init: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/testing.cpython-37m-x86_64-linux-gnu.so\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/bin/python [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /lib/x86_64-linux-gnu/libutil.so.1 [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_heapq.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_opcode.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_ctypes.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../libffi.so.6 [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_struct.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/_mklinit.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../libiomp5.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/core/_multiarray_umath.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/math.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_datetime.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_pickle.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/core/_multiarray_tests.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/linalg/lapack_lite.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/linalg/_umath_linalg.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/zlib.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_bz2.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_lzma.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../liblzma.so.5 [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/grp.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_decimal.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/fft/fftpack_lite.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/mkl_fft/_pydfti.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/random/mtrand.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_hashlib.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_blake2.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_sha3.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_bisect.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_random.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../libmkl_intel_lp64.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../libmkl_avx2.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../libmkl_intel_thread.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../libmkl_core.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/numpy/../../../libmkl_rt.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/binascii.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../libz.so.1 [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_posixsubprocess.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/select.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/pyexpat.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_socket.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_csv.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/fcntl.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/termios.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/framework/fast_tensor_util.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_queue.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/wrapt/_wrappers.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_json.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/_ssl.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../libssl.so.1.1 [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/../../libcrypto.so.1.1 [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/array.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/_errors.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/defs.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/_objects.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/_conv.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5r.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5t.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/utils.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5z.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5a.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5s.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5p.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5ac.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/_proxy.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5d.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5ds.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5f.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5g.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5i.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5fd.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5pl.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5o.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/h5l.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/libhdf5_hl-db841637.so.100.1.1 [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/libhdf5-978d01a9.so.103.0.0 [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./libz-a147dcb0.so.1.2.3 [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./libsz-1c7dd0cf.so.2.0.1 [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/h5py/.libs/./libaec-2147abcd.so.0.0.4 [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/lite/experimental/microfrontend/python/ops/_audio_microfrontend_op.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/../libtensorflow_framework.so.2 [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /lib/x86_64-linux-gnu/librt.so.1 [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /lib/x86_64-linux-gnu/libdl.so.2 [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/conversion.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/c_timestamp.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/nattype.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/np_datetime.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/timezones.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/tzconversion.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/timedeltas.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/offsets.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/ccalendar.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/strptime.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/fields.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/parsing.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/period.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/frequencies.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/timestamps.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslibs/resolution.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/hashtable.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/missing.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/lib.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/tslib.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/algos.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/interval.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/properties.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/hashing.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/ops.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/index.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/join.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/sparse.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/indexing.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/internals.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/unicodedata.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/lib-dynload/mmap.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/reshape.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/window.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/bin/../lib/libstdc++.so.6 [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/bin/../lib/libgcc_s.so.1 [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /lib/x86_64-linux-gnu/libm.so.6 [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/skiplist.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/groupby.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/reduction.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/parsers.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/json.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/writers.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/util/_move.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/io/msgpack/_packer.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/io/msgpack/_unpacker.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/pandas/_libs/testing.cpython-37m-x86_64-linux-gnu.so [0]\r\n>      22191:\t\r\n>      22191:\t\r\n>      22191:\tcalling fini: /lib/x86_64-linux-gnu/libpthread.so.0 [0]\r\n>      22191:\t\r\n> \r\n> == env ==========================================================\r\n> LD_LIBRARY_PATH is unset\r\n> DYLD_LIBRARY_PATH is unset\r\n> \r\n> == nvidia-smi ===================================================\r\n> Mon Sep 16 13:02:01 2019       \r\n> +-----------------------------------------------------------------------------+\r\n> | NVIDIA-SMI 418.74       Driver Version: 418.74       CUDA Version: 10.1     |\r\n> |-------------------------------+----------------------+----------------------+\r\n> | GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n> | Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n> |===============================+======================+======================|\r\n> |   0  GeForce RTX 2070    On   | 00000000:01:00.0  On |                  N/A |\r\n> | 38%   30C    P8    14W / 175W |   1249MiB /  7949MiB |      6%      Default |\r\n> +-------------------------------+----------------------+----------------------+\r\n>                                                                                \r\n> +-----------------------------------------------------------------------------+\r\n> | Processes:                                                       GPU Memory |\r\n> |  GPU       PID   Type   Process name                             Usage      |\r\n> |=============================================================================|\r\n> |    0       814      G   /usr/lib/xorg/Xorg                            34MiB |\r\n> |    0       948      G   /usr/bin/gnome-shell                          24MiB |\r\n> |    0      1171      G   /usr/lib/xorg/Xorg                           217MiB |\r\n> |    0      1250      G   /usr/bin/gnome-shell                         176MiB |\r\n> |    0      1551      G   ...uest-channel-token=12821291265308298198     8MiB |\r\n> |    0      2551      G   ...equest-channel-token=447657113308850378   786MiB |\r\n> +-----------------------------------------------------------------------------+\r\n> \r\n> == cuda libs  ===================================================\r\n> \r\n> == tensorflow installed from info ==================\r\n> Name: tensorflow\r\n> Version: 2.0.0rc1\r\n> Summary: TensorFlow is an open source machine learning framework for everyone.\r\n> Home-page: https://www.tensorflow.org/\r\n> Author-email: packages@tensorflow.org\r\n> License: Apache 2.0\r\n> Location: /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages\r\n> Required-by: \r\n> \r\n> == python version  ==============================================\r\n> (major, minor, micro, releaselevel, serial)\r\n> (3, 7, 4, 'final', 0)\r\n> \r\n> == bazel version  ===============================================\r\n> \r\n\r\n**Describe the current behavior**\r\n\r\nDuring the train of the xgboosted tree, the kernel will abort and halt.\r\n\r\n**Describe the expected behavior**\r\n\r\nThat the python kernel operate normally.\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n> import numpy as np\r\n> import pandas as pd\r\n> import tensorflow as tf\r\n> import ssl\r\n> dftrain = pd.read_csv('https://storage.googleapis.com/tf-datasets/titanic/train.csv')\r\n> dfeval = pd.read_csv('https://storage.googleapis.com/tf-datasets/titanic/eval.csv')\r\n> y_train = dftrain.pop('survived')\r\n> y_eval = dfeval.pop('survived')\r\n> try:\r\n>   %tensorflow_version 2.x\r\n> except Exception:\r\n>   pass\r\n> import tensorflow as tf\r\n> tf.random.set_seed(123)\r\n> print( \"tensorflow version = {}\".format(tf.version))\r\n> import platform\r\n> print(platform.python_version())\r\n> vocabulary = dftrain['sex'].unique()\r\n> fc = tf.feature_column\r\n> CATEGORICAL_COLUMNS = ['sex', 'n_siblings_spouses', 'parch', 'class', 'deck', 'embark_town', 'alone']\r\n> NUMERIC_COLUMNS = ['age', 'fare']\r\n>   \r\n> def one_hot_cat_column(feature_name, vocab):\r\n>     return tf.feature_column.indicator_column(\r\n>         tf.feature_column.categorical_column_with_vocabulary_list(feature_name,\r\n>                                                                 vocab))\r\n> feature_columns = []\r\n> for feature_name in CATEGORICAL_COLUMNS:\r\n>     # Need to one-hot encode categorical features.\r\n>     # He finds the unique values in each column and uses that\r\n>     # array as a vocabulary\r\n>     vocabulary = dftrain[feature_name].unique()\r\n>     feature_columns.append(one_hot_cat_column(feature_name, vocabulary))\r\n> \r\n> for feature_name in NUMERIC_COLUMNS:\r\n>     feature_columns.append(tf.feature_column.numeric_column(feature_name,dtype=tf.float32))\r\n> \r\n> example = dict(dftrain.head(1))\r\n> class_fc = tf.feature_column.indicator_column(\r\n>     tf.feature_column.categorical_column_with_vocabulary_list('class', ('First', 'Second', 'Third')))\r\n> print('Feature value: \"{}\"'.format(example['class'].iloc[0]))\r\n> print('One-hot encoded: ', tf.keras.layers.DenseFeatures([class_fc])(example).numpy())\r\n> \r\n> # Use entire batch since this is such a small dataset.\r\n> NUM_EXAMPLES = len(y_train)\r\n> \r\n> def make_input_fn(X, y, n_epochs=None, shuffle=True):\r\n>   def input_fn():\r\n>     dataset = tf.data.Dataset.from_tensor_slices((dict(X), y))\r\n>     if shuffle:\r\n>       dataset = dataset.shuffle(NUM_EXAMPLES)\r\n>     # For training, cycle thru dataset as many times as need (n_epochs=None).    \r\n>     dataset = dataset.repeat(n_epochs)\r\n>     # In memory training doesn't use batching.\r\n>     dataset = dataset.batch(NUM_EXAMPLES)\r\n>     return dataset\r\n>   return input_fn\r\n> \r\n> # Training and evaluation input functions.\r\n> train_input_fn = make_input_fn(dftrain, y_train)\r\n> eval_input_fn = make_input_fn(dfeval, y_eval, shuffle=False, n_epochs=1)\r\n> linear_est = tf.estimator.LinearClassifier(feature_columns)\r\n> \r\n> # Train model.\r\n> linear_est.train(train_input_fn, max_steps=100)\r\n> \r\n> # Evaluation.\r\n> result = linear_est.evaluate(eval_input_fn)\r\n> \r\n> # Since data fits into memory, use entire dataset per layer. It will be faster.\r\n> # Above one batch is defined as the entire dataset. \r\n> n_batches = 1\r\n> est = tf.estimator.BoostedTreesClassifier(feature_columns,\r\n>                                           n_batches_per_layer=n_batches)\r\n> \r\n> # The model will stop training once the specified number of trees is built, not \r\n> # based on the number of steps.\r\n> est.train(train_input_fn, max_steps=100)   ##### <<<<<---- this kills notebook kernel\r\n> \r\n> \r\n\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\nOutput of the est.train call at end of sample script.  This output is generated and then the jupyter notebook will pop up a dialog which says kernel has stopped.\r\n\r\n> INFO:tensorflow:Calling model_fn.\r\n> WARNING:tensorflow:From /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/feature_column/feature_column.py:2158: NumericColumn._transform_feature (from tensorflow.python.feature_column.feature_column_v2) is deprecated and will be removed in a future version.\r\n> Instructions for updating:\r\n> The old _FeatureColumn APIs are being deprecated. Please use the new FeatureColumn APIs instead.\r\n> WARNING:tensorflow:From /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/feature_column/feature_column.py:2158: IndicatorColumn._transform_feature (from tensorflow.python.feature_column.feature_column_v2) is deprecated and will be removed in a future version.\r\n> Instructions for updating:\r\n> The old _FeatureColumn APIs are being deprecated. Please use the new FeatureColumn APIs instead.\r\n> WARNING:tensorflow:From /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/feature_column/feature_column_v2.py:4302: VocabularyListCategoricalColumn._get_sparse_tensors (from tensorflow.python.feature_column.feature_column_v2) is deprecated and will be removed in a future version.\r\n> Instructions for updating:\r\n> The old _FeatureColumn APIs are being deprecated. Please use the new FeatureColumn APIs instead.\r\n> WARNING:tensorflow:From /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_core/python/feature_column/feature_column.py:2158: VocabularyListCategoricalColumn._transform_feature (from tensorflow.python.feature_column.feature_column_v2) is deprecated and will be removed in a future version.\r\n> Instructions for updating:\r\n> The old _FeatureColumn APIs are being deprecated. Please use the new FeatureColumn APIs instead.\r\n> WARNING:tensorflow:From /home/davis/anaconda3/envs/py3tf2/lib/python3.7/site-packages/tensorflow_estimator/python/estimator/canned/boosted_trees.py:161: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\r\n> Instructions for updating:\r\n> Use `tf.cast` instead.\r\n> INFO:tensorflow:Done calling model_fn.\r\n> INFO:tensorflow:Create CheckpointSaverHook.\r\n> WARNING:tensorflow:Issue encountered when serializing resources.\r\n> Type is unsupported, or the types of the items don't match field type in CollectionDef. Note this is a warning and probably safe to ignore.\r\n> '_Resource' object has no attribute 'name'\r\n> INFO:tensorflow:Graph was finalized.\r\n> INFO:tensorflow:Running local_init_op.\r\n> INFO:tensorflow:Done running local_init_op.\r\n> WARNING:tensorflow:Issue encountered when serializing resources.\r\n> Type is unsupported, or the types of the items don't match field type in CollectionDef. Note this is a warning and probably safe to ignore.\r\n> '_Resource' object has no attribute 'name'\r\n> INFO:tensorflow:Saving checkpoints for 0 into /tmp/tmpr2q3edmx/model.ckpt.\r\n> WARNING:tensorflow:Issue encountered when serializing resources.\r\n> Type is unsupported, or the types of the items don't match field type in CollectionDef. Note this is a warning and probably safe to ignore.\r\n> '_Resource' object has no attribute 'name'\r\n> INFO:tensorflow:loss = 0.6931468, step = 0\r\n> WARNING:tensorflow:It seems that global step (tf.train.get_global_step) has not been increased. Current value (could be stable): 0 vs previous value: 0. You could increase the global step by passing tf.train.get_global_step() to Optimizer.apply_gradients or Optimizer.minimize.\r\n> \u200b"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32556", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32556/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32556/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32556/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32556", "id": 494171720, "node_id": "MDU6SXNzdWU0OTQxNzE3MjA=", "number": 32556, "title": "Bazel workspace.bzl requires a dependency on rules_closure", "user": {"login": "alexeagle", "id": 47395, "node_id": "MDQ6VXNlcjQ3Mzk1", "avatar_url": "https://avatars2.githubusercontent.com/u/47395?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexeagle", "html_url": "https://github.com/alexeagle", "followers_url": "https://api.github.com/users/alexeagle/followers", "following_url": "https://api.github.com/users/alexeagle/following{/other_user}", "gists_url": "https://api.github.com/users/alexeagle/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexeagle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexeagle/subscriptions", "organizations_url": "https://api.github.com/users/alexeagle/orgs", "repos_url": "https://api.github.com/users/alexeagle/repos", "events_url": "https://api.github.com/users/alexeagle/events{/privacy}", "received_events_url": "https://api.github.com/users/alexeagle/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1222092379, "node_id": "MDU6TGFiZWwxMjIyMDkyMzc5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:bazel", "name": "subtype:bazel", "color": "b619ea", "default": false, "description": "Bazel related Build_Installation issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-09-16T17:07:56Z", "updated_at": "2019-10-12T06:25:13Z", "closed_at": null, "author_association": "NONE", "body": "Per https://stackoverflow.com/questions/52482972/running-load-within-skylark-macro\r\nusers of Tensorflow are adding rules_closure to their `WORKSPACE` file even though they don't use it.\r\n\r\nrules_closure is minimally maintained (my team has just acquired it). We don't want new dependencies on it and have discovered that most dependencies are due to this issue.\r\n\r\nI suspect the Tensorflow users don't actually want to build a Closure Compiler-minified UI, so any `load()` statement from rules_closure doesn't belong in the tensorflow bazel rules distribution.\r\n\r\nNote, #15997 suggests customizing the dependencies, but in this issue I propose that users should never observe this dependency at all."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32550", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32550/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32550/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32550/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32550", "id": 493885303, "node_id": "MDU6SXNzdWU0OTM4ODUzMDM=", "number": 32550, "title": "Timeline reports incorrect GPU memory usage", "user": {"login": "smr97", "id": 18290261, "node_id": "MDQ6VXNlcjE4MjkwMjYx", "avatar_url": "https://avatars0.githubusercontent.com/u/18290261?v=4", "gravatar_id": "", "url": "https://api.github.com/users/smr97", "html_url": "https://github.com/smr97", "followers_url": "https://api.github.com/users/smr97/followers", "following_url": "https://api.github.com/users/smr97/following{/other_user}", "gists_url": "https://api.github.com/users/smr97/gists{/gist_id}", "starred_url": "https://api.github.com/users/smr97/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/smr97/subscriptions", "organizations_url": "https://api.github.com/users/smr97/orgs", "repos_url": "https://api.github.com/users/smr97/repos", "events_url": "https://api.github.com/users/smr97/events{/privacy}", "received_events_url": "https://api.github.com/users/smr97/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-09-16T07:19:10Z", "updated_at": "2019-12-18T17:25:47Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): conda (binary)\r\n- TensorFlow version (use command below): 1.14 gpu\r\n- Python version: 3.6.7\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: 10.0\r\n- GPU model and memory:\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\n\r\nMy objective is to measure the amount of GPU memory needed by BERT during the inference process. I have already set the TF_FORCE_GPU_ALLOW_GROWTH (or a paraphrase thereof, I don't remember the exact flag) to true. NVIDIA-SMI shows a usage of ~2500 MB for a batch size of 227. \r\n\r\n1. Even if the allow growth is true, the tensorflow allocation is taking place in steps. I see the same peak usage in nvidia-smi for batch sizes 16, 32, 64 and then it jumps up suddenly. Usage for batch sizes 128 through 227 is as above, while for batch size 228, it is suddenly 4495MB. Hence, this measurement does not serve my purpose. It clearly depends more on the allocator behaviour than the network size + activations size.\r\n\r\n2. Timeline visualisation in chrome trace format shows a peak allocation on GPU_0_bfc as ~418MB for a batch size of 227. This is way too low. If I compare it with nvidia-smi trace (peaking at ~2500MB) this makes no sense.\r\n\r\n3. Tensorboard visualisation somehow shows the BERT node as using 175MB. Again, it makes no sense.\r\n\r\n**Describe the expected behavior**\r\nPlease help me get an accurate measurement of how much memory my current model and batch size is really taking to run on a GPU with TF. The only trustworthy metric I see in this labyrinth is nvidia-smi, but only for the batch sizes at which it suddenly steps up.\r\n\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\nCan use the google research bert and profile for memory using ProfilerHooks.\r\n\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32547", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32547/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32547/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32547/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32547", "id": 493862992, "node_id": "MDU6SXNzdWU0OTM4NjI5OTI=", "number": 32547, "title": "tensorflow.contrib.integrate.odeint does not work with the default __call__ method of subclass of tf.Keras.layers.Layer", "user": {"login": "richardwth", "id": 33274336, "node_id": "MDQ6VXNlcjMzMjc0MzM2", "avatar_url": "https://avatars0.githubusercontent.com/u/33274336?v=4", "gravatar_id": "", "url": "https://api.github.com/users/richardwth", "html_url": "https://github.com/richardwth", "followers_url": "https://api.github.com/users/richardwth/followers", "following_url": "https://api.github.com/users/richardwth/following{/other_user}", "gists_url": "https://api.github.com/users/richardwth/gists{/gist_id}", "starred_url": "https://api.github.com/users/richardwth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/richardwth/subscriptions", "organizations_url": "https://api.github.com/users/richardwth/orgs", "repos_url": "https://api.github.com/users/richardwth/repos", "events_url": "https://api.github.com/users/richardwth/events{/privacy}", "received_events_url": "https://api.github.com/users/richardwth/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1166103538, "node_id": "MDU6TGFiZWwxMTY2MTAzNTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/contrib", "name": "contrib", "color": "5319e7", "default": false, "description": "Anything that comes under contrib directory"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-09-16T06:07:16Z", "updated_at": "2019-09-25T23:54:39Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 19.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): both 1.14 and 1.15-rc0\r\n- Python version: 3.7\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: 10.1/7.0\r\n- GPU model and memory: Titan RTX, 24 GB\r\n\r\n**Describe the current behavior**\r\n__For Tensorflow 1.14:__\r\nWhen defining ODE function using the default `__call__` method of any subclass of `tf.Keras.layers.Layer`, an `ValueError` is raised, stating `VarIsInitializedOp` has been marked as not fetchable. To avoid this issue, the ODE function has to be defined using either pure TensorFlow functions, or the `call` method of the subclass instead of `__call__`. \r\n__For Tensorflow 1.15-rc0:__\r\nThe same code will run forever without error message. The above solution (using `call` instead of `__call__`) also applies here. \r\n\r\n**Describe the expected behavior**\r\n`tensorflow.contrib.integrate.odeint` should work with the default `__call__` method of any subclass of `tf.Keras.layers.Layer` under both TensorFlow 1.14 and 1.15-rc0.\r\n\r\n**Code to reproduce the issue**\r\n```python\r\nimport tensorflow as tf\r\nfrom tensorflow.python.keras import backend, layers, Input\r\nbackend.clear_session()\r\nfrom tensorflow.contrib.integrate import odeint\r\n\r\nx = Input(shape=(10,))\r\nl0 = layers.Dense(units=10)\r\nl0.build(x.shape)  # this line is necessary only to make call work\r\n\r\ndef ode_func(h, t, *ode_params):\r\n    return l0(h)  # l0.call(h) avoids the error which is hacky\r\n\r\nts = tf.constant([0., 1.], dtype=tf.float64)\r\nh_ts = odeint(ode_func, x, ts)\r\n```\r\n\r\n**Other info / logs**\r\n<details><summary>For TensorFlow 1.14: ValueError: '.../VarIsInitializedOp' not fetchable; click here for detailed logs.</summary>\r\n<p>\r\n\r\n```python\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-3-ad0e95799922> in <module>()\r\n     13 print('code start')\r\n     14 \r\n---> 15 h_ts = odeint(ode_func, x, ts)\r\n     16 \r\n     17 print('code finished')\r\n\r\n23 frames\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/integrate/python/ops/odes.py in odeint(func, y0, t, rtol, atol, method, options, full_output, name)\r\n    538         full_output=full_output,\r\n    539         name=scope,\r\n--> 540         **options)\r\n    541 \r\n    542 \r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/integrate/python/ops/odes.py in _dopri5(func, y0, t, rtol, atol, full_output, first_step, safety, ifactor, dfactor, max_num_steps, name)\r\n    403         lambda _, __, ___, i: i < num_times,\r\n    404         interpolate, (solution, history, rk_state, 1),\r\n--> 405         name='interpolate_loop')\r\n    406 \r\n    407     y = solution.stack(name=scope)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/control_flow_ops.py in while_loop(cond, body, loop_vars, shape_invariants, parallel_iterations, back_prop, swap_memory, name, maximum_iterations, return_same_structure)\r\n   3499       ops.add_to_collection(ops.GraphKeys.WHILE_CONTEXT, loop_context)\r\n   3500     result = loop_context.BuildLoop(cond, body, loop_vars, shape_invariants,\r\n-> 3501                                     return_same_structure)\r\n   3502     if maximum_iterations is not None:\r\n   3503       return result[1]\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/control_flow_ops.py in BuildLoop(self, pred, body, loop_vars, shape_invariants, return_same_structure)\r\n   3010       with ops.get_default_graph()._mutation_lock():  # pylint: disable=protected-access\r\n   3011         original_body_result, exit_vars = self._BuildLoop(\r\n-> 3012             pred, body, original_loop_vars, loop_vars, shape_invariants)\r\n   3013     finally:\r\n   3014       self.Exit()\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/control_flow_ops.py in _BuildLoop(self, pred, body, original_loop_vars, loop_vars, shape_invariants)\r\n   2935         expand_composites=True)\r\n   2936     pre_summaries = ops.get_collection(ops.GraphKeys._SUMMARY_COLLECTION)  # pylint: disable=protected-access\r\n-> 2937     body_result = body(*packed_vars_for_body)\r\n   2938     post_summaries = ops.get_collection(ops.GraphKeys._SUMMARY_COLLECTION)  # pylint: disable=protected-access\r\n   2939     if not nest.is_sequence_or_composite(body_result):\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/integrate/python/ops/odes.py in interpolate(solution, history, rk_state, i)\r\n    381             lambda rk_state, *_: t[i] > rk_state.t1,\r\n    382             adaptive_runge_kutta_step, (rk_state, history, 0),\r\n--> 383             name='integrate_loop')\r\n    384         y = _interp_evaluate(rk_state.interp_coeff, rk_state.t0, rk_state.t1,\r\n    385                              t[i])\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/control_flow_ops.py in while_loop(cond, body, loop_vars, shape_invariants, parallel_iterations, back_prop, swap_memory, name, maximum_iterations, return_same_structure)\r\n   3499       ops.add_to_collection(ops.GraphKeys.WHILE_CONTEXT, loop_context)\r\n   3500     result = loop_context.BuildLoop(cond, body, loop_vars, shape_invariants,\r\n-> 3501                                     return_same_structure)\r\n   3502     if maximum_iterations is not None:\r\n   3503       return result[1]\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/control_flow_ops.py in BuildLoop(self, pred, body, loop_vars, shape_invariants, return_same_structure)\r\n   3010       with ops.get_default_graph()._mutation_lock():  # pylint: disable=protected-access\r\n   3011         original_body_result, exit_vars = self._BuildLoop(\r\n-> 3012             pred, body, original_loop_vars, loop_vars, shape_invariants)\r\n   3013     finally:\r\n   3014       self.Exit()\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/control_flow_ops.py in _BuildLoop(self, pred, body, original_loop_vars, loop_vars, shape_invariants)\r\n   2935         expand_composites=True)\r\n   2936     pre_summaries = ops.get_collection(ops.GraphKeys._SUMMARY_COLLECTION)  # pylint: disable=protected-access\r\n-> 2937     body_result = body(*packed_vars_for_body)\r\n   2938     post_summaries = ops.get_collection(ops.GraphKeys._SUMMARY_COLLECTION)  # pylint: disable=protected-access\r\n   2939     if not nest.is_sequence_or_composite(body_result):\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/integrate/python/ops/odes.py in adaptive_runge_kutta_step(rk_state, history, n_steps)\r\n    345       with ops.control_dependencies(\r\n    346           [check_underflow, check_max_num_steps, check_numerics]):\r\n--> 347         y1, f1, y1_error, k = _runge_kutta_step(func, y0, f0, t0, dt)\r\n    348 \r\n    349       with ops.name_scope('error_ratio'):\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/integrate/python/ops/odes.py in _runge_kutta_step(func, y0, f0, t0, dt, tableau, name)\r\n    121       ti = t0 + alpha_i * dt\r\n    122       yi = y0 + _scaled_dot_product(dt_cast, beta_i, k)\r\n--> 123       k.append(func(yi, ti))\r\n    124 \r\n    125     if not (tableau.c_sol[-1] == 0 and tableau.c_sol[:-1] == tableau.beta[-1]):\r\n\r\n<ipython-input-3-ad0e95799922> in ode_func(h, t, *ode_params)\r\n      8 \r\n      9 def ode_func(h, t, *ode_params):\r\n---> 10     return l0(h)  # l0.call(h) avoids the error which is hacky\r\n     11 \r\n     12 ts = tf.constant([0., 1.], dtype=tf.float64)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/base_layer.py in __call__(self, inputs, *args, **kwargs)\r\n    559       # framework.\r\n    560       if base_layer_utils.needs_keras_history(inputs):\r\n--> 561         base_layer_utils.create_keras_history(inputs)\r\n    562 \r\n    563     # Handle Keras mask propagation from previous layer to current layer.\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/base_layer_utils.py in create_keras_history(tensors)\r\n    198     keras_tensors: The Tensors found that came from a Keras Layer.\r\n    199   \"\"\"\r\n--> 200   _, created_layers = _create_keras_history_helper(tensors, set(), [])\r\n    201   return created_layers\r\n    202 \r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/base_layer_utils.py in _create_keras_history_helper(tensors, processed_ops, created_layers)\r\n    244             constants[i] = backend.function([], op_input)([])\r\n    245       processed_ops, created_layers = _create_keras_history_helper(\r\n--> 246           layer_inputs, processed_ops, created_layers)\r\n    247       name = op.name\r\n    248       node_def = op.node_def.SerializeToString()\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/base_layer_utils.py in _create_keras_history_helper(tensors, processed_ops, created_layers)\r\n    244             constants[i] = backend.function([], op_input)([])\r\n    245       processed_ops, created_layers = _create_keras_history_helper(\r\n--> 246           layer_inputs, processed_ops, created_layers)\r\n    247       name = op.name\r\n    248       node_def = op.node_def.SerializeToString()\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/base_layer_utils.py in _create_keras_history_helper(tensors, processed_ops, created_layers)\r\n    242             constants[i] = op_input\r\n    243           else:\r\n--> 244             constants[i] = backend.function([], op_input)([])\r\n    245       processed_ops, created_layers = _create_keras_history_helper(\r\n    246           layer_inputs, processed_ops, created_layers)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/backend.py in __call__(self, inputs)\r\n   3251     inputs = nest.flatten(inputs)\r\n   3252 \r\n-> 3253     session = get_session(inputs)\r\n   3254     feed_arrays = []\r\n   3255     array_vals = []\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/backend.py in get_session(op_input_list)\r\n    460   if not _MANUAL_VAR_INIT:\r\n    461     with session.graph.as_default():\r\n--> 462       _initialize_variables(session)\r\n    463   return session\r\n    464 \r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/backend.py in _initialize_variables(session)\r\n    877     # marked as initialized.\r\n    878     is_initialized = session.run(\r\n--> 879         [variables_module.is_variable_initialized(v) for v in candidate_vars])\r\n    880     uninitialized_vars = []\r\n    881     for flag, v in zip(is_initialized, candidate_vars):\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in run(self, fetches, feed_dict, options, run_metadata)\r\n    948     try:\r\n    949       result = self._run(None, fetches, feed_dict, options_ptr,\r\n--> 950                          run_metadata_ptr)\r\n    951       if run_metadata:\r\n    952         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\r\n   1156     # Create a fetch handler to take care of the structure of fetches.\r\n   1157     fetch_handler = _FetchHandler(\r\n-> 1158         self._graph, fetches, feed_dict_tensor, feed_handles=feed_handles)\r\n   1159 \r\n   1160     # Run request and get response.\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in __init__(self, graph, fetches, feeds, feed_handles)\r\n    485         self._ops.append(True)\r\n    486       else:\r\n--> 487         self._assert_fetchable(graph, fetch.op)\r\n    488         self._fetches.append(fetch)\r\n    489         self._ops.append(False)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py in _assert_fetchable(self, graph, op)\r\n    498     if not graph.is_fetchable(op):\r\n    499       raise ValueError(\r\n--> 500           'Operation %r has been marked as not fetchable.' % op.name)\r\n    501 \r\n    502   def fetches(self):\r\n\r\nValueError: Operation 'odeint/interpolate_loop/interpolate/integrate_loop/runge_kutta_step/VarIsInitializedOp' has been marked as not fetchable.\r\n```\r\n\r\n</p>\r\n</details>\r\n\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32546", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32546/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32546/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32546/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32546", "id": 493833012, "node_id": "MDU6SXNzdWU0OTM4MzMwMTI=", "number": 32546, "title": "OperatorNotAllowedInGraphError error in Tensorflow 2.0", "user": {"login": "payne4handsome", "id": 28085731, "node_id": "MDQ6VXNlcjI4MDg1NzMx", "avatar_url": "https://avatars2.githubusercontent.com/u/28085731?v=4", "gravatar_id": "", "url": "https://api.github.com/users/payne4handsome", "html_url": "https://github.com/payne4handsome", "followers_url": "https://api.github.com/users/payne4handsome/followers", "following_url": "https://api.github.com/users/payne4handsome/following{/other_user}", "gists_url": "https://api.github.com/users/payne4handsome/gists{/gist_id}", "starred_url": "https://api.github.com/users/payne4handsome/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/payne4handsome/subscriptions", "organizations_url": "https://api.github.com/users/payne4handsome/orgs", "repos_url": "https://api.github.com/users/payne4handsome/repos", "events_url": "https://api.github.com/users/payne4handsome/events{/privacy}", "received_events_url": "https://api.github.com/users/payne4handsome/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1190546177, "node_id": "MDU6TGFiZWwxMTkwNTQ2MTc3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:autograph", "name": "comp:autograph", "color": "0052cc", "default": false, "description": ""}, {"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mdanatg", "id": 26628547, "node_id": "MDQ6VXNlcjI2NjI4NTQ3", "avatar_url": "https://avatars1.githubusercontent.com/u/26628547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mdanatg", "html_url": "https://github.com/mdanatg", "followers_url": "https://api.github.com/users/mdanatg/followers", "following_url": "https://api.github.com/users/mdanatg/following{/other_user}", "gists_url": "https://api.github.com/users/mdanatg/gists{/gist_id}", "starred_url": "https://api.github.com/users/mdanatg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mdanatg/subscriptions", "organizations_url": "https://api.github.com/users/mdanatg/orgs", "repos_url": "https://api.github.com/users/mdanatg/repos", "events_url": "https://api.github.com/users/mdanatg/events{/privacy}", "received_events_url": "https://api.github.com/users/mdanatg/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mdanatg", "id": 26628547, "node_id": "MDQ6VXNlcjI2NjI4NTQ3", "avatar_url": "https://avatars1.githubusercontent.com/u/26628547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mdanatg", "html_url": "https://github.com/mdanatg", "followers_url": "https://api.github.com/users/mdanatg/followers", "following_url": "https://api.github.com/users/mdanatg/following{/other_user}", "gists_url": "https://api.github.com/users/mdanatg/gists{/gist_id}", "starred_url": "https://api.github.com/users/mdanatg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mdanatg/subscriptions", "organizations_url": "https://api.github.com/users/mdanatg/orgs", "repos_url": "https://api.github.com/users/mdanatg/repos", "events_url": "https://api.github.com/users/mdanatg/events{/privacy}", "received_events_url": "https://api.github.com/users/mdanatg/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-09-16T03:44:14Z", "updated_at": "2019-10-05T06:35:27Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution \r\nMac os (10.14.6)\r\n- TensorFlow installed from (source or binary):\r\nbinary\r\n- TensorFlow version (use command below):\r\n 2.0.0rc1\r\n- Python version:\r\nPython 3.6.4\r\n\r\nI'm learn tensorflow2.0 from [official tutorials](https://www.tensorflow.org/beta/guide/autograph#batching).I can understand the result from below code.\r\n```\r\ndef square_if_positive(x):\r\n  return [i ** 2 if i > 0 else i for i in x]\r\nsquare_if_positive(range(-5, 5))\r\n\r\n# result\r\n[-5, -4, -3, -2, -1, 0, 1, 4, 9, 16]\r\n```\r\nBut if I change the inputs with tensor not python code, just like this, I got a error\r\n```\r\n@tf.function\r\ndef square_if_positive(x):\r\n  return [i ** 2 if i > 0 else i for i in x]\r\nsquare_if_positive(tf.range(-5, 5))\r\n```\r\n```\r\n\r\n~/tf2_workspace/tf2.0/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py in _create_graph_function(self, args, kwargs, override_flat_arg_shapes)\r\n   1984             arg_names=arg_names,\r\n   1985             override_flat_arg_shapes=override_flat_arg_shapes,\r\n-> 1986             capture_by_value=self._capture_by_value),\r\n   1987         self._function_attributes,\r\n   1988         # Tell the ConcreteFunction to clean up its graph once it goes out of\r\n\r\n~/tf2_workspace/tf2.0/lib/python3.6/site-packages/tensorflow_core/python/framework/func_graph.py in func_graph_from_py_func(name, python_func, args, kwargs, signature, func_graph, autograph, autograph_options, add_control_dependencies, arg_names, op_return_value, collections, capture_by_value, override_flat_arg_shapes)\r\n    851                                           converted_func)\r\n    852 \r\n--> 853       func_outputs = python_func(*func_args, **func_kwargs)\r\n    854 \r\n    855       # invariant: `func_outputs` contains only Tensors, CompositeTensors,\r\n\r\n~/tf2_workspace/tf2.0/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py in wrapped_fn(*args, **kwds)\r\n    323         # __wrapped__ allows AutoGraph to swap in a converted function. We give\r\n    324         # the function a weak reference to itself to avoid a reference cycle.\r\n--> 325         return weak_wrapped_fn().__wrapped__(*args, **kwds)\r\n    326     weak_wrapped_fn = weakref.ref(wrapped_fn)\r\n    327 \r\n\r\n~/tf2_workspace/tf2.0/lib/python3.6/site-packages/tensorflow_core/python/framework/func_graph.py in wrapper(*args, **kwargs)\r\n    841           except Exception as e:  # pylint:disable=broad-except\r\n    842             if hasattr(e, \"ag_error_metadata\"):\r\n--> 843               raise e.ag_error_metadata.to_exception(type(e))\r\n    844             else:\r\n    845               raise\r\n\r\nOperatorNotAllowedInGraphError: in converted code:\r\n\r\n    <ipython-input-37-6c17f29a3443>:3 square_if_positive  *\r\n        return [i**2 if i > 0 else i for i in x]\r\n    /Users/zhangpan/tf2_workspace/tf2.0/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py:547 __iter__\r\n        self._disallow_iteration()\r\n    /Users/zhangpan/tf2_workspace/tf2.0/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py:540 _disallow_iteration\r\n        self._disallow_when_autograph_enabled(\"iterating over `tf.Tensor`\")\r\n    /Users/zhangpan/tf2_workspace/tf2.0/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py:518 _disallow_when_autograph_enabled\r\n        \" decorating it directly with @tf.function.\".format(task))\r\n\r\n    OperatorNotAllowedInGraphError: iterating over `tf.Tensor` is not allowed: AutoGraph did not convert this function. Try decorating it directly with @tf.function.\r\n```\r\nI can't find any specifications about this error. I think the real reason is not \"iterating over tf.Tensor is not allowed\" . Becase I can write like this.\r\n\r\n```\r\n@tf.function\r\ndef square_if_positive(x):\r\n    for i in x:\r\n        if i>0:\r\n            tf.print(i**2)\r\n        else:\r\n            tf.print(i)\r\n\r\nsquare_if_positive(tf.range(10))\r\n```\r\niterate over tensor just like above code.\r\nSo my question is what's the real reason about this error? Any suggestions will help me. I really can't understand this error through I read a lot of materials.\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32545", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32545/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32545/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32545/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32545", "id": 493794672, "node_id": "MDU6SXNzdWU0OTM3OTQ2NzI=", "number": 32545, "title": "tf.keras.layers.Add can add tensors with dimension ()", "user": {"login": "breadbread1984", "id": 1930282, "node_id": "MDQ6VXNlcjE5MzAyODI=", "avatar_url": "https://avatars0.githubusercontent.com/u/1930282?v=4", "gravatar_id": "", "url": "https://api.github.com/users/breadbread1984", "html_url": "https://github.com/breadbread1984", "followers_url": "https://api.github.com/users/breadbread1984/followers", "following_url": "https://api.github.com/users/breadbread1984/following{/other_user}", "gists_url": "https://api.github.com/users/breadbread1984/gists{/gist_id}", "starred_url": "https://api.github.com/users/breadbread1984/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/breadbread1984/subscriptions", "organizations_url": "https://api.github.com/users/breadbread1984/orgs", "repos_url": "https://api.github.com/users/breadbread1984/repos", "events_url": "https://api.github.com/users/breadbread1984/events{/privacy}", "received_events_url": "https://api.github.com/users/breadbread1984/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-09-15T22:33:18Z", "updated_at": "2019-09-24T23:12:22Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 2.0.0-dev20190731\r\n- Python version: 3.6.7\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source): N/A\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: N/A\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\n\r\nwhen I add multiple tensors with shape (), tf.keras.layers.Add complains that\r\n>  File \"/home/xieyi/.local/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/base_layer.py\", line 680, in __call__\r\n    self._maybe_build(inputs)\r\n  File \"/home/xieyi/.local/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/base_layer.py\", line 1905, in _maybe_build\r\n    self.build(input_shapes)\r\n  File \"/home/xieyi/.local/lib/python3.6/site-packages/tensorflow_core/python/keras/utils/tf_utils.py\", line 299, in wrapper\r\n    output_shape = fn(instance, input_shape)\r\n  File \"/home/xieyi/.local/lib/python3.6/site-packages/tensorflow_core/python/keras/layers/merge.py\", line 95, in build\r\n    batch_sizes = [s[0] for s in input_shape if s is not None]\r\n  File \"/home/xieyi/.local/lib/python3.6/site-packages/tensorflow_core/python/keras/layers/merge.py\", line 95, in <listcomp>\r\n    batch_sizes = [s[0] for s in input_shape if s is not None]\r\nIndexError: tuple index out of range\r\n\r\n**Describe the expected behavior**\r\n\r\nI expect tf.keras.layers.Add can process tensors of any dimension.\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n```python\r\n#!/usr/bin/python3\r\n\r\nimport tensorflow as tf;\r\n\r\na = tf.constant(1);\r\nb = tf.constant(2);\r\nc = tf.constant(3);\r\nd = tf.keras.layers.Add()([a,b,c]);\r\n```\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32535", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32535/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32535/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32535/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32535", "id": 493693904, "node_id": "MDU6SXNzdWU0OTM2OTM5MDQ=", "number": 32535, "title": "Build TensorFlow Lite for Raspberry Pi with SELECT_TF_OPS", "user": {"login": "liushengzhong1023", "id": 31457704, "node_id": "MDQ6VXNlcjMxNDU3NzA0", "avatar_url": "https://avatars2.githubusercontent.com/u/31457704?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liushengzhong1023", "html_url": "https://github.com/liushengzhong1023", "followers_url": "https://api.github.com/users/liushengzhong1023/followers", "following_url": "https://api.github.com/users/liushengzhong1023/following{/other_user}", "gists_url": "https://api.github.com/users/liushengzhong1023/gists{/gist_id}", "starred_url": "https://api.github.com/users/liushengzhong1023/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liushengzhong1023/subscriptions", "organizations_url": "https://api.github.com/users/liushengzhong1023/orgs", "repos_url": "https://api.github.com/users/liushengzhong1023/repos", "events_url": "https://api.github.com/users/liushengzhong1023/events{/privacy}", "received_events_url": "https://api.github.com/users/liushengzhong1023/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1194756584, "node_id": "MDU6TGFiZWwxMTk0NzU2NTg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20raspberry%20pi", "name": "subtype: raspberry pi", "color": "b619ea", "default": false, "description": "Raspberry Pi Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-09-15T04:29:13Z", "updated_at": "2019-09-16T06:04:13Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Raspbian GNU/Linux 9.1 (stretch)\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version: 1.14\r\n- Python version:\r\n- Installed using virtualenv? pip? conda?:\r\n- Bazel version (if compiling from source): 0.26.1\r\n- GCC/Compiler version (if compiling from source): \r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\n\r\n\r\n**Describe the problem**\r\n\r\nHi, I am trying to use TF Lite with SELECT_TF_OPS on my Raspberry Pi 3B. According to your docs, Python API is currently not fully supported, so I tried to use the C++ API. Then I have to compile a static library for TF Lite [https://www.tensorflow.org/lite/guide/build_rpi#cross-compile_for_raspberry_pi](url) . The problem is how can I config it to support SELECT_TF_OPS? The only information I found is on [https://www.tensorflow.org/lite/guide/ops_select#c](url), but it is about compiling using Bazel, which is not compatible with the compiling instructions on Raspberry Pi? Does anyone has any suggestions or ideas about this issue?\r\n\r\nThanks!"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32533", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32533/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32533/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32533/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/32533", "id": 493676674, "node_id": "MDExOlB1bGxSZXF1ZXN0MzE3NTk3MTA5", "number": 32533, "title": "Improved compatibility with sklearn", "user": {"login": "daviddiazvico", "id": 2562168, "node_id": "MDQ6VXNlcjI1NjIxNjg=", "avatar_url": "https://avatars1.githubusercontent.com/u/2562168?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daviddiazvico", "html_url": "https://github.com/daviddiazvico", "followers_url": "https://api.github.com/users/daviddiazvico/followers", "following_url": "https://api.github.com/users/daviddiazvico/following{/other_user}", "gists_url": "https://api.github.com/users/daviddiazvico/gists{/gist_id}", "starred_url": "https://api.github.com/users/daviddiazvico/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daviddiazvico/subscriptions", "organizations_url": "https://api.github.com/users/daviddiazvico/orgs", "repos_url": "https://api.github.com/users/daviddiazvico/repos", "events_url": "https://api.github.com/users/daviddiazvico/events{/privacy}", "received_events_url": "https://api.github.com/users/daviddiazvico/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1178505529, "node_id": "MDU6TGFiZWwxMTc4NTA1NTI5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/prtype:bugfix", "name": "prtype:bugfix", "color": "159b2e", "default": false, "description": "PR to fix a bug"}, {"id": 1169365682, "node_id": "MDU6TGFiZWwxMTY5MzY1Njgy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:L", "name": "size:L", "color": "adafea", "default": false, "description": "CL Change Size: Large"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2019-09-14T23:28:20Z", "updated_at": "2020-02-29T16:58:29Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/32533", "html_url": "https://github.com/tensorflow/tensorflow/pull/32533", "diff_url": "https://github.com/tensorflow/tensorflow/pull/32533.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/32533.patch"}, "body": "The original PR in keras-team/keras is [this](https://github.com/keras-team/keras/pull/12833\r\n)\r\n\r\n\r\n## Summary\r\n\r\nScikit-learn estimators are instanced only with hyper-parameter information. No knowledge on the data (X or y) is needed until the estimator is fitted. On the other hand, KerasRegressor and KerasClassifier receive as argument a build_fn that instantiates and compiles the estimator. At this point, the input and output shapes are needed to define the network's architecture. This is a subtle but important difference between Scikit-learn estimators and KerasClassifier/KerasRegressor.\r\n\r\nAlso, Scikit-learn's GridSearchCV and RandomizedSearchCV (and probably Scikit-optimize's BayesSearchCV) automatically infer the most appropriate CV folding (stratified or not) from the base_estimator. KerasClassifier and KerasRegressor, however, do not have the attribute needed for this to work.\r\n\r\n\r\n## Related Issues\r\n\r\n#32532"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32532", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32532/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32532/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32532/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32532", "id": 493676436, "node_id": "MDU6SXNzdWU0OTM2NzY0MzY=", "number": 32532, "title": "Improving compatibility with Scikit-learn", "user": {"login": "daviddiazvico", "id": 2562168, "node_id": "MDQ6VXNlcjI1NjIxNjg=", "avatar_url": "https://avatars1.githubusercontent.com/u/2562168?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daviddiazvico", "html_url": "https://github.com/daviddiazvico", "followers_url": "https://api.github.com/users/daviddiazvico/followers", "following_url": "https://api.github.com/users/daviddiazvico/following{/other_user}", "gists_url": "https://api.github.com/users/daviddiazvico/gists{/gist_id}", "starred_url": "https://api.github.com/users/daviddiazvico/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daviddiazvico/subscriptions", "organizations_url": "https://api.github.com/users/daviddiazvico/orgs", "repos_url": "https://api.github.com/users/daviddiazvico/repos", "events_url": "https://api.github.com/users/daviddiazvico/events{/privacy}", "received_events_url": "https://api.github.com/users/daviddiazvico/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, {"login": "qlzh727", "id": 5118881, "node_id": "MDQ6VXNlcjUxMTg4ODE=", "avatar_url": "https://avatars3.githubusercontent.com/u/5118881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qlzh727", "html_url": "https://github.com/qlzh727", "followers_url": "https://api.github.com/users/qlzh727/followers", "following_url": "https://api.github.com/users/qlzh727/following{/other_user}", "gists_url": "https://api.github.com/users/qlzh727/gists{/gist_id}", "starred_url": "https://api.github.com/users/qlzh727/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qlzh727/subscriptions", "organizations_url": "https://api.github.com/users/qlzh727/orgs", "repos_url": "https://api.github.com/users/qlzh727/repos", "events_url": "https://api.github.com/users/qlzh727/events{/privacy}", "received_events_url": "https://api.github.com/users/qlzh727/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-09-14T23:24:10Z", "updated_at": "2020-03-09T00:35:56Z", "closed_at": null, "author_association": "NONE", "body": "The original issue in keras-team/keras is [this](https://github.com/keras-team/keras/issues/12832\r\n)\r\n\r\nScikit-learn estimators are instanced only with hyper-parameter information. No knowledge on the data (X or y) is needed until the estimator is fitted. On the other hand, KerasRegressor and KerasClassifier receive as argument a build_fn that instantiates and compiles the estimator. At this point, the input and output shapes are needed to define the network's architecture. This is a subtle but important difference between Scikit-learn estimators and KerasClassifier/KerasRegressor.\r\n\r\nAlso, Scikit-learn's GridSearchCV and RandomizedSearchCV (and probably Scikit-optimize's BayesSearchCV) automatically infer the most appropriate CV folding (stratified or not) from the base_estimator. KerasClassifier and KerasRegressor, however, do not have the attribute needed for this to work.\r\n\r\nMy proposed solution (with some additional tests) is in [this](https://github.com/daviddiazvico/tensorflow/commit/e33e1c5f88e9832b2578f495ee85bcae7e9a5a4f) commit (I'll open a PR now).\r\n\r\nThank you!"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32521", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32521/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32521/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32521/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32521", "id": 493596685, "node_id": "MDU6SXNzdWU0OTM1OTY2ODU=", "number": 32521, "title": "can not tflite squeezedet graph by freeze_graph.py", "user": {"login": "Davari393", "id": 46137886, "node_id": "MDQ6VXNlcjQ2MTM3ODg2", "avatar_url": "https://avatars0.githubusercontent.com/u/46137886?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Davari393", "html_url": "https://github.com/Davari393", "followers_url": "https://api.github.com/users/Davari393/followers", "following_url": "https://api.github.com/users/Davari393/following{/other_user}", "gists_url": "https://api.github.com/users/Davari393/gists{/gist_id}", "starred_url": "https://api.github.com/users/Davari393/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Davari393/subscriptions", "organizations_url": "https://api.github.com/users/Davari393/orgs", "repos_url": "https://api.github.com/users/Davari393/repos", "events_url": "https://api.github.com/users/Davari393/events{/privacy}", "received_events_url": "https://api.github.com/users/Davari393/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jaeyoo", "id": 40815393, "node_id": "MDQ6VXNlcjQwODE1Mzkz", "avatar_url": "https://avatars1.githubusercontent.com/u/40815393?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaeyoo", "html_url": "https://github.com/jaeyoo", "followers_url": "https://api.github.com/users/jaeyoo/followers", "following_url": "https://api.github.com/users/jaeyoo/following{/other_user}", "gists_url": "https://api.github.com/users/jaeyoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaeyoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaeyoo/subscriptions", "organizations_url": "https://api.github.com/users/jaeyoo/orgs", "repos_url": "https://api.github.com/users/jaeyoo/repos", "events_url": "https://api.github.com/users/jaeyoo/events{/privacy}", "received_events_url": "https://api.github.com/users/jaeyoo/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jaeyoo", "id": 40815393, "node_id": "MDQ6VXNlcjQwODE1Mzkz", "avatar_url": "https://avatars1.githubusercontent.com/u/40815393?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaeyoo", "html_url": "https://github.com/jaeyoo", "followers_url": "https://api.github.com/users/jaeyoo/followers", "following_url": "https://api.github.com/users/jaeyoo/following{/other_user}", "gists_url": "https://api.github.com/users/jaeyoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaeyoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaeyoo/subscriptions", "organizations_url": "https://api.github.com/users/jaeyoo/orgs", "repos_url": "https://api.github.com/users/jaeyoo/repos", "events_url": "https://api.github.com/users/jaeyoo/events{/privacy}", "received_events_url": "https://api.github.com/users/jaeyoo/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-09-14T07:56:01Z", "updated_at": "2020-02-01T00:27:01Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 18.04):\r\n- TensorFlow installed from (binary):\r\n- TensorFlow version (1.15.0-dev20190707):\r\n\r\n\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime. If those are native TensorFlow operators, you might be able to use the extended runtime by passing --enable_select_tf_ops, or by setting target_ops=TFLITE_BUILTINS,SELECT_TF_OPS when calling tf.lite.TFLiteConverter(). Otherwise, if you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: ADD, ARG_MAX, CAST, CONCATENATION, CONV_2D, DIV, EXP, FLOOR, GREATER, LOGISTIC, MAXIMUM, MAX_POOL_2D, MINIMUM, MUL, PACK, REDUCE_MAX, RESHAPE, SOFTMAX, STRIDED_SLICE, SUB, TRANSPOSE, UNPACK. Here is a list of operators for which you will need custom implementations: RandomUniform.\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32520", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32520/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32520/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32520/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32520", "id": 493592443, "node_id": "MDU6SXNzdWU0OTM1OTI0NDM=", "number": 32520, "title": "Training stuck on Allocation exceeds 10% of system memory", "user": {"login": "ychen404", "id": 22212046, "node_id": "MDQ6VXNlcjIyMjEyMDQ2", "avatar_url": "https://avatars3.githubusercontent.com/u/22212046?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ychen404", "html_url": "https://github.com/ychen404", "followers_url": "https://api.github.com/users/ychen404/followers", "following_url": "https://api.github.com/users/ychen404/following{/other_user}", "gists_url": "https://api.github.com/users/ychen404/gists{/gist_id}", "starred_url": "https://api.github.com/users/ychen404/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ychen404/subscriptions", "organizations_url": "https://api.github.com/users/ychen404/orgs", "repos_url": "https://api.github.com/users/ychen404/repos", "events_url": "https://api.github.com/users/ychen404/events{/privacy}", "received_events_url": "https://api.github.com/users/ychen404/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "penpornk", "id": 38085909, "node_id": "MDQ6VXNlcjM4MDg1OTA5", "avatar_url": "https://avatars3.githubusercontent.com/u/38085909?v=4", "gravatar_id": "", "url": "https://api.github.com/users/penpornk", "html_url": "https://github.com/penpornk", "followers_url": "https://api.github.com/users/penpornk/followers", "following_url": "https://api.github.com/users/penpornk/following{/other_user}", "gists_url": "https://api.github.com/users/penpornk/gists{/gist_id}", "starred_url": "https://api.github.com/users/penpornk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/penpornk/subscriptions", "organizations_url": "https://api.github.com/users/penpornk/orgs", "repos_url": "https://api.github.com/users/penpornk/repos", "events_url": "https://api.github.com/users/penpornk/events{/privacy}", "received_events_url": "https://api.github.com/users/penpornk/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "penpornk", "id": 38085909, "node_id": "MDQ6VXNlcjM4MDg1OTA5", "avatar_url": "https://avatars3.githubusercontent.com/u/38085909?v=4", "gravatar_id": "", "url": "https://api.github.com/users/penpornk", "html_url": "https://github.com/penpornk", "followers_url": "https://api.github.com/users/penpornk/followers", "following_url": "https://api.github.com/users/penpornk/following{/other_user}", "gists_url": "https://api.github.com/users/penpornk/gists{/gist_id}", "starred_url": "https://api.github.com/users/penpornk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/penpornk/subscriptions", "organizations_url": "https://api.github.com/users/penpornk/orgs", "repos_url": "https://api.github.com/users/penpornk/repos", "events_url": "https://api.github.com/users/penpornk/events{/privacy}", "received_events_url": "https://api.github.com/users/penpornk/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 13, "created_at": "2019-09-14T06:59:54Z", "updated_at": "2020-03-15T14:34:46Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 1.9.0\r\n- Python version: 3.5\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: running on CPU\r\n- GPU model and memory:\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nThe training is stuck after throwing the following warning: \r\n2019-09-13 23:25:57.221146: W tensorflow/core/framework/allocator.cc:108] Allocation of 603979776 exceeds 10% of system memory.\r\nstart training iteration: 0 elapse: 1568442370.016824\r\n2019-09-13 23:26:10.230583: W tensorflow/core/framework/allocator.cc:108] Allocation of 2147483648 exceeds 10% of system memory.\r\n2019-09-13 23:26:11.860365: W tensorflow/core/framework/allocator.cc:108] Allocation of 2147483648 exceeds 10% of system memory.\r\n\r\n**Describe the expected behavior**\r\nExpect the training to slowly progress given the memory is not big enough to hold the tensors then the swap should be able to help. \r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\nMN_REDUCED.py\r\n    \r\n    import tensorflow as tf\r\n    from tensorflow.python.framework import ops\r\n    from tensorflow.python.framework import dtypes\r\n    import random\r\n    import numpy as np\r\n      \r\n    BATCH_SIZE = 128\r\n    OUTPUT=4096\r\n    NUM_CLASSES = OUTPUT\r\n    \r\n    class MN_REDUCED(object):\r\n     \r\n          def __init__(self, trainable=True, dropout=0.5):\r\n              self.trainable = trainable\r\n              self.dropout = dropout\r\n              self.parameters = []\r\n    \r\n          def build(self,rgb,train_mode=None):\r\n              with tf.name_scope('conv_1') as scope:\r\n                  kernel = tf.Variable(tf.truncated_normal([3, 3, 3, OUTPUT], dtype=tf.float32,\r\n                                          stddev=1e-2), name='weights')\r\n                  conv = tf.nn.conv2d(rgb, kernel, [1, 1, 1, 1], padding='SAME')\r\n                  biases = tf.Variable(tf.constant(0.0, shape=[OUTPUT], dtype=tf.float32),\r\n                                           trainable=True, name='biases')\r\n                  conv1 = tf.nn.bias_add(conv, biases)\r\n               #   shape = int(np.prod(out.get_shape()))\r\n               #   flat = tf.reshape(out, [BATCH_SIZE, -1])\r\n               #   self.out_0 = flat[:,0:OUTPUT]\r\n              with tf.name_scope('conv_2') as scope:\r\n                  kernel = tf.Variable(tf.truncated_normal([3, 3, OUTPUT, OUTPUT], type=tf.float32,\r\n                                          stddev=1e-2), name='weights')\r\n                  conv = tf.nn.conv2d(conv1, kernel, [1, 1, 1, 1], padding='SAME')\r\n                  biases = tf.Variable(tf.constant(0.0, shape=[OUTPUT], dtype=tf.float32),\r\n                                           trainable=True, name='biases')\r\n                  out = tf.nn.bias_add(conv, biases)\r\n                  shape = int(np.prod(out.get_shape()))\r\n                  flat = tf.reshape(out, [BATCH_SIZE, -1])\r\n                  self.out_0 = flat[:,0:OUTPUT]\r\n     \r\n          def loss(self, labels):\r\n              labels = tf.cast(labels, tf.int32)\r\n              oneHot = tf.one_hot (labels, NUM_CLASSES)\r\n              loss = tf.reduce_mean(tf.square(self.out_0 - oneHot), name='loss')\r\n              return loss\r\n     \r\n          def training(self, loss):\r\n              optimizer = tf.train.GradientDescentOptimizer(0.001)\r\n              train_op = optimizer.minimize(loss);\r\n              return train_op\r\n\r\n\r\nmain.py\r\n\r\n     import tensorflow as tf\r\n     import random\r\n     import os\r\n     from DataInput import DataInput\r\n     #from CNN_FULL_CPU import CNN_FULL_CPU\r\n     from MN_REDUCED import MN_REDUCED\r\n     import pdb\r\n     from tensorflow.python.tools.inspect_checkpoint import print_tensors_in_checkpoint_file\r\n     import time\r\n     import numpy as np\r\n     \r\n     dataset_path = \"./\"\r\n     train_labels_file = \"dataset.txt\"\r\n     \r\n     IMAGE_HEIGHT = 32\r\n     IMAGE_WIDTH = 32\r\n     NUM_CHANNELS = 3\r\n     BATCH_SIZE = 128\r\n     NUM_ITERATIONS = 1000\r\n     #NUM_ITERATIONS = 10\r\n     LEARNING_RATE = 0.001\r\n     SUMMARY_LOG_DIR=\"./summary-log\"\r\n     lasttime = 0\r\n   \r\n       def placeholder_inputs(batch_size):\r\n               images_placeholder = tf.placeholder(tf.float32,\r\n                                                                       shape=(batch_size, IMAGE_HEIGHT,\r\n                                                                                  IMAGE_WIDTH, NUM_CHANNELS))\r\n               labels_placeholder = tf.placeholder(tf.int32,\r\n                                                                       shape=(batch_size))\r\n       \r\n               return images_placeholder, labels_placeholder\r\n   \r\n     def fill_feed_dict(images_pl, labels_pl, sess):\r\n               #images_feed, labels_feed = sess.run([data_input.example_batch, data_input.label_batch])\r\n       \r\n       \r\n               #feed_dict = {\r\n               #       images_pl: images_feed,\r\n               #       labels_pl: labels_feed,\r\n               #}\r\n               n = BATCH_SIZE * IMAGE_WIDTH * IMAGE_HEIGHT * NUM_CHANNELS\r\n               k = IMAGE_WIDTH\r\n               a = np.empty(n, dtype=np.float32)\r\n               np.random.seed(0)\r\n       \r\n           for i in range(0, n, k):\r\n                   a[i:i+k] = np.random.normal(loc=0, scale=1, size=k)\r\n               rand = np.reshape(a, (BATCH_SIZE, IMAGE_WIDTH, IMAGE_HEIGHT, NUM_CHANNELS))\r\n       \r\n       \r\n               n1 = BATCH_SIZE\r\n               a1 = np.empty(n1, dtype=np.float32)\r\n               for i in range(0, n1):\r\n                   a1[i] = np.random.normal(loc=0, scale=1)\r\n       \r\n       \r\n               feed_dict = {\r\n                       images_pl: rand,\r\n                       labels_pl: a1,\r\n               }\r\n       \r\n               return feed_dict\r\n   \r\n       def do_eval(sess,\r\n                           eval_correct,\r\n                           logits,\r\n                           images_placeholder,\r\n                           labels_placeholder,\r\n                           dataset):\r\n   \r\n           true_count = 0\r\n           # // is flooring division\r\n           steps_per_epoch = dataset.num_examples // BATCH_SIZE\r\n           num_examples = steps_per_epoch * BATCH_SIZE\r\n   \r\n           for step in xrange(steps_per_epoch):\r\n                   #feed_dict = fill_feed_dict(dataset, images_placeholder,        labels_placeholder)\r\n                   feed_dict = fill_feed_dict(dataset, images_placeholder, labels_placeholder,sess)\r\n                   count = sess.run(eval_correct, feed_dict=feed_dict)\r\n                   true_count = true_count + count\r\n   \r\n           precision = float(true_count) / num_examples\r\n           print ('  Num examples: %d, Num correct: %d, Precision @ 1: %0.04f' %\r\n                           (num_examples, true_count, precision))\r\n\r\n    def placeholder_inputs(batch_size):\r\n        images_placeholder = tf.placeholder(tf.float32,\r\n        shape=(batch_size, IMAGE_HEIGHT,\r\n        IMAGE_WIDTH, NUM_CHANNELS))\r\n        labels_placeholder = tf.placeholder(tf.int32,\r\n        shape=(batch_size))  \r\n       def main():\r\n               with tf.Graph().as_default():\r\n   \r\n                   #data_input = DataInput(dataset_path, train_labels_file, BATCH_SIZE)\r\n                   images_placeholder, labels_placeholder = placeholder_inputs(BATCH_SIZE)\r\n                   cnn_full_cpu = MN_REDUCED()\r\n                   cnn_full_cpu.build(images_placeholder)\r\n   \r\n                   summary = tf.summary.merge_all()\r\n                   saver = tf.train.Saver()\r\n                   sess = tf.Session()\r\n                   #sess = tf.Session(config=tf.ConfigProto(log_device_placement=True))\r\n                   summary_writer = tf.summary.FileWriter(SUMMARY_LOG_DIR, sess.graph)\r\n                   coord = tf.train.Coordinator()\r\n                   threads = tf.train.start_queue_runners(sess=sess, coord=coord)\r\n   \r\n                   loss = cnn_full_cpu.loss(labels_placeholder)\r\n                   train_op = cnn_full_cpu.training(loss)\r\n   \r\n                   init = tf.global_variables_initializer()\r\n                   sess.run(init)\r\n                   eval_correct = evaluation(cnn_full_cpu.out_0, labels_placeholder)\r\n   \r\n                   try:\r\n                           for i in range(NUM_ITERATIONS):\r\n                                   feed_dict = fill_feed_dict(images_placeholder,\r\n                                                                   labels_placeholder, sess)\r\n                                   _, loss_value = sess.run([train_op, loss], feed_dict=feed_dict)\r\n   \r\n                                   print ('Step %d: loss = %.6f' % (i, loss_value))\r\n   \r\n                           coord.request_stop()\r\n                           coord.join(threads)\r\n                   except Exception as e:\r\n                           print(e)\r\n                   infer = sess.run([cnn_full_cpu.out_0], feed_dict=feed_dict)\r\n           sess.close().   \r\n\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\nI checked the memory utilization of the virtual machine. \r\nAlthough the memory is almost fully utilized, but there is still swap area. The program should run at a cost of performance. \r\n              total        used        free      shared  buff/cache   available\r\nMem:           3945        3712         178           0          54          79\r\nSwap:          4092        2169        1923\r\n\r\nIn order to simulate a memory constrained environment, I setup a VirtualBox with 4GB memory and 4 GB swap size. Only one cpu core. \r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32517", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32517/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32517/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32517/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32517", "id": 493576685, "node_id": "MDU6SXNzdWU0OTM1NzY2ODU=", "number": 32517, "title": "undeclared inclusion(s) in rule '//tensorflow/contrib/lite/kernels:eigen_support'", "user": {"login": "eraserpencil", "id": 16631431, "node_id": "MDQ6VXNlcjE2NjMxNDMx", "avatar_url": "https://avatars1.githubusercontent.com/u/16631431?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eraserpencil", "html_url": "https://github.com/eraserpencil", "followers_url": "https://api.github.com/users/eraserpencil/followers", "following_url": "https://api.github.com/users/eraserpencil/following{/other_user}", "gists_url": "https://api.github.com/users/eraserpencil/gists{/gist_id}", "starred_url": "https://api.github.com/users/eraserpencil/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eraserpencil/subscriptions", "organizations_url": "https://api.github.com/users/eraserpencil/orgs", "repos_url": "https://api.github.com/users/eraserpencil/repos", "events_url": "https://api.github.com/users/eraserpencil/events{/privacy}", "received_events_url": "https://api.github.com/users/eraserpencil/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1162044565, "node_id": "MDU6TGFiZWwxMTYyMDQ0NTY1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.12", "name": "TF 1.12", "color": "c2e0c6", "default": false, "description": "Issues related to TF 1.12"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-09-14T03:16:22Z", "updated_at": "2019-09-20T12:32:54Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution: Linux Ubuntu 16.04\r\n- TensorFlow installed from (source or binary): Source\r\n- TensorFlow version: r1.12\r\n- Python version: 2.7\r\n- Installed using virtualenv? pip? conda?: No\r\n- Bazel version (if compiling from source): 0.15.0\r\n- GCC/Compiler version (if compiling from source): 5.4.0\r\n- CUDA/cuDNN version: Cuda 9.0/ cuDNN 7\r\n- GPU model and memory: Mobile GTX 1070\r\n\r\n\r\n\r\n**Describe the problem**\r\n\r\nsudo bazel --output_base=/opt/tensorflow build --config=cuda --config=opt --define framework_shared_object=false tensorflow:libtensorflow_cc.so //tensorflow/tools/pip_package:build_pip_package\r\n\r\n**Any other info / logs**\r\n`./configure`\r\nbuild --action_env PYTHON_BIN_PATH=\"/usr/bin/python\"\r\nbuild --action_env PYTHON_LIB_PATH=\"/home/ryan/catkin_ws/devel/lib/python2.7/dist-packages\"\r\nbuild --python_path=\"/usr/bin/python\"\r\nbuild:ignite --define with_ignite_support=true\r\nbuild:xla --define with_xla_support=true\r\nbuild --action_env TF_NEED_OPENCL_SYCL=\"0\"\r\nbuild --action_env TF_NEED_ROCM=\"0\"\r\nbuild --action_env TF_NEED_CUDA=\"1\"\r\nbuild --action_env CUDA_TOOLKIT_PATH=\"/usr/local/cuda\"\r\nbuild --action_env TF_CUDA_VERSION=\"9.0\"\r\nbuild --action_env CUDNN_INSTALL_PATH=\"/usr/lib/x86_64-linux-gnu\"\r\nbuild --action_env TF_CUDNN_VERSION=\"7\"\r\nbuild --action_env TF_NCCL_VERSION=\"1\"\r\nbuild --action_env TF_CUDA_COMPUTE_CAPABILITIES=\"6.1\"\r\nbuild --action_env LD_LIBRARY_PATH=\"/usr/local/cuda-9.0/lib64:/home/ryan/catkin_ws/devel/lib:/opt/ros/kinetic/lib:/opt/ros/kinetic/lib/x86_64-linux-gnu\"\r\nbuild --action_env TF_CUDA_CLANG=\"0\"\r\nbuild --action_env GCC_HOST_COMPILER_PATH=\"/usr/bin/gcc\"\r\nbuild --config=cuda\r\ntest --config=cuda\r\nbuild:opt --copt=-march=native\r\nbuild:opt --host_copt=-march=native\r\nbuild:opt --define with_default_optimizations=true\r\nbuild:v2 --define=tf_api_version=2\r\n\r\n`build log`\r\nWARNING: The following configs were expanded more than once: [cuda]. For repeatable flags, repeats are counted twice and may lead to unexpected behavior.\r\nDEBUG: /opt/tensorflow/external/bazel_tools/tools/cpp/lib_cc_configure.bzl:115:5: \r\nAuto-Configuration Warning: 'TMP' environment variable is not set, using 'C:\\Windows\\Temp' as default\r\nWARNING: /opt/tensorflow/external/grpc/BUILD:1992:1: in srcs attribute of cc_library rule @grpc//:grpc_nanopb: please do not import '@grpc//third_party/nanopb:pb_common.c' directly. You should either move the file to this package or depend on an appropriate rule there. Since this rule was created by the macro 'grpc_generate_one_off_targets', the error might have been caused by the macro implementation in /opt/tensorflow/external/grpc/bazel/grpc_build_system.bzl:172:12\r\nWARNING: /opt/tensorflow/external/grpc/BUILD:1992:1: in srcs attribute of cc_library rule @grpc//:grpc_nanopb: please do not import '@grpc//third_party/nanopb:pb_decode.c' directly. You should either move the file to this package or depend on an appropriate rule there. Since this rule was created by the macro 'grpc_generate_one_off_targets', the error might have been caused by the macro implementation in /opt/tensorflow/external/grpc/bazel/grpc_build_system.bzl:172:12\r\nWARNING: /opt/tensorflow/external/grpc/BUILD:1992:1: in srcs attribute of cc_library rule @grpc//:grpc_nanopb: please do not import '@grpc//third_party/nanopb:pb_encode.c' directly. You should either move the file to this package or depend on an appropriate rule there. Since this rule was created by the macro 'grpc_generate_one_off_targets', the error might have been caused by the macro implementation in /opt/tensorflow/external/grpc/bazel/grpc_build_system.bzl:172:12\r\nWARNING: /home/ryan/tensorflow/tensorflow/contrib/learn/BUILD:17:1: in py_library rule //tensorflow/contrib/learn:learn: target '//tensorflow/contrib/learn:learn' depends on deprecated target '//tensorflow/contrib/session_bundle:exporter': No longer supported. Switch to SavedModel immediately.\r\nWARNING: /home/ryan/tensorflow/tensorflow/contrib/learn/BUILD:17:1: in py_library rule //tensorflow/contrib/learn:learn: target '//tensorflow/contrib/learn:learn' depends on deprecated target '//tensorflow/contrib/session_bundle:gc': No longer supported. Switch to SavedModel immediately.\r\nWARNING: /home/ryan/tensorflow/tensorflow/contrib/timeseries/python/timeseries/BUILD:354:1: in py_library rule //tensorflow/contrib/timeseries/python/timeseries:ar_model: target '//tensorflow/contrib/timeseries/python/timeseries:ar_model' depends on deprecated target '//tensorflow/contrib/distributions:distributions_py': TensorFlow Distributions has migrated to TensorFlow Probability (https://github.com/tensorflow/probability). Deprecated copies remaining in tf.contrib.distributions are unmaintained, unsupported, and will be removed by late 2018. You should update all usage of `tf.contrib.distributions` to `tfp.distributions`.\r\nWARNING: /home/ryan/tensorflow/tensorflow/contrib/timeseries/python/timeseries/state_space_models/BUILD:230:1: in py_library rule //tensorflow/contrib/timeseries/python/timeseries/state_space_models:filtering_postprocessor: target '//tensorflow/contrib/timeseries/python/timeseries/state_space_models:filtering_postprocessor' depends on deprecated target '//tensorflow/contrib/distributions:distributions_py': TensorFlow Distributions has migrated to TensorFlow Probability (https://github.com/tensorflow/probability). Deprecated copies remaining in tf.contrib.distributions are unmaintained, unsupported, and will be removed by late 2018. You should update all usage of `tf.contrib.distributions` to `tfp.distributions`.\r\nWARNING: /home/ryan/tensorflow/tensorflow/contrib/timeseries/python/timeseries/state_space_models/BUILD:73:1: in py_library rule //tensorflow/contrib/timeseries/python/timeseries/state_space_models:kalman_filter: target '//tensorflow/contrib/timeseries/python/timeseries/state_space_models:kalman_filter' depends on deprecated target '//tensorflow/contrib/distributions:distributions_py': TensorFlow Distributions has migrated to TensorFlow Probability (https://github.com/tensorflow/probability). Deprecated copies remaining in tf.contrib.distributions are unmaintained, unsupported, and will be removed by late 2018. You should update all usage of `tf.contrib.distributions` to `tfp.distributions`.\r\nWARNING: /home/ryan/tensorflow/tensorflow/contrib/seq2seq/BUILD:23:1: in py_library rule //tensorflow/contrib/seq2seq:seq2seq_py: target '//tensorflow/contrib/seq2seq:seq2seq_py' depends on deprecated target '//tensorflow/contrib/distributions:distributions_py': TensorFlow Distributions has migrated to TensorFlow Probability (https://github.com/tensorflow/probability). Deprecated copies remaining in tf.contrib.distributions are unmaintained, unsupported, and will be removed by late 2018. You should update all usage of `tf.contrib.distributions` to `tfp.distributions`.\r\nWARNING: /home/ryan/tensorflow/tensorflow/contrib/bayesflow/BUILD:17:1: in py_library rule //tensorflow/contrib/bayesflow:bayesflow_py: target '//tensorflow/contrib/bayesflow:bayesflow_py' depends on deprecated target '//tensorflow/contrib/distributions:distributions_py': TensorFlow Distributions has migrated to TensorFlow Probability (https://github.com/tensorflow/probability). Deprecated copies remaining in tf.contrib.distributions are unmaintained, unsupported, and will be removed by late 2018. You should update all usage of `tf.contrib.distributions` to `tfp.distributions`.\r\nWARNING: /home/ryan/tensorflow/tensorflow/contrib/BUILD:13:1: in py_library rule //tensorflow/contrib:contrib_py: target '//tensorflow/contrib:contrib_py' depends on deprecated target '//tensorflow/contrib/distributions:distributions_py': TensorFlow Distributions has migrated to TensorFlow Probability (https://github.com/tensorflow/probability). Deprecated copies remaining in tf.contrib.distributions are unmaintained, unsupported, and will be removed by late 2018. You should update all usage of `tf.contrib.distributions` to `tfp.distributions`.\r\nINFO: Analysed 2 targets (0 packages loaded).\r\nINFO: Found 2 targets...\r\nERROR: /home/ryan/tensorflow/tensorflow/contrib/lite/kernels/BUILD:57:1: undeclared inclusion(s) in rule '//tensorflow/contrib/lite/kernels:eigen_support':\r\nthis rule is missing dependency declarations for the following files included by 'tensorflow/contrib/lite/kernels/eigen_support.cc':\r\n  '/opt/tensorflow/external/eigen_archive/Eigen/Core'\r\nINFO: Elapsed time: 3.144s, Critical Path: 2.54s\r\nINFO: 18 processes: 18 local.\r\nFAILED: Build did NOT complete successfully\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32512", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32512/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32512/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32512/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32512", "id": 493549053, "node_id": "MDU6SXNzdWU0OTM1NDkwNTM=", "number": 32512, "title": "Expand checkpoint + SavedModel file formats to include provenance (origin) meta data", "user": {"login": "jxtps", "id": 90846, "node_id": "MDQ6VXNlcjkwODQ2", "avatar_url": "https://avatars0.githubusercontent.com/u/90846?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jxtps", "html_url": "https://github.com/jxtps", "followers_url": "https://api.github.com/users/jxtps/followers", "following_url": "https://api.github.com/users/jxtps/following{/other_user}", "gists_url": "https://api.github.com/users/jxtps/gists{/gist_id}", "starred_url": "https://api.github.com/users/jxtps/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jxtps/subscriptions", "organizations_url": "https://api.github.com/users/jxtps/orgs", "repos_url": "https://api.github.com/users/jxtps/repos", "events_url": "https://api.github.com/users/jxtps/events{/privacy}", "received_events_url": "https://api.github.com/users/jxtps/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-09-13T23:12:10Z", "updated_at": "2019-11-16T06:27:28Z", "closed_at": null, "author_association": "NONE", "body": "I wrote a really nice issue description. Then github made it all disappear when I clicked their shiny new \"Similar issues - Try it!\" feature. I'm too frustrated to retype it. The gist is really in the title: current provenance practice is basically in the filename of the model, which sucks. \r\n\r\nWe should add a field (that should get as auto-populated as possible) to the model outputs to keep track of the story behind the model. "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32495", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32495/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32495/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32495/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32495", "id": 493313818, "node_id": "MDU6SXNzdWU0OTMzMTM4MTg=", "number": 32495, "title": "[r2.0.0-rc1] Converting to TFLite format: Invalid quantization params for op RESHAPE", "user": {"login": "grwlf", "id": 4477729, "node_id": "MDQ6VXNlcjQ0Nzc3Mjk=", "avatar_url": "https://avatars3.githubusercontent.com/u/4477729?v=4", "gravatar_id": "", "url": "https://api.github.com/users/grwlf", "html_url": "https://github.com/grwlf", "followers_url": "https://api.github.com/users/grwlf/followers", "following_url": "https://api.github.com/users/grwlf/following{/other_user}", "gists_url": "https://api.github.com/users/grwlf/gists{/gist_id}", "starred_url": "https://api.github.com/users/grwlf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/grwlf/subscriptions", "organizations_url": "https://api.github.com/users/grwlf/orgs", "repos_url": "https://api.github.com/users/grwlf/repos", "events_url": "https://api.github.com/users/grwlf/events{/privacy}", "received_events_url": "https://api.github.com/users/grwlf/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "suharshs", "id": 1450614, "node_id": "MDQ6VXNlcjE0NTA2MTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/1450614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suharshs", "html_url": "https://github.com/suharshs", "followers_url": "https://api.github.com/users/suharshs/followers", "following_url": "https://api.github.com/users/suharshs/following{/other_user}", "gists_url": "https://api.github.com/users/suharshs/gists{/gist_id}", "starred_url": "https://api.github.com/users/suharshs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suharshs/subscriptions", "organizations_url": "https://api.github.com/users/suharshs/orgs", "repos_url": "https://api.github.com/users/suharshs/repos", "events_url": "https://api.github.com/users/suharshs/events{/privacy}", "received_events_url": "https://api.github.com/users/suharshs/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "suharshs", "id": 1450614, "node_id": "MDQ6VXNlcjE0NTA2MTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/1450614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suharshs", "html_url": "https://github.com/suharshs", "followers_url": "https://api.github.com/users/suharshs/followers", "following_url": "https://api.github.com/users/suharshs/following{/other_user}", "gists_url": "https://api.github.com/users/suharshs/gists{/gist_id}", "starred_url": "https://api.github.com/users/suharshs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suharshs/subscriptions", "organizations_url": "https://api.github.com/users/suharshs/orgs", "repos_url": "https://api.github.com/users/suharshs/repos", "events_url": "https://api.github.com/users/suharshs/events{/privacy}", "received_events_url": "https://api.github.com/users/suharshs/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2019-09-13T13:02:48Z", "updated_at": "2020-02-04T06:52:21Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): **Yes**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): **Ubuntu 18.04.2 LTS**\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): **Source**\r\n- TensorFlow version (use command below): **2.0.0-rc1 commit 59bf33**\r\n- Python version: 3.6.8\r\n- Bazel version (if compiling from source): 0.26.1\r\n- GCC/Compiler version (if compiling from source): 7.4.0\r\n- CUDA/cuDNN version: 10.0.130\r\n- GPU model and memory: NVidia 1080Ti / 11G\r\n\r\n**Describe the current behavior**\r\n\r\nConversion of TF2.0 function containing `softmax` and `reshape` ops to TFLite format fails with the following RuntimeError. Source code of the program is listed in the `Code` section below.\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nRuntimeError                              Traceback (most recent call last)\r\n<ipython-input-4-ec9775ede022> in <module>\r\n----> 1 run()\r\n\r\n~/mironov/hbtest/tflite_softmax_bug_v2.py in run()\r\n     20   converter.optimizations = [tf.lite.Optimize.DEFAULT]\r\n     21\r\n---> 22   tflite_model = converter.convert()\r\n     23   model_file = \"/tmp/tflite_softmax_bug_v2.tflite\"\r\n     24   open(model_file, \"wb\").write(tflite_model)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/lite/python/lite.py in convert(self)\r\n    448     if self._is_calibration_quantize():\r\n    449       result = self._calibrate_quantize_model(result, constants.FLOAT,\r\n--> 450                                               constants.FLOAT)\r\n    451\r\n    452     return result\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/lite/python/lite.py in _calibrate_quantize_model(self, result, inference_input_type, inference_output_type)                                                                             \r\n    237     return calibrate_quantize.calibrate_and_quantize(\r\n    238         self.representative_dataset.input_gen, inference_input_type,\r\n--> 239         inference_output_type, allow_float)\r\n    240\r\n    241   def _get_base_converter_args(self):\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/lite/python/optimize/calibrator.py in calibrate_and_quantize(self, dataset_gen, input_type, output_type, allow_float)                                                                   \r\n     76     return self._calibrator.QuantizeModel(\r\n     77         np.dtype(input_type.as_numpy_dtype()).num,\r\n---> 78         np.dtype(output_type.as_numpy_dtype()).num, allow_float)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/lite/python/optimize/tensorflow_lite_wrap_calibration_wrapper.py in QuantizeModel(self, input_py_type, output_py_type, allow_float)                                                     \r\n    113\r\n    114     def QuantizeModel(self, input_py_type, output_py_type, allow_float):\r\n--> 115         return _tensorflow_lite_wrap_calibration_wrapper.CalibrationWrapper_QuantizeModel(self, input_py_type, output_py_type, allow_float)                                                                                            \r\n    116 CalibrationWrapper_swigregister = _tensorflow_lite_wrap_calibration_wrapper.CalibrationWrapper_swigregister\r\n    117 CalibrationWrapper_swigregister(CalibrationWrapper)\r\n\r\nRuntimeError: Invalid quantization params for op RESHAPE at index 1 in subgraph 0\r\n\r\n```\r\n\r\n**Describe the expected behavior**\r\n\r\n`converter.convert()` call finishes without errors\r\n\r\n\r\n**Code to reproduce the issue**\r\n\r\nFile: `tflite_softmax_bug_v2.py`\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\n@tf.function(input_signature=[\r\n    tf.TensorSpec(shape=[10], dtype=tf.float32, name='inp0')])\r\ndef model(inp0):\r\n  res = tf.nn.softmax(inp0)\r\n  res = tf.reshape(res, [1, 10])\r\n  print(res.shape)\r\n  return res\r\n\r\ndef run():\r\n  def _representative_dataset_gen():\r\n    for i in range(10):\r\n      yield [np.random.random_integers(0, 9, size=[10]).astype('float32'),]\r\n\r\n  cfunc = model.get_concrete_function()\r\n  converter = tf.lite.TFLiteConverter.from_concrete_functions([cfunc])\r\n  converter.representative_dataset = _representative_dataset_gen\r\n  converter.optimizations = [tf.lite.Optimize.DEFAULT]\r\n\r\n  tflite_model = converter.convert()\r\n  model_file = \"/tmp/tflite_softmax_bug_v2.tflite\"\r\n  open(model_file, \"wb\").write(tflite_model)\r\n\r\n  interpreter = tf.lite.Interpreter(model_path=model_file)\r\n  interpreter.allocate_tensors()\r\n\r\nif __name__ == '__main__':\r\n  run()\r\n\r\n```\r\n\r\n**Other info / logs**\r\nN/A"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32492", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32492/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32492/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32492/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32492", "id": 493243631, "node_id": "MDU6SXNzdWU0OTMyNDM2MzE=", "number": 32492, "title": "SIGSEGV", "user": {"login": "shlapfish", "id": 41903293, "node_id": "MDQ6VXNlcjQxOTAzMjkz", "avatar_url": "https://avatars3.githubusercontent.com/u/41903293?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shlapfish", "html_url": "https://github.com/shlapfish", "followers_url": "https://api.github.com/users/shlapfish/followers", "following_url": "https://api.github.com/users/shlapfish/following{/other_user}", "gists_url": "https://api.github.com/users/shlapfish/gists{/gist_id}", "starred_url": "https://api.github.com/users/shlapfish/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shlapfish/subscriptions", "organizations_url": "https://api.github.com/users/shlapfish/orgs", "repos_url": "https://api.github.com/users/shlapfish/repos", "events_url": "https://api.github.com/users/shlapfish/events{/privacy}", "received_events_url": "https://api.github.com/users/shlapfish/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-09-13T10:08:58Z", "updated_at": "2019-09-13T21:23:03Z", "closed_at": null, "author_association": "NONE", "body": "```\r\nimport tensorflow as tf\r\nfrom tensorflow_probability import distributions as tfd\r\n\r\nmu = [1., 2., 3.]\r\nmu = tf.stack([mu, mu], 0)\r\ncov = [[ 0.36,  0.12,  0.06],\r\n       [ 0.12,  0.29, -0.13],\r\n       [ 0.06, -0.13,  0.26]]\r\ncov = tf.stack([cov, cov], 0)\r\nscale = tf.linalg.cholesky(cov)\r\n\r\nmvn = tfd.MultivariateNormalTriL(\r\n    loc=mu,\r\n    scale_tril=scale)\r\n\r\nl = mvn.bijector.scale.to_dense()\r\nl = tf.linalg.triangular_solve(l, tf.eye(3))\r\n```\r\n\r\n**System information**\r\n- Ubuntu 18.04\r\n- TensorFlow installed from binary\r\n- TensorFlow version: 2.0.0-dev20190913\r\n- Python version: 3.7\r\n- No GPU\r\n\r\ngit version: v1.12.1-11024-ge8506e0\r\ntensorflow-probability version: 0.9.0-dev20190913\r\n\r\n**Describe the current behavior**\r\n`Process finished with exit code 139 (interrupted by signal 11: SIGSEGV)`\r\n\r\nSometimes it hangs for a bit, sometimes it doesn't crash. But 2/3 times I get a SIGSEGV.\r\nMost modifications to the posted code somehow solve the crash.\r\n\r\n**Describe the expected behavior**\r\nIt should complain about dimensions that mismatch at the last operation.\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32488", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32488/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32488/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32488/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32488", "id": 493176446, "node_id": "MDU6SXNzdWU0OTMxNzY0NDY=", "number": 32488, "title": "Issue: Structure of Python function inputs does not match input_signature while trying to save a subclassed model", "user": {"login": "datitran", "id": 3866530, "node_id": "MDQ6VXNlcjM4NjY1MzA=", "avatar_url": "https://avatars2.githubusercontent.com/u/3866530?v=4", "gravatar_id": "", "url": "https://api.github.com/users/datitran", "html_url": "https://github.com/datitran", "followers_url": "https://api.github.com/users/datitran/followers", "following_url": "https://api.github.com/users/datitran/following{/other_user}", "gists_url": "https://api.github.com/users/datitran/gists{/gist_id}", "starred_url": "https://api.github.com/users/datitran/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/datitran/subscriptions", "organizations_url": "https://api.github.com/users/datitran/orgs", "repos_url": "https://api.github.com/users/datitran/repos", "events_url": "https://api.github.com/users/datitran/events{/privacy}", "received_events_url": "https://api.github.com/users/datitran/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-09-13T07:27:52Z", "updated_at": "2020-03-19T01:16:27Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Google Colab\r\n- TensorFlow installed from (source or binary): Binary\r\n- TensorFlow version (use command below): v1.14.0-0-g87989f6959 1.14.0 / tensorflow-gpu==2.0.0-rc0\r\n- Python version: 3.6.8\r\n- GPU model and memory: Google Colab (Nvidia T4)\r\n\r\nSimilar to this issue #28165, I have defined the following Encoder class with a tf.function signature hoping to be able to save it using the SavedModel format. In my case, I'm using a LSTM layer though instead of GRUs:\r\n\r\n```\r\nclass Encoder(tf.keras.Model):\r\n    def __init__(self, vocab_size, embedding_size, lstm_size):\r\n        super(Encoder, self).__init__()\r\n        self.lstm_size = lstm_size\r\n        self.embedding = tf.keras.layers.Embedding(vocab_size, embedding_size)\r\n        self.lstm = tf.keras.layers.LSTM(\r\n            lstm_size, return_sequences=True, return_state=True)\r\n\r\n    @tf.function(input_signature=(\r\n        tf.TensorSpec([None, None], tf.int32, name='sequence'),\r\n        (tf.TensorSpec([None, 64], tf.float32, name='states_1'), tf.TensorSpec([None, 64], tf.float32, name='states_2'))\r\n    )) \r\n    def call(self, sequence, states):\r\n        embed = self.embedding(sequence)\r\n        output, state_h, state_c = self.lstm(embed, initial_state=states)\r\n\r\n        return output, state_h, state_c\r\n\r\n    def init_states(self, batch_size):\r\n        return (tf.zeros([batch_size, self.lstm_size]),\r\n                tf.zeros([batch_size, self.lstm_size]))\r\n\r\n# Some more code for training the seq2seq model...\r\n\r\ntf.saved_model.save(\r\n    encoder,  # instance of Encoder\r\n    './some/directory/',\r\n    signatures=encoder.call\r\n)\r\n```\r\nHere's also the Colab notebook to reproduce the results: [Google Colab Link](https://colab.research.google.com/drive/11rgiI7oYT9uiRWG3ZT9NvRhuRJ5ubEQY)\r\n\r\nSince the issue was closed I hope it would work now but now I get this weird error that the Python function input does not match the input_signature although they clearly match each other:\r\n\r\n```\r\nValueError: Structure of Python function inputs does not match input_signature:\r\n  inputs: (\r\n    [<tf.Tensor 'sequence:0' shape=(None, None) dtype=int32>, (<tf.Tensor 'states_1:0' shape=(None, 64) dtype=float32>, <tf.Tensor 'states_2:0' shape=(None, 64) dtype=float32>)])\r\n  input_signature: (\r\n    TensorSpec(shape=(None, None), dtype=tf.int32, name='sequence'),\r\n    (TensorSpec(shape=(None, 64), dtype=tf.float32, name='states_1'), TensorSpec(shape=(None, 64), dtype=tf.float32, name='states_2')))\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32468", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32468/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32468/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32468/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32468", "id": 492857889, "node_id": "MDU6SXNzdWU0OTI4NTc4ODk=", "number": 32468, "title": "TF Micro requires CONV_2D version '2' when applying quantization", "user": {"login": "dustedduke", "id": 9148822, "node_id": "MDQ6VXNlcjkxNDg4MjI=", "avatar_url": "https://avatars1.githubusercontent.com/u/9148822?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dustedduke", "html_url": "https://github.com/dustedduke", "followers_url": "https://api.github.com/users/dustedduke/followers", "following_url": "https://api.github.com/users/dustedduke/following{/other_user}", "gists_url": "https://api.github.com/users/dustedduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/dustedduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dustedduke/subscriptions", "organizations_url": "https://api.github.com/users/dustedduke/orgs", "repos_url": "https://api.github.com/users/dustedduke/repos", "events_url": "https://api.github.com/users/dustedduke/events{/privacy}", "received_events_url": "https://api.github.com/users/dustedduke/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "suharshs", "id": 1450614, "node_id": "MDQ6VXNlcjE0NTA2MTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/1450614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suharshs", "html_url": "https://github.com/suharshs", "followers_url": "https://api.github.com/users/suharshs/followers", "following_url": "https://api.github.com/users/suharshs/following{/other_user}", "gists_url": "https://api.github.com/users/suharshs/gists{/gist_id}", "starred_url": "https://api.github.com/users/suharshs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suharshs/subscriptions", "organizations_url": "https://api.github.com/users/suharshs/orgs", "repos_url": "https://api.github.com/users/suharshs/repos", "events_url": "https://api.github.com/users/suharshs/events{/privacy}", "received_events_url": "https://api.github.com/users/suharshs/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "suharshs", "id": 1450614, "node_id": "MDQ6VXNlcjE0NTA2MTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/1450614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suharshs", "html_url": "https://github.com/suharshs", "followers_url": "https://api.github.com/users/suharshs/followers", "following_url": "https://api.github.com/users/suharshs/following{/other_user}", "gists_url": "https://api.github.com/users/suharshs/gists{/gist_id}", "starred_url": "https://api.github.com/users/suharshs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suharshs/subscriptions", "organizations_url": "https://api.github.com/users/suharshs/orgs", "repos_url": "https://api.github.com/users/suharshs/repos", "events_url": "https://api.github.com/users/suharshs/events{/privacy}", "received_events_url": "https://api.github.com/users/suharshs/received_events", "type": "User", "site_admin": false}, {"login": "njeffrie", "id": 6947391, "node_id": "MDQ6VXNlcjY5NDczOTE=", "avatar_url": "https://avatars2.githubusercontent.com/u/6947391?v=4", "gravatar_id": "", "url": "https://api.github.com/users/njeffrie", "html_url": "https://github.com/njeffrie", "followers_url": "https://api.github.com/users/njeffrie/followers", "following_url": "https://api.github.com/users/njeffrie/following{/other_user}", "gists_url": "https://api.github.com/users/njeffrie/gists{/gist_id}", "starred_url": "https://api.github.com/users/njeffrie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/njeffrie/subscriptions", "organizations_url": "https://api.github.com/users/njeffrie/orgs", "repos_url": "https://api.github.com/users/njeffrie/repos", "events_url": "https://api.github.com/users/njeffrie/events{/privacy}", "received_events_url": "https://api.github.com/users/njeffrie/received_events", "type": "User", "site_admin": false}, {"login": "rockyrhodes", "id": 7253968, "node_id": "MDQ6VXNlcjcyNTM5Njg=", "avatar_url": "https://avatars2.githubusercontent.com/u/7253968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rockyrhodes", "html_url": "https://github.com/rockyrhodes", "followers_url": "https://api.github.com/users/rockyrhodes/followers", "following_url": "https://api.github.com/users/rockyrhodes/following{/other_user}", "gists_url": "https://api.github.com/users/rockyrhodes/gists{/gist_id}", "starred_url": "https://api.github.com/users/rockyrhodes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rockyrhodes/subscriptions", "organizations_url": "https://api.github.com/users/rockyrhodes/orgs", "repos_url": "https://api.github.com/users/rockyrhodes/repos", "events_url": "https://api.github.com/users/rockyrhodes/events{/privacy}", "received_events_url": "https://api.github.com/users/rockyrhodes/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 16, "created_at": "2019-09-12T14:53:23Z", "updated_at": "2020-03-09T01:30:00Z", "closed_at": null, "author_association": "NONE", "body": "- Have I written custom code: Yes\r\n- OS Platform and Distribution: Ubuntu 18.04\r\n- TensorFlow version: 1.14, 2.0-rc0, nightly-preview 2.0.0.dev20190911\r\n- Python version: 3.7.4\r\n\r\nI am trying to run a simple Keras model with TensorFlow version for microcontrollers (modified micro_vision example with several convolutions, dense layers and batch normalization). While the model works correctly when using floats, the quantized version generated with `tf.lite.Optimize.DEFAULT` outputs wrong values and `'Didn't find op for builtin opcode 'CONV_2D' version '2' Invoke failed.'` error.\r\n\r\nAfter changing `CONV_2D` version with `AddBuiltin(BuiltinOperator_CONV_2D, Register_CONV_2D(), 1, 2)` in `all_ops_resolver.cc` the error disappeared, but now the model outputs NaN instead of normal output and I'm not sure if it actually uses a different micro kernel.\r\n\r\nAfter trying multiple conversion techniques (from .h5, model itself, SavedModel folder etc.) with multiple TF versions and BatchNormalization removal, the situation remains the same. As far as I understand, each way to quantize the model (post-training quantization, quantization aware training) requires this version of `CONV2D`, but it seems to work incorrectly or there is no such version in TF micro.\r\n\r\nIs there any way to deploy such a model with quantization?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32460", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32460/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32460/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32460/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32460", "id": 492682096, "node_id": "MDU6SXNzdWU0OTI2ODIwOTY=", "number": 32460, "title": "Executor error message in GradientTape.jacobian", "user": {"login": "jl-wynen", "id": 11393224, "node_id": "MDQ6VXNlcjExMzkzMjI0", "avatar_url": "https://avatars2.githubusercontent.com/u/11393224?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jl-wynen", "html_url": "https://github.com/jl-wynen", "followers_url": "https://api.github.com/users/jl-wynen/followers", "following_url": "https://api.github.com/users/jl-wynen/following{/other_user}", "gists_url": "https://api.github.com/users/jl-wynen/gists{/gist_id}", "starred_url": "https://api.github.com/users/jl-wynen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jl-wynen/subscriptions", "organizations_url": "https://api.github.com/users/jl-wynen/orgs", "repos_url": "https://api.github.com/users/jl-wynen/repos", "events_url": "https://api.github.com/users/jl-wynen/events{/privacy}", "received_events_url": "https://api.github.com/users/jl-wynen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-09-12T09:12:20Z", "updated_at": "2020-01-09T12:47:18Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux-4.14.141-1-MANJARO-x86_64-with-arch-Manjaro-Linux\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: /\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): v2.0.0-beta1-5101-gc75bb66 2.0.0-rc0\r\n- Python version: 3.7.4\r\n- Bazel version (if compiling from source): /\r\n- GCC/Compiler version (if compiling from source): /\r\n- CUDA/cuDNN version: /\r\n- GPU model and memory: /\r\n\r\n**Describe the current behavior**\r\nI am calculating the Jacobian of a model with respect to its parameters using a gradient tape. The method `GradientTape.jacobian` outputs an error message about a missing function library. The program does not abort however and the computed Jacobian is correct.\r\n\r\n**Describe the expected behavior**\r\nThere should be no error message.\r\n\r\n**Code to reproduce the issue**\r\n```python\r\nimport tensorflow as tf\r\nfrom tensorflow import keras\r\n\r\nmodel = keras.Sequential([\r\n    keras.layers.Dense(2, input_shape=(2,)),\r\n])\r\ninputs = tf.Variable([[1, 2]], dtype=tf.float32)\r\n\r\nwith tf.GradientTape() as gtape:\r\n    outputs = model(inputs)\r\ngtape.jacobian(outputs, model.trainable_variables)\r\n```\r\n\r\n**Other info / logs**\r\nThe full output of the program shown above is:\r\n```\r\n2019-09-12 11:01:04.479226: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2019-09-12 11:01:04.498159: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2304500000 Hz\r\n2019-09-12 11:01:04.498584: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556260300c60 executing computations on platform Host. Devices:\r\n2019-09-12 11:01:04.498609: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version\r\n2019-09-12 11:01:04.630899: E tensorflow/core/common_runtime/executor.cc:642] Executor failed to create kernel. Internal: No function library\r\n\t [[{{node loop_body/MatMul_1/pfor/cond}}]]\r\n```\r\nWith additional layers, more error messages like the one quoted above appear, one per matrix multiplication.\r\nThe problem persists when the Jacobian calculation is moved into a `tf.function` decorated function."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32457", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32457/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32457/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32457/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32457", "id": 492618713, "node_id": "MDU6SXNzdWU0OTI2MTg3MTM=", "number": 32457, "title": "[TF 2.0] Feature request: let autograph accept collection inputs", "user": {"login": "David-Mao", "id": 12476624, "node_id": "MDQ6VXNlcjEyNDc2NjI0", "avatar_url": "https://avatars3.githubusercontent.com/u/12476624?v=4", "gravatar_id": "", "url": "https://api.github.com/users/David-Mao", "html_url": "https://github.com/David-Mao", "followers_url": "https://api.github.com/users/David-Mao/followers", "following_url": "https://api.github.com/users/David-Mao/following{/other_user}", "gists_url": "https://api.github.com/users/David-Mao/gists{/gist_id}", "starred_url": "https://api.github.com/users/David-Mao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/David-Mao/subscriptions", "organizations_url": "https://api.github.com/users/David-Mao/orgs", "repos_url": "https://api.github.com/users/David-Mao/repos", "events_url": "https://api.github.com/users/David-Mao/events{/privacy}", "received_events_url": "https://api.github.com/users/David-Mao/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1190546177, "node_id": "MDU6TGFiZWwxMTkwNTQ2MTc3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:autograph", "name": "comp:autograph", "color": "0052cc", "default": false, "description": ""}, {"id": 1478826728, "node_id": "MDU6TGFiZWwxNDc4ODI2NzI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:core", "name": "comp:core", "color": "024391", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mdanatg", "id": 26628547, "node_id": "MDQ6VXNlcjI2NjI4NTQ3", "avatar_url": "https://avatars1.githubusercontent.com/u/26628547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mdanatg", "html_url": "https://github.com/mdanatg", "followers_url": "https://api.github.com/users/mdanatg/followers", "following_url": "https://api.github.com/users/mdanatg/following{/other_user}", "gists_url": "https://api.github.com/users/mdanatg/gists{/gist_id}", "starred_url": "https://api.github.com/users/mdanatg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mdanatg/subscriptions", "organizations_url": "https://api.github.com/users/mdanatg/orgs", "repos_url": "https://api.github.com/users/mdanatg/repos", "events_url": "https://api.github.com/users/mdanatg/events{/privacy}", "received_events_url": "https://api.github.com/users/mdanatg/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mdanatg", "id": 26628547, "node_id": "MDQ6VXNlcjI2NjI4NTQ3", "avatar_url": "https://avatars1.githubusercontent.com/u/26628547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mdanatg", "html_url": "https://github.com/mdanatg", "followers_url": "https://api.github.com/users/mdanatg/followers", "following_url": "https://api.github.com/users/mdanatg/following{/other_user}", "gists_url": "https://api.github.com/users/mdanatg/gists{/gist_id}", "starred_url": "https://api.github.com/users/mdanatg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mdanatg/subscriptions", "organizations_url": "https://api.github.com/users/mdanatg/orgs", "repos_url": "https://api.github.com/users/mdanatg/repos", "events_url": "https://api.github.com/users/mdanatg/events{/privacy}", "received_events_url": "https://api.github.com/users/mdanatg/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-09-12T06:49:43Z", "updated_at": "2019-11-19T15:24:07Z", "closed_at": null, "author_association": "NONE", "body": "\r\n**System information**\r\n- TensorFlow version (you are using): 2.0.0-dev20190901\r\n- Are you willing to contribute it (Yes/No): No\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\nCurrently it seems to me that there is no way to convert a function to graph if the input of the function is a variant length list of elements (except the simplest case when the elements themselves are all tensors with the same shape, for which we can use a TensorArray). \r\n\r\nAssume we have a function that runs well in graph mode for a certain type of input, say a tensor tuple containing 2 tensors with arbitrary shape:\r\n\r\n```\r\n@tf.function(input_signature=[(tf.TensorSpec(None), tf.TensorSpec(None))])\r\ndef do_something(input):\r\n    ....\r\n    return some_result\r\n```\r\n\r\nWe want to have another function that takes undetermined number of `input`s and merge the result, so we have:\r\n\r\n```\r\ndef merge(list_of_inputs):\r\n    return tf.reduce_sum(tf.stack([do_something(input) for input in list_of_inputs]))\r\n```\r\n\r\nThis function works well in eager mode, but we cannot add a `@tf.function` decorator to it, because `list_of_inputs` has no fixed length and the function will retrace for every calls, which is very slow. Even if we can pad the `list_of_inputs` to have the same length, it's still not working as the shapes of the elements might vary across different runs, so retracing will still be triggered.\r\n\r\nSo it would be great if we have something like `tf.Array`and `tf.ArraySpec`, which is defined as an array of objects that share the same specs. Then we can give the `merge` function a decorator like:\r\n\r\n```\r\n@tf.function(input_signature=[\r\n    tf.ArraySpec((tf.TensorSpec(None), tf.TensorSpec(None)))])\r\ndef merge(list_of_inputs):\r\n    return tf.reduce_sum(tf.stack([do_something(input) for input in list_of_inputs]))\r\n```\r\n and run it without retracing.\r\n\r\n**Will this change the current api? How?**\r\n\r\nAs described above, we propose to add `tf.Array`and `tf.ArraySpec`.\r\n\r\n**Who will benefit with this feature?**\r\n\r\nAnyone uses autograph will benefit. It would be much easier to write code that handles the case when a data example contains a set/list of variant number of objects, which is very common in NLP / vision / knowledge graph and so on.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32454", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32454/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32454/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32454/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32454", "id": 492569349, "node_id": "MDU6SXNzdWU0OTI1NjkzNDk=", "number": 32454, "title": "Calling tf.function from tf.py_function in dataset.map hangs.", "user": {"login": "makercob", "id": 6904036, "node_id": "MDQ6VXNlcjY5MDQwMzY=", "avatar_url": "https://avatars2.githubusercontent.com/u/6904036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/makercob", "html_url": "https://github.com/makercob", "followers_url": "https://api.github.com/users/makercob/followers", "following_url": "https://api.github.com/users/makercob/following{/other_user}", "gists_url": "https://api.github.com/users/makercob/gists{/gist_id}", "starred_url": "https://api.github.com/users/makercob/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/makercob/subscriptions", "organizations_url": "https://api.github.com/users/makercob/orgs", "repos_url": "https://api.github.com/users/makercob/repos", "events_url": "https://api.github.com/users/makercob/events{/privacy}", "received_events_url": "https://api.github.com/users/makercob/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 1478826728, "node_id": "MDU6TGFiZWwxNDc4ODI2NzI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:core", "name": "comp:core", "color": "024391", "default": false, "description": ""}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 736653459, "node_id": "MDU6TGFiZWw3MzY2NTM0NTk=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:eager", "name": "comp:eager", "color": "0052cc", "default": false, "description": ""}, {"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mhong", "id": 969799, "node_id": "MDQ6VXNlcjk2OTc5OQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/969799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mhong", "html_url": "https://github.com/mhong", "followers_url": "https://api.github.com/users/mhong/followers", "following_url": "https://api.github.com/users/mhong/following{/other_user}", "gists_url": "https://api.github.com/users/mhong/gists{/gist_id}", "starred_url": "https://api.github.com/users/mhong/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mhong/subscriptions", "organizations_url": "https://api.github.com/users/mhong/orgs", "repos_url": "https://api.github.com/users/mhong/repos", "events_url": "https://api.github.com/users/mhong/events{/privacy}", "received_events_url": "https://api.github.com/users/mhong/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mhong", "id": 969799, "node_id": "MDQ6VXNlcjk2OTc5OQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/969799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mhong", "html_url": "https://github.com/mhong", "followers_url": "https://api.github.com/users/mhong/followers", "following_url": "https://api.github.com/users/mhong/following{/other_user}", "gists_url": "https://api.github.com/users/mhong/gists{/gist_id}", "starred_url": "https://api.github.com/users/mhong/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mhong/subscriptions", "organizations_url": "https://api.github.com/users/mhong/orgs", "repos_url": "https://api.github.com/users/mhong/repos", "events_url": "https://api.github.com/users/mhong/events{/privacy}", "received_events_url": "https://api.github.com/users/mhong/received_events", "type": "User", "site_admin": false}, {"login": "qqfish", "id": 1269299, "node_id": "MDQ6VXNlcjEyNjkyOTk=", "avatar_url": "https://avatars3.githubusercontent.com/u/1269299?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qqfish", "html_url": "https://github.com/qqfish", "followers_url": "https://api.github.com/users/qqfish/followers", "following_url": "https://api.github.com/users/qqfish/following{/other_user}", "gists_url": "https://api.github.com/users/qqfish/gists{/gist_id}", "starred_url": "https://api.github.com/users/qqfish/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qqfish/subscriptions", "organizations_url": "https://api.github.com/users/qqfish/orgs", "repos_url": "https://api.github.com/users/qqfish/repos", "events_url": "https://api.github.com/users/qqfish/events{/privacy}", "received_events_url": "https://api.github.com/users/qqfish/received_events", "type": "User", "site_admin": false}, {"login": "mdanatg", "id": 26628547, "node_id": "MDQ6VXNlcjI2NjI4NTQ3", "avatar_url": "https://avatars1.githubusercontent.com/u/26628547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mdanatg", "html_url": "https://github.com/mdanatg", "followers_url": "https://api.github.com/users/mdanatg/followers", "following_url": "https://api.github.com/users/mdanatg/following{/other_user}", "gists_url": "https://api.github.com/users/mdanatg/gists{/gist_id}", "starred_url": "https://api.github.com/users/mdanatg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mdanatg/subscriptions", "organizations_url": "https://api.github.com/users/mdanatg/orgs", "repos_url": "https://api.github.com/users/mdanatg/repos", "events_url": "https://api.github.com/users/mdanatg/events{/privacy}", "received_events_url": "https://api.github.com/users/mdanatg/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-09-12T03:46:44Z", "updated_at": "2019-10-04T18:35:24Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes.\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): macOS or Windows.\r\n- TensorFlow installed from (source or binary): binary.\r\n- TensorFlow version (use command below):2.0.0b1/rc0/rc1\r\n- Python version: 3.6.\r\n- CUDA/cuDNN version: 10.0\r\n- GPU model and memory: Tesla K80\r\n\r\n**Describe the current behavior**\r\nCalling tf.function from tf.py_function in dataset.map hangs the program.\r\nBy removing tf.function decorator or enable run_functions_eagerly, program runs as expected.\r\n\r\n**Describe the expected behavior**\r\nCalling tf.function from tf.py_function does not hang the program.\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n```\r\nimport tensorflow as tf\r\n\r\n@tf.function\r\ndef generate_feature(key):\r\n    if key > tf.constant(-1):\r\n        x = tf.random.uniform(shape=(), minval=0.0, maxval=20.0)\r\n        y = tf.random.uniform(shape=(), minval=0.0, maxval=20.0)\r\n    else:\r\n        x = tf.random.uniform(shape=(), minval=40.0, maxval=100.0)\r\n        y = tf.random.uniform(shape=(), minval=40.0, maxval=100.0)\r\n    x = tf.math.sign(tf.random.uniform(shape=(), minval=-1.0, maxval=1.0)) * tf.abs(x)\r\n    y = tf.math.sign(tf.random.uniform(shape=(), minval=-1.0, maxval=1.0)) * tf.abs(y)\r\n    return tf.stack([x, y])\r\n\r\ndef generate_feature_and_label(key):\r\n    feature = generate_feature(key)\r\n    if key > -1:\r\n        label = tf.constant(1)\r\n    else:\r\n        label = tf.constant(0)\r\n    return feature, label\r\n\r\ndef dataset_map(key):\r\n    feature, label = tf.py_function(func=generate_feature_and_label,\r\n                                    inp=[key],\r\n                                    Tout=[tf.float32, tf.int32])\r\n    feature = tf.ensure_shape(feature, [2])\r\n    label = tf.ensure_shape(label, [])\r\n    return feature, label\r\n\r\nif __name__ == '__main__':\r\n    print(tf.__version__)\r\n    # remove tf.function decorator or enable run_functions_eagerly to run successfully\r\n\r\n    # tf.config.experimental_run_functions_eagerly(True)\r\n    keys = list(range(-1000, 1000))\r\n    dataset = tf.data.Dataset.from_tensor_slices(keys)\r\n    dataset = dataset.repeat()\r\n    dataset = dataset.shuffle(buffer_size=len(keys))\r\n    dataset = dataset.map(map_func=dataset_map,\r\n                          num_parallel_calls=tf.data.experimental.AUTOTUNE)\r\n    dataset = dataset.batch(4)\r\n\r\n    it = iter(dataset)\r\n    while True:\r\n        features, labels = next(it)\r\n        print(f'labels={labels}, features={features}')\r\n        input('press any key to continue...\\r\\n')\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32453", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32453/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32453/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32453/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32453", "id": 492545941, "node_id": "MDU6SXNzdWU0OTI1NDU5NDE=", "number": 32453, "title": "Add tfrecord support to saved_model_cli", "user": {"login": "fsx950223", "id": 17592563, "node_id": "MDQ6VXNlcjE3NTkyNTYz", "avatar_url": "https://avatars0.githubusercontent.com/u/17592563?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fsx950223", "html_url": "https://github.com/fsx950223", "followers_url": "https://api.github.com/users/fsx950223/followers", "following_url": "https://api.github.com/users/fsx950223/following{/other_user}", "gists_url": "https://api.github.com/users/fsx950223/gists{/gist_id}", "starred_url": "https://api.github.com/users/fsx950223/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fsx950223/subscriptions", "organizations_url": "https://api.github.com/users/fsx950223/orgs", "repos_url": "https://api.github.com/users/fsx950223/repos", "events_url": "https://api.github.com/users/fsx950223/events{/privacy}", "received_events_url": "https://api.github.com/users/fsx950223/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-09-12T02:04:24Z", "updated_at": "2019-09-25T02:29:51Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): 1.14\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\n``` bash\r\nsaved_model_cli run --inputs=\"x=/tmp/example.[npy,npz]\" --dir=<model-dir> --tag_set=serve --signature_def=serving_default\r\n```\r\nsaved_model_cli does not support tfrecord as inputs \r\n**Will this change the current api? How?**\r\n``` bash\r\nsaved_model_cli run --inputs=/tmp/example.tfrecord --dir=<model-dir> --tag_set=serve --signature_def=serving_default\r\n```\r\n**Who will benefit with this feature?**\r\nDevelopers always use tfrecord to warm up serving, it will be more convenient for them to use tfrecord as saved_model_cli run inputs.\r\n**Any Other info.**\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32452", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32452/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32452/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32452/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32452", "id": 492531007, "node_id": "MDU6SXNzdWU0OTI1MzEwMDc=", "number": 32452, "title": "Unimplemented: this graph contains an operator of type Abs for which the quantized form is not yet implemented", "user": {"login": "dipali-ruchier", "id": 31741032, "node_id": "MDQ6VXNlcjMxNzQxMDMy", "avatar_url": "https://avatars1.githubusercontent.com/u/31741032?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dipali-ruchier", "html_url": "https://github.com/dipali-ruchier", "followers_url": "https://api.github.com/users/dipali-ruchier/followers", "following_url": "https://api.github.com/users/dipali-ruchier/following{/other_user}", "gists_url": "https://api.github.com/users/dipali-ruchier/gists{/gist_id}", "starred_url": "https://api.github.com/users/dipali-ruchier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dipali-ruchier/subscriptions", "organizations_url": "https://api.github.com/users/dipali-ruchier/orgs", "repos_url": "https://api.github.com/users/dipali-ruchier/repos", "events_url": "https://api.github.com/users/dipali-ruchier/events{/privacy}", "received_events_url": "https://api.github.com/users/dipali-ruchier/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-09-12T00:50:43Z", "updated_at": "2019-10-23T00:31:38Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No. Got Insightface trained model directly from https://drive.google.com/open?id=1Iw2Ckz_BnHZUi78USlaFreZXylJj7hnP\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: NA\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: v1.12.1-9365-gff401a6 1.15.0-dev20190821\r\n- **Python version**: 3.5.2\r\n- **Bazel version (if compiling from source)**: Not installed\r\n- **GCC/Compiler version (if compiling from source)**: c++ (Ubuntu 8.1.0-5ubuntu1~16.04) 8.1.0\r\n- **CUDA/cuDNN version**: CPU only\r\n- **GPU model and memory**: CPU only\r\n- **Exact command to reproduce**: tflite_convert \\\r\n--output_file=insightface_quant.tflite \\\r\n--graph_def_file=insightface.pb \\\r\n--inference_type=QUANTIZED_UINT8 \\\r\n--mean_values=128 \\\r\n--std_dev_values=128 \\\r\n--input_arrays=img_inputs \\\r\n--output_arrays=resnet_v1_50/E_BN2/Identity \\\r\n--default_range_min=0 \\\r\n--default_range_max=127\r\n\r\n\r\n### Describe the problem\r\nI am trying to convert insightface pre-trained model so that I can run it on EdgeTPU. First, I am trying to convert the .pb model into tflite model with both weights and activations quantized to 8bit integer. That's when I get the error below. Is the support for operator Abs coming soon?\r\n2019-09-11 16:41:12.872535: W tensorflow/lite/toco/graph_transformations/quantize.cc:139] Constant array resnet_v1_50/conv1/W_conv2d lacks MinMax information. To make up for that, we will now compute the MinMax from actual array elements. That will result in quantization parameters that probably do not match whichever arithmetic was used during training, and thus will probably be a cause of poor inference accuracy.\r\n2019-09-11 16:41:12.872690: F ./tensorflow/lite/toco/toco_tooling.h:38] Check failed: s.ok() Unimplemented: this graph contains an operator of type Abs for which the quantized form is not yet implemented. Sorry, and patches welcome (that's a relatively fun patch to write, mostly providing the actual quantized arithmetic code for this op).\r\nFatal Python error: Aborted\r\n\r\n\r\n### Source code / logs\r\nWARNING: Logging before flag parsing goes to stderr.\r\nW0911 16:39:50.219565 140227897026304 __init__.py:690] \r\n\r\n  TensorFlow's `tf-nightly` package will soon be updated to TensorFlow 2.0.\r\n\r\n  Please upgrade your code to TensorFlow 2.0:\r\n    * https://www.tensorflow.org/beta/guide/migration_guide\r\n\r\n  Or install the latest stable TensorFlow 1.X release:\r\n    * `pip install -U \"tensorflow==1.*\"`\r\n\r\n  Otherwise your code may be broken by the change.\r\n\r\n  \r\n2019-09-11 16:39:50.225242: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2019-09-11 16:39:50.246574: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3504000000 Hz\r\n2019-09-11 16:39:50.246796: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x490a580 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n2019-09-11 16:39:50.246817: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\nTraceback (most recent call last):\r\n  File \"/home/crossbar/.local/bin/tflite_convert\", line 10, in <module>\r\n    sys.exit(main())\r\n  File \"/home/crossbar/.local/lib/python3.5/site-packages/tensorflow_core/lite/python/tflite_convert.py\", line 515, in main\r\n    app.run(main=run_main, argv=sys.argv[:1])\r\n  File \"/home/crossbar/.local/lib/python3.5/site-packages/tensorflow_core/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/home/crossbar/.local/lib/python3.5/site-packages/absl/app.py\", line 300, in run\r\n    _run_main(main, args)\r\n  File \"/home/crossbar/.local/lib/python3.5/site-packages/absl/app.py\", line 251, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/home/crossbar/.local/lib/python3.5/site-packages/tensorflow_core/lite/python/tflite_convert.py\", line 511, in run_main\r\n    _convert_tf1_model(tflite_flags)\r\n  File \"/home/crossbar/.local/lib/python3.5/site-packages/tensorflow_core/lite/python/tflite_convert.py\", line 199, in _convert_tf1_model\r\n    output_data = converter.convert()\r\n  File \"/home/crossbar/.local/lib/python3.5/site-packages/tensorflow_core/lite/python/lite.py\", line 983, in convert\r\n    **converter_kwargs)\r\n  File \"/home/crossbar/.local/lib/python3.5/site-packages/tensorflow_core/lite/python/convert.py\", line 449, in toco_convert_impl\r\n    enable_mlir_converter=enable_mlir_converter)\r\n  File \"/home/crossbar/.local/lib/python3.5/site-packages/tensorflow_core/lite/python/convert.py\", line 200, in toco_convert_protos\r\n    raise ConverterError(\"See console for info.\\n%s\\n%s\\n\" % (stdout, stderr))\r\ntensorflow.lite.python.convert.ConverterError: See console for info.\r\nWARNING: Logging before flag parsing goes to stderr.\r\nW0911 16:39:52.657464 140689256613632 __init__.py:690] \r\n\r\n  TensorFlow's `tf-nightly` package will soon be updated to TensorFlow 2.0.\r\n\r\n  Please upgrade your code to TensorFlow 2.0:\r\n    * https://www.tensorflow.org/beta/guide/migration_guide\r\n\r\n  Or install the latest stable TensorFlow 1.X release:\r\n    * `pip install -U \"tensorflow==1.*\"`\r\n\r\n  Otherwise your code may be broken by the change.\r\n\r\n  \r\n2019-09-11 16:39:53.139500: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 1363 operators, 1866 arrays (0 quantized)\r\n2019-09-11 16:39:53.171158: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 1363 operators, 1866 arrays (0 quantized)\r\n2019-09-11 16:39:53.395100: W tensorflow/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:88] RandomUniform op outputting \"resnet_v1_50/E_Dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\r\n2019-09-11 16:39:53.398795: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 1: 292 operators, 508 arrays (1 quantized)\r\n2019-09-11 16:39:53.536832: W tensorflow/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:88] RandomUniform op outputting \"resnet_v1_50/E_Dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\r\n2019-09-11 16:39:53.545258: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 2: 291 operators, 507 arrays (1 quantized)\r\n2019-09-11 16:39:53.549759: W tensorflow/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:88] RandomUniform op outputting \"resnet_v1_50/E_Dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\r\n2019-09-11 16:39:53.561449: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 3: 288 operators, 501 arrays (1 quantized)\r\n2019-09-11 16:39:53.562454: W tensorflow/lite/toco/graph_transformations/resolve_constant_random_uniform.cc:88] RandomUniform op outputting \"resnet_v1_50/E_Dropout/random_uniform/RandomUniform\" is truly random (using /dev/random system entropy). Therefore, cannot resolve as constant. Set \"seed\" or \"seed2\" attr non-zero to fix this\r\n2019-09-11 16:39:53.567925: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before pre-quantization graph transformations: 288 operators, 501 arrays (1 quantized)\r\n2019-09-11 16:39:53.570066: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before Group bidirectional sequence lstm/rnn: 288 operators, 501 arrays (1 quantized)\r\n2019-09-11 16:39:53.573091: F tensorflow/lite/toco/tooling_util.cc:1728] Array resnet_v1_50/bn0/batchnorm/add_1, which is an input to the Abs operator producing the output array resnet_v1_50/prelu0/Abs, is lacking min/max data, which is necessary for quantization. If accuracy matters, either target a non-quantized output format, or run quantized training with your model from a floating point checkpoint to change the input graph to contain min/max information. If you don't care about accuracy, you can pass --default_ranges_min= and --default_ranges_max= for easy experimentation.\r\nFatal Python error: Aborted\r\n\r\nCurrent thread 0x00007ff4c52a0700 (most recent call first):\r\n  File \"/home/crossbar/.local/lib/python3.5/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 52 in execute\r\n  File \"/home/crossbar/.local/lib/python3.5/site-packages/absl/app.py\", line 251 in _run_main\r\n  File \"/home/crossbar/.local/lib/python3.5/site-packages/absl/app.py\", line 300 in run\r\n  File \"/home/crossbar/.local/lib/python3.5/site-packages/tensorflow_core/python/platform/app.py\", line 40 in run\r\n  File \"/home/crossbar/.local/lib/python3.5/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 89 in main\r\n  File \"/home/crossbar/.local/bin/toco_from_protos\", line 10 in <module>\r\nAborted (core dumped)\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32449", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32449/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32449/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32449/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32449", "id": 492519444, "node_id": "MDU6SXNzdWU0OTI1MTk0NDQ=", "number": 32449, "title": "C API: Unexpected behaviour when multithreading calls of c_api's TF_SessionRun", "user": {"login": "Nucs", "id": 649919, "node_id": "MDQ6VXNlcjY0OTkxOQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/649919?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nucs", "html_url": "https://github.com/Nucs", "followers_url": "https://api.github.com/users/Nucs/followers", "following_url": "https://api.github.com/users/Nucs/following{/other_user}", "gists_url": "https://api.github.com/users/Nucs/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nucs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nucs/subscriptions", "organizations_url": "https://api.github.com/users/Nucs/orgs", "repos_url": "https://api.github.com/users/Nucs/repos", "events_url": "https://api.github.com/users/Nucs/events{/privacy}", "received_events_url": "https://api.github.com/users/Nucs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ebrevdo", "id": 1794715, "node_id": "MDQ6VXNlcjE3OTQ3MTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1794715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebrevdo", "html_url": "https://github.com/ebrevdo", "followers_url": "https://api.github.com/users/ebrevdo/followers", "following_url": "https://api.github.com/users/ebrevdo/following{/other_user}", "gists_url": "https://api.github.com/users/ebrevdo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebrevdo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebrevdo/subscriptions", "organizations_url": "https://api.github.com/users/ebrevdo/orgs", "repos_url": "https://api.github.com/users/ebrevdo/repos", "events_url": "https://api.github.com/users/ebrevdo/events{/privacy}", "received_events_url": "https://api.github.com/users/ebrevdo/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ebrevdo", "id": 1794715, "node_id": "MDQ6VXNlcjE3OTQ3MTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1794715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebrevdo", "html_url": "https://github.com/ebrevdo", "followers_url": "https://api.github.com/users/ebrevdo/followers", "following_url": "https://api.github.com/users/ebrevdo/following{/other_user}", "gists_url": "https://api.github.com/users/ebrevdo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebrevdo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebrevdo/subscriptions", "organizations_url": "https://api.github.com/users/ebrevdo/orgs", "repos_url": "https://api.github.com/users/ebrevdo/repos", "events_url": "https://api.github.com/users/ebrevdo/events{/privacy}", "received_events_url": "https://api.github.com/users/ebrevdo/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-09-11T23:56:10Z", "updated_at": "2019-09-25T17:03:00Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes.\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10\r\n- TensorFlow installed from (source or binary): [Official download URL from TF's website. ](https://www.tensorflow.org/install/lang_c),Which is then downloaded via nuget package.\r\n- TensorFlow version (use command below): Unable, we use c_api, the dll is downloaded from [here](https://storage.googleapis.com/tensorflow/libtensorflow/libtensorflow-cpu-windows-x86_64-1.14.0.zip)\r\n- Python version: -\r\n- Bazel version (if compiling from source): -\r\n- GCC/Compiler version (if compiling from source): -\r\n- CUDA/cuDNN version: We use CPU\r\n- GPU model and memory: -\r\n\r\n**Describe the current behavior**\r\nI'm working with our team on [Tensorflow.NET](https://github.com/SciSharp/TensorFlow.NET/) and we wanted to exploit C#'s multithreading capabilities with Tensorflow. \r\nOur library is a port of close to 1-1 from python to C# with couple of changes to allow multithreading to work.\r\nWe use a different Session and Graph for every Thread so every thread is actually isolated from the other Threads.\r\nWhen calling `c_api.TF_SessionRun` from 10 parallel threads in an infinite loop for a minute or so - some sort of corruption occurs that causes Tensorflow to terminate with the following error code \r\n\r\n`Code -1073740791 (0xc0000409).` which is:\r\n> Stack buffer overflow / overrun. Error can indicate a bug in the executed software that causes > stack overflow, leading to abnormal termination of the software.\r\n\r\nThis does not occur every run, in-fact it might occur 1/10 and only after 1-5 minutes of running.\r\n\r\nIn most cases, the program will just terminate but even more rarely the following message is printed:\r\n> 2019-09-12 02:47:15.298642: F tensorflow/core/framework/tensor.cc:928] Check failed: buf_ null buf_ with non-zero shape size 15\r\n\r\nWe discussed the issue in our repository: https://github.com/SciSharp/TensorFlow.NET/issues/380\r\n\r\n**Describe the expected behavior**\r\nRun smoothly, `c_api.TF_SessionRun` expected to be thread-safe when used with a separate Session and Graph for every thread.\r\n\r\n**Code to reproduce the issue**\r\nhttps://github.com/Nucs/TensorFlowNetMultithreading\r\nRequirements: Visual Studio 2017+\r\nHappens both in Debug or Release builds.\r\n\r\nThe tensorflow.dll we use is not built on Debug, in order to use a custom tensorflow.dll with a .pdb, replace the one in `CalcEventsTFS\\bin\\Debug\\net461 or netcoreapp2.2\\` and then run `CalcEventsTFS.exe`\r\n\r\nSimply build the solution and run the only project there is. \r\nI recommend to restart the program if it did not occur within 1 minute.\r\n\r\nIf you are getting `Unable to load DLL 'tensorflow': The specified module could not be found.`, \r\nCopy your own tensorflow.dll of version 1.40 CPU for windows to the output directory: \r\n> CalcEventsTFS\\bin\\Debug\\net461 or netcoreapp2.2\\\r\n\r\n**Other info / logs**\r\nWe managed to get a dump after the termination of the program available from [here]( https://mega.nz/#!VVF3HKrS!r5sxOBsbccdVn93KpwS7EtxWSvtLlim2GwExDF8L9h4).\r\n\r\n![image](https://user-images.githubusercontent.com/649919/64742960-c1d51c80-d506-11e9-9f2d-c4f7de2234b8.png)\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32437", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32437/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32437/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32437/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32437", "id": 492409681, "node_id": "MDU6SXNzdWU0OTI0MDk2ODE=", "number": 32437, "title": "Cannot cross-compile ARM64 on Mac host", "user": {"login": "truongsinh", "id": 358585, "node_id": "MDQ6VXNlcjM1ODU4NQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/358585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/truongsinh", "html_url": "https://github.com/truongsinh", "followers_url": "https://api.github.com/users/truongsinh/followers", "following_url": "https://api.github.com/users/truongsinh/following{/other_user}", "gists_url": "https://api.github.com/users/truongsinh/gists{/gist_id}", "starred_url": "https://api.github.com/users/truongsinh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/truongsinh/subscriptions", "organizations_url": "https://api.github.com/users/truongsinh/orgs", "repos_url": "https://api.github.com/users/truongsinh/repos", "events_url": "https://api.github.com/users/truongsinh/events{/privacy}", "received_events_url": "https://api.github.com/users/truongsinh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-09-11T18:55:47Z", "updated_at": "2019-09-12T10:30:42Z", "closed_at": null, "author_association": "NONE", "body": "Following https://www.tensorflow.org/lite/guide/build_arm64 is not possible on Mac, `./tensorflow/lite/tools/make/build_aarch64_lib.sh` returns\r\n\r\n```\r\n...\r\n/bin/bash: aarch64-linux-gnu-g++: command not found\r\n...\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32434", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32434/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32434/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32434/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32434", "id": 492396265, "node_id": "MDU6SXNzdWU0OTIzOTYyNjU=", "number": 32434, "title": "Int32 overflow in sparse_reshape on Windows", "user": {"login": "ThomasOerkild", "id": 16103356, "node_id": "MDQ6VXNlcjE2MTAzMzU2", "avatar_url": "https://avatars3.githubusercontent.com/u/16103356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ThomasOerkild", "html_url": "https://github.com/ThomasOerkild", "followers_url": "https://api.github.com/users/ThomasOerkild/followers", "following_url": "https://api.github.com/users/ThomasOerkild/following{/other_user}", "gists_url": "https://api.github.com/users/ThomasOerkild/gists{/gist_id}", "starred_url": "https://api.github.com/users/ThomasOerkild/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ThomasOerkild/subscriptions", "organizations_url": "https://api.github.com/users/ThomasOerkild/orgs", "repos_url": "https://api.github.com/users/ThomasOerkild/repos", "events_url": "https://api.github.com/users/ThomasOerkild/events{/privacy}", "received_events_url": "https://api.github.com/users/ThomasOerkild/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-09-11T18:26:51Z", "updated_at": "2019-09-11T19:14:14Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution: Windows 10 64-bit\r\n- TensorFlow installed from: Source\r\n- TensorFlow version: 1.14.0\r\n- Python version: 3.6.7\r\n\r\n**Describe the current behavior**\r\nWhen a large sparse tensor is reshaped using `sparse_reshape` on Windows it fails, due to the fact that it uses `np.prod` to determine whether the number of elements in the old and new SparseTensor are the same. This can fail on Windows, due to the fact that numpy converts python ints to dtype np.int32 on Windows, which will overflow for large dimensions.\r\n\r\n**Describe the expected behavior**\r\n`sparse_reshape` should work similarly on both Windows and Unix-based systems.\r\n\r\n**Code to reproduce the issue**\r\n```python\r\nimport tensorflow as tf\r\ntf.enable_eager_execution()\r\n\r\nidxs = tf.constant([[1, 0, 1],\r\n                             [1, 4, 2]], dtype=tf.int64)\r\nvalues = tf.constant([12, 42])\r\n\r\nA = tf.sparse.SparseTensor(idxs, values, (8, 42000, 40000))\r\ntf.sparse.reshape(A, (8, 40000, 42000))\r\n```\r\n\r\nOutput:\r\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"C:\\Users\\thomasoerkild\\Anaconda3\\envs\\tf_gpu\\lib\\site-packages\\tensorflow\\python\\ops\\sparse_ops.py\", line 769, in sparse_reshape\r\n    reshaped_size))\r\nValueError: Cannot reshape a tensor with 555098112 elements to shape [8, 40000, 42000] (13440000000 elements).\r\n```\r\n\r\n**Other info / logs**\r\nThe issue might be resolved, by forcing the shape inputted to `np.prod` to be of type np.int64.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32413", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32413/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32413/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32413/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32413", "id": 492049838, "node_id": "MDU6SXNzdWU0OTIwNDk4Mzg=", "number": 32413, "title": "How to split neural network into different GPU devices ?", "user": {"login": "Liang-yc", "id": 25114561, "node_id": "MDQ6VXNlcjI1MTE0NTYx", "avatar_url": "https://avatars0.githubusercontent.com/u/25114561?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Liang-yc", "html_url": "https://github.com/Liang-yc", "followers_url": "https://api.github.com/users/Liang-yc/followers", "following_url": "https://api.github.com/users/Liang-yc/following{/other_user}", "gists_url": "https://api.github.com/users/Liang-yc/gists{/gist_id}", "starred_url": "https://api.github.com/users/Liang-yc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Liang-yc/subscriptions", "organizations_url": "https://api.github.com/users/Liang-yc/orgs", "repos_url": "https://api.github.com/users/Liang-yc/repos", "events_url": "https://api.github.com/users/Liang-yc/events{/privacy}", "received_events_url": "https://api.github.com/users/Liang-yc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-09-11T06:48:21Z", "updated_at": "2019-12-24T06:15:03Z", "closed_at": null, "author_association": "NONE", "body": "Hi, I am working on a Video Segmentation project. Due to the limit of GPU memory (GTX 1080TI),  OOM error has occurred. I do know this error can be avoided if I squeeze my model or just use other GPUs with higher memory. But, does Tensorflow support splitting one neural network into different GPU devices? i.e. , I have 2 GPUs(A and B) and the model definitation is shown as following:\r\n```\r\n    input = keras.layers.Input((28, 28))\r\n    f = keras.layers.Flatten()(input)\r\n    #I want GPU A finish this part\r\n    part1 = keras.layers.Dense(128, activation=tf.nn.relu)(f)    \r\n     #After part1 is finished, GPU B will finish this part\r\n    part2 = keras.layers.Dense(10, activation=tf.nn.softmax)(part1)   \r\n```\r\nI want  GPU A finish `part1 = keras.layers.Dense(128, activation=tf.nn.relu)(f)  ` and GPU B finish `part2 = keras.layers.Dense(10, activation=tf.nn.softmax)(part1) `."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32412", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32412/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32412/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32412/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32412", "id": 492042897, "node_id": "MDU6SXNzdWU0OTIwNDI4OTc=", "number": 32412, "title": "[TF 2.0.0-rc0] Keras Model subclassing `dynamic=True` throws Error. Possible Regression bug of rc0", "user": {"login": "faizanahemad", "id": 7088567, "node_id": "MDQ6VXNlcjcwODg1Njc=", "avatar_url": "https://avatars3.githubusercontent.com/u/7088567?v=4", "gravatar_id": "", "url": "https://api.github.com/users/faizanahemad", "html_url": "https://github.com/faizanahemad", "followers_url": "https://api.github.com/users/faizanahemad/followers", "following_url": "https://api.github.com/users/faizanahemad/following{/other_user}", "gists_url": "https://api.github.com/users/faizanahemad/gists{/gist_id}", "starred_url": "https://api.github.com/users/faizanahemad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/faizanahemad/subscriptions", "organizations_url": "https://api.github.com/users/faizanahemad/orgs", "repos_url": "https://api.github.com/users/faizanahemad/repos", "events_url": "https://api.github.com/users/faizanahemad/events{/privacy}", "received_events_url": "https://api.github.com/users/faizanahemad/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-09-11T06:28:32Z", "updated_at": "2020-03-18T05:59:37Z", "closed_at": null, "author_association": "NONE", "body": "\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): \r\n    - Mac OSX 10.13.6, intel i7, MacBook Pro (Retina, 13-inch, Early 2015), Intel Iris Graphics 6100 1536 MB, \r\n    - Google Colab (Both CPU and GPU)\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: No\r\n- TensorFlow installed from (source or binary): Binary (pip)\r\n- TensorFlow version (use command below): 2.0.0-rc0\r\n` pip install tensorflow==2.0.0-rc0`\r\n- Python version: 3.7.3\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: NA\r\n- GPU model and memory: Intel Iris Graphics 6100 1536 MB (Stock Intel i7 CPU bundled)\r\n\r\n**Describe the current behavior**\r\nIn 2.0.0-rc0, While using Model Subclassing of tf,keras.Model and passing `dynamic=True`. Then when I call model.fit it throws `AttributeError: 'NoneType' object has no attribute 'dtype'`\r\n\r\n**Describe the expected behavior**\r\nmodel.fit should not throw any error. Note this was working fine in `2.0.0-beta1`\r\n\r\n**Code to reproduce the issue**\r\n```python\r\nimport numpy as np\r\nimport tensorflow as tf\r\nimport os\r\n\r\nprint(tf.__version__)\r\n\r\n\r\nclass ConvBn2D(tf.keras.Model):\r\n    def __init__(self, c_out, kernel_size=3):\r\n        super().__init__()\r\n        self.conv = tf.keras.layers.Conv2D(filters=c_out, kernel_size=kernel_size,\r\n                                           strides=1, padding=\"SAME\",\r\n                                           use_bias=False)\r\n        self.bn = tf.keras.layers.BatchNormalization(momentum=0.9, epsilon=1e-7)\r\n\r\n    def call(self, inputs):\r\n        res = tf.nn.relu(self.bn(self.conv(inputs)))\r\n        return res\r\n\r\n\r\nclass FNet(tf.keras.Model):\r\n    def __init__(self, start_kernels=64, weight=0.125, **kwargs):\r\n        super().__init__(**kwargs)\r\n        c = start_kernels\r\n        self.max_pool = tf.keras.layers.MaxPooling2D()\r\n        self.init_conv_bn = ConvBn2D(c, kernel_size=3)\r\n        self.c0 = ConvBn2D(c, kernel_size=3)\r\n\r\n        self.c1 = ConvBn2D(c * 2, kernel_size=3)\r\n        self.c2 = ConvBn2D(c * 2, kernel_size=3)\r\n\r\n        self.c3 = ConvBn2D(c * 2, kernel_size=3)\r\n        self.c4 = ConvBn2D(c * 2, kernel_size=3)\r\n\r\n        self.pool = tf.keras.layers.GlobalMaxPool2D()\r\n        self.linear = tf.keras.layers.Dense(10, use_bias=False)\r\n        self.weight = weight\r\n\r\n    def call(self, x):\r\n        h = self.max_pool(self.c0(self.init_conv_bn(x)))\r\n        h = self.max_pool(self.c2(self.c1(h)))\r\n        h = self.max_pool(self.c4(self.c3(h)))\r\n        h = self.pool(h)\r\n        h = self.linear(h) * self.weight\r\n        return h\r\n\r\n\r\n(x_train, y_train), (x_test, y_test) = tf.keras.datasets.cifar10.load_data()\r\ntrain = tf.data.Dataset.from_tensor_slices((x_train, y_train))\r\ntrain = train.map(lambda x,y:(tf.cast(x,tf.float32),tf.cast(y,tf.int64))).map(lambda x,y:(x/255.0,y)).batch(512)\r\n\r\n# model = FNet(start_kernels=8)\r\n\r\nmodel = FNet(start_kernels=8,dynamic=True)\r\n\r\nloss = tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True)\r\nmodel.compile(optimizer=tf.keras.optimizers.RMSprop(0.01),\r\n              loss=loss)\r\n\r\ncallbacks=[]\r\nmodel.fit(train, epochs=2, callbacks=callbacks,verbose=1)\r\n```\r\n\r\n\r\n**Other info / logs**\r\nRun code in `2.0.0-beta1` it works. in rc0 fails.\r\n\r\n[Colab Notebook with same issue](https://colab.research.google.com/drive/1dZaIwlgKRk_8FSKkdyQlwXsT3auqV6VX)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32410", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32410/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32410/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32410/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32410", "id": 492001885, "node_id": "MDU6SXNzdWU0OTIwMDE4ODU=", "number": 32410, "title": "Possible issue in tf.scatter_nd documentation.", "user": {"login": "praveenjune17", "id": 26601843, "node_id": "MDQ6VXNlcjI2NjAxODQz", "avatar_url": "https://avatars0.githubusercontent.com/u/26601843?v=4", "gravatar_id": "", "url": "https://api.github.com/users/praveenjune17", "html_url": "https://github.com/praveenjune17", "followers_url": "https://api.github.com/users/praveenjune17/followers", "following_url": "https://api.github.com/users/praveenjune17/following{/other_user}", "gists_url": "https://api.github.com/users/praveenjune17/gists{/gist_id}", "starred_url": "https://api.github.com/users/praveenjune17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/praveenjune17/subscriptions", "organizations_url": "https://api.github.com/users/praveenjune17/orgs", "repos_url": "https://api.github.com/users/praveenjune17/repos", "events_url": "https://api.github.com/users/praveenjune17/events{/privacy}", "received_events_url": "https://api.github.com/users/praveenjune17/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "yashk2810", "id": 14262417, "node_id": "MDQ6VXNlcjE0MjYyNDE3", "avatar_url": "https://avatars1.githubusercontent.com/u/14262417?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yashk2810", "html_url": "https://github.com/yashk2810", "followers_url": "https://api.github.com/users/yashk2810/followers", "following_url": "https://api.github.com/users/yashk2810/following{/other_user}", "gists_url": "https://api.github.com/users/yashk2810/gists{/gist_id}", "starred_url": "https://api.github.com/users/yashk2810/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yashk2810/subscriptions", "organizations_url": "https://api.github.com/users/yashk2810/orgs", "repos_url": "https://api.github.com/users/yashk2810/repos", "events_url": "https://api.github.com/users/yashk2810/events{/privacy}", "received_events_url": "https://api.github.com/users/yashk2810/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "yashk2810", "id": 14262417, "node_id": "MDQ6VXNlcjE0MjYyNDE3", "avatar_url": "https://avatars1.githubusercontent.com/u/14262417?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yashk2810", "html_url": "https://github.com/yashk2810", "followers_url": "https://api.github.com/users/yashk2810/followers", "following_url": "https://api.github.com/users/yashk2810/following{/other_user}", "gists_url": "https://api.github.com/users/yashk2810/gists{/gist_id}", "starred_url": "https://api.github.com/users/yashk2810/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yashk2810/subscriptions", "organizations_url": "https://api.github.com/users/yashk2810/orgs", "repos_url": "https://api.github.com/users/yashk2810/repos", "events_url": "https://api.github.com/users/yashk2810/events{/privacy}", "received_events_url": "https://api.github.com/users/yashk2810/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-09-11T03:50:12Z", "updated_at": "2019-09-14T17:21:14Z", "closed_at": null, "author_association": "NONE", "body": "Thank you for explaining about tf.scatter_nd using some wonderful visualizations. I have a doubt whether the cubes used for the higher dimensional explanation of tf.scatter_nd is right or not.\r\nPlease check the visualization of the Cube tagged as 'output' in [tf.scatter_nd](https://www.tensorflow.org/versions/r2.0/api_docs/python/tf/scatter_nd#) documentation, the second and fourth indices are shaded whereas the given indices according to the example is tf.constant([[0], [2]]) so the first and third indices (0 , 2) should be shaded instead of second and fourth. Please correct me if I'm wrong\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32405", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32405/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32405/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32405/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32405", "id": 491958661, "node_id": "MDU6SXNzdWU0OTE5NTg2NjE=", "number": 32405, "title": "Failed to build on Ubuntu 18.04 with Ryzen CPU", "user": {"login": "babytut", "id": 10155837, "node_id": "MDQ6VXNlcjEwMTU1ODM3", "avatar_url": "https://avatars3.githubusercontent.com/u/10155837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/babytut", "html_url": "https://github.com/babytut", "followers_url": "https://api.github.com/users/babytut/followers", "following_url": "https://api.github.com/users/babytut/following{/other_user}", "gists_url": "https://api.github.com/users/babytut/gists{/gist_id}", "starred_url": "https://api.github.com/users/babytut/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/babytut/subscriptions", "organizations_url": "https://api.github.com/users/babytut/orgs", "repos_url": "https://api.github.com/users/babytut/repos", "events_url": "https://api.github.com/users/babytut/events{/privacy}", "received_events_url": "https://api.github.com/users/babytut/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-09-11T00:34:12Z", "updated_at": "2019-09-22T09:58:55Z", "closed_at": null, "author_association": "NONE", "body": "<em>Error when build from source on Ubuntu 18.04 tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution: Ubuntu 18.04\r\n- TensorFlow installed from source 1.14\r\n- TensorFlow version: 1.14\r\n- Python version: 3.6\r\n- Bazel version (if compiling from source): 0.24.1\r\n- GCC/Compiler version (if compiling from source): 7.4\r\n- CUDA/cuDNN version: 10.0\r\n- GPU model and memory: RTX 2060\r\n- CPU: Ryzen 5 2600\r\n\r\n**Describe the problem**\r\nI follow tutorial https://www.tensorflow.org/install/source, but It always throw error like this\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n```\r\nbazel build --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" -- define=tensorflow_mkldnn_contraction_kernel=0 --verbose_failures  //tensorflow/tools/pip_package:build_pip_package\r\nor \r\nbazel build --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" //tensorflow/tools/pip_package:build_pip_package\r\nor \r\nbazel build --config=cuda //tensorflow/tools/pip_package:build_pip_package\r\n**Any other info / logs**\r\nERROR: /home/tuan/Downloads/tensorflow-1.14.0/tensorflow/core/BUILD:3079:1: C++ compilation of rule '//tensorflow/core:core_cpu_base' failed (Exit 1): crosstool_wrapper_driver_is_not_gcc failed: error executing command \r\n  (cd /home/tuan/.cache/bazel/_bazel_tuan/5cac32750bec0be81932199159ef575e/execroot/org_tensorflow && \\\r\n  exec env - \\\r\n    CUDA_TOOLKIT_PATH=/usr/local/cuda \\\r\n    GCC_HOST_COMPILER_PATH=/usr/bin/gcc \\\r\n    PATH=/home/tuan/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin \\\r\n    PWD=/proc/self/cwd \\\r\n    PYTHON_BIN_PATH=/usr/bin/python3 \\\r\n    PYTHON_LIB_PATH=/usr/local/lib/python3.6/dist-packages \\\r\n    TF_CONFIGURE_IOS=0 \\\r\n    TF_CUDA_CLANG=0 \\\r\n    TF_CUDA_COMPUTE_CAPABILITIES=7.5 \\\r\n    TF_NEED_CUDA=1 \\\r\n    TF_NEED_OPENCL_SYCL=0 \\\r\n    TF_NEED_ROCM=0 \\\r\n    TF_NEED_TENSORRT=1 \\\r\n  external/local_config_cuda/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -MD -MF bazel-out/k8-opt/bin/tensorflow/core/_objs/core_cpu_base/graph_constructor.pic.d '-frandom-seed=bazel-out/k8-opt/bin/tensorflow/core/_objs/core_cpu_base/graph_constructor.pic.o' -D__CLANG_SUPPORT_DYN_ANNOTATION__ -DEIGEN_MPL2_ONLY '-DEIGEN_MAX_ALIGN_BYTES=64' '-DEIGEN_HAS_TYPE_TRAITS=0' -DTF_USE_SNAPPY -iquote . -iquote bazel-out/k8-opt/genfiles -iquote bazel-out/k8-opt/bin -iquote external/com_google_absl -iquote bazel-out/k8-opt/genfiles/external/com_google_absl -iquote bazel-out/k8-opt/bin/external/com_google_absl -iquote external/eigen_archive -iquote bazel-out/k8-opt/genfiles/external/eigen_archive -iquote bazel-out/k8-opt/bin/external/eigen_archive -iquote external/local_config_sycl -iquote bazel-out/k8-opt/genfiles/external/local_config_sycl -iquote bazel-out/k8-opt/bin/external/local_config_sycl -iquote external/nsync -iquote bazel-out/k8-opt/genfiles/external/nsync -iquote bazel-out/k8-opt/bin/external/nsync -iquote external/gif_archive -iquote bazel-out/k8-opt/genfiles/external/gif_archive -iquote bazel-out/k8-opt/bin/external/gif_archive -iquote external/jpeg -iquote bazel-out/k8-opt/genfiles/external/jpeg -iquote bazel-out/k8-opt/bin/external/jpeg -iquote external/protobuf_archive -iquote bazel-out/k8-opt/genfiles/external/protobuf_archive -iquote bazel-out/k8-opt/bin/external/protobuf_archive -iquote external/com_googlesource_code_re2 -iquote bazel-out/k8-opt/genfiles/external/com_googlesource_code_re2 -iquote bazel-out/k8-opt/bin/external/com_googlesource_code_re2 -iquote external/farmhash_archive -iquote bazel-out/k8-opt/genfiles/external/farmhash_archive -iquote bazel-out/k8-opt/bin/external/farmhash_archive -iquote external/fft2d -iquote bazel-out/k8-opt/genfiles/external/fft2d -iquote bazel-out/k8-opt/bin/external/fft2d -iquote external/highwayhash -iquote bazel-out/k8-opt/genfiles/external/highwayhash -iquote bazel-out/k8-opt/bin/external/highwayhash -iquote external/zlib_archive -iquote bazel-out/k8-opt/genfiles/external/zlib_archive -iquote bazel-out/k8-opt/bin/external/zlib_archive -iquote external/local_config_cuda -iquote bazel-out/k8-opt/genfiles/external/local_config_cuda -iquote bazel-out/k8-opt/bin/external/local_config_cuda -Ibazel-out/k8-opt/bin/external/local_config_cuda/cuda/_virtual_includes/cuda_headers_virtual -isystem external/eigen_archive -isystem bazel-out/k8-opt/genfiles/external/eigen_archive -isystem bazel-out/k8-opt/bin/external/eigen_archive -isystem external/nsync/public -isystem bazel-out/k8-opt/genfiles/external/nsync/public -isystem bazel-out/k8-opt/bin/external/nsync/public -isystem external/gif_archive/lib -isystem bazel-out/k8-opt/genfiles/external/gif_archive/lib -isystem bazel-out/k8-opt/bin/external/gif_archive/lib -isystem external/protobuf_archive/src -isystem bazel-out/k8-opt/genfiles/external/protobuf_archive/src -isystem bazel-out/k8-opt/bin/external/protobuf_archive/src -isystem external/farmhash_archive/src -isystem bazel-out/k8-opt/genfiles/external/farmhash_archive/src -isystem bazel-out/k8-opt/bin/external/farmhash_archive/src -isystem external/zlib_archive -isystem bazel-out/k8-opt/genfiles/external/zlib_archive -isystem bazel-out/k8-opt/bin/external/zlib_archive -isystem external/local_config_cuda/cuda -isystem bazel-out/k8-opt/genfiles/external/local_config_cuda/cuda -isystem bazel-out/k8-opt/bin/external/local_config_cuda/cuda -isystem external/local_config_cuda/cuda/cuda/include -isystem bazel-out/k8-opt/genfiles/external/local_config_cuda/cuda/cuda/include -isystem bazel-out/k8-opt/bin/external/local_config_cuda/cuda/cuda/include '-std=c++11' -Wno-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -fPIC -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -Wall -fno-omit-frame-pointer -no-canonical-prefixes -fno-canonical-system-headers -DNDEBUG -g0 -O2 -ffunction-sections -fdata-sections '-D_GLIBCXX_USE_CXX11_ABI=0' -DEIGEN_AVOID_STL_ARRAY -Iexternal/gemmlowp -Wno-sign-compare -fno-exceptions '-ftemplate-depth=900' '-DGOOGLE_CUDA=1' '-DGOOGLE_TENSORRT=1' -msse3 -pthread '-DGOOGLE_CUDA=1' '-DGOOGLE_TENSORRT=1' -c tensorflow/core/graph/graph_constructor.cc -o bazel-out/k8-opt/bin/tensorflow/core/_objs/core_cpu_base/graph_constructor.pic.o)\r\nExecution platform: @bazel_tools//platforms:host_platform\r\nIn file included from external/protobuf_archive/src/google/protobuf/arena_impl.h:40:0,\r\n                 from external/protobuf_archive/src/google/protobuf/arena.h:51,\r\n                 from bazel-out/k8-opt/genfiles/tensorflow/core/framework/graph.pb.h:24,\r\n                 from ./tensorflow/core/graph/graph_constructor.h:19,\r\n                 from tensorflow/core/graph/graph_constructor.cc:16:\r\nexternal/protobuf_archive/src/google/protobuf/map.h: In instantiation of 'void google::protobuf::Map<Key, T>::InnerMap::iterator_base<KeyValueType>::SearchFrom(google::protobuf::Map<Key, T>::size_type) [with KeyValueType = google::protobuf::Map<unsigned int, std::basic_string<char> >::KeyValuePair; Key = unsigned int; T = std::basic_string<char>; google::protobuf::Map<Key, T>::size_type = long unsigned int]':\r\nexternal/protobuf_archive/src/google/protobuf/map.h:400:19:   required from 'google::protobuf::Map<Key, T>::InnerMap::iterator_base<KeyValueType>::iterator_base(const google::protobuf::Map<Key, T>::InnerMap*) [with KeyValueType = google::protobuf::Map<unsigned int, std::basic_string<char> >::KeyValuePair; Key = unsigned int; T = std::basic_string<char>]'\r\nexternal/protobuf_archive/src/google/protobuf/map.h:516:31:   required from 'google::protobuf::Map<Key, T>::InnerMap::iterator google::protobuf::Map<Key, T>::InnerMap::begin() [with Key = unsigned int; T = std::basic_string<char>; google::protobuf::Map<Key, T>::InnerMap::iterator = google::protobuf::Map<unsigned int, std::basic_string<char> >::InnerMap::iterator_base<google::protobuf::Map<unsigned int, std::basic_string<char> >::KeyValuePair>]'\r\nexternal/protobuf_archive/src/google/protobuf/map.h:1037:29:   required from 'google::protobuf::Map<Key, T>::iterator google::protobuf::Map<Key, T>::begin() [with Key = unsigned int; T = std::basic_string<char>]'\r\nexternal/protobuf_archive/src/google/protobuf/map.h:1147:29:   required from 'void google::protobuf::Map<Key, T>::clear() [with Key = unsigned int; T = std::basic_string<char>]'\r\nexternal/protobuf_archive/src/google/protobuf/map_field_inl.h:188:3:   required from 'void google::protobuf::internal::MapField<Derived, Key, T, key_wire_type, value_wire_type, default_enum_value>::Clear() [with Derived = tensorflow::DeviceStepStats_ThreadNamesEntry_DoNotUse; Key = unsigned int; T = std::basic_string<char>; google::protobuf::internal::WireFormatLite::FieldType kKeyFieldType = (google::protobuf::internal::WireFormatLite::FieldType)13; google::protobuf::internal::WireFormatLite::FieldType kValueFieldType = (google::protobuf::internal::WireFormatLite::FieldType)9; int default_enum_value = 0]'\r\nbazel-out/k8-opt/genfiles/tensorflow/core/framework/step_stats.pb.h:2329:23:   required from here\r\nexternal/protobuf_archive/src/google/protobuf/map.h:423:9: internal compiler error: Segmentation fault\r\n         GOOGLE_DCHECK(m_->index_of_first_non_null_ == m_->num_buckets_ ||\r\n         ^\r\nPlease submit a full bug report,\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32396", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32396/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32396/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32396/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32396", "id": 491915736, "node_id": "MDU6SXNzdWU0OTE5MTU3MzY=", "number": 32396, "title": "The SessionOptions doesn't control the usage of CPU or Thread", "user": {"login": "Binbin16", "id": 19718702, "node_id": "MDQ6VXNlcjE5NzE4NzAy", "avatar_url": "https://avatars3.githubusercontent.com/u/19718702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Binbin16", "html_url": "https://github.com/Binbin16", "followers_url": "https://api.github.com/users/Binbin16/followers", "following_url": "https://api.github.com/users/Binbin16/following{/other_user}", "gists_url": "https://api.github.com/users/Binbin16/gists{/gist_id}", "starred_url": "https://api.github.com/users/Binbin16/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Binbin16/subscriptions", "organizations_url": "https://api.github.com/users/Binbin16/orgs", "repos_url": "https://api.github.com/users/Binbin16/repos", "events_url": "https://api.github.com/users/Binbin16/events{/privacy}", "received_events_url": "https://api.github.com/users/Binbin16/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "ezhulenev", "id": 1174378, "node_id": "MDQ6VXNlcjExNzQzNzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/1174378?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezhulenev", "html_url": "https://github.com/ezhulenev", "followers_url": "https://api.github.com/users/ezhulenev/followers", "following_url": "https://api.github.com/users/ezhulenev/following{/other_user}", "gists_url": "https://api.github.com/users/ezhulenev/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezhulenev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezhulenev/subscriptions", "organizations_url": "https://api.github.com/users/ezhulenev/orgs", "repos_url": "https://api.github.com/users/ezhulenev/repos", "events_url": "https://api.github.com/users/ezhulenev/events{/privacy}", "received_events_url": "https://api.github.com/users/ezhulenev/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ezhulenev", "id": 1174378, "node_id": "MDQ6VXNlcjExNzQzNzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/1174378?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezhulenev", "html_url": "https://github.com/ezhulenev", "followers_url": "https://api.github.com/users/ezhulenev/followers", "following_url": "https://api.github.com/users/ezhulenev/following{/other_user}", "gists_url": "https://api.github.com/users/ezhulenev/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezhulenev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezhulenev/subscriptions", "organizations_url": "https://api.github.com/users/ezhulenev/orgs", "repos_url": "https://api.github.com/users/ezhulenev/repos", "events_url": "https://api.github.com/users/ezhulenev/events{/privacy}", "received_events_url": "https://api.github.com/users/ezhulenev/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-09-10T21:49:17Z", "updated_at": "2019-09-13T22:09:19Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No, only use C++ API\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): SUSE 12.4\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version (use command below): 1.14.0\r\n- Python version: 3.5\r\n- Bazel version (if compiling from source): 0.24.1\r\n- GCC/Compiler version (if compiling from source): gcc 4.8\r\n- CUDA/cuDNN version: only CPU\r\n- GPU model and memory: only CPU\r\n\r\n**Describe the current behavior**\r\nI created a session option with inter=1 and intra=1. Then I used this option to create a session and load a model.\r\nWhen I run the model, the program used almost all the CPU cores on my server, and thread spawned to several hundreds.\r\nAnd No matter what value I set to \"inter\" and \"intra\", there are still many CPU cores were used and many threads were created.\r\n\r\n**Describe the expected behavior**\r\nTF only use 1 thread and 1 cpu core\r\n\r\n**Code to reproduce the issue**\r\n  std::unique_ptr<tensorflow::Session> session;\r\n  tensorflow::SessionOptions options;\r\n  tensorflow::ConfigProto & config = options.config;\r\n  int coresToUse = 1;\r\n  if (coresToUse > 0)\r\n    {\r\n\t\tconfig.set_use_per_session_threads(false);\r\n\t\tconfig.set_inter_op_parallelism_threads(coresToUse);\r\n                config.set_intra_op_parallelism_threads(coresToUse);\t\r\n    }\r\n  status = tensorflow::NewSession(options, session);\r\ntensorflow::MetaGraphDef graph_def;\r\ntensorflow::ReadBinaryProto(tensorflow::Env::Default(), metamodel_path, &graph_def);\r\nsession->Create(graph_def.graph_def());\r\nrun_model();\r\n\r\n**Other info / logs**\r\nWhen I use the python API of TensorFlow 1.14 do the same thing, it seems like the CPU and thread usage can be controlled by the inter and intra parameter.\r\n\r\nHow to control the computing resources used by tensorflow C++ API?\r\n\r\n#32009 @JiayiFu @ezhulenev I saw the similar problem described here, but don't know its solution."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32386", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32386/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32386/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32386/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/32386", "id": 491802474, "node_id": "MDExOlB1bGxSZXF1ZXN0MzE2MDk5NTkz", "number": 32386, "title": "NVCC bug demonstration", "user": {"login": "brianwa84", "id": 22173987, "node_id": "MDQ6VXNlcjIyMTczOTg3", "avatar_url": "https://avatars0.githubusercontent.com/u/22173987?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brianwa84", "html_url": "https://github.com/brianwa84", "followers_url": "https://api.github.com/users/brianwa84/followers", "following_url": "https://api.github.com/users/brianwa84/following{/other_user}", "gists_url": "https://api.github.com/users/brianwa84/gists{/gist_id}", "starred_url": "https://api.github.com/users/brianwa84/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brianwa84/subscriptions", "organizations_url": "https://api.github.com/users/brianwa84/orgs", "repos_url": "https://api.github.com/users/brianwa84/repos", "events_url": "https://api.github.com/users/brianwa84/events{/privacy}", "received_events_url": "https://api.github.com/users/brianwa84/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-09-10T17:25:04Z", "updated_at": "2020-02-12T10:05:09Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/32386", "html_url": "https://github.com/tensorflow/tensorflow/pull/32386", "diff_url": "https://github.com/tensorflow/tensorflow/pull/32386.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/32386.patch"}, "body": "Would like to submit this, but it crashes GPU."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32382", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32382/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32382/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32382/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32382", "id": 491695689, "node_id": "MDU6SXNzdWU0OTE2OTU2ODk=", "number": 32382, "title": "Audio WAV files from iOS are not read by Tensorflow audio_ops.decode_wav: Header mismatch: Expected fmt  but found JUNK", "user": {"login": "KauthamMurugan", "id": 41481829, "node_id": "MDQ6VXNlcjQxNDgxODI5", "avatar_url": "https://avatars2.githubusercontent.com/u/41481829?v=4", "gravatar_id": "", "url": "https://api.github.com/users/KauthamMurugan", "html_url": "https://github.com/KauthamMurugan", "followers_url": "https://api.github.com/users/KauthamMurugan/followers", "following_url": "https://api.github.com/users/KauthamMurugan/following{/other_user}", "gists_url": "https://api.github.com/users/KauthamMurugan/gists{/gist_id}", "starred_url": "https://api.github.com/users/KauthamMurugan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/KauthamMurugan/subscriptions", "organizations_url": "https://api.github.com/users/KauthamMurugan/orgs", "repos_url": "https://api.github.com/users/KauthamMurugan/repos", "events_url": "https://api.github.com/users/KauthamMurugan/events{/privacy}", "received_events_url": "https://api.github.com/users/KauthamMurugan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-09-10T14:06:11Z", "updated_at": "2019-10-31T07:34:11Z", "closed_at": null, "author_association": "NONE", "body": "I have an iOS app that records audio as wav files and sends the files to the server for audio recognition. The iOS app records audio as wav files with the following configurations \r\n```\r\nlet settings = [\r\n                    AVFormatIDKey: Int(kAudioFormatLinearPCM),\r\n                    AVSampleRateKey: 16000,\r\n                    AVNumberOfChannelsKey: 1,\r\n                    AVLinearPCMBitDepthKey: 16,\r\n                    AVEncoderAudioQualityKey:AVAudioQuality.max.rawValue\r\n                    ] as [String : Any]\r\n```\r\nThe files are playing with any media player. But when i try to read the files with tensorflow ops in the server i am getting the following error\r\n\r\n```\r\nInvalidArgumentError: Header mismatch: Expected fmt  but found JUNK\r\n\t [[node DecodeWav_3 (defined at <ipython-input-5-36afd53919f4>:4) ]]\r\n\r\nErrors may have originated from an input operation.\r\nInput Source operations connected to node DecodeWav_3:\r\n ReadFile_3 (defined at <ipython-input-5-36afd53919f4>:3)\r\n\r\nOriginal stack trace for 'DecodeWav_3':\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/ipykernel_launcher.py\", line 16, in <module>\r\n    app.launch_new_instance()\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/traitlets/config/application.py\", line 658, in launch_instance\r\n    app.start()\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/ipykernel/kernelapp.py\", line 505, in start\r\n    self.io_loop.start()\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/tornado/platform/asyncio.py\", line 148, in start\r\n    self.asyncio_loop.run_forever()\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/asyncio/base_events.py\", line 438, in run_forever\r\n    self._run_once()\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/asyncio/base_events.py\", line 1451, in _run_once\r\n    handle._run()\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/asyncio/events.py\", line 145, in _run\r\n    self._callback(*self._args)\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/tornado/ioloop.py\", line 690, in <lambda>\r\n    lambda f: self._run_callback(functools.partial(callback, future))\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/tornado/ioloop.py\", line 743, in _run_callback\r\n    ret = callback()\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/tornado/gen.py\", line 787, in inner\r\n    self.run()\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/tornado/gen.py\", line 748, in run\r\n    yielded = self.gen.send(value)\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/ipykernel/kernelbase.py\", line 365, in process_one\r\n    yield gen.maybe_future(dispatch(*args))\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/tornado/gen.py\", line 209, in wrapper\r\n    yielded = next(result)\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/ipykernel/kernelbase.py\", line 272, in dispatch_shell\r\n    yield gen.maybe_future(handler(stream, idents, msg))\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/tornado/gen.py\", line 209, in wrapper\r\n    yielded = next(result)\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/ipykernel/kernelbase.py\", line 542, in execute_request\r\n    user_expressions, allow_stdin,\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/tornado/gen.py\", line 209, in wrapper\r\n    yielded = next(result)\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/ipykernel/ipkernel.py\", line 294, in do_execute\r\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/ipykernel/zmqshell.py\", line 536, in run_cell\r\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2855, in run_cell\r\n    raw_cell, store_history, silent, shell_futures)\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 2881, in _run_cell\r\n    return runner(coro)\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/IPython/core/async_helpers.py\", line 68, in _pseudo_sync_runner\r\n    coro.send(None)\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 3058, in run_cell_async\r\n    interactivity=interactivity, compiler=compiler, result=result)\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 3249, in run_ast_nodes\r\n    if (await self.run_code(code, result,  async_=asy)):\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 3326, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-5-36afd53919f4>\", line 4, in <module>\r\n    data = audio_ops.decode_wav(audio_binary, desired_channels=1)\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/tensorflow/python/ops/gen_audio_ops.py\", line 227, in decode_wav\r\n    desired_samples=desired_samples, name=name)\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py\", line 788, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 3616, in create_op\r\n    op_def=op_def)\r\n  File \"/Users/minimaci73/anaconda3/envs/Samples/lib/python3.6/site-packages/tensorflow/python/framework/ops.py\", line 2005, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n```\r\n\r\nI couldn't find the reason for the crash. My TensorFlow code to read the files are as below\r\n\r\n```\r\nimport tensorflow as tf\r\nfrom tensorflow.contrib.framework.python.ops import audio_ops\r\nfile = \"/Users/minimaci73/Downloads/1567690231185.wav\"  #wav file path\r\naudio_binary = tf.read_file(file)\r\ndata = audio_ops.decode_wav(audio_binary, desired_channels=1)\r\npcm16_data = tf.Session().run(data)\r\npcm16_data = pcm16_data[0] \r\nprint(pcm16_data)\r\n```\r\n\r\nOS - OSX Mojave 10.14.6\r\nTensorflow Version: 14\r\nEnvironment - Anaconda VM"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32380", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32380/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32380/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32380/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32380", "id": 491638409, "node_id": "MDU6SXNzdWU0OTE2Mzg0MDk=", "number": 32380, "title": "BatchNormalization virtual_batch_size does not work with None in input shape", "user": {"login": "ikrets", "id": 18064490, "node_id": "MDQ6VXNlcjE4MDY0NDkw", "avatar_url": "https://avatars1.githubusercontent.com/u/18064490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ikrets", "html_url": "https://github.com/ikrets", "followers_url": "https://api.github.com/users/ikrets/followers", "following_url": "https://api.github.com/users/ikrets/following{/other_user}", "gists_url": "https://api.github.com/users/ikrets/gists{/gist_id}", "starred_url": "https://api.github.com/users/ikrets/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ikrets/subscriptions", "organizations_url": "https://api.github.com/users/ikrets/orgs", "repos_url": "https://api.github.com/users/ikrets/repos", "events_url": "https://api.github.com/users/ikrets/events{/privacy}", "received_events_url": "https://api.github.com/users/ikrets/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2019-09-10T12:22:40Z", "updated_at": "2020-02-08T01:09:51Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): \r\nv2.0.0-beta1-5101-gc75bb66 2.0.0-rc0\r\n- Python version: 3.6.8\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source): N/A\r\n- CUDA/cuDNN version: CUDA 10.0, cuDNN 7.6.2.24-1\r\n- GPU model and memory: Nvidia RTX 2070 8 GB\r\n\r\n**Describe the current behavior**\r\nA constructor of a tf.keras Model that uses `tf.keras.layers.BatchNormalization` with `virtual_batch_size` set and unspecified input shape dimensions throws an exception.\r\n\r\n**Describe the expected behavior**\r\nSuch a model should be usable.\r\n\r\n**Code to reproduce the issue**\r\n```python\r\nimport tensorflow as tf\r\n\r\ninp = tf.keras.layers.Input(shape=(None, None, 3))\r\nnet = tf.keras.layers.BatchNormalization(virtual_batch_size=8)(inp)\r\n\r\nmodel = tf.keras.Model(inputs=inp, outputs=net)\r\n```\r\n\r\n**Other info / logs**\r\nTraceback of the exception:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/ikrets/tf2/lib/python3.6/site-packages/tensorflow_core/python/framework/tensor_util.py\", line 541, in make_tensor_proto\r\n    str_values = [compat.as_bytes(x) for x in proto_values]\r\n  File \"/home/ikrets/tf2/lib/python3.6/site-packages/tensorflow_core/python/framework/tensor_util.py\", line 541, in <listcomp>\r\n    str_values = [compat.as_bytes(x) for x in proto_values]\r\n  File \"/home/ikrets/tf2/lib/python3.6/site-packages/tensorflow_core/python/util/compat.py\", line 71, in as_bytes\r\n    (bytes_or_text,))\r\nTypeError: Expected binary or unicode string, got 8\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/ikrets/tf2/lib/python3.6/site-packages/tensorflow_core/python/framework/test_virtual_batch.py\", line 6, in <module>\r\n    net = tf.keras.layers.BatchNormalization(virtual_batch_size=8)(inp)\r\n  File \"/home/ikrets/tf2/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/base_layer.py\", line 802, in __call__\r\n    outputs = call_fn(cast_inputs, *args, **kwargs)\r\n  File \"/home/ikrets/tf2/lib/python3.6/site-packages/tensorflow_core/python/keras/layers/normalization.py\", line 652, in call\r\n    inputs = array_ops.reshape(inputs, expanded_shape)\r\n  File \"/home/ikrets/tf2/lib/python3.6/site-packages/tensorflow_core/python/ops/array_ops.py\", line 131, in reshape\r\n    result = gen_array_ops.reshape(tensor, shape, name)\r\n  File \"/home/ikrets/tf2/lib/python3.6/site-packages/tensorflow_core/python/ops/gen_array_ops.py\", line 8117, in reshape\r\n    \"Reshape\", tensor=tensor, shape=shape, name=name)\r\n  File \"/home/ikrets/tf2/lib/python3.6/site-packages/tensorflow_core/python/framework/op_def_library.py\", line 530, in _apply_op_helper\r\n    raise err\r\n  File \"/home/ikrets/tf2/lib/python3.6/site-packages/tensorflow_core/python/framework/op_def_library.py\", line 527, in _apply_op_helper\r\n    preferred_dtype=default_dtype)\r\n  File \"/home/ikrets/tf2/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py\", line 1296, in internal_convert_to_tensor\r\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\r\n  File \"/home/ikrets/tf2/lib/python3.6/site-packages/tensorflow_core/python/framework/constant_op.py\", line 286, in _constant_tensor_conversion_function\r\n    return constant(v, dtype=dtype, name=name)\r\n  File \"/home/ikrets/tf2/lib/python3.6/site-packages/tensorflow_core/python/framework/constant_op.py\", line 227, in constant\r\n    allow_broadcast=True)\r\n  File \"/home/ikrets/tf2/lib/python3.6/site-packages/tensorflow_core/python/framework/constant_op.py\", line 265, in _constant_impl\r\n    allow_broadcast=allow_broadcast))\r\n  File \"/home/ikrets/tf2/lib/python3.6/site-packages/tensorflow_core/python/framework/tensor_util.py\", line 545, in make_tensor_proto\r\n    \"supported type.\" % (type(values), values))\r\nTypeError: Failed to convert object of type <class 'list'> to Tensor. Contents: [8, -1, None, None, 3]. Consider casting elements to a supported type.\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32365", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32365/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32365/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32365/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32365", "id": 491291723, "node_id": "MDU6SXNzdWU0OTEyOTE3MjM=", "number": 32365, "title": "Reduce sum should work on heterogeneous shapes", "user": {"login": "bionicles", "id": 24532336, "node_id": "MDQ6VXNlcjI0NTMyMzM2", "avatar_url": "https://avatars2.githubusercontent.com/u/24532336?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bionicles", "html_url": "https://github.com/bionicles", "followers_url": "https://api.github.com/users/bionicles/followers", "following_url": "https://api.github.com/users/bionicles/following{/other_user}", "gists_url": "https://api.github.com/users/bionicles/gists{/gist_id}", "starred_url": "https://api.github.com/users/bionicles/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bionicles/subscriptions", "organizations_url": "https://api.github.com/users/bionicles/orgs", "repos_url": "https://api.github.com/users/bionicles/repos", "events_url": "https://api.github.com/users/bionicles/events{/privacy}", "received_events_url": "https://api.github.com/users/bionicles/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-09-09T19:49:34Z", "updated_at": "2019-09-10T06:40:24Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using): 2 rc\r\n- Are you willing to contribute it (Yes/No): Not sure how\r\n\r\n**Describe the feature and the current behavior/state.**\r\ntf.math.reduce_sum fails if given an array of differently shaped tensors\r\n\r\n**Will this change the current api? How?**\r\nreduce sum should \"just work\" in the case where user wants to total a bunch of different shapes. \r\n\r\n**Who will benefit with this feature?**\r\nanyone who wants to tally the losses\r\n\r\n**Any Other info.**\r\njust want to tally my losses, but this doesn't work:\r\n`total = tf.math.reduce_sum(LIST_OF_TENSORS)`\r\n```\r\n    @tf.function\r\n    def tally(losses):\r\n        total = 0.\r\n        for loss in losses:\r\n            current = tf.math.reduce_sum(loss)\r\n            tf.print(tf.shape(current))\r\n            total = total + current\r\n        return total\r\n```\r\nthis is a simple common task, `total = tf.math.reduce_sum(LIST_OF_TENSORS)` should just work even if the tensors are differently shaped\r\n\r\n>     ValueError: Shapes must be equal rank, but are 3 and 0"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32361", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32361/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32361/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32361/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32361", "id": 491181304, "node_id": "MDU6SXNzdWU0OTExODEzMDQ=", "number": 32361, "title": "load custom op library when using c++?", "user": {"login": "7oud", "id": 7981826, "node_id": "MDQ6VXNlcjc5ODE4MjY=", "avatar_url": "https://avatars0.githubusercontent.com/u/7981826?v=4", "gravatar_id": "", "url": "https://api.github.com/users/7oud", "html_url": "https://github.com/7oud", "followers_url": "https://api.github.com/users/7oud/followers", "following_url": "https://api.github.com/users/7oud/following{/other_user}", "gists_url": "https://api.github.com/users/7oud/gists{/gist_id}", "starred_url": "https://api.github.com/users/7oud/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/7oud/subscriptions", "organizations_url": "https://api.github.com/users/7oud/orgs", "repos_url": "https://api.github.com/users/7oud/repos", "events_url": "https://api.github.com/users/7oud/events{/privacy}", "received_events_url": "https://api.github.com/users/7oud/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2019-09-09T15:52:31Z", "updated_at": "2019-12-10T23:48:21Z", "closed_at": null, "author_association": "NONE", "body": "I have build a very simple custom op `zero_out.dll` with bazel, it works when using python.\r\n```\r\nimport tensorflow as tf\r\nzero_out_module = tf.load_op_library('./zero_out.dll')\r\nwith tf.Session(''):\r\n  zero_out_module.zero_out([[1, 2], [3, 4]]).eval()\r\n```\r\nHowever I have to run the inference using C++, is there any c++ api which has the similar function as `tf.load_op_library`, or it seems that a lot of registeration work has been done in `tf.load_op_library`, TF has not counterpart c++ API?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32359", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32359/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32359/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32359/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32359", "id": 491155886, "node_id": "MDU6SXNzdWU0OTExNTU4ODY=", "number": 32359, "title": "[TPU][TF 1.14]Can not reload the trained model for training on Colab TPU.", "user": {"login": "rishabhsahrawat", "id": 15910460, "node_id": "MDQ6VXNlcjE1OTEwNDYw", "avatar_url": "https://avatars2.githubusercontent.com/u/15910460?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rishabhsahrawat", "html_url": "https://github.com/rishabhsahrawat", "followers_url": "https://api.github.com/users/rishabhsahrawat/followers", "following_url": "https://api.github.com/users/rishabhsahrawat/following{/other_user}", "gists_url": "https://api.github.com/users/rishabhsahrawat/gists{/gist_id}", "starred_url": "https://api.github.com/users/rishabhsahrawat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rishabhsahrawat/subscriptions", "organizations_url": "https://api.github.com/users/rishabhsahrawat/orgs", "repos_url": "https://api.github.com/users/rishabhsahrawat/repos", "events_url": "https://api.github.com/users/rishabhsahrawat/events{/privacy}", "received_events_url": "https://api.github.com/users/rishabhsahrawat/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097541661, "node_id": "MDU6TGFiZWwxMDk3NTQxNjYx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tpus", "name": "comp:tpus", "color": "0052cc", "default": false, "description": "tpu, tpuestimator"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jhseu", "id": 170179, "node_id": "MDQ6VXNlcjE3MDE3OQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/170179?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jhseu", "html_url": "https://github.com/jhseu", "followers_url": "https://api.github.com/users/jhseu/followers", "following_url": "https://api.github.com/users/jhseu/following{/other_user}", "gists_url": "https://api.github.com/users/jhseu/gists{/gist_id}", "starred_url": "https://api.github.com/users/jhseu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jhseu/subscriptions", "organizations_url": "https://api.github.com/users/jhseu/orgs", "repos_url": "https://api.github.com/users/jhseu/repos", "events_url": "https://api.github.com/users/jhseu/events{/privacy}", "received_events_url": "https://api.github.com/users/jhseu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jhseu", "id": 170179, "node_id": "MDQ6VXNlcjE3MDE3OQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/170179?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jhseu", "html_url": "https://github.com/jhseu", "followers_url": "https://api.github.com/users/jhseu/followers", "following_url": "https://api.github.com/users/jhseu/following{/other_user}", "gists_url": "https://api.github.com/users/jhseu/gists{/gist_id}", "starred_url": "https://api.github.com/users/jhseu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jhseu/subscriptions", "organizations_url": "https://api.github.com/users/jhseu/orgs", "repos_url": "https://api.github.com/users/jhseu/repos", "events_url": "https://api.github.com/users/jhseu/events{/privacy}", "received_events_url": "https://api.github.com/users/jhseu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 13, "created_at": "2019-09-09T15:08:00Z", "updated_at": "2019-09-23T06:36:16Z", "closed_at": null, "author_association": "NONE", "body": "I trained a model on Colab TPU and then saved it using callbacks in `model.fit()`. Now, I want to continue training model after restoring it from the last checkpoint saved as h5 format. This file has layer weights and optimizer weights i.e. also the architecture. On loading the model inside `TPUStrategy scope()` as follows-\r\n````\r\nTPU_WORKER = 'grpc://' + os.environ['COLAB_TPU_ADDR']# Name or Address of TPU\r\nresolver = tf.contrib.cluster_resolver.TPUClusterResolver(TPU_WORKER)\r\ntf.contrib.distribute.initialize_tpu_system(resolver)\r\nstrategy = tf.contrib.distribute.TPUStrategy(resolver)\r\n\r\nwith strategy.scope():\r\n  saved_model_file_name = os.path.join(\"/content/gdrive/My Drive/data\", 'GDmodel09.h5')# saved model is on my Google Drive\r\n  model = tf.keras.models.load_model(saved_model_file_name)\r\n````\r\nthe last line throws following error-\r\n`AttributeError: 'NoneType' object has no attribute 'merge_call'`\r\nHowever, if I load the model outside scope then it gets loaded without any error.\r\nPlease help. Thank you!"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32357", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32357/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32357/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32357/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32357", "id": 491127544, "node_id": "MDU6SXNzdWU0OTExMjc1NDQ=", "number": 32357, "title": "Keras 'fit_generator' - Zip object is not considered generator or sequence in ", "user": {"login": "kevinkepp", "id": 787153, "node_id": "MDQ6VXNlcjc4NzE1Mw==", "avatar_url": "https://avatars0.githubusercontent.com/u/787153?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kevinkepp", "html_url": "https://github.com/kevinkepp", "followers_url": "https://api.github.com/users/kevinkepp/followers", "following_url": "https://api.github.com/users/kevinkepp/following{/other_user}", "gists_url": "https://api.github.com/users/kevinkepp/gists{/gist_id}", "starred_url": "https://api.github.com/users/kevinkepp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kevinkepp/subscriptions", "organizations_url": "https://api.github.com/users/kevinkepp/orgs", "repos_url": "https://api.github.com/users/kevinkepp/repos", "events_url": "https://api.github.com/users/kevinkepp/events{/privacy}", "received_events_url": "https://api.github.com/users/kevinkepp/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-09-09T14:21:36Z", "updated_at": "2020-01-30T17:36:36Z", "closed_at": null, "author_association": "NONE", "body": "**Description**\r\nKeras Model `fit_generator` does not work with `zip` objects.\r\nI followed the image segmentation example from https://keras.io/preprocessing/image/ of loading and transforming images and masks together and then training a model with `fit_generator`.\r\n\r\nI'm getting `AttributeError: 'zip' object has no attribute 'shape'` (see stack trace below)\r\n\r\n**System information**\r\n- TensorFlow version: 1.14.0 and 2.0.0-RC\r\n- Python version: 3.7.3\r\n- Occurs on both CPU and GPU execution\r\n\r\n**Code to reproduce the issue**\r\nCode taken from https://keras.io/preprocessing/image/\r\n\r\n```\r\n# we create two instances with the same arguments\r\ndata_gen_args = dict(featurewise_center=True,\r\n                     featurewise_std_normalization=True,\r\n                     rotation_range=90,\r\n                     width_shift_range=0.1,\r\n                     height_shift_range=0.1,\r\n                     zoom_range=0.2)\r\nimage_datagen = ImageDataGenerator(**data_gen_args)\r\nmask_datagen = ImageDataGenerator(**data_gen_args)\r\n\r\n# Provide the same seed and keyword arguments to the fit and flow methods\r\nseed = 1\r\nimage_datagen.fit(images, augment=True, seed=seed)\r\nmask_datagen.fit(masks, augment=True, seed=seed)\r\n\r\nimage_generator = image_datagen.flow_from_directory(\r\n    'data/images',\r\n    class_mode=None,\r\n    seed=seed)\r\n\r\nmask_generator = mask_datagen.flow_from_directory(\r\n    'data/masks',\r\n    class_mode=None,\r\n    seed=seed)\r\n\r\n# combine generators into one which yields image and masks\r\ntrain_generator = zip(image_generator, mask_generator)\r\n\r\nmodel.fit_generator(\r\n    train_generator,\r\n    steps_per_epoch=2000,\r\n    epochs=50)\r\n```\r\n\r\n**Stacktrace**\r\n```\r\nFile \"/home/kevin/dev/code/image-gen/src/train.py\", line 47, in main\r\n    validation_steps=1)\r\n  File \"/home/kevin/dev/venvs/image-gen/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py\", line 1303, in fit_generator\r\n    steps_name='steps_per_epoch')\r\n  File \"/home/kevin/dev/venvs/image-gen/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_generator.py\", line 144, in model_iteration\r\n    shuffle=shuffle)\r\n  File \"/home/kevin/dev/venvs/image-gen/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_generator.py\", line 477, in convert_to_generator_like\r\n    num_samples = int(nest.flatten(data)[0].shape[0])\r\nAttributeError: 'zip' object has no attribute 'shape'\r\n```\r\n\r\n**Workaround**:\r\nCreate generator from zip object\r\n`train_generator = (pair for pair in zip(image_generator, mask_generator))`\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32355", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32355/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32355/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32355/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32355", "id": 491123366, "node_id": "MDU6SXNzdWU0OTExMjMzNjY=", "number": 32355, "title": "Custom Distributed Strategy", "user": {"login": "jpadrao", "id": 11543583, "node_id": "MDQ6VXNlcjExNTQzNTgz", "avatar_url": "https://avatars2.githubusercontent.com/u/11543583?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jpadrao", "html_url": "https://github.com/jpadrao", "followers_url": "https://api.github.com/users/jpadrao/followers", "following_url": "https://api.github.com/users/jpadrao/following{/other_user}", "gists_url": "https://api.github.com/users/jpadrao/gists{/gist_id}", "starred_url": "https://api.github.com/users/jpadrao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jpadrao/subscriptions", "organizations_url": "https://api.github.com/users/jpadrao/orgs", "repos_url": "https://api.github.com/users/jpadrao/repos", "events_url": "https://api.github.com/users/jpadrao/events{/privacy}", "received_events_url": "https://api.github.com/users/jpadrao/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-09-09T14:14:43Z", "updated_at": "2019-12-04T15:55:49Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): 1.14.0\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\nAs Tensorflow stands, there is no easy and intuitive way to implement a new distribution strategy. The ones available, (MirroredStrategy, MultiWorkerMirroredStrategy, ...), work fine but the code seems very complex, and there isn't a tutorial/guide on how to develop a new one\r\n\r\n**Will this change the current api? How?**\r\n\r\nThe api cloud be restructured to ease the support of new distributed strategy. A tutorial/guide on how to develop one would also be appreciated \r\n\r\n**Who will benefit with this feature?**\r\n\r\nResearchers who want to reduce the time spent training distributed tensorflow models\r\n\r\n**Any Other info.**"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32345", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32345/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32345/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32345/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32345", "id": 491009831, "node_id": "MDU6SXNzdWU0OTEwMDk4MzE=", "number": 32345, "title": "[lite/micro] Huge size of libtensorflow-microlite.a for arm", "user": {"login": "csukuangfj", "id": 5284924, "node_id": "MDQ6VXNlcjUyODQ5MjQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/5284924?v=4", "gravatar_id": "", "url": "https://api.github.com/users/csukuangfj", "html_url": "https://github.com/csukuangfj", "followers_url": "https://api.github.com/users/csukuangfj/followers", "following_url": "https://api.github.com/users/csukuangfj/following{/other_user}", "gists_url": "https://api.github.com/users/csukuangfj/gists{/gist_id}", "starred_url": "https://api.github.com/users/csukuangfj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/csukuangfj/subscriptions", "organizations_url": "https://api.github.com/users/csukuangfj/orgs", "repos_url": "https://api.github.com/users/csukuangfj/repos", "events_url": "https://api.github.com/users/csukuangfj/events{/privacy}", "received_events_url": "https://api.github.com/users/csukuangfj/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-09-09T10:21:42Z", "updated_at": "2020-01-22T01:22:22Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "\r\nThe file `tensorflow/lite/experimental/micro/README.md` says \r\n>The core runtime fits in 16KB on a Cortex M3, and with enough operators to run a speech keyword detection model, takes up a total of 22KB.\r\n\r\nBut after compiling `libtensorflow-microlite.a`, I get\r\n\r\n```\r\nls -lh\r\ntotal 512\r\n-rw-r--r--  1 xxx  xxx   254K Sep  9 18:11 libtensorflow-microlite.a\r\n```\r\n\r\nwhich is an order of magnitude larger than `22KB`.\r\n\r\nThe command I used to compile it is:\r\n\r\n```\r\nmake -j2 -f tensorflow/lite/experimental/micro/tools/make/Makefile TARGET=foo microlite\r\n```\r\n\r\nThe configuration file `lite/experimental/micro/tools/make/targets/foo_makefile.inc` is \r\n```\r\nifeq ($(TARGET), foo)\r\n\r\nTARGET_TOOLCHAIN_PREFIX := arm-none-eabi-\r\n\r\nCOMMON_FLAGS := \\\r\n-O2 \\\r\n-fno-unwind-tables \\\r\n-fstack-reuse=all -ffunction-sections -fdata-sections -Wl,--gc-sections -nostartfiles \\\r\n-mthumb -mcpu=cortex-m4 -march=armv7e-m -mfloat-abi=hard -mfpu=fpv4-sp-d16 \\\r\n-mno-thumb-interwork -ffast-math  \\\r\n-Wall -Werror -Wlogical-op -Waddress -Wempty-body -Wpointer-arith \\\r\n-Wenum-compare  -fno-strict-aliasing \\\r\n-Wno-sign-compare \\\r\n-nostdlib \\\r\n-fno-exceptions \\\r\n-fno-unwind-tables \\\r\n-fno-builtin\r\n\r\nCXXFLAGS += $(COMMON_FLAGS) -fno-rtti\r\nCCFLAGS += $(COMMON_FLAGS)\r\n\r\nendif\r\n```\r\n\r\nThe compiler toolchain information is as follows:\r\n\r\n```\r\n$ arm-none-eabi-gcc --version\r\narm-none-eabi-gcc (GNU Tools for ARM Embedded Processors) 5.3.1 20160307 (release) [ARM/embedded-5-branch revision 234589]\r\nCopyright (C) 2015 Free Software Foundation, Inc.\r\nThis is free software; see the source for copying conditions.  There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32341", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32341/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32341/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32341/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32341", "id": 490894516, "node_id": "MDU6SXNzdWU0OTA4OTQ1MTY=", "number": 32341, "title": "Keras model with sequence feature columns fails to convert to estimator", "user": {"login": "shkarupa-alex", "id": 1289725, "node_id": "MDQ6VXNlcjEyODk3MjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1289725?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shkarupa-alex", "html_url": "https://github.com/shkarupa-alex", "followers_url": "https://api.github.com/users/shkarupa-alex/followers", "following_url": "https://api.github.com/users/shkarupa-alex/following{/other_user}", "gists_url": "https://api.github.com/users/shkarupa-alex/gists{/gist_id}", "starred_url": "https://api.github.com/users/shkarupa-alex/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shkarupa-alex/subscriptions", "organizations_url": "https://api.github.com/users/shkarupa-alex/orgs", "repos_url": "https://api.github.com/users/shkarupa-alex/repos", "events_url": "https://api.github.com/users/shkarupa-alex/events{/privacy}", "received_events_url": "https://api.github.com/users/shkarupa-alex/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, {"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-09-09T06:07:34Z", "updated_at": "2019-10-10T21:32:18Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Google Colab\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: No\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): v2.0.0-beta1-5101-gc75bb66 2.0.0-rc0\r\n- Python version: 3\r\n- Bazel version (if compiling from source): No\r\n- GCC/Compiler version (if compiling from source): No\r\n- CUDA/cuDNN version: Unknown, from Colab\r\n- GPU model and memory: Unknown, from Colab\r\n\r\n\r\n**Describe the current behavior**\r\nWhen i rewrote my estimator-based model (Dataset + Feature columns) to keras i was able to run (train) it.\r\n\r\nBut when i converted it to estimator as shown in migration guide https://www.tensorflow.org/beta/guide/migration_guide#estimators it fails with error\r\n```python\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-7-6538390f0054> in <module>()\r\n      1 estimator = tf.keras.estimator.model_to_estimator(\r\n----> 2   keras_model = model\r\n      3 )\r\n\r\n9 frames\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/autograph/impl/api.py in wrapper(*args, **kwargs)\r\n    235       except Exception as e:  # pylint:disable=broad-except\r\n    236         if hasattr(e, 'ag_error_metadata'):\r\n--> 237           raise e.ag_error_metadata.to_exception(e)\r\n    238         else:\r\n    239           raise\r\n\r\nValueError: in converted code:\r\n    relative to /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/feature_column:\r\n\r\n    sequence_feature_column.py:140 call\r\n        transformation_cache, self._state_manager)\r\n    feature_column_v2.py:3205 get_sequence_dense_tensor\r\n        self.categorical_column))\r\n\r\n    ValueError: In embedding_column: words_embedding. categorical_column must be of type SequenceCategoricalColumn to use SequenceFeatures. Suggested fix: Use one of sequence_categorical_column_with_*. Given (type <class 'tensorflow.python.feature_column.feature_column_v2.HashedCategoricalColumn'>): HashedCategoricalColumn(key='words', hash_bucket_size=1000, dtype=tf.string)\r\n```\r\n\r\n**Describe the expected behavior**\r\nWorking keras model should always be convertable to estimator.\r\n\r\n**Code to reproduce the issue**\r\nHere is an example https://colab.research.google.com/drive/11pWyltRzvQPPvM2dWQ8EqxafB9ByCxNn\r\nThere are 2 cases shown. First i show that keras model with sequence features is working. See `model.fit_generator`.\r\nAnd then i show that conversion to estimator fails.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32335", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32335/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32335/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32335/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32335", "id": 490818056, "node_id": "MDU6SXNzdWU0OTA4MTgwNTY=", "number": 32335, "title": "For long labels / logits, torch.nn.CTCloss is 30-100x faster than tf.nn.ctc_loss", "user": {"login": "ASDen", "id": 124146, "node_id": "MDQ6VXNlcjEyNDE0Ng==", "avatar_url": "https://avatars3.githubusercontent.com/u/124146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ASDen", "html_url": "https://github.com/ASDen", "followers_url": "https://api.github.com/users/ASDen/followers", "following_url": "https://api.github.com/users/ASDen/following{/other_user}", "gists_url": "https://api.github.com/users/ASDen/gists{/gist_id}", "starred_url": "https://api.github.com/users/ASDen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ASDen/subscriptions", "organizations_url": "https://api.github.com/users/ASDen/orgs", "repos_url": "https://api.github.com/users/ASDen/repos", "events_url": "https://api.github.com/users/ASDen/events{/privacy}", "received_events_url": "https://api.github.com/users/ASDen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-09-08T22:38:54Z", "updated_at": "2019-12-12T21:56:47Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\nDefault Google Colab GPU runtime\r\n\r\n**Describe the current behavior**\r\nFor long labels / logits, tf.nn.ctc_loss is unbearably slow, in a way that makes whole training very slow (tf.nn.ctc_loss_v2 is even slower)\r\nA standard GPU implementation with unbounded label length such as one offered by torch.nn.CTCloss is many many times faster\r\n\r\n**Code to reproduce the issue**\r\nThe following code is used for the benchmark\r\n\r\n```\r\nfrom torch import nn\r\nimport torch\r\nimport tensorflow as tf\r\nimport math\r\nimport time\r\n\r\ntime_step  = 5  # Input sequence length\r\nvocab_size = 200  # Number of classes\r\nbatch_size = 4  # Batch size\r\ntarget_sql = 3  # Target sequence length\r\n\r\niters = 6\r\nwarm  = 3\r\nDENSE = False\r\n\r\ndef dense_to_sparse(dense_tensor, sequence_length):\r\n    indices = tf.where(tf.sequence_mask(sequence_length))\r\n    values = tf.gather_nd(dense_tensor, indices)\r\n    shape = tf.shape(dense_tensor, out_type=tf.int64)\r\n    return tf.SparseTensor(indices, values, shape)\r\n\r\n\r\nctc_loss = nn.CTCLoss(blank=vocab_size - 1, reduction='none')\r\n\r\nfor j in range(25):\r\n  time_step  *= 2\r\n  target_sql *= 2\r\n  print('Logits length : ',time_step,'Label length : ',target_sql)\r\n  print('-------------------')\r\n  \r\n  x = torch.randn(time_step, batch_size, vocab_size).log_softmax(2).detach().requires_grad_().cuda()\r\n  y = torch.randint(low=0, high=vocab_size-2, size=(batch_size, target_sql),dtype=torch.long).cuda()\r\n\r\n  x_lengths = torch.full(size=(batch_size,), fill_value=time_step, dtype=torch.long).cuda()\r\n  y_lengths = torch.full(size=(batch_size,), fill_value=target_sql, dtype=torch.long).cuda()\r\n\r\n  s=0\r\n  tlss=0.\r\n  for i in range(iters):\r\n      torch.cuda.synchronize()\r\n      a = time.perf_counter()\r\n      loss = ctc_loss(x.log_softmax(2), y, x_lengths, y_lengths).mean()\r\n      torch.cuda.synchronize()\r\n      b = time.perf_counter()\r\n      tlss += float(loss)\r\n      del loss\r\n  \r\n      if i>=warm:\r\n          s += b - a\r\n\r\n  torch.cuda.empty_cache()\r\n  avtorch = s/(iters-warm)\r\n  print('Average torch Time : %.6f'%(avtorch),'Loss : %.3f'%(tlss/iters))\r\n\r\n  ###################################\r\n  ###################################\r\n  \r\n  x = x.detach().cpu().numpy()\r\n  y = y.detach().cpu().numpy()\r\n  x_lengths = x_lengths.detach().cpu().numpy()\r\n  y_lengths = y_lengths.detach().cpu().numpy()\r\n\r\n  if not DENSE:\r\n    y = tf.cast(dense_to_sparse(y, y_lengths), dtype=tf.int32)\r\n  else:\r\n    y = tf.cast(y, dtype=tf.int32)\r\n\r\n\r\n  _x = tf.placeholder(tf.float32, [None, None, None])\r\n\r\n  if not DENSE:\r\n    ctclosses = tf.nn.ctc_loss(y, _x, x_lengths)\r\n  else:\r\n    ctclosses = tf.nn.ctc_loss_v2(y, _x, [target_sql]*batch_size, x_lengths, blank_index=-1)\r\n\r\n  ctclosses = tf.reduce_mean(ctclosses)\r\n\r\n  with tf.Session() as sess:\r\n      s=0\r\n      flss = 0\r\n      for i in range(iters):\r\n          a = time.perf_counter()\r\n          loss = sess.run(ctclosses, feed_dict={_x: x})\r\n          b = time.perf_counter()\r\n          flss += float(loss)\r\n          if i>=warm:\r\n            s += b - a\r\n      \r\n      avtf = s/(iters-warm)\r\n      print('Average tf Time    : %.6f'%(avtf),'Loss : %.3f'%(flss/iters))\r\n\r\n  print('Loss diff : %.6f'%(abs(tlss-flss)))\r\n  print('torch.nn.CTCloss Speed-up : %.2f'%(avtf/avtorch),'\\n\\n')\r\n\r\n```\r\nand get the following results\r\n```\r\nLogits length :  10 Label length :  6\r\n-------------------\r\nAverage torch Time : 0.000162 Loss : 47.414\r\nAverage tf Time    : 0.001151 Loss : 47.414\r\nLoss diff : 0.000046\r\ntorch.nn.CTCloss Speed-up : 7.09 \r\n\r\n\r\nLogits length :  20 Label length :  12\r\n-------------------\r\nAverage torch Time : 0.000173 Loss : 95.054\r\nAverage tf Time    : 0.001166 Loss : 95.054\r\nLoss diff : 0.000092\r\ntorch.nn.CTCloss Speed-up : 6.74 \r\n\r\n\r\nLogits length :  40 Label length :  24\r\n-------------------\r\nAverage torch Time : 0.000172 Loss : 183.101\r\nAverage tf Time    : 0.001589 Loss : 183.101\r\nLoss diff : 0.000092\r\ntorch.nn.CTCloss Speed-up : 9.23 \r\n\r\n\r\nLogits length :  80 Label length :  48\r\n-------------------\r\nAverage torch Time : 0.000252 Loss : 363.414\r\nAverage tf Time    : 0.003907 Loss : 363.414\r\nLoss diff : 0.000000\r\ntorch.nn.CTCloss Speed-up : 15.52 \r\n\r\n\r\nLogits length :  160 Label length :  96\r\n-------------------\r\nAverage torch Time : 0.000580 Loss : 727.621\r\nAverage tf Time    : 0.008144 Loss : 727.621\r\nLoss diff : 0.000366\r\ntorch.nn.CTCloss Speed-up : 14.05 \r\n\r\n\r\nLogits length :  320 Label length :  192\r\n-------------------\r\nAverage torch Time : 0.001026 Loss : 1446.162\r\nAverage tf Time    : 0.025436 Loss : 1446.162\r\nLoss diff : 0.001465\r\ntorch.nn.CTCloss Speed-up : 24.80 \r\n\r\n\r\nLogits length :  640 Label length :  384\r\n-------------------\r\nAverage torch Time : 0.001742 Loss : 2894.562\r\nAverage tf Time    : 0.098221 Loss : 2894.562\r\nLoss diff : 0.004395\r\ntorch.nn.CTCloss Speed-up : 56.38 \r\n\r\n\r\nLogits length :  1280 Label length :  768\r\n-------------------\r\nAverage torch Time : 0.006307 Loss : 5772.526\r\nAverage tf Time    : 0.379303 Loss : 5772.524\r\nLoss diff : 0.011719\r\ntorch.nn.CTCloss Speed-up : 60.14 \r\n\r\n\r\nLogits length :  2560 Label length :  1536\r\n-------------------\r\nAverage torch Time : 0.025078 Loss : 11538.377\r\nAverage tf Time    : 1.546986 Loss : 11538.381\r\nLoss diff : 0.023438\r\ntorch.nn.CTCloss Speed-up : 61.69 \r\n\r\n\r\nLogits length :  5120 Label length :  3072\r\n-------------------\r\nAverage torch Time : 0.043300 Loss : 23038.340\r\nAverage tf Time    : 6.084921 Loss : 23038.336\r\nLoss diff : 0.023438\r\ntorch.nn.CTCloss Speed-up : 140.53 \r\n\r\n\r\nLogits length :  10240 Label length :  6144\r\n-------------------\r\nAverage torch Time : 0.312641 Loss : 46052.559\r\nAverage tf Time    : 23.677528 Loss : 46052.535\r\nLoss diff : 0.140625\r\ntorch.nn.CTCloss Speed-up : 75.73 \r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32323", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32323/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32323/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32323/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32323", "id": 490703487, "node_id": "MDU6SXNzdWU0OTA3MDM0ODc=", "number": 32323, "title": "Build fails on latest master with clang and CUDA", "user": {"login": "SamuelMarks", "id": 807580, "node_id": "MDQ6VXNlcjgwNzU4MA==", "avatar_url": "https://avatars0.githubusercontent.com/u/807580?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SamuelMarks", "html_url": "https://github.com/SamuelMarks", "followers_url": "https://api.github.com/users/SamuelMarks/followers", "following_url": "https://api.github.com/users/SamuelMarks/following{/other_user}", "gists_url": "https://api.github.com/users/SamuelMarks/gists{/gist_id}", "starred_url": "https://api.github.com/users/SamuelMarks/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SamuelMarks/subscriptions", "organizations_url": "https://api.github.com/users/SamuelMarks/orgs", "repos_url": "https://api.github.com/users/SamuelMarks/repos", "events_url": "https://api.github.com/users/SamuelMarks/events{/privacy}", "received_events_url": "https://api.github.com/users/SamuelMarks/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-09-08T02:55:59Z", "updated_at": "2019-11-02T10:03:55Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version: b78ed2c5973ddebb2589558d722ea78da238e815\r\n- Python version: 3.6.8\r\n- Installed using virtualenv? pip? conda?:\r\n- Bazel version (if compiling from source): 0.25.2\r\n- GCC/Compiler version (if compiling from source): clang 6.0.0-1ubuntu2\r\n- CUDA/cuDNN version: 10.2\r\n- GPU model and memory: NVIDIA Tesla K80 11441MiB\r\n\r\n**Describe the problem**\r\n> **FAILED: Build did NOT complete successfully**\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n\r\nBuild script:\r\nhttps://github.com/offscale/offregister-tensorflow/blob/5bf7a19f6b5056362442177128dbae92304ef6c3/offregister_tensorflow/ubuntu/utils.py#L148\r\n\r\nSpecifically:\r\n```\r\n./configure\r\nbazel build --config=opt //tensorflow/tools/pip_package:build_pip_package\r\n```\r\n(fails on that second line)\r\n\r\nEnvironment variables set (+ `PYTHON_LIB_PATH` and `PYTHON_BIN_PATH`):\r\n```\r\n{'CC_OPT_FLAGS': '-march=native',\r\n 'CLANG_CUDA_COMPILER_PATH': '/usr/bin/clang',\r\n 'LD_LIBRARY_PATH': '/usr/local/cuda/extras/CUPTI/lib64',\r\n 'TF_CUDA_CLANG': '1',\r\n 'TF_CUDA_COMPUTE_CAPABILITIES': '3.7',\r\n 'TF_DOWNLOAD_CLANG': '0',\r\n 'TF_DOWNLOAD_MKL': '1',\r\n 'TF_ENABLE_XLA': '0',\r\n 'TF_NEED_COMPUTECPP': '0',\r\n 'TF_NEED_CUDA': '1',\r\n 'TF_NEED_GCP': '0',\r\n 'TF_NEED_GDR': '0',\r\n 'TF_NEED_HDFS': '0',\r\n 'TF_NEED_JEMALLOC': '1',\r\n 'TF_NEED_KAFKA': '0',\r\n 'TF_NEED_MKL': '1',\r\n 'TF_NEED_MPI': '0',\r\n 'TF_NEED_OPENCL': '0',\r\n 'TF_NEED_OPENCL_SYCL': '0',\r\n 'TF_NEED_ROCM': '0',\r\n 'TF_NEED_S3': '0',\r\n 'TF_NEED_TENSORRT': '1',\r\n 'TF_NEED_VERBS': '0',\r\n 'TF_SET_ANDROID_WORKSPACE': '0'}\r\n```\r\n\r\n\r\n**Any other info / logs**\r\n```\r\n\r\nERROR: /home/ubuntu/repos/tensorflow-for-py3/tensorflow/core/kernels/BUILD:2518:1: output 'tensorflow/core/kernels/_objs/dynamic_stitch_op_gpu/dynamic_stitch_op_gpu.cu.pic.o' was not created\r\n[8,641 / 8,655] 4 actions running\r\n    Compiling tensorflow/core/kernels/sparse_matmul_op.cc; 16s local\r\n    Compiling tensorflow/core/kernels/dynamic_stitch_op_gpu.cu.cc; 12s local\r\n    Compiling tensorflow/core/kernels/data/cache_dataset_ops.cc; 7s local\r\n    Compiling tensorflow/core/kernels/fifo_queue_op.cc; 4s local\r\n\r\n\r\n\r\n\r\n\r\nERROR: /home/ubuntu/repos/tensorflow-for-py3/tensorflow/core/kernels/BUILD:2518:1: not all outputs were created or valid\r\n[8,641 / 8,655] 4 actions running\r\n    Compiling tensorflow/core/kernels/sparse_matmul_op.cc; 16s local\r\n    Compiling tensorflow/core/kernels/dynamic_stitch_op_gpu.cu.cc; 12s local\r\n    Compiling tensorflow/core/kernels/data/cache_dataset_ops.cc; 7s local\r\n    Compiling tensorflow/core/kernels/fifo_queue_op.cc; 4s local\r\n\r\n\r\n\r\n\r\n\r\n[8,645 / 8,655] checking cached actions\r\n\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\n[8,645 / 8,655] checking cached actions\r\n\r\nUse --verbose_failures to see the command lines of failed build steps.\r\n[8,645 / 8,655] checking cached actions\r\n\r\nINFO: Elapsed time: 3087.912s, Critical Path: 114.34s\r\n[8,645 / 8,655] checking cached actions\r\n\r\nINFO: 5399 processes: 5399 local.\r\n[8,645 / 8,655] checking cached actions\r\n\r\nFAILED: Build did NOT complete successfully\r\n\r\nFAILED: Build did NOT complete successfully\r\n```"}]