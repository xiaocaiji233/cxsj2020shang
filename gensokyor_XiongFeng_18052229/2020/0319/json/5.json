[{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36868", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36868/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36868/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36868/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36868", "id": 567203048, "node_id": "MDExOlB1bGxSZXF1ZXN0Mzc2ODcyNzQx", "number": 36868, "title": "Cadence HiFi4 Neural Network (NN) Library", "user": {"login": "nyadla-sys", "id": 26728802, "node_id": "MDQ6VXNlcjI2NzI4ODAy", "avatar_url": "https://avatars1.githubusercontent.com/u/26728802?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nyadla-sys", "html_url": "https://github.com/nyadla-sys", "followers_url": "https://api.github.com/users/nyadla-sys/followers", "following_url": "https://api.github.com/users/nyadla-sys/following{/other_user}", "gists_url": "https://api.github.com/users/nyadla-sys/gists{/gist_id}", "starred_url": "https://api.github.com/users/nyadla-sys/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nyadla-sys/subscriptions", "organizations_url": "https://api.github.com/users/nyadla-sys/orgs", "repos_url": "https://api.github.com/users/nyadla-sys/repos", "events_url": "https://api.github.com/users/nyadla-sys/events{/privacy}", "received_events_url": "https://api.github.com/users/nyadla-sys/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 987666414, "node_id": "MDU6TGFiZWw5ODc2NjY0MTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/ready%20to%20pull", "name": "ready to pull", "color": "2cd643", "default": false, "description": ""}, {"id": 1173072136, "node_id": "MDU6TGFiZWwxMTczMDcyMTM2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:XL", "name": "size:XL", "color": "adafea", "default": false, "description": "CL Change Size:Extra Large"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-02-18T22:40:36Z", "updated_at": "2020-03-16T22:19:47Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36868", "html_url": "https://github.com/tensorflow/tensorflow/pull/36868", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36868.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36868.patch"}, "body": "HI Pete,Nick,\r\n\r\nPlease take code changes for optimized Cadence NN HIFi 4 lib \r\n\r\nThanks,\r\nNiranjan\r\nOptimized HiFi4 NN library to run ops for TensorFlowLite for Micro\r\n\r\nSigned-off-by: Prasad Nikam <pnikam@cadence.com>\r\nSigned-off-by: Pramod Kumar Surana <pramods@cadence.com>\r\nSigned-off-by: Niranjan Yadla <nyadla@cadence.com>\r\nSigned-off-by: Ranjit Kumar Voruganti <ranjitv@cadence.com>"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36867", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36867/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36867/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36867/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36867", "id": 567132232, "node_id": "MDU6SXNzdWU1NjcxMzIyMzI=", "number": 36867, "title": "Why i have same value in confusion matrix always 12% even after 17000 lerning rate?", "user": {"login": "konradqweleg", "id": 35398062, "node_id": "MDQ6VXNlcjM1Mzk4MDYy", "avatar_url": "https://avatars2.githubusercontent.com/u/35398062?v=4", "gravatar_id": "", "url": "https://api.github.com/users/konradqweleg", "html_url": "https://github.com/konradqweleg", "followers_url": "https://api.github.com/users/konradqweleg/followers", "following_url": "https://api.github.com/users/konradqweleg/following{/other_user}", "gists_url": "https://api.github.com/users/konradqweleg/gists{/gist_id}", "starred_url": "https://api.github.com/users/konradqweleg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/konradqweleg/subscriptions", "organizations_url": "https://api.github.com/users/konradqweleg/orgs", "repos_url": "https://api.github.com/users/konradqweleg/repos", "events_url": "https://api.github.com/users/konradqweleg/events{/privacy}", "received_events_url": "https://api.github.com/users/konradqweleg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "amahendrakar", "id": 57165142, "node_id": "MDQ6VXNlcjU3MTY1MTQy", "avatar_url": "https://avatars1.githubusercontent.com/u/57165142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amahendrakar", "html_url": "https://github.com/amahendrakar", "followers_url": "https://api.github.com/users/amahendrakar/followers", "following_url": "https://api.github.com/users/amahendrakar/following{/other_user}", "gists_url": "https://api.github.com/users/amahendrakar/gists{/gist_id}", "starred_url": "https://api.github.com/users/amahendrakar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amahendrakar/subscriptions", "organizations_url": "https://api.github.com/users/amahendrakar/orgs", "repos_url": "https://api.github.com/users/amahendrakar/repos", "events_url": "https://api.github.com/users/amahendrakar/events{/privacy}", "received_events_url": "https://api.github.com/users/amahendrakar/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "amahendrakar", "id": 57165142, "node_id": "MDQ6VXNlcjU3MTY1MTQy", "avatar_url": "https://avatars1.githubusercontent.com/u/57165142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amahendrakar", "html_url": "https://github.com/amahendrakar", "followers_url": "https://api.github.com/users/amahendrakar/followers", "following_url": "https://api.github.com/users/amahendrakar/following{/other_user}", "gists_url": "https://api.github.com/users/amahendrakar/gists{/gist_id}", "starred_url": "https://api.github.com/users/amahendrakar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amahendrakar/subscriptions", "organizations_url": "https://api.github.com/users/amahendrakar/orgs", "repos_url": "https://api.github.com/users/amahendrakar/repos", "events_url": "https://api.github.com/users/amahendrakar/events{/privacy}", "received_events_url": "https://api.github.com/users/amahendrakar/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2020-02-18T20:14:52Z", "updated_at": "2020-03-18T05:29:21Z", "closed_at": null, "author_association": "NONE", "body": "Model after train don,t work and Confusion matrix have one column value other column 0\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36853", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36853/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36853/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36853/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36853", "id": 566790534, "node_id": "MDU6SXNzdWU1NjY3OTA1MzQ=", "number": 36853, "title": "The minimum required Cuda capability is 6.0 for the binary C-API releases 1.14.0 and 1.15.0", "user": {"login": "johan-andersson01", "id": 17073827, "node_id": "MDQ6VXNlcjE3MDczODI3", "avatar_url": "https://avatars2.githubusercontent.com/u/17073827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/johan-andersson01", "html_url": "https://github.com/johan-andersson01", "followers_url": "https://api.github.com/users/johan-andersson01/followers", "following_url": "https://api.github.com/users/johan-andersson01/following{/other_user}", "gists_url": "https://api.github.com/users/johan-andersson01/gists{/gist_id}", "starred_url": "https://api.github.com/users/johan-andersson01/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/johan-andersson01/subscriptions", "organizations_url": "https://api.github.com/users/johan-andersson01/orgs", "repos_url": "https://api.github.com/users/johan-andersson01/repos", "events_url": "https://api.github.com/users/johan-andersson01/events{/privacy}", "received_events_url": "https://api.github.com/users/johan-andersson01/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "amahendrakar", "id": 57165142, "node_id": "MDQ6VXNlcjU3MTY1MTQy", "avatar_url": "https://avatars1.githubusercontent.com/u/57165142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amahendrakar", "html_url": "https://github.com/amahendrakar", "followers_url": "https://api.github.com/users/amahendrakar/followers", "following_url": "https://api.github.com/users/amahendrakar/following{/other_user}", "gists_url": "https://api.github.com/users/amahendrakar/gists{/gist_id}", "starred_url": "https://api.github.com/users/amahendrakar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amahendrakar/subscriptions", "organizations_url": "https://api.github.com/users/amahendrakar/orgs", "repos_url": "https://api.github.com/users/amahendrakar/repos", "events_url": "https://api.github.com/users/amahendrakar/events{/privacy}", "received_events_url": "https://api.github.com/users/amahendrakar/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "amahendrakar", "id": 57165142, "node_id": "MDQ6VXNlcjU3MTY1MTQy", "avatar_url": "https://avatars1.githubusercontent.com/u/57165142?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amahendrakar", "html_url": "https://github.com/amahendrakar", "followers_url": "https://api.github.com/users/amahendrakar/followers", "following_url": "https://api.github.com/users/amahendrakar/following{/other_user}", "gists_url": "https://api.github.com/users/amahendrakar/gists{/gist_id}", "starred_url": "https://api.github.com/users/amahendrakar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amahendrakar/subscriptions", "organizations_url": "https://api.github.com/users/amahendrakar/orgs", "repos_url": "https://api.github.com/users/amahendrakar/repos", "events_url": "https://api.github.com/users/amahendrakar/events{/privacy}", "received_events_url": "https://api.github.com/users/amahendrakar/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-02-18T10:21:57Z", "updated_at": "2020-03-12T05:57:33Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution: Ubuntu 18.04\r\n- TensorFlow installed from: binary C-API release (https://storage.googleapis.com/tensorflow/libtensorflow/libtensorflow-gpu-linux-x86_64-1.14.0.tar.gz)\r\n- TensorFlow version: `1.14.0`\r\n- Docker image: `tensorflow/tensorflow:1.14.0-gpu-py3`\r\n- GPU model and memory:\r\n\r\n```\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 440.59       Driver Version: 440.59       CUDA Version: 10.2     |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce GTX 960M    Off  | 00000000:01:00.0 Off |                  N/A |\r\n| N/A   36C    P8    N/A /  N/A |      0MiB /  2004MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|  No running processes found                                                 |\r\n+-----------------------------------------------------------------------------+\r\n```\r\n\r\n\r\n**Describe the problem**\r\nUsing the C-API, the following error occurs when attempting to run inferences with the above GPU setup. \r\n\r\n```\r\n2020-02-18 09:42:51.504548: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2020-02-18 09:42:51.529888: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2599990000 Hz\r\n2020-02-18 09:42:51.530480: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555dbf23f760 executing computations on platform Host. Devices:\r\n2020-02-18 09:42:51.530508: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>\r\n2020-02-18 09:42:51.531487: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1\r\n2020-02-18 09:42:51.541446: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2020-02-18 09:42:51.542021: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: \r\nname: GeForce GTX 960M major: 5 minor: 0 memoryClockRate(GHz): 1.0975\r\npciBusID: 0000:01:00.0\r\n2020-02-18 09:42:51.542289: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.0\r\n2020-02-18 09:42:51.543592: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10.0\r\n2020-02-18 09:42:51.544681: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10.0\r\n2020-02-18 09:42:51.545006: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10.0\r\n2020-02-18 09:42:51.546594: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10.0\r\n2020-02-18 09:42:51.547771: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10.0\r\n2020-02-18 09:42:51.551039: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7\r\n2020-02-18 09:42:51.551147: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2020-02-18 09:42:51.552024: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2020-02-18 09:42:51.552531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1717] Ignoring visible gpu device (device: 0, name: GeForce GTX 960M, pci bus id: 0000:01:00.0, compute capability: 5.0) with Cuda compute capability 5.0. The minimum required Cuda capability is 6.0.\r\n2020-02-18 09:42:51.585097: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2020-02-18 09:42:51.585122: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 \r\n2020-02-18 09:42:51.585128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N \r\n```\r\n\r\nThis issue has previously been raised and fixed in https://github.com/tensorflow/tensorflow/issues/25329 for another setup, but the error remains when using the C-API.\r\n\r\nI have also confirmed the same issue when using the `1.15.0` binary release.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36849", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36849/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36849/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36849/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36849", "id": 566669464, "node_id": "MDExOlB1bGxSZXF1ZXN0Mzc2NDM0Njg3", "number": 36849, "title": "Use case clarification comments #36785", "user": {"login": "abhilash1910", "id": 30946547, "node_id": "MDQ6VXNlcjMwOTQ2NTQ3", "avatar_url": "https://avatars0.githubusercontent.com/u/30946547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abhilash1910", "html_url": "https://github.com/abhilash1910", "followers_url": "https://api.github.com/users/abhilash1910/followers", "following_url": "https://api.github.com/users/abhilash1910/following{/other_user}", "gists_url": "https://api.github.com/users/abhilash1910/gists{/gist_id}", "starred_url": "https://api.github.com/users/abhilash1910/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abhilash1910/subscriptions", "organizations_url": "https://api.github.com/users/abhilash1910/orgs", "repos_url": "https://api.github.com/users/abhilash1910/repos", "events_url": "https://api.github.com/users/abhilash1910/events{/privacy}", "received_events_url": "https://api.github.com/users/abhilash1910/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 703812914, "node_id": "MDU6TGFiZWw3MDM4MTI5MTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/kokoro:force-run", "name": "kokoro:force-run", "color": "1d76db", "default": false, "description": null}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-02-18T06:07:47Z", "updated_at": "2020-03-19T01:16:04Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36849", "html_url": "https://github.com/tensorflow/tensorflow/pull/36849", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36849.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36849.patch"}, "body": "Changes in comments for learning rate =1.0 and epsilon =1e-6 following PR #36785. Added description to suit the use cases where the modifications are required as mentioned in the sections if the paper by M. D. Zeiler"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36848", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36848/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36848/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36848/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36848", "id": 566657067, "node_id": "MDU6SXNzdWU1NjY2NTcwNjc=", "number": 36848, "title": "Not able to use 'training' argument in the call method for a custom layer.", "user": {"login": "ankitesh97", "id": 16163706, "node_id": "MDQ6VXNlcjE2MTYzNzA2", "avatar_url": "https://avatars1.githubusercontent.com/u/16163706?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ankitesh97", "html_url": "https://github.com/ankitesh97", "followers_url": "https://api.github.com/users/ankitesh97/followers", "following_url": "https://api.github.com/users/ankitesh97/following{/other_user}", "gists_url": "https://api.github.com/users/ankitesh97/gists{/gist_id}", "starred_url": "https://api.github.com/users/ankitesh97/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ankitesh97/subscriptions", "organizations_url": "https://api.github.com/users/ankitesh97/orgs", "repos_url": "https://api.github.com/users/ankitesh97/repos", "events_url": "https://api.github.com/users/ankitesh97/events{/privacy}", "received_events_url": "https://api.github.com/users/ankitesh97/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2020-02-18T05:28:31Z", "updated_at": "2020-02-21T19:47:02Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our\r\n[GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md),\r\nwe only address code/doc bugs, performance issues, feature requests and\r\nbuild/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information** :\r\n\r\nOS - CentOs\r\ntensorflow-gpu = 2.1.0\r\ntensorflow = 2.0.0\r\ninstalled in the conda version - conda version : 4.8.1\r\nusing cuda - CUDA Version: 10.1\r\nGpu - Tesla K80\r\npython - 3.6\r\n\r\n\r\n**Describe the current behavior**\r\nNot able to use the 'training' flag when designing a custom layer. Getting error saying that \r\n```\r\noperatorNotAllowedInGraphError            Traceback (most recent call last)\r\n~/miniconda3/envs/CbrainCustomLayer/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/base_layer.py in __call__(self, inputs, *args, **kwargs)\r\n    841                   with auto_control_deps.AutomaticControlDependencies() as acd:\r\n--> 842                     outputs = call_fn(cast_inputs, *args, **kwargs)\r\n    843                     # Wrap Tensors in `outputs` in `tf.identity` to avoid\r\n\r\n~/miniconda3/envs/CbrainCustomLayer/lib/python3.6/site-packages/tensorflow_core/python/autograph/impl/api.py in wrapper(*args, **kwargs)\r\n    236         if hasattr(e, 'ag_error_metadata'):\r\n--> 237           raise e.ag_error_metadata.to_exception(e)\r\n    238         else:\r\n\r\nOperatorNotAllowedInGraphError: in converted code:\r\n\r\n    <ipython-input-26-3ff47d389914>:43 call\r\n        if not training:\r\n    /home/ankitesh/miniconda3/envs/CbrainCustomLayer/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py:765 __bool__\r\n        self._disallow_bool_casting()\r\n    /home/ankitesh/miniconda3/envs/CbrainCustomLayer/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py:534 _disallow_bool_casting\r\n        self._disallow_in_graph_mode(\"using a `tf.Tensor` as a Python `bool`\")\r\n    /home/ankitesh/miniconda3/envs/CbrainCustomLayer/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py:523 _disallow_in_graph_mode\r\n        \" this function with @tf.function.\".format(task))\r\n\r\n    OperatorNotAllowedInGraphError: using a `tf.Tensor` as a Python `bool` is not allowed in Graph execution. Use Eager execution or decorate this function with @tf.function.\r\n```\r\n**Describe the expected behavior**\r\nIt should not give an error\r\n\r\n**Code to reproduce the issue** Provide a reproducible test case that is the\r\nbare minimum necessary to generate the problem.\r\n\r\nThis is the class that I made\r\n\r\n```python\r\nfrom tensorflow.keras import initializers\r\nfrom tensorflow.keras import layers\r\n\r\n\r\nclass CustomBatchNormalization(layers.Layer):\r\n    def __init__(self, momentum=0.99, epsilon=1e-3,beta_initializer='zeros',\r\n                 gamma_initializer='ones', moving_mean_initializer='zeros',\r\n                 moving_range_initializer='ones',**kwargs):\r\n        self.momentum = momentum\r\n        self.epsilon = epsilon\r\n        self.beta_initializer = initializers.get(beta_initializer)\r\n        self.gamma_initializer = initializers.get(gamma_initializer)\r\n        self.moving_mean_initializer = initializers.get(moving_mean_initializer)\r\n        self.moving_range_initializer = (\r\n            initializers.get(moving_range_initializer))\r\n        \r\n        super().__init__(**kwargs)\r\n    \r\n    def build(self,input_shape):\r\n        dim = input_shape[-1]\r\n        shape = (dim,)\r\n        self.gamma = self.add_weight(shape=shape,\r\n                             name='gamma',\r\n                             initializer=self.gamma_initializer,trainable=True)\r\n        self.beta = self.add_weight(shape=shape,\r\n                            name='beta',\r\n                            initializer=self.beta_initializer,\r\n                                   trainable=True)\r\n        \r\n        self.moving_mean = self.add_weight(\r\n            shape=shape,\r\n            name='moving_mean',\r\n            initializer=self.moving_mean_initializer,\r\n            trainable=False)\r\n        \r\n        self.moving_range = self.add_weight(\r\n            shape=shape,\r\n            name='moving_range',\r\n            initializer=self.moving_range_initializer,\r\n            trainable=False)\r\n\r\n\r\n\r\n    def call(self, inputs, training=None):\r\n        input_shape = inputs.shape\r\n        \r\n        if not training:\r\n            scaled = (inputs-self.moving_mean)/(self.moving_range+self.epsilon)\r\n            return self.gamma*scaled + self.beta\r\n        \r\n        mean = tf.math.reduce_mean(inputs,axis=0)\r\n        maxr = tf.math.reduce_max(inputs,axis=0)\r\n        minr = tf.math.reduce_min(inputs,axis=0)\r\n        \r\n        range_diff = tf.math.subtract(maxr,minr)\r\n        self.moving_mean = tf.math.add(self.momentum*self.moving_mean, (1-self.momentum)*mean)\r\n        self.moving_range = tf.math.add(self.momentum*self.moving_range,(1-self.momentum)*range_diff)\r\n        scaled = tf.math.divide(tf.math.subtract(inputs,mean),(range_diff+self.epsilon))\r\n        return tf.math.add(tf.math.multiply(self.gamma,scaled),self.beta)\r\n    \r\n    def get_config(self):\r\n        config = {\r\n            'momentum': self.momentum,\r\n            'epsilon': self.epsilon,\r\n            'beta_initializer': initializers.serialize(self.beta_initializer),\r\n            'gamma_initializer': initializers.serialize(self.gamma_initializer),\r\n            'moving_mean_initializer':\r\n                initializers.serialize(self.moving_mean_initializer),\r\n            'moving_range_initializer':\r\n                initializers.serialize(self.moving_range_initializer)\r\n        }\r\n        base_config = super(CustomBatchNormalization, self).get_config()\r\n        return dict(list(base_config.items()) + list(config.items()))\r\n    \r\n    def compute_output_shape(self, input_shape):\r\n        return input_shape\r\n\r\n\r\n\r\n\r\n##Below is the network \r\n\r\ninp = Input(shape=(64,))\r\nbatch_norm_1 = CustomBatchNormalization()(inp)\r\ndensout = Dense(128, activation='linear')(batch_norm_1)\r\ndensout = LeakyReLU(alpha=0.3)(densout)\r\nfor i in range (6):\r\n    batch_norm_i = CustomBatchNormalization()(densout)\r\n    densout = Dense(128, activation='linear')(batch_norm_i)\r\n    densout = LeakyReLU(alpha=0.3)(densout)\r\nbatch_norm_out = CustomBatchNormalization()(densout)\r\nout = Dense(64, activation='linear')(batch_norm_out)\r\nInp_RH_CBN = tf.keras.models.Model(inp, out)\r\n```\r\n**Other info / logs** Include any logs or source code that would be helpful to\r\ndiagnose the problem. If including tracebacks, please include the full\r\ntraceback. Large logs and files should be attached.\r\n\r\n\r\nHere is the full log error\r\n```\r\nOperatorNotAllowedInGraphError            Traceback (most recent call last)\r\n~/miniconda3/envs/CbrainCustomLayer/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/base_layer.py in __call__(self, inputs, *args, **kwargs)\r\n    841                   with auto_control_deps.AutomaticControlDependencies() as acd:\r\n--> 842                     outputs = call_fn(cast_inputs, *args, **kwargs)\r\n    843                     # Wrap Tensors in `outputs` in `tf.identity` to avoid\r\n\r\n~/miniconda3/envs/CbrainCustomLayer/lib/python3.6/site-packages/tensorflow_core/python/autograph/impl/api.py in wrapper(*args, **kwargs)\r\n    236         if hasattr(e, 'ag_error_metadata'):\r\n--> 237           raise e.ag_error_metadata.to_exception(e)\r\n    238         else:\r\n\r\nOperatorNotAllowedInGraphError: in converted code:\r\n\r\n    <ipython-input-26-3ff47d389914>:43 call\r\n        if not training:\r\n    /home/ankitesh/miniconda3/envs/CbrainCustomLayer/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py:765 __bool__\r\n        self._disallow_bool_casting()\r\n    /home/ankitesh/miniconda3/envs/CbrainCustomLayer/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py:534 _disallow_bool_casting\r\n        self._disallow_in_graph_mode(\"using a `tf.Tensor` as a Python `bool`\")\r\n    /home/ankitesh/miniconda3/envs/CbrainCustomLayer/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py:523 _disallow_in_graph_mode\r\n        \" this function with @tf.function.\".format(task))\r\n\r\n    OperatorNotAllowedInGraphError: using a `tf.Tensor` as a Python `bool` is not allowed in Graph execution. Use Eager execution or decorate this function with @tf.function.\r\n\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-27-3d2d9055924b> in <module>\r\n      1 inp = Input(shape=(64,))\r\n----> 2 batch_norm_1 = CustomBatchNormalization()(inp)\r\n      3 densout = Dense(128, activation='linear')(batch_norm_1)\r\n      4 densout = LeakyReLU(alpha=0.3)(densout)\r\n      5 for i in range (6):\r\n\r\n~/miniconda3/envs/CbrainCustomLayer/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/base_layer.py in __call__(self, inputs, *args, **kwargs)\r\n    852                               'dynamic. Pass `dynamic=True` to the class '\r\n    853                               'constructor.\\nEncountered error:\\n\"\"\"\\n' +\r\n--> 854                               str(e) + '\\n\"\"\"')\r\n    855           else:\r\n    856             # We will use static shape inference to return symbolic tensors\r\n\r\nTypeError: You are attempting to use Python control flow in a layer that was not declared to be dynamic. Pass `dynamic=True` to the class constructor.\r\nEncountered error:\r\n\"\"\"\r\nin converted code:\r\n\r\n    <ipython-input-26-3ff47d389914>:43 call\r\n        if not training:\r\n    /home/ankitesh/miniconda3/envs/CbrainCustomLayer/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py:765 __bool__\r\n        self._disallow_bool_casting()\r\n    /home/ankitesh/miniconda3/envs/CbrainCustomLayer/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py:534 _disallow_bool_casting\r\n        self._disallow_in_graph_mode(\"using a `tf.Tensor` as a Python `bool`\")\r\n    /home/ankitesh/miniconda3/envs/CbrainCustomLayer/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py:523 _disallow_in_graph_mode\r\n        \" this function with @tf.function.\".format(task))\r\n\r\n    OperatorNotAllowedInGraphError: using a `tf.Tensor` as a Python `bool` is not allowed in Graph execution. Use Eager execution or decorate this function with @tf.function.\r\n```\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36846", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36846/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36846/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36846/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36846", "id": 566627964, "node_id": "MDU6SXNzdWU1NjY2Mjc5NjQ=", "number": 36846, "title": "There aren't enough elements in this dataset for each shard to have at least one element (# elems = 1, # shards = 2)", "user": {"login": "ianferreira", "id": 165107, "node_id": "MDQ6VXNlcjE2NTEwNw==", "avatar_url": "https://avatars3.githubusercontent.com/u/165107?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ianferreira", "html_url": "https://github.com/ianferreira", "followers_url": "https://api.github.com/users/ianferreira/followers", "following_url": "https://api.github.com/users/ianferreira/following{/other_user}", "gists_url": "https://api.github.com/users/ianferreira/gists{/gist_id}", "starred_url": "https://api.github.com/users/ianferreira/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ianferreira/subscriptions", "organizations_url": "https://api.github.com/users/ianferreira/orgs", "repos_url": "https://api.github.com/users/ianferreira/repos", "events_url": "https://api.github.com/users/ianferreira/events{/privacy}", "received_events_url": "https://api.github.com/users/ianferreira/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2020-02-18T03:48:35Z", "updated_at": "2020-03-18T15:36:02Z", "closed_at": null, "author_association": "NONE", "body": "**Environment**\r\nPython 3.7.3 (default, Dec 20 2019, 18:57:59)\r\n[GCC 8.3.0] on linux\r\ntensorflow(cpu) 2.1.0\r\ntensorflow_datasets 2.0.0\r\nDescription:    Raspbian GNU/Linux 10 (buster)\r\n\r\n**Using code the example from**\r\nhttps://www.tensorflow.org/tutorials/distribute/multi_worker_with_keras\r\n\r\n**TFConfig below**\r\n\r\n`\r\n{'cluster': {'worker': ['RpiCluster1:2222', 'RpiCluster2:2222']}, 'task': {'type': 'worker', 'index': 0}}\r\n{'cluster': {'worker': ['RpiCluster1:2222', 'RpiCluster2:2222']}, 'task': {'type': 'worker', 'index': 1}}\r\n`\r\n\r\n**Error below seems to suggest sharding is not working**\r\n2020-02-18 03:41:12.788327: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:300] Initialize GrpcChannelCache for job worker -> {0 -> RpiCluster1:2222, 1 -> localhost:2222}\r\n2020-02-18 03:41:12.789117: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:390] Started server with target: grpc://localhost:2222\r\n2020-02-18 03:41:21.023441: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:300] Initialize GrpcChannelCache for job worker -> {0 -> localhost:2222, 1 -> RpiCluster2:2222}\r\n2020-02-18 03:41:21.024802: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:390] Started server with target: grpc://localhost:2222\r\nWARNING:tensorflow:`eval_fn` is not passed in. The `worker_fn` will be used if an \"evaluator\" task exists in the cluster.\r\nWARNING:tensorflow:`eval_fn` is not passed in. The `worker_fn` will be used if an \"evaluator\" task exists in the cluster.\r\nWARNING:tensorflow:`eval_strategy` is not passed in. No distribution strategy will be used for evaluation.\r\nWARNING:tensorflow:`eval_strategy` is not passed in. No distribution strategy will be used for evaluation.\r\nWARNING:tensorflow:`eval_fn` is not passed in. The `worker_fn` will be used if an \"evaluator\" task exists in the cluster.\r\nWARNING:tensorflow:`eval_fn` is not passed in. The `worker_fn` will be used if an \"evaluator\" task exists in the cluster.\r\nWARNING:tensorflow:`eval_strategy` is not passed in. No distribution strategy will be used for evaluation.\r\nWARNING:tensorflow:`eval_strategy` is not passed in. No distribution strategy will be used for evaluation.\r\n2020-02-18 03:41:34.450011: W tensorflow/core/common_runtime/base_collective_executor.cc:217] BaseCollectiveExecutor::StartAbort Out of range: End of sequence\r\n         [[{{node IteratorGetNext}}]]\r\nWARNING:tensorflow:Your input ran out of data; interrupting training. Make sure that your dataset or generator can generate at least `steps_per_epoch * epochs` batches (in this case, 15 batches). You may need to use the repeat() function when building your dataset.\r\nWARNING:tensorflow:Your input ran out of data; interrupting training. Make sure that your dataset or generator can generate at least `steps_per_epoch * epochs` batches (in this case, 15 batches). You may need to use the repeat() function when building your dataset.\r\n2020-02-18 03:41:35.775198: W tensorflow/core/common_runtime/base_collective_executor.cc:217] BaseCollectiveExecutor::StartAbort Invalid argument: There aren't enough elements in this dataset for each shard to have at least one element (# elems = 1, # shards = 2). If you are using datasets with distribution strategy, considering setting the auto sharding policy to either DATA or OFF using the `experimental_distribute.auto_shard_policy` optionof `tf.data.Options()`.\r\n         [[{{node MultiDeviceIteratorGetNextFromShard}}]]\r\n         [[RemoteCall]]\r\n         [[IteratorGetNext]]\r\n2020-02-18 03:41:35.795862: I tensorflow/core/profiler/lib/profiler_session.cc:225] Profiler session started.\r\nFound Cluster spec  {'worker': ['RpiCluster1:2222', 'RpiCluster2:2222']}\r\nFound TFConfig {'cluster': {'worker': ['RpiCluster1:2222', 'RpiCluster2:2222']}, 'task': {'type': 'worker', 'index': 0}}\r\nCreated strategy  <tensorflow.python.distribute.collective_all_reduce_strategy.CollectiveAllReduceStrategy object at 0x66fb7e70>\r\nNumber of workers  2\r\nCreating datasets inside scope...\r\nCreating model inside scope...\r\nStarting to fit model....\r\nTrain for 5 steps\r\nEpoch 1/3\r\n2020-02-18 03:41:36.589112: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\r\nWARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nIf using Keras pass *_constraint arguments to layers.\r\nWARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nIf using Keras pass *_constraint arguments to layers.\r\n2020-02-18 03:41:39.502892: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\r\n2020-02-18 03:41:39.615315: E tensorflow/core/common_runtime/ring_alg.cc:279] Aborting RingReduce with Cancelled: RPC Request was cancelled\r\n2020-02-18 03:41:39.615446: W tensorflow/core/common_runtime/base_collective_executor.cc:217] BaseCollectiveExecutor::StartAbort Cancelled: RPC Request was cancelled\r\n2020-02-18 03:41:39.615763: W tensorflow/core/framework/op_kernel.cc:1655] OP_REQUIRES failed at collective_ops.cc:253 : Cancelled: RPC Request was cancelled\r\n2020-02-18 03:41:39.615850: W tensorflow/core/common_runtime/base_collective_executor.cc:217] BaseCollectiveExecutor::StartAbort Cancelled: RPC Request was cancelled\r\n         [[{{node CollectiveReduce}}]]\r\nFound Cluster spec  {'worker': ['RpiCluster1:2222', 'RpiCluster2:2222']}\r\nFound TFConfig {'cluster': {'worker': ['RpiCluster1:2222', 'RpiCluster2:2222']}, 'task': {'type': 'worker', 'index': 1}}\r\nCreated strategy  <tensorflow.python.distribute.collective_all_reduce_strategy.CollectiveAllReduceStrategy object at 0x670a3c10>\r\nNumber of workers  2\r\nCreating datasets inside scope...\r\nCreating model inside scope...\r\nStarting to fit model....\r\nTrain for 5 steps\r\nEpoch 1/3\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 753, in on_start\r\n    yield\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 397, in fit\r\n    prefix='val_')\r\n  File \"/usr/lib/python3.7/contextlib.py\", line 130, in __exit__\r\n    self.gen.throw(type, value, traceback)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 771, in on_epoch\r\n    self.callbacks.on_epoch_end(epoch, epoch_logs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/callbacks.py\", line 302, in on_epoch_end\r\n    callback.on_epoch_end(epoch, logs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/callbacks.py\", line 990, in on_epoch_end\r\n    self._save_model(epoch=epoch, logs=logs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/callbacks.py\", line 1040, in _save_model\r\n    self.model.save(filepath, overwrite=True)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/engine/network.py\", line 1008, in save\r\n    signatures, options)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/saving/save.py\", line 115, in save_model\r\n    signatures, options)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/saving/saved_model/save.py\", line 78, in save\r\n    save_lib.save(model, filepath, signatures, options)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/saved_model/save.py\", line 916, in save\r\n    object_saver.save(utils_impl.get_variables_path(export_dir))\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/training/tracking/util.py\", line 1168, in save\r\n    file_prefix=file_prefix_tensor, object_graph_tensor=object_graph_tensor)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/training/tracking/util.py\", line 1116, in _save_cached_when_graph_building\r\n    save_op = saver.save(file_prefix)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/training/saving/functional_saver.py\", line 230, in save\r\n    sharded_saves.append(saver.save(shard_prefix))\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/training/saving/functional_saver.py\", line 69, in save\r\n    tensors.append(spec.tensor)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/training/saving/saveable_object.py\", line 52, in tensor\r\n    return self._tensor() if callable(self._tensor) else self._tensor\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/values.py\", line 1252, in tensor\r\n    return strategy.extended.read_var(sync_on_read_variable)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/mirrored_strategy.py\", line 769, in read_var\r\n    return replica_local_var._get_cross_replica()  # pylint: disable=protected-access\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/values.py\", line 1347, in _get_cross_replica\r\n    self, axis=None)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/distribute_lib.py\", line 808, in reduce\r\n    return self._extended._reduce(reduce_op, value)  # pylint: disable=protected-access\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/distribute_lib.py\", line 1449, in _reduce\r\n    device_util.current() or \"/device:CPU:0\"))[0]\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/collective_all_reduce_strategy.py\", line 528, in _reduce_to\r\n    reduce_op, value, destinations=destinations)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/cross_device_ops.py\", line 282, in reduce\r\n    destinations)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/cross_device_ops.py\", line 1038, in reduce_implementation\r\n    all_reduced = self._batch_all_reduce(reduce_op, [per_replica_value])[0]\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/cross_device_ops.py\", line 1118, in _batch_all_reduce\r\n    dense_results = self._do_batch_all_reduce_dense(reduce_op, dense_values)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/cross_device_ops.py\", line 1160, in _do_batch_all_reduce_dense\r\n    \"Id\", communication_hint)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/cross_device_utils.py\", line 368, in build_collective_reduce\r\n    return collective_all_reduce()\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/eager/def_function.py\", line 568, in __call__\r\n    result = self._call(*args, **kwds)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/eager/def_function.py\", line 638, in _call\r\n    return self._concrete_stateful_fn._filtered_call(canon_args, canon_kwds)  # pylint: disable=protected-access\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/eager/function.py\", line 1611, in _filtered_call\r\n    self.captured_inputs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/eager/function.py\", line 1692, in _call_flat\r\n    ctx, args, cancellation_manager=cancellation_manager))\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/eager/function.py\", line 545, in call\r\n    ctx=ctx)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/eager/execute.py\", line 67, in quick_execute\r\n    six.raise_from(core._status_to_exception(e.code, message), None)\r\n  File \"<string>\", line 3, in raise_from\r\ntensorflow.python.framework.errors_impl.CancelledError:  RPC Request was cancelled\r\n         [[node CollectiveReduce (defined at /usr/lib/python3.7/contextlib.py:130) ]] [Op:__inference_collective_all_reduce_1457]\r\n\r\nFunction call stack:\r\ncollective_all_reduce\r\n\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"main_2.py\", line 98, in <module>\r\n    multi_worker_model.fit(x=train_datasets, epochs=3, steps_per_epoch=5, callbacks = callbacks)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/engine/training.py\", line 819, in fit\r\n    use_multiprocessing=use_multiprocessing)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/engine/training_distributed.py\", line 790, in fit\r\n    *args, **kwargs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/engine/training_distributed.py\", line 777, in wrapper\r\n    mode=dc.CoordinatorMode.INDEPENDENT_WORKER)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/distribute_coordinator.py\", line 853, in run_distribute_coordinator\r\n    task_id, session_config, rpc_layer)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/distribute_coordinator.py\", line 360, in _run_single_worker\r\n    return worker_fn(strategy)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/engine/training_distributed.py\", line 772, in _worker_fn\r\n    return method(model, **kwargs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 397, in fit\r\n    prefix='val_')\r\n  File \"/usr/lib/python3.7/contextlib.py\", line 130, in __exit__\r\n    self.gen.throw(type, value, traceback)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 757, in on_start\r\n    self.callbacks._call_end_hook(mode)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/callbacks.py\", line 262, in _call_end_hook\r\n    self.on_train_end()\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/callbacks.py\", line 379, in on_train_end\r\n    callback.on_train_end(logs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/callbacks.py\", line 966, in on_train_end\r\n    self._training_state.delete_backup()\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/distribute/multi_worker_training_state.py\", line 173, in delete_backup\r\n    tracking.AutoTrackable.__delattr__(self._model, CKPT_SAVED_EPOCH)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/training/tracking/tracking.py\", line 94, in __delattr__\r\n    super(AutoTrackable, self).__delattr__(name)\r\nAttributeError: _ckpt_saved_epoch\r\nWARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nIf using Keras pass *_constraint arguments to layers.\r\nWARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nIf using Keras pass *_constraint arguments to layers.\r\n2020-02-18 03:41:41.376299: W tensorflow/core/common_runtime/eager/context.cc:349] Unable to destroy server_ object, so releasing instead. Servers don't support clean shutdown.\r\nsrun: error: RpiCluster2: task 1: Exited with exit code 1\r\n2020-02-18 03:41:45.023032: E tensorflow/core/common_runtime/ring_alg.cc:279] Aborting RingReduce with Invalid argument: [_Derived_]There aren't enough elements in this dataset for each shard to have at least one element (# elems = 1, # shards = 2). If you are using datasets with distribution strategy, considering setting the auto sharding policy to either DATA or OFF using the `experimental_distribute.auto_shard_policy` optionof `tf.data.Options()`.\r\n         [[{{node MultiDeviceIteratorGetNextFromShard}}]]\r\n         [[RemoteCall]]\r\n         [[IteratorGetNext]]\r\n2020-02-18 03:41:45.023246: W tensorflow/core/common_runtime/base_collective_executor.cc:217] BaseCollectiveExecutor::StartAbort Invalid argument: [_Derived_]There aren't enough elements in this dataset for each shard to have at least one element (# elems = 1, # shards = 2). If you are using datasets with distribution strategy, considering setting the auto sharding policy to either DATA or OFF using the `experimental_distribute.auto_shard_policy` optionof `tf.data.Options()`.\r\n         [[{{node MultiDeviceIteratorGetNextFromShard}}]]\r\n         [[RemoteCall]]\r\n         [[IteratorGetNext]]\r\n2020-02-18 03:41:45.023715: W tensorflow/core/framework/op_kernel.cc:1655] OP_REQUIRES failed at collective_ops.cc:253 : Invalid argument: [_Derived_]There aren't enough elements in this dataset for each shard to have at least one element (# elems = 1, # shards = 2). If you are using datasets with distribution strategy, considering setting the auto sharding policy to either DATA or OFF using the `experimental_distribute.auto_shard_policy` optionof `tf.data.Options()`.\r\n         [[{{node MultiDeviceIteratorGetNextFromShard}}]]\r\n         [[RemoteCall]]\r\n         [[IteratorGetNext]]\r\n2020-02-18 03:41:45.024006: W tensorflow/core/common_runtime/base_collective_executor.cc:217] BaseCollectiveExecutor::StartAbort Invalid argument: [_Derived_]There aren't enough elements in this dataset for each shard to have at least one element (# elems = 1, # shards = 2). If you are using datasets with distribution strategy, considering setting the auto sharding policy to either DATA or OFF using the `experimental_distribute.auto_shard_policy` optionof `tf.data.Options()`.\r\n         [[{{node MultiDeviceIteratorGetNextFromShard}}]]\r\n         [[RemoteCall]]\r\n         [[IteratorGetNext]]\r\n         [[CollectiveReduce]]\r\nTraceback (most recent call last):\r\n  File \"main_2.py\", line 98, in <module>\r\n    multi_worker_model.fit(x=train_datasets, epochs=3, steps_per_epoch=5, callbacks = callbacks)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/engine/training.py\", line 819, in fit\r\n    use_multiprocessing=use_multiprocessing)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/engine/training_distributed.py\", line 790, in fit\r\n    *args, **kwargs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/engine/training_distributed.py\", line 777, in wrapper\r\n    mode=dc.CoordinatorMode.INDEPENDENT_WORKER)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/distribute_coordinator.py\", line 853, in run_distribute_coordinator\r\n    task_id, session_config, rpc_layer)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/distribute_coordinator.py\", line 360, in _run_single_worker\r\n    return worker_fn(strategy)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/engine/training_distributed.py\", line 772, in _worker_fn\r\n    return method(model, **kwargs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 397, in fit\r\n    prefix='val_')\r\n  File \"/usr/lib/python3.7/contextlib.py\", line 130, in __exit__\r\n    self.gen.throw(type, value, traceback)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 771, in on_epoch\r\n    self.callbacks.on_epoch_end(epoch, epoch_logs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/callbacks.py\", line 302, in on_epoch_end\r\n    callback.on_epoch_end(epoch, logs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/callbacks.py\", line 990, in on_epoch_end\r\n    self._save_model(epoch=epoch, logs=logs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/callbacks.py\", line 1040, in _save_model\r\n    self.model.save(filepath, overwrite=True)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/engine/network.py\", line 1008, in save\r\n    signatures, options)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/saving/save.py\", line 115, in save_model\r\n    signatures, options)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/keras/saving/saved_model/save.py\", line 78, in save\r\n    save_lib.save(model, filepath, signatures, options)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/saved_model/save.py\", line 916, in save\r\n    object_saver.save(utils_impl.get_variables_path(export_dir))\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/training/tracking/util.py\", line 1168, in save\r\n    file_prefix=file_prefix_tensor, object_graph_tensor=object_graph_tensor)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/training/tracking/util.py\", line 1116, in _save_cached_when_graph_building\r\n    save_op = saver.save(file_prefix)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/training/saving/functional_saver.py\", line 230, in save\r\n    sharded_saves.append(saver.save(shard_prefix))\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/training/saving/functional_saver.py\", line 69, in save\r\n    tensors.append(spec.tensor)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/training/saving/saveable_object.py\", line 52, in tensor\r\n    return self._tensor() if callable(self._tensor) else self._tensor\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/values.py\", line 1252, in tensor\r\n    return strategy.extended.read_var(sync_on_read_variable)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/mirrored_strategy.py\", line 769, in read_var\r\n    return replica_local_var._get_cross_replica()  # pylint: disable=protected-access\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/values.py\", line 1347, in _get_cross_replica\r\n    self, axis=None)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/distribute_lib.py\", line 808, in reduce\r\n    return self._extended._reduce(reduce_op, value)  # pylint: disable=protected-access\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/distribute_lib.py\", line 1449, in _reduce\r\n    device_util.current() or \"/device:CPU:0\"))[0]\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/collective_all_reduce_strategy.py\", line 528, in _reduce_to\r\n    reduce_op, value, destinations=destinations)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/cross_device_ops.py\", line 282, in reduce\r\n    destinations)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/cross_device_ops.py\", line 1038, in reduce_implementation\r\n    all_reduced = self._batch_all_reduce(reduce_op, [per_replica_value])[0]\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/cross_device_ops.py\", line 1118, in _batch_all_reduce\r\n    dense_results = self._do_batch_all_reduce_dense(reduce_op, dense_values)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/cross_device_ops.py\", line 1160, in _do_batch_all_reduce_dense\r\n    \"Id\", communication_hint)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/distribute/cross_device_utils.py\", line 368, in build_collective_reduce\r\n    return collective_all_reduce()\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/eager/def_function.py\", line 568, in __call__\r\n    result = self._call(*args, **kwds)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/eager/def_function.py\", line 638, in _call\r\n    return self._concrete_stateful_fn._filtered_call(canon_args, canon_kwds)  # pylint: disable=protected-access\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/eager/function.py\", line 1611, in _filtered_call\r\n    self.captured_inputs)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/eager/function.py\", line 1692, in _call_flat\r\n    ctx, args, cancellation_manager=cancellation_manager))\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/eager/function.py\", line 545, in call\r\n    ctx=ctx)\r\n  File \"/usr/local/lib/python3.7/dist-packages/tensorflow_core/python/eager/execute.py\", line 67, in quick_execute\r\n    six.raise_from(core._status_to_exception(e.code, message), None)\r\n  File \"<string>\", line 3, in raise_from\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError:  [_Derived_]There aren't enough elements in this dataset for each shard to have at least one element (# elems = 1, # shards = 2). If you are using datasets with distribution strategy, considering setting the auto sharding policy to either DATA or OFF using the `experimental_distribute.auto_shard_policy` optionof `tf.data.Options()`.\r\n         [[{{node MultiDeviceIteratorGetNextFromShard}}]]\r\n         [[RemoteCall]]\r\n         [[IteratorGetNext]]\r\n         [[CollectiveReduce]] [Op:__inference_collective_all_reduce_1477]\r\n\r\nFunction call stack:\r\ncollective_all_reduce\r\n\r\n2020-02-18 03:41:47.749541: W tensorflow/core/common_runtime/eager/context.cc:349] Unable to destroy server_ object, so releasing instead. Servers don't support clean shutdown.\r\n1/5 [=====>........................] - ETA: 22ssrun: error: RpiCluster1: task 0: Exited with exit code 1\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36841", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36841/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36841/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36841/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36841", "id": 566563549, "node_id": "MDU6SXNzdWU1NjY1NjM1NDk=", "number": 36841, "title": "DockerHub tag 2.1.0-py3 includes GPU support", "user": {"login": "deliahu", "id": 808475, "node_id": "MDQ6VXNlcjgwODQ3NQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/808475?v=4", "gravatar_id": "", "url": "https://api.github.com/users/deliahu", "html_url": "https://github.com/deliahu", "followers_url": "https://api.github.com/users/deliahu/followers", "following_url": "https://api.github.com/users/deliahu/following{/other_user}", "gists_url": "https://api.github.com/users/deliahu/gists{/gist_id}", "starred_url": "https://api.github.com/users/deliahu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/deliahu/subscriptions", "organizations_url": "https://api.github.com/users/deliahu/orgs", "repos_url": "https://api.github.com/users/deliahu/repos", "events_url": "https://api.github.com/users/deliahu/events{/privacy}", "received_events_url": "https://api.github.com/users/deliahu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-02-17T23:31:10Z", "updated_at": "2020-02-29T01:17:02Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n\r\nDockerHub: [tensorflow/tensorflow:2.1.0-py3](https://hub.docker.com/layers/tensorflow/tensorflow/2.1.0-py3/images/sha256-14ec674cefd622aa9d45f07485500da254acaf8adfef80bd0f279db03c735689?context=explore)\r\n\r\n**Describe the problem**\r\n\r\nThis Docker image seems to have the pip `tensorflow` package installed, rather than the `tensorflow-cpu` package. As of version 2.1.0, the `tensorflow` package includes GPU support (see the first bullet point in the [changelog](https://github.com/tensorflow/tensorflow/releases/tag/v2.1.0)).\r\n\r\nSince [tensorflow/tensorflow:2.1.0-gpu-py3](https://hub.docker.com/layers/tensorflow/tensorflow/2.1.0-gpu-py3/images/sha256-1010e051dde4a9b62532a80f4a9a619013eafc78491542d5ef5da796cc2697ae?context=explore) is also provided, it seems to me like [tensorflow/tensorflow:2.1.0-py3](https://hub.docker.com/layers/tensorflow/tensorflow/2.1.0-py3/images/sha256-14ec674cefd622aa9d45f07485500da254acaf8adfef80bd0f279db03c735689?context=explore) should not include GPU support. If you believe that it should, would it be possible to publish e.g. tensorflow/tensorflow:2.1.0-cpu-py3 to DockerHub?\r\n\r\n**Additional context**\r\n\r\nThe reason I noticed this is because I started seeing these warnings when running on CPU: \r\n\r\n```\r\nW tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory\r\nW tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory\r\nW tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.\r\n```\r\n\r\nIn addition to removing these warnings, having a cpu-only version would reduce the image size."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36839", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36839/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36839/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36839/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36839", "id": 566544663, "node_id": "MDExOlB1bGxSZXF1ZXN0Mzc2MzM2NjYw", "number": 36839, "title": "Add step argument to SummaryWriter.(set_)as_default.", "user": {"login": "foxik", "id": 560016, "node_id": "MDQ6VXNlcjU2MDAxNg==", "avatar_url": "https://avatars0.githubusercontent.com/u/560016?v=4", "gravatar_id": "", "url": "https://api.github.com/users/foxik", "html_url": "https://github.com/foxik", "followers_url": "https://api.github.com/users/foxik/followers", "following_url": "https://api.github.com/users/foxik/following{/other_user}", "gists_url": "https://api.github.com/users/foxik/gists{/gist_id}", "starred_url": "https://api.github.com/users/foxik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/foxik/subscriptions", "organizations_url": "https://api.github.com/users/foxik/orgs", "repos_url": "https://api.github.com/users/foxik/repos", "events_url": "https://api.github.com/users/foxik/events{/privacy}", "received_events_url": "https://api.github.com/users/foxik/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 1178505529, "node_id": "MDU6TGFiZWwxMTc4NTA1NTI5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/prtype:bugfix", "name": "prtype:bugfix", "color": "159b2e", "default": false, "description": "PR to fix a bug"}, {"id": 987666414, "node_id": "MDU6TGFiZWw5ODc2NjY0MTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/ready%20to%20pull", "name": "ready to pull", "color": "2cd643", "default": false, "description": ""}, {"id": 1169365494, "node_id": "MDU6TGFiZWwxMTY5MzY1NDk0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:M", "name": "size:M", "color": "adafea", "default": false, "description": "CL Change Size: Medium"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-17T22:32:52Z", "updated_at": "2020-03-12T05:22:35Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36839", "html_url": "https://github.com/tensorflow/tensorflow/pull/36839", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36839.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36839.patch"}, "body": "As a followup to #26406, here is a simple proposed solution which adds `step` argument to `SummaryWriter.as_default` and `SummaryWriter.set_as_default`. The default value is `None` which means the argument is ignored, so the change is backward compatible.\r\n\r\nThe current code is extremely simple, yet useful. Given lack of response in #26406, I submitted this PR, but I am happy to update it (or scrap it) if a different consensus is reached. For reasons to this change, see #26406.\r\n\r\nBTW, the `get_step` and `set_step` methods could be used inside the implementation instead of manual manipulation with `_summary_state`."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36838", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36838/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36838/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36838/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36838", "id": 566528079, "node_id": "MDExOlB1bGxSZXF1ZXN0Mzc2MzIzMjM2", "number": 36838, "title": "[ROCm] re-enable the test //tensorflow/python:auto_mixed_precision_test_gpu on ROCm", "user": {"login": "deven-amd", "id": 36858332, "node_id": "MDQ6VXNlcjM2ODU4MzMy", "avatar_url": "https://avatars2.githubusercontent.com/u/36858332?v=4", "gravatar_id": "", "url": "https://api.github.com/users/deven-amd", "html_url": "https://github.com/deven-amd", "followers_url": "https://api.github.com/users/deven-amd/followers", "following_url": "https://api.github.com/users/deven-amd/following{/other_user}", "gists_url": "https://api.github.com/users/deven-amd/gists{/gist_id}", "starred_url": "https://api.github.com/users/deven-amd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/deven-amd/subscriptions", "organizations_url": "https://api.github.com/users/deven-amd/orgs", "repos_url": "https://api.github.com/users/deven-amd/repos", "events_url": "https://api.github.com/users/deven-amd/events{/privacy}", "received_events_url": "https://api.github.com/users/deven-amd/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-02-17T21:38:30Z", "updated_at": "2020-03-13T11:59:56Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36838", "html_url": "https://github.com/tensorflow/tensorflow/pull/36838", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36838.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36838.patch"}, "body": "This PR is to re-enable the AMP unit test on the ROCm platform.\r\n\r\n------------------------------\r\n\r\n/cc @whchung @chsigg @nvining-work "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36837", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36837/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36837/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36837/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36837", "id": 566494224, "node_id": "MDU6SXNzdWU1NjY0OTQyMjQ=", "number": 36837, "title": "Tensorflow Lite Build Problem - Specialization for Eigen::internal::scalar_logistic_op<float> Removed", "user": {"login": "dtsmith2001", "id": 3189861, "node_id": "MDQ6VXNlcjMxODk4NjE=", "avatar_url": "https://avatars1.githubusercontent.com/u/3189861?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dtsmith2001", "html_url": "https://github.com/dtsmith2001", "followers_url": "https://api.github.com/users/dtsmith2001/followers", "following_url": "https://api.github.com/users/dtsmith2001/following{/other_user}", "gists_url": "https://api.github.com/users/dtsmith2001/gists{/gist_id}", "starred_url": "https://api.github.com/users/dtsmith2001/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dtsmith2001/subscriptions", "organizations_url": "https://api.github.com/users/dtsmith2001/orgs", "repos_url": "https://api.github.com/users/dtsmith2001/repos", "events_url": "https://api.github.com/users/dtsmith2001/events{/privacy}", "received_events_url": "https://api.github.com/users/dtsmith2001/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1194756584, "node_id": "MDU6TGFiZWwxMTk0NzU2NTg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20raspberry%20pi", "name": "subtype: raspberry pi", "color": "b619ea", "default": false, "description": "Raspberry Pi Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-02-17T20:03:03Z", "updated_at": "2020-02-25T14:13:34Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Lunux Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): source, branch r2.1\r\n- TensorFlow version: 2.1.0\r\n- Python version: 3.6\r\n- Installed using virtualenv? pip? conda?: No\r\n- Bazel version (if compiling from source): ./tensorflow/tools/ci_build/install/install_bazel.sh\r\n- GCC/Compiler version (if compiling from source): arm-linux-gnueabihf-gcc (Ubuntu/Linaro 7.4.0-1ubuntu1~18.04.1) 7.4.0\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\n\r\n\r\n**Describe the problem**\r\n\r\nCross-compiling Tensorflow Lite for Raspberry PI following published instructions.\r\n\r\nMultiple failures to find `Eigen::internal::scalar_logistic_op`:\r\n\r\n```In file included from tensorflow/lite/kernels/activations.cc:28:0:\r\n./tensorflow/lite/kernels/internal/optimized/optimized_ops.h: In function 'void tflite::optimized_ops::LstmCell(const tflite::LstmCellParams&, const tflite::RuntimeShape&, const float*, const tflite::RuntimeShape&, const float*, const tflite::RuntimeShape&, const float*, const tflite::RuntimeShape&, const float*, const tflite::RuntimeShape&, const float*, const tflite::RuntimeShape&, float*, const tflite::RuntimeShape&, float*, const tflite::RuntimeShape&, float*, const tflite::RuntimeShape&, float*, tflite::CpuBackendContext*)':\r\n./tensorflow/lite/kernels/internal/optimized/optimized_ops.h:2938:48: error: 'scalar_logistic_op' is not a member of 'Eigen::internal'\r\n       input_gate_sm.unaryExpr(Eigen::internal::scalar_logistic_op<float>()) *\r\n                                                ^~~~~~~~~~~~~~~~~~\r\n```\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n\r\n```\r\ngit clone git@github.com:tensorflow/tensorflow.git\r\ncd tensorflow && git checkout r2.1\r\n./tensorflow/tools/ci_build/install/install_bazel.sh\r\n./tensorflow/lite/tools/make/download_dependencies.sh\r\n./tensorflow/lite/tools/make/build_rpi_lib.sh\r\n```\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\nEigen has moved to GitLab. The release for 2.1.0 has an error in `download_dependencies.sh` - the BitBucket repository URL is not found since `curl` is called with `-s`. I cloned the repository and found this using `git log`:\r\n\r\n```\r\ncommit 0f288e2ae6d343a978c4d5f6a951e20d7b69d96e\r\nAuthor: Rasmus Munk Larsen <rmlarsen@google.com>\r\nDate:   Mon Dec 2 17:00:58 2019 -0800\r\n\r\n    Revert the specialization for scalar_logistic_op<float> introduced in:\r\n    \r\n    https://bitbucket.org/eigen/eigen/commits/5ce45e1849c9c8352266830f6f8e628f26b99a9a\r\n    \r\n    While providing a 50% speedup on Haswell+ processors, the large relative error outside [-18, 18] in this approximation causes problems, e.g., when computing gradients of activation functions like softplus in neural networks.\r\n```\r\n\r\nI tried other releases of Eigen with the same problem."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36835", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36835/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36835/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36835/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36835", "id": 566485899, "node_id": "MDU6SXNzdWU1NjY0ODU4OTk=", "number": 36835, "title": "graph_transforms not found when running export_tflite_ssd_graph.py to convert ssd model", "user": {"login": "melloelout", "id": 33122799, "node_id": "MDQ6VXNlcjMzMTIyNzk5", "avatar_url": "https://avatars3.githubusercontent.com/u/33122799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/melloelout", "html_url": "https://github.com/melloelout", "followers_url": "https://api.github.com/users/melloelout/followers", "following_url": "https://api.github.com/users/melloelout/following{/other_user}", "gists_url": "https://api.github.com/users/melloelout/gists{/gist_id}", "starred_url": "https://api.github.com/users/melloelout/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/melloelout/subscriptions", "organizations_url": "https://api.github.com/users/melloelout/orgs", "repos_url": "https://api.github.com/users/melloelout/repos", "events_url": "https://api.github.com/users/melloelout/events{/privacy}", "received_events_url": "https://api.github.com/users/melloelout/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-02-17T19:40:39Z", "updated_at": "2020-02-23T21:33:20Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (or github SHA if from source): 2.1.0\r\n\r\n\r\n**Command used to run the converter or code if you\u2019re using the Python API**\r\nFrom issue #31015 I'm trying to run:\r\n\r\npython ../models/research/object_detection/export_tflite_ssd_graph.py --pipeline_config_path pipeline.config --trained_checkpoint_prefix model.ckpt --output_directory my_frozen_graph --add_postprocessing_op True\r\n\r\nThe output is as follows:\r\n\r\nTraceback (most recent call last):\r\n  File \"../models/research/object_detection/export_tflite_ssd_graph.py\", line 96, in <module>\r\n    from object_detection import export_tflite_ssd_graph_lib\r\n  File \"/home/mello/venv36/lib/python3.6/site-packages/object_detection/export_tflite_ssd_graph_lib.py\", line 26, in <module>\r\n    from tensorflow.tools.graph_transforms import TransformGraph\r\nModuleNotFoundError: No module named 'tensorflow.tools.graph_transforms'\r\n\r\nThe section in export_tflite_ssd_graph_lib.py where the error occurs:\r\n\r\nimport tensorflow as tf\r\nfrom tensorflow.core.framework import attr_value_pb2\r\nfrom tensorflow.core.framework import types_pb2\r\nfrom tensorflow.core.protobuf import saver_pb2\r\nfrom tensorflow.tools.graph_transforms import TransformGraph\r\n\r\nI have tried binary install of tensorflow, both on ubuntu and on raspbian buster, have tried it with python 3.7 and 3.6, virtualenv or without.\r\nAlso have tried with tensorflow compiled using bazel.\r\n\r\nRegardless, I alwas get that tensorflow.tools.graph_transforms are missing.\r\n\r\nModel I'm using is ssd_mobilenet_v2_coco_2018_03_29\r\n\r\nI don't believe it has the to do with the model, but probably with the tensorflow install (but not at all sure...)\r\n\r\nThanks for your help!"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36833", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36833/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36833/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36833/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36833", "id": 566480334, "node_id": "MDU6SXNzdWU1NjY0ODAzMzQ=", "number": 36833, "title": "[tf2.1.0] model.save() throws TypeError when using tf.debugging.enable_check_numerics()", "user": {"login": "yufengm", "id": 15642465, "node_id": "MDQ6VXNlcjE1NjQyNDY1", "avatar_url": "https://avatars1.githubusercontent.com/u/15642465?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yufengm", "html_url": "https://github.com/yufengm", "followers_url": "https://api.github.com/users/yufengm/followers", "following_url": "https://api.github.com/users/yufengm/following{/other_user}", "gists_url": "https://api.github.com/users/yufengm/gists{/gist_id}", "starred_url": "https://api.github.com/users/yufengm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yufengm/subscriptions", "organizations_url": "https://api.github.com/users/yufengm/orgs", "repos_url": "https://api.github.com/users/yufengm/repos", "events_url": "https://api.github.com/users/yufengm/events{/privacy}", "received_events_url": "https://api.github.com/users/yufengm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-02-17T19:24:59Z", "updated_at": "2020-02-25T13:18:58Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Redhat 8.1 (in Docker)\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): TF2.1.0\r\n- Python version: 3.6.8\r\n- CUDA/cuDNN version: 10.1\r\n- GPU model and memory: V100, 32GB\r\n\r\n**Describe the current behavior**\r\nwhen using `tf.debugging.enable_check_numerics()`, model.save(...) will throw some TypeError as below:\r\n```\r\nTypeError: Input 'resource' of 'AssignVariableOp' Op has type float32 that does not match expected type of resource.\r\n```\r\n\r\n**Code to reproduce the issue** \r\n```python\r\nimport tensorflow as tf\r\ntf.debugging.enable_check_numerics()\r\n\r\ndef build_and_compile_model():\r\n    \r\n    input = tf.keras.Input((20,))\r\n    y = tf.keras.layers.Dense(2)\r\n    model = tf.keras.Model(inputs=input, outputs=y)\r\n    \r\n    model.compile(\r\n        loss=tf.keras.losses.sparse_categorical_crossentropy,\r\n        optimizer=tf.keras.optimizers.SGD(learning_rate=0.001),\r\n        metrics=['accuracy'])\r\n    \r\n    return model\r\n\r\nmodel = build_and_compile_model()\r\nmodel.save('test', save_format='tf')\r\n```\r\n\r\n**Other info / logs** \r\nTraceback logs as follows:\r\n```\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n/tmp/site-packages/tensorflow_core/python/framework/op_def_library.py in _apply_op_helper(op_type_name, name, **keywords)\r\n    467               as_ref=input_arg.is_ref,\r\n--> 468               preferred_dtype=default_dtype)\r\n    469         except TypeError as err:\r\n\r\n/tmp/site-packages/tensorflow_core/python/framework/ops.py in convert_to_tensor(value, dtype, name, as_ref, preferred_dtype, dtype_hint, ctx, accepted_result_types)\r\n   1289           \"Tensor conversion requested dtype %s for Tensor with dtype %s: %r\" %\r\n-> 1290           (dtype.name, value.dtype.name, value))\r\n   1291     return value\r\n\r\nValueError: Tensor conversion requested dtype resource for Tensor with dtype float32: <tf.Tensor 'dense/kernel/Read/ReadVariableOp:0' shape=(20, 2) dtype=float32>\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-3-597a577ec9b0> in <module>()\r\n      3 model = build_and_compile_model()\r\n      4 \r\n----> 5 model.save('test', save_format='tf')\r\n\r\n/tmp/site-packages/tensorflow_core/python/keras/engine/network.py in save(self, filepath, overwrite, include_optimizer, save_format, signatures, options)\r\n   1006     \"\"\"\r\n   1007     save.save_model(self, filepath, overwrite, include_optimizer, save_format,\r\n-> 1008                     signatures, options)\r\n   1009 \r\n   1010   def save_weights(self, filepath, overwrite=True, save_format=None):\r\n\r\n/tmp/site-packages/tensorflow_core/python/keras/saving/save.py in save_model(model, filepath, overwrite, include_optimizer, save_format, signatures, options)\r\n    113   else:\r\n    114     saved_model_save.save(model, filepath, overwrite, include_optimizer,\r\n--> 115                           signatures, options)\r\n    116 \r\n    117 \r\n\r\n/tmp/site-packages/tensorflow_core/python/keras/saving/saved_model/save.py in save(model, filepath, overwrite, include_optimizer, signatures, options)\r\n     76     # we use the default replica context here.\r\n     77     with distribution_strategy_context._get_default_replica_context():  # pylint: disable=protected-access\r\n---> 78       save_lib.save(model, filepath, signatures, options)\r\n     79 \r\n     80   if not include_optimizer:\r\n\r\n/tmp/site-packages/tensorflow_core/python/saved_model/save.py in save(obj, export_dir, signatures, options)\r\n    907   object_saver = util.TrackableSaver(checkpoint_graph_view)\r\n    908   asset_info, exported_graph = _fill_meta_graph_def(\r\n--> 909       meta_graph_def, saveable_view, signatures, options.namespace_whitelist)\r\n    910   saved_model.saved_model_schema_version = (\r\n    911       constants.SAVED_MODEL_SCHEMA_VERSION)\r\n\r\n/tmp/site-packages/tensorflow_core/python/saved_model/save.py in _fill_meta_graph_def(meta_graph_def, saveable_view, signature_functions, namespace_whitelist)\r\n    588     for concrete_function in saveable_view.concrete_functions:\r\n    589       concrete_function.add_to_graph()\r\n--> 590     saver_def = saver.to_proto()\r\n    591     meta_graph_def.saver_def.CopyFrom(saver_def)\r\n    592   graph_def = exported_graph.as_graph_def(add_shapes=True)\r\n\r\n/tmp/site-packages/tensorflow_core/python/training/saving/functional_saver.py in to_proto(self)\r\n    149         shape=[], dtype=dtypes.string, name=\"saver_filename\")\r\n    150     save_tensor = self._traced_save(filename_tensor)\r\n--> 151     restore_op = self._traced_restore(filename_tensor).op\r\n    152     return saver_pb2.SaverDef(\r\n    153         filename_tensor_name=filename_tensor.name,\r\n\r\n/tmp/site-packages/tensorflow_core/python/eager/def_function.py in __call__(self, *args, **kwds)\r\n    566         xla_context.Exit()\r\n    567     else:\r\n--> 568       result = self._call(*args, **kwds)\r\n    569 \r\n    570     if tracing_count == self._get_tracing_count():\r\n\r\n/tmp/site-packages/tensorflow_core/python/eager/def_function.py in _call(self, *args, **kwds)\r\n    613       # This is the first call of __call__, so we have to initialize.\r\n    614       initializers = []\r\n--> 615       self._initialize(args, kwds, add_initializers_to=initializers)\r\n    616     finally:\r\n    617       # At this point we know that the initialization is complete (or less\r\n\r\n/tmp/site-packages/tensorflow_core/python/eager/def_function.py in _initialize(self, args, kwds, add_initializers_to)\r\n    495     self._concrete_stateful_fn = (\r\n    496         self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access\r\n--> 497             *args, **kwds))\r\n    498 \r\n    499     def invalid_creator_scope(*unused_args, **unused_kwds):\r\n\r\n/tmp/site-packages/tensorflow_core/python/eager/function.py in _get_concrete_function_internal_garbage_collected(self, *args, **kwargs)\r\n   2387       args, kwargs = None, None\r\n   2388     with self._lock:\r\n-> 2389       graph_function, _, _ = self._maybe_define_function(args, kwargs)\r\n   2390     return graph_function\r\n   2391 \r\n\r\n/tmp/site-packages/tensorflow_core/python/eager/function.py in _maybe_define_function(self, args, kwargs)\r\n   2701 \r\n   2702       self._function_cache.missed.add(call_context_key)\r\n-> 2703       graph_function = self._create_graph_function(args, kwargs)\r\n   2704       self._function_cache.primary[cache_key] = graph_function\r\n   2705       return graph_function, args, kwargs\r\n\r\n/tmp/site-packages/tensorflow_core/python/eager/function.py in _create_graph_function(self, args, kwargs, override_flat_arg_shapes)\r\n   2591             arg_names=arg_names,\r\n   2592             override_flat_arg_shapes=override_flat_arg_shapes,\r\n-> 2593             capture_by_value=self._capture_by_value),\r\n   2594         self._function_attributes,\r\n   2595         # Tell the ConcreteFunction to clean up its graph once it goes out of\r\n\r\n/tmp/site-packages/tensorflow_core/python/framework/func_graph.py in func_graph_from_py_func(name, python_func, args, kwargs, signature, func_graph, autograph, autograph_options, add_control_dependencies, arg_names, op_return_value, collections, capture_by_value, override_flat_arg_shapes)\r\n    976                                           converted_func)\r\n    977 \r\n--> 978       func_outputs = python_func(*func_args, **func_kwargs)\r\n    979 \r\n    980       # invariant: `func_outputs` contains only Tensors, CompositeTensors,\r\n\r\n/tmp/site-packages/tensorflow_core/python/eager/def_function.py in wrapped_fn(*args, **kwds)\r\n    437         # __wrapped__ allows AutoGraph to swap in a converted function. We give\r\n    438         # the function a weak reference to itself to avoid a reference cycle.\r\n--> 439         return weak_wrapped_fn().__wrapped__(*args, **kwds)\r\n    440     weak_wrapped_fn = weakref.ref(wrapped_fn)\r\n    441 \r\n\r\n/tmp/site-packages/tensorflow_core/python/eager/function.py in bound_method_wrapper(*args, **kwargs)\r\n   3204       if tf_inspect.ismethod(wrapped_fn):\r\n   3205         wrapped_fn = six.get_unbound_function(wrapped_fn)\r\n-> 3206       return wrapped_fn(weak_instance(), *args, **kwargs)\r\n   3207 \r\n   3208     # If __wrapped__ was replaced, then it is always an unbound function.\r\n\r\n/tmp/site-packages/tensorflow_core/python/training/saving/functional_saver.py in _traced_restore(self, file_prefix)\r\n    169       autograph=False)\r\n    170   def _traced_restore(self, file_prefix):\r\n--> 171     restore_ops = self.restore(file_prefix)\r\n    172     with ops.device(\"cpu:0\"):\r\n    173       with ops.control_dependencies(restore_ops.values()):\r\n\r\n/tmp/site-packages/tensorflow_core/python/training/saving/functional_saver.py in restore(self, file_prefix)\r\n    253     for device, saver in sorted(self._single_device_savers.items()):\r\n    254       with ops.device(device):\r\n--> 255         restore_ops.update(saver.restore(file_prefix))\r\n    256     return restore_ops\r\n\r\n/tmp/site-packages/tensorflow_core/python/training/saving/functional_saver.py in restore(self, file_prefix)\r\n    100                                           structured_restored_tensors):\r\n    101       restore_ops[saveable.name] = saveable.restore(\r\n--> 102           restored_tensors, restored_shapes=None)\r\n    103     return restore_ops\r\n    104 \r\n\r\n/tmp/site-packages/tensorflow_core/python/training/saving/saveable_object_util.py in restore(self, restored_tensors, restored_shapes)\r\n    114       restored_tensor = array_ops.identity(restored_tensor)\r\n    115       return resource_variable_ops.shape_safe_assign_variable_handle(\r\n--> 116           self.handle_op, self._var_shape, restored_tensor)\r\n    117 \r\n    118 \r\n\r\n/tmp/site-packages/tensorflow_core/python/ops/resource_variable_ops.py in shape_safe_assign_variable_handle(handle, shape, value, name)\r\n    298   return gen_resource_variable_ops.assign_variable_op(handle,\r\n    299                                                       value_tensor,\r\n--> 300                                                       name=name)\r\n    301 \r\n    302 \r\n\r\n/tmp/site-packages/tensorflow_core/python/ops/gen_resource_variable_ops.py in assign_variable_op(resource, value, name)\r\n    152   # Add nodes to the TensorFlow graph.\r\n    153   _, _, _op, _outputs = _op_def_library._apply_op_helper(\r\n--> 154         \"AssignVariableOp\", resource=resource, value=value, name=name)\r\n    155   return _op\r\n    156 AssignVariableOp = tf_export(\"raw_ops.AssignVariableOp\")(_ops.to_raw_op(assign_variable_op))\r\n\r\n/tmp/site-packages/tensorflow_core/python/framework/op_def_library.py in _apply_op_helper(op_type_name, name, **keywords)\r\n    489           if input_arg.type != types_pb2.DT_INVALID:\r\n    490             raise TypeError(\"%s expected type of %s.\" %\r\n--> 491                             (prefix, dtypes.as_dtype(input_arg.type).name))\r\n    492           else:\r\n    493             # Update the maps with the default, if needed.\r\n\r\nTypeError: Input 'resource' of 'AssignVariableOp' Op has type float32 that does not match expected type of resource.\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36827", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36827/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36827/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36827/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36827", "id": 566373898, "node_id": "MDU6SXNzdWU1NjYzNzM4OTg=", "number": 36827, "title": "Keras with multiple outputs: cannot evaluate a metric without associated loss", "user": {"login": "durandg12", "id": 45902885, "node_id": "MDQ6VXNlcjQ1OTAyODg1", "avatar_url": "https://avatars0.githubusercontent.com/u/45902885?v=4", "gravatar_id": "", "url": "https://api.github.com/users/durandg12", "html_url": "https://github.com/durandg12", "followers_url": "https://api.github.com/users/durandg12/followers", "following_url": "https://api.github.com/users/durandg12/following{/other_user}", "gists_url": "https://api.github.com/users/durandg12/gists{/gist_id}", "starred_url": "https://api.github.com/users/durandg12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/durandg12/subscriptions", "organizations_url": "https://api.github.com/users/durandg12/orgs", "repos_url": "https://api.github.com/users/durandg12/repos", "events_url": "https://api.github.com/users/durandg12/events{/privacy}", "received_events_url": "https://api.github.com/users/durandg12/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-02-17T15:32:09Z", "updated_at": "2020-02-27T10:50:30Z", "closed_at": null, "author_association": "NONE", "body": "- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): macOS 10.13.6\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): v2.1.0-rc2-17-ge5bf8de410 2.1.0\r\n- Python version: v3.6.7:6ec5cf24b7, Oct 20 2018, 03:02:14\r\n\r\n**Describe the current behavior**\r\n\r\nI am training a model which has two outputs, but I only want to train it with respect to a loss function on the first output. Nervertheless, I want to calculate a metric based on the second output. So, I pass this kind of argument to `compile`: \r\n`loss={'main_output': tf.keras.losses.MeanSquaredError(),}, metrics={'second_output': tf.keras.losses.MeanSquaredError()}` or `loss={'main_output': tf.keras.losses.MeanSquaredError(), 'second_output': None}, metrics={'second_output': tf.keras.losses.MeanSquaredError()}`. This does not work as intendend as the metric on `second_output`is not computed when I call the `fit` method. The first try raises a Warning which explains why:\r\n```\r\nWARNING:tensorflow:Output second_output missing from loss dictionary. We assume this was done on purpose. The fit and evaluate APIs will not be expecting any data to be passed to second_output.\r\n```\r\nI don't get why the API is done that way, for what reason no data could be passed to `second_output`just because I didn't associate a loss.\r\n\r\n**Workaround**\r\nI had to write a custom loss functions returning always `0.` to make things work:\r\n```\r\ndef zero_loss(y_true, y_pred):\r\n    return 0.\r\nmodel.compile(optimizer=tf.keras.optimizers.Adam(), \r\n              loss={'main_output': tf.keras.losses.MeanSquaredError(), 'second_output': zero_loss}, \r\n              metrics={'second_output': tf.keras.losses.MeanSquaredError()})\r\n```\r\nBut this prints a lot of useless stuff when calling `model.fit`: this prints `second_output_loss: 0.0000e+00` on each epoch.\r\n\r\n**Describe the expected behavior**\r\nI think that metrics on outputs without losses should be able to be computed when calling `fit`or `evaluate`.\r\n\r\n**Code to reproduce the issue** \r\n\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\nprint('Using Tensorflow version {} (git version {})'.format(tf.version.VERSION, tf.version.GIT_VERSION))\r\n\r\ninput_data = np.random.normal(size=(1024, 5))\r\ntarget_data = {'main_output' : np.random.normal(size=(1024,)), 'second_output': np.random.normal(size=(1024,))}\r\ninput_dataset = tf.data.Dataset.from_tensor_slices(input_data)\r\ntarget_dataset = tf.data.Dataset.from_tensor_slices(target_data)\r\ndataset = tf.data.Dataset.zip((input_dataset, target_dataset)).batch(16)\r\n\r\ndef make_model():\r\n    inp = tf.keras.Input(shape=(5))\r\n    hidden = tf.keras.layers.Dense(24, activation='relu')(inp)\r\n    out = tf.keras.layers.Dense(1, name='main_output')(hidden)\r\n    out2 = tf.keras.layers.Lambda(lambda x: x ** 2, name='second_output')(out)\r\n    model = tf.keras.Model(inputs=inp, outputs=[out, out2])\r\n    return model\r\n\r\nepochs = 2\r\n\r\nmodel = make_model()\r\nmodel.compile(optimizer=tf.keras.optimizers.Adam(), \r\n              loss={'main_output': tf.keras.losses.MeanSquaredError(),}, \r\n              metrics={'second_output': tf.keras.losses.MeanSquaredError()})\r\nmodel.fit(x=dataset, epochs=epochs)\r\n\r\nmodel = make_model()\r\nmodel.compile(optimizer=tf.keras.optimizers.Adam(), \r\n              loss={'main_output': tf.keras.losses.MeanSquaredError(), 'second_output': None}, \r\n              metrics={'second_output': tf.keras.losses.MeanSquaredError()})\r\nmodel.fit(x=dataset, epochs=epochs)\r\n\r\nmodel = make_model()\r\ndef zero_loss(y_true, y_pred):\r\n    return 0.\r\nmodel.compile(optimizer=tf.keras.optimizers.Adam(), \r\n              loss={'main_output': tf.keras.losses.MeanSquaredError(), 'second_output': zero_loss}, \r\n              metrics={'second_output': tf.keras.losses.MeanSquaredError()})\r\nmodel.fit(x=dataset, epochs=epochs)\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36824", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36824/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36824/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36824/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36824", "id": 566314969, "node_id": "MDExOlB1bGxSZXF1ZXN0Mzc2MTQ5NDY0", "number": 36824, "title": "Add int8 and int16 support to tflu network tester.", "user": {"login": "sicong-li-arm", "id": 58341114, "node_id": "MDQ6VXNlcjU4MzQxMTE0", "avatar_url": "https://avatars1.githubusercontent.com/u/58341114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sicong-li-arm", "html_url": "https://github.com/sicong-li-arm", "followers_url": "https://api.github.com/users/sicong-li-arm/followers", "following_url": "https://api.github.com/users/sicong-li-arm/following{/other_user}", "gists_url": "https://api.github.com/users/sicong-li-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/sicong-li-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sicong-li-arm/subscriptions", "organizations_url": "https://api.github.com/users/sicong-li-arm/orgs", "repos_url": "https://api.github.com/users/sicong-li-arm/repos", "events_url": "https://api.github.com/users/sicong-li-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/sicong-li-arm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-02-17T13:55:04Z", "updated_at": "2020-03-11T09:23:03Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36824", "html_url": "https://github.com/tensorflow/tensorflow/pull/36824", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36824.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36824.patch"}, "body": "Add support for other quantized types (int8, int16) to tflu network tester.\r\n\r\nSigned-off-by: SiCong Li <sicong.li@arm.com>"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36822", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36822/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36822/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36822/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36822", "id": 566308469, "node_id": "MDU6SXNzdWU1NjYzMDg0Njk=", "number": 36822, "title": "exception in gradient computation for losses when combining Tensor and EagerTensor", "user": {"login": "ngc92", "id": 7938269, "node_id": "MDQ6VXNlcjc5MzgyNjk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7938269?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ngc92", "html_url": "https://github.com/ngc92", "followers_url": "https://api.github.com/users/ngc92/followers", "following_url": "https://api.github.com/users/ngc92/following{/other_user}", "gists_url": "https://api.github.com/users/ngc92/gists{/gist_id}", "starred_url": "https://api.github.com/users/ngc92/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ngc92/subscriptions", "organizations_url": "https://api.github.com/users/ngc92/orgs", "repos_url": "https://api.github.com/users/ngc92/repos", "events_url": "https://api.github.com/users/ngc92/events{/privacy}", "received_events_url": "https://api.github.com/users/ngc92/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-02-17T13:44:06Z", "updated_at": "2020-02-18T12:05:49Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information** - Have I written custom code (as opposed to using a stock\r\nexample script provided in TensorFlow): yes \r\n- OS Platform and Distribution (e.g.,\r\nLinux Ubuntu 16.04): - Linux Mint 19 \r\n- TensorFlow installed from (source or binary): binary (pip)\r\n- TensorFlow version (use command below): v2.1.0-rc2-17-ge5bf8de 2.1.0\r\n- Python version: 3.6\r\n\r\n**Describe the current behavior**\r\nThe following minimal example works when using the second implementation alternative, but raises an error for the first:\r\n```python\r\nip = layers.Input(10)\r\nwith tf.GradientTape() as tape:\r\n    t = tf.zeros((10, 10))\r\n    tape.watch(t)\r\n    # this line throws an error \r\n    result = keras.losses.MeanSquaredError()(t, ip)\r\n    # but this one works\r\n    # result = (t - ip)**2 / tf.cast(tf.reduce_prod(tf.shape(t)), tf.float32)\r\ntape.gradient(result, t)\r\n```\r\n\r\nThe error is\r\n```\r\n  File \"~/wrapper.py\", line 101, in <module>\r\n    print(tape.gradient(result, t))\r\n  File \"~/venv/lib/python3.6/site-packages/tensorflow_core/python/eager/backprop.py\", line 1029, in gradient\r\n    unconnected_gradients=unconnected_gradients)\r\n  File \"~/venv/lib/python3.6/site-packages/tensorflow_core/python/eager/imperative_grad.py\", line 77, in imperative_grad\r\n    compat.as_str(unconnected_gradients.value))\r\n  File \"~/venv/lib/python3.6/site-packages/tensorflow_core/python/eager/backprop.py\", line 141, in _gradient_function\r\n    return grad_fn(mock_op, *out_grads)\r\n  File \"~/venv/lib/python3.6/site-packages/tensorflow_core/python/ops/math_grad.py\", line 258, in _MeanGrad\r\n    sum_grad = _SumGrad(op, grad)[0]\r\n  File \"~/venv/lib/python3.6/site-packages/tensorflow_core/python/ops/math_grad.py\", line 213, in _SumGrad\r\n    op.inputs[1])\r\n  File \"~/venv/lib/python3.6/site-packages/tensorflow_core/python/ops/math_ops.py\", line 3502, in reduced_shape\r\n    input_shape = input_shape.numpy()\r\nAttributeError: 'Tensor' object has no attribute 'numpy'\r\n```\r\n**Describe the expected behavior**\r\nAs the second implementation works, i would also expect the first to work.\r\n\r\nI have not done exhaustive testing of different loss functions, but the same problem also occurs when replacing the `MeanSquaredError` by `CategoricalCrossEntropy`. The problem seems to be caused by the fact that only one of the arguments to the loss function is an `EagerTensor`."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36821", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36821/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36821/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36821/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36821", "id": 566279235, "node_id": "MDU6SXNzdWU1NjYyNzkyMzU=", "number": 36821, "title": "Memory leak using generators with tf.data.experimental.AUTOTUNE", "user": {"login": "plooney", "id": 5527810, "node_id": "MDQ6VXNlcjU1Mjc4MTA=", "avatar_url": "https://avatars0.githubusercontent.com/u/5527810?v=4", "gravatar_id": "", "url": "https://api.github.com/users/plooney", "html_url": "https://github.com/plooney", "followers_url": "https://api.github.com/users/plooney/followers", "following_url": "https://api.github.com/users/plooney/following{/other_user}", "gists_url": "https://api.github.com/users/plooney/gists{/gist_id}", "starred_url": "https://api.github.com/users/plooney/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/plooney/subscriptions", "organizations_url": "https://api.github.com/users/plooney/orgs", "repos_url": "https://api.github.com/users/plooney/repos", "events_url": "https://api.github.com/users/plooney/events{/privacy}", "received_events_url": "https://api.github.com/users/plooney/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-02-17T12:52:03Z", "updated_at": "2020-02-26T00:05:25Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our\r\n[GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md),\r\nwe only address code/doc bugs, performance issues, feature requests and\r\nbuild/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information** - Have I written custom code (as opposed to using a stock\r\nexample script provided in TensorFlow): - OS Platform and Distribution (e.g.,\r\nLinux Ubuntu 16.04): - Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if\r\nthe issue happens on mobile device: - TensorFlow installed from (source or\r\nbinary): - TensorFlow version (use command below): - Python version: - Bazel\r\nversion (if compiling from source): - GCC/Compiler version (if compiling from\r\nsource): - CUDA/cuDNN version: - GPU model and memory:\r\n\r\nWindows 10\r\nTensorflow 2.0\r\nRTX 2060\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\n\r\nRead images from a generator using \"num_parallel_calls=AUTOTUNE\" is eating all memory\r\n\r\n**Describe the expected behavior**\r\n\r\nDon't use up all memory\r\n\r\n**Code to reproduce the issue** Provide a reproducible test case that is the\r\nbare minimum necessary to generate the problem.\r\n\r\n```\r\ndef my_generator(data_dir):\r\n    def my_func():\r\n        paths = pathlib.Path(data_dir).rglob('*.png')\r\n        for path in paths:\r\n            yield str(path)\r\n    return my_func\r\n\r\ndef process_path_test(file_path):\r\n    \"\"\"Read a tensorflow image from a png file and return the\r\n    image and filepath for writing out during test time\"\"\"\r\n    img_file = tf.io.read_file(file_path)\r\n    img = tf.io.decode_png(img_file, channels=1, dtype=tf.uint16)\r\n    return img, file_path\r\n\r\ndef some_func(img, file_path):\r\n    return img, file_path\r\n\r\np_dir = '//Some_path_to_images'\r\nAUTOTUNE = tf.data.experimental.AUTOTUNE\r\ntest_imgs = tf.data.Dataset.from_generator(my_generator(p_dir), tf.string).map(process_path_test)\r\ntest_imgs = test_imgs.map(some_func, num_parallel_calls=AUTOTUNE)\r\nmy_iter = iter(test_imgs)\r\nnext(my_iter)\r\n```\r\n\r\n**Other info / logs** Include any logs or source code that would be helpful to\r\ndiagnose the problem. If including tracebacks, please include the full\r\ntraceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36815", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36815/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36815/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36815/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36815", "id": 566176322, "node_id": "MDU6SXNzdWU1NjYxNzYzMjI=", "number": 36815, "title": "2GB Protobuf limit", "user": {"login": "carlpe", "id": 54416001, "node_id": "MDQ6VXNlcjU0NDE2MDAx", "avatar_url": "https://avatars0.githubusercontent.com/u/54416001?v=4", "gravatar_id": "", "url": "https://api.github.com/users/carlpe", "html_url": "https://github.com/carlpe", "followers_url": "https://api.github.com/users/carlpe/followers", "following_url": "https://api.github.com/users/carlpe/following{/other_user}", "gists_url": "https://api.github.com/users/carlpe/gists{/gist_id}", "starred_url": "https://api.github.com/users/carlpe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/carlpe/subscriptions", "organizations_url": "https://api.github.com/users/carlpe/orgs", "repos_url": "https://api.github.com/users/carlpe/repos", "events_url": "https://api.github.com/users/carlpe/events{/privacy}", "received_events_url": "https://api.github.com/users/carlpe/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-17T09:45:51Z", "updated_at": "2020-03-10T23:25:52Z", "closed_at": null, "author_association": "NONE", "body": "Greetings,\r\n\r\nI am training some deep learning models using Ubuntu Server 18.04 along with the following nvidia docker: nvcr.io/nvidia/tensorflow:20.01-tf1-py3\r\n\r\nTensorflow-gpu 1.15.2\r\nCUDA 10.2\r\nGPU TITAN RTX 24GB\r\n\r\nEverything is working very well and with a solid performance boost compared to my windows setup.\r\nHowever, it is limited to having a set window size of 328,328,328 - once I go with any larger window size the following happens:\r\n\r\nFile \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/ops.py\", line 3166, in _as_graph_def\r\ngraph.ParseFromString(compat.as_bytes(data))\r\n\r\nAs far as I understand this has to do with the protbuf limit set at 2GB as default. If I print the length of the data being serialized it is just under 2GB at the working window_size and just over when it is not working.\r\n\r\nIf I run the same script in windows10 (with pip install of tensorflow-gpu==1.15.2), the protobuf error is not present. But it is running out of memory with higher resolutions as windows is using significant amounts of VRAM in background.\r\n\r\nMy question is: How do I raise the limit of the protobuf while using the dockerfile in question. I am not interested in simply lowerering the window size because the higher windowsize we choose, the better is the quality of the output in the end.\r\n\r\nI have tried looking into the ops.py and also the coded_stream.h - without knowing exactly what to change"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36814", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36814/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36814/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36814/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36814", "id": 566166436, "node_id": "MDU6SXNzdWU1NjYxNjY0MzY=", "number": 36814, "title": "Can't import Layer from tensorflow.python.keras.engine.base_layer", "user": {"login": "harshithdwivedi", "id": 47669588, "node_id": "MDQ6VXNlcjQ3NjY5NTg4", "avatar_url": "https://avatars1.githubusercontent.com/u/47669588?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harshithdwivedi", "html_url": "https://github.com/harshithdwivedi", "followers_url": "https://api.github.com/users/harshithdwivedi/followers", "following_url": "https://api.github.com/users/harshithdwivedi/following{/other_user}", "gists_url": "https://api.github.com/users/harshithdwivedi/gists{/gist_id}", "starred_url": "https://api.github.com/users/harshithdwivedi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harshithdwivedi/subscriptions", "organizations_url": "https://api.github.com/users/harshithdwivedi/orgs", "repos_url": "https://api.github.com/users/harshithdwivedi/repos", "events_url": "https://api.github.com/users/harshithdwivedi/events{/privacy}", "received_events_url": "https://api.github.com/users/harshithdwivedi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-02-17T09:28:37Z", "updated_at": "2020-03-12T22:47:01Z", "closed_at": null, "author_association": "NONE", "body": "I'm getting an error that says `from tensorflow.python.keras.engine.base_layer import Layer` while importing tensorflow in my app.\r\n\r\n**System information** \r\n- Have I written custom code (as opposed to using a stock\r\nexample script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g.,\r\nLinux Ubuntu 16.04): MacOS\r\n- TensorFlow installed from (source or\r\nbinary): binary\r\n- TensorFlow version (use command below): 1.15.0\r\n- Python version: 3.7\r\n\r\n**Describe the current behavior**\r\nOn packaging an app using tensorflow with py2app, I get the following error while running the app: \r\n```\r\nFile \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow_core/__init__.py\", line 36, in <module>\r\n    from tensorflow._api.v1 import compat\r\n  File \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow_core/_api/v1/compat/__init__.py\", line 23, in <module>\r\n    from tensorflow._api.v1.compat import v1\r\n  File \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow_core/_api/v1/compat/v1/__init__.py\", line 40, in <module>\r\n    from tensorflow._api.v1.compat.v1 import experimental\r\n  File \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow_core/_api/v1/compat/v1/experimental/__init__.py\", line 11, in <module>\r\n    from tensorflow.python.ops.control_flow_v2_toggles import output_all_intermediates\r\n  File \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow_core/python/ops/control_flow_v2_toggles.py\", line 24, in <module>\r\n    from tensorflow.python.ops import control_flow_util_v2\r\n  File \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow_core/python/ops/control_flow_util_v2.py\", line 28, in <module>\r\n    from tensorflow.python.keras.engine import base_layer_utils\r\n  File \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow_core/python/keras/__init__.py\", line 27, in <module>\r\n    from tensorflow.python.keras import applications\r\n  File \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow_core/python/keras/applications/__init__.py\", line 25, in <module>\r\n    from tensorflow.python.keras import engine\r\n  File \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow_core/python/keras/engine/__init__.py\", line 23, in <module>\r\n    from tensorflow.python.keras.engine.base_layer import Layer\r\n  File \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow_core/python/keras/engine/base_layer.py\", line 58, in <module>\r\n    from tensorflow.python.keras.saving.saved_model import save as saved_model\r\n  File \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow_core/python/keras/saving/saved_model/save.py\", line 30, in <module>\r\n    from tensorflow.python.keras.saving import saving_utils\r\n  File \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow_core/python/keras/saving/__init__.py\", line 33, in <module>\r\n    from tensorflow.python.keras.saving.saved_model_experimental import export_saved_model\r\n  File \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow_core/python/keras/saving/saved_model_experimental.py\", line 30, in <module>\r\n    from tensorflow.python.keras.utils import mode_keys\r\n  File \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow_core/python/keras/utils/__init__.py\", line 38, in <module>\r\n    from tensorflow.python.keras.utils.multi_gpu_utils import multi_gpu_model\r\n  File \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow_core/python/keras/utils/multi_gpu_utils.py\", line 22, in <module>\r\n    from tensorflow.python.keras.engine.training import Model\r\n  File \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow_core/python/keras/engine/training.py\", line 42, in <module>\r\n    from tensorflow.python.keras import metrics as metrics_module\r\n  File \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow_core/python/keras/metrics.py\", line 34, in <module>\r\n    from tensorflow.python.keras.engine.base_layer import Layer\r\nImportError: cannot import name 'Layer' from 'tensorflow.python.keras.engine.base_layer' (/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow_core/python/keras/engine/base_layer.py)\r\n```\r\n\r\n**Describe the expected behavior**\r\nThe packaged app should work as expected.\r\n\r\n**Code to reproduce the issue** Provide a reproducible test case that is the\r\nbare minimum necessary to generate the problem.\r\n\r\n```\r\nimport tensorflow as tf\r\n\r\nself.model_path = r\"{}\".format(\r\n            pathlib.Path(os.getcwd()).joinpath('model'))\r\n        self.session = tf.Session(graph=tf.Graph())\r\n        tf.saved_model.loader.load(self.session, ['serve'], self.model_path)\r\n```\r\n\r\nhere's the setup.py that I've used with py2app: \r\n\r\n```\r\n\"\"\"\r\nThis is a setup.py script generated by py2applet\r\n\r\nUsage:\r\n    python setup.py py2app\r\n\"\"\"\r\n\r\nfrom setuptools import setup\r\n\r\nAPP = ['aftershoot.py']\r\nDATA_FILES = []\r\nOPTIONS = {\r\n        'packages' : ['PySide2', 'shiboken2', 'tensorflow_core', 'astor'],\r\n        'resources' : ['exposure/']\r\n        # 'optimize' : 1,\r\n        }\r\n\r\nsetup(\r\n    app=APP,\r\n    data_files=DATA_FILES,\r\n    options={'py2app': OPTIONS},\r\n    setup_requires=['py2app']\r\n)\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36810", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36810/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36810/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36810/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36810", "id": 566097839, "node_id": "MDU6SXNzdWU1NjYwOTc4Mzk=", "number": 36810, "title": "Gradient Support for Unique operator", "user": {"login": "Prasandhmcw", "id": 26406976, "node_id": "MDQ6VXNlcjI2NDA2OTc2", "avatar_url": "https://avatars2.githubusercontent.com/u/26406976?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Prasandhmcw", "html_url": "https://github.com/Prasandhmcw", "followers_url": "https://api.github.com/users/Prasandhmcw/followers", "following_url": "https://api.github.com/users/Prasandhmcw/following{/other_user}", "gists_url": "https://api.github.com/users/Prasandhmcw/gists{/gist_id}", "starred_url": "https://api.github.com/users/Prasandhmcw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Prasandhmcw/subscriptions", "organizations_url": "https://api.github.com/users/Prasandhmcw/orgs", "repos_url": "https://api.github.com/users/Prasandhmcw/repos", "events_url": "https://api.github.com/users/Prasandhmcw/events{/privacy}", "received_events_url": "https://api.github.com/users/Prasandhmcw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-02-17T07:08:14Z", "updated_at": "2020-03-04T01:09:16Z", "closed_at": null, "author_association": "NONE", "body": "I am trying to run a custom graph with only Unique op for a debugging.\r\n\r\n`with tf.GradientTape() as g:\r\ny = tf.unique(x)\r\ndy_dx = g.gradient(y, x)`\r\n\r\nThe Forward pass runs fine, but getting this error during Backward pass:\r\n\r\n> LookupError: gradient registry has no entry for: Unique\r\n\r\nGradient yet to be supported for Unique (or) there is no gradient for Unique ? Please help me understand why incase if its the second one.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36809", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36809/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36809/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36809/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36809", "id": 566064585, "node_id": "MDU6SXNzdWU1NjYwNjQ1ODU=", "number": 36809, "title": "import_graph_def  with cond nodes fails in eager/tf.function contexts", "user": {"login": "jackd", "id": 659115, "node_id": "MDQ6VXNlcjY1OTExNQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/659115?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jackd", "html_url": "https://github.com/jackd", "followers_url": "https://api.github.com/users/jackd/followers", "following_url": "https://api.github.com/users/jackd/following{/other_user}", "gists_url": "https://api.github.com/users/jackd/gists{/gist_id}", "starred_url": "https://api.github.com/users/jackd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jackd/subscriptions", "organizations_url": "https://api.github.com/users/jackd/orgs", "repos_url": "https://api.github.com/users/jackd/repos", "events_url": "https://api.github.com/users/jackd/events{/privacy}", "received_events_url": "https://api.github.com/users/jackd/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-02-17T05:24:16Z", "updated_at": "2020-02-26T00:10:38Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "*Have I written custom code*: Yes\r\n*OS Platform and Distribution*: Ubuntu 16.04\r\n*Tensorflow installed from*: binary\r\n*Tensorflow version*: v2.1.0-rc2-17-ge5bf8de 2.1.0 (cpu)\r\n\r\n**Describe the current behavior**\r\n`import_graph_def` fails to rebuild graphs containing `tf.cond` nodes in eager mode/`tf.function`ed calls.\r\n\r\n**Describe the expected behavior**\r\nWork as it does using tf 1.x-style session calls, or eager mode/`tf.function`ed calls on graph defs containing similar nodes like `tf.where`.\r\n\r\n**Code to reproduce the issue**\r\n```python\r\nimport tensorflow as tf\r\n\r\ngraph = tf.Graph()\r\nwith graph.as_default():\r\n    x = tf.keras.backend.placeholder(shape=(), dtype=tf.float32)\r\n    y = tf.keras.backend.placeholder(shape=(), dtype=tf.float32)\r\n    training = tf.keras.backend.placeholder(shape=(), dtype=tf.bool)\r\n    z = tf.cond(training, lambda: x * 10, lambda: y * 2)\r\n\r\ngraph_def = graph.as_graph_def()\r\n\r\n\r\ndef fn(*args):\r\n    x_value, y_value, training_value = args\r\n    return tf.graph_util.import_graph_def(graph_def,\r\n                                          input_map={\r\n                                              x.op.name: x_value,\r\n                                              y.op.name: y_value,\r\n                                              training.op.name: training_value,\r\n                                          },\r\n                                          return_elements=[z.name])\r\n\r\n\r\nclass ImportedCondTest(tf.test.TestCase):\r\n\r\n    def test_in_graph_mode(self):\r\n        with tf.Graph().as_default():\r\n            out = tf.graph_util.import_graph_def(graph_def,\r\n                                                 input_map={\r\n                                                     x.op.name: 0.,\r\n                                                     y.op.name: 1.0,\r\n                                                     training.op.name: True,\r\n                                                 },\r\n                                                 return_elements=[z.name])\r\n            with tf.compat.v1.Session() as sess:\r\n                sess.run(out)\r\n\r\n    def test_fn(self):\r\n        fn(0., 1., True)\r\n\r\n    def test_tf_function_fn(self):\r\n        tf.function(fn)(0., 1., True)\r\n\r\n    def test_map(self):\r\n        dataset = tf.data.Dataset.from_tensor_slices(([0.], [1.], [True]))\r\n        mapped = dataset.map(fn)\r\n        for _ in mapped:\r\n            pass\r\n\r\n\r\nif __name__ == '__main__':\r\n    tf.test.main()\r\n```\r\n\r\n**Other info / logs**\r\n```\r\nRunning tests under Python 3.6.8: ...anaconda2/envs/tf-2.0-cpu/bin/python\r\n[ RUN      ] ImportedCondTest.test_in_graph_mode\r\n2020-02-17 15:13:40.567294: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2020-02-17 15:13:40.587856: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3491630000 Hz\r\n2020-02-17 15:13:40.588472: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f5c5ffbd30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n2020-02-17 15:13:40.588510: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\n[       OK ] ImportedCondTest.test_in_graph_mode\r\n[ RUN      ] ImportedCondTest.test_map\r\n2020-02-17 15:13:40.733678: W tensorflow/core/framework/op_kernel.cc:1655] OP_REQUIRES failed at optimize_dataset_op.cc:60 : Invalid argument: Unable to find FunctionDef for cond_true_4 in the registry.\r\n[  FAILED  ] ImportedCondTest.test_map\r\n[ RUN      ] ImportedCondTest.test_normal\r\n[  FAILED  ] ImportedCondTest.test_normal\r\n[ RUN      ] ImportedCondTest.test_session\r\n[  SKIPPED ] ImportedCondTest.test_session\r\n[ RUN      ] ImportedCondTest.test_tf_function\r\n[  FAILED  ] ImportedCondTest.test_tf_function\r\n======================================================================\r\nERROR: test_map (__main__.ImportedCondTest)\r\ntest_map (__main__.ImportedCondTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"cond_fail.py\", line 47, in test_map\r\n    for _ in mapped:\r\n  File \"...anaconda2/envs/tf-2.0-cpu/lib/python3.6/site-packages/tensorflow_core/python/data/ops/dataset_ops.py\", line 418, in __iter__\r\n    return iterator_ops.OwnedIterator(self)\r\n  File \"...anaconda2/envs/tf-2.0-cpu/lib/python3.6/site-packages/tensorflow_core/python/data/ops/iterator_ops.py\", line 594, in __init__\r\n    self._create_iterator(dataset)\r\n  File \"...anaconda2/envs/tf-2.0-cpu/lib/python3.6/site-packages/tensorflow_core/python/data/ops/iterator_ops.py\", line 600, in _create_iterator\r\n    dataset = dataset._apply_options()\r\n  File \"...anaconda2/envs/tf-2.0-cpu/lib/python3.6/site-packages/tensorflow_core/python/data/ops/dataset_ops.py\", line 381, in _apply_options\r\n    static_optimization_configs)\r\n  File \"...anaconda2/envs/tf-2.0-cpu/lib/python3.6/site-packages/tensorflow_core/python/data/ops/dataset_ops.py\", line 4213, in __init__\r\n    **self._flat_structure)\r\n  File \"...anaconda2/envs/tf-2.0-cpu/lib/python3.6/site-packages/tensorflow_core/python/ops/gen_dataset_ops.py\", line 3638, in optimize_dataset\r\n    _ops.raise_from_not_ok_status(e, name)\r\n  File \"...anaconda2/envs/tf-2.0-cpu/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py\", line 6606, in raise_from_not_ok_status\r\n    six.raise_from(core._status_to_exception(e.code, message), None)\r\n  File \"<string>\", line 3, in raise_from\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Unable to find FunctionDef for cond_true_4 in the registry. [Op:OptimizeDataset]\r\n\r\n======================================================================\r\nERROR: test_normal (__main__.ImportedCondTest)\r\ntest_normal (__main__.ImportedCondTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"cond_fail.py\", line 39, in test_normal\r\n    fn(0., 1., True)\r\n  File \"cond_fail.py\", line 21, in fn\r\n    return_elements=[z.name])\r\n  File \"...anaconda2/envs/tf-2.0-cpu/lib/python3.6/site-packages/tensorflow_core/python/util/deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"...anaconda2/envs/tf-2.0-cpu/lib/python3.6/site-packages/tensorflow_core/python/framework/importer.py\", line 405, in import_graph_def\r\n    producer_op_list=producer_op_list)\r\n  File \"...anaconda2/envs/tf-2.0-cpu/lib/python3.6/site-packages/tensorflow_core/python/framework/importer.py\", line 487, in _import_graph_def_internal\r\n    validate_colocation_constraints)\r\n  File \"...anaconda2/envs/tf-2.0-cpu/lib/python3.6/site-packages/tensorflow_core/python/framework/importer.py\", line 221, in _PopulateTFImportGraphDefOptions\r\n    dst_output = input_dst._as_tf_output()  # pylint: disable=protected-access\r\n  File \"...anaconda2/envs/tf-2.0-cpu/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py\", line 1125, in _as_tf_output\r\n    \"_as_tf_output not supported when eager execution is enabled.\")\r\nNotImplementedError: _as_tf_output not supported when eager execution is enabled.\r\n\r\n======================================================================\r\nERROR: test_tf_function (__main__.ImportedCondTest)\r\ntest_tf_function (__main__.ImportedCondTest)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"cond_fail.py\", line 42, in test_tf_function\r\n    tf.function(fn)(0., 1., True)\r\n  File \"...anaconda2/envs/tf-2.0-cpu/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py\", line 568, in __call__\r\n    result = self._call(*args, **kwds)\r\n  File \"...anaconda2/envs/tf-2.0-cpu/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py\", line 638, in _call\r\n    return self._concrete_stateful_fn._filtered_call(canon_args, canon_kwds)  # pylint: disable=protected-access\r\n  File \"...anaconda2/envs/tf-2.0-cpu/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 1611, in _filtered_call\r\n    self.captured_inputs)\r\n  File \"...anaconda2/envs/tf-2.0-cpu/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 1692, in _call_flat\r\n    ctx, args, cancellation_manager=cancellation_manager))\r\n  File \"...anaconda2/envs/tf-2.0-cpu/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 545, in call\r\n    ctx=ctx)\r\n  File \"...anaconda2/envs/tf-2.0-cpu/lib/python3.6/site-packages/tensorflow_core/python/eager/execute.py\", line 67, in quick_execute\r\n    six.raise_from(core._status_to_exception(e.code, message), None)\r\n  File \"<string>\", line 3, in raise_from\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Op type not registered 'cond_true_4' in binary running on jackd-5810. Make sure the Op and Kernel are registered in the binary running in this process. Note that if you are loading a saved graph which used ops from tf.contrib, accessing (e.g.) `tf.contrib.resampler` should be done before importing the graph, as contrib ops are lazily registered when the module is first accessed. while building NodeDef 'import/cond/then/_0' [Op:__inference_fn_61]\r\n\r\n----------------------------------------------------------------------\r\nRan 5 tests in 0.243s\r\n\r\nFAILED (errors=3, skipped=1)\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36807", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36807/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36807/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36807/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36807", "id": 566041666, "node_id": "MDU6SXNzdWU1NjYwNDE2NjY=", "number": 36807, "title": "wrong doc for categorical_hinge loss ", "user": {"login": "openyuanmu", "id": 50131187, "node_id": "MDQ6VXNlcjUwMTMxMTg3", "avatar_url": "https://avatars0.githubusercontent.com/u/50131187?v=4", "gravatar_id": "", "url": "https://api.github.com/users/openyuanmu", "html_url": "https://github.com/openyuanmu", "followers_url": "https://api.github.com/users/openyuanmu/followers", "following_url": "https://api.github.com/users/openyuanmu/following{/other_user}", "gists_url": "https://api.github.com/users/openyuanmu/gists{/gist_id}", "starred_url": "https://api.github.com/users/openyuanmu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/openyuanmu/subscriptions", "organizations_url": "https://api.github.com/users/openyuanmu/orgs", "repos_url": "https://api.github.com/users/openyuanmu/repos", "events_url": "https://api.github.com/users/openyuanmu/events{/privacy}", "received_events_url": "https://api.github.com/users/openyuanmu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-02-17T03:58:13Z", "updated_at": "2020-03-05T03:34:48Z", "closed_at": null, "author_association": "NONE", "body": "## Description of issue (what needs changing):\r\n\r\ndocument for tensorflow.keras.losses.categorical_hinge is wrong\r\n\r\n### Clear description\r\n\r\n```python\r\n@keras_export('keras.losses.categorical_hinge')\r\ndef categorical_hinge(y_true, y_pred):\r\n  \"\"\"Computes the categorical hinge loss between `y_true` and `y_pred`.\r\n  `loss = maximum(neg - pos + 1, 0)`\r\n  where `neg = sum(y_true * y_pred)` and `pos = maximum(1 - y_true)`\r\n  Args:\r\n    y_true: The ground truth values. `y_true` values are expected to be -1 or 1.\r\n      If binary (0 or 1) labels are provided they will be converted to -1 or 1.\r\n    y_pred: The predicted values.\r\n  Returns:\r\n    Categorical hinge loss values.\r\n  \"\"\"\r\n  y_pred = ops.convert_to_tensor_v2(y_pred)\r\n  y_true = math_ops.cast(y_true, y_pred.dtype)\r\n  pos = math_ops.reduce_sum(y_true * y_pred, axis=-1)\r\n  neg = math_ops.reduce_max((1. - y_true) * y_pred, axis=-1)\r\n  return math_ops.maximum(0., neg - pos + 1.)\r\n```\r\n\r\nShould be: `neg=maximum((1-y_true)*y_pred)` and `pos=sum(y_true*y_pred)`\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36805", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36805/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36805/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36805/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36805", "id": 566020732, "node_id": "MDU6SXNzdWU1NjYwMjA3MzI=", "number": 36805, "title": "Convert `std::vector<tensorflow::Tensor>` into `std::vector<float>`", "user": {"login": "Abdulazizbek", "id": 15800037, "node_id": "MDQ6VXNlcjE1ODAwMDM3", "avatar_url": "https://avatars3.githubusercontent.com/u/15800037?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Abdulazizbek", "html_url": "https://github.com/Abdulazizbek", "followers_url": "https://api.github.com/users/Abdulazizbek/followers", "following_url": "https://api.github.com/users/Abdulazizbek/following{/other_user}", "gists_url": "https://api.github.com/users/Abdulazizbek/gists{/gist_id}", "starred_url": "https://api.github.com/users/Abdulazizbek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Abdulazizbek/subscriptions", "organizations_url": "https://api.github.com/users/Abdulazizbek/orgs", "repos_url": "https://api.github.com/users/Abdulazizbek/repos", "events_url": "https://api.github.com/users/Abdulazizbek/events{/privacy}", "received_events_url": "https://api.github.com/users/Abdulazizbek/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-02-17T02:28:28Z", "updated_at": "2020-02-26T00:20:30Z", "closed_at": null, "author_association": "NONE", "body": "How to convert Tensor `<type: float shae: [1, 512, 800, 1] >` into `std::vector<float>` ?\r\n\r\nI've tried [stackoverflow](https://stackoverflow.com/questions/44843368/convert-tensorflow-tensor-of-variable-size-to-stdvector-in-c) and some others  also, but failed\r\nThank you beforehand."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36802", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36802/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36802/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36802/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36802", "id": 566003103, "node_id": "MDU6SXNzdWU1NjYwMDMxMDM=", "number": 36802, "title": "DataLoss error on TFRecords - Randomly when accessing the dataset on S3 like storage", "user": {"login": "cheyang", "id": 3724388, "node_id": "MDQ6VXNlcjM3MjQzODg=", "avatar_url": "https://avatars2.githubusercontent.com/u/3724388?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cheyang", "html_url": "https://github.com/cheyang", "followers_url": "https://api.github.com/users/cheyang/followers", "following_url": "https://api.github.com/users/cheyang/following{/other_user}", "gists_url": "https://api.github.com/users/cheyang/gists{/gist_id}", "starred_url": "https://api.github.com/users/cheyang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cheyang/subscriptions", "organizations_url": "https://api.github.com/users/cheyang/orgs", "repos_url": "https://api.github.com/users/cheyang/repos", "events_url": "https://api.github.com/users/cheyang/events{/privacy}", "received_events_url": "https://api.github.com/users/cheyang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-02-17T00:56:49Z", "updated_at": "2020-03-17T03:17:45Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our\r\n[GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md),\r\nwe only address code/doc bugs, performance issues, feature requests and\r\nbuild/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information** \r\n- OS Platform and Distribution (e.g.,Linux Ubuntu 16.04): CentOS Linux 7.7\r\n- TensorFlow installed from (source or\r\nbinary): binary\r\n- TensorFlow version (use command below): 1.14.0\r\n- Python version: 3.6.8\r\n- Bazel\r\n- CUDA/cuDNN version: 410.79/V10.0.130\r\n- GPU model and memory: V100 8 GPUs /16130MiB\r\n\r\n**Describe the current behavior**\r\n\r\nI'm running tensorflow benchmark ResNet50 on Fuse of cloud storage(Alibaba Cloud Storage: oss). It succeed many times, or failed at the beginning of training. And when it passed the beginning,  it never failed during the training. And the speed is also good.\r\n\r\n The workload is 4 V100 GPU instances and each has 8 GPUs: 32 GPUs in total. \r\n\r\n```\r\n  (0) Data loss: corrupted record at 0\r\n\t [[{{node MultiDeviceIteratorGetNextFromShard}}]]\r\n\t [[RemoteCall]]\r\n\t [[input_processing/IteratorGetNext]]\r\n\t [[cluster_5_1/merge_oidx_1/_951]]\r\n  (1) Data loss: corrupted record at 0\r\n\t [[{{node MultiDeviceIteratorGetNextFromShard}}]]\r\n\t [[RemoteCall]]\r\n\t [[input_processing/IteratorGetNext]]\r\n0 successful operations.\r\n0 derived errors ignored.\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1356, in _do_call\r\n    return fn(*args)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1341, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"/usr/local/lib/python3.6/site-packages/tensorflow/python/client/session.py\", line 1429, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.DataLossError: 2 root error(s) found.\r\n  (0) Data loss: corrupted record at 0\r\n\t [[{{node MultiDeviceIteratorGetNextFromShard}}]]\r\n\t [[RemoteCall]]\r\n\t [[input_processing/IteratorGetNext]]\r\n\t [[cluster_5_1/merge_oidx_1/_951]]\r\n  (1) Data loss: corrupted record at 0\r\n\t [[{{node MultiDeviceIteratorGetNextFromShard}}]]\r\n\t [[RemoteCall]]\r\n\t [[input_processing/IteratorGetNext]]\r\n```\r\n\r\nI can make sure the tfrecords are correct, because we have checked it one by one.\r\nThe logs of fuse and Cloud storage system doesn't have any hint.\r\nCould your guys suggest what may cause this issue? Is there any latency requirement? Or could we set timeout in somewhere? Thanks very much for your help!\r\n\r\n\r\nHere is the full log:\r\n[test.log](https://github.com/tensorflow/tensorflow/files/4211351/test.log)\r\n\r\n\r\n**Describe the expected behavior**\r\n\r\n**Code to reproduce the issue** Provide a reproducible test case that is the\r\nbare minimum necessary to generate the problem.\r\n\r\n**Other info / logs** Include any logs or source code that would be helpful to\r\ndiagnose the problem. If including tracebacks, please include the full\r\ntraceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36801", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36801/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36801/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36801/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36801", "id": 565990445, "node_id": "MDU6SXNzdWU1NjU5OTA0NDU=", "number": 36801, "title": "TypeError: Object of type float32 is not JSON serializable", "user": {"login": "nbro", "id": 9349000, "node_id": "MDQ6VXNlcjkzNDkwMDA=", "avatar_url": "https://avatars2.githubusercontent.com/u/9349000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nbro", "html_url": "https://github.com/nbro", "followers_url": "https://api.github.com/users/nbro/followers", "following_url": "https://api.github.com/users/nbro/following{/other_user}", "gists_url": "https://api.github.com/users/nbro/gists{/gist_id}", "starred_url": "https://api.github.com/users/nbro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nbro/subscriptions", "organizations_url": "https://api.github.com/users/nbro/orgs", "repos_url": "https://api.github.com/users/nbro/repos", "events_url": "https://api.github.com/users/nbro/events{/privacy}", "received_events_url": "https://api.github.com/users/nbro/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2020-02-16T23:32:08Z", "updated_at": "2020-03-04T18:52:49Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code: Yes\r\n- OS Platform and Distribution: Mac OS Catalina (Version: 10.15.3)\r\n- TensorFlow installed from: binary\r\n- TensorFlow version: 2.1\r\n- Python version: 3.7.5\r\n- GPU model and memory: Intel Iris Pro 1536 MB\r\n\r\n**Describe the current behavior**\r\n\r\nI get the following error\r\n\r\n> TypeError: Object of type float32 is not JSON serializable\r\n\r\nwhen I try to save the state of the optimizer **after** having trained the model. Before training the model, I can save the state of the optimizer without getting any error.\r\n\r\n**Describe the expected behavior**\r\n\r\nNo error.\r\n\r\n**Code to reproduce the issue** \r\n\r\n```\r\nimport json\r\n\r\nimport tensorflow as tf\r\n\r\n\r\ndef get_model(input_shape=(1,)):\r\n    model = tf.keras.Sequential()\r\n    model.add(tf.keras.layers.Input(shape=input_shape))\r\n    model.add(tf.keras.layers.Dense(8, activation=\"relu\"))\r\n    model.add(tf.keras.layers.Dense(1))\r\n    model.summary()\r\n    model.compile(loss=\"mse\", optimizer=\"adam\")\r\n    return model\r\n\r\n\r\ndef write_config(model, optimizer_file_path=\"optimizer.json\"):\r\n    with open(optimizer_file_path, \"w\") as f:\r\n        json.dump(model.optimizer.get_config(), f, indent=4, sort_keys=True)\r\n\r\n\r\ndef get_data(n=100):\r\n    import numpy as np\r\n    data_x = np.random.rand(n, 1)\r\n    data_y = np.asarray([1 if x > 0.5 else 0 for x in data_x]).reshape(data_x.shape)\r\n    return data_x, data_y\r\n\r\n\r\nif __name__ == '__main__':\r\n    model = get_model()\r\n\r\n    x, y = get_data()\r\n\r\n    # No error before fitting.\r\n    # write_config(model)\r\n\r\n    model.fit(x, y, epochs=2)\r\n\r\n    # Error after fitting.\r\n    write_config(model)\r\n```\r\n\r\n**Other**\r\n\r\nNote that [the documentation of `model.optimizer.get_config()` says that the returned value is serializable](https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/Optimizer#get_config)\r\n\r\n> An optimizer config is a Python dictionary (serializable) containing the configuration of an optimizer."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36800", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36800/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36800/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36800/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36800", "id": 565984191, "node_id": "MDU6SXNzdWU1NjU5ODQxOTE=", "number": 36800, "title": "Pip package building fail on third party NASM linking ", "user": {"login": "tim-evain", "id": 33903279, "node_id": "MDQ6VXNlcjMzOTAzMjc5", "avatar_url": "https://avatars0.githubusercontent.com/u/33903279?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tim-evain", "html_url": "https://github.com/tim-evain", "followers_url": "https://api.github.com/users/tim-evain/followers", "following_url": "https://api.github.com/users/tim-evain/following{/other_user}", "gists_url": "https://api.github.com/users/tim-evain/gists{/gist_id}", "starred_url": "https://api.github.com/users/tim-evain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tim-evain/subscriptions", "organizations_url": "https://api.github.com/users/tim-evain/orgs", "repos_url": "https://api.github.com/users/tim-evain/repos", "events_url": "https://api.github.com/users/tim-evain/events{/privacy}", "received_events_url": "https://api.github.com/users/tim-evain/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1188421838, "node_id": "MDU6TGFiZWwxMTg4NDIxODM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:windows", "name": "subtype:windows", "color": "b619ea", "default": false, "description": "Windows Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-16T22:46:46Z", "updated_at": "2020-02-17T06:29:57Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10 Pro (version 1903 ; 18362.657)\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version: 2.0.1\r\n- Python version: 3.7.3\r\n- Bazel version (if compiling from source): 0.26.1\r\n- GCC/Compiler version (if compiling from source): MSVC 16 (VS2019)\r\n- CUDA/cuDNN version: 10.2 + 7\r\n- GPU model and memory: NVIDIA Titan RTX\r\n\r\n**Describe the problem**\r\n\r\nBuilding from source the pip package fails due to a failing linking to a third-party library (NASM)\r\n**NOTE**: During the first building try, my antivirus (Avira) put a nasm-related generated file in quarantine, so I disabled it before doing a clean new build.\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n\r\n- Preamble : Installed all prerequisites as given by https://www.tensorflow.org/install/source_windows\r\n- Run the configuration script (`python ./configure.py`) with following options: python 3.7 ; XLA support ; no ROCm ; CUDA 10.2 + cuDNN 7 ; AVX2 instruction set ; Eigen inline override\r\n- Fix the WORKSPACE file by adding:\r\n~~~~\r\nhttp_archive(\r\n    name = \"io_bazel_rules_docker\",\r\n    sha256 = \"dc97fccceacd4c6be14e800b2a00693d5e8d07f69ee187babfd04a80a9f8e250\",\r\n    strip_prefix = \"rules_docker-0.14.1\",\r\n    urls = [\"https://github.com/bazelbuild/rules_docker/releases/download/v0.14.1/rules_docker-v0.14.1.tar.gz\"],\r\n)\r\n~~~~\r\nafter the http_archive for closure rules (otherwise build fails when trying to execute `git reset --hard [...]` on @io_bazel_rules_docker)\r\n- Run the bazel build (`bazel build //tensorflow/tools/pip_package:build_pip_package`)\r\nThe build fail during the linking of the 3rd party NASM library (see error log under)\r\n\r\n**Any other info / logs**\r\n\r\npython configure.py\r\n~~~~\r\nPlease specify the location of python. [Default is C:\\Program Files\\Python_3.7.3\\python.exe]:\r\n\r\n\r\nFound possible Python library paths:\r\n  C:\\Program Files\\Python_3.7.3\\lib\\site-packages\r\nPlease input the desired Python library path to use.  Default is [C:\\Program Files\\Python_3.7.3\\lib\\site-packages]\r\n\r\nDo you wish to build TensorFlow with XLA JIT support? [y/N]: y\r\nXLA JIT support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with ROCm support? [y/N]: n\r\nNo ROCm support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with CUDA support? [y/N]: y\r\nCUDA support will be enabled for TensorFlow.\r\n\r\nFound CUDA 10.2 in:\r\n    C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.2/lib/x64\r\n    C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.2/include\r\nFound cuDNN 7 in:\r\n    C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.2/lib/x64\r\n    C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.2/include\r\n\r\n\r\nPlease specify a list of comma-separated CUDA compute capabilities you want to build with.\r\nYou can find the compute capability of your device at: https://developer.nvidia.com/cuda-gpus.\r\nPlease note that each additional compute capability significantly increases your build time and binary size, and that TensorFlow only supports compute capabilities >= 3.5 [Default is: 3.5,7.0]: 7.5\r\n\r\n\r\nPlease specify optimization flags to use during compilation when bazel option \"--config=opt\" is specified [Default is /arch:AVX]: /arch:AVX2\r\n\r\n\r\nWould you like to override eigen strong inline for some C++ compilation to reduce the compilation time? [Y/n]: y\r\nEigen strong inline overridden.\r\n\r\nPreconfigured Bazel build configs. You can use any of the below by adding \"--config=<>\" to your build command. See .bazelrc for more details.\r\n        --config=mkl            # Build with MKL support.\r\n        --config=monolithic     # Config for mostly static monolithic build.\r\n        --config=gdr            # Build with GDR support.\r\n        --config=verbs          # Build with libverbs support.\r\n        --config=ngraph         # Build with Intel nGraph support.\r\n        --config=numa           # Build with NUMA support.\r\n        --config=dynamic_kernels        # (Experimental) Build kernels into separate shared objects.\r\n        --config=v2             # Build TensorFlow 2.x instead of 1.x.\r\nPreconfigured Bazel build configs to DISABLE default on features:\r\n        --config=noaws          # Disable AWS S3 filesystem support.\r\n        --config=nogcp          # Disable GCP support.\r\n        --config=nohdfs         # Disable HDFS support.\r\n        --config=noignite       # Disable Apache Ignite support.\r\n        --config=nokafka        # Disable Apache Kafka support.\r\n        --config=nonccl         # Disable NVIDIA NCCL support.\r\n~~~~\r\n\r\nBuild error\r\n~~~~\r\nERROR: C:/users/tyrmalion/_bazel_tyrmalion/mrkkanxp/external/nasm/BUILD.bazel:8:1: Linking of rule '@nasm//:nasm' failed (Exit 1104): link.exe failed: error executing command\r\n  cd C:/users/tyrmalion/_bazel_tyrmalion/mrkkanxp/execroot/org_tensorflow\r\n  SET CUDA_TOOLKIT_PATH=C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v10.2\r\n    SET INCLUDE=C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\VC\\Tools\\MSVC\\14.24.28314\\ATLMFC\\include;C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\VC\\Tools\\MSVC\\14.24.28314\\include;C:\\Program Files (x86)\\Windows Kits\\NETFXSDK\\4.6.1\\include\\um;C:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.17763.0\\ucrt;C:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.17763.0\\shared;C:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.17763.0\\um;C:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.17763.0\\winrt;C:\\Program Files (x86)\\Windows Kits\\10\\include\\10.0.17763.0\\cppwinrt\r\n    SET LIB=C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\VC\\Tools\\MSVC\\14.24.28314\\ATLMFC\\lib\\x64;C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\VC\\Tools\\MSVC\\14.24.28314\\lib\\x64;C:\\Program Files (x86)\\Windows Kits\\NETFXSDK\\4.6.1\\lib\\um\\x64;C:\\Program Files (x86)\\Windows Kits\\10\\lib\\10.0.17763.0\\ucrt\\x64;C:\\Program Files (x86)\\Windows Kits\\10\\lib\\10.0.17763.0\\um\\x64;\r\n    SET PATH=C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\VC\\Tools\\MSVC\\14.24.28314\\bin\\HostX64\\x64;C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\Common7\\IDE\\VC\\VCPackages;C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\Common7\\IDE\\CommonExtensions\\Microsoft\\TestWindow;C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\Common7\\IDE\\CommonExtensions\\Microsoft\\TeamFoundation\\Team Explorer;C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\MSBuild\\Current\\bin\\Roslyn;C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\Team Tools\\Performance Tools\\x64;C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\Team Tools\\Performance Tools;C:\\Program Files (x86)\\Microsoft Visual Studio\\Shared\\Common\\VSPerfCollectionTools\\vs2019\\\\x64;C:\\Program Files (x86)\\Microsoft Visual Studio\\Shared\\Common\\VSPerfCollectionTools\\vs2019\\;C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v10.0A\\bin\\NETFX 4.6.1 Tools\\x64\\;C:\\Program Files (x86)\\Windows Kits\\10\\bin\\10.0.17763.0\\x64;C:\\Program Files (x86)\\Windows Kits\\10\\bin\\x64;C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\\\MSBuild\\Current\\Bin;C:\\WINDOWS\\Microsoft.NET\\Framework64\\v4.0.30319;C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\Common7\\IDE\\;C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\Common7\\Tools\\;;C:\\WINDOWS\\system32;C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\Common7\\IDE\\CommonExtensions\\Microsoft\\CMake\\CMake\\bin;C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\Common7\\IDE\\CommonExtensions\\Microsoft\\CMake\\Ninja\r\n    SET PWD=/proc/self/cwd\r\n    SET PYTHON_BIN_PATH=C:/Program Files/Python_3.7.3/python.exe\r\n    SET PYTHON_LIB_PATH=C:/Program Files/Python_3.7.3/lib/site-packages\r\n    SET RUNFILES_MANIFEST_ONLY=1\r\n    SET TEMP=C:\\Users\\TYRMAL~1\\AppData\\Local\\Temp\r\n    SET TF2_BEHAVIOR=1\r\n    SET TF_CONFIGURE_IOS=0\r\n    SET TF_CUDA_COMPUTE_CAPABILITIES=7.5\r\n    SET TF_ENABLE_XLA=1\r\n    SET TF_NEED_CUDA=1\r\n    SET TMP=C:\\Users\\TYRMAL~1\\AppData\\Local\\Temp\r\n  C:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC/Tools/MSVC/14.24.28314/bin/HostX64/x64/link.exe /nologo /OUT:bazel-out/x64_windows-opt/bin/external/nasm/nasm /SUBSYSTEM:CONSOLE /MACHINE:X64 @bazel-out/x64_windows-opt/bin/external/nasm/nasm-2.params\r\nExecution platform: @bazel_tools//platforms:host_platform\r\nLINK : fatal error LNK1104: cannot open file 'bazel-out\\x64_windows-opt\\bin\\external\\nasm\\nasm'\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nINFO: Elapsed time: 478.038s, Critical Path: 27.71s\r\nINFO: 563 processes: 563 local.\r\nFAILED: Build did NOT complete successfully\r\n~~~~"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36799", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36799/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36799/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36799/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36799", "id": 565965912, "node_id": "MDU6SXNzdWU1NjU5NjU5MTI=", "number": 36799, "title": "Feature Request: General Purpose Metrics Callback", "user": {"login": "PhilipMay", "id": 229382, "node_id": "MDQ6VXNlcjIyOTM4Mg==", "avatar_url": "https://avatars3.githubusercontent.com/u/229382?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PhilipMay", "html_url": "https://github.com/PhilipMay", "followers_url": "https://api.github.com/users/PhilipMay/followers", "following_url": "https://api.github.com/users/PhilipMay/following{/other_user}", "gists_url": "https://api.github.com/users/PhilipMay/gists{/gist_id}", "starred_url": "https://api.github.com/users/PhilipMay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PhilipMay/subscriptions", "organizations_url": "https://api.github.com/users/PhilipMay/orgs", "repos_url": "https://api.github.com/users/PhilipMay/repos", "events_url": "https://api.github.com/users/PhilipMay/events{/privacy}", "received_events_url": "https://api.github.com/users/PhilipMay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-02-16T20:39:24Z", "updated_at": "2020-03-05T16:11:36Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "# Background\r\nI am coming from tensorflow addons and have been send here by @pavithrasv and @seanpmorgan to start this discussion. The root of this is that we have great problems to implement a clean and bugfree F1 metric for keras. See here: https://github.com/tensorflow/addons/issues/825\r\n\r\n# Feature Request Description\r\nFor keras / tensorflow it is possible to implement custom metrics. These metrics are basicaly keras layers and have to be implemented with tensorflow itself. For many reasons it is not easy to implement certain metrics. This is the reason why some metrics like F1 are still not available in TF and have a history of ugly bugs. This is why I think that it would be good to implement a callback to plug in any metric without having to use TF. So you could plug in all sklearn metrics you want to use.\r\nThis is the case with other tools like LightGBM and XGBoost. See `feval` parameter of `lightgbm.train`: https://lightgbm.readthedocs.io/en/latest/pythonapi/lightgbm.train.html#lightgbm.train\r\n\r\n# First Idea of Implementation\r\nA first implementation version could look like this (but has some limitations - see below):\r\n\r\n``` python\r\nclass MetricsCallback(keras.callbacks.Callback):\r\n    def __init__(self, val_data, val_labels, fmetrics):\r\n        super().__init__()\r\n        self.val_data = val_data\r\n        self.val_labels = val_labels\r\n        self.fmetrics = fmetrics\r\n        # TODO: more checks\r\n\r\n    def on_epoch_end(self, epoch, logs=None):\r\n        logs = logs or {}\r\n        predict_results = self.model.predict(self.val_data)\r\n\r\n        for fm in self.fmetrics:\r\n            metric_name, value = fm(self.val_labels, predict_results)\r\n            logs[metric_name] = value\r\n```\r\n\r\n## Limitations\r\nYou have to give validation data to this callback and not to the fit function of keras. Otherwise the validation data will be predicted twice - once from keras fit and once from this callback. \r\n\r\nAnd if you want to use the EarlyStopping callback you have to provide this callback before the EarlyStopping callback.\r\n\r\n# Next Steps\r\nWhat are the next steps? I would like to start a discussion on how to implement the first version in a way that integrates with keras and does not feel like a hack."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36798", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36798/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36798/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36798/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36798", "id": 565958148, "node_id": "MDU6SXNzdWU1NjU5NTgxNDg=", "number": 36798, "title": "TF 2.0: Spyder auto complete and go to definition not working. Please fix it!", "user": {"login": "colt18", "id": 26602153, "node_id": "MDQ6VXNlcjI2NjAyMTUz", "avatar_url": "https://avatars1.githubusercontent.com/u/26602153?v=4", "gravatar_id": "", "url": "https://api.github.com/users/colt18", "html_url": "https://github.com/colt18", "followers_url": "https://api.github.com/users/colt18/followers", "following_url": "https://api.github.com/users/colt18/following{/other_user}", "gists_url": "https://api.github.com/users/colt18/gists{/gist_id}", "starred_url": "https://api.github.com/users/colt18/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/colt18/subscriptions", "organizations_url": "https://api.github.com/users/colt18/orgs", "repos_url": "https://api.github.com/users/colt18/repos", "events_url": "https://api.github.com/users/colt18/events{/privacy}", "received_events_url": "https://api.github.com/users/colt18/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1093464312, "node_id": "MDU6TGFiZWwxMDkzNDY0MzEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:others", "name": "type:others", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, {"login": "annarev", "id": 22060313, "node_id": "MDQ6VXNlcjIyMDYwMzEz", "avatar_url": "https://avatars0.githubusercontent.com/u/22060313?v=4", "gravatar_id": "", "url": "https://api.github.com/users/annarev", "html_url": "https://github.com/annarev", "followers_url": "https://api.github.com/users/annarev/followers", "following_url": "https://api.github.com/users/annarev/following{/other_user}", "gists_url": "https://api.github.com/users/annarev/gists{/gist_id}", "starred_url": "https://api.github.com/users/annarev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/annarev/subscriptions", "organizations_url": "https://api.github.com/users/annarev/orgs", "repos_url": "https://api.github.com/users/annarev/repos", "events_url": "https://api.github.com/users/annarev/events{/privacy}", "received_events_url": "https://api.github.com/users/annarev/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-02-16T19:43:56Z", "updated_at": "2020-02-25T04:32:13Z", "closed_at": null, "author_association": "NONE", "body": "Due to the nature of the \"lazy import\" spyder IDE is not able to resolve the package tree and fails both \"auto complete\" and \"go to function definition\". \r\n\r\nSpyder guys told me TF should implemeny .pyi files to overcome this.\r\n\r\nhttps://github.com/spyder-ide/spyder/issues/11553"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36797", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36797/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36797/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36797/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36797", "id": 565956436, "node_id": "MDU6SXNzdWU1NjU5NTY0MzY=", "number": 36797, "title": "Severe slowdown with 1 BN step in while_v2", "user": {"login": "OverLordGoldDragon", "id": 16495490, "node_id": "MDQ6VXNlcjE2NDk1NDkw", "avatar_url": "https://avatars2.githubusercontent.com/u/16495490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/OverLordGoldDragon", "html_url": "https://github.com/OverLordGoldDragon", "followers_url": "https://api.github.com/users/OverLordGoldDragon/followers", "following_url": "https://api.github.com/users/OverLordGoldDragon/following{/other_user}", "gists_url": "https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}", "starred_url": "https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/OverLordGoldDragon/subscriptions", "organizations_url": "https://api.github.com/users/OverLordGoldDragon/orgs", "repos_url": "https://api.github.com/users/OverLordGoldDragon/repos", "events_url": "https://api.github.com/users/OverLordGoldDragon/events{/privacy}", "received_events_url": "https://api.github.com/users/OverLordGoldDragon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-16T19:31:44Z", "updated_at": "2020-03-05T14:40:55Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "I'm developing recurrent batch normalization for LSTM, and am seeing a best-case scenario of **8x slowdown** relative to base implementation (worst-case can **exceed 20x**). `tf.function` helps notably, but not nearly enough - and the behavior is unreasonable; applying the operation on _1 out of 150 steps_ yields a 6.7x slowdown, and on 150/150 steps, 8x. I suspect [`while_v2.while_loop()`](https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/ops/control_flow_ops.py#L2666)'s gradient handling is responsible.\r\n\r\nThe problem's exacerbated by TF 2.1's [broken profiler](https://github.com/tensorflow/tensorboard/issues/3256) - my IDE (Spyder 4) is also unable to capture the call details in Eager or Graph, unlike in TF2. I also cannot develop in 2.0 per bug fixes and significant performance improvements. I don't think `while_v2` was designed to handle whatever I'm doing.\r\n\r\nWhat can I do to circumvent such a severe slowdown? Also, is this the best place to ask, or is there a dev forum somewhere to avoid a month-long back & forth? Help is appreciated.\r\n\r\n<hr>\r\n\r\n**DETAILS**: a part of the full code:\r\n\r\n```python\r\ndef recurrent_bn(self, inputs_t, op_name, step, training=None):\r\n    training = self._get_training_value(training)\r\n    beta, gamma, moving_mean, moving_variance = self._get_bn_vars(op_name)\r\n\r\n    @tf.function\r\n    def outs(inputs_t, step, beta, gamma, moving_mean, moving_variance, training):\r\n        if tf.math.less(step, self.max_inference_step) and (training != False):\r\n            mean_t, variance_t = self._get_stats_and_maybe_update(\r\n                inputs_t, step, moving_mean, moving_variance, training)\r\n        else:\r\n            mean_t, variance_t = moving_mean[-1], moving_variance[-1]\r\n        return nn.batch_normalization(inputs_t, mean_t, variance_t,\r\n                                      beta, gamma, self.bn_epsilon)\r\n\r\n    outputs = outs(inputs_t, step, beta, gamma, moving_mean,\r\n                   moving_variance, training)\r\n    outputs.set_shape(inputs_t.shape)\r\n    return outputs\r\n\r\ndef _get_bn_vars(self, op_name):\r\n    return [getattr(self, op_name + '_' + var_name) for var_name in\r\n            ('gamma', 'beta', 'moving_mean', 'moving_variance')]  # these were built\r\n```\r\n\r\n`recurrent_bn` is applied 9 times in `call` - 4 times for each of `i, f, c, o` of `kernel, recurrent`, and once on `c`. `_get_stats_and_maybe_update` returns `nn.moments` applied on `moving_...[step:step+1]` slice, and calls [`_assign_moving_average`](https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/layers/normalization.py#L503) (added method to `LSTMCell`) when `training` is truthy. `LSTM` and `LSTMCell` are also inherited by `recurrent_v2` classes, which yielded a speedup.\r\n\r\n - `gamma, beta` have shape `(1, self.units)`\r\n - `moving_mean, moving_variance` have shape `(self.max_inference_steps, self.units)`\r\n - There are 9 of each -> 36 total\r\n - Example call: `x_i = self.recurrent_bn(x_i, 'kernel_i', step, training)`\r\n\r\n<hr>\r\n\r\n**Possible culprits**:\r\n\r\n 1. Gradients, **main culprit**, via T2-T5: T3 yielded significant speedup relative to every other test, including T4 - and T5 was negligible. It appears that updating the BN variables just _once_ triggers some gradient operations for _every timestep_ - hence the slowdown. \r\n 2. `_get_bn_vars`, **unknown**; the variables are being fetched from a Python dictionary in `tf.function`, and though there are no retracing warnings, it's still a suspect\r\n 3. `nn.batch_normalization` + `nn.moments`, **ruled out** via T2; only a 12% speedup is granted.\r\n 4. `step`, **ruled out** via T6 + T7; no noted performance difference\r\n 5. `CuDNNLSTM`, **ruled out**; I set `implementation = 1` and `recurrent_dropout = .05`\r\n\r\n**Tests**:\r\n\r\n - **T1**: replace `self.max_inference_steps` (`.numpy() == 150`) with `tf.constant(1, dtype='int64')\r\n - **T2**: T1 + move `nn.batch_normalization` under `if`, replace `else` with `return inputs_t`\r\n - **T3**: wrap `gamma, beta` with `K.stop_gradient()` _before_ `if`, and `mean_t, variance_t` _after_ `else` (otherwise cannot slice wrapped tensor)\r\n - **T4**: T3, but wrap everything _after_ `else`.\r\n - **T5**: `K.stop_gradient` on `inputs_t, training`\r\n - **T6**: immediately `return inputs_t` in `recurrent_bn`\r\n - **T7**: remove hidden state `step`, don't return `step + 1` in `call`\r\n\r\n**Bugs**:\r\n\r\n  1. Wrapping `self._assign_moving_average` with `self.add_update` fails [`_assert_same_graph()`](https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/framework/ops.py#L5816):\r\n\r\n```\r\noriginal_item == updates[0], item == updates[1]\r\nupdates[0] == <tf.Operation 'training/Adam/Adam/AssignAddVariableOp' type=AssignAddVariableOp>\r\nupdates[1] == <tf.Operation 'AssignMovingAvg' type=ResourceStridedSliceAssign>\r\nupdates[0].graph == <tensorflow.python.framework.ops.Graph object at 0x000002A3473AF788>\r\nupdates[1].graph == <tensorflow.python.ops.control_flow_v2_func_graphs.CondBranchFuncGraph\r\n                     object at 0x000002A35C7F2548>\r\n```\r\n   -  [`updates`](https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/engine/training.py#L2059); `len(updates) == 37` = 9*4 + 1; so 4 per each of 9 calls to `recurrent_bn`, +1 default\r\n   - [`self.add_update`](https://github.com/tensorflow/tensorflow/blob/r2.1/tensorflow/python/keras/layers/recurrent_v2.py#L1158) is used in `LSTM` right _after_ `K.rnn` - so it appears that `while_v2` is responsible for `updates[1].graph` being different\r\n   - `self.add_update` compiles, and yields a 10% speedup in Eager\r\n\r\n 2. As noted [here](https://github.com/tensorflow/tensorflow/issues/36840): while there aren't errors in Eager, the gradients are extremely small: `1e-9` to `1e-19`, whereas usually the same layers have `1e-6` to `1e-2`. This may or may not be a design rather than a bug problem.\r\n\r\n<hr>\r\n\r\n**IDE Profiler encapsulation**:\r\n\r\n<img src=\"https://user-images.githubusercontent.com/16495490/74617169-49255c80-5145-11ea-9aba-b5cca922e97c.png\" width=\"550\">\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36794", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36794/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36794/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36794/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36794", "id": 565893564, "node_id": "MDU6SXNzdWU1NjU4OTM1NjQ=", "number": 36794, "title": "a bug about tf.function", "user": {"login": "paokuwansui", "id": 45961471, "node_id": "MDQ6VXNlcjQ1OTYxNDcx", "avatar_url": "https://avatars0.githubusercontent.com/u/45961471?v=4", "gravatar_id": "", "url": "https://api.github.com/users/paokuwansui", "html_url": "https://github.com/paokuwansui", "followers_url": "https://api.github.com/users/paokuwansui/followers", "following_url": "https://api.github.com/users/paokuwansui/following{/other_user}", "gists_url": "https://api.github.com/users/paokuwansui/gists{/gist_id}", "starred_url": "https://api.github.com/users/paokuwansui/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/paokuwansui/subscriptions", "organizations_url": "https://api.github.com/users/paokuwansui/orgs", "repos_url": "https://api.github.com/users/paokuwansui/repos", "events_url": "https://api.github.com/users/paokuwansui/events{/privacy}", "received_events_url": "https://api.github.com/users/paokuwansui/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1190546177, "node_id": "MDU6TGFiZWwxMTkwNTQ2MTc3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:autograph", "name": "comp:autograph", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2020-02-16T11:57:01Z", "updated_at": "2020-03-16T07:22:35Z", "closed_at": null, "author_association": "NONE", "body": "WARNING:tensorflow:AutoGraph could not transform <function converge_to_2 at 0x7f6e047dae50> and will run it as-is.\r\nPlease report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.\r\nCause: invalid value for \"node\": expected \"ast.AST\", got \"<class 'NoneType'>\"; to visit lists of nodes, use \"visit_block\" instead\r\nWARNING: AutoGraph could not transform <function converge_to_2 at 0x7f6e047dae50> and will run it as-is.\r\nPlease report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.\r\nCause: invalid value for \"node\": expected \"ast.AST\", got \"<class 'NoneType'>\"; to visit lists of nodes, use \"visit_block\" instead\r\ntf.Tensor(1.9999981, shape=(), dtype=float32)"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36792", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36792/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36792/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36792/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36792", "id": 565881226, "node_id": "MDU6SXNzdWU1NjU4ODEyMjY=", "number": 36792, "title": "Cannot convert a symbolic Tensor (Neg_1:0) to a numpy array", "user": {"login": "oeyvindds", "id": 13333063, "node_id": "MDQ6VXNlcjEzMzMzMDYz", "avatar_url": "https://avatars2.githubusercontent.com/u/13333063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oeyvindds", "html_url": "https://github.com/oeyvindds", "followers_url": "https://api.github.com/users/oeyvindds/followers", "following_url": "https://api.github.com/users/oeyvindds/following{/other_user}", "gists_url": "https://api.github.com/users/oeyvindds/gists{/gist_id}", "starred_url": "https://api.github.com/users/oeyvindds/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oeyvindds/subscriptions", "organizations_url": "https://api.github.com/users/oeyvindds/orgs", "repos_url": "https://api.github.com/users/oeyvindds/repos", "events_url": "https://api.github.com/users/oeyvindds/events{/privacy}", "received_events_url": "https://api.github.com/users/oeyvindds/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1190546177, "node_id": "MDU6TGFiZWwxMTkwNTQ2MTc3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:autograph", "name": "comp:autograph", "color": "0052cc", "default": false, "description": ""}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-02-16T10:12:27Z", "updated_at": "2020-03-16T04:00:39Z", "closed_at": null, "author_association": "NONE", "body": "Hello.\r\n\r\nI am trying to derive with Tensorflow, and get an error telling me to report the behavior to the TensorFlow team. Hence this post. \r\n\r\nMy code:\r\n```python\r\nfrom math import e\r\n\r\ndef cal_sigma(y):\r\n    return 1 / (1 + np.power(e, -y) )\r\n\r\n@tf.function\r\ndef get_derivative(x, y):\r\n    with tf.GradientTape(persistent=True) as tape:\r\n        tape.watch(x)\r\n        tape.watch(y)\r\n        y_sigma = cal_sigma(-y)\r\n        f = (x + y_sigma) / np.power((x -y), 2)\r\n    df_dy = tape.gradient(f, y) \r\n    return df_dy\r\n\r\nx = tf.constant (1.)\r\ny = tf.constant (-3.)\r\nprint(get_derivative(x, y))\r\n\r\nIf I derive with respect to x (df_dy = tape.gradient(f, x) in second to last line; it works. However, with y, I get the following error:\r\n\r\nWARNING:tensorflow:AutoGraph could not transform <method-wrapper '__call__' of numpy.ufunc object at 0x110a96950> and will run it as-is.\r\nPlease report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.\r\nCause: Cannot convert a symbolic Tensor (Neg_1:0) to a numpy array.\r\nWARNING: AutoGraph could not transform <method-wrapper '__call__' of numpy.ufunc object at 0x110a96950> and will run it as-is.\r\nPlease report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.\r\nCause: Cannot convert a symbolic Tensor (Neg_1:0) to a numpy array.\r\n---------------------------------------------------------------------------\r\nNotImplementedError                       Traceback (most recent call last)\r\n<ipython-input-11-a4cdc628e4ad> in <module>\r\n      2 y = tf.constant (-3.)\r\n      3 #print(get_derivative(x, y))\r\n----> 4 print(get_derivative2(x, y))\r\n\r\n/opt/anaconda3/envs/DeepLearning/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py in __call__(self, *args, **kwds)\r\n    566         xla_context.Exit()\r\n    567     else:\r\n--> 568       result = self._call(*args, **kwds)\r\n    569 \r\n    570     if tracing_count == self._get_tracing_count():\r\n\r\n/opt/anaconda3/envs/DeepLearning/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py in _call(self, *args, **kwds)\r\n    604       # In this case we have not created variables on the first call. So we can\r\n    605       # run the first trace but we should fail if variables are created.\r\n--> 606       results = self._stateful_fn(*args, **kwds)\r\n    607       if self._created_variables:\r\n    608         raise ValueError(\"Creating variables on a non-first call to a function\"\r\n\r\n/opt/anaconda3/envs/DeepLearning/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py in __call__(self, *args, **kwargs)\r\n   2360     \"\"\"Calls a graph function specialized to the inputs.\"\"\"\r\n   2361     with self._lock:\r\n-> 2362       graph_function, args, kwargs = self._maybe_define_function(args, kwargs)\r\n   2363     return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access\r\n   2364 \r\n\r\n/opt/anaconda3/envs/DeepLearning/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py in _maybe_define_function(self, args, kwargs)\r\n   2701 \r\n   2702       self._function_cache.missed.add(call_context_key)\r\n-> 2703       graph_function = self._create_graph_function(args, kwargs)\r\n   2704       self._function_cache.primary[cache_key] = graph_function\r\n   2705       return graph_function, args, kwargs\r\n\r\n/opt/anaconda3/envs/DeepLearning/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py in _create_graph_function(self, args, kwargs, override_flat_arg_shapes)\r\n   2591             arg_names=arg_names,\r\n   2592             override_flat_arg_shapes=override_flat_arg_shapes,\r\n-> 2593             capture_by_value=self._capture_by_value),\r\n   2594         self._function_attributes,\r\n   2595         # Tell the ConcreteFunction to clean up its graph once it goes out of\r\n\r\n/opt/anaconda3/envs/DeepLearning/lib/python3.7/site-packages/tensorflow_core/python/framework/func_graph.py in func_graph_from_py_func(name, python_func, args, kwargs, signature, func_graph, autograph, autograph_options, add_control_dependencies, arg_names, op_return_value, collections, capture_by_value, override_flat_arg_shapes)\r\n    976                                           converted_func)\r\n    977 \r\n--> 978       func_outputs = python_func(*func_args, **func_kwargs)\r\n    979 \r\n    980       # invariant: `func_outputs` contains only Tensors, CompositeTensors,\r\n\r\n/opt/anaconda3/envs/DeepLearning/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py in wrapped_fn(*args, **kwds)\r\n    437         # __wrapped__ allows AutoGraph to swap in a converted function. We give\r\n    438         # the function a weak reference to itself to avoid a reference cycle.\r\n--> 439         return weak_wrapped_fn().__wrapped__(*args, **kwds)\r\n    440     weak_wrapped_fn = weakref.ref(wrapped_fn)\r\n    441 \r\n\r\n/opt/anaconda3/envs/DeepLearning/lib/python3.7/site-packages/tensorflow_core/python/framework/func_graph.py in wrapper(*args, **kwargs)\r\n    966           except Exception as e:  # pylint:disable=broad-except\r\n    967             if hasattr(e, \"ag_error_metadata\"):\r\n--> 968               raise e.ag_error_metadata.to_exception(e)\r\n    969             else:\r\n    970               raise\r\n\r\nNotImplementedError: in converted code:\r\n\r\n    <ipython-input-9-af8fccc461fb>:20 get_derivative2  *\r\n        y_sigma = cal_sigma(-y)\r\n    <ipython-input-9-af8fccc461fb>:4 cal_sigma  *\r\n        return 1 / (1 + np.power(e, -y) )\r\n    /opt/anaconda3/envs/DeepLearning/lib/python3.7/site-packages/tensorflow_core/python/framework/ops.py:728 __array__\r\n        \" array.\".format(self.name))\r\n\r\n    NotImplementedError: Cannot convert a symbolic Tensor (Neg_1:0) to a numpy array.\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36790", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36790/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36790/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36790/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36790", "id": 565860795, "node_id": "MDU6SXNzdWU1NjU4NjA3OTU=", "number": 36790, "title": "tf.keras.backend.set_floatx() causing ValueError (dtype conversion error) while computing tf.keras.metrics.*", "user": {"login": "Hemal-Mamtora", "id": 32389544, "node_id": "MDQ6VXNlcjMyMzg5NTQ0", "avatar_url": "https://avatars0.githubusercontent.com/u/32389544?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Hemal-Mamtora", "html_url": "https://github.com/Hemal-Mamtora", "followers_url": "https://api.github.com/users/Hemal-Mamtora/followers", "following_url": "https://api.github.com/users/Hemal-Mamtora/following{/other_user}", "gists_url": "https://api.github.com/users/Hemal-Mamtora/gists{/gist_id}", "starred_url": "https://api.github.com/users/Hemal-Mamtora/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Hemal-Mamtora/subscriptions", "organizations_url": "https://api.github.com/users/Hemal-Mamtora/orgs", "repos_url": "https://api.github.com/users/Hemal-Mamtora/repos", "events_url": "https://api.github.com/users/Hemal-Mamtora/events{/privacy}", "received_events_url": "https://api.github.com/users/Hemal-Mamtora/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}, {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-02-16T06:43:58Z", "updated_at": "2020-02-18T18:05:44Z", "closed_at": null, "author_association": "NONE", "body": "**System information** - Have I written custom code on **Google Colab**: - \r\n**Code:**\r\n```\r\ntf.keras.backend.set_floatx('float64')\r\n\r\nmodel.compile(optimizer= Adam(learning_rate= 0.001, clipnorm=1.0, clipvalue=0.5),\r\n              loss={\r\n                  'class_output': BinaryCrossentropy(),\r\n                  'decoder_output': BinaryCrossentropy()\r\n              },\r\n              loss_weights=[0.5, 1.0],\r\n               metrics = {\r\n                  'class_output':[tf.metrics.Recall(), tf.metrics.Precision()],\r\n                  'decoder_output':[tf.metrics.Recall(), tf.metrics.Precision()],\r\n              }\r\n             ) \r\n```\r\n**Error:**\r\n```\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/ops.py in convert_to_tensor(value, dtype, name, as_ref, preferred_dtype, dtype_hint, ctx, accepted_result_types)\r\n   1288       raise ValueError(\r\n   1289           \"Tensor conversion requested dtype %s for Tensor with dtype %s: %r\" %\r\n-> 1290           (dtype.name, value.dtype.name, value))\r\n   1291     return value\r\n   1292 \r\n\r\nValueError: Tensor conversion requested dtype float64 for Tensor with dtype float32: <tf.Tensor 'metrics_6/class_output_recall_8/Sum:0' shape=(1,) dtype=float32>\r\n```\r\n\r\nOS Platform and Distribution : - \r\n```\r\nos.uname()\r\n>>> posix.uname_result(sysname='Linux', nodename='ed841897617b', release='4.14.137+', version='#1 SMP Thu Aug 8 02:47:02 PDT 2019', machine='x86_64')\r\n```\r\nTensorFlow installed from : - \r\n```!pip install tensorflow==2.10```\r\nTensorFlow version : - \r\n```\r\ntf.__version__\r\n>>> '2.1.0'\r\n```\r\nPython version: - \r\n```\r\n!python -V\r\n>>> Python 3.6.9\r\n```\r\n~~Bazel version :-  NA~~\r\n~~GCC/Compiler version : - NA~~  \r\n~~CUDA/cuDNN version: -  NA~~\r\n\r\nGPU model and memory:\r\n```\r\nfrom psutil import virtual_memory\r\nmem = virtual_memory()\r\nprint(mem.total / 1024**3, 'GB') # total physical memory available\r\n>>>12.717426300048828 GB\r\n````\r\n~~You can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`~~\r\n\r\n**Describe the current behavior**\r\nWhen using `tf.keras.backend.set_floatx('float64')` , whole tf should be set to float64, right ?\r\nBut the tf.metrics are not getting set as shown in the code above\r\n\r\n**Describe the expected behavior**\r\nAll of tf including tf.metrics should be calculated on the basis of tf.keras.backend.set_floatx('float64')\r\n\r\n**Code to reproduce the issue** \r\n```\r\nimport tensorflow as tf \r\n\r\ntf.keras.backend.set_floatx('float64')\r\n\r\nm = tf.keras.metrics.Recall()\r\nm.update_state([0, 1, 1, 1], [1, 0, 1, 1])\r\nprint('Final result: ', m.result().numpy())\r\n```\r\n\r\n**Other info / logs** ~~Include any logs or source code that would be helpful to\r\ndiagnose the problem. If including tracebacks, please include the full\r\ntraceback. Large logs and files should be attached.~~\r\nStackTrace:\r\n```\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-30-86f79f751766> in <module>()\r\n      6               loss_weights=[0.5, 1.0],\r\n      7                metrics = {\r\n----> 8                   'class_output':[tf.metrics.Recall(), tf.metrics.Precision()],\r\n      9                 #  'decoder_output':[tf.metrics.Recall(), tf.metrics.Precision()],\r\n     10               }\r\n\r\n13 frames\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/training/tracking/base.py in _method_wrapper(self, *args, **kwargs)\r\n    455     self._self_setattr_tracking = False  # pylint: disable=protected-access\r\n    456     try:\r\n--> 457       result = method(self, *args, **kwargs)\r\n    458     finally:\r\n    459       self._self_setattr_tracking = previous_value  # pylint: disable=protected-access\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training.py in compile(self, optimizer, loss, metrics, loss_weights, sample_weight_mode, weighted_metrics, target_tensors, distribute, **kwargs)\r\n    437           targets=self._targets,\r\n    438           skip_target_masks=self._prepare_skip_target_masks(),\r\n--> 439           masks=self._prepare_output_masks())\r\n    440 \r\n    441       # Prepare sample weight modes. List with the same length as model outputs.\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training.py in _handle_metrics(self, outputs, targets, skip_target_masks, sample_weights, masks, return_weighted_metrics, return_weighted_and_unweighted_metrics)\r\n   2002           metric_results.extend(\r\n   2003               self._handle_per_output_metrics(self._per_output_metrics[i],\r\n-> 2004                                               target, output, output_mask))\r\n   2005         if return_weighted_and_unweighted_metrics or return_weighted_metrics:\r\n   2006           metric_results.extend(\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training.py in _handle_per_output_metrics(self, metrics_dict, y_true, y_pred, mask, weights)\r\n   1953       with K.name_scope(metric_name):\r\n   1954         metric_result = training_utils.call_metric_function(\r\n-> 1955             metric_fn, y_true, y_pred, weights=weights, mask=mask)\r\n   1956         metric_results.append(metric_result)\r\n   1957     return metric_results\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_utils.py in call_metric_function(metric_fn, y_true, y_pred, weights, mask)\r\n   1153 \r\n   1154   if y_pred is not None:\r\n-> 1155     return metric_fn(y_true, y_pred, sample_weight=weights)\r\n   1156   # `Mean` metric only takes a single value.\r\n   1157   return metric_fn(y_true, sample_weight=weights)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/metrics.py in __call__(self, *args, **kwargs)\r\n    194     from tensorflow.python.keras.distribute import distributed_training_utils  # pylint:disable=g-import-not-at-top\r\n    195     return distributed_training_utils.call_replica_local_fn(\r\n--> 196         replica_local_fn, *args, **kwargs)\r\n    197 \r\n    198   @property\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/distribute/distributed_training_utils.py in call_replica_local_fn(fn, *args, **kwargs)\r\n   1133     with strategy.scope():\r\n   1134       return strategy.extended.call_for_each_replica(fn, args, kwargs)\r\n-> 1135   return fn(*args, **kwargs)\r\n   1136 \r\n   1137 \r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/metrics.py in replica_local_fn(*args, **kwargs)\r\n    177     def replica_local_fn(*args, **kwargs):\r\n    178       \"\"\"Updates the state of the metric in a replica-local context.\"\"\"\r\n--> 179       update_op = self.update_state(*args, **kwargs)  # pylint: disable=not-callable\r\n    180       with ops.control_dependencies([update_op]):\r\n    181         result_t = self.result()  # pylint: disable=not-callable\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/utils/metrics_utils.py in decorated(metric_obj, *args, **kwargs)\r\n     74 \r\n     75     with tf_utils.graph_context_for_symbolic_tensors(*args, **kwargs):\r\n---> 76       update_op = update_state_fn(*args, **kwargs)\r\n     77     if update_op is not None:  # update_op will be None in eager execution.\r\n     78       metric_obj.add_update(update_op)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/metrics.py in update_state(self, y_true, y_pred, sample_weight)\r\n   1340         top_k=self.top_k,\r\n   1341         class_id=self.class_id,\r\n-> 1342         sample_weight=sample_weight)\r\n   1343 \r\n   1344   def result(self):\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/utils/metrics_utils.py in update_confusion_matrix_variables(variables_to_update, y_true, y_pred, thresholds, top_k, class_id, sample_weight, multi_label, label_weights)\r\n    438       update_ops.append(\r\n    439           weighted_assign_add(label, pred, weights_tiled,\r\n--> 440                               variables_to_update[matrix_cond]))\r\n    441 \r\n    442   return control_flow_ops.group(update_ops)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/utils/metrics_utils.py in weighted_assign_add(label, pred, weights, var)\r\n    414     if weights is not None:\r\n    415       label_and_pred *= weights\r\n--> 416     return var.assign_add(math_ops.reduce_sum(label_and_pred, 1))\r\n    417 \r\n    418   loop_vars = {\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/ops/resource_variable_ops.py in assign_add(self, delta, use_locking, name, read_value)\r\n    783     with _handle_graph(self.handle), self._assign_dependencies():\r\n    784       assign_add_op = gen_resource_variable_ops.assign_add_variable_op(\r\n--> 785           self.handle, ops.convert_to_tensor(delta, dtype=self.dtype),\r\n    786           name=name)\r\n    787     if read_value:\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/ops.py in convert_to_tensor(value, dtype, name, as_ref, preferred_dtype, dtype_hint, ctx, accepted_result_types)\r\n   1288       raise ValueError(\r\n   1289           \"Tensor conversion requested dtype %s for Tensor with dtype %s: %r\" %\r\n-> 1290           (dtype.name, value.dtype.name, value))\r\n   1291     return value\r\n   1292 \r\n\r\nValueError: Tensor conversion requested dtype float64 for Tensor with dtype float32: <tf.Tensor 'metrics_6/class_output_recall_8/Sum:0' shape=(1,) dtype=float32>\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36786", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36786/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36786/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36786/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36786", "id": 565793015, "node_id": "MDU6SXNzdWU1NjU3OTMwMTU=", "number": 36786, "title": "Add \"See also\"  references", "user": {"login": "janosh", "id": 30958850, "node_id": "MDQ6VXNlcjMwOTU4ODUw", "avatar_url": "https://avatars0.githubusercontent.com/u/30958850?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janosh", "html_url": "https://github.com/janosh", "followers_url": "https://api.github.com/users/janosh/followers", "following_url": "https://api.github.com/users/janosh/following{/other_user}", "gists_url": "https://api.github.com/users/janosh/gists{/gist_id}", "starred_url": "https://api.github.com/users/janosh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janosh/subscriptions", "organizations_url": "https://api.github.com/users/janosh/orgs", "repos_url": "https://api.github.com/users/janosh/repos", "events_url": "https://api.github.com/users/janosh/events{/privacy}", "received_events_url": "https://api.github.com/users/janosh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-02-15T18:50:29Z", "updated_at": "2020-03-16T06:12:54Z", "closed_at": null, "author_association": "NONE", "body": "This is sort of a follow up to #33756. The TF docs have undergone huge improvements over the last couple months. However, one thing I really like about the PyTorch docs which is still (mostly) missing in the TF docs are \"**See also**\"  references.\r\n\r\nA lot of functions have similar or related functionality. Examples include:\r\n\r\n1. `tf.split`, `tf.unstack`\r\n2. `tf.size`, `tf.shape`\r\n3. `tf.repeat`, `tf.concat`, `tf.tile`, `tf.stack`\r\n4. `tf.exp`, `tf.math.log`\r\n5. `tf.keras.layers.MaxPool2D`, `tf.nn.max_pool2d `\r\n6. `tf.ones`, `tf.ones_like` and `tf.zeros`, `tf.zeros_like`\r\n\r\njust to name a few.\r\n\r\nOften people happen to find one and start using it regularly but remain unaware of the others for quite a while. Even if I do know about all of them, I often find myself wanting to compare the signature of similar functions to find the one most suitable to the current use case. In those cases, it takes way too many clicks to get from one to the other(s).\r\n\r\nIn short, would be great if the docs referenced related content. That should help guide people to use the best tool for the job right from the start."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36785", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36785/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36785/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36785/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36785", "id": 565785654, "node_id": "MDU6SXNzdWU1NjU3ODU2NTQ=", "number": 36785, "title": "TF 2.1/tf.keras AdaDelta optimizer: default epsilon and learning rate values", "user": {"login": "8bitmp3", "id": 19637339, "node_id": "MDQ6VXNlcjE5NjM3MzM5", "avatar_url": "https://avatars3.githubusercontent.com/u/19637339?v=4", "gravatar_id": "", "url": "https://api.github.com/users/8bitmp3", "html_url": "https://github.com/8bitmp3", "followers_url": "https://api.github.com/users/8bitmp3/followers", "following_url": "https://api.github.com/users/8bitmp3/following{/other_user}", "gists_url": "https://api.github.com/users/8bitmp3/gists{/gist_id}", "starred_url": "https://api.github.com/users/8bitmp3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/8bitmp3/subscriptions", "organizations_url": "https://api.github.com/users/8bitmp3/orgs", "repos_url": "https://api.github.com/users/8bitmp3/repos", "events_url": "https://api.github.com/users/8bitmp3/events{/privacy}", "received_events_url": "https://api.github.com/users/8bitmp3/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "karmel", "id": 667809, "node_id": "MDQ6VXNlcjY2NzgwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karmel", "html_url": "https://github.com/karmel", "followers_url": "https://api.github.com/users/karmel/followers", "following_url": "https://api.github.com/users/karmel/following{/other_user}", "gists_url": "https://api.github.com/users/karmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/karmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karmel/subscriptions", "organizations_url": "https://api.github.com/users/karmel/orgs", "repos_url": "https://api.github.com/users/karmel/repos", "events_url": "https://api.github.com/users/karmel/events{/privacy}", "received_events_url": "https://api.github.com/users/karmel/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "karmel", "id": 667809, "node_id": "MDQ6VXNlcjY2NzgwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karmel", "html_url": "https://github.com/karmel", "followers_url": "https://api.github.com/users/karmel/followers", "following_url": "https://api.github.com/users/karmel/following{/other_user}", "gists_url": "https://api.github.com/users/karmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/karmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karmel/subscriptions", "organizations_url": "https://api.github.com/users/karmel/orgs", "repos_url": "https://api.github.com/users/karmel/repos", "events_url": "https://api.github.com/users/karmel/events{/privacy}", "received_events_url": "https://api.github.com/users/karmel/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-02-15T17:53:23Z", "updated_at": "2020-02-20T08:18:03Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "Hi @tanzhenyu @lamberta @dynamicwebpaige There are two param default values for AdaDelta that look different from the original implementation. It is probably explained in past discussions (and if it is the case pls let me know where I can find it so we can close this issue.) Cheers.\r\n\r\nSimilar issues: https://github.com/tensorflow/tensorflow/issues/31024 and https://github.com/tensorflow/tensorflow/pull/31025.\r\n\r\nTF 2.1 [API docs for the Adadelta optimizer](https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/Adadelta) come from [`/optimizer-v2/`](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/keras/optimizer_v2/adadelta.py), where: \r\n- The learning rate is set to 0.001:\r\n  - Keras' implementation states that learning rate is 1.\r\n  - [`optimizer.py`](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/keras/optimizers.py) (v1) sets it to 1 (synced with Keras, I suppose).\r\n  - There's a Keras PR - https://github.com/keras-team/keras/pull/12841 - that proposed to change the LR from 1 to 0.001. It may have been reverted back to 1 (see commit https://github.com/keras-team/keras/pull/12888/commits/2009cab5217a57bfbb4dae88371640ce1bb4a0e9).\r\n- The default epsilon does not match the one in the original AdaDelta [paper](https://arxiv.org/pdf/1212.5701.pdf) as well as Keras' implementation:\r\n  - They use `1e-6` instead of `1e-7` (`\"Setting the hyperparameters to \u03b5 = 1e \u2212 6 and \u03c1 = 0.95...\"`).\r\n\r\nSources: \r\n\r\n- [TF 2.1 /optimizer_v2/](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/keras/optimizer_v2/adadelta.py):\r\n\r\n```python\r\n@keras_export('keras.optimizers.Adadelta')\r\nclass Adadelta(optimizer_v2.OptimizerV2):\r\n  ...\r\n  def __init__(self,\r\n               learning_rate=0.001,\r\n               rho=0.95,\r\n               epsilon=1e-7,\r\n               name='Adadelta',\r\n               **kwargs):\r\n```\r\n\r\n- [TF 2.1 optimizers.py - version 1](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/keras/optimizers.py):\r\n\r\n```python\r\nclass Adadelta(Optimizer):\r\n...\r\n  def __init__(self, lr=1.0, rho=0.95, epsilon=None, decay=0., **kwargs):\r\n...\r\n```\r\n\r\n- [Keras optimizers.py](https://github.com/keras-team/keras/blob/master/keras/optimizers.py):\r\n```python\r\nclass Adadelta(Optimizer):\r\n...\r\n    def __init__(self, learning_rate=1.0, rho=0.95, **kwargs):\r\n...\r\n```\r\n\r\nThanks for taking your time to look at this potential issue."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36783", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36783/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36783/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36783/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36783", "id": 565745219, "node_id": "MDU6SXNzdWU1NjU3NDUyMTk=", "number": 36783, "title": "tensorflow-1.14 and tensorflow1.15, avx512f does no performance improvements than avx2", "user": {"login": "haolujun", "id": 10751631, "node_id": "MDQ6VXNlcjEwNzUxNjMx", "avatar_url": "https://avatars3.githubusercontent.com/u/10751631?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haolujun", "html_url": "https://github.com/haolujun", "followers_url": "https://api.github.com/users/haolujun/followers", "following_url": "https://api.github.com/users/haolujun/following{/other_user}", "gists_url": "https://api.github.com/users/haolujun/gists{/gist_id}", "starred_url": "https://api.github.com/users/haolujun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haolujun/subscriptions", "organizations_url": "https://api.github.com/users/haolujun/orgs", "repos_url": "https://api.github.com/users/haolujun/repos", "events_url": "https://api.github.com/users/haolujun/events{/privacy}", "received_events_url": "https://api.github.com/users/haolujun/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 1093464312, "node_id": "MDU6TGFiZWwxMDkzNDY0MzEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:others", "name": "type:others", "color": "159b2e", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-02-15T13:01:25Z", "updated_at": "2020-02-21T18:48:20Z", "closed_at": null, "author_association": "NONE", "body": "HI :\r\n    I run a model use tensorflow-1.14 compiled with avx2, avx512f , and found that: avx512 does no performance improvements than avx2. The timeline of avx2 or avx512f were the same as below. MatMul is most expensive op.\r\n\r\nMachine A:\r\navx512 CPU: Intel(R) Xeon(R) Silver 4110 CPU @ 2.10GHz\r\navx512 compile command: \r\nbazel build tensorflow:libtensorflow_cc.so -c opt --copt=-march=native --copt=-mfpmath=both  --copt=-mfma --copt=-mavx --copt=-mavx2 --copt=-mavx512f --copt=-mavx512cd --copt=-mavx512dq --copt=-mavx512bw --copt=-mavx512vl . \r\ngcc version: 7.3.0\r\n\r\nMachine B:\r\navx2 CPU: Intel(R) Xeon(R) CPU E5-2620 v4 @ 2.10GHz\r\navx2 compile command:\r\nbazel build tensorflow:libtensorflow_cc.so -c opt --copt=-march=native --copt=-mfpmath=both  --copt=-mfma --copt=-mavx --copt=-mavx2 \r\ngcc version: 4.8.5\r\n    \r\n![image](https://user-images.githubusercontent.com/10751631/74588331-6d464800-5036-11ea-80dc-dd26b71e0f25.png)\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36782", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36782/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36782/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36782/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36782", "id": 565743041, "node_id": "MDU6SXNzdWU1NjU3NDMwNDE=", "number": 36782, "title": "Unable to package tensorflow with Py2App", "user": {"login": "harshithdwivedi", "id": 47669588, "node_id": "MDQ6VXNlcjQ3NjY5NTg4", "avatar_url": "https://avatars1.githubusercontent.com/u/47669588?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harshithdwivedi", "html_url": "https://github.com/harshithdwivedi", "followers_url": "https://api.github.com/users/harshithdwivedi/followers", "following_url": "https://api.github.com/users/harshithdwivedi/following{/other_user}", "gists_url": "https://api.github.com/users/harshithdwivedi/gists{/gist_id}", "starred_url": "https://api.github.com/users/harshithdwivedi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harshithdwivedi/subscriptions", "organizations_url": "https://api.github.com/users/harshithdwivedi/orgs", "repos_url": "https://api.github.com/users/harshithdwivedi/repos", "events_url": "https://api.github.com/users/harshithdwivedi/events{/privacy}", "received_events_url": "https://api.github.com/users/harshithdwivedi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1205765054, "node_id": "MDU6TGFiZWwxMjA1NzY1MDU0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:macOS", "name": "subtype:macOS", "color": "b619ea", "default": false, "description": "macOS Build/Installation issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-02-15T12:41:54Z", "updated_at": "2020-03-03T21:46:07Z", "closed_at": null, "author_association": "NONE", "body": "\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): MacOS Catalina\r\n- TensorFlow installed from (source or binary): Binary\r\n- TensorFlow version: 2.1.0\r\n- Python version: 3.7\r\n- Installed using virtualenv? pip? conda?: Yes, installed in a virtualenv using pip\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: N/A\r\n\r\n**Describe the problem**\r\nOn running an executable that was packaged using Py2App, the executable throws the following error: \r\n\r\n```\r\nFile \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/aftershoot.py\", line 4, in <module>\r\n    import asexposure.ASExposure as Exposure\r\n  File \"asexposure/ASExposure.pyc\", line 1, in <module>\r\n  File \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow/__init__.py\", line 98, in <module>\r\n    from tensorflow_core import *\r\n  File \"/Users/harshitdwivedi/Desktop/aftershootscripts/dist/aftershoot.app/Contents/Resources/lib/python3.7/tensorflow_core/__init__.py\", line 40, in <module>\r\n    from tensorflow.python.tools import module_util as _module_util\r\nModuleNotFoundError: No module named 'tensorflow.python.tools'; 'tensorflow.python' is not a package\r\n```\r\nUpon looking into the line of code causing this issue, it looks like `tensorflow_core`'s `init.py` is trying to import `module_util` from `tensorflow.python.tools`. However, isnide my site-packages,  there's northing inside the package named `tensorflow`. Instead the package above `python.tools` exists inside `tensorflow_core`.\r\n\r\nHere's a screenshot showcasing this: \r\n\r\n<img width=\"626\" alt=\"Screenshot 2020-02-15 at 6 06 56 PM\" src=\"https://user-images.githubusercontent.com/47669588/74587897-20567780-501e-11ea-9ff1-91b268c2a160.png\">\r\n\r\nAs you can see here, python folder is inside tensorflow_core, but the init.py tries to refer it from tensorflow.\r\n<img width=\"817\" alt=\"Screenshot 2020-02-15 at 6 07 52 PM\" src=\"https://user-images.githubusercontent.com/47669588/74587901-264c5880-501e-11ea-9814-63e8d9ded432.png\">\r\n\r\nIs this a known issue? And if so, is there a way to fix this?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36781", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36781/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36781/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36781/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36781", "id": 565734442, "node_id": "MDU6SXNzdWU1NjU3MzQ0NDI=", "number": 36781, "title": "Blas GEMM launch failed", "user": {"login": "JivanRoquet", "id": 6452675, "node_id": "MDQ6VXNlcjY0NTI2NzU=", "avatar_url": "https://avatars2.githubusercontent.com/u/6452675?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JivanRoquet", "html_url": "https://github.com/JivanRoquet", "followers_url": "https://api.github.com/users/JivanRoquet/followers", "following_url": "https://api.github.com/users/JivanRoquet/following{/other_user}", "gists_url": "https://api.github.com/users/JivanRoquet/gists{/gist_id}", "starred_url": "https://api.github.com/users/JivanRoquet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JivanRoquet/subscriptions", "organizations_url": "https://api.github.com/users/JivanRoquet/orgs", "repos_url": "https://api.github.com/users/JivanRoquet/repos", "events_url": "https://api.github.com/users/JivanRoquet/events{/privacy}", "received_events_url": "https://api.github.com/users/JivanRoquet/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-02-15T11:19:07Z", "updated_at": "2020-03-02T20:42:55Z", "closed_at": null, "author_association": "NONE", "body": "- Have I written custom code: yes\r\n- OS Platform and Distribution: ubuntu 18.04\r\n- TensorFlow installed from binary\r\n- TensorFlow version: 2.1.0 (TensorFlow-GPU)\r\n- Keras version: 2.3.1\r\n- Python version: 3.6.8\r\n- CUDA/cuDNN version: Cuda 10.1 / cuDNN 7.6.4\r\n- GPU model and memory: Tesla K80 with 11441MiB Memory\r\n\r\n**Describe the current behavior**\r\n\r\nOn an AWS p2.xlarge instance, when calling `model.fit` on a TF model with GPU support activated, the process crashes with the following error message:\r\n\r\n```\r\nInternalError:  Blas GEMM launch failed : a.shape=(32, 116032), b.shape=(116032, 256), m=32, n=256, k=116032\r\n\t [[node dense_1/MatMul (defined at /home/ubuntu/.local/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:3009) ]] [Op:__inference_keras_scratch_graph_1645]\r\n\r\nFunction call stack:\r\nkeras_scratch_graph\r\n```\r\n\r\n**Describe the expected behavior**\r\n\r\nWhen calling `model.fit`, the model would simply train normally like it does when using a CPU.\r\n\r\n**Code to reproduce the issue**\r\n\r\nRun a p2.xlarge instance on AWS\r\nInstall all the GPU-related requirements as per https://www.tensorflow.org/install/gpu\r\nCreate a basic Sequential model with Keras (TF backend)\r\nCompile the model (this runs fine)\r\nCall `model.fit` on some training data\r\n\r\n**Other info / logs** Include any logs or source code that would be helpful to\r\ndiagnose the problem. If including tracebacks, please include the full\r\ntraceback. Large logs and files should be attached.\r\n\r\nLogs of the error:\r\n```\r\n2020-02-15 11:07:22.795814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1241] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10770 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:1e.0, compute capability: 3.7)\r\n2020-02-15 11:07:27.168747: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10\r\n2020-02-15 11:07:27.169206: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED\r\n2020-02-15 11:07:27.169297: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED\r\n2020-02-15 11:07:27.169377: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED\r\n2020-02-15 11:07:27.170036: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED\r\n2020-02-15 11:07:27.170106: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED\r\n2020-02-15 11:07:27.170242: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED\r\n2020-02-15 11:07:27.170302: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED\r\n2020-02-15 11:07:27.170533: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED\r\n2020-02-15 11:07:27.170593: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED\r\n2020-02-15 11:07:27.180263: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7\r\n2020-02-15 11:07:28.554099: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED\r\n2020-02-15 11:07:28.709952: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED\r\n2020-02-15 11:07:28.808561: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED\r\n2020-02-15 11:07:28.820285: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED\r\n2020-02-15 11:07:28.820399: W tensorflow/stream_executor/stream.cc:2041] attempting to perform BLAS operation using StreamExecutor without BLAS support\r\n2020-02-15 11:07:28.820463: W tensorflow/core/common_runtime/base_collective_executor.cc:217] BaseCollectiveExecutor::StartAbort Internal: Blas GEMM launch failed : a.shape=(32, 116032), b.shape=(116032, 256), m=32, n=256, k=116032\r\n```\r\n\r\nThis is the output of `nvidia-smi` **before** calling `model.compile()`:\r\n\r\n```\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 430.50       Driver Version: 430.50       CUDA Version: 10.1     |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  Tesla K80           Off  | 00000000:00:1E.0 Off |                    0 |\r\n| N/A   45C    P0    74W / 149W |      0MiB / 11441MiB |    100%      Default |   <<<--- 0% Memory usage\r\n+-------------------------------+----------------------+----------------------+\r\n\r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|  No running processes found                                                 |   <<<--- nothing running\r\n+-----------------------------------------------------------------------------+\r\n```\r\n\r\nAnd the output of `nvidia-smi` **after** calling `model.compile()` (and immediately before `model.fit()`):\r\n\r\n```\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 430.50       Driver Version: 430.50       CUDA Version: 10.1     |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  Tesla K80           Off  | 00000000:00:1E.0 Off |                    0 |\r\n| N/A   45C    P0    72W / 149W |  10942MiB / 11441MiB |      0%      Default |   <<<--- 96% Memory usage\r\n+-------------------------------+----------------------+----------------------+\r\n\r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|    0      1811      C   /usr/bin/python3                           10929MiB |   <<<--- TF model here\r\n+-----------------------------------------------------------------------------+\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36778", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36778/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36778/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36778/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36778", "id": 565712213, "node_id": "MDU6SXNzdWU1NjU3MTIyMTM=", "number": 36778, "title": "TFTRT Int8 calibrate cost all of memory and Fail", "user": {"login": "double344931987", "id": 11947126, "node_id": "MDQ6VXNlcjExOTQ3MTI2", "avatar_url": "https://avatars3.githubusercontent.com/u/11947126?v=4", "gravatar_id": "", "url": "https://api.github.com/users/double344931987", "html_url": "https://github.com/double344931987", "followers_url": "https://api.github.com/users/double344931987/followers", "following_url": "https://api.github.com/users/double344931987/following{/other_user}", "gists_url": "https://api.github.com/users/double344931987/gists{/gist_id}", "starred_url": "https://api.github.com/users/double344931987/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/double344931987/subscriptions", "organizations_url": "https://api.github.com/users/double344931987/orgs", "repos_url": "https://api.github.com/users/double344931987/repos", "events_url": "https://api.github.com/users/double344931987/events{/privacy}", "received_events_url": "https://api.github.com/users/double344931987/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1754777628, "node_id": "MDU6TGFiZWwxNzU0Nzc3NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu:tensorrt", "name": "comp:gpu:tensorrt", "color": "ea98ba", "default": false, "description": "Issues specific to TensorRT"}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2020-02-15T07:40:28Z", "updated_at": "2020-03-19T02:48:01Z", "closed_at": null, "author_association": "NONE", "body": "**System information** \r\nHardware : i7 + 1660ti \r\nTensorFlow installed from source using bazel\r\nThe tf_env.txt is shown :\r\n\r\n== check python ===================================================\r\npython version: 3.5.2\r\npython branch: \r\npython build version: ('default', 'Oct  8 2019 13:06:37')\r\npython compiler version: GCC 5.4.0 20160609\r\npython implementation: CPython\r\n\r\n\r\n== check os platform ===============================================\r\nos: Linux\r\nos kernel version: #30~18.04.1-Ubuntu SMP Fri Jan 17 06:14:09 UTC 2020\r\nos release version: 5.3.0-28-generic\r\nos platform: Linux-5.3.0-28-generic-x86_64-with-Ubuntu-16.04-xenial\r\nlinux distribution: ('Ubuntu', '16.04', 'xenial')\r\nlinux os distribution: ('Ubuntu', '16.04', 'xenial')\r\nmac version: ('', ('', '', ''), '')\r\nuname: uname_result(system='Linux', node='xuxin', release='5.3.0-28-generic', version='#30~18.04.1-Ubuntu SMP Fri Jan 17 06:14:09 UTC 2020', machine='x86_64', processor='x86_64')\r\narchitecture: ('64bit', 'ELF')\r\nmachine: x86_64\r\n\r\n\r\n== are we in docker =============================================\r\nYes\r\n\r\n== compiler =====================================================\r\nc++ (Ubuntu 5.4.0-6ubuntu1~16.04.12) 5.4.0 20160609\r\nCopyright (C) 2015 Free Software Foundation, Inc.\r\nThis is free software; see the source for copying conditions.  There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n\r\n\r\n== check pips ===================================================\r\nnumpy                1.17.3                \r\nprotobuf             3.10.0                \r\ntensorflow           1.15.0                \r\ntensorflow-estimator 1.15.1                \r\n\r\n== check for virtualenv =========================================\r\nFalse\r\n== env ==========================================================\r\nLD_LIBRARY_PATH is unset\r\nDYLD_LIBRARY_PATH is unset\r\n\r\n== nvidia-smi ===================================================\r\nSat Feb 15 07:29:47 2020       \r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 440.59       Driver Version: 440.59       CUDA Version: 10.2     |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce GTX 166...  Off  | 00000000:01:00.0 Off |                  N/A |\r\n| N/A   41C    P0    28W /  N/A |    346MiB /  5944MiB |     13%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n+-----------------------------------------------------------------------------+\r\n\r\n== cuda libs  ===================================================\r\n/usr/local/lib/python3.5/dist-packages/torch/lib/libcudart-1b201d85.so.10.1\r\n/usr/local/cuda-10.1/targets/x86_64-linux/lib/libcudart.so.10.1.243\r\n/usr/local/cuda-10.1/targets/x86_64-linux/lib/libcudart_static.a\r\n\r\n== tensorflow installed from info ==================\r\nName: tensorflow\r\nVersion: 1.15.0\r\nSummary: TensorFlow is an open source machine learning framework for everyone.\r\nHome-page: https://www.tensorflow.org/\r\nAuthor-email: packages@tensorflow.org\r\nLicense: Apache 2.0\r\nLocation: /usr/local/lib/python3.5/dist-packages\r\nRequired-by: \r\n\r\n== python version  ==============================================\r\n(major, minor, micro, releaselevel, serial)\r\n(2, 7, 12, 'final', 0)\r\n\r\n== bazel version  ===============================================\r\nBuild label: 0.24.1\r\nBuild time: Tue Apr 2 16:29:26 2019 (1554222566)\r\nBuild timestamp: 1554222566\r\nBuild timestamp as int: 1554222566\r\n\r\n**Describe the current behavior**\r\n\r\nI use tftrt module to calibrate int8 model.\r\nI can convert() the model successfully and cost a little memory.\r\nBut, as I do calibrate(), the memory increase crazily and use the whole memory.\r\nI set config as following and send to init TrtGraphConverter:\r\n        config = tf.ConfigProto()\r\n        config.gpu_options.per_process_gpu_memory_fraction = 0.5\r\n        config.gpu_options.allow_growth = True\r\n        config.allow_soft_placement = True\r\n        config.log_device_placement = False\r\n\r\nBut it is useless.\r\nBy the way, I can use my PC to infer the model normally but calibrate always fail. \r\n\r\n\r\n**Code to reproduce the issue**\r\n```\r\n        config = tf.ConfigProto()\r\n        config.gpu_options.per_process_gpu_memory_fraction = 0.5\r\n        config.gpu_options.allow_growth = True\r\n        config.allow_soft_placement = True\r\n        config.log_device_placement = False\r\n\r\n        tftrt_graph = tftrt.TrtGraphConverter(\r\n            input_graph_def=graph.frozen_graph,\r\n            nodes_blacklist=graph.y_name,\r\n            session_config=config,\r\n            max_batch_size=1,\r\n            max_workspace_size_bytes=1 << 32,\r\n            precision_mode='INT8',\r\n            is_dynamic_op=True,\r\n            minimum_segment_size=5)\r\n\r\n      engine_graph = tftrt_graph.convert()\r\n      engine_graph = tftrt_graph.calibrate(\r\n                fetch_names=[x + ':0' for x in graph.y_name],\r\n                num_runs=1,\r\n                feed_dict_fn=feed_dict_fn)\r\n```\r\n\r\n**Other info / logs** \r\n\r\nThe TFTRT output :\r\n2020-02-15 07:03:29.178998: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2020-02-15 07:03:29.179482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: \r\nname: GeForce GTX 1660 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.59\r\npciBusID: 0000:01:00.0\r\n2020-02-15 07:03:29.179549: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1\r\n2020-02-15 07:03:29.179572: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10\r\n2020-02-15 07:03:29.179608: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10\r\n2020-02-15 07:03:29.179642: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10\r\n2020-02-15 07:03:29.179652: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10\r\n2020-02-15 07:03:29.179701: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10\r\n2020-02-15 07:03:29.179715: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7\r\n2020-02-15 07:03:29.179777: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2020-02-15 07:03:29.180161: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2020-02-15 07:03:29.180449: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0\r\n2020-02-15 07:03:29.180472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2020-02-15 07:03:29.180498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 \r\n2020-02-15 07:03:29.180525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N \r\n2020-02-15 07:03:29.180604: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2020-02-15 07:03:29.180926: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero\r\n2020-02-15 07:03:29.181202: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 5214 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1660 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5)\r\n2020-02-15 07:03:30.620789: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:812] Starting calibration thread on device 0, Calibration Resource @ 0x7f1be40085e0\r\n2020-02-15 07:03:30.621001: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libnvinfer.so.6\r\n2020-02-15 07:03:30.621392: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libnvinfer_plugin.so.6\r\n2020-02-15 07:03:36.767786: E tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:41] DefaultLogger ../rtSafe/safeContext.cpp (105) - Cudnn Error in initializeCommonContext: 4 (Could not initialize cudnn, please check cudnn installation.)\r\n2020-02-15 07:03:36.768004: E tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:41] DefaultLogger ../rtSafe/safeContext.cpp (105) - Cudnn Error in initializeCommonContext: 4 (Could not initialize cudnn, please check cudnn installation.)\r\n2020-02-15 07:03:36.768058: E tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:838] Calibration failed: Internal: Failed to build TensorRT engine\r\nterminate called without an active exception\r\nAborted (core dumped)\r\n\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36773", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36773/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36773/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36773/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36773", "id": 565634120, "node_id": "MDExOlB1bGxSZXF1ZXN0Mzc1NjM5Mjk3", "number": 36773, "title": "Support Keras grouped convolutions", "user": {"login": "lgeiger", "id": 13285808, "node_id": "MDQ6VXNlcjEzMjg1ODA4", "avatar_url": "https://avatars1.githubusercontent.com/u/13285808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lgeiger", "html_url": "https://github.com/lgeiger", "followers_url": "https://api.github.com/users/lgeiger/followers", "following_url": "https://api.github.com/users/lgeiger/following{/other_user}", "gists_url": "https://api.github.com/users/lgeiger/gists{/gist_id}", "starred_url": "https://api.github.com/users/lgeiger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lgeiger/subscriptions", "organizations_url": "https://api.github.com/users/lgeiger/orgs", "repos_url": "https://api.github.com/users/lgeiger/repos", "events_url": "https://api.github.com/users/lgeiger/events{/privacy}", "received_events_url": "https://api.github.com/users/lgeiger/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1169365494, "node_id": "MDU6TGFiZWwxMTY5MzY1NDk0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:M", "name": "size:M", "color": "adafea", "default": false, "description": "CL Change Size: Medium"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-02-15T01:08:00Z", "updated_at": "2020-03-16T11:59:49Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36773", "html_url": "https://github.com/tensorflow/tensorflow/pull/36773", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36773.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36773.patch"}, "body": "This PR adds support for grouped convolutions to Keras layers.\r\n\r\nFor a more in-depth discussion see https://github.com/keras-team/governance/pull/16"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36772", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36772/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36772/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36772/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36772", "id": 565630110, "node_id": "MDU6SXNzdWU1NjU2MzAxMTA=", "number": 36772, "title": "Error converting GraphDef to tflite - Check failed: GetOpWithOutput(model, output_array) Specified output array \"'TFLite_Detection_PostProcess'\" is not produced by any op in this graph", "user": {"login": "Jack-Hewson", "id": 57640969, "node_id": "MDQ6VXNlcjU3NjQwOTY5", "avatar_url": "https://avatars3.githubusercontent.com/u/57640969?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jack-Hewson", "html_url": "https://github.com/Jack-Hewson", "followers_url": "https://api.github.com/users/Jack-Hewson/followers", "following_url": "https://api.github.com/users/Jack-Hewson/following{/other_user}", "gists_url": "https://api.github.com/users/Jack-Hewson/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jack-Hewson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jack-Hewson/subscriptions", "organizations_url": "https://api.github.com/users/Jack-Hewson/orgs", "repos_url": "https://api.github.com/users/Jack-Hewson/repos", "events_url": "https://api.github.com/users/Jack-Hewson/events{/privacy}", "received_events_url": "https://api.github.com/users/Jack-Hewson/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-02-15T00:43:33Z", "updated_at": "2020-03-18T21:27:56Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution = Win10\r\n- TensorFlow installed from binary - pip\r\n- TensorFlow version 1.13.1\r\n\r\n\r\n\r\n**Command used to run the converter or code if you\u2019re using the Python API**\r\n\r\n```\r\n# Copy and paste here the exact command\r\ntflite_convert \\\r\n --output_file=/tmp/detect.tflite \\ \r\n --graph_def_file=tflite2/tflite_graph.pb \\ \r\n --input_shapes=1,300,300,3 \\\r\n --input_arrays=image_tensor \\ \r\n--output_arrays='TFLite_Detection_PostProcess','TFLite_Detection_PostProcess:1','TFLite_Detection_PostProcess:2','TFLite_Detection_PostProcess:3'\r\n\r\n**The output from the converter invocation**\r\n\r\n```\r\n# Copy and paste the output here.\r\n(tensorflow1) C:\\tensorflow1\\models\\research\\object_detection>tflite_convert \\ --output_file=/tmp/fuck.tflite \\ --graph_def_file=tflite2/tflite_graph.pb \\ --input_shapes=1,300,300,3 \\ --input_arrays=image_tensor \\ --output_arrays='TFLite_Detection_PostProcess','TFLite_Detection_PostProcess:1','TFLite_Detection_PostProcess:2','TFLite_Detection_PostProcess:3'\r\n2020-02-15 00:33:22.884597: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll\r\n2020-02-15 00:33:24.579223: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library nvcuda.dll\r\n2020-02-15 00:33:24.608227: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties:\r\nname: GeForce RTX 2080 SUPER major: 7 minor: 5 memoryClockRate(GHz): 1.845\r\npciBusID: 0000:2d:00.0\r\n2020-02-15 00:33:24.611885: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll\r\n2020-02-15 00:33:24.616006: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll\r\n2020-02-15 00:33:24.621212: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll\r\n2020-02-15 00:33:24.623686: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll\r\n2020-02-15 00:33:24.628228: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll\r\n2020-02-15 00:33:24.631880: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll\r\n2020-02-15 00:33:24.640338: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll\r\n2020-02-15 00:33:24.642489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0\r\n2020-02-15 00:33:24.644141: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX AVX2\r\n2020-02-15 00:33:24.649750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties:\r\nname: GeForce RTX 2080 SUPER major: 7 minor: 5 memoryClockRate(GHz): 1.845\r\npciBusID: 0000:2d:00.0\r\n2020-02-15 00:33:24.653135: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll\r\n2020-02-15 00:33:24.656487: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll\r\n2020-02-15 00:33:24.658613: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_100.dll\r\n2020-02-15 00:33:24.660695: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_100.dll\r\n2020-02-15 00:33:24.662859: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_100.dll\r\n2020-02-15 00:33:24.665900: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_100.dll\r\n2020-02-15 00:33:24.670329: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll\r\n2020-02-15 00:33:24.672979: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0\r\n2020-02-15 00:33:25.178111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2020-02-15 00:33:25.179912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0\r\n2020-02-15 00:33:25.181515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N\r\n2020-02-15 00:33:25.184222: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6269 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 SUPER, pci bus id: 0000:2d:00.0, compute capability: 7.5)\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\jacks\\Anaconda3\\envs\\tensorflow1\\Scripts\\tflite_convert-script.py\", line 10, in <module>\r\n    sys.exit(main())\r\n  File \"C:\\Users\\jacks\\Anaconda3\\envs\\tensorflow1\\lib\\site-packages\\tensorflow_core\\lite\\python\\tflite_convert.py\", line 515, in main\r\n    app.run(main=run_main, argv=sys.argv[:1])\r\n  File \"C:\\Users\\jacks\\Anaconda3\\envs\\tensorflow1\\lib\\site-packages\\tensorflow_core\\python\\platform\\app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"C:\\Users\\jacks\\Anaconda3\\envs\\tensorflow1\\lib\\site-packages\\absl\\app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"C:\\Users\\jacks\\Anaconda3\\envs\\tensorflow1\\lib\\site-packages\\absl\\app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"C:\\Users\\jacks\\Anaconda3\\envs\\tensorflow1\\lib\\site-packages\\tensorflow_core\\lite\\python\\tflite_convert.py\", line 511, in run_main\r\n    _convert_tf1_model(tflite_flags)\r\n  File \"C:\\Users\\jacks\\Anaconda3\\envs\\tensorflow1\\lib\\site-packages\\tensorflow_core\\lite\\python\\tflite_convert.py\", line 199, in _convert_tf1_model\r\n    output_data = converter.convert()\r\n  File \"C:\\Users\\jacks\\Anaconda3\\envs\\tensorflow1\\lib\\site-packages\\tensorflow_core\\lite\\python\\lite.py\", line 989, in convert\r\n    **converter_kwargs)\r\n  File \"C:\\Users\\jacks\\Anaconda3\\envs\\tensorflow1\\lib\\site-packages\\tensorflow_core\\lite\\python\\convert.py\", line 412, in toco_convert_graph_def\r\n    enable_mlir_converter=enable_mlir_converter)\r\n  File \"C:\\Users\\jacks\\Anaconda3\\envs\\tensorflow1\\lib\\site-packages\\tensorflow_core\\lite\\python\\convert.py\", line 200, in toco_convert_protos\r\n    raise ConverterError(\"See console for info.\\n%s\\n%s\\n\" % (stdout, stderr))\r\ntensorflow.lite.python.convert.ConverterError: See console for info.\r\n2020-02-15 00:33:25.515637: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll\r\n2020-02-15 00:33:27.222702: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: TFLite_Detection_PostProcess\r\n2020-02-15 00:33:27.230047: F tensorflow/lite/toco/tooling_util.cc:935] Check failed: GetOpWithOutput(model, output_array) Specified output array \"'TFLite_Detection_PostProcess'\" is not produced by any op in this graph. Is it a typo? This should not happen. If you trigger this error please send a bug report (with code to reporduce this error), to the TensorFlow Lite team.\r\nFatal Python error: Aborted\r\n\r\nCurrent thread 0x00002c24 (most recent call first):\r\n  File \"C:\\Users\\jacks\\Anaconda3\\envs\\tensorflow1\\lib\\site-packages\\tensorflow_core\\lite\\toco\\python\\toco_from_protos.py\", line 52 in execute\r\n  File \"C:\\Users\\jacks\\Anaconda3\\envs\\tensorflow1\\lib\\site-packages\\absl\\app.py\", line 250 in _run_main\r\n  File \"C:\\Users\\jacks\\Anaconda3\\envs\\tensorflow1\\lib\\site-packages\\absl\\app.py\", line 299 in run\r\n  File \"C:\\Users\\jacks\\Anaconda3\\envs\\tensorflow1\\lib\\site-packages\\tensorflow_core\\python\\platform\\app.py\", line 40 in run\r\n  File \"C:\\Users\\jacks\\Anaconda3\\envs\\tensorflow1\\lib\\site-packages\\tensorflow_core\\lite\\toco\\python\\toco_from_protos.py\", line 89 in main\r\n  File \"C:\\Users\\jacks\\Anaconda3\\envs\\tensorflow1\\Scripts\\toco_from_protos-script.py\", line 10 in <module>\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36771", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36771/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36771/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36771/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36771", "id": 565625975, "node_id": "MDU6SXNzdWU1NjU2MjU5NzU=", "number": 36771, "title": "Building libtensorflow for v2.1.0 fails on mac with unrecognized flag \"-fno-constant-cfstrings\"", "user": {"login": "OneRaynyDay", "id": 7191678, "node_id": "MDQ6VXNlcjcxOTE2Nzg=", "avatar_url": "https://avatars0.githubusercontent.com/u/7191678?v=4", "gravatar_id": "", "url": "https://api.github.com/users/OneRaynyDay", "html_url": "https://github.com/OneRaynyDay", "followers_url": "https://api.github.com/users/OneRaynyDay/followers", "following_url": "https://api.github.com/users/OneRaynyDay/following{/other_user}", "gists_url": "https://api.github.com/users/OneRaynyDay/gists{/gist_id}", "starred_url": "https://api.github.com/users/OneRaynyDay/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/OneRaynyDay/subscriptions", "organizations_url": "https://api.github.com/users/OneRaynyDay/orgs", "repos_url": "https://api.github.com/users/OneRaynyDay/repos", "events_url": "https://api.github.com/users/OneRaynyDay/events{/privacy}", "received_events_url": "https://api.github.com/users/OneRaynyDay/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1205765054, "node_id": "MDU6TGFiZWwxMjA1NzY1MDU0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:macOS", "name": "subtype:macOS", "color": "b619ea", "default": false, "description": "macOS Build/Installation issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-15T00:22:42Z", "updated_at": "2020-02-17T10:08:33Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Mac OSX 10.15.3\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version: 2.1.0 (Version on branch git/r2.1)\r\n- Python version: Python 3.7.4\r\n- Installed using virtualenv? pip? conda?: conda\r\n- Bazel version (if compiling from source): 0.29.1\r\n- GCC/Compiler version (if compiling from source): CC=gcc-8, CXX=g++8, version 8.3.0, \r\n- CUDA/cuDNN version: N/A, not installing with GPU\r\n- GPU model and memory: N/A, not installing with GPU\r\n\r\n\r\n\r\n**Describe the problem**\r\n\r\nAt Airbnb we want to build by source the C++ API for tensorflow so we can integrate it with internal libraries. We want to use the latest C++ API and building for mac is a first step. \r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\nHere are the minimal steps taken to reproduce the issue on my machine:\r\n\r\n```\r\n\u276f echo $PWD\r\n/Users/ray_zhang/home/tensorflow\r\n\u276f CXX=g++-8 CC=gcc-8 ./configure\r\n... (chose all the default options)\r\n\u276f bazel clean --expunge\r\n\u276f BAZEL_USE_CPP_ONLY_TOOLCHAIN=1 bazel build --action_env CC=gcc-8 --action_env CXX=g++-8 //tensorflow:libtensorflow.so\r\n```\r\n\r\nAnd I get the error:\r\n\r\n```\r\nERROR: /private/var/tmp/_bazel_ray_zhang/af5fde86ccd7201c52a3f430d09db563/external/curl/BUILD.bazel:32:1: C++ compilation of rule '@curl//:curl' failed (Exit 1)\r\ngcc-8: error: unrecognized command line option '-fno-constant-cfstrings'; did you mean '-mno-constant-cfstrings'?\r\nTarget //tensorflow:libtensorflow.so failed to build\r\nUse --verbose_failures to see the command lines of failed build steps.\r\nINFO: Elapsed time: 244.628s, Critical Path: 53.75s\r\nINFO: 754 processes: 754 local.\r\nFAILED: Build did NOT complete successfully\r\n```\r\n\r\n\r\n**Any other info / logs**\r\nHere's a larger trace with the WARNING messages shortened(I'm guessing that is redundant):\r\n\r\n```\r\nINFO: Options provided by the client:\r\n  Inherited 'common' options: --isatty=1 --terminal_columns=188\r\nINFO: Reading rc options for 'build' from /Users/ray_zhang/home/tensorflow/.bazelrc:\r\n  'build' options: --apple_platform_type=macos --define framework_shared_object=true --define open_source_build=true --java_toolchain=//third_party/toolchains/java:tf_java_toolchain --host_java_toolchain=//third_party/toolchains/java:tf_java_toolchain --define=use_fast_cpp_protos=true --define=allow_oversize_protos=true --spawn_strategy=standalone --strategy=Genrule=standalone -c opt --cxxopt=-std=c++14 --host_cxxopt=-std=c++14 --announce_rc --define=grpc_no_ares=true --noincompatible_remove_legacy_whole_archive --define=PREFIX=/usr --define=LIBDIR=$(PREFIX)/lib --define=INCLUDEDIR=$(PREFIX)/include --config=v2\r\nINFO: Reading rc options for 'build' from /Users/ray_zhang/home/tensorflow/.tf_configure.bazelrc:\r\n  'build' options: --action_env PYTHON_BIN_PATH=/Users/ray_zhang/anaconda/envs/bh/bin/python --action_env PYTHON_LIB_PATH=/Users/ray_zhang/anaconda/envs/bh/lib/python3.7/site-packages --python_path=/Users/ray_zhang/anaconda/envs/bh/bin/python --config=xla --action_env TF_CONFIGURE_IOS=0\r\nINFO: Found applicable config definition build:v2 in file /Users/ray_zhang/home/tensorflow/.bazelrc: --define=tf_api_version=2 --action_env=TF2_BEHAVIOR=1\r\nINFO: Found applicable config definition build:xla in file /Users/ray_zhang/home/tensorflow/.tf_configure.bazelrc: --define with_xla_support=true\r\nWARNING: /Users/ray_zhang/home/tensorflow/tensorflow/core/BUILD:2174:12: in srcs attribute of cc_library rule //tensorflow/core:lib_internal: please do not import '//tensorflow/core/platform:abi.h' directly. You should either move the file to this package or depend on an appropriate rule there\r\nWARNING: /Users/ray_zhang/home/tensorflow/tensorflow/core/BUILD:2174:12: in srcs attribute of cc_library rule //tensorflow/core:lib_internal: please do not import '//tensorflow/core/platform:byte_order.h' directly. You should either move the file to this package or depend on an appropriate rule there\r\nWARNING: /Users/ray_zhang/home/tensorflow/tensorflow/core/BUILD:2174:12: in srcs attribute of cc_library rule //tensorflow/core:lib_internal: please do not import '//tensorflow/core/platform:context.h' directly. You should either move the file to this package or depend on an appropriate rule there\r\nWARNING: /Users/ray_zhang/home/tensorflow/tensorflow/core/BUILD:2174:12: in srcs attribute of cc_library rule //tensorflow/core:lib_internal: please do not import '//tensorflow/core/platform:cord.h' directly. You should either move the file to this package or depend on an appropriate rule there\r\nWARNING: /Users/ray_zhang/home/tensorflow/tensorflow/core/BUILD:2174:12: in srcs attribute of cc_library rule //tensorflow/core:lib_internal: please do not import '//tensorflow/core/platform:cpu_feature_guard.h' directly. You should either move the file to this package or depend on an appropriate rule there\r\n...\r\n'//tensorflow/core/platform:profile_utils/cpu_utils.cc' directly. You should either move the file to this package or depend on an appropriate rule there\r\nWARNING: /Users/ray_zhang/home/tensorflow/tensorflow/core/BUILD:2367:12: in srcs attribute of cc_library rule //tensorflow/core:jpeg_internal: please do not import '//tensorflow/core/platform:jpeg.h' directly. You should either move the file to this package or depend on an appropriate rule there\r\nWARNING: /Users/ray_zhang/home/tensorflow/tensorflow/core/BUILD:2347:12: in srcs attribute of cc_library rule //tensorflow/core:gif_internal: please do not import '//tensorflow/core/platform:gif.h' directly. You should either move the file to this package or depend on an appropriate rule there\r\nINFO: Analyzed target //tensorflow:libtensorflow.so (165 packages loaded, 15597 targets configured).\r\nINFO: Found 1 target...\r\nINFO: Deleting stale sandbox base /private/var/tmp/_bazel_ray_zhang/af5fde86ccd7201c52a3f430d09db563/sandbox\r\nINFO: From Compiling external/llvm/lib/Support/UnicodeCaseFold.cpp [for host]:\r\nexternal/llvm/lib/Support/UnicodeCaseFold.cpp:8:1: warning: multi-line comment [-Wcomment]\r\n //   utils/unicode-case-fold.py \\\r\n ^\r\nINFO: From Compiling external/llvm/lib/Support/VirtualFileSystem.cpp [for host]:\r\nexternal/llvm/lib/Support/VirtualFileSystem.cpp: In member function 'std::unique_ptr<llvm::vfs::RedirectingFileSystem::Entry> llvm::vfs::RedirectingFileSystemParser::parseEntry(llvm::yaml::Node*, llvm::vfs::RedirectingFileSystem*, bool)':\r\nexternal/llvm/lib/Support/VirtualFileSystem.cpp:1448:5: warning: 'Kind' may be used uninitialized in this function [-Wmaybe-uninitialized]\r\n     switch (Kind) {\r\n     ^~~~~~\r\nINFO: From Compiling external/llvm/lib/MC/XCOFFObjectWriter.cpp [for host]:\r\nexternal/llvm/lib/MC/XCOFFObjectWriter.cpp: In member function 'void {anonymous}::XCOFFObjectWriter::writeSymbolName(const llvm::StringRef&)':\r\nexternal/llvm/lib/MC/XCOFFObjectWriter.cpp:349:17: warning: 'char* strncpy(char*, const char*, size_t)' specified bound 8 equals destination size [-Wstringop-truncation]\r\n     std::strncpy(Name, SymbolName.data(), XCOFF::NameSize);\r\n     ~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nINFO: From Compiling external/llvm/lib/MC/MachObjectWriter.cpp [for host]:\r\nexternal/llvm/lib/MC/MachObjectWriter.cpp: In member function 'void llvm::MachObjectWriter::writeNlist(llvm::MachObjectWriter::MachSymbolData&, const llvm::MCAsmLayout&)':\r\nexternal/llvm/lib/MC/MachObjectWriter.cpp:381:13: warning: 'AliaseeInfo' may be used uninitialized in this function [-Wmaybe-uninitialized]\r\n     Address = AliaseeInfo->StringIndex;\r\n     ~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~\r\nINFO: From Compiling external/llvm/lib/MC/ELFObjectWriter.cpp [for host]:\r\nexternal/llvm/lib/MC/ELFObjectWriter.cpp: In function 'uint64_t {anonymous}::ELFWriter::writeObject(llvm::MCAssembler&, const llvm::MCAsmLayout&)':\r\nexternal/llvm/lib/MC/ELFObjectWriter.cpp:1216:36: warning: 'AddrsigSection' may be used uninitialized in this function [-Wmaybe-uninitialized]\r\n       SectionOffsets[AddrsigSection] = std::make_pair(SecStart, SecEnd);\r\n                                    ^\r\nINFO: From Compiling external/nsync/internal/cv.c [for host]:\r\nexternal/nsync/internal/cv.c: In function 'void nsync::nsync_cv_init(nsync::nsync_cv*)':\r\nexternal/nsync/internal/cv.c:30:36: warning: 'void* memset(void*, int, size_t)' clearing an object of type 'nsync::nsync_cv' {aka 'struct nsync::nsync_cv_s_'} with no trivial copy-assignment; use value-initialization instead [-Wclass-memaccess]\r\n         memset (cv, 0, sizeof (*cv));\r\n                                    ^\r\nIn file included from external/nsync/public/nsync.h:20,\r\n                 from external/nsync/internal/cv.c:19:\r\nexternal/nsync/public/nsync_cv.h:86:16: note: 'nsync::nsync_cv' {aka 'struct nsync::nsync_cv_s_'} declared here\r\n typedef struct nsync_cv_s_ {\r\n                ^~~~~~~~~~~\r\nINFO: From Compiling external/nsync/internal/counter.c [for host]:\r\nexternal/nsync/internal/counter.c: In function 'nsync::nsync_counter_s_* nsync::nsync_counter_new(uint32_t)':\r\nexternal/nsync/internal/counter.c:39:28: warning: 'void* memset(void*, int, size_t)' clearing an object of type 'struct nsync::nsync_counter_s_' with no trivial copy-assignment; use value-initialization instead [-Wclass-memaccess]\r\n   memset (c, 0, sizeof (*c));\r\n                            ^\r\nexternal/nsync/internal/counter.c:29:8: note: 'struct nsync::nsync_counter_s_' declared here\r\n struct nsync_counter_s_ {\r\n        ^~~~~~~~~~~~~~~~\r\nINFO: From Compiling tensorflow/core/platform/numbers.cc:\r\ntensorflow/core/platform/numbers.cc: In instantiation of 'T tensorflow::{anonymous}::locale_independent_strtonum(const char*, const char**) [with T = double]':\r\ntensorflow/core/platform/numbers.cc:197:60:   required from here\r\ntensorflow/core/platform/numbers.cc:65:21: warning: comparison of integer expressions of different signedness: 'int' and 'std::__cxx11::basic_string<char>::size_type' {aka 'long unsigned int'} [-Wsign-compare]\r\n   for (int i = 0; i < special_num_str.length(); ++i) {\r\n                   ~~^~~~~~~~~~~~~~~~~~~~~~~~~~\r\nINFO: From Compiling tensorflow/core/lib/strings/proto_serialization.cc:\r\ntensorflow/core/lib/strings/proto_serialization.cc: In function 'bool tensorflow::SerializeToBufferDeterministic(const google::protobuf::MessageLite&, char*, size_t)':\r\ntensorflow/core/lib/strings/proto_serialization.cc:75:44: warning: comparison of integer expressions of different signedness: 'size_t' {aka 'long unsigned int'} and 'int' [-Wsign-compare]\r\n   return !output_stream.HadError() && size == output_stream.ByteCount();\r\n                                       ~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nINFO: From Compiling external/snappy/snappy-stubs-internal.cc [for host]:\r\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\r\nINFO: From Compiling external/snappy/snappy.cc [for host]:\r\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\r\nINFO: From Compiling external/snappy/snappy-sinksource.cc:\r\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\r\nINFO: From Compiling external/snappy/snappy-stubs-internal.cc:\r\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\r\nINFO: From Compiling external/snappy/snappy.cc:\r\ncc1plus: warning: command line option '-Wno-implicit-function-declaration' is valid for C/ObjC but not for C++\r\nERROR: /private/var/tmp/_bazel_ray_zhang/af5fde86ccd7201c52a3f430d09db563/external/curl/BUILD.bazel:32:1: C++ compilation of rule '@curl//:curl' failed (Exit 1)\r\ngcc-8: error: unrecognized command line option '-fno-constant-cfstrings'; did you mean '-mno-constant-cfstrings'?\r\nTarget //tensorflow:libtensorflow.so failed to build\r\nUse --verbose_failures to see the command lines of failed build steps.\r\nINFO: Elapsed time: 244.628s, Critical Path: 53.75s\r\nINFO: 754 processes: 754 local.\r\nFAILED: Build did NOT complete successfully\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36764", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36764/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36764/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36764/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36764", "id": 565573579, "node_id": "MDU6SXNzdWU1NjU1NzM1Nzk=", "number": 36764, "title": "tf.linalg.svd not supporting tf.half as dtype on Windows CPU with python3.5", "user": {"login": "pkan2", "id": 34614124, "node_id": "MDQ6VXNlcjM0NjE0MTI0", "avatar_url": "https://avatars3.githubusercontent.com/u/34614124?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pkan2", "html_url": "https://github.com/pkan2", "followers_url": "https://api.github.com/users/pkan2/followers", "following_url": "https://api.github.com/users/pkan2/following{/other_user}", "gists_url": "https://api.github.com/users/pkan2/gists{/gist_id}", "starred_url": "https://api.github.com/users/pkan2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pkan2/subscriptions", "organizations_url": "https://api.github.com/users/pkan2/orgs", "repos_url": "https://api.github.com/users/pkan2/repos", "events_url": "https://api.github.com/users/pkan2/events{/privacy}", "received_events_url": "https://api.github.com/users/pkan2/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-02-14T21:52:45Z", "updated_at": "2020-02-21T18:48:18Z", "closed_at": null, "author_association": "NONE", "body": "Hello!\r\n\r\nI am currently writing a test file for an optimizer toward tensorflow_addons. I use tf.linalg.svd function in the test file and I test with the case of using tf.half as dtype. \r\n\r\nThe test can pass the given CI test with Mac CPU python 3.5 and Ubuntu CPU python 3. But for the given CI test on Windows CPU with python3.5, it throws following error message: \r\n\r\n\"\r\nERROR:tensorflow:No OpKernel was registered to support Op 'Svd' used by node Svd (defined at \\\\?\\C:\\Users\\RUNNER~1\\AppData\\Local\\Temp\\Bazel.runfiles_pt5sug_g\\runfiles\\__main__\\tensorflow_addons\\optimizers\\conditional_gradient_test.py:37) with these attrs: [full_matrices=false, compute_uv=true, T=DT_HALF]\r\n\r\nRegistered devices: [CPU]\r\n\r\nRegistered kernels:\r\n\r\n  device='CPU'; T in [DT_FLOAT]\r\n\r\n  device='CPU'; T in [DT_DOUBLE]\r\n\r\n  device='CPU'; T in [DT_COMPLEX64]\r\n\r\n  device='CPU'; T in [DT_COMPLEX128]\r\n\r\n  device='GPU'; T in [DT_FLOAT]\r\n\r\n  device='GPU'; T in [DT_DOUBLE]\r\n\r\n\r\n\r\n\t [[Svd]]\r\n\"\r\n\r\nThe code I am running with is as following:\r\n\"\r\ndef top_singular_vector( m):\r\n        # handle the case where m is a tensor of rank 0 or rank 1.\r\n        n = tf.cond(\r\n            tf.equal(tf.rank(m), 0),\r\n            lambda: tf.expand_dims(tf.expand_dims(m, [0]), [0]),\r\n            lambda: m,\r\n        )\r\n        n = tf.cond(tf.equal(tf.rank(m), 1), lambda: tf.expand_dims(m, [0]), lambda: n,)\r\n        st, ut, vt = tf.linalg.svd(n, full_matrices=False)\r\n        m_size = tf.shape(n)\r\n        ut = tf.reshape(ut[:, 0], [m_size[0], 1])\r\n        vt = tf.reshape(vt[:, 0], [m_size[1], 1])\r\n        st = tf.matmul(ut, tf.transpose(vt))\r\n        # when we return the top singular vector, we have to remove the\r\n        # dimension we have added on\r\n        st = tf.cond(\r\n            tf.equal(tf.rank(m), 0),\r\n            lambda: tf.squeeze(tf.squeeze(st, [0]), [0]),\r\n            lambda: st,\r\n        )\r\n        st = tf.cond(tf.equal(tf.rank(m), 1), lambda: tf.squeeze(st, [0]), lambda: st,)\r\n        return st\r\n\r\ngrads0 = tf.constant([0.1, 0.1], dtype=tf.half)\r\ngrads1 = tf.constant([0.01, 0.01], dtype=tf.half)\r\ntop_singular_vector0 = top_singular_vector(grads0)\r\ntop_singular_vector1 = top_singular_vector(grads1)\r\n\"\r\n\r\nIt will be great if tf.linalg.svd function can have more compatible or similar behavior on dtype over different systems.\r\n\r\nThank you!\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36762", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36762/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36762/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36762/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36762", "id": 565558749, "node_id": "MDExOlB1bGxSZXF1ZXN0Mzc1NTc1NTQ2", "number": 36762, "title": "[ROCm] Updating ROCm CI scripts to include large tests", "user": {"login": "deven-amd", "id": 36858332, "node_id": "MDQ6VXNlcjM2ODU4MzMy", "avatar_url": "https://avatars2.githubusercontent.com/u/36858332?v=4", "gravatar_id": "", "url": "https://api.github.com/users/deven-amd", "html_url": "https://github.com/deven-amd", "followers_url": "https://api.github.com/users/deven-amd/followers", "following_url": "https://api.github.com/users/deven-amd/following{/other_user}", "gists_url": "https://api.github.com/users/deven-amd/gists{/gist_id}", "starred_url": "https://api.github.com/users/deven-amd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/deven-amd/subscriptions", "organizations_url": "https://api.github.com/users/deven-amd/orgs", "repos_url": "https://api.github.com/users/deven-amd/repos", "events_url": "https://api.github.com/users/deven-amd/events{/privacy}", "received_events_url": "https://api.github.com/users/deven-amd/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-02-14T21:13:56Z", "updated_at": "2020-03-13T02:09:50Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36762", "html_url": "https://github.com/tensorflow/tensorflow/pull/36762", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36762.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36762.patch"}, "body": "This PR updates the ROCm CI scripts to include `large` tests.\r\n\r\nOn the ROCm platform, the CI scripts run tests with `sharding` disabled, in order to prevent the same test from running more than one subtest concurrently on the same GPU . Note that tests are still run in parallel (with number of tests in parellel == the number of GPUs available on the testing machine), just not on individual GPUs.\r\n\r\nBecause `sharding` is disabled (and all subtests within a given test execute serially on the GPU), some tests that have a lot of subtests, take much longer to run with the `sharding` disabled. Some of these tests were getting timed out, and need to re-classified as `large` (to raise their timeout limit). \r\n\r\nThere does not seem to be a way to conditionally specify the value of the `size` arg (i.e. `large` for ROCm, but `medium` for everybody else), and hence the change to `large` is unconditional.\r\n\r\n------\r\n\r\n/cc @whchung @chsigg @nvining-work "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36759", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36759/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36759/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36759/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36759", "id": 565506131, "node_id": "MDU6SXNzdWU1NjU1MDYxMzE=", "number": 36759, "title": "posenet negative output scores", "user": {"login": "aselva-eb", "id": 43152159, "node_id": "MDQ6VXNlcjQzMTUyMTU5", "avatar_url": "https://avatars0.githubusercontent.com/u/43152159?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselva-eb", "html_url": "https://github.com/aselva-eb", "followers_url": "https://api.github.com/users/aselva-eb/followers", "following_url": "https://api.github.com/users/aselva-eb/following{/other_user}", "gists_url": "https://api.github.com/users/aselva-eb/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselva-eb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselva-eb/subscriptions", "organizations_url": "https://api.github.com/users/aselva-eb/orgs", "repos_url": "https://api.github.com/users/aselva-eb/repos", "events_url": "https://api.github.com/users/aselva-eb/events{/privacy}", "received_events_url": "https://api.github.com/users/aselva-eb/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "MeghnaNatraj", "id": 8790823, "node_id": "MDQ6VXNlcjg3OTA4MjM=", "avatar_url": "https://avatars0.githubusercontent.com/u/8790823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MeghnaNatraj", "html_url": "https://github.com/MeghnaNatraj", "followers_url": "https://api.github.com/users/MeghnaNatraj/followers", "following_url": "https://api.github.com/users/MeghnaNatraj/following{/other_user}", "gists_url": "https://api.github.com/users/MeghnaNatraj/gists{/gist_id}", "starred_url": "https://api.github.com/users/MeghnaNatraj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MeghnaNatraj/subscriptions", "organizations_url": "https://api.github.com/users/MeghnaNatraj/orgs", "repos_url": "https://api.github.com/users/MeghnaNatraj/repos", "events_url": "https://api.github.com/users/MeghnaNatraj/events{/privacy}", "received_events_url": "https://api.github.com/users/MeghnaNatraj/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MeghnaNatraj", "id": 8790823, "node_id": "MDQ6VXNlcjg3OTA4MjM=", "avatar_url": "https://avatars0.githubusercontent.com/u/8790823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MeghnaNatraj", "html_url": "https://github.com/MeghnaNatraj", "followers_url": "https://api.github.com/users/MeghnaNatraj/followers", "following_url": "https://api.github.com/users/MeghnaNatraj/following{/other_user}", "gists_url": "https://api.github.com/users/MeghnaNatraj/gists{/gist_id}", "starred_url": "https://api.github.com/users/MeghnaNatraj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MeghnaNatraj/subscriptions", "organizations_url": "https://api.github.com/users/MeghnaNatraj/orgs", "repos_url": "https://api.github.com/users/MeghnaNatraj/repos", "events_url": "https://api.github.com/users/MeghnaNatraj/events{/privacy}", "received_events_url": "https://api.github.com/users/MeghnaNatraj/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-02-14T19:11:13Z", "updated_at": "2020-03-02T16:36:52Z", "closed_at": null, "author_association": "NONE", "body": "@tensorflow/micro\r\n\r\n\r\n**Describe the problem**\r\nHello,\r\n\r\nI'm working on a C++ implementation for the posenet model. (using multi_person_mobilenet_v1_075_float.tflite).\r\n\r\nI can't seem to find much documentation on how to interpret the outputs of the model, but I did come across [this medium post](https://medium.com/@prajwalsingh_48273/posenet-for-android-8b6dede9fa2f). My outputs adhere to the dimensions that the article outlines, however, I'm getting negative scores.\r\n\r\nI've also tried with the starter model file from the [Tensorflow Pose estimation page](https://www.tensorflow.org/lite/models/pose_estimation/overview) with similar negative scores.\r\n\r\nMy question is regarding the range of values I can expect for each of these outputs (score, offsets, displacements). \r\n\r\nProbably a better question to ask: Is there updated models and comprehensive documentation somewhere for any pretrained posenet model?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36757", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36757/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36757/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36757/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36757", "id": 565488775, "node_id": "MDU6SXNzdWU1NjU0ODg3NzU=", "number": 36757, "title": "Add more information about eager/graph context for Keras layer.call()", "user": {"login": "qlzh727", "id": 5118881, "node_id": "MDQ6VXNlcjUxMTg4ODE=", "avatar_url": "https://avatars3.githubusercontent.com/u/5118881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qlzh727", "html_url": "https://github.com/qlzh727", "followers_url": "https://api.github.com/users/qlzh727/followers", "following_url": "https://api.github.com/users/qlzh727/following{/other_user}", "gists_url": "https://api.github.com/users/qlzh727/gists{/gist_id}", "starred_url": "https://api.github.com/users/qlzh727/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qlzh727/subscriptions", "organizations_url": "https://api.github.com/users/qlzh727/orgs", "repos_url": "https://api.github.com/users/qlzh727/repos", "events_url": "https://api.github.com/users/qlzh727/events{/privacy}", "received_events_url": "https://api.github.com/users/qlzh727/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-02-14T18:31:52Z", "updated_at": "2020-03-16T15:55:59Z", "closed_at": null, "author_association": "MEMBER", "body": "Thank you for submitting a TensorFlow documentation issue. Per our GitHub\r\npolicy, we only address code/doc bugs, performance issues, feature requests, and\r\nbuild/installation issues on GitHub.\r\n\r\nThe TensorFlow docs are open source! To get involved, read the documentation\r\ncontributor guide: https://www.tensorflow.org/community/contribute/docs\r\n\r\n## URL(s) with the issue:\r\n\r\nhttps://www.tensorflow.org/api_docs/python/tf/keras/layers/Layer#call\r\n\r\n## Description of issue (what needs changing):\r\n\r\n### Clear description\r\n\r\nThis is a key function that user will implement with they custom layer. Currently it is poorly documented, especially w.r.t the execution context of eager/graph. In TF 2.0, we are advocating eager execution by default. However, the call() body in keras is executed with graph context by default unless configured otherwise. It will raise error if user try to add print/debug related to items into the call body, eg print(eager_tensor.numpy()), etc.\r\n\r\nSome related question raised in  https://github.com/tensorflow/tensorflow/issues/27519.\r\n\r\n### Correct links\r\n\r\nYes\r\n\r\n### Parameters defined\r\n\r\nYes\r\n\r\n### Returns defined\r\n\r\nYes\r\n\r\n### Raises listed and defined\r\n\r\nYes\r\n\r\n### Usage example\r\n\r\nNo\r\n\r\n### Request visuals, if applicable\r\n\r\nNo\r\n\r\n### Submit a pull request?\r\nNo\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36756", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36756/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36756/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36756/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36756", "id": 565461060, "node_id": "MDExOlB1bGxSZXF1ZXN0Mzc1NDk1MDk0", "number": 36756, "title": "Update rmsprop.py API docs for TF 2.x", "user": {"login": "8bitmp3", "id": 19637339, "node_id": "MDQ6VXNlcjE5NjM3MzM5", "avatar_url": "https://avatars3.githubusercontent.com/u/19637339?v=4", "gravatar_id": "", "url": "https://api.github.com/users/8bitmp3", "html_url": "https://github.com/8bitmp3", "followers_url": "https://api.github.com/users/8bitmp3/followers", "following_url": "https://api.github.com/users/8bitmp3/following{/other_user}", "gists_url": "https://api.github.com/users/8bitmp3/gists{/gist_id}", "starred_url": "https://api.github.com/users/8bitmp3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/8bitmp3/subscriptions", "organizations_url": "https://api.github.com/users/8bitmp3/orgs", "repos_url": "https://api.github.com/users/8bitmp3/repos", "events_url": "https://api.github.com/users/8bitmp3/events{/privacy}", "received_events_url": "https://api.github.com/users/8bitmp3/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-14T17:29:20Z", "updated_at": "2020-02-20T09:13:37Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36756", "html_url": "https://github.com/tensorflow/tensorflow/pull/36756", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36756.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36756.patch"}, "body": "Hello and TGIF. This PR updates the RMSProp API docs for TF 2.x:\r\n\r\n- Added a new description: sourced from Alex Graves's 2013 [paper](https://arxiv.org/abs/1308.0850) and Hinton's 2012 [lecture](http://www.cs.toronto.edu/~tijmen/csc321/slides/lecture_slides_lec6.pdf). The latter is said to be the first public mention of the optimizer. The description is pretty much word for word, hope that's ok. Feel free to modify it.\r\n- Modified the reference using Alex Graves' reference style from the 2013 [paper](https://arxiv.org/pdf/1308.0850.pdf) that followed the first \"unpublished\" introduction of RMSProp (a.k.a. _rmsprop_) (`T. Tieleman and G. Hinton. Lecture 6.5 - rmsprop:...`).\r\n- Other minor fixes (indentation, colon, etc).\r\n\r\nLet me know if that looks good @lamberta and team. I'm combing through another platform's optimizer API docs, so will be sending you more PRs if I spot anything here\u2014hope that's ok."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36748", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36748/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36748/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36748/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36748", "id": 565271359, "node_id": "MDU6SXNzdWU1NjUyNzEzNTk=", "number": 36748, "title": "Ubuntu 18.04 with RTX 2070 SUPER with tensorflow 1.13, Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERRO", "user": {"login": "Randryn0", "id": 42965043, "node_id": "MDQ6VXNlcjQyOTY1MDQz", "avatar_url": "https://avatars0.githubusercontent.com/u/42965043?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Randryn0", "html_url": "https://github.com/Randryn0", "followers_url": "https://api.github.com/users/Randryn0/followers", "following_url": "https://api.github.com/users/Randryn0/following{/other_user}", "gists_url": "https://api.github.com/users/Randryn0/gists{/gist_id}", "starred_url": "https://api.github.com/users/Randryn0/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Randryn0/subscriptions", "organizations_url": "https://api.github.com/users/Randryn0/orgs", "repos_url": "https://api.github.com/users/Randryn0/repos", "events_url": "https://api.github.com/users/Randryn0/events{/privacy}", "received_events_url": "https://api.github.com/users/Randryn0/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-02-14T11:30:48Z", "updated_at": "2020-02-19T15:03:55Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code : No\r\n- OS: Linux 5.3.0-28 18.04.1-Ubuntu\r\n- TensorFlow installed from pip3\r\n- TensorFlow version: tried 13.1 and 13.2\r\n- Python version: Python 3.6.9\r\n- Bazel: /\r\n- GCC/Compiler: gcc (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0\r\n- CUDA/cuDNN version: CUDA 10.0, cuDNN 7.4.2\r\n- GPU model and memory: GeForce RTX 2070 SUPER, 8GB\r\n\r\n**Describe the current behavior**\r\nI downloaded the [MNIST \"tensorflow without a PhD example\"](https://github.com/GoogleCloudPlatform/tensorflow-without-a-phd) from git and tried to run one of the examples with\r\n`python3 mnist_3.1_convolutional_bigger_dropout.py`\r\nafter downloading tensorflow and tensorflow gpu with\r\n`pip3 install tensorflow==1.13.2 tensorflow-gpu==1.13.2`.\r\n\r\n**Describe the expected behavior**\r\nI have not altered the code in any way and could successfully run it on the CPU. I assumed it would work without problems with the GPU, too, after I installed proprietary NVidia drivers (435) and the CUDA and cuDNN libraries.\r\nThere was a [workaround in a different issue relating to the same problem](https://github.com/tensorflow/tensorflow/issues/24496#issuecomment-464909727) but this did not fix the issue for me.\r\n\r\n**Code to reproduce the issue**\r\nJust clone the repository above and run the code from the \"tensorflow-mnist-tutorial\" directory.\r\n\r\n**Other info / logs**\r\nThis is the output:\r\n```\r\n$ python3 mnist_3.1_convolutional_bigger_dropout.py \r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/dtypes.py:526: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint8 = np.dtype([(\"qint8\", np.int8, 1)])\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/dtypes.py:527: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint8 = np.dtype([(\"quint8\", np.uint8, 1)])\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/dtypes.py:528: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint16 = np.dtype([(\"qint16\", np.int16, 1)])\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/dtypes.py:529: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint16 = np.dtype([(\"quint16\", np.uint16, 1)])\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/dtypes.py:530: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint32 = np.dtype([(\"qint32\", np.int32, 1)])\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/dtypes.py:535: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  np_resource = np.dtype([(\"resource\", np.ubyte, 1)])\r\nINFO:tensorflow:Tensorflow version 1.13.2\r\nTensorflow version 1.13.2\r\n2020-02-14 11:56:04.391977: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x16d9470 executing computations on platform CUDA. Devices:\r\n2020-02-14 11:56:04.392023: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): GeForce RTX 2070 SUPER, Compute Capability 7.5\r\n2020-02-14 11:56:04.412696: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3600105000 Hz\r\n2020-02-14 11:56:04.413472: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x1718880 executing computations on platform Host. Devices:\r\n2020-02-14 11:56:04.413512: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>\r\n2020-02-14 11:56:04.413749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties: \r\nname: GeForce RTX 2070 SUPER major: 7 minor: 5 memoryClockRate(GHz): 1.815\r\npciBusID: 0000:03:00.0\r\ntotalMemory: 7.79GiB freeMemory: 7.56GiB\r\n2020-02-14 11:56:04.413786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0\r\n2020-02-14 11:56:04.414980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2020-02-14 11:56:04.415008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 \r\n2020-02-14 11:56:04.415022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N \r\n2020-02-14 11:56:04.415176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7350 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2070 SUPER, pci bus id: 0000:03:00.0, compute capability: 7.5)\r\n2020-02-14 11:56:08.593018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0\r\n2020-02-14 11:56:08.593064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2020-02-14 11:56:08.593075: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 \r\n2020-02-14 11:56:08.593087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N \r\n2020-02-14 11:56:08.593176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7350 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2070 SUPER, pci bus id: 0000:03:00.0, compute capability: 7.5)\r\nWARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nColocations handled automatically by placer.\r\nWARNING:tensorflow:From mnist_3.1_convolutional_bigger_dropout.py:88: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nPlease use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.\r\nWARNING:tensorflow:From mnist_3.1_convolutional_bigger_dropout.py:95: softmax_cross_entropy_with_logits (from tensorflow.python.ops.nn_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\n\r\nFuture major versions of TensorFlow will allow gradients to flow\r\ninto the labels input on backprop by default.\r\n\r\nSee `tf.nn.softmax_cross_entropy_with_logits_v2`.\r\n\r\n2020-02-14 11:56:10.165980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0\r\n2020-02-14 11:56:10.166030: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2020-02-14 11:56:10.166039: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 \r\n2020-02-14 11:56:10.166049: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N \r\n2020-02-14 11:56:10.166133: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7350 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2070 SUPER, pci bus id: 0000:03:00.0, compute capability: 7.5)\r\n2020-02-14 11:56:10.651240: I tensorflow/stream_executor/dso_loader.cc:152] successfully opened CUDA library libcublas.so.10.0 locally\r\n2020-02-14 11:56:11.534908: E tensorflow/stream_executor/cuda/cuda_dnn.cc:334] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\n2020-02-14 11:56:11.581923: E tensorflow/stream_executor/cuda/cuda_dnn.cc:334] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\nException in Tkinter callback\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py\", line 1334, in _do_call\r\n    return fn(*args)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py\", line 1319, in _run_fn\r\n    options, feed_dict, fetch_list, target_list, run_metadata)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py\", line 1407, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.UnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n         [[{{node Conv2D}}]]\r\n         [[{{node convert_image}}]]\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.6/tkinter/__init__.py\", line 1705, in __call__\r\n    return self.func(*args)\r\n  File \"/usr/lib/python3.6/tkinter/__init__.py\", line 749, in callit\r\n    func(*args)\r\n  File \"/usr/lib/python3/dist-packages/matplotlib/backends/backend_tkagg.py\", line 95, in _on_timer\r\n    TimerBase._on_timer(self)\r\n  File \"/usr/lib/python3/dist-packages/matplotlib/backend_bases.py\", line 1383, in _on_timer\r\n    ret = func(*args, **kwargs)\r\n  File \"/usr/lib/python3/dist-packages/matplotlib/animation.py\", line 1542, in _step\r\n    still_going = Animation._step(self, *args)\r\n  File \"/usr/lib/python3/dist-packages/matplotlib/animation.py\", line 1277, in _step\r\n    self._draw_next_frame(framedata, self._blit)\r\n  File \"/usr/lib/python3/dist-packages/matplotlib/animation.py\", line 1296, in _draw_next_frame\r\n    self._draw_frame(framedata)\r\n  File \"/usr/lib/python3/dist-packages/matplotlib/animation.py\", line 1814, in _draw_frame\r\n    self._drawn_artists = self._func(framedata, *self._args)\r\n  File \"/home/myuser/repository/tensorflow-without-a-phd/tensorflow-mnist-tutorial/tensorflowvisu.py\", line 364, in animate_step\r\n    compute_step(n, request_test_data_update, request_data_update)\r\n  File \"mnist_3.1_convolutional_bigger_dropout.py\", line 131, in training_step\r\n    feed_dict={X: batch_X, Y_: batch_Y, pkeep: 1.0, step: i})\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py\", line 929, in run\r\n    run_metadata_ptr)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py\", line 1152, in _run\r\n    feed_dict_tensor, options, run_metadata)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py\", line 1328, in _do_run\r\n    run_metadata)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/client/session.py\", line 1348, in _do_call\r\n    raise type(e)(node_def, op, message)\r\ntensorflow.python.framework.errors_impl.UnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n         [[node Conv2D (defined at mnist_3.1_convolutional_bigger_dropout.py:78) ]]\r\n         [[node convert_image (defined at /home/myuser/repository/tensorflow-without-a-phd/tensorflow-mnist-tutorial/tensorflowvisu.py:62) ]]\r\n\r\nCaused by op 'Conv2D', defined at:\r\n  File \"mnist_3.1_convolutional_bigger_dropout.py\", line 78, in <module>\r\n    Y1 = tf.nn.relu(tf.nn.conv2d(X, W1, strides=[1, stride, stride, 1], padding='SAME') + B1)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/gen_nn_ops.py\", line 1026, in conv2d\r\n    data_format=data_format, dilations=dilations, name=name)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/op_def_library.py\", line 788, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/util/deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/ops.py\", line 3300, in create_op\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/ops.py\", line 1801, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n\r\nUnknownError (see above for traceback): Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n         [[node Conv2D (defined at mnist_3.1_convolutional_bigger_dropout.py:78) ]]\r\n         [[node convert_image (defined at /home/myuser/repository/tensorflow-without-a-phd/tensorflow-mnist-tutorial/tensorflowvisu.py:62) ]]\r\n```\r\n\r\nBy the way, there was a helpful table showing which tensorflow version required what python version, gcc compiler, bazel version and cuDNN/CUDA version. What happened to that?\r\n\r\nCheers"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36747", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36747/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36747/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36747/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36747", "id": 565259688, "node_id": "MDExOlB1bGxSZXF1ZXN0Mzc1MzM1MDMy", "number": 36747, "title": "Micro: Return error if tensor allocation fails.", "user": {"login": "jvistrand", "id": 49676198, "node_id": "MDQ6VXNlcjQ5Njc2MTk4", "avatar_url": "https://avatars2.githubusercontent.com/u/49676198?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvistrand", "html_url": "https://github.com/jvistrand", "followers_url": "https://api.github.com/users/jvistrand/followers", "following_url": "https://api.github.com/users/jvistrand/following{/other_user}", "gists_url": "https://api.github.com/users/jvistrand/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvistrand/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvistrand/subscriptions", "organizations_url": "https://api.github.com/users/jvistrand/orgs", "repos_url": "https://api.github.com/users/jvistrand/repos", "events_url": "https://api.github.com/users/jvistrand/events{/privacy}", "received_events_url": "https://api.github.com/users/jvistrand/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 987666414, "node_id": "MDU6TGFiZWw5ODc2NjY0MTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/ready%20to%20pull", "name": "ready to pull", "color": "2cd643", "default": false, "description": ""}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-02-14T11:11:27Z", "updated_at": "2020-03-19T12:10:19Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36747", "html_url": "https://github.com/tensorflow/tensorflow/pull/36747", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36747.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36747.patch"}, "body": ""}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36740", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36740/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36740/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36740/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36740", "id": 565106888, "node_id": "MDU6SXNzdWU1NjUxMDY4ODg=", "number": 36740, "title": "Image Classification pretrained model breaks for batch size 1 with BaseCollectiveExecutor::StartAbort error", "user": {"login": "mankeyboy", "id": 6156303, "node_id": "MDQ6VXNlcjYxNTYzMDM=", "avatar_url": "https://avatars3.githubusercontent.com/u/6156303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mankeyboy", "html_url": "https://github.com/mankeyboy", "followers_url": "https://api.github.com/users/mankeyboy/followers", "following_url": "https://api.github.com/users/mankeyboy/following{/other_user}", "gists_url": "https://api.github.com/users/mankeyboy/gists{/gist_id}", "starred_url": "https://api.github.com/users/mankeyboy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mankeyboy/subscriptions", "organizations_url": "https://api.github.com/users/mankeyboy/orgs", "repos_url": "https://api.github.com/users/mankeyboy/repos", "events_url": "https://api.github.com/users/mankeyboy/events{/privacy}", "received_events_url": "https://api.github.com/users/mankeyboy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1754777628, "node_id": "MDU6TGFiZWwxNzU0Nzc3NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu:tensorrt", "name": "comp:gpu:tensorrt", "color": "ea98ba", "default": false, "description": "Issues specific to TensorRT"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-02-14T05:03:14Z", "updated_at": "2020-02-26T01:56:42Z", "closed_at": null, "author_association": "NONE", "body": "**System information** \r\n- Have I written custom code (as opposed to using a stock\r\nexample script provided in TensorFlow): No, code used from https://github.com/tensorflow/tensorrt/tftrt/examples/image-classification\r\n- OS Platform and Distribution (e.g.,\r\nLinux Ubuntu 16.04): RHEL 7.6\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if\r\nthe issue happens on mobile device: \r\n- TensorFlow installed from (source or\r\nbinary): Binary\r\n- TensorFlow version (use command below): 2.1\r\n- Python version: - Bazel\r\nversion (if compiling from source): \r\n- GCC/Compiler version (if compiling from\r\nsource): 7.3.0\r\n- CUDA/cuDNN version: 10.2/7.6.5\r\n- GPU model and memory: Tesla T4\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nRelated issue: https://github.com/tensorflow/tensorrt/issues/169: Link: https://github.com/tensorflow/tensorrt/issues/169#issuecomment-572383212 \r\nThis example uses a frozen graph that was downloaded from here: http://download.tensorflow.org/models/official/resnet_v1_imagenet_savedmodel.tar.gz\r\n\r\nThis issue happens for synthetic as well as a validation runs. I was making my runs using this call:\r\n```\r\npython image_classification.py --input_saved_model_dir data/resnet_v1_50/1523293981 --data_dir /home/mayroy13/Mayank/Mayank/test/imagenet --calib_data_dir /home/mayroy13/Mayank/Mayank/test/imagenet --minimum_segment_size 3 --output_saved_model_dir trt_engine --batch_size 1 --use_trt --num_iterations 100 --precision FP16 --mode validation --max_workspace_size $((2**32))\r\n```\r\nAnd it fails with the following error:\r\n```\r\nBenchmark arguments:\r\n  batch_size: 1\r\n  calib_data_dir: /home/mayroy13/Mayank/Mayank/test/imagenet\r\n  data_dir: /home/mayroy13/Mayank/Mayank/test/imagenet\r\n  display_every: 100\r\n  gpu_mem_cap: 0\r\n  input_saved_model_dir: data/resnet_v1_50/1523293981\r\n  input_size: 224\r\n  max_workspace_size: 4294967296\r\n  minimum_segment_size: 3\r\n  mode: validation\r\n  num_calib_inputs: 50\r\n  num_classes: 1001\r\n  num_iterations: 100\r\n  num_warmup_iterations: 50\r\n  optimize_offline: False\r\n  output_saved_model_dir: trt_engine\r\n  precision: FP16\r\n  preprocess_method: vgg\r\n  target_duration: None\r\n  use_synthetic: False\r\n  use_trt: True\r\nTensorRT Conversion Params:\r\n  is_dynamic_op: True\r\n  max_batch_size: 1\r\n  max_workspace_size_bytes: 4294967296\r\n  maximum_cached_engines: 100\r\n  minimum_segment_size: 3\r\n  precision_mode: FP16\r\n  rewriter_config_template: None\r\n  use_calibration: False\r\nConversion times:\r\n  conversion: 40.5s\r\n2020-02-13 22:40:45.510560: W tensorflow/core/common_runtime/base_collective_executor.cc:217] BaseCollectiveExecutor::StartAbort Invalid argument: Number of ways to split should evenly divide the split dimension, but got split_dim 0 (size = 1) and num_split 2\r\n         [[{{node PartitionedCall/split_inputs/split}}]]\r\n2020-02-13 22:40:45.510560: W tensorflow/core/common_runtime/base_collective_executor.cc:217] BaseCollectiveExecutor::StartAbort Invalid argument: Number of ways to split should evenly divide the split dimension, but got split_dim 0 (size = 1) and num_split 2\r\n         [[{{node PartitionedCall/split_inputs/split}}]]\r\n         [[PartitionedCall/split_inputs/split/_2]]\r\n2020-02-13 22:40:45.511446: W tensorflow/core/common_runtime/base_collective_executor.cc:217] BaseCollectiveExecutor::StartAbort Invalid argument: Number of ways to split should evenly divide the split dimension, but got split_dim 0 (size = 1) and num_split 2\r\n         [[{{node PartitionedCall/split_inputs/split}}]]\r\n         [[PartitionedCall/TRTEngineOp_0/_6]]\r\nTraceback (most recent call last):\r\n  File \"image_classification.py\", line 464, in <module>\r\n    target_duration=args.target_duration)\r\n  File \"image_classification.py\", line 231, in run_inference\r\n    batch_preds = graph_func(batch_images)[0].numpy()\r\n  File \"/home/mayroy13/anaconda3/envs/wml17/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 1551, in __call__\r\n    return self._call_impl(args, kwargs)\r\n  File \"/home/mayroy13/anaconda3/envs/wml17/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 1591, in _call_impl\r\n    return self._call_flat(args, self.captured_inputs, cancellation_manager)\r\n  File \"/home/mayroy13/anaconda3/envs/wml17/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 1692, in _call_flat\r\n    ctx, args, cancellation_manager=cancellation_manager))\r\n  File \"/home/mayroy13/anaconda3/envs/wml17/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 545, in call\r\n    ctx=ctx)\r\n  File \"/home/mayroy13/anaconda3/envs/wml17/lib/python3.7/site-packages/tensorflow_core/python/eager/execute.py\", line 67, in quick_execute\r\n    six.raise_from(core._status_to_exception(e.code, message), None)\r\n  File \"<string>\", line 3, in raise_from\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.\r\n  (0) Invalid argument:  Number of ways to split should evenly divide the split dimension, but got split_dim 0 (size = 1) and num_split 2\r\n         [[node PartitionedCall/split_inputs/split (defined at image_classification.py:134) ]]\r\n         [[PartitionedCall/split_inputs/split/_2]]\r\n  (1) Invalid argument:  Number of ways to split should evenly divide the split dimension, but got split_dim 0 (size = 1) and num_split 2\r\n         [[node PartitionedCall/split_inputs/split (defined at image_classification.py:134) ]]\r\n0 successful operations.\r\n1 derived errors ignored. [Op:__inference_pruned_25839]\r\n\r\nFunction call stack:\r\npruned -> pruned\r\n```\r\n**Describe the expected behavior**\r\nThe expected behaviour would be for the code to complete and print metrics for the run.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36734", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36734/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36734/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36734/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36734", "id": 564884337, "node_id": "MDU6SXNzdWU1NjQ4ODQzMzc=", "number": 36734, "title": "AttributeError: 'BatchGen' object has no attribute 'shape'", "user": {"login": "etetteh", "id": 28512232, "node_id": "MDQ6VXNlcjI4NTEyMjMy", "avatar_url": "https://avatars3.githubusercontent.com/u/28512232?v=4", "gravatar_id": "", "url": "https://api.github.com/users/etetteh", "html_url": "https://github.com/etetteh", "followers_url": "https://api.github.com/users/etetteh/followers", "following_url": "https://api.github.com/users/etetteh/following{/other_user}", "gists_url": "https://api.github.com/users/etetteh/gists{/gist_id}", "starred_url": "https://api.github.com/users/etetteh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/etetteh/subscriptions", "organizations_url": "https://api.github.com/users/etetteh/orgs", "repos_url": "https://api.github.com/users/etetteh/repos", "events_url": "https://api.github.com/users/etetteh/events{/privacy}", "received_events_url": "https://api.github.com/users/etetteh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2020-02-13T18:53:58Z", "updated_at": "2020-03-17T06:50:48Z", "closed_at": null, "author_association": "NONE", "body": "I am using TensorFlow version 1.15 for a project. I have converted a BioBert pre-trained model into a Keras layer following the code [here](https://towardsdatascience.com/fine-tuning-bert-with-keras-and-tf-module-ed24ea91cff2). However, when I run my code, I get the following error:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/jupyter-belona/.conda/envs/mimic-proj/lib/python3.7/runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"/home/jupyter-belona/.conda/envs/mimic-proj/lib/python3.7/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/home/jupyter-belona/Untitled_Folder/deep-learning-clinical-forecast/mimic3newmodels/decompensation/main.py\", line\r\n152, in <module>\r\n    verbose=args.verbose)\r\n  File \"/home/jupyter-belona/.conda/envs/mimic-proj/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/trainin\r\ng.py\", line 1296, in fit_generator\r\n    steps_name='steps_per_epoch')\r\n  File \"/home/jupyter-belona/.conda/envs/mimic-proj/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/trainin\r\ng_generator.py\", line 144, in model_iteration\r\n    shuffle=shuffle)\r\n  File \"/home/jupyter-belona/.conda/envs/mimic-proj/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/trainin\r\ng_generator.py\", line 477, in convert_to_generator_like\r\n    **num_samples = int(nest.flatten(data)[0].shape[0])**\r\nAttributeError: 'BatchGen' object has no attribute 'shape'\r\n```\r\nPlease, how do I fix this error? I really need your help."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36724", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36724/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36724/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36724/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36724", "id": 564529215, "node_id": "MDU6SXNzdWU1NjQ1MjkyMTU=", "number": 36724, "title": "Bug for TF2.x + TensorRT(7) failing when minimum_segment_size=2", "user": {"login": "mankeyboy", "id": 6156303, "node_id": "MDQ6VXNlcjYxNTYzMDM=", "avatar_url": "https://avatars3.githubusercontent.com/u/6156303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mankeyboy", "html_url": "https://github.com/mankeyboy", "followers_url": "https://api.github.com/users/mankeyboy/followers", "following_url": "https://api.github.com/users/mankeyboy/following{/other_user}", "gists_url": "https://api.github.com/users/mankeyboy/gists{/gist_id}", "starred_url": "https://api.github.com/users/mankeyboy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mankeyboy/subscriptions", "organizations_url": "https://api.github.com/users/mankeyboy/orgs", "repos_url": "https://api.github.com/users/mankeyboy/repos", "events_url": "https://api.github.com/users/mankeyboy/events{/privacy}", "received_events_url": "https://api.github.com/users/mankeyboy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1754777628, "node_id": "MDU6TGFiZWwxNzU0Nzc3NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu:tensorrt", "name": "comp:gpu:tensorrt", "color": "ea98ba", "default": false, "description": "Issues specific to TensorRT"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "bixia1", "id": 35820639, "node_id": "MDQ6VXNlcjM1ODIwNjM5", "avatar_url": "https://avatars1.githubusercontent.com/u/35820639?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bixia1", "html_url": "https://github.com/bixia1", "followers_url": "https://api.github.com/users/bixia1/followers", "following_url": "https://api.github.com/users/bixia1/following{/other_user}", "gists_url": "https://api.github.com/users/bixia1/gists{/gist_id}", "starred_url": "https://api.github.com/users/bixia1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bixia1/subscriptions", "organizations_url": "https://api.github.com/users/bixia1/orgs", "repos_url": "https://api.github.com/users/bixia1/repos", "events_url": "https://api.github.com/users/bixia1/events{/privacy}", "received_events_url": "https://api.github.com/users/bixia1/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "bixia1", "id": 35820639, "node_id": "MDQ6VXNlcjM1ODIwNjM5", "avatar_url": "https://avatars1.githubusercontent.com/u/35820639?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bixia1", "html_url": "https://github.com/bixia1", "followers_url": "https://api.github.com/users/bixia1/followers", "following_url": "https://api.github.com/users/bixia1/following{/other_user}", "gists_url": "https://api.github.com/users/bixia1/gists{/gist_id}", "starred_url": "https://api.github.com/users/bixia1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bixia1/subscriptions", "organizations_url": "https://api.github.com/users/bixia1/orgs", "repos_url": "https://api.github.com/users/bixia1/repos", "events_url": "https://api.github.com/users/bixia1/events{/privacy}", "received_events_url": "https://api.github.com/users/bixia1/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-02-13T08:52:19Z", "updated_at": "2020-02-26T08:57:53Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No, code used from https://github.com/tensorflow/tensorrt/blob/master/tftrt/examples/object_detection/object_detection.py and modified to remove logical errors\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: RHEL 7.6\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**: \r\n- **TensorFlow version (use command below)**: 2.1.0\r\n- **Python version**: 3.7.6\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**: 7.3.0\r\n- **CUDA/cuDNN version**: 10.2/7.6.5\r\n- **GPU model and memory**: Tesla T4\r\n- **Exact command to reproduce**: python object_detection.py  --input_saved_model_dir models/ssd_inception_v2_coco_2018_01_28/saved_model --output_saved_model_dir trt_engine --data_dir coco/val2017  --annotation_path coco/annotations/instances_val2017.json --input_size 640 --batch_size 1 --num_warmup_iterations 10  --minimum_segment_size 2 --num_iterations 20 --use_trt --precision FP16\r\n\r\nYou can collect some of this information using our environment capture script:\r\n\r\nhttps://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh\r\n\r\nYou can obtain the TensorFlow version with:\r\n\r\n```bash\r\npython -c \"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"\r\n```\r\n\r\n### Describe the problem\r\nRelated issue: https://github.com/tensorflow/tensorrt/issues/178\r\nWhen minimum_segment_size is set to 2 for TensorRT conversion, the code fails with this assertion error and the error log suggests this is a Tensorflow issue.\r\n```\r\nBenchmark arguments:\r\n  annotation_path: coco/annotations/instances_val2017.json\r\n  batch_size: 1\r\n  calib_data_dir: None\r\n  data_dir: coco/val2017\r\n  display_every: 100\r\n  gpu_mem_cap: 0\r\n  input_saved_model_dir: models/ssd_inception_v2_coco_2018_01_28/saved_model\r\n  input_size: 640\r\n  max_workspace_size: 1073741824\r\n  minimum_segment_size: 2\r\n  mode: validation\r\n  num_calib_inputs: 128\r\n  num_iterations: 20\r\n  num_warmup_iterations: 10\r\n  optimize_offline: False\r\n  output_saved_model_dir: trt_engine\r\n  precision: FP16\r\n  target_duration: None\r\n  use_synthetic: False\r\n  use_trt: True\r\nTensorRT Conversion Params:\r\n  is_dynamic_op: True\r\n  max_batch_size: 1\r\n  max_workspace_size_bytes: 1073741824\r\n  maximum_cached_engines: 1\r\n  minimum_segment_size: 2\r\n  precision_mode: FP16\r\n  rewriter_config_template: None\r\n  use_calibration: False\r\nConversion times:\r\n  conversion: 51.9s\r\nloading annotations into memory...\r\nDone (t=0.96s)\r\ncreating index...\r\nindex created!\r\n2020-02-13 02:32:55.475297: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/Preprocessor/map/while/ResizeImage/TRTEngineOp_293 with input shapes: [[1,640,640,3]]\r\n2020-02-13 02:32:55.475382: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libnvinfer.so.7\r\n2020-02-13 02:32:55.476308: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libnvinfer_plugin.so.7\r\n2020-02-13 02:32:56.821045: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:32:56.821587: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/TRTEngineOp_0 with input shapes: [[1,300,300,3]]\r\n2020-02-13 02:33:40.565597: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.568191: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/TRTEngineOp_292 with input shapes: [[1,1083,91], [1,600,91], [1,150,91], [1,54,91], [1,24,91], [1,6,91]]\r\n2020-02-13 02:33:40.572484: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/MultipleGridAnchorGenerator/TRTEngineOp_19 with input shapes: [[6,2]]\r\n2020-02-13 02:33:40.633713: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.633784: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/MultipleGridAnchorGenerator/TRTEngineOp_20 with input shapes: [[6,2]]\r\n2020-02-13 02:33:40.662646: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.662798: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/TRTEngineOp_294 with input shapes: [[1,1083,1,4], [1,600,1,4], [1,150,1,4], [1,54,1,4], [1,24,1,4], [1,6,1,4]]\r\n2020-02-13 02:33:40.670319: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.670384: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/MultipleGridAnchorGenerator/TRTEngineOp_9 with input shapes: [[1083,2]]\r\n2020-02-13 02:33:40.670419: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/MultipleGridAnchorGenerator/TRTEngineOp_8 with input shapes: [[6,2], [6,2]]\r\n2020-02-13 02:33:40.711256: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.720622: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.720687: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/MultipleGridAnchorGenerator/TRTEngineOp_10 with input shapes: [[1083,2]]\r\n2020-02-13 02:33:40.726760: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.750769: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.750833: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/MultipleGridAnchorGenerator/TRTEngineOp_11 with input shapes: [[600,2]]\r\n2020-02-13 02:33:40.750850: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/MultipleGridAnchorGenerator/TRTEngineOp_3 with input shapes: [[1083,2], [1083,2]]\r\n2020-02-13 02:33:40.774449: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.782585: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.782647: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/MultipleGridAnchorGenerator/TRTEngineOp_12 with input shapes: [[600,2]]\r\n2020-02-13 02:33:40.808488: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.808552: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/MultipleGridAnchorGenerator/TRTEngineOp_13 with input shapes: [[150,2]]\r\n2020-02-13 02:33:40.808570: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/MultipleGridAnchorGenerator/TRTEngineOp_4 with input shapes: [[600,2], [600,2]]\r\n2020-02-13 02:33:40.831022: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.840426: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.840488: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/MultipleGridAnchorGenerator/TRTEngineOp_14 with input shapes: [[150,2]]\r\n2020-02-13 02:33:40.866507: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.866570: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/MultipleGridAnchorGenerator/TRTEngineOp_15 with input shapes: [[54,2]]\r\n2020-02-13 02:33:40.866587: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/MultipleGridAnchorGenerator/TRTEngineOp_5 with input shapes: [[150,2], [150,2]]\r\n2020-02-13 02:33:40.890943: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.899113: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.899176: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/MultipleGridAnchorGenerator/TRTEngineOp_16 with input shapes: [[54,2]]\r\n2020-02-13 02:33:40.925454: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.925518: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/MultipleGridAnchorGenerator/TRTEngineOp_17 with input shapes: [[24,2]]\r\n2020-02-13 02:33:40.925538: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/MultipleGridAnchorGenerator/TRTEngineOp_6 with input shapes: [[54,2], [54,2]]\r\n2020-02-13 02:33:40.950457: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.958686: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.958751: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/MultipleGridAnchorGenerator/TRTEngineOp_18 with input shapes: [[24,2]]\r\n2020-02-13 02:33:40.984527: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.984605: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/MultipleGridAnchorGenerator/TRTEngineOp_7 with input shapes: [[24,2], [24,2]]\r\n2020-02-13 02:33:40.998919: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:40.999116: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/TRTEngineOp_2 with input shapes: [[1917], [1917], [1917], [1917]]\r\n2020-02-13 02:33:41.113058: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:41.113152: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/TRTEngineOp_1 with input shapes: [[1917], [1917], [1917], [1917]]\r\n2020-02-13 02:33:41.229240: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:41.229401: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/Postprocessor/TRTEngineOp_291 with input shapes: [[1,1917,4]]\r\n2020-02-13 02:33:41.249654: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:41.252100: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/Postprocessor/BatchMultiClassNonMaxSuppression/map/while/MultiClassNonMaxSuppression/TRTEngineOp_171 with input shapes: [[1917,1]]\r\n2020-02-13 02:33:41.272919: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:41.272990: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/Postprocessor/BatchMultiClassNonMaxSuppression/map/while/MultiClassNonMaxSuppression/TRTEngineOp_175 with input shapes: [[1917,1]]\r\n2020-02-13 02:33:41.275116: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/Postprocessor/BatchMultiClassNonMaxSuppression/map/while/MultiClassNonMaxSuppression/ClipToWindow_63/TRTEngineOp_81 with input shapes: [[0,4]]\r\n2020-02-13 02:33:41.276148: E tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:42] DefaultLogger Parameter check failed at: ../builder/builder.cpp::setMaxBatchSize::135, condition: batchSize > 0 && batchSize <= MAX_BATCH_SIZE\r\n2020-02-13 02:33:41.304032: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:41.304124: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/Postprocessor/BatchMultiClassNonMaxSuppression/map/while/MultiClassNonMaxSuppression/TRTEngineOp_176 with input shapes: [[1917,1]]\r\n2020-02-13 02:33:41.316747: W tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:38] DefaultLogger Current optimization profile is: 0. Please ensure there are no enqueued operations pending in this context prior to switching profiles\r\n2020-02-13 02:33:41.316786: E tensorflow/compiler/tf2tensorrt/utils/trt_logger.cc:42] DefaultLogger Parameter check failed at: engine.cpp::enqueue::292, condition: batchSize > 0 && batchSize <= mEngine.getMaxBatchSize(). Note: Batch size was: 0, but engine max batch size was: 1\r\n2020-02-13 02:33:41.316800: W tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:635] Failed to enqueue batch for TRT engine: StatefulPartitionedCall/Postprocessor/BatchMultiClassNonMaxSuppression/map/while/MultiClassNonMaxSuppression/ClipToWindow_63/TRTEngineOp_81\r\n2020-02-13 02:33:41.316816: W tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:506] Failed to execute engine, retrying with native segment for StatefulPartitionedCall/Postprocessor/BatchMultiClassNonMaxSuppression/map/while/MultiClassNonMaxSuppression/ClipToWindow_63/TRTEngineOp_81\r\n2020-02-13 02:33:41.317449: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for StatefulPartitionedCall/Postprocessor/BatchMultiClassNonMaxSuppression/map/while/MultiClassNonMaxSuppression/ClipToWindow_67/TRTEngineOp_85 with input shapes: [[0,4]]\r\n2020-02-13 02:33:41.317620: F tensorflow/core/framework/op_kernel.cc:898] Check failed: mutable_output(index) == nullptr (0x7ff68c02e790 vs. nullptr)\r\nAborted\r\n```\r\n### Source code / logs\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36723", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36723/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36723/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36723/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36723", "id": 564457673, "node_id": "MDU6SXNzdWU1NjQ0NTc2NzM=", "number": 36723, "title": "Allow TrtGraphConverterV2 to accept Frozen Graph input as well as saved_model", "user": {"login": "mankeyboy", "id": 6156303, "node_id": "MDQ6VXNlcjYxNTYzMDM=", "avatar_url": "https://avatars3.githubusercontent.com/u/6156303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mankeyboy", "html_url": "https://github.com/mankeyboy", "followers_url": "https://api.github.com/users/mankeyboy/followers", "following_url": "https://api.github.com/users/mankeyboy/following{/other_user}", "gists_url": "https://api.github.com/users/mankeyboy/gists{/gist_id}", "starred_url": "https://api.github.com/users/mankeyboy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mankeyboy/subscriptions", "organizations_url": "https://api.github.com/users/mankeyboy/orgs", "repos_url": "https://api.github.com/users/mankeyboy/repos", "events_url": "https://api.github.com/users/mankeyboy/events{/privacy}", "received_events_url": "https://api.github.com/users/mankeyboy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 1754777628, "node_id": "MDU6TGFiZWwxNzU0Nzc3NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu:tensorrt", "name": "comp:gpu:tensorrt", "color": "ea98ba", "default": false, "description": "Issues specific to TensorRT"}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "bixia1", "id": 35820639, "node_id": "MDQ6VXNlcjM1ODIwNjM5", "avatar_url": "https://avatars1.githubusercontent.com/u/35820639?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bixia1", "html_url": "https://github.com/bixia1", "followers_url": "https://api.github.com/users/bixia1/followers", "following_url": "https://api.github.com/users/bixia1/following{/other_user}", "gists_url": "https://api.github.com/users/bixia1/gists{/gist_id}", "starred_url": "https://api.github.com/users/bixia1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bixia1/subscriptions", "organizations_url": "https://api.github.com/users/bixia1/orgs", "repos_url": "https://api.github.com/users/bixia1/repos", "events_url": "https://api.github.com/users/bixia1/events{/privacy}", "received_events_url": "https://api.github.com/users/bixia1/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "bixia1", "id": 35820639, "node_id": "MDQ6VXNlcjM1ODIwNjM5", "avatar_url": "https://avatars1.githubusercontent.com/u/35820639?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bixia1", "html_url": "https://github.com/bixia1", "followers_url": "https://api.github.com/users/bixia1/followers", "following_url": "https://api.github.com/users/bixia1/following{/other_user}", "gists_url": "https://api.github.com/users/bixia1/gists{/gist_id}", "starred_url": "https://api.github.com/users/bixia1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bixia1/subscriptions", "organizations_url": "https://api.github.com/users/bixia1/orgs", "repos_url": "https://api.github.com/users/bixia1/repos", "events_url": "https://api.github.com/users/bixia1/events{/privacy}", "received_events_url": "https://api.github.com/users/bixia1/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-02-13T05:55:21Z", "updated_at": "2020-02-21T18:44:17Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using):2.1\r\n- Are you willing to contribute it (Yes/No):Yes\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nCurrently, the trt API for tensorflow [here](https://github.com/tensorflow/tensorflow/blob/39cfd72c068a290cfff3fb5f61009ccc88ec0064/tensorflow/python/compiler/tensorrt/trt_convert.py#L1039) takes only a saved_model dir as input when it internally converts the saved_model to frozen graph before working on it. Before TF2.x, there was support for both in the form of either giving the saved_model directory or giving the frozen graph def. This change has caused codebases which used frozen_graph to break in functionality even after modifying the code to TF2.x supported APIs.\r\n**Will this change the current api? How?**\r\nThis will modify the current API to support the previous TrtGraphConverter API\r\n**Who will benefit with this feature?**\r\nAnyone who has been using frozen_graph for converting using TensorRT inside Tensorflow.\r\n**Any Other info.**\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36718", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36718/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36718/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36718/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36718", "id": 564410345, "node_id": "MDU6SXNzdWU1NjQ0MTAzNDU=", "number": 36718, "title": "[TPU Colab] [TF2.1] Many issues only on TPU due to data types, batch sizes and memory (gist provided with explanations)", "user": {"login": "MichaelKarpe", "id": 28049739, "node_id": "MDQ6VXNlcjI4MDQ5NzM5", "avatar_url": "https://avatars0.githubusercontent.com/u/28049739?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MichaelKarpe", "html_url": "https://github.com/MichaelKarpe", "followers_url": "https://api.github.com/users/MichaelKarpe/followers", "following_url": "https://api.github.com/users/MichaelKarpe/following{/other_user}", "gists_url": "https://api.github.com/users/MichaelKarpe/gists{/gist_id}", "starred_url": "https://api.github.com/users/MichaelKarpe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MichaelKarpe/subscriptions", "organizations_url": "https://api.github.com/users/MichaelKarpe/orgs", "repos_url": "https://api.github.com/users/MichaelKarpe/repos", "events_url": "https://api.github.com/users/MichaelKarpe/events{/privacy}", "received_events_url": "https://api.github.com/users/MichaelKarpe/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097541661, "node_id": "MDU6TGFiZWwxMDk3NTQxNjYx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tpus", "name": "comp:tpus", "color": "0052cc", "default": false, "description": "tpu, tpuestimator"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "hongjunChoi", "id": 10834525, "node_id": "MDQ6VXNlcjEwODM0NTI1", "avatar_url": "https://avatars0.githubusercontent.com/u/10834525?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hongjunChoi", "html_url": "https://github.com/hongjunChoi", "followers_url": "https://api.github.com/users/hongjunChoi/followers", "following_url": "https://api.github.com/users/hongjunChoi/following{/other_user}", "gists_url": "https://api.github.com/users/hongjunChoi/gists{/gist_id}", "starred_url": "https://api.github.com/users/hongjunChoi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hongjunChoi/subscriptions", "organizations_url": "https://api.github.com/users/hongjunChoi/orgs", "repos_url": "https://api.github.com/users/hongjunChoi/repos", "events_url": "https://api.github.com/users/hongjunChoi/events{/privacy}", "received_events_url": "https://api.github.com/users/hongjunChoi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "hongjunChoi", "id": 10834525, "node_id": "MDQ6VXNlcjEwODM0NTI1", "avatar_url": "https://avatars0.githubusercontent.com/u/10834525?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hongjunChoi", "html_url": "https://github.com/hongjunChoi", "followers_url": "https://api.github.com/users/hongjunChoi/followers", "following_url": "https://api.github.com/users/hongjunChoi/following{/other_user}", "gists_url": "https://api.github.com/users/hongjunChoi/gists{/gist_id}", "starred_url": "https://api.github.com/users/hongjunChoi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hongjunChoi/subscriptions", "organizations_url": "https://api.github.com/users/hongjunChoi/orgs", "repos_url": "https://api.github.com/users/hongjunChoi/repos", "events_url": "https://api.github.com/users/hongjunChoi/events{/privacy}", "received_events_url": "https://api.github.com/users/hongjunChoi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-02-13T03:09:29Z", "updated_at": "2020-03-09T06:51:51Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes, see gists with code on Colab [not working on TPU](https://colab.research.google.com/drive/1yk4Emyzxju85gqflEii9FVuMD6VF5vta) and [working on GPU](https://colab.research.google.com/drive/1d4_RPQ2wHg6q4wr-J8VzjSi_DMTLRZDp).\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Google Colab\r\n- **TensorFlow installed from (source or binary)**: `%tensorflow_version 2.x` command\r\n- **TensorFlow version (use command below)**: `2.1.0`\r\n\r\n### Describe the problem\r\nAll the issues are shown and described in the [gist provided](https://colab.research.google.com/drive/1yk4Emyzxju85gqflEii9FVuMD6VF5vta). Here is the list of the issues:\r\n- Issue 1: Models fitted on TPU does not deal number of samples not divisible by batch size.\r\n- Issue 1bis: With argument validation_split on TPU, issue 1 may occur with number of samples not divisible by batch size.\r\n- Issue 2: List of supported dtypes on TPU is restrictive.\r\n- Issue 2bis: Predict on TPU has the same dtype constraints than fit on TPU.\r\n- Issue 3: Number of samples may cause error for prediction on TPU\r\n- Issue 4: Batch size may cause error for prediction on TPU\r\n- Issue 4bis: Warnings when predicting on TPU\r\n- Issue 5: Trying to fit or predict on TPU a model on a supported dtype after having tried on a not supported dtype may raise an error.\r\n- Issue 6: `UnavailableError: Socket closed` on TPU and related errors\r\n\r\n### Source code / logs\r\n[See Gist provided.](https://colab.research.google.com/drive/1yk4Emyzxju85gqflEii9FVuMD6VF5vta)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36717", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36717/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36717/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36717/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36717", "id": 564374794, "node_id": "MDU6SXNzdWU1NjQzNzQ3OTQ=", "number": 36717, "title": "MKL no longer works with tensorflow 1.15", "user": {"login": "pavanky", "id": 364829, "node_id": "MDQ6VXNlcjM2NDgyOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/364829?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavanky", "html_url": "https://github.com/pavanky", "followers_url": "https://api.github.com/users/pavanky/followers", "following_url": "https://api.github.com/users/pavanky/following{/other_user}", "gists_url": "https://api.github.com/users/pavanky/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavanky/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavanky/subscriptions", "organizations_url": "https://api.github.com/users/pavanky/orgs", "repos_url": "https://api.github.com/users/pavanky/repos", "events_url": "https://api.github.com/users/pavanky/events{/privacy}", "received_events_url": "https://api.github.com/users/pavanky/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1104829434, "node_id": "MDU6TGFiZWwxMTA0ODI5NDM0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:mkl", "name": "comp:mkl", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "preethivenkatesh", "id": 32650358, "node_id": "MDQ6VXNlcjMyNjUwMzU4", "avatar_url": "https://avatars2.githubusercontent.com/u/32650358?v=4", "gravatar_id": "", "url": "https://api.github.com/users/preethivenkatesh", "html_url": "https://github.com/preethivenkatesh", "followers_url": "https://api.github.com/users/preethivenkatesh/followers", "following_url": "https://api.github.com/users/preethivenkatesh/following{/other_user}", "gists_url": "https://api.github.com/users/preethivenkatesh/gists{/gist_id}", "starred_url": "https://api.github.com/users/preethivenkatesh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/preethivenkatesh/subscriptions", "organizations_url": "https://api.github.com/users/preethivenkatesh/orgs", "repos_url": "https://api.github.com/users/preethivenkatesh/repos", "events_url": "https://api.github.com/users/preethivenkatesh/events{/privacy}", "received_events_url": "https://api.github.com/users/preethivenkatesh/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "preethivenkatesh", "id": 32650358, "node_id": "MDQ6VXNlcjMyNjUwMzU4", "avatar_url": "https://avatars2.githubusercontent.com/u/32650358?v=4", "gravatar_id": "", "url": "https://api.github.com/users/preethivenkatesh", "html_url": "https://github.com/preethivenkatesh", "followers_url": "https://api.github.com/users/preethivenkatesh/followers", "following_url": "https://api.github.com/users/preethivenkatesh/following{/other_user}", "gists_url": "https://api.github.com/users/preethivenkatesh/gists{/gist_id}", "starred_url": "https://api.github.com/users/preethivenkatesh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/preethivenkatesh/subscriptions", "organizations_url": "https://api.github.com/users/preethivenkatesh/orgs", "repos_url": "https://api.github.com/users/preethivenkatesh/repos", "events_url": "https://api.github.com/users/preethivenkatesh/events{/privacy}", "received_events_url": "https://api.github.com/users/preethivenkatesh/received_events", "type": "User", "site_admin": false}, {"login": "TensorFlow-MKL", "id": 44416303, "node_id": "MDQ6VXNlcjQ0NDE2MzAz", "avatar_url": "https://avatars2.githubusercontent.com/u/44416303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TensorFlow-MKL", "html_url": "https://github.com/TensorFlow-MKL", "followers_url": "https://api.github.com/users/TensorFlow-MKL/followers", "following_url": "https://api.github.com/users/TensorFlow-MKL/following{/other_user}", "gists_url": "https://api.github.com/users/TensorFlow-MKL/gists{/gist_id}", "starred_url": "https://api.github.com/users/TensorFlow-MKL/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TensorFlow-MKL/subscriptions", "organizations_url": "https://api.github.com/users/TensorFlow-MKL/orgs", "repos_url": "https://api.github.com/users/TensorFlow-MKL/repos", "events_url": "https://api.github.com/users/TensorFlow-MKL/events{/privacy}", "received_events_url": "https://api.github.com/users/TensorFlow-MKL/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 28, "created_at": "2020-02-13T01:05:48Z", "updated_at": "2020-03-04T01:40:34Z", "closed_at": null, "author_association": "NONE", "body": "------------------------\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: NO\r\n\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Centos 7\r\n\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: N/A\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: 1.15.2\r\n- **Python version**: N/A\r\n- **Bazel version (if compiling from source)**: 0.24.1\r\n- **GCC/Compiler version (if compiling from source)**: gcc-6 (devtoolset-6 on centos 7)\r\n- **CUDA/cuDNN version**: N/A\r\n- **GPU model and memory**: N/A\r\n- **Exact command to reproduce**:\r\n```bash\r\n bazel build -c opt --copt=-msse4.2 --copt=-mavx \\\r\n       --copt=-O3 --config=mkl --linkopt -ldl \\\r\n       --copt=-march=x86-64 \\\r\n       //tensorflow/tools/pip_package:build_pip_package \\\r\n       //tensorflow/tools/lib_package:libtensorflow_jni \\\r\n       //tensorflow/tools/lib_package:libtensorflow \\\r\n       //tensorflow/tools/lib_package:libtensorflow_proto \\\r\n```\r\n\r\n### Describe the problem\r\nlibtensorflow_framework.so build this way does not have any symbols from MKL. When trying to import tensorflow from ~~java~~ scala, it fails with symbol not found for `tensorflow::DisableMKL()`\r\n\r\nThe number of MKL symbols found in `libtensorflow_framework.so` for 1.15 are also significantly lower than those found in 1.14.\r\n\r\n### Source code / logs\r\n\r\nCode used to import tensorflow in scala\r\n\r\n```scala\r\nimport org.tensorflow.Tensorflow\r\n```\r\nNote: We have to ensure `libiomp5.so` and `libmklml_intel.so` are available on library load path. \r\n\r\nThe simplest solution we found was to load the libraries manually in order. The code snippet can be seen here:\r\nhttps://gist.github.com/pavanky/ea6e71e3e7e52c013db844b715723be0\r\n \r\n\r\nError\r\n\r\n```\r\nlibtensorflow_jni.so: undefined symbol: _ZN10tensorflow10DisableMKLEv\r\n```\r\n\r\nLooking at the number of symbols related to MKL:\r\n\r\n```\t\r\n $ nm -D org/tensorflow/native/linux-x86_64/libtensorflow_framework.so.1 | grep -i mkl | wc -l\r\n1\r\n $ nm -D org/tensorflow/native/linux-x86_64/libtensorflow_jni.so | grep -i mkl | wc -l\r\n9\r\n $ nm -D org/tensorflow/native/linux-x86_64/libtensorflow_framework.so.1 | grep -i mkl\r\n0000000000e127b0 T _ZN10tensorflow12IsMklEnabledEv\r\n```\r\n\r\nFor reference, 1.14 had a lot more\r\n\r\n```\r\n $ nm -D org/tensorflow/native/linux-x86_64/libtensorflow_framework.so.1 | grep -i mkl | wc -l\r\n11388\r\n $ nm -D org/tensorflow/native/linux-x86_64/libtensorflow_jni.so | grep -i mkl | wc -l\r\n8\r\n```\r\n\r\n---------\r\nMKL is also not available in the wheel built by the command mentioned above.\r\n\r\n```python\r\n>>> import tensorflow as tf\r\n>>> tf.python.pywrap_tensorflow.IsMklEnabled()\r\nFalse\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36716", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36716/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36716/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36716/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36716", "id": 564365575, "node_id": "MDExOlB1bGxSZXF1ZXN0Mzc0NjEwODI4", "number": 36716, "title": "TFLu: Port SetCancellationFunction() from TFL and add test cases.", "user": {"login": "suphoff", "id": 2333473, "node_id": "MDQ6VXNlcjIzMzM0NzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/2333473?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suphoff", "html_url": "https://github.com/suphoff", "followers_url": "https://api.github.com/users/suphoff/followers", "following_url": "https://api.github.com/users/suphoff/following{/other_user}", "gists_url": "https://api.github.com/users/suphoff/gists{/gist_id}", "starred_url": "https://api.github.com/users/suphoff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suphoff/subscriptions", "organizations_url": "https://api.github.com/users/suphoff/orgs", "repos_url": "https://api.github.com/users/suphoff/repos", "events_url": "https://api.github.com/users/suphoff/events{/privacy}", "received_events_url": "https://api.github.com/users/suphoff/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 1169365494, "node_id": "MDU6TGFiZWwxMTY5MzY1NDk0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:M", "name": "size:M", "color": "adafea", "default": false, "description": "CL Change Size: Medium"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-02-13T00:34:10Z", "updated_at": "2020-03-16T11:57:23Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36716", "html_url": "https://github.com/tensorflow/tensorflow/pull/36716", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36716.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36716.patch"}, "body": "@petewarden : First draft of porting the SetCancellationFunction() from TFL.\r\nFunctionality should be fine - but need to check style in unit test. "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36715", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36715/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36715/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36715/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36715", "id": 564286578, "node_id": "MDU6SXNzdWU1NjQyODY1Nzg=", "number": 36715, "title": "BUG: tf.random.normal() has a fixed value in eager mode (TF2.0)", "user": {"login": "markemus", "id": 28574774, "node_id": "MDQ6VXNlcjI4NTc0Nzc0", "avatar_url": "https://avatars3.githubusercontent.com/u/28574774?v=4", "gravatar_id": "", "url": "https://api.github.com/users/markemus", "html_url": "https://github.com/markemus", "followers_url": "https://api.github.com/users/markemus/followers", "following_url": "https://api.github.com/users/markemus/following{/other_user}", "gists_url": "https://api.github.com/users/markemus/gists{/gist_id}", "starred_url": "https://api.github.com/users/markemus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/markemus/subscriptions", "organizations_url": "https://api.github.com/users/markemus/orgs", "repos_url": "https://api.github.com/users/markemus/repos", "events_url": "https://api.github.com/users/markemus/events{/privacy}", "received_events_url": "https://api.github.com/users/markemus/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "wangpengmit", "id": 7817365, "node_id": "MDQ6VXNlcjc4MTczNjU=", "avatar_url": "https://avatars2.githubusercontent.com/u/7817365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wangpengmit", "html_url": "https://github.com/wangpengmit", "followers_url": "https://api.github.com/users/wangpengmit/followers", "following_url": "https://api.github.com/users/wangpengmit/following{/other_user}", "gists_url": "https://api.github.com/users/wangpengmit/gists{/gist_id}", "starred_url": "https://api.github.com/users/wangpengmit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wangpengmit/subscriptions", "organizations_url": "https://api.github.com/users/wangpengmit/orgs", "repos_url": "https://api.github.com/users/wangpengmit/repos", "events_url": "https://api.github.com/users/wangpengmit/events{/privacy}", "received_events_url": "https://api.github.com/users/wangpengmit/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "wangpengmit", "id": 7817365, "node_id": "MDQ6VXNlcjc4MTczNjU=", "avatar_url": "https://avatars2.githubusercontent.com/u/7817365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wangpengmit", "html_url": "https://github.com/wangpengmit", "followers_url": "https://api.github.com/users/wangpengmit/followers", "following_url": "https://api.github.com/users/wangpengmit/following{/other_user}", "gists_url": "https://api.github.com/users/wangpengmit/gists{/gist_id}", "starred_url": "https://api.github.com/users/wangpengmit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wangpengmit/subscriptions", "organizations_url": "https://api.github.com/users/wangpengmit/orgs", "repos_url": "https://api.github.com/users/wangpengmit/repos", "events_url": "https://api.github.com/users/wangpengmit/events{/privacy}", "received_events_url": "https://api.github.com/users/wangpengmit/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 14, "created_at": "2020-02-12T21:32:51Z", "updated_at": "2020-02-26T12:30:18Z", "closed_at": null, "author_association": "NONE", "body": "Please go to Stack Overflow for help and support:\r\n\r\nhttps://stackoverflow.com/questions/tagged/tensorflow\r\n\r\nIf you open a GitHub issue, here is our policy:\r\n\r\n1. It must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).\r\n2. The form below must be filled out.\r\n3. It shouldn't be a TensorBoard issue. Those go [here](https://github.com/tensorflow/tensorboard/issues).\r\n\r\n**Here's why we have that policy**: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.\r\n\r\n------------------------\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: \r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**:\r\n- **TensorFlow version (use command below)**: v2.0.0-rc2-26-g64c3d38 2.0.0\r\n- **Python version**: 3.6.9\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**:\r\n- **GPU model and memory**:\r\n- **Exact command to reproduce**:\r\n\r\nYou can collect some of this information using our environment capture script:\r\n\r\nhttps://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh\r\n\r\nYou can obtain the TensorFlow version with:\r\n\r\n```bash\r\npython -c \"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"\r\n```\r\n\r\n### Describe the problem\r\nDescribe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.\r\n\r\nIn Tf2.0 eager mode, tf.random.normal() will give the same value over and over again. This happens whether you use a Keras Model or just call the tf.random.normal() tensor repeatedly:\r\n\r\n```\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\nid = np.ones(shape=(32,10))\r\ni = tf.keras.layers.Input(shape=(10,), batch_size=32, dtype=tf.float64)\r\ny = tf.random.normal(shape=(32,10), name=\"noise\", dtype=tf.float64)\r\no = tf.add(i, y)\r\nmodel = tf.keras.Model(inputs=i, outputs=o)\r\n\r\n# same value every time?\r\nmodel.predict(id)\r\nmodel.predict(id)\r\nmodel.predict(id)\r\n```\r\n\r\nThis occurs without Keras as well:\r\n\r\n```\r\nx = tf.constant(value=np.ones(shape=(32,10)), dtype=tf.float64)\r\ny = tf.random.normal(shape=(32,10), name=\"noise\", dtype=tf.float64)\r\nz = tf.add(x, y)\r\nprint(z)\r\nprint(z)\r\nprint(z)\r\n```\r\n\r\nIf you disable eager mode with tf.compat.v1.disable_eager_execution(), the Keras Model will generate new values each time it's called (as it should).\r\n\r\n### Source code / logs\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36712", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36712/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36712/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36712/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36712", "id": 564280837, "node_id": "MDU6SXNzdWU1NjQyODA4Mzc=", "number": 36712, "title": "KeyError of identity node, when using Skip Connection and RandomDrop together", "user": {"login": "gahaalt", "id": 43541355, "node_id": "MDQ6VXNlcjQzNTQxMzU1", "avatar_url": "https://avatars2.githubusercontent.com/u/43541355?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gahaalt", "html_url": "https://github.com/gahaalt", "followers_url": "https://api.github.com/users/gahaalt/followers", "following_url": "https://api.github.com/users/gahaalt/following{/other_user}", "gists_url": "https://api.github.com/users/gahaalt/gists{/gist_id}", "starred_url": "https://api.github.com/users/gahaalt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gahaalt/subscriptions", "organizations_url": "https://api.github.com/users/gahaalt/orgs", "repos_url": "https://api.github.com/users/gahaalt/repos", "events_url": "https://api.github.com/users/gahaalt/events{/privacy}", "received_events_url": "https://api.github.com/users/gahaalt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-02-12T21:23:00Z", "updated_at": "2020-03-01T19:02:27Z", "closed_at": null, "author_association": "NONE", "body": "- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Windows 10\r\n- **TensorFlow installed from (source or binary)**: pip\r\n- **TensorFlow version (use command below)**: v2.1.0-rc2-17-ge5bf8de410 2.1.0\r\n- **Python version**: 3.7.6 Anaconda\r\n- **CUDA/cuDNN version**: 10.2 / 7.6.5\r\n- **GPU model and memory**: RTX2070 mobile, 8GB\r\n\r\n### Minimal example:\r\n```\r\nimport tensorflow as tf\r\n\r\nclass OpOrSkip(tf.keras.layers.Layer):\r\n    def __init__(self, op):\r\n        super().__init__()\r\n        self.op = op\r\n        \r\n    def call(self, x):\r\n        rnd = tf.random.uniform(())\r\n        if rnd < 0.5:\r\n            return self.op(x)\r\n        else:\r\n            return x\r\n\r\ndef skip_conv(s):\r\n    x = tf.keras.layers.Conv2D(3, 3, padding='same')(s)\r\n    return x + s #tf.identity(s, name='s')\r\n\r\ndef func_as_model(func, shape):\r\n    inp = tf.keras.Input(shape)\r\n    out = func(inp)\r\n    return tf.keras.Model(inputs=inp, outputs=out)\r\n\r\ninputs = tf.keras.Input((32, 32, 3))\r\nSkipConv = func_as_model(skip_conv, [32, 32, 3])\r\n\r\nx = OpOrSkip(SkipConv)(inputs)\r\nmodel = tf.keras.Model(inputs=inputs, outputs=x)\r\n```\r\n\r\n### Describe the problem\r\nI am building a resnet network, so a network with skip connections, but also with RandomDrop, that is dropping the whole residual with some probability. However, I can't do this in tensorflow 2, wheras it was possible in tensorflow 1. The error occurs only when both skip connection and RandomDrop are preset at once.\r\n\r\nMy observation is tensorflow confuses shortcut in `skip_conv` with another node. When I try to name this shortcut using `tf.identity`, I get yet another error. However I expect it to work without explicitly naming the identity node.\r\n\r\nThe alternative for `s` is commented in the code (`tf.identity(s, name='s')`). Error in the first version occurs when only defining the model. When named the identity node, the error occurs only when using model in a graph (in `@tf.function` decorated function).\r\n\r\n### Source code / logs\r\n```\r\n---------------------------------------------------------------------------\r\nKeyError                                  Traceback (most recent call last)\r\n<ipython-input-9-c655ea21defb> in <module>()\r\n     27 SkipConv = func_as_model(skip_conv, [32, 32, 3])\r\n     28 \r\n---> 29 x = OpOrSkip(SkipConv)(inputs)\r\n     30 model = tf.keras.Model(inputs=inputs, outputs=x)\r\n\r\nC:\\Users\\gaha\\Anaconda3\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\base_layer.py in __call__(self, inputs, *args, **kwargs)\r\n    771                     not base_layer_utils.is_in_eager_or_tf_function()):\r\n    772                   with auto_control_deps.AutomaticControlDependencies() as acd:\r\n--> 773                     outputs = call_fn(cast_inputs, *args, **kwargs)\r\n    774                     # Wrap Tensors in `outputs` in `tf.identity` to avoid\r\n    775                     # circular dependencies.\r\n\r\nC:\\Users\\gaha\\Anaconda3\\lib\\site-packages\\tensorflow_core\\python\\autograph\\impl\\api.py in wrapper(*args, **kwargs)\r\n    235       except Exception as e:  # pylint:disable=broad-except\r\n    236         if hasattr(e, 'ag_error_metadata'):\r\n--> 237           raise e.ag_error_metadata.to_exception(e)\r\n    238         else:\r\n    239           raise\r\n\r\nKeyError: in converted code:\r\n\r\n    <ipython-input-1-56c161fa68ed>:12 call  *\r\n        if rnd < 0.5:\r\n    C:\\Users\\gaha\\Anaconda3\\lib\\site-packages\\tensorflow_core\\python\\autograph\\operators\\control_flow.py:918 if_stmt\r\n        basic_symbol_names, composite_symbol_names)\r\n    C:\\Users\\gaha\\Anaconda3\\lib\\site-packages\\tensorflow_core\\python\\autograph\\operators\\control_flow.py:956 tf_if_stmt\r\n        error_checking_orelse)\r\n    C:\\Users\\gaha\\Anaconda3\\lib\\site-packages\\tensorflow_core\\python\\util\\deprecation.py:507 new_func\r\n        return func(*args, **kwargs)\r\n    C:\\Users\\gaha\\Anaconda3\\lib\\site-packages\\tensorflow_core\\python\\ops\\control_flow_ops.py:1174 cond\r\n        return cond_v2.cond_v2(pred, true_fn, false_fn, name)\r\n    C:\\Users\\gaha\\Anaconda3\\lib\\site-packages\\tensorflow_core\\python\\ops\\cond_v2.py:83 cond_v2\r\n        op_return_value=pred)\r\n    C:\\Users\\gaha\\Anaconda3\\lib\\site-packages\\tensorflow_core\\python\\framework\\func_graph.py:1019 func_graph_from_py_func\r\n        func_graph.variables = variables\r\n    C:\\Users\\gaha\\Anaconda3\\lib\\site-packages\\tensorflow_core\\python\\framework\\auto_control_deps.py:324 __exit__\r\n        for inp in op.inputs:\r\n    C:\\Users\\gaha\\Anaconda3\\lib\\site-packages\\tensorflow_core\\python\\framework\\ops.py:2163 inputs\r\n        c_api.GetOperationInputs(self._c_op)))\r\n    C:\\Users\\gaha\\Anaconda3\\lib\\site-packages\\tensorflow_core\\python\\framework\\ops.py:3696 _get_tensor_by_tf_output\r\n        op = self._get_operation_by_tf_operation(tf_output.oper)\r\n    C:\\Users\\gaha\\Anaconda3\\lib\\site-packages\\tensorflow_core\\python\\framework\\ops.py:3660 _get_operation_by_tf_operation\r\n        return self._get_operation_by_name_unsafe(op_name)\r\n    C:\\Users\\gaha\\Anaconda3\\lib\\site-packages\\tensorflow_core\\python\\framework\\ops.py:3656 _get_operation_by_name_unsafe\r\n        return self._nodes_by_name[name]\r\n\r\n    KeyError: 'input_17'\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36711", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36711/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36711/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36711/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36711", "id": 564239173, "node_id": "MDU6SXNzdWU1NjQyMzkxNzM=", "number": 36711, "title": "Error TFLite converting tensorflow graph generated with config file with experimental_new_converter = True", "user": {"login": "erichaydel", "id": 6462853, "node_id": "MDQ6VXNlcjY0NjI4NTM=", "avatar_url": "https://avatars1.githubusercontent.com/u/6462853?v=4", "gravatar_id": "", "url": "https://api.github.com/users/erichaydel", "html_url": "https://github.com/erichaydel", "followers_url": "https://api.github.com/users/erichaydel/followers", "following_url": "https://api.github.com/users/erichaydel/following{/other_user}", "gists_url": "https://api.github.com/users/erichaydel/gists{/gist_id}", "starred_url": "https://api.github.com/users/erichaydel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/erichaydel/subscriptions", "organizations_url": "https://api.github.com/users/erichaydel/orgs", "repos_url": "https://api.github.com/users/erichaydel/repos", "events_url": "https://api.github.com/users/erichaydel/events{/privacy}", "received_events_url": "https://api.github.com/users/erichaydel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "daverim", "id": 2448933, "node_id": "MDQ6VXNlcjI0NDg5MzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/2448933?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daverim", "html_url": "https://github.com/daverim", "followers_url": "https://api.github.com/users/daverim/followers", "following_url": "https://api.github.com/users/daverim/following{/other_user}", "gists_url": "https://api.github.com/users/daverim/gists{/gist_id}", "starred_url": "https://api.github.com/users/daverim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daverim/subscriptions", "organizations_url": "https://api.github.com/users/daverim/orgs", "repos_url": "https://api.github.com/users/daverim/repos", "events_url": "https://api.github.com/users/daverim/events{/privacy}", "received_events_url": "https://api.github.com/users/daverim/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "daverim", "id": 2448933, "node_id": "MDQ6VXNlcjI0NDg5MzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/2448933?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daverim", "html_url": "https://github.com/daverim", "followers_url": "https://api.github.com/users/daverim/followers", "following_url": "https://api.github.com/users/daverim/following{/other_user}", "gists_url": "https://api.github.com/users/daverim/gists{/gist_id}", "starred_url": "https://api.github.com/users/daverim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daverim/subscriptions", "organizations_url": "https://api.github.com/users/daverim/orgs", "repos_url": "https://api.github.com/users/daverim/repos", "events_url": "https://api.github.com/users/daverim/events{/privacy}", "received_events_url": "https://api.github.com/users/daverim/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-12T20:06:16Z", "updated_at": "2020-02-13T18:26:49Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04\r\n- TensorFlow installed from (source or binary): binary (pip)\r\n- TensorFlow version (or github SHA if from source): TF Nightly 2.2.0-dev20200212\r\n\r\n**Command used to run the converter or code if you\u2019re using the Python API**\r\n\r\n```\r\nconverter = tf.lite.TFLiteConverter.from_concrete_functions([inception_func])\r\nconverter.optimizations = [tf.lite.Optimize.DEFAULT]\r\nconverter.target_spec.supported_ops = [tf.lite.OpsSet.TFLITE_BUILTINS, tf.lite.OpsSet.SELECT_TF_OPS]\r\nconverter.target_spec.supported_types = [tf.int8, tf.uint8]\r\nconverter.inference_input_type = tf.uint8\r\nconverter.inference_output_type = tf.uint8\r\nconverter.experimental_new_converter = True\r\ntflite_model = converter.convert()\r\n```\r\n\r\n**The output from the converter invocation**\r\n\r\n```\r\n2020-02-12 14:44:53.272916: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1\r\n2020-02-12 14:44:53.293807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: \r\npciBusID: 0000:01:00.0 name: TITAN Xp computeCapability: 6.1\r\ncoreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 510.07GiB/s\r\n2020-02-12 14:44:53.294407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 1 with properties: \r\npciBusID: 0000:02:00.0 name: TITAN Xp computeCapability: 6.1\r\ncoreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 510.07GiB/s\r\n2020-02-12 14:44:53.294542: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory\r\n2020-02-12 14:44:53.295848: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10\r\n2020-02-12 14:44:53.297069: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10\r\n2020-02-12 14:44:53.297272: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10\r\n2020-02-12 14:44:53.298655: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10\r\n2020-02-12 14:44:53.299389: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10\r\n2020-02-12 14:44:53.299452: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory\r\n2020-02-12 14:44:53.299461: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1595] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.\r\nSkipping registering GPU devices...\r\n2020-02-12 14:44:53.299683: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2020-02-12 14:44:53.327596: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 3597955000 Hz\r\n2020-02-12 14:44:53.328433: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55838544dd10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n2020-02-12 14:44:53.328472: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\n2020-02-12 14:44:53.331414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2020-02-12 14:44:53.331444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      \r\n<generator object image_files_gen at 0x7febddc4ed50>\r\n2020-02-12 14:44:54.788049: I tensorflow/core/profiler/lib/profiler_session.cc:159] Profiler session started.\r\n2020-02-12 14:44:54.788083: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1363] Profiler found 2 GPUs\r\n2020-02-12 14:44:54.788196: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.1'; dlerror: libcupti.so.10.1: cannot open shared object file: No such file or directory\r\n2020-02-12 14:44:54.788207: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1408] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI could not be loaded or symbol could not be found.\r\n2020-02-12 14:44:54.788215: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1447] function cupti_interface_->ActivityRegisterCallbacks( AllocCuptiActivityBuffer, FreeCuptiActivityBuffer)failed with error CUPTI could not be loaded or symbol could not be found.\r\n[<tf.Tensor: shape=(1, 100, 4), dtype=float32, numpy=\r\narray([[[0.4523084 , 0.19130976, 0.48489496, 0.25743166],\r\n        [0.44898474, 0.19012845, 0.48815066, 0.2607174 ],\r\n        [0.6068166 , 0.04942099, 0.63641137, 0.11622739],\r\n        [0.45264566, 0.1908576 , 0.48534685, 0.2560804 ],\r\n        [0.45322064, 0.19343509, 0.48580036, 0.25778043],\r\n        [0.50848585, 0.576692  , 0.53330845, 0.6251781 ],\r\n        [0.45322064, 0.19343509, 0.48580036, 0.25778043],\r\n        [0.4494503 , 0.17628026, 0.48778558, 0.2566436 ],\r\n        [0.527445  , 0.33889085, 0.55464226, 0.39898926],\r\n        [0.45296955, 0.1903181 , 0.48529047, 0.25696498],\r\n        [0.5204598 , 0.32256034, 0.5480597 , 0.39266023],\r\n        [0.63632804, 0.6682412 , 0.6719902 , 0.7374546 ],\r\n        [0.45650837, 0.19338551, 0.4927548 , 0.277421  ],\r\n        [0.44446883, 0.1737675 , 0.4827005 , 0.25779355],\r\n        [0.72652483, 0.2473509 , 0.7562058 , 0.30082873],\r\n        [0.9542563 , 0.843302  , 1.        , 0.96409976],\r\n        [0.11040416, 0.00447438, 0.13210008, 0.03558907],\r\n        [0.45264566, 0.1908576 , 0.48534685, 0.2560804 ],\r\n        [0.4523084 , 0.19130976, 0.48489496, 0.25743166],\r\n        [0.44075978, 0.14530185, 0.48041832, 0.25093415],\r\n        [0.15409914, 0.94093376, 0.1896761 , 1.        ],\r\n        [0.45264566, 0.1908576 , 0.48534685, 0.2560804 ],\r\n        [0.6068166 , 0.04942099, 0.63641137, 0.11622739],\r\n        [0.50790685, 0.7605634 , 0.53323144, 0.82372105],\r\n        [0.10795376, 0.0060998 , 0.13245544, 0.04638027],\r\n        [0.4466028 , 0.18642351, 0.4799665 , 0.24573368],\r\n        [0.52835655, 0.28773227, 0.5562326 , 0.34618238],\r\n        [0.45650837, 0.19338551, 0.4927548 , 0.277421  ],\r\n        [0.3502379 , 0.44612858, 0.38212806, 0.50805885],\r\n        [0.64212465, 0.39890158, 0.6739552 , 0.49036568],\r\n        [0.45171025, 0.19052231, 0.4847984 , 0.25762528],\r\n        [0.12097565, 0.00399387, 0.1428402 , 0.03510833],\r\n        [0.4466028 , 0.18642351, 0.4799665 , 0.24573368],\r\n        [0.17729592, 0.19604556, 0.20469955, 0.26705974],\r\n        [0.45841685, 0.14860368, 0.5037309 , 0.26684842],\r\n        [0.11995812, 0.00256568, 0.14446093, 0.05109425],\r\n        [0.5166499 , 0.2938283 , 0.5506055 , 0.39516765],\r\n        [0.5196249 , 0.32896924, 0.54816073, 0.38678855],\r\n        [0.31064248, 0.7969677 , 0.35238957, 0.8906676 ],\r\n        [0.51701736, 0.30636752, 0.55060136, 0.40481085],\r\n        [0.22814384, 0.32451725, 0.259156  , 0.41317737],\r\n        [0.50587946, 0.30761832, 0.53356034, 0.37745112],\r\n        [0.45861158, 0.2037143 , 0.4902828 , 0.2635113 ],\r\n        [0.4471084 , 0.184802  , 0.47876382, 0.25051934],\r\n        [0.43582347, 0.19232129, 0.4744096 , 0.26392525],\r\n        [0.45296955, 0.1903181 , 0.48529047, 0.25696498],\r\n        [0.01486549, 0.        , 0.07320484, 0.08066794],\r\n        [0.        , 0.09366378, 0.21820027, 0.9756663 ],\r\n        [0.54991406, 0.5637065 , 0.691194  , 0.96959376],\r\n        [0.59876406, 0.04728752, 0.6286751 , 0.11585537],\r\n        [0.53492194, 0.08620362, 0.5909355 , 0.24983023],\r\n        [0.70816135, 0.00839768, 0.74530756, 0.06555284],\r\n        [0.686458  , 0.944192  , 0.75062335, 1.        ],\r\n        [0.4471084 , 0.184802  , 0.47876382, 0.25051934],\r\n        [0.13161138, 0.45191422, 0.15738365, 0.5095992 ],\r\n        [0.4885881 , 0.80888736, 0.54836   , 0.978459  ],\r\n        [0.13416171, 0.00377405, 0.1561068 , 0.03560173],\r\n        [0.45158228, 0.19188425, 0.48981753, 0.2612535 ],\r\n        [0.75087017, 0.00396507, 0.78542954, 0.06046526],\r\n        [0.637136  , 0.66719157, 0.66992843, 0.7352523 ],\r\n        [0.5243317 , 0.29501545, 0.5598284 , 0.39330977],\r\n        [0.44330403, 0.1994324 , 0.48607805, 0.27255926],\r\n        [0.4471084 , 0.184802  , 0.47876382, 0.25051934],\r\n        [0.96380365, 0.84537166, 1.        , 0.9437652 ],\r\n        [0.44857678, 0.18810245, 0.48808834, 0.25654176],\r\n        [0.5276355 , 0.2980371 , 0.55767304, 0.364582  ],\r\n        [0.51808655, 0.3211314 , 0.5516435 , 0.41390526],\r\n        [0.44262165, 0.2258066 , 0.49634498, 0.2604202 ],\r\n        [0.51671165, 0.23575601, 0.5696979 , 0.38195243],\r\n        [0.5159677 , 0.2698248 , 0.56696165, 0.4135533 ],\r\n        [0.16784409, 0.18931931, 0.19625813, 0.26827484],\r\n        [0.44924247, 0.11680316, 0.48714614, 0.24786523],\r\n        [0.6068166 , 0.04942099, 0.63641137, 0.11622739],\r\n        [0.5007901 , 0.58252937, 0.527007  , 0.63281745],\r\n        [0.4662144 , 0.19344129, 0.5073866 , 0.26448467],\r\n        [0.19347599, 0.5412288 , 0.21763065, 0.5982214 ],\r\n        [0.44075978, 0.14530185, 0.48041832, 0.25093415],\r\n        [0.44787258, 0.2035003 , 0.48078   , 0.26272708],\r\n        [0.36003056, 0.43164626, 0.39625302, 0.5073702 ],\r\n        [0.85064745, 0.2225066 , 0.8861109 , 0.31016666],\r\n        [0.5810017 , 0.11662646, 0.6081669 , 0.17228721],\r\n        [0.45315146, 0.17665324, 0.48381698, 0.2442483 ],\r\n        [0.63825023, 0.        , 1.        , 1.        ],\r\n        [0.27971706, 0.21467996, 0.33935127, 0.41237378],\r\n        [0.20111686, 0.9416385 , 0.23956841, 1.        ],\r\n        [0.44525808, 0.17430884, 0.47413707, 0.23905429],\r\n        [0.44446883, 0.1737675 , 0.4827005 , 0.25779355],\r\n        [0.44451416, 0.1914759 , 0.4826401 , 0.27257037],\r\n        [0.18308899, 0.00234124, 0.20454633, 0.03471272],\r\n        [0.56354165, 0.11042208, 0.5989641 , 0.18208715],\r\n        [0.8662053 , 0.26750824, 1.        , 0.6562464 ],\r\n        [0.45214534, 0.21824962, 0.48541468, 0.2723656 ],\r\n        [0.5272091 , 0.18768561, 0.5903445 , 0.34028006],\r\n        [0.1258346 , 0.9409971 , 0.16100453, 1.        ],\r\n        [0.44988436, 0.19079384, 0.48194766, 0.25922737],\r\n        [0.5381035 , 0.7981993 , 0.5771181 , 0.885656  ],\r\n        [0.51808256, 0.29529324, 0.54818624, 0.36529002],\r\n        [0.44561428, 0.12746832, 0.48472154, 0.25478205],\r\n        [0.55583   , 0.39829937, 0.6881298 , 0.8807714 ],\r\n        [0.12827086, 0.        , 0.15974712, 0.02394507]]], dtype=float32)>, <tf.Tensor: shape=(1, 100), dtype=float32, numpy=\r\narray([[0.92555547, 0.04032728, 0.04001778, 0.03919104, 0.0389992 ,\r\n        0.03491211, 0.03117302, 0.02736771, 0.02710325, 0.02648216,\r\n        0.02614886, 0.02420676, 0.02387115, 0.02345794, 0.02287492,\r\n        0.02275831, 0.02204138, 0.02131733, 0.02058503, 0.02054   ,\r\n        0.0202291 , 0.0200913 , 0.01930887, 0.01929054, 0.0186362 ,\r\n        0.01838633, 0.01820371, 0.01814541, 0.0180732 , 0.01789805,\r\n        0.01755115, 0.01670685, 0.01663533, 0.01650512, 0.01644138,\r\n        0.01569021, 0.01568368, 0.01562142, 0.0155603 , 0.01543599,\r\n        0.01460987, 0.01423776, 0.0142113 , 0.01356006, 0.01343337,\r\n        0.01308289, 0.01273718, 0.01269153, 0.01266637, 0.01263455,\r\n        0.01250893, 0.01249737, 0.01232877, 0.01232168, 0.01225841,\r\n        0.01223144, 0.01213449, 0.01195824, 0.01176769, 0.01173973,\r\n        0.01167473, 0.01161668, 0.01140118, 0.0113658 , 0.01134393,\r\n        0.01127735, 0.01115933, 0.01114836, 0.01104337, 0.01092488,\r\n        0.0109069 , 0.01084158, 0.01068258, 0.01066345, 0.0105837 ,\r\n        0.01057971, 0.01048639, 0.01046959, 0.01027715, 0.01023829,\r\n        0.01021823, 0.01019359, 0.01015976, 0.01008341, 0.01005188,\r\n        0.00993064, 0.00975928, 0.00972691, 0.00967205, 0.00965327,\r\n        0.00961038, 0.00959793, 0.00955415, 0.00954556, 0.00948521,\r\n        0.0093832 , 0.00936151, 0.00935119, 0.00931564, 0.00920397]],\r\n      dtype=float32)>, <tf.Tensor: shape=(1, 100), dtype=float32, numpy=\r\narray([[15., 13.,  4.,  3., 12., 15., 10., 16.,  8.,  9., 10., 13., 15.,\r\n        15., 15.,  8., 14.,  1.,  2., 16., 12., 14., 10., 10.,  4., 12.,\r\n        13., 13.,  5.,  8.,  8., 14., 13.,  4., 15.,  4., 16.,  8.,  5.,\r\n        10.,  3., 10., 12.,  2., 12.,  4., 11., 16.,  3.,  4., 10., 13.,\r\n         5., 10.,  4., 10., 14., 11., 12.,  8., 16., 15.,  1.,  7.,  6.,\r\n        13., 16., 14., 10., 10.,  4., 16., 16., 15., 15.,  4.,  1., 12.,\r\n        12., 10.,  4., 10., 16.,  4., 12., 10.,  3., 16., 14.,  8.,  1.,\r\n        15.,  3.,  4.,  7.,  8., 10., 10.,  3., 14.]], dtype=float32)>, <tf.Tensor: shape=(1,), dtype=float32, numpy=array([100.], dtype=float32)>]\r\n2020-02-12 14:44:56.654298: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1430] function cupti_interface_->EnableCallback( 0 , subscriber_, CUPTI_CB_DOMAIN_DRIVER_API, cbid)failed with error CUPTI could not be loaded or symbol could not be found.\r\n2020-02-12 14:44:56.654980: I tensorflow/core/profiler/internal/gpu/device_tracer.cc:203]  GpuTracer has collected 0 callback api events and 0 activity events.\r\nCONVERTING\r\n\r\n\r\n\r\n\r\n2020-02-12 14:44:56.953373: I tensorflow/core/grappler/devices.cc:55] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 2\r\n2020-02-12 14:44:56.953474: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2020-02-12 14:44:57.201293: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55839683e470 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:\r\n2020-02-12 14:44:57.201338: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): TITAN Xp, Compute Capability 6.1\r\n2020-02-12 14:44:57.201351: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): TITAN Xp, Compute Capability 6.1\r\n2020-02-12 14:44:57.205900: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: \r\npciBusID: 0000:01:00.0 name: TITAN Xp computeCapability: 6.1\r\ncoreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 510.07GiB/s\r\n2020-02-12 14:44:57.207642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 1 with properties: \r\npciBusID: 0000:02:00.0 name: TITAN Xp computeCapability: 6.1\r\ncoreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 510.07GiB/s\r\n2020-02-12 14:44:57.207835: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory\r\n2020-02-12 14:44:57.207873: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10\r\n2020-02-12 14:44:57.207900: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10\r\n2020-02-12 14:44:57.207925: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10\r\n2020-02-12 14:44:57.207949: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10\r\n2020-02-12 14:44:57.207973: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10\r\n2020-02-12 14:44:57.208090: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory\r\n2020-02-12 14:44:57.208110: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1595] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.\r\nSkipping registering GPU devices...\r\n2020-02-12 14:44:57.208187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2020-02-12 14:44:57.208206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      0 1 \r\n2020-02-12 14:44:57.208221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0:   N Y \r\n2020-02-12 14:44:57.208234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 1:   Y N \r\n2020-02-12 14:44:57.433135: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: graph_to_optimize\r\n2020-02-12 14:44:57.433170: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: Graph size after: 2451 nodes (0), 2754 edges (0), time = 28.091ms.\r\n2020-02-12 14:44:57.433174: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: Graph size after: 2451 nodes (0), 2754 edges (0), time = 30.465ms.\r\n2020-02-12 14:44:57.433178: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: PadOrClipBoxList_cond_1_false_5569\r\n2020-02-12 14:44:57.433182: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: Graph size after: 20 nodes (0), 22 edges (0), time = 0.312ms.\r\n2020-02-12 14:44:57.433185: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: Graph size after: 20 nodes (0), 22 edges (0), time = 0.299ms.\r\n2020-02-12 14:44:57.433189: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: PadOrClipBoxList_cond_2_true_5627\r\n2020-02-12 14:44:57.433192: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-02-12 14:44:57.433195: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-02-12 14:44:57.433198: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: PadOrClipBoxList_cond_3_true_5686\r\n2020-02-12 14:44:57.433204: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-02-12 14:44:57.433207: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-02-12 14:44:57.433210: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: cond_true_5533\r\n2020-02-12 14:44:57.433214: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-02-12 14:44:57.433217: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-02-12 14:44:57.433224: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: cond_false_5652\r\n2020-02-12 14:44:57.433228: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-02-12 14:44:57.433231: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-02-12 14:44:57.433236: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: PadOrClipBoxList_cond_2_false_5628\r\n2020-02-12 14:44:57.433242: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: Graph size after: 20 nodes (0), 22 edges (0), time = 0.278ms.\r\n2020-02-12 14:44:57.433246: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: Graph size after: 20 nodes (0), 22 edges (0), time = 0.295ms.\r\n2020-02-12 14:44:57.433251: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: cond_true_5592\r\n2020-02-12 14:44:57.433256: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-02-12 14:44:57.433260: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-02-12 14:44:57.433264: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: PadOrClipBoxList_cond_1_true_5568\r\n2020-02-12 14:44:57.433269: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-02-12 14:44:57.433273: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-02-12 14:44:57.433277: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: Postprocessor_BatchMultiClassNonMaxSuppression_map_while_cond_4116\r\n2020-02-12 14:44:57.433282: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-02-12 14:44:57.433286: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-02-12 14:44:57.433290: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: Preprocessor_map_while_body_20\r\n2020-02-12 14:44:57.433295: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-02-12 14:44:57.433299: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-02-12 14:44:57.433303: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: cond_false_5534\r\n2020-02-12 14:44:57.433308: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-02-12 14:44:57.433312: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-02-12 14:44:57.433316: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: cond_true_5651\r\n2020-02-12 14:44:57.433321: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-02-12 14:44:57.433325: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-02-12 14:44:57.433329: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: PadOrClipBoxList_cond_3_false_5687\r\n2020-02-12 14:44:57.433334: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: Graph size after: 20 nodes (0), 22 edges (0), time = 0.284ms.\r\n2020-02-12 14:44:57.433339: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: Graph size after: 20 nodes (0), 22 edges (0), time = 0.301ms.\r\n2020-02-12 14:44:57.433343: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: cond_false_5711\r\n2020-02-12 14:44:57.433347: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0.002ms.\r\n2020-02-12 14:44:57.433352: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-02-12 14:44:57.433356: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: cond_true_5710\r\n2020-02-12 14:44:57.433361: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-02-12 14:44:57.433365: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-02-12 14:44:57.433369: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: Preprocessor_map_while_cond_19\r\n2020-02-12 14:44:57.433374: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0.002ms.\r\n2020-02-12 14:44:57.433378: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-02-12 14:44:57.433382: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: PadOrClipBoxList_cond_false_5510\r\n2020-02-12 14:44:57.433387: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: Graph size after: 20 nodes (0), 22 edges (0), time = 0.793ms.\r\n2020-02-12 14:44:57.433391: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: Graph size after: 20 nodes (0), 22 edges (0), time = 0.877ms.\r\n2020-02-12 14:44:57.433395: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: Postprocessor_BatchMultiClassNonMaxSuppression_map_while_body_4117\r\n2020-02-12 14:44:57.433400: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: Graph size after: 1290 nodes (0), 1804 edges (0), time = 8.567ms.\r\n2020-02-12 14:44:57.433405: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: Graph size after: 1290 nodes (0), 1804 edges (0), time = 10.381ms.\r\n2020-02-12 14:44:57.433409: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: PadOrClipBoxList_cond_true_5509\r\n2020-02-12 14:44:57.433414: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-02-12 14:44:57.433418: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-02-12 14:44:57.433423: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: cond_false_5593\r\n2020-02-12 14:44:57.433427: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-02-12 14:44:57.433432: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-02-12 14:44:59.331976: I tensorflow/core/grappler/devices.cc:55] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 2\r\n2020-02-12 14:44:59.332072: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2020-02-12 14:44:59.333207: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: \r\npciBusID: 0000:01:00.0 name: TITAN Xp computeCapability: 6.1\r\ncoreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 510.07GiB/s\r\n2020-02-12 14:44:59.333751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 1 with properties: \r\npciBusID: 0000:02:00.0 name: TITAN Xp computeCapability: 6.1\r\ncoreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 510.07GiB/s\r\n2020-02-12 14:44:59.333842: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory\r\n2020-02-12 14:44:59.333858: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10\r\n2020-02-12 14:44:59.333868: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10\r\n2020-02-12 14:44:59.333878: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10\r\n2020-02-12 14:44:59.333887: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10\r\n2020-02-12 14:44:59.333896: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10\r\n2020-02-12 14:44:59.333939: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory\r\n2020-02-12 14:44:59.333946: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1595] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.\r\nSkipping registering GPU devices...\r\n2020-02-12 14:44:59.333988: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2020-02-12 14:44:59.333995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      0 1 \r\n2020-02-12 14:44:59.334002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0:   N Y \r\n2020-02-12 14:44:59.334006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 1:   Y N \r\n2020-02-12 14:44:59.918734: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: graph_to_optimize\r\n2020-02-12 14:44:59.918767: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 937 nodes (-1514), 1045 edges (-1709), time = 270.114ms.\r\n2020-02-12 14:44:59.918772: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 937 nodes (0), 1045 edges (0), time = 79.506ms.\r\n2020-02-12 14:44:59.918775: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: cond_true_5710_frozen\r\n2020-02-12 14:44:59.918779: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 10 nodes (0), 8 edges (0), time = 0.278ms.\r\n2020-02-12 14:44:59.918782: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 10 nodes (0), 8 edges (0), time = 0.171ms.\r\n2020-02-12 14:44:59.918785: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: cond_false_5711_frozen\r\n2020-02-12 14:44:59.918789: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 8 nodes (0), 5 edges (0), time = 0.17ms.\r\n2020-02-12 14:44:59.918793: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 8 nodes (0), 5 edges (0), time = 0.119ms.\r\n2020-02-12 14:44:59.918796: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: PadOrClipBoxList_cond_1_true_5568_frozen\r\n2020-02-12 14:44:59.918801: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 5 nodes (-3), 4 edges (-3), time = 0.285ms.\r\n2020-02-12 14:44:59.918805: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 5 nodes (0), 4 edges (0), time = 0.093ms.\r\n2020-02-12 14:44:59.918808: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: Postprocessor_BatchMultiClassNonMaxSuppression_map_while_cond_4116_frozen\r\n2020-02-12 14:44:59.918812: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 18 nodes (0), 7 edges (0), time = 0.253ms.\r\n2020-02-12 14:44:59.918819: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 18 nodes (0), 7 edges (0), time = 0.199ms.\r\n2020-02-12 14:44:59.918824: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: cond_true_5592_frozen\r\n2020-02-12 14:44:59.918829: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 10 nodes (0), 8 edges (0), time = 0.248ms.\r\n2020-02-12 14:44:59.918833: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 10 nodes (0), 8 edges (0), time = 0.172ms.\r\n2020-02-12 14:44:59.918838: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: cond_true_5533_frozen\r\n2020-02-12 14:44:59.918846: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 10 nodes (0), 8 edges (0), time = 0.22ms.\r\n2020-02-12 14:44:59.918851: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 10 nodes (0), 8 edges (0), time = 0.198ms.\r\n2020-02-12 14:44:59.918855: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: PadOrClipBoxList_cond_false_5510_frozen\r\n2020-02-12 14:44:59.918860: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 18 nodes (-2), 20 edges (-2), time = 0.72ms.\r\n2020-02-12 14:44:59.918865: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 18 nodes (0), 20 edges (0), time = 0.366ms.\r\n2020-02-12 14:44:59.918869: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: Preprocessor_map_while_cond_19_frozen\r\n2020-02-12 14:44:59.918873: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 11 nodes (0), 7 edges (0), time = 0.222ms.\r\n2020-02-12 14:44:59.918878: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 11 nodes (0), 7 edges (0), time = 0.141ms.\r\n2020-02-12 14:44:59.918882: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: PadOrClipBoxList_cond_2_false_5628_frozen\r\n2020-02-12 14:44:59.918886: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 18 nodes (-2), 20 edges (-2), time = 0.716ms.\r\n2020-02-12 14:44:59.918891: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 18 nodes (0), 20 edges (0), time = 0.369ms.\r\n2020-02-12 14:44:59.918895: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: PadOrClipBoxList_cond_true_5509_frozen\r\n2020-02-12 14:44:59.918899: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 5 nodes (-3), 4 edges (-3), time = 0.278ms.\r\n2020-02-12 14:44:59.918904: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 5 nodes (0), 4 edges (0), time = 0.096ms.\r\n2020-02-12 14:44:59.918908: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: cond_false_5593_frozen\r\n2020-02-12 14:44:59.918913: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 8 nodes (0), 5 edges (0), time = 0.2ms.\r\n2020-02-12 14:44:59.918917: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 8 nodes (0), 5 edges (0), time = 0.125ms.\r\n2020-02-12 14:44:59.918921: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: Postprocessor_BatchMultiClassNonMaxSuppression_map_while_body_4117_frozen\r\n2020-02-12 14:44:59.918926: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 1256 nodes (-34), 1804 edges (0), time = 35.923ms.\r\n2020-02-12 14:44:59.918930: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 1256 nodes (0), 1804 edges (0), time = 22.273ms.\r\n2020-02-12 14:44:59.918935: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: cond_false_5652_frozen\r\n2020-02-12 14:44:59.918939: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 8 nodes (0), 5 edges (0), time = 0.212ms.\r\n2020-02-12 14:44:59.918943: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 8 nodes (0), 5 edges (0), time = 0.129ms.\r\n2020-02-12 14:44:59.918948: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: Preprocessor_map_while_body_20_frozen\r\n2020-02-12 14:44:59.918952: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 28 nodes (-9), 25 edges (-9), time = 1.367ms.\r\n2020-02-12 14:44:59.918956: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 28 nodes (0), 25 edges (0), time = 0.432ms.\r\n2020-02-12 14:44:59.918961: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: PadOrClipBoxList_cond_3_true_5686_frozen\r\n2020-02-12 14:44:59.918965: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 5 nodes (-3), 4 edges (-3), time = 0.29ms.\r\n2020-02-12 14:44:59.918969: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 5 nodes (0), 4 edges (0), time = 0.099ms.\r\n2020-02-12 14:44:59.918974: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: PadOrClipBoxList_cond_3_false_5687_frozen\r\n2020-02-12 14:44:59.918978: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 18 nodes (-2), 20 edges (-2), time = 0.801ms.\r\n2020-02-12 14:44:59.918982: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 18 nodes (0), 20 edges (0), time = 0.382ms.\r\n2020-02-12 14:44:59.918986: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: PadOrClipBoxList_cond_1_false_5569_frozen\r\n2020-02-12 14:44:59.918989: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 18 nodes (-2), 20 edges (-2), time = 0.745ms.\r\n2020-02-12 14:44:59.918994: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 18 nodes (0), 20 edges (0), time = 0.384ms.\r\n2020-02-12 14:44:59.918998: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: cond_true_5651_frozen\r\n2020-02-12 14:44:59.919002: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 10 nodes (0), 8 edges (0), time = 0.228ms.\r\n2020-02-12 14:44:59.919006: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 10 nodes (0), 8 edges (0), time = 0.203ms.\r\n2020-02-12 14:44:59.919011: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: cond_false_5534_frozen\r\n2020-02-12 14:44:59.919015: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 8 nodes (0), 5 edges (0), time = 0.174ms.\r\n2020-02-12 14:44:59.919019: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 8 nodes (0), 5 edges (0), time = 0.126ms.\r\n2020-02-12 14:44:59.919024: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:797] Optimization results for grappler item: PadOrClipBoxList_cond_2_true_5627_frozen\r\n2020-02-12 14:44:59.919028: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 5 nodes (-3), 4 edges (-3), time = 0.298ms.\r\n2020-02-12 14:44:59.919032: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:799]   constant_folding: Graph size after: 5 nodes (0), 4 edges (0), time = 0.101ms.\r\nTraceback (most recent call last):\r\n  File \"convert_to_tflite2.py\", line 105, in <module>\r\n    tflite_model = converter.convert()\r\n  File \"/home/eric/.anaconda3/envs/tf_nightly_gpu/lib/python3.7/site-packages/tensorflow_core/lite/python/lite.py\", line 513, in convert\r\n    **converter_kwargs)\r\n  File \"/home/eric/.anaconda3/envs/tf_nightly_gpu/lib/python3.7/site-packages/tensorflow_core/lite/python/convert.py\", line 496, in toco_convert_impl\r\n    enable_mlir_converter=enable_mlir_converter)\r\n  File \"/home/eric/.anaconda3/envs/tf_nightly_gpu/lib/python3.7/site-packages/tensorflow_core/lite/python/convert.py\", line 227, in toco_convert_protos\r\n    raise ConverterError(\"See console for info.\\n%s\\n%s\\n\" % (stdout, stderr))\r\ntensorflow.lite.python.convert.ConverterError: See console for info.\r\n2020-02-12 14:45:01.509402: W tensorflow/compiler/mlir/lite/python/graphdef_to_tfl_flatbuffer.cc:108] Ignored output_format.\r\n2020-02-12 14:45:01.509437: W tensorflow/compiler/mlir/lite/python/graphdef_to_tfl_flatbuffer.cc:111] Ignored drop_control_dependency.\r\n2020-02-12 14:45:01.712175: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2020-02-12 14:45:01.739469: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 3597955000 Hz\r\n2020-02-12 14:45:01.740229: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55dc06f27020 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n2020-02-12 14:45:01.740266: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\n2020-02-12 14:45:01.744300: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1\r\n2020-02-12 14:45:01.935539: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55dc09be74d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:\r\n2020-02-12 14:45:01.935576: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): TITAN Xp, Compute Capability 6.1\r\n2020-02-12 14:45:01.935585: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): TITAN Xp, Compute Capability 6.1\r\n2020-02-12 14:45:01.937373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties: \r\npciBusID: 0000:01:00.0 name: TITAN Xp computeCapability: 6.1\r\ncoreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 510.07GiB/s\r\n2020-02-12 14:45:01.938710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 1 with properties: \r\npciBusID: 0000:02:00.0 name: TITAN Xp computeCapability: 6.1\r\ncoreClock: 1.582GHz coreCount: 30 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 510.07GiB/s\r\n2020-02-12 14:45:01.938995: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory\r\n2020-02-12 14:45:01.941769: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10\r\n2020-02-12 14:45:01.944257: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10\r\n2020-02-12 14:45:01.944765: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10\r\n2020-02-12 14:45:01.947695: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10\r\n2020-02-12 14:45:01.949183: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10\r\n2020-02-12 14:45:01.949331: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory\r\n2020-02-12 14:45:01.949349: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1595] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.\r\nSkipping registering GPU devices...\r\n2020-02-12 14:45:01.949431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2020-02-12 14:45:01.949448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      0 1 \r\n2020-02-12 14:45:01.949462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0:   N Y \r\n2020-02-12 14:45:01.949473: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 1:   Y N \r\nloc(callsite(\"Preprocessor/map/TensorArrayV2_1\"(\"/home/eric/.anaconda3/envs/tf_nightly_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/lift_to_graph.py\":339:0) at callsite(\"/home/eric/.anaconda3/envs/tf_nightly_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/wrap_function.py\":321:0 at callsite(\"convert_to_tflite2.py\":50:0 at \"convert_to_tflite2.py\":72:0)))): error: operand type 'tensor<i32>' is not compatible with preceding operands; expected rank: 1\r\nTraceback (most recent call last):\r\n  File \"/home/eric/.anaconda3/envs/tf_nightly_gpu/bin/toco_from_protos\", line 8, in <module>\r\n    sys.exit(main())\r\n  File \"/home/eric/.anaconda3/envs/tf_nightly_gpu/lib/python3.7/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 93, in main\r\n    app.run(main=execute, argv=[sys.argv[0]] + unparsed)\r\n  File \"/home/eric/.anaconda3/envs/tf_nightly_gpu/lib/python3.7/site-packages/tensorflow_core/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/home/eric/.anaconda3/envs/tf_nightly_gpu/lib/python3.7/site-packages/absl/app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"/home/eric/.anaconda3/envs/tf_nightly_gpu/lib/python3.7/site-packages/absl/app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/home/eric/.anaconda3/envs/tf_nightly_gpu/lib/python3.7/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 56, in execute\r\n    enable_mlir_converter)\r\nException: /home/eric/.anaconda3/envs/tf_nightly_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/lift_to_graph.py:339:11: error: operand type 'tensor<i32>' is not compatible with preceding operands; expected rank: 1\r\n          op=op, graph=graph, op_map=op_map, base_graph=base_graph)\r\n          ^\r\n/home/eric/.anaconda3/envs/tf_nightly_gpu/lib/python3.7/site-packages/tensorflow_core/python/eager/wrap_function.py:321:9: note: called from\r\n        base_graph=self._func_graph)\r\n        ^\r\nconvert_to_tflite2.py:50:9: note: called from\r\n        tf.nest.map_structure(import_graph.as_graph_element, outputs))\r\n        ^\r\nconvert_to_tflite2.py:72:1: note: called from\r\ninception_func = wrap_frozen_graph(detection_graph.as_graph_def(add_shapes=True), inputs=input_arrays, outputs=output_arrays)\r\n```\r\n\r\n**Also, please include a link to the saved model or GraphDef**\r\n\r\n```\r\nCan't attach, but here's most of the .config file that was used to generate the graph (frozen graph).\r\nmodel {\r\n  ssd {\r\n    inplace_batchnorm_update: true\r\n    freeze_batchnorm: false\r\n    num_classes: 16   \r\n    box_coder {\r\n      faster_rcnn_box_coder {\r\n        y_scale: 10.0\r\n        x_scale: 10.0\r\n        height_scale: 5.0\r\n        width_scale: 5.0\r\n      }\r\n    }\r\n    matcher {\r\n      argmax_matcher {\r\n        matched_threshold: 0.5\r\n        unmatched_threshold: 0.5\r\n        ignore_thresholds: false\r\n        negatives_lower_than_unmatched: true\r\n        force_match_for_each_row: true\r\n        use_matmul_gather: true\r\n      }\r\n    }\r\n    similarity_calculator {\r\n      iou_similarity {\r\n      }\r\n    }\r\n    encode_background_as_zeros: true\r\n    anchor_generator {\r\n      multiscale_anchor_generator {\r\n        min_level: 3\r\n        max_level: 7\r\n        anchor_scale: 4.0\r\n        aspect_ratios: [1.0, 2.0, 0.5]\r\n        scales_per_octave: 2\r\n      }\r\n    }\r\n    image_resizer {\r\n      fixed_shape_resizer {\r\n        height: 640\r\n        width: 640\r\n      }\r\n    }\r\n    box_predictor {\r\n      weight_shared_convolutional_box_predictor {\r\n        depth: 256\r\n        class_prediction_bias_init: -4.6\r\n        conv_hyperparams {\r\n          activation: RELU_6,\r\n          regularizer {\r\n            l2_regularizer {\r\n              weight: 0.00004\r\n            }\r\n          }\r\n          initializer {\r\n            random_normal_initializer {\r\n              stddev: 0.01\r\n              mean: 0.0\r\n            }\r\n          }\r\n          batch_norm {\r\n            scale: true,\r\n            decay: 0.997,\r\n            epsilon: 0.001,\r\n          }\r\n        }\r\n        num_layers_before_predictor: 4\r\n        kernel_size: 3\r\n      }\r\n    }\r\n    feature_extractor {\r\n      type: 'ssd_mobilenet_v1_fpn'\r\n      min_depth: 16\r\n      depth_multiplier: 1.0\r\n      conv_hyperparams {\r\n        activation: RELU_6,\r\n        regularizer {\r\n          l2_regularizer {\r\n            weight: 0.00004\r\n          }\r\n        }\r\n        initializer {\r\n          random_normal_initializer {\r\n            stddev: 0.01\r\n            mean: 0.0\r\n          }\r\n        }\r\n        batch_norm {\r\n          scale: true,\r\n          decay: 0.997,\r\n          epsilon: 0.001,\r\n        }\r\n      }\r\n      override_base_feature_extractor_hyperparams: true\r\n    }\r\n    loss {\r\n      classification_loss {\r\n        weighted_sigmoid_focal {\r\n          alpha: 0.25\r\n          gamma: 2.0\r\n        }\r\n      }\r\n      localization_loss {\r\n        weighted_smooth_l1 {\r\n        }\r\n      }\r\n      classification_weight: 1.0\r\n      localization_weight: 1.0\r\n    }\r\n    normalize_loss_by_num_matches: true\r\n    normalize_loc_loss_by_codesize: true\r\n    post_processing {\r\n      batch_non_max_suppression {\r\n        score_threshold: 1e-8\r\n        iou_threshold: 0.6\r\n        max_detections_per_class: 100\r\n        max_total_detections: 100\r\n      }\r\n      score_converter: SIGMOID\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n**Failure details**\r\nModel crashes on conversion\r\n\r\n\r\n**Any other info / logs**\r\n\r\nWe use the generator scripts in the tensorflow object_detection library to actually make and train our neural net, so it's not easy to see what code would be breaking this. "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36710", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36710/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36710/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36710/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36710", "id": 564233357, "node_id": "MDU6SXNzdWU1NjQyMzMzNTc=", "number": 36710, "title": "Infinite recursion in TFModuleWrapper.__getattr__", "user": {"login": "chrishmorris", "id": 8377815, "node_id": "MDQ6VXNlcjgzNzc4MTU=", "avatar_url": "https://avatars3.githubusercontent.com/u/8377815?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chrishmorris", "html_url": "https://github.com/chrishmorris", "followers_url": "https://api.github.com/users/chrishmorris/followers", "following_url": "https://api.github.com/users/chrishmorris/following{/other_user}", "gists_url": "https://api.github.com/users/chrishmorris/gists{/gist_id}", "starred_url": "https://api.github.com/users/chrishmorris/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chrishmorris/subscriptions", "organizations_url": "https://api.github.com/users/chrishmorris/orgs", "repos_url": "https://api.github.com/users/chrishmorris/repos", "events_url": "https://api.github.com/users/chrishmorris/events{/privacy}", "received_events_url": "https://api.github.com/users/chrishmorris/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "yifeif", "id": 1192265, "node_id": "MDQ6VXNlcjExOTIyNjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/1192265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yifeif", "html_url": "https://github.com/yifeif", "followers_url": "https://api.github.com/users/yifeif/followers", "following_url": "https://api.github.com/users/yifeif/following{/other_user}", "gists_url": "https://api.github.com/users/yifeif/gists{/gist_id}", "starred_url": "https://api.github.com/users/yifeif/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yifeif/subscriptions", "organizations_url": "https://api.github.com/users/yifeif/orgs", "repos_url": "https://api.github.com/users/yifeif/repos", "events_url": "https://api.github.com/users/yifeif/events{/privacy}", "received_events_url": "https://api.github.com/users/yifeif/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "yifeif", "id": 1192265, "node_id": "MDQ6VXNlcjExOTIyNjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/1192265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yifeif", "html_url": "https://github.com/yifeif", "followers_url": "https://api.github.com/users/yifeif/followers", "following_url": "https://api.github.com/users/yifeif/following{/other_user}", "gists_url": "https://api.github.com/users/yifeif/gists{/gist_id}", "starred_url": "https://api.github.com/users/yifeif/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yifeif/subscriptions", "organizations_url": "https://api.github.com/users/yifeif/orgs", "repos_url": "https://api.github.com/users/yifeif/repos", "events_url": "https://api.github.com/users/yifeif/events{/privacy}", "received_events_url": "https://api.github.com/users/yifeif/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-02-12T19:56:15Z", "updated_at": "2020-02-29T01:16:59Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes \r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Docker container gcr.io/deeplearning-platform-release/tf-cpu.1-15\r\n- **TensorFlow version (use command below)**: v1.15\r\n- **Python version**: Python 3.5.6 :: Anaconda, Inc.\r\n- **Exact command to reproduce**:\r\n\r\n### Describe the problem\r\nWhen running a complex Apache Beam job using Tensorflow to create TFRecords, the jobs fails with \r\n....\r\n  File \"/usr/local/lib/python3.5/site-packages/tensorflow_core/python/util/module_wrapper.py\", line 192, in __getattr__\r\n    attr = getattr(self._tfmw_wrapped_module, name)\r\n  File \"/usr/local/lib/python3.5/site-packages/tensorflow_core/python/util/module_wrapper.py\", line 192, in __getattr__\r\n    attr = getattr(self._tfmw_wrapped_module, name)\r\n  File \"/usr/local/lib/python3.5/site-packages/tensorflow_core/python/util/module_wrapper.py\", line 192, in __getattr__\r\n    attr = getattr(self._tfmw_wrapped_module, name)\r\n  File \"/usr/local/lib/python3.5/site-packages/tensorflow_core/python/util/module_wrapper.py\", line 160, in __getattribute__\r\n    attr_map = object.__getattribute__(self, '_tfmw_attr_map')\r\nRecursionError: maximum recursion depth exceeded while calling a Python object\r\n\r\nSorry, I have been unable to isolate a test case. However, TFModuleWrapper.__getattr__ does look vulberable to recursion errors. See https://nedbatchelder.com/blog/201010/surprising_getattr_recursion.html for a discussion of a similar problem.\r\n\r\nI am not using kivy, so this is probably different than: https://github.com/tensorflow/tensorflow/issues/27312 \r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36705", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36705/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36705/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36705/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36705", "id": 564198554, "node_id": "MDU6SXNzdWU1NjQxOTg1NTQ=", "number": 36705, "title": "TFLite: allocate_tensors() fails for 2 dense layers with quantization", "user": {"login": "julian-urban", "id": 30963828, "node_id": "MDQ6VXNlcjMwOTYzODI4", "avatar_url": "https://avatars2.githubusercontent.com/u/30963828?v=4", "gravatar_id": "", "url": "https://api.github.com/users/julian-urban", "html_url": "https://github.com/julian-urban", "followers_url": "https://api.github.com/users/julian-urban/followers", "following_url": "https://api.github.com/users/julian-urban/following{/other_user}", "gists_url": "https://api.github.com/users/julian-urban/gists{/gist_id}", "starred_url": "https://api.github.com/users/julian-urban/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/julian-urban/subscriptions", "organizations_url": "https://api.github.com/users/julian-urban/orgs", "repos_url": "https://api.github.com/users/julian-urban/repos", "events_url": "https://api.github.com/users/julian-urban/events{/privacy}", "received_events_url": "https://api.github.com/users/julian-urban/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "daverim", "id": 2448933, "node_id": "MDQ6VXNlcjI0NDg5MzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/2448933?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daverim", "html_url": "https://github.com/daverim", "followers_url": "https://api.github.com/users/daverim/followers", "following_url": "https://api.github.com/users/daverim/following{/other_user}", "gists_url": "https://api.github.com/users/daverim/gists{/gist_id}", "starred_url": "https://api.github.com/users/daverim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daverim/subscriptions", "organizations_url": "https://api.github.com/users/daverim/orgs", "repos_url": "https://api.github.com/users/daverim/repos", "events_url": "https://api.github.com/users/daverim/events{/privacy}", "received_events_url": "https://api.github.com/users/daverim/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "daverim", "id": 2448933, "node_id": "MDQ6VXNlcjI0NDg5MzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/2448933?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daverim", "html_url": "https://github.com/daverim", "followers_url": "https://api.github.com/users/daverim/followers", "following_url": "https://api.github.com/users/daverim/following{/other_user}", "gists_url": "https://api.github.com/users/daverim/gists{/gist_id}", "starred_url": "https://api.github.com/users/daverim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daverim/subscriptions", "organizations_url": "https://api.github.com/users/daverim/orgs", "repos_url": "https://api.github.com/users/daverim/repos", "events_url": "https://api.github.com/users/daverim/events{/privacy}", "received_events_url": "https://api.github.com/users/daverim/received_events", "type": "User", "site_admin": false}, {"login": "terryheo", "id": 2908505, "node_id": "MDQ6VXNlcjI5MDg1MDU=", "avatar_url": "https://avatars2.githubusercontent.com/u/2908505?v=4", "gravatar_id": "", "url": "https://api.github.com/users/terryheo", "html_url": "https://github.com/terryheo", "followers_url": "https://api.github.com/users/terryheo/followers", "following_url": "https://api.github.com/users/terryheo/following{/other_user}", "gists_url": "https://api.github.com/users/terryheo/gists{/gist_id}", "starred_url": "https://api.github.com/users/terryheo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/terryheo/subscriptions", "organizations_url": "https://api.github.com/users/terryheo/orgs", "repos_url": "https://api.github.com/users/terryheo/repos", "events_url": "https://api.github.com/users/terryheo/events{/privacy}", "received_events_url": "https://api.github.com/users/terryheo/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2020-02-12T18:54:00Z", "updated_at": "2020-02-26T23:47:36Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (or github SHA if from source): 1.15.0\r\n\r\nI'm trying to convert a model built with keras to tflite in order to run it on an Edge TPU. If I use more than one dense layer, allocate_tensors() throws an error. It only happens for full integer quantization with a representative dataset. Here is a minimal example which reproduces this error:\r\n\r\n```\r\nimport keras\r\nimport tensorflow as tf\r\nimport tflite_runtime.interpreter as tflite\r\nimport numpy as np\r\n\r\n\r\nn = 16\r\n\r\ndense_1 = keras.layers.Dense(n)\r\ndense_2 = keras.layers.Dense(n)\r\n\r\nx = keras.layers.Input(shape=(n,))\r\n\r\ny = dense_1(x)\r\ny = dense_2(y)\r\n\r\nmodel = keras.models.Model(inputs=[x], outputs=[y])\r\n\r\nmodel.compile(optimizer='rmsprop', loss='mean_squared_error')\r\nmodel.save('example.h5')\r\n\r\ninput_shapes = {}\r\ninput_shapes['input_1'] = (1, n)\r\nconverter = tf.lite.TFLiteConverter.from_keras_model_file('example.h5', input_shapes=input_shapes)\r\n\r\nconverter.optimizations = [tf.lite.Optimize.DEFAULT]\r\nconverter.target_spec.supported_ops = [tf.lite.OpsSet.TFLITE_BUILTINS_INT8]\r\n\r\ndef rep_data_gen():\r\n\tfor _ in range(100):\r\n\t\tyield [np.random.rand(1, n).astype(np.float32)]\r\n\r\nconverter.representative_dataset = rep_data_gen\r\n\r\ntflite_model = converter.convert()\r\nopen(\"example.tflite\", \"wb\").write(tflite_model)\r\n\r\ninterpreter = tflite.Interpreter(\"example.tflite\",\r\n\t\t\t\t\t\t\t\t experimental_delegates=[tflite.load_delegate('libedgetpu.so.1')])\r\n\r\ninterpreter.allocate_tensors()\r\n```\r\n\r\nThe error:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"example.py\", line 43, in <module>\r\n    interpreter.allocate_tensors()\r\n  File \"/home/julian/anaconda3/envs/keras/lib/python3.7/site-packages/tflite_runtime/interpreter.py\", line 244, in allocate_tensors\r\n    return self._interpreter.AllocateTensors()\r\n  File \"/home/julian/anaconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/lite/python/interpreter_wrapper/tensorflow_wrap_interpreter_wrapper.py\", line 106, in AllocateTensors\r\n    return _tensorflow_wrap_interpreter_wrapper.InterpreterWrapper_AllocateTensors(self)\r\nRuntimeError: tensorflow/lite/kernels/kernel_util.cc:106 std::abs(input_product_scale - bias_scale) <= 1e-6 * std::min(input_product_scale, bias_scale) was not true.Node number 2 (FULLY_CONNECTED) failed to prepare.\r\n```\r\n\r\nNote that the error doesn't occur when I drop ```y = dense_2(y)```. I feel like I am missing something simple, but what is it? This is the simplest two-layer model I can imagine, so it should really work."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36700", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36700/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36700/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36700/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36700", "id": 564120890, "node_id": "MDU6SXNzdWU1NjQxMjA4OTA=", "number": 36700, "title": "tf2 isn't enabled in tensorflow_core.python.keras.layers.__init__", "user": {"login": "EmGarr", "id": 9768541, "node_id": "MDQ6VXNlcjk3Njg1NDE=", "avatar_url": "https://avatars1.githubusercontent.com/u/9768541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/EmGarr", "html_url": "https://github.com/EmGarr", "followers_url": "https://api.github.com/users/EmGarr/followers", "following_url": "https://api.github.com/users/EmGarr/following{/other_user}", "gists_url": "https://api.github.com/users/EmGarr/gists{/gist_id}", "starred_url": "https://api.github.com/users/EmGarr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/EmGarr/subscriptions", "organizations_url": "https://api.github.com/users/EmGarr/orgs", "repos_url": "https://api.github.com/users/EmGarr/repos", "events_url": "https://api.github.com/users/EmGarr/events{/privacy}", "received_events_url": "https://api.github.com/users/EmGarr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-02-12T16:35:26Z", "updated_at": "2020-02-17T20:27:58Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04\r\n- TensorFlow installed from (source or binary): pip install tensorflow==2.1\r\n- TensorFlow version (use command below): 2.1\r\n- Python version: 3.6.6\r\n- CUDA/cuDNN version: Not used\r\n- GPU model and memory: Not used\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\n\r\nWhenever you import a layer using the path:\r\n `from tensorflow.python.keras.layers`\r\n\r\nIt will import the layer using the tensorflow 1.X behavior.\r\nWhich isn't the case when we use tensorflow.keras.layers.\r\n\r\nThe issue is that every networks from tf.keras.applications (resnet, densenet...) use those import which can lead to some severe bugs (e.g: BatchNormalization).\r\n\r\n**Describe the expected behavior**\r\nImporting from `from tensorflow.python.keras.layers` and `from tensorflow.keras.layers` should have exactly the same behavior (2.X).\r\n\r\n**Code to reproduce the issue**\r\n```python\r\nfrom tensorflow.python.keras.layers import BatchNormalization as buggy_BN\r\nfrom tensorflow.keras.layers import BatchNormalization as good_BN\r\n\r\nprint(good_BN()._USE_V2_BEHAVIOR) # TRUE\r\nprint(buggy_BN()._USE_V2_BEHAVIOR) # FALSE\r\n```\r\n\r\n**Other info / logs**\r\n\r\nI think that the issue could be fix by changing this [tensorflow_core.python.tf2](https://github.com/tensorflow/tensorflow/blob/9bd55fcb645500a2c859cb3390f32b3a7c48327f/tensorflow/python/tf2.py#L43).\r\n\r\nfrom\r\n\r\n```python\r\ndef enabled():\r\n  \"\"\"Returns True iff TensorFlow 2.0 behavior should be enabled.\"\"\"\r\n  if _force_enable is None:\r\n    return os.getenv(\"TF2_BEHAVIOR\", \"0\") != \"0\"\r\n  else:\r\n    return _force_enable\r\n```\r\nto\r\n\r\n```python\r\ndef enabled():\r\n  \"\"\"Returns True iff TensorFlow 2.0 behavior should be enabled.\"\"\"\r\n  if _force_enable is None:\r\n    return os.getenv(\"TF2_BEHAVIOR\", \"1\") != \"0\"\r\n  else:\r\n    return _force_enable\r\n```\r\nit will make TF2_BEHAVIOR enabled by default"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36694", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36694/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36694/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36694/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36694", "id": 563959807, "node_id": "MDU6SXNzdWU1NjM5NTk4MDc=", "number": 36694, "title": "Different gradient results for same custom loss function in Tensorflow 2.0", "user": {"login": "aGiant", "id": 25084782, "node_id": "MDQ6VXNlcjI1MDg0Nzgy", "avatar_url": "https://avatars0.githubusercontent.com/u/25084782?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aGiant", "html_url": "https://github.com/aGiant", "followers_url": "https://api.github.com/users/aGiant/followers", "following_url": "https://api.github.com/users/aGiant/following{/other_user}", "gists_url": "https://api.github.com/users/aGiant/gists{/gist_id}", "starred_url": "https://api.github.com/users/aGiant/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aGiant/subscriptions", "organizations_url": "https://api.github.com/users/aGiant/orgs", "repos_url": "https://api.github.com/users/aGiant/repos", "events_url": "https://api.github.com/users/aGiant/events{/privacy}", "received_events_url": "https://api.github.com/users/aGiant/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-02-12T12:14:08Z", "updated_at": "2020-02-17T04:14:11Z", "closed_at": null, "author_association": "NONE", "body": "Tensorflow 2.0 & Python 3.7\r\n\r\n```\r\ndef custom_loss2(output2, label2):\r\n    loss_value = K.mean(binary_crossentropy(label2, output2)) \r\n    return loss_value\r\ndef EWC_loss(new_weights, old_weights, fisher_matrix, rate):\r\n    sum_w = 0\r\n    for v in range(len(fisher_matrix)):\r\n        sum_w += tf.reduce_sum(tf.multiply(fisher_matrix[v], tf.square(new_weights[v] - old_weights[v]))) \r\n    return sum_w*rate\r\n```\r\n\r\nTwo different trains, the same results were expected but two very different results came out. \r\nFirst one, just let rate = 0.5\r\n\r\n```\r\ndel optimizer\r\ndel tape\r\noptimizer = tf.keras.optimizers.SGD()\r\newc_model = tf.keras.models.clone_model(model)\r\nold_weights = model.trainable_variables.copy()\r\nfor epoch in range(num_epochs):\r\n    with tf.GradientTape() as tape:\r\n        out = ewc_model(features_t)\r\n        new_weights = ewc_model.trainable_variables.copy()\r\n        ewc_loss = EWC_loss(new_weights, old_weights, fisher_matrix, 0.5)\r\n        loss = ewc_loss + custom_loss2(out, labels_2_t)\r\n        grad = tape.gradient(loss, ewc_model.trainable_variables)\r\n        optimizer.apply_gradients(grads_and_vars=zip(grad, ewc_model.trainable_variables))\r\n    if (epoch+1)%100 == 0:\r\n        print(\"epch: {}, loss: {}\".format(epoch, loss.numpy()))\r\n        print(ewc_loss.numpy(), loss.numpy())\r\n```\r\n\r\nIn case II, just put the factor out and let rate = 1.0 but put 0.5 to ewc_loss:\r\n\r\n```\r\ndel optimizer\r\ndel tape\r\noptimizer = tf.keras.optimizers.SGD()\r\newc_model = tf.keras.models.clone_model(model)\r\nold_weights = model.trainable_variables.copy()\r\nfor epoch in range(num_epochs):\r\n    with tf.GradientTape() as tape:\r\n        out = ewc_model(features_t)\r\n        new_weights = ewc_model.trainable_variables.copy()\r\n        ewc_loss = 0.5*EWC_loss(new_weights, old_weights, fisher_matrix, 1.0)\r\n        loss = ewc_loss + custom_loss2(out, labels_2_t)\r\n        grad = tape.gradient(loss, ewc_model.trainable_variables)\r\n        optimizer.apply_gradients(grads_and_vars=zip(grad, ewc_model.trainable_variables))\r\n    if (epoch+1)%100 == 0:\r\n        print(\"epch: {}, loss: {}\".format(epoch, loss.numpy()))\r\n        print(ewc_loss.numpy(), loss.numpy())\r\n```\r\n\r\nTests were with random samples, but the same for those test codes described above. \r\nWe evaluated the model using two test sets, loss = custom_loss2(prd, labels_2). \r\nThe first case returned:\r\n\r\n```\r\ntf.Tensor(14.144677747478463, shape=(), dtype=float64)\r\ntf.Tensor(14.254150624518838, shape=(), dtype=float64)\r\n```\r\n\r\nbut the case II returned:\r\n\r\n```\r\ntf.Tensor(0.15645654679566814, shape=(), dtype=float64)\r\ntf.Tensor(0.263113701303186, shape=(), dtype=float64)\r\n```\r\n\r\nCan anyone identify this issue? If the gradient was wrong, then the risk of applying tf.GradientTape() is very high using custom loss function."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36688", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36688/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36688/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36688/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36688", "id": 563863797, "node_id": "MDU6SXNzdWU1NjM4NjM3OTc=", "number": 36688, "title": "RNN support for Tensorflow Lite Micro", "user": {"login": "padoremu", "id": 42805615, "node_id": "MDQ6VXNlcjQyODA1NjE1", "avatar_url": "https://avatars1.githubusercontent.com/u/42805615?v=4", "gravatar_id": "", "url": "https://api.github.com/users/padoremu", "html_url": "https://github.com/padoremu", "followers_url": "https://api.github.com/users/padoremu/followers", "following_url": "https://api.github.com/users/padoremu/following{/other_user}", "gists_url": "https://api.github.com/users/padoremu/gists{/gist_id}", "starred_url": "https://api.github.com/users/padoremu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/padoremu/subscriptions", "organizations_url": "https://api.github.com/users/padoremu/orgs", "repos_url": "https://api.github.com/users/padoremu/repos", "events_url": "https://api.github.com/users/padoremu/events{/privacy}", "received_events_url": "https://api.github.com/users/padoremu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rockyrhodes", "id": 7253968, "node_id": "MDQ6VXNlcjcyNTM5Njg=", "avatar_url": "https://avatars2.githubusercontent.com/u/7253968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rockyrhodes", "html_url": "https://github.com/rockyrhodes", "followers_url": "https://api.github.com/users/rockyrhodes/followers", "following_url": "https://api.github.com/users/rockyrhodes/following{/other_user}", "gists_url": "https://api.github.com/users/rockyrhodes/gists{/gist_id}", "starred_url": "https://api.github.com/users/rockyrhodes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rockyrhodes/subscriptions", "organizations_url": "https://api.github.com/users/rockyrhodes/orgs", "repos_url": "https://api.github.com/users/rockyrhodes/repos", "events_url": "https://api.github.com/users/rockyrhodes/events{/privacy}", "received_events_url": "https://api.github.com/users/rockyrhodes/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rockyrhodes", "id": 7253968, "node_id": "MDQ6VXNlcjcyNTM5Njg=", "avatar_url": "https://avatars2.githubusercontent.com/u/7253968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rockyrhodes", "html_url": "https://github.com/rockyrhodes", "followers_url": "https://api.github.com/users/rockyrhodes/followers", "following_url": "https://api.github.com/users/rockyrhodes/following{/other_user}", "gists_url": "https://api.github.com/users/rockyrhodes/gists{/gist_id}", "starred_url": "https://api.github.com/users/rockyrhodes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rockyrhodes/subscriptions", "organizations_url": "https://api.github.com/users/rockyrhodes/orgs", "repos_url": "https://api.github.com/users/rockyrhodes/repos", "events_url": "https://api.github.com/users/rockyrhodes/events{/privacy}", "received_events_url": "https://api.github.com/users/rockyrhodes/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-12T09:26:11Z", "updated_at": "2020-02-12T20:21:43Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version: v1.12.1-23779-g96c5c8a 2.2.0-dev20200202\r\n- Are you willing to contribute it: No\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nSupport of RNNs is currently missing in Tensorflow Lite Micro. I've been testing with an RNN with GRU cells. Simple code (from [here](https://github.com/tensorflow/tensorflow/issues/33416#issuecomment-585081574)):\r\n\r\n```python\r\nimport tensorflow as tf\r\n\r\nmodel = tf.keras.Sequential()\r\n\r\nmodel.add(tf.keras.layers.Input(shape=(1, 1,)))\r\n\r\ncell = tf.keras.layers.GRUCell(10)\r\n\r\nmodel.add(tf.keras.layers.RNN(cell, unroll=True))\r\n\r\nconverter = tf.lite.TFLiteConverter.from_keras_model(model)\r\nconverter.experimental_new_converter = True\r\n\r\ntflite_model = converter.convert()\r\n\r\n# for testing if operations are implemented by Tensorflow Lite\r\ninterpreter = tf.lite.Interpreter(model_content=tflite_model)\r\ninterpreter.allocate_tensors()\r\ninterpreter.invoke()\r\n```\r\n\r\nThe current situation is (missing ops):\r\n- `experimental_new_converter=True, unroll=True`: builtin ops SHAPE, TRANSPOSE, FILL, SPLIT_V, SUB, TANH\r\n- `experimental_new_converter=True, unroll=False`: 3 subgraphs (only 1 subgraph supported)\r\n- `experimental_new_converter=False, unroll=True`: builtin ops SPLIT_V, SUB, TANH\r\n- `experimental_new_converter=False, unroll=False`: custom ops TensorListFromTensor, TensorListReserve, TensorListStack, While\r\n\r\nMy questions are:\r\n\r\n1. Are there any tangible plans to implement the missing ops for RNNs for Tensorflow Lite Micro and if so, which one of the four variants will be the way to go?\r\n2. Is it currently possible to somehow make the Toco converter for the non-unrolled case (i.e. `experimental_new_converter=False, unroll=False`) to convert the RNN just as a single (unsupported) placeholder RNN op rather than splitting it up into the four (unsupported) operators TensorListFromTensor, TensorListReserve, TensorListStack, While?\r\n\r\nThank you.\r\n\r\n**Will this change the current api? How?**\r\nNo\r\n\r\n**Who will benefit with this feature?**\r\nEverybody who needs RNNs with Tensorflow Lite Micro.\r\n\r\n**Any Other info.**\r\nNone"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36686", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36686/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36686/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36686/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36686", "id": 563850831, "node_id": "MDU6SXNzdWU1NjM4NTA4MzE=", "number": 36686, "title": "Dataset padded_batch fails with InvalidArgumentError", "user": {"login": "stathva", "id": 36402609, "node_id": "MDQ6VXNlcjM2NDAyNjA5", "avatar_url": "https://avatars3.githubusercontent.com/u/36402609?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stathva", "html_url": "https://github.com/stathva", "followers_url": "https://api.github.com/users/stathva/followers", "following_url": "https://api.github.com/users/stathva/following{/other_user}", "gists_url": "https://api.github.com/users/stathva/gists{/gist_id}", "starred_url": "https://api.github.com/users/stathva/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stathva/subscriptions", "organizations_url": "https://api.github.com/users/stathva/orgs", "repos_url": "https://api.github.com/users/stathva/repos", "events_url": "https://api.github.com/users/stathva/events{/privacy}", "received_events_url": "https://api.github.com/users/stathva/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}, {"login": "edloper", "id": 5790348, "node_id": "MDQ6VXNlcjU3OTAzNDg=", "avatar_url": "https://avatars1.githubusercontent.com/u/5790348?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edloper", "html_url": "https://github.com/edloper", "followers_url": "https://api.github.com/users/edloper/followers", "following_url": "https://api.github.com/users/edloper/following{/other_user}", "gists_url": "https://api.github.com/users/edloper/gists{/gist_id}", "starred_url": "https://api.github.com/users/edloper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edloper/subscriptions", "organizations_url": "https://api.github.com/users/edloper/orgs", "repos_url": "https://api.github.com/users/edloper/repos", "events_url": "https://api.github.com/users/edloper/events{/privacy}", "received_events_url": "https://api.github.com/users/edloper/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-02-12T09:02:16Z", "updated_at": "2020-02-21T18:44:15Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 2.1.0\r\n- Python version: 3.6\r\n\r\n**Describe the current behavior**\r\n```\r\nrt = tf.ragged.constant([[1,2,3], [2], [1,2,3,4], [1,1]])\r\nds = tf.data.Dataset.from_tensor_slices(rt)\r\nds.padded_batch(2, padded_shapes=[None])\r\n```\r\nFails with the following error:\r\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"/home/vas/anaconda3/envs/text-ai/lib/python3.6/site-packages/tensorflow_core/python/data/ops/dataset_ops.py\", line 1481, in padded_batch\r\n    drop_remainder)\r\n  File \"/home/vas/anaconda3/envs/text-ai/lib/python3.6/site-packages/tensorflow_core/python/data/ops/dataset_ops.py\", line 3858, in __init__\r\n    output_shapes=structure.get_flat_tensor_shapes(self._structure))\r\n  File \"/home/vas/anaconda3/envs/text-ai/lib/python3.6/site-packages/tensorflow_core/python/ops/gen_dataset_ops.py\", line 4091, in padded_batch_dataset_v2\r\n    _ops.raise_from_not_ok_status(e, name)\r\n  File \"/home/vas/anaconda3/envs/text-ai/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py\", line 6606, in raise_from_not_ok_status\r\n    six.raise_from(core._status_to_exception(e.code, message), None)\r\n  File \"<string>\", line 3, in raise_from\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Mismatched type between padding value 0 and input dataset's component 0: int32 vs. variant [Op:PaddedBatchDatasetV2]\r\n```\r\nHowever:\r\n```\r\nds.map(lambda x: x).padded_batch(2, padded_shapes=[None])\r\n```\r\nworks as expected"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36679", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36679/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36679/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36679/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36679", "id": 563785079, "node_id": "MDU6SXNzdWU1NjM3ODUwNzk=", "number": 36679, "title": "tf.keras.layers.Softmax should respect image_data_format by default", "user": {"login": "dd1923", "id": 22530039, "node_id": "MDQ6VXNlcjIyNTMwMDM5", "avatar_url": "https://avatars0.githubusercontent.com/u/22530039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dd1923", "html_url": "https://github.com/dd1923", "followers_url": "https://api.github.com/users/dd1923/followers", "following_url": "https://api.github.com/users/dd1923/following{/other_user}", "gists_url": "https://api.github.com/users/dd1923/gists{/gist_id}", "starred_url": "https://api.github.com/users/dd1923/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dd1923/subscriptions", "organizations_url": "https://api.github.com/users/dd1923/orgs", "repos_url": "https://api.github.com/users/dd1923/repos", "events_url": "https://api.github.com/users/dd1923/events{/privacy}", "received_events_url": "https://api.github.com/users/dd1923/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-12T06:35:02Z", "updated_at": "2020-02-19T18:13:39Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): 2.1.0\r\n- Are you willing to contribute it (Yes/No): No\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nTensorflow allows one to set image_data_format of either channels_last (set by default, NHWC) or channels_first (NCHW) using `tf.keras.backend.set_image_data_format(data_format)`. Doing so nicely results in almost all layers of the `tf.keras.model` adjust appropriately by either bringing the channel last or first. Even the model.load_weights() work perfectly fine (and transparently), respecting user's choice of image_data_format, as it should. The story is somewhat different when it comes to `tf.keras.layers.Softmax`. Softmax layer/activation is often used in classification problems to normalize the output of the model and such normalization is applied w.r.t to an axis. Currently, Softmax implementation always sets the default value of axis = -1, which is the last axis. This works perfectly fine when image_data_format is channels_last but it for channels_first, one needs to explicitly set the axis to 1. \r\n\r\nThis feels like slightly out of sync compared to how all the other layers behave. They respect the image_data_format automatically and adjust accordingly. So why not Softmax? I am pretty sure 90% of the use cases of Softmax applies the function along the channels axis, so why not make it respect the data format automatically,too ?\r\n\r\nThis is also easy to miss for folks just getting started with TensorFlow. The docs does not mention anything remotely about this.\r\n\r\n**Will this change the current api? How?**\r\nYes. `tf.keras.layers.Softmax` would start respecting the default set_image_data_format set by user and hence axis would be -1 incase of NHWC and 1 incase of NCHW.\r\n\r\nThis would also allow one to easily specify `activation=\"softmax\"` in the last layer instead of adding one explicit line like :\r\n\r\n`model.add(tf.keras.layers.Softmax(axis=-1 if data_format==\"channels_last\" else 1))`\r\n\r\n**Who will benefit with this feature?**\r\nA big group of people who are either using Softmax in its default form (i.e. to normalize along channels axis) or someone who is getting started with TF and wants to have flexibility of changing image data layouts. This would render a uniform API experience and expectation to end-user, trusting that tensorflow's layers are respecting the global image data format without much hassle or individual treatment.\r\n\r\n**Any Other info.**\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36677", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36677/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36677/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36677/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36677", "id": 563731068, "node_id": "MDU6SXNzdWU1NjM3MzEwNjg=", "number": 36677, "title": "Custom training loss with custom gradients", "user": {"login": "rohanmohapatra", "id": 31756343, "node_id": "MDQ6VXNlcjMxNzU2MzQz", "avatar_url": "https://avatars2.githubusercontent.com/u/31756343?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rohanmohapatra", "html_url": "https://github.com/rohanmohapatra", "followers_url": "https://api.github.com/users/rohanmohapatra/followers", "following_url": "https://api.github.com/users/rohanmohapatra/following{/other_user}", "gists_url": "https://api.github.com/users/rohanmohapatra/gists{/gist_id}", "starred_url": "https://api.github.com/users/rohanmohapatra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rohanmohapatra/subscriptions", "organizations_url": "https://api.github.com/users/rohanmohapatra/orgs", "repos_url": "https://api.github.com/users/rohanmohapatra/repos", "events_url": "https://api.github.com/users/rohanmohapatra/events{/privacy}", "received_events_url": "https://api.github.com/users/rohanmohapatra/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-02-12T03:44:43Z", "updated_at": "2020-02-14T10:50:46Z", "closed_at": null, "author_association": "NONE", "body": "I am trying to write a custom loss in Tensorflow v2, for simplicity let's say that I'm using Mean Squared Error loss as follows,\r\n```\r\nloss_object = tf.keras.losses.MeanSquaredError()\r\n\r\n\r\ndef loss(model, x, y, training):\r\n  # training=training is needed only if there are layers with different\r\n  # behavior during training versus inference (e.g. Dropout).\r\n  y_ = model(x, training=training)\r\n  return loss_object(y_true=y, y_pred=y_)\r\n```\r\n\r\nNow I know that Tensorflow does [automatic differentiation](https://stackoverflow.com/questions/48219296/why-doesnt-keras-need-the-gradient-of-a-custom-loss-function).\r\n\r\nBut I want to specify my **custom gradient**, in the BackPropagation algorithm,\r\nif we use MSE, we have to do the following \r\n\r\n<a href=\"https://www.codecogs.com/eqnedit.php?latex=\\frac{\\partial&space;E}{\\partial&space;w}&space;=&space;\\frac{\\partial&space;E}{\\partial&space;y_i}&space;\\frac{\\partial&space;y_i}{\\partial&space;net_i}&space;\\frac{\\partial&space;net_i}{\\partial&space;w}\" target=\"_blank\"><img src=\"https://latex.codecogs.com/gif.latex?\\frac{\\partial&space;E}{\\partial&space;w}&space;=&space;\\frac{\\partial&space;E}{\\partial&space;y_i}&space;\\frac{\\partial&space;y_i}{\\partial&space;net_i}&space;\\frac{\\partial&space;net_i}{\\partial&space;w}\" title=\"\\frac{\\partial E}{\\partial w} = \\frac{\\partial E}{\\partial y_i} \\frac{\\partial y_i}{\\partial net_i} \\frac{\\partial net_i}{\\partial w}\" /></a>\r\n\r\n<img src=\"https://latex.codecogs.com/gif.latex?\\frac{\\partial&space;E}{\\partial&space;w}&space;=&space;(y&space;-&space;\\hat{y})*&space;D(activation)&space;*&space;x\" title=\"\\frac{\\partial E}{\\partial w} = (y - \\hat{y})* D(activation) * x\" />\r\n\r\nIs it possible in **Keras** to replace <a href=\"https://www.codecogs.com/eqnedit.php?latex=(y&space;-&space;\\hat{y})\" target=\"_blank\"><img src=\"https://latex.codecogs.com/gif.latex?(y&space;-&space;\\hat{y})\" title=\"(y - \\hat{y})\" /></a>  with <a href=\"https://www.codecogs.com/eqnedit.php?latex=(y&space;-&space;p)\" target=\"_blank\"><img src=\"https://latex.codecogs.com/gif.latex?(y&space;-&space;p)\" title=\"(y - p)\" /></a> where `p` is a tensor that is passed during training before applying gradients.\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36675", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36675/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36675/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36675/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36675", "id": 563715639, "node_id": "MDU6SXNzdWU1NjM3MTU2Mzk=", "number": 36675, "title": "[TF2] TRT Engine Ops are not garbage collected, resulting in incorrect reuse", "user": {"login": "MattConley", "id": 10891704, "node_id": "MDQ6VXNlcjEwODkxNzA0", "avatar_url": "https://avatars0.githubusercontent.com/u/10891704?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MattConley", "html_url": "https://github.com/MattConley", "followers_url": "https://api.github.com/users/MattConley/followers", "following_url": "https://api.github.com/users/MattConley/following{/other_user}", "gists_url": "https://api.github.com/users/MattConley/gists{/gist_id}", "starred_url": "https://api.github.com/users/MattConley/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MattConley/subscriptions", "organizations_url": "https://api.github.com/users/MattConley/orgs", "repos_url": "https://api.github.com/users/MattConley/repos", "events_url": "https://api.github.com/users/MattConley/events{/privacy}", "received_events_url": "https://api.github.com/users/MattConley/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1754777628, "node_id": "MDU6TGFiZWwxNzU0Nzc3NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu:tensorrt", "name": "comp:gpu:tensorrt", "color": "ea98ba", "default": false, "description": "Issues specific to TensorRT"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "bixia1", "id": 35820639, "node_id": "MDQ6VXNlcjM1ODIwNjM5", "avatar_url": "https://avatars1.githubusercontent.com/u/35820639?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bixia1", "html_url": "https://github.com/bixia1", "followers_url": "https://api.github.com/users/bixia1/followers", "following_url": "https://api.github.com/users/bixia1/following{/other_user}", "gists_url": "https://api.github.com/users/bixia1/gists{/gist_id}", "starred_url": "https://api.github.com/users/bixia1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bixia1/subscriptions", "organizations_url": "https://api.github.com/users/bixia1/orgs", "repos_url": "https://api.github.com/users/bixia1/repos", "events_url": "https://api.github.com/users/bixia1/events{/privacy}", "received_events_url": "https://api.github.com/users/bixia1/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "bixia1", "id": 35820639, "node_id": "MDQ6VXNlcjM1ODIwNjM5", "avatar_url": "https://avatars1.githubusercontent.com/u/35820639?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bixia1", "html_url": "https://github.com/bixia1", "followers_url": "https://api.github.com/users/bixia1/followers", "following_url": "https://api.github.com/users/bixia1/following{/other_user}", "gists_url": "https://api.github.com/users/bixia1/gists{/gist_id}", "starred_url": "https://api.github.com/users/bixia1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bixia1/subscriptions", "organizations_url": "https://api.github.com/users/bixia1/orgs", "repos_url": "https://api.github.com/users/bixia1/repos", "events_url": "https://api.github.com/users/bixia1/events{/privacy}", "received_events_url": "https://api.github.com/users/bixia1/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2020-02-12T03:12:36Z", "updated_at": "2020-02-26T23:44:08Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 2.1\r\n- Python version: 3.6.9\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source): N/A\r\n- CUDA/cuDNN version: CUDA 10.0 cuDNN 7.6.5, TensorRT 6.0.1\r\n- GPU model and memory: RTX 2080 \r\n\r\n\r\n**Describe the current behavior**\r\n\r\nWhen TRTEngineOps are created for different runs back to back, the first one is not properly cleared, resulting in potential reuse with an incorrect configuration.\r\n\r\nIn the reproducing case, running the dynamic input shapes TFTRT test creates and uses an fp16 engine op as expected, but the fp32 test does not create a new instance, instead reusing the one from before.  This behavior may result in the test failing, depending on the particular numerical results and tolerances.  In the case where the test passes, the bug can still be observed by parsing through the logs from the run (some snippets of mine are included below).\r\n\r\nI'm not sure if the issue is limited to TFTRT, or is the result of a larger problem with the resource manager in TF2.  This forced garbage collection is likely an attempted workaround for the issue:\r\nhttps://github.com/tensorflow/tensorflow/blob/v2.1.0/tensorflow/python/compiler/tensorrt/test/tf_trt_integration_test_base.py#L372\r\n\r\n**Describe the expected behavior**\r\n\r\nCreated TRTEngineOps should be handled by the resource manager such that they aren't reused in a separate invocation.\r\n\r\n**Code to reproduce the issue**\r\n\r\nRunning the dynamic_input_shapes_test.py with increased verbosity will demonstrate the failure in the logs:\r\n`env TF_CPP_VMODULE=convert_nodes=2,trt_engine_op=1 python tensorflow/python/compiler/tensorrt/test/dynamic_input_shapes_test.py`\r\n\r\n**Other info / logs**\r\n\r\n(Full log attached)\r\nIn the first creation of a TRTEngineOp for the test, we can see that none are found in the TF-TRT cache, so one will be created:\r\n\r\n> 2020-02-11 18:21:13.440748: W tensorflow/core/framework/op_kernel.cc:1655] OP_REQUIRES failed at trt_engine_resource_ops.cc:183 : Not found: Container TF-TRT does not exist. (Could not find resource: TF-TRT/TRTEngineOp_0)\r\n> INFO:tensorflow:Could not find TRTEngineOp_0 in TF-TRT cache. This can happen if build() is not called, which means TensorRT engines will be built and cached at runtime.\r\n> I0211 18:21:13.440817 140386763036416 trt_convert.py:1074] Could not find TRTEngineOp_0 in TF-TRT cache. This can happen if build() is not called, which means TensorRT engines will be built and cached at runtime.\r\n> INFO:tensorflow:Assets written to: /tmp/dynamic_input_shapes_test0vdtk5_4/tmpsu9l_mk2/tmpd2ckucmp/assets\r\n> I0211 18:21:13.468731 140386763036416 builder_impl.py:775] Assets written to: /tmp/dynamic_input_shapes_test0vdtk5_4/tmpsu9l_mk2/tmpd2ckucmp/assets\r\n> ...\r\n> ...\r\n> 2020-02-11 18:21:13.624985: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:257] Constructing PartitionedCall/TRTEngineOp_0\r\n> 2020-02-11 18:21:13.625010: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:237] Constructing function handle\r\n> 2020-02-11 18:21:13.625334: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:736] Building a new TensorRT engine for PartitionedCall/TRTEngineOp_0 with input shapes: [[1,5,5,1]]\r\n> 2020-02-11 18:21:13.625404: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libnvinfer.so.6\r\n> 2020-02-11 18:21:13.829528: I tensorflow/compiler/tf2tensorrt/convert/convert_nodes.cc:5645] Starting engine conversion, precision mode: FP16\r\n\r\n\r\nHowever, in the FP32 test run later, we do not see the warning about an engine op not being found in the cache, and there is no new engine op created:\r\n\r\n> \r\n> WARNING:tensorflow:From /home/mconley/TF2.1_test_env/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1635: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.\r\n> Instructions for updating:\r\n> If using Keras pass *_constraint arguments to layers.\r\n> W0211 18:21:16.109585 140386763036416 deprecation.py:506] From /home/mconley/TF2.1_test_env/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1635: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.\r\n> Instructions for updating:\r\n> If using Keras pass *_constraint arguments to layers.\r\n> INFO:tensorflow:Assets written to: /tmp/dynamic_input_shapes_test0vdtk5_4/tmp45kosn5r/tmpou7_kbrm/assets\r\n> I0211 18:21:16.131422 140386763036416 builder_impl.py:775] Assets written to: /tmp/dynamic_input_shapes_test0vdtk5_4/tmp45kosn5r/tmpou7_kbrm/assets\r\n> WARNING:tensorflow:Unresolved object in checkpoint: (root).trt_engine_resources.TRTEngineOp_0._serialized_trt_resource_filename\r\n> W0211 18:21:16.308784 140386763036416 util.py:144] Unresolved object in checkpoint: (root).trt_engine_resources.TRTEngineOp_0._serialized_trt_resource_filename\r\n> ...\r\n> ...\r\n> 2020-02-11 18:21:16.378245: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:257] Constructing PartitionedCall/TRTEngineOp_0\r\n> 2020-02-11 18:21:16.378281: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:237] Constructing function handle\r\n> 2020-02-11 18:21:16.378781: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:515] Executing TRT engine: PartitionedCall/TRTEngineOp_0\r\n> 2020-02-11 18:21:16.379594: I tensorflow/compiler/tf2tensorrt/kernels/trt_engine_op.cc:515] Executing TRT engine: PartitionedCall/TRTEngineOp_0\r\n> [logged_output.log](https://github.com/tensorflow/tensorflow/files/4189640/logged_output.log)\r\n> "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36673", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36673/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36673/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36673/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36673", "id": 563547454, "node_id": "MDExOlB1bGxSZXF1ZXN0MzczOTI3NDg3", "number": 36673, "title": "Fix gpu test filters when running the ./configure script", "user": {"login": "wdirons", "id": 22967383, "node_id": "MDQ6VXNlcjIyOTY3Mzgz", "avatar_url": "https://avatars3.githubusercontent.com/u/22967383?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wdirons", "html_url": "https://github.com/wdirons", "followers_url": "https://api.github.com/users/wdirons/followers", "following_url": "https://api.github.com/users/wdirons/following{/other_user}", "gists_url": "https://api.github.com/users/wdirons/gists{/gist_id}", "starred_url": "https://api.github.com/users/wdirons/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wdirons/subscriptions", "organizations_url": "https://api.github.com/users/wdirons/orgs", "repos_url": "https://api.github.com/users/wdirons/repos", "events_url": "https://api.github.com/users/wdirons/events{/privacy}", "received_events_url": "https://api.github.com/users/wdirons/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1169364259, "node_id": "MDU6TGFiZWwxMTY5MzY0MjU5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:XS", "name": "size:XS", "color": "adafea", "default": false, "description": "CL Change Size: Extra Small"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-11T22:38:01Z", "updated_at": "2020-03-19T14:21:07Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36673", "html_url": "https://github.com/tensorflow/tensorflow/pull/36673", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36673.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36673.patch"}, "body": "Today if you run the ./configure script without setting the\r\nvariable TF_NEED_CUDA, in the resulting .tf_configure.bazelrc\r\nyou get:\r\n\r\ntest:v1 --test_tag_filters=-benchmark-test,-no_oss,-gpu,-oss_serial\r\ntest:v1 --build_tag_filters=-benchmark-test,-no_oss,-gpu\r\ntest:v2 --test_tag_filters=-benchmark-test,-no_oss,-gpu,-oss_serial,-v1only\r\ntest:v2 --build_tag_filters=-benchmark-test,-no_oss,-gpu,-v1only\r\n\r\nThis is incorrect because -gpu means exclude the gpu test. It should be\r\n-no_gpu.\r\n\r\nDebugging the problem I found when the code was switched from using\r\nos.env to using environ_cp, that the method system_specific_test_config\r\nwas never updated. So unless the environment variable TF_NEED_CUDA was\r\nset before running ./configure then answering yes for CUDA would not\r\nselect the correct test filter for gpus.\r\n\r\nWith this change the test filters are correct:\r\n\r\ntest:v1 --test_tag_filters=-benchmark-test,-no_oss,-no_gpu,-oss_serial\r\ntest:v1 --build_tag_filters=-benchmark-test,-no_oss,-no_gpu\r\ntest:v2 --test_tag_filters=-benchmark-test,-no_oss,-no_gpu,-oss_serial,-v1only\r\ntest:v2 --build_tag_filters=-benchmark-test,-no_oss,-no_gpu,-v1only"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36672", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36672/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36672/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36672/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36672", "id": 563466350, "node_id": "MDU6SXNzdWU1NjM0NjYzNTA=", "number": 36672, "title": "Add a raspberry pi docker image", "user": {"login": "fgervais", "id": 5411996, "node_id": "MDQ6VXNlcjU0MTE5OTY=", "avatar_url": "https://avatars1.githubusercontent.com/u/5411996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fgervais", "html_url": "https://github.com/fgervais", "followers_url": "https://api.github.com/users/fgervais/followers", "following_url": "https://api.github.com/users/fgervais/following{/other_user}", "gists_url": "https://api.github.com/users/fgervais/gists{/gist_id}", "starred_url": "https://api.github.com/users/fgervais/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fgervais/subscriptions", "organizations_url": "https://api.github.com/users/fgervais/orgs", "repos_url": "https://api.github.com/users/fgervais/repos", "events_url": "https://api.github.com/users/fgervais/events{/privacy}", "received_events_url": "https://api.github.com/users/fgervais/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1194756584, "node_id": "MDU6TGFiZWwxMTk0NzU2NTg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20raspberry%20pi", "name": "subtype: raspberry pi", "color": "b619ea", "default": false, "description": "Raspberry Pi Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-02-11T20:45:35Z", "updated_at": "2020-02-18T16:59:25Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using): 2.1.0\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\nThere is already a tensoflow docker image for amd64. I'd like to see if there is interest other than me to have the same for armv7.\r\n\r\nI recently made one for tensorflow 2.1.0 here:\r\n\r\nhttps://github.com/fgervais/docker-tensorflow/blob/master/Dockerfile\r\n\r\nI think it would be nice to have an image like this published on the official docker hub repository.\r\n\r\nNote that this image does not need to be built on an actual raspberry pi. I build mine on my x86_64 system using:\r\n\r\n```\r\ndocker buildx build --platform linux/arm/v7 -t tensorflow:2.1.0-cp35 --load .\r\n```\r\n\r\nI'm guessing whatever CI system that builds the amd64 image could also build the armv7 image.\r\n\r\n**Who will benefit with this feature?**\r\n\r\nOn the raspberry pi, the docker image is quite useful since a lot of pip wheels do not come in binary form and the cost of building, let say scipy, is quite high. Having the docker image ensures a plug-and-play experience.\r\n\r\nWhat do you think? Would this integrate well in tensorflow?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36669", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36669/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36669/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36669/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36669", "id": 563378960, "node_id": "MDU6SXNzdWU1NjMzNzg5NjA=", "number": 36669, "title": "Error while reading resource variable _AnonymousVar12 from Container: localhost", "user": {"login": "mindis", "id": 3082556, "node_id": "MDQ6VXNlcjMwODI1NTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/3082556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mindis", "html_url": "https://github.com/mindis", "followers_url": "https://api.github.com/users/mindis/followers", "following_url": "https://api.github.com/users/mindis/following{/other_user}", "gists_url": "https://api.github.com/users/mindis/gists{/gist_id}", "starred_url": "https://api.github.com/users/mindis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mindis/subscriptions", "organizations_url": "https://api.github.com/users/mindis/orgs", "repos_url": "https://api.github.com/users/mindis/repos", "events_url": "https://api.github.com/users/mindis/events{/privacy}", "received_events_url": "https://api.github.com/users/mindis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-02-11T17:58:03Z", "updated_at": "2020-02-12T06:54:30Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): centos 7.7\r\n- TensorFlow installed from (source or binary): yes\r\n- TensorFlow version (use command below): 2.1\r\n- Python version: 3.6\r\n\r\n\r\n\r\n**Describe the current behavior**\r\nError when trying to update tf.Variable in data.Dataset pipeline\r\n\r\n**Describe the expected behavior**\r\nNo error\r\n\r\n**Code to reproduce the issue**\r\n```\r\nds=tf.data.Dataset.from_tensor_slices(tf.constant([[9, 10, 11, 12]]))\r\ndef update(update):\r\n    ref = tf.Variable([1, 2, 3, 4, 5, 6, 7, 8])\r\n    indices = tf.constant([[4], [3], [1] ,[7]])\r\n    updated = tf.tensor_scatter_nd_update(ref, indices, update)\r\n    return updated\r\nds=ds.map(update)\r\nfor i in ds:\r\n    print(i)\r\n```\r\n\r\n**Other info / logs**\r\n```\r\nFailedPreconditionError: {{function_node __inference_Dataset_map_update_674}} Error while reading resource variable _AnonymousVar12 from Container: localhost. This could mean that the variable was uninitialized. Not found: Resource localhost/_AnonymousVar12/N10tensorflow3VarE does not exist.\r\n\t [[{{node TensorScatterUpdate/ReadVariableOp}}]] [Op:IteratorGetNextSync]\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36667", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36667/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36667/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36667/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36667", "id": 563328840, "node_id": "MDU6SXNzdWU1NjMzMjg4NDA=", "number": 36667, "title": "Pip package for tensorflow 2.1 for Raspberry Pi (python 3.7)", "user": {"login": "feranick", "id": 35967, "node_id": "MDQ6VXNlcjM1OTY3", "avatar_url": "https://avatars1.githubusercontent.com/u/35967?v=4", "gravatar_id": "", "url": "https://api.github.com/users/feranick", "html_url": "https://github.com/feranick", "followers_url": "https://api.github.com/users/feranick/followers", "following_url": "https://api.github.com/users/feranick/following{/other_user}", "gists_url": "https://api.github.com/users/feranick/gists{/gist_id}", "starred_url": "https://api.github.com/users/feranick/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/feranick/subscriptions", "organizations_url": "https://api.github.com/users/feranick/orgs", "repos_url": "https://api.github.com/users/feranick/repos", "events_url": "https://api.github.com/users/feranick/events{/privacy}", "received_events_url": "https://api.github.com/users/feranick/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1194756584, "node_id": "MDU6TGFiZWwxMTk0NzU2NTg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20raspberry%20pi", "name": "subtype: raspberry pi", "color": "b619ea", "default": false, "description": "Raspberry Pi Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-11T16:35:04Z", "updated_at": "2020-02-12T10:03:15Z", "closed_at": null, "author_association": "NONE", "body": "Current versions of Raspbian use Python 3.7. Yet, the most updated pip packages (TF 2.1) provided by Google for the Raspberry pi are limited to python 3.5:\r\n\r\nhttps://www.tensorflow.org/install/pip\r\n\r\nPypi provides much older versions of TF (1.14) for python 3.7.  \r\n\r\nPlease update the version provided by either google or Pypi"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36666", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36666/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36666/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36666/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36666", "id": 563284340, "node_id": "MDU6SXNzdWU1NjMyODQzNDA=", "number": 36666, "title": "Saving model with tf.keras.layers.RNN with unroll=True fails for save_format=tf", "user": {"login": "padoremu", "id": 42805615, "node_id": "MDQ6VXNlcjQyODA1NjE1", "avatar_url": "https://avatars1.githubusercontent.com/u/42805615?v=4", "gravatar_id": "", "url": "https://api.github.com/users/padoremu", "html_url": "https://github.com/padoremu", "followers_url": "https://api.github.com/users/padoremu/followers", "following_url": "https://api.github.com/users/padoremu/following{/other_user}", "gists_url": "https://api.github.com/users/padoremu/gists{/gist_id}", "starred_url": "https://api.github.com/users/padoremu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/padoremu/subscriptions", "organizations_url": "https://api.github.com/users/padoremu/orgs", "repos_url": "https://api.github.com/users/padoremu/repos", "events_url": "https://api.github.com/users/padoremu/events{/privacy}", "received_events_url": "https://api.github.com/users/padoremu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-02-11T15:28:25Z", "updated_at": "2020-02-12T20:17:56Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution: Linux Ubuntu 18.04\r\n- Mobile device if the issue happens on mobile device: -\r\n- TensorFlow installed from: binary (tf-nightly via docker)\r\n- TensorFlow version: GIT_VERSION = v1.12.1-23779-g96c5c8a 2.2.0-dev20200202\r\n- Python version: 3.6.9\r\n- Bazel version (if compiling from source): -\r\n- GCC/Compiler version (if compiling from source): -\r\n- CUDA/cuDNN version: CPU only\r\n- GPU model and memory: CPU only\r\n\r\n**Describe the current behavior**\r\nSaving a `tf.keras.Sequential` model with `tf.keras.layers.RNN` with `unroll=True` fails for `save_format=tf`(but succeeds for `save_format=ht`).\r\n\r\n**Describe the expected behavior**\r\nSaving should succeed for `save_format=tf` as well.\r\n\r\n**Code to reproduce the issue**\r\n```python\r\nimport tensorflow as tf\r\n\r\nmodel = tf.keras.Sequential()\r\n\r\nmodel.add(tf.keras.layers.Input(shape=(1, 1,)))\r\n\r\ncell = tf.keras.layers.GRUCell(10)\r\n\r\nmodel.add(tf.keras.layers.RNN(cell, unroll=True))\r\n    \r\nmodel.save(\"test.tf\", save_format='tf') # fails\r\n#model.save(\"test.h5\", save_format='h5') # works\r\n```\r\n\r\n**Other info / logs**\r\nUnfortunately, saving as h5 is not an option (which would actually be my favorite), since it fails when having more than one cell (see #36093).\r\n\r\nTraceback in case of failure:\r\n```bash\r\n  File \"test.py\", line 11, in <module>\r\n    model.save(\"test.tf\", save_format='tf') # fails\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/network.py\", line 999, in save\r\n    signatures, options)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/save.py\", line 138, in save_model\r\n    signatures, options)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/save.py\", line 78, in save\r\n    save_lib.save(model, filepath, signatures, options)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/saved_model/save.py\", line 955, in save\r\n    checkpoint_graph_view)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/saved_model/signature_serialization.py\", line 75, in find_function_to_export\r\n    functions = saveable_view.list_functions(saveable_view.root)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/saved_model/save.py\", line 142, in list_functions\r\n    self._serialization_cache)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/base_layer.py\", line 2535, in _list_functions_for_serialization\r\n    .list_functions_for_serialization(serialization_cache))\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/base_serialization.py\", line 91, in list_functions_for_serialization\r\n    fns = self.functions_to_serialize(serialization_cache)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/layer_serialization.py\", line 79, in functions_to_serialize\r\n    serialization_cache).functions_to_serialize)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/layer_serialization.py\", line 94, in _get_serialized_attributes\r\n    serialization_cache)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/model_serialization.py\", line 53, in _get_serialized_attributes_internal\r\n    serialization_cache))\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/layer_serialization.py\", line 103, in _get_serialized_attributes_internal\r\n    functions = save_impl.wrap_layer_functions(self.obj, serialization_cache)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/save_impl.py\", line 161, in wrap_layer_functions\r\n    original_fns = _replace_child_layer_functions(layer, serialization_cache)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/save_impl.py\", line 249, in _replace_child_layer_functions\r\n    serialization_cache).functions)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/layer_serialization.py\", line 94, in _get_serialized_attributes\r\n    serialization_cache)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/layer_serialization.py\", line 103, in _get_serialized_attributes_internal\r\n    functions = save_impl.wrap_layer_functions(self.obj, serialization_cache)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/save_impl.py\", line 171, in wrap_layer_functions\r\n    '{}_layer_call_and_return_conditional_losses'.format(layer.name))\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/save_impl.py\", line 487, in add_function\r\n    self.add_trace(*self._input_signature)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/save_impl.py\", line 402, in add_trace\r\n    trace_with_training(True)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/save_impl.py\", line 400, in trace_with_training\r\n    fn.get_concrete_function(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/save_impl.py\", line 531, in get_concrete_function\r\n    return super(LayerCall, self).get_concrete_function(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/eager/def_function.py\", line 953, in get_concrete_function\r\n    concrete = self._get_concrete_function_garbage_collected(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/eager/def_function.py\", line 859, in _get_concrete_function_garbage_collected\r\n    self._initialize(args, kwargs, add_initializers_to=initializers)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/eager/def_function.py\", line 505, in _initialize\r\n    *args, **kwds))\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/eager/function.py\", line 2440, in _get_concrete_function_internal_garbage_collected\r\n    graph_function, _, _ = self._maybe_define_function(args, kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/eager/function.py\", line 2771, in _maybe_define_function\r\n    graph_function = self._create_graph_function(args, kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/eager/function.py\", line 2661, in _create_graph_function\r\n    capture_by_value=self._capture_by_value),\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/func_graph.py\", line 981, in func_graph_from_py_func\r\n    func_outputs = python_func(*func_args, **func_kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/eager/def_function.py\", line 440, in wrapped_fn\r\n    return weak_wrapped_fn().__wrapped__(*args, **kwds)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/save_impl.py\", line 508, in wrapper\r\n    ret = method(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/utils.py\", line 170, in wrap_with_training_arg\r\n    lambda: replace_training_and_call(False))\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/utils/tf_utils.py\", line 59, in smart_cond\r\n    pred, true_fn=true_fn, false_fn=false_fn, name=name)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/smart_cond.py\", line 54, in smart_cond\r\n    return true_fn()\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/utils.py\", line 169, in <lambda>\r\n    lambda: replace_training_and_call(True),\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/utils.py\", line 165, in replace_training_and_call\r\n    return wrapped_call(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/saved_model/save_impl.py\", line 550, in call_and_return_conditional_losses\r\n    return layer_call(inputs, *args, **kwargs), layer.get_losses_for(inputs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/layers/recurrent.py\", line 734, in call\r\n    raise ValueError('Cannot unroll a RNN if the '\r\nValueError: Cannot unroll a RNN if the time dimension is undefined. \r\n- If using a Sequential model, specify the time dimension by passing an `input_shape` or `batch_input_shape` argument to your first layer. If your first layer is an Embedding, you can also use the `input_length` argument.\r\n- If using the functional API, specify the time dimension by passing a `shape` or `batch_shape` argument to your Input layer.\r\n\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36658", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36658/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36658/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36658/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36658", "id": 563160033, "node_id": "MDU6SXNzdWU1NjMxNjAwMzM=", "number": 36658, "title": "generate_projects target in the tf micro makefile fails for some target architectures", "user": {"login": "JaccovG", "id": 46677324, "node_id": "MDQ6VXNlcjQ2Njc3MzI0", "avatar_url": "https://avatars1.githubusercontent.com/u/46677324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JaccovG", "html_url": "https://github.com/JaccovG", "followers_url": "https://api.github.com/users/JaccovG/followers", "following_url": "https://api.github.com/users/JaccovG/following{/other_user}", "gists_url": "https://api.github.com/users/JaccovG/gists{/gist_id}", "starred_url": "https://api.github.com/users/JaccovG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JaccovG/subscriptions", "organizations_url": "https://api.github.com/users/JaccovG/orgs", "repos_url": "https://api.github.com/users/JaccovG/repos", "events_url": "https://api.github.com/users/JaccovG/events{/privacy}", "received_events_url": "https://api.github.com/users/JaccovG/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "wangtz", "id": 34290063, "node_id": "MDQ6VXNlcjM0MjkwMDYz", "avatar_url": "https://avatars1.githubusercontent.com/u/34290063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wangtz", "html_url": "https://github.com/wangtz", "followers_url": "https://api.github.com/users/wangtz/followers", "following_url": "https://api.github.com/users/wangtz/following{/other_user}", "gists_url": "https://api.github.com/users/wangtz/gists{/gist_id}", "starred_url": "https://api.github.com/users/wangtz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wangtz/subscriptions", "organizations_url": "https://api.github.com/users/wangtz/orgs", "repos_url": "https://api.github.com/users/wangtz/repos", "events_url": "https://api.github.com/users/wangtz/events{/privacy}", "received_events_url": "https://api.github.com/users/wangtz/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "wangtz", "id": 34290063, "node_id": "MDQ6VXNlcjM0MjkwMDYz", "avatar_url": "https://avatars1.githubusercontent.com/u/34290063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wangtz", "html_url": "https://github.com/wangtz", "followers_url": "https://api.github.com/users/wangtz/followers", "following_url": "https://api.github.com/users/wangtz/following{/other_user}", "gists_url": "https://api.github.com/users/wangtz/gists{/gist_id}", "starred_url": "https://api.github.com/users/wangtz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wangtz/subscriptions", "organizations_url": "https://api.github.com/users/wangtz/orgs", "repos_url": "https://api.github.com/users/wangtz/repos", "events_url": "https://api.github.com/users/wangtz/events{/privacy}", "received_events_url": "https://api.github.com/users/wangtz/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-11T12:00:07Z", "updated_at": "2020-02-14T00:11:50Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "@tensorflow/micro\r\n\r\n**System information**\r\n- Host OS Platform and Distribution: cygwin\r\n- TensorFlow installed from (source or binary):\r\n- Tensorflow version (commit SHA if source):\r\n- Target platform (e.g. Arm Mbed OS, Arduino Nano 33 etc.): ARC\r\n\r\n**Describe the problem**\r\nThe generate_projects target in the tf micro makefile creates all projects, including the projects that are not valid for the given TARGET_ARCH. Only the projects valid for the provided TARGET_ARCH should be added to the ALL_PROJECT_TARGETS variable.\r\nPossible solutions:\r\n- add TARGET_ARCH specific conditions around filling the ALL_PROJECT_TARGETS list (note that this is not in line with the policy to keep TARGET_ARCH specific code in separate files)\r\n- Change the location of including the arch specific makefiles such that ALL_PROJECT_TARGETS can be filtered.\r\n- ...\r\n\r\n\r\n**Please provide the exact sequence of commands/steps when you ran into the problem**\r\nmake -f tensorflow/lite/micro/tools/make/Makefile TARGET_ARCH=arc generate_projects\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36657", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36657/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36657/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36657/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36657", "id": 563128876, "node_id": "MDU6SXNzdWU1NjMxMjg4NzY=", "number": 36657, "title": "Hello World example for STM32F746 make error", "user": {"login": "Nithraniel", "id": 5825230, "node_id": "MDQ6VXNlcjU4MjUyMzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/5825230?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Nithraniel", "html_url": "https://github.com/Nithraniel", "followers_url": "https://api.github.com/users/Nithraniel/followers", "following_url": "https://api.github.com/users/Nithraniel/following{/other_user}", "gists_url": "https://api.github.com/users/Nithraniel/gists{/gist_id}", "starred_url": "https://api.github.com/users/Nithraniel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Nithraniel/subscriptions", "organizations_url": "https://api.github.com/users/Nithraniel/orgs", "repos_url": "https://api.github.com/users/Nithraniel/repos", "events_url": "https://api.github.com/users/Nithraniel/events{/privacy}", "received_events_url": "https://api.github.com/users/Nithraniel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rockyrhodes", "id": 7253968, "node_id": "MDQ6VXNlcjcyNTM5Njg=", "avatar_url": "https://avatars2.githubusercontent.com/u/7253968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rockyrhodes", "html_url": "https://github.com/rockyrhodes", "followers_url": "https://api.github.com/users/rockyrhodes/followers", "following_url": "https://api.github.com/users/rockyrhodes/following{/other_user}", "gists_url": "https://api.github.com/users/rockyrhodes/gists{/gist_id}", "starred_url": "https://api.github.com/users/rockyrhodes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rockyrhodes/subscriptions", "organizations_url": "https://api.github.com/users/rockyrhodes/orgs", "repos_url": "https://api.github.com/users/rockyrhodes/repos", "events_url": "https://api.github.com/users/rockyrhodes/events{/privacy}", "received_events_url": "https://api.github.com/users/rockyrhodes/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rockyrhodes", "id": 7253968, "node_id": "MDQ6VXNlcjcyNTM5Njg=", "avatar_url": "https://avatars2.githubusercontent.com/u/7253968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rockyrhodes", "html_url": "https://github.com/rockyrhodes", "followers_url": "https://api.github.com/users/rockyrhodes/followers", "following_url": "https://api.github.com/users/rockyrhodes/following{/other_user}", "gists_url": "https://api.github.com/users/rockyrhodes/gists{/gist_id}", "starred_url": "https://api.github.com/users/rockyrhodes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rockyrhodes/subscriptions", "organizations_url": "https://api.github.com/users/rockyrhodes/orgs", "repos_url": "https://api.github.com/users/rockyrhodes/repos", "events_url": "https://api.github.com/users/rockyrhodes/events{/privacy}", "received_events_url": "https://api.github.com/users/rockyrhodes/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-11T11:04:54Z", "updated_at": "2020-02-11T11:49:33Z", "closed_at": null, "author_association": "NONE", "body": "@tensorflow/micro\r\n\r\n**System information**\r\n- Host OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10 x64\r\n- TensorFlow installed from (source or binary): pip\r\n- Tensorflow version (commit SHA if source): 2.1.0\r\n- Target platform (e.g. Arm Mbed OS, Arduino Nano 33 etc.): STM32F7\r\n\r\n**Describe the problem**\r\nI started following the guide here : https://github.com/tensorflow/tensorflow/tree/master/tensorflow/lite/micro/examples/hello_world#deploy-to-STM32F746\r\nwhich required me to download TensorFlow's sources (I installed it previously using pip), and my goal is to deploy it to STM32F746. Except that the first step : \r\n`make -f tensorflow/lite/micro/tools/make/Makefile TARGET=mbed TAGS=\"CMSIS disco_f746ng\" generate_hello_world_mbed_project`\r\ndoesn't work and throws me an error saying that it tried to download gemmlowp for some reason and that tensorflow is not recognized as an internal command... I get that I'm not supposed to run tensorflow outside of python but I'm just running **make** here... Shouldn't have any link whatsoever.\r\n\r\n**Please provide the exact sequence of commands/steps when you ran into the problem**\r\n\r\nUsed the first command from the \"Deploy to STM32F746\" guide `make -f tensorflow/lite/micro/tools/make/Makefile TARGET=mbed TAGS=\"CMSIS disco_f746ng\" generate_hello_world_mbed_project`\r\n\r\nEncountered first an error with unam -m tied to my OS or architecture, had to manually delete the makefile code regarding that and write it in stone; then I ran it again and got this :\r\n\r\n```\r\nmake -f tensorflow/lite/micro/tools/make/Makefile TARGET=mbed TAGS=\"CMSIS disco_f746ng\" generate_hello_world_mbed_project\r\ntensorflow/lite/micro/tools/make/download_and_extract.sh \"https://github.com/google/gemmlowp/archive/719139ce755a0f31cbf1c37f7f98adcc7fc9f425.zip\" \"7e8191b24853d75de2af87622ad293ba\" tensorflow/lite/micro/tools/make/downloads/gemmlowp\r\n'tensorflow' is not recognized as an internal or external command operable program or batch file\r\nmake: *** [tensorflow/lite/micro/tools/make/downloads/gemmlowp] Error 1\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36655", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36655/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36655/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36655/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36655", "id": 563110777, "node_id": "MDExOlB1bGxSZXF1ZXN0MzczNTgxMDAx", "number": 36655, "title": "Update wav_to_features.py", "user": {"login": "foldl", "id": 4046440, "node_id": "MDQ6VXNlcjQwNDY0NDA=", "avatar_url": "https://avatars3.githubusercontent.com/u/4046440?v=4", "gravatar_id": "", "url": "https://api.github.com/users/foldl", "html_url": "https://github.com/foldl", "followers_url": "https://api.github.com/users/foldl/followers", "following_url": "https://api.github.com/users/foldl/following{/other_user}", "gists_url": "https://api.github.com/users/foldl/gists{/gist_id}", "starred_url": "https://api.github.com/users/foldl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/foldl/subscriptions", "organizations_url": "https://api.github.com/users/foldl/orgs", "repos_url": "https://api.github.com/users/foldl/repos", "events_url": "https://api.github.com/users/foldl/events{/privacy}", "received_events_url": "https://api.github.com/users/foldl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 987666414, "node_id": "MDU6TGFiZWw5ODc2NjY0MTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/ready%20to%20pull", "name": "ready to pull", "color": "2cd643", "default": false, "description": ""}, {"id": 1169364259, "node_id": "MDU6TGFiZWwxMTY5MzY0MjU5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:XS", "name": "size:XS", "color": "adafea", "default": false, "description": "CL Change Size: Extra Small"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-02-11T10:33:07Z", "updated_at": "2020-03-19T13:06:07Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36655", "html_url": "https://github.com/tensorflow/tensorflow/pull/36655", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36655.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36655.patch"}, "body": "Remove the leading comma in the generated float array. With this leading comma, the generated C code can't be compiled."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36654", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36654/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36654/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36654/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36654", "id": 563106629, "node_id": "MDU6SXNzdWU1NjMxMDY2Mjk=", "number": 36654, "title": "Tensorflow Lite Android Application Crashes on Inference A/libc: Fatal signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x7759200000 in tid 26388 (mple.inpainting), pid 26388 (mple.inpainting)", "user": {"login": "nauyan", "id": 16066688, "node_id": "MDQ6VXNlcjE2MDY2Njg4", "avatar_url": "https://avatars3.githubusercontent.com/u/16066688?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nauyan", "html_url": "https://github.com/nauyan", "followers_url": "https://api.github.com/users/nauyan/followers", "following_url": "https://api.github.com/users/nauyan/following{/other_user}", "gists_url": "https://api.github.com/users/nauyan/gists{/gist_id}", "starred_url": "https://api.github.com/users/nauyan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nauyan/subscriptions", "organizations_url": "https://api.github.com/users/nauyan/orgs", "repos_url": "https://api.github.com/users/nauyan/repos", "events_url": "https://api.github.com/users/nauyan/events{/privacy}", "received_events_url": "https://api.github.com/users/nauyan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "terryheo", "id": 2908505, "node_id": "MDQ6VXNlcjI5MDg1MDU=", "avatar_url": "https://avatars2.githubusercontent.com/u/2908505?v=4", "gravatar_id": "", "url": "https://api.github.com/users/terryheo", "html_url": "https://github.com/terryheo", "followers_url": "https://api.github.com/users/terryheo/followers", "following_url": "https://api.github.com/users/terryheo/following{/other_user}", "gists_url": "https://api.github.com/users/terryheo/gists{/gist_id}", "starred_url": "https://api.github.com/users/terryheo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/terryheo/subscriptions", "organizations_url": "https://api.github.com/users/terryheo/orgs", "repos_url": "https://api.github.com/users/terryheo/repos", "events_url": "https://api.github.com/users/terryheo/events{/privacy}", "received_events_url": "https://api.github.com/users/terryheo/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "terryheo", "id": 2908505, "node_id": "MDQ6VXNlcjI5MDg1MDU=", "avatar_url": "https://avatars2.githubusercontent.com/u/2908505?v=4", "gravatar_id": "", "url": "https://api.github.com/users/terryheo", "html_url": "https://github.com/terryheo", "followers_url": "https://api.github.com/users/terryheo/followers", "following_url": "https://api.github.com/users/terryheo/following{/other_user}", "gists_url": "https://api.github.com/users/terryheo/gists{/gist_id}", "starred_url": "https://api.github.com/users/terryheo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/terryheo/subscriptions", "organizations_url": "https://api.github.com/users/terryheo/orgs", "repos_url": "https://api.github.com/users/terryheo/repos", "events_url": "https://api.github.com/users/terryheo/events{/privacy}", "received_events_url": "https://api.github.com/users/terryheo/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-02-11T10:26:41Z", "updated_at": "2020-03-18T22:11:46Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): N/A\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: Samsung A30\r\n- TensorFlow installed from (source or binary): Source\r\n- TensorFlow version (use command below): 1.14.0\r\n- Python version: 3.5.5\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source): N/A\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: N/A\r\n\r\n\r\n**Describe the current behavior**\r\nI am working on InPainting application on android using the TensorflowLite model but the application crashes during inference.\r\n\r\n**Describe the expected behavior**\r\nI am developing an Inpainting android application using tensorflow lite. The tensorflow lite model takes two inputs:\r\n\r\n1. Input Image (512x680x3)\r\n2. Mask Image(512x680x1)\r\n\r\nThese two input images are loaded from the asset folder in the form of Bitmaps and then converted into ByteBuffer. After that, they are passed to the tensorflow lite model and the model is supposed to give output in the form of ByteBuffer. Later this ByteBuffer is converted into a restored RGB image.\r\n\r\n**Code to reproduce the issue**\r\nMain Activity Code\r\n```\r\n protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_main);\r\n        Toolbar toolbar = findViewById(R.id.toolbar);\r\n        setSupportActionBar(toolbar);\r\n\r\n        FloatingActionButton fab = findViewById(R.id.fab);\r\n        fab.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                Snackbar.make(view, \"Replace with your own action\", Snackbar.LENGTH_LONG)\r\n                        .setAction(\"Action\", null).show();\r\n            }\r\n        });\r\n\r\n        try {\r\n            tflite = new Interpreter(loadModelFile(MainActivity.this, \"converted_model.tflite\"));\r\n\r\n            Bitmap Image = getBitmapFromAsset(this,\"001.png\");\r\n            Bitmap Mask = getBitmapFromAsset(this,\"tmp_mask.png\");\r\n\r\n            ByteBuffer BImage = convertBitmapToByteBuffer(Image);\r\n            System.out.println(\"First Image Converted\");\r\n            ByteBuffer BMask = convertBitmapToByteBuffer1(Mask);\r\n            System.out.println(\"Second Image Converted\");\r\n\r\n            BImage.order(ByteOrder.nativeOrder());\r\n            BMask.order(ByteOrder.nativeOrder());\r\n\r\n            System.out.println(\"Bytes in BIMAGE \"+BImage.position());\r\n            System.out.println(\"Bytes in BMask \"+BMask.position());\r\n\r\n            Object[] Inputs = {BImage,BMask};\r\n\r\n\r\n            int OutputTensorIndex = 0;\r\n            int[] OutputShape =\r\n                    tflite.getOutputTensor(OutputTensorIndex).shape(); // {1, NUM_CLASSES}\r\n            DataType OutputDataType = tflite.getOutputTensor(OutputTensorIndex).dataType();\r\n            System.out.println(\"Output 1 Shape \"+ OutputShape[1]+\" \"+OutputShape[2]+\" +OutputShape[3]);\r\n            System.out.println(\"Output 1 DataType \" + OutputDataType);\r\n\r\n            TensorBuffer outputBuffer = TensorBuffer.createFixedSize(OutputShape, OutputDataType);\r\n            Map<Integer, Object> outputs = new HashMap<>();\r\n            System.out.println(\"Resizing Input\");\r\n            System.out.println(\"Bytes in Ouput\" + outputBuffer.getBuffer().position());\r\n            outputs.put(0,outputBuffer.getBuffer());\r\n            int[] input1 = new int[]{1,512,680,3};\r\n            int[] input2 = new int[]{1,512,680,1};\r\n            tflite.resizeInput(0,input1);\r\n            tflite.resizeInput(1,input2);\r\n            System.out.println(\"Resizing Input Done\");\r\n\r\n            tflite.runForMultipleInputsOutputs(Inputs, outputs);\r\n\r\n            Toast.makeText(this,\"Working\",Toast.LENGTH_LONG).show();\r\n            System.out.println(\"Inference Complete\");\r\n\r\n            tflite.close();\r\n\r\n        } catch (IOException e) {\r\n            Toast.makeText(this,\"Failed\",Toast.LENGTH_LONG).show();\r\n            e.printStackTrace();\r\n        }\r\n\r\n}\r\n```\r\nCode for getting Bitmap from Asset folder\r\n```\r\nprivate Bitmap getBitmapFromAsset(Context context, String filePath) {\r\n        AssetManager assetManager = context.getAssets();\r\n\r\n        InputStream istr;\r\n        Bitmap bitmap = null;\r\n        try {\r\n            istr = assetManager.open(filePath);\r\n            bitmap = BitmapFactory.decodeStream(istr);\r\n        } catch (IOException e) {\r\n            // handle exception\r\n        }\r\n        return bitmap;\r\n    }\r\n```\r\nCode for Converting Bitmap to ByteBuffer for RGB Input\r\n```\r\nprivate ByteBuffer convertBitmapToByteBuffer(Bitmap bitmap) {\r\n        int IMAGE_MEAN = 128;\r\n        float IMAGE_STD = 128.0f;\r\n        ByteBuffer byteBuffer = ByteBuffer.allocateDirect(4 * 1 * 512 * 680 * 3);\r\n        int[] intValues = new int[512 * 680];\r\n        bitmap.getPixels(intValues, 0, bitmap.getWidth(), 0, 0, bitmap.getWidth(), bitmap.getHeight());\r\n        int pixel = 0;\r\n        for (int i = 0; i < 512; ++i) {\r\n            for (int j = 0; j < 680; ++j) {\r\n                final int val = intValues[pixel++];\r\n                byteBuffer.putFloat((((val >> 16) & 0xFF)-IMAGE_MEAN)/IMAGE_STD);\r\n                byteBuffer.putFloat((((val >> 8) & 0xFF)-IMAGE_MEAN)/IMAGE_STD);\r\n                byteBuffer.putFloat((((val) & 0xFF)-IMAGE_MEAN)/IMAGE_STD);\r\n            }\r\n        }\r\n        return byteBuffer;\r\n    }\r\n```\r\nCode for Converting Bitmap to ByteBuffer for Single Channel Input\r\n\r\n```\r\nprivate ByteBuffer convertBitmapToByteBuffer1(Bitmap bitmap) {\r\n        int IMAGE_MEAN = 128;\r\n        float IMAGE_STD = 128.0f;\r\n        ByteBuffer byteBuffer1 = ByteBuffer.allocateDirect(4 * 1 * 512 * 680 * 1);\r\n        //byteBuffer1.order(ByteOrder.nativeOrder());\r\n        int[] intValues = new int[512 * 680];\r\n        bitmap.getPixels(intValues, 0, bitmap.getWidth(), 0, 0, bitmap.getWidth(), bitmap.getHeight());\r\n        int pixel = 0;\r\n        for (int i = 0; i < 512; ++i) {\r\n            for (int j = 0; j < 680; ++j) {\r\n                final int val = intValues[pixel++];\r\n                //byteBuffer1.putFloat((((val >> 16) & 0xFF)-IMAGE_MEAN)/IMAGE_STD);\r\n                //byteBuffer1.putFloat((((val >> 8) & 0xFF)-IMAGE_MEAN)/IMAGE_STD);\r\n                byteBuffer1.putFloat((((val) & 0xFF)-IMAGE_MEAN)/IMAGE_STD);\r\n            }\r\n        }\r\n        return byteBuffer1;\r\n    }\r\n```\r\n\r\n\r\n**Other info / logs**\r\n```\r\n2020-02-11 14:56:45.730 26572-26572/? A/DEBUG: *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***\r\n2020-02-11 14:56:44.696 26388-26388/com.example.inpainting A/libc: Fatal signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x7759200000 in tid 26388 (mple.inpainting), pid 26388 (mple.inpainting)\r\n\r\n\r\n2020-02-11 14:56:45.730 26572-26572/? A/DEBUG: Build fingerprint: 'samsung/a30dd/a30:9/PPR1.180610.011/A305FDDU2ASF3:user/release-keys'\r\n2020-02-11 14:56:45.730 26572-26572/? A/DEBUG: Revision: '3'\r\n2020-02-11 14:56:45.730 26572-26572/? A/DEBUG: ABI: 'arm64'\r\n2020-02-11 14:56:45.730 26572-26572/? A/DEBUG: pid: 26388, tid: 26388, name: mple.inpainting  >>> com.example.inpainting <<<\r\n2020-02-11 14:56:45.730 26572-26572/? A/DEBUG: signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x7759200000\r\n2020-02-11 14:56:45.731 26572-26572/? A/DEBUG:     x0  000000770c7eb900  x1  0000007756164700  x2  ffffffffb35eb630  x3  00000077591fffc0\r\n2020-02-11 14:56:45.731 26572-26572/? A/DEBUG:     x4  000000770974fd80  x5  000000770c7eb680  x6  bf7ff19cbf7fec39  x7  bf7ff8c9bf5baee6\r\n2020-02-11 14:56:45.731 26572-26572/? A/DEBUG:     x8  bf800000bf800000  x9  bf709453bf7fdb6c  x10 bf7fffeebf7ffeac  x11 bf7fff54bf7ffa20\r\n2020-02-11 14:56:45.731 26572-26572/? A/DEBUG:     x12 bf800000bf800000  x13 bf7f9c97bf7fb93d  x14 00000000000000aa  x15 00000000000000aa\r\n2020-02-11 14:56:45.731 26572-26572/? A/DEBUG:     x16 0000007759593008  x17 00000077f5f60cf0  x18 0000000000000000  x19 fffffffffffffa00\r\n2020-02-11 14:56:45.731 26572-26572/? A/DEBUG:     x20 fffffffffffffd80  x21 0000000000000000  x22 0000007709750000  x23 0000000000000000\r\n2020-02-11 14:56:45.731 26572-26572/? A/DEBUG:     x24 000000770c7eb900  x25 0000000000000001  x26 0000000000005500  x27 0000000000000380\r\n2020-02-11 14:56:45.731 26572-26572/? A/DEBUG:     x28 0000000000000000  x29 0000007fe8dc5b90\r\n2020-02-11 14:56:45.731 26572-26572/? A/DEBUG:     sp  0000007fe8dc5af0  lr  0000007759423300  pc  00000077f5f60e18\r\n\r\n2020-02-11 14:56:46.346 26572-26572/? A/DEBUG: backtrace:\r\n2020-02-11 14:56:46.347 26572-26572/? A/DEBUG:     #00 pc 000000000001de18  /system/lib64/libc.so (memcpy+296)\r\n2020-02-11 14:56:46.347 26572-26572/? A/DEBUG:     #01 pc 000000000005b2fc  /data/app/com.example.inpainting-40kevdvzYiOK_rsH1RbKGA==/lib/arm64/libtensorflowlite_jni.so\r\n2020-02-11 14:56:46.347 26572-26572/? A/DEBUG:     #02 pc 000000000005b008  /data/app/com.example.inpainting-40kevdvzYiOK_rsH1RbKGA==/lib/arm64/libtensorflowlite_jni.so\r\n2020-02-11 14:56:46.347 26572-26572/? A/DEBUG:     #03 pc 000000000005a5a0  /data/app/com.example.inpainting-40kevdvzYiOK_rsH1RbKGA==/lib/arm64/libtensorflowlite_jni.so\r\n2020-02-11 14:56:46.347 26572-26572/? A/DEBUG:     #04 pc 0000000000061ac8  /data/app/com.example.inpainting-40kevdvzYiOK_rsH1RbKGA==/lib/arm64/libtensorflowlite_jni.so\r\n2020-02-11 14:56:46.347 26572-26572/? A/DEBUG:     #05 pc 000000000005a358  /data/app/com.example.inpainting-40kevdvzYiOK_rsH1RbKGA==/lib/arm64/libtensorflowlite_jni.so\r\n2020-02-11 14:56:46.347 26572-26572/? A/DEBUG:     #06 pc 0000000000141aa8  /data/app/com.example.inpainting-40kevdvzYiOK_rsH1RbKGA==/lib/arm64/libtensorflowlite_jni.so\r\n2020-02-11 14:56:46.347 26572-26572/? A/DEBUG:     #07 pc 0000000000144f88  /data/app/com.example.inpainting-40kevdvzYiOK_rsH1RbKGA==/lib/arm64/libtensorflowlite_jni.so\r\n2020-02-11 14:56:46.347 26572-26572/? A/DEBUG:     #08 pc 000000000000eec8  /data/app/com.example.inpainting-40kevdvzYiOK_rsH1RbKGA==/lib/arm64/libtensorflowlite_jni.so (Java_org_tensorflow_lite_NativeInterpreterWrapper_run+32)\r\n2020-02-11 14:56:46.347 26572-26572/? A/DEBUG:     #09 pc 0000000000563be0  /system/lib64/libart.so (art_quick_generic_jni_trampoline+144)\r\n2020-02-11 14:56:46.347 26572-26572/? A/DEBUG:     #10 pc 000000000055ae4c  /system/lib64/libart.so (art_quick_invoke_static_stub+604)\r\n2020-02-11 14:56:46.347 26572-26572/? A/DEBUG:     #11 pc 00000000000d04e8  /system/lib64/libart.so (art::ArtMethod::Invoke(art::Thread*, unsigned int*, unsigned int, art::JValue*, char const*)+232)\r\n2020-02-11 14:56:46.347 26572-26572/? A/DEBUG:     #12 pc 00000000002838c0  /system/lib64/libart.so (art::interpreter::ArtInterpreterToCompiledCodeBridge(art::Thread*, art::ArtMethod*, art::ShadowFrame*, unsigned short, art::JValue*)+344)\r\n2020-02-11 14:56:46.347 26572-26572/? A/DEBUG:     #13 pc 000000000027d8c8  /system/lib64/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+968)\r\n2020-02-11 14:56:46.347 26572-26572/? A/DEBUG:     #14 pc 000000000052b784  /system/lib64/libart.so (MterpInvokeStatic+204)\r\n2020-02-11 14:56:46.347 26572-26572/? A/DEBUG:     #15 pc 000000000054d394  /system/lib64/libart.so (ExecuteMterpImpl+14612)\r\n2020-02-11 14:56:46.347 26572-26572/? A/DEBUG:     #16 pc 000000000019b778  /dev/ashmem/dalvik-classes.dex extracted in memory from /data/app/com.example.inpainting-40kevdvzYiOK_rsH1RbKGA==/base.apk_26388_26388 (deleted) (org.tensorflow.lite.NativeInterpreterWrapper.run+156)\r\n2020-02-11 14:56:46.347 26572-26572/? A/DEBUG:     #17 pc 00000000002575cc  /system/lib64/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.3090282045+488)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #18 pc 000000000025d0c0  /system/lib64/libart.so (art::interpreter::ArtInterpreterToInterpreterBridge(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*, art::JValue*)+216)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #19 pc 000000000027d8ac  /system/lib64/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+940)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #20 pc 000000000052a280  /system/lib64/libart.so (MterpInvokeVirtual+588)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #21 pc 000000000054d214  /system/lib64/libart.so (ExecuteMterpImpl+14228)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #22 pc 000000000019adee  /dev/ashmem/dalvik-classes.dex extracted in memory from /data/app/com.example.inpainting-40kevdvzYiOK_rsH1RbKGA==/base.apk_26388_26388 (deleted) (org.tensorflow.lite.Interpreter.runForMultipleInputsOutputs+10)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #23 pc 00000000002575cc  /system/lib64/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.3090282045+488)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #24 pc 000000000025d0c0  /system/lib64/libart.so (art::interpreter::ArtInterpreterToInterpreterBridge(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*, art::JValue*)+216)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #25 pc 000000000027d8ac  /system/lib64/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+940)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #26 pc 000000000052a280  /system/lib64/libart.so (MterpInvokeVirtual+588)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #27 pc 000000000054d214  /system/lib64/libart.so (ExecuteMterpImpl+14228)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #28 pc 000000000001c28c  /dev/ashmem/dalvik-classes2.dex extracted in memory from /data/app/com.example.inpainting-40kevdvzYiOK_rsH1RbKGA==/base.apk!classes2.dex_26388_26388 (deleted) (com.example.inpainting.MainActivity.onCreate+736)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #29 pc 00000000002575cc  /system/lib64/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.3090282045+488)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #30 pc 000000000025d0c0  /system/lib64/libart.so (art::interpreter::ArtInterpreterToInterpreterBridge(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*, art::JValue*)+216)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #31 pc 000000000027d8ac  /system/lib64/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+940)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #32 pc 000000000052a280  /system/lib64/libart.so (MterpInvokeVirtual+588)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #33 pc 000000000054d214  /system/lib64/libart.so (ExecuteMterpImpl+14228)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #34 pc 00000000004c641e  /system/framework/boot-framework.vdex (android.app.Activity.performCreate+24)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #35 pc 00000000002575cc  /system/lib64/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.3090282045+488)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #36 pc 000000000025d0c0  /system/lib64/libart.so (art::interpreter::ArtInterpreterToInterpreterBridge(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*, art::JValue*)+216)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #37 pc 000000000027d8ac  /system/lib64/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+940)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #38 pc 000000000052d2c4  /system/lib64/libart.so (MterpInvokeVirtualQuick+584)\r\n2020-02-11 14:56:46.348 26572-26572/? A/DEBUG:     #39 pc 0000000000550f94  /system/lib64/libart.so (ExecuteMterpImpl+29972)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #40 pc 00000000005eaccc  /system/framework/boot-framework.vdex (android.app.Activity.performCreate+2)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #41 pc 00000000002575cc  /system/lib64/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.3090282045+488)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #42 pc 000000000025d0c0  /system/lib64/libart.so (art::interpreter::ArtInterpreterToInterpreterBridge(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*, art::JValue*)+216)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #43 pc 000000000027d8ac  /system/lib64/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+940)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #44 pc 000000000052a280  /system/lib64/libart.so (MterpInvokeVirtual+588)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #45 pc 000000000054d214  /system/lib64/libart.so (ExecuteMterpImpl+14228)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #46 pc 00000000004e6948  /system/framework/boot-framework.vdex (android.app.Instrumentation.callActivityOnCreate+6)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #47 pc 00000000002575cc  /system/lib64/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.3090282045+488)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #48 pc 000000000025d0c0  /system/lib64/libart.so (art::interpreter::ArtInterpreterToInterpreterBridge(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*, art::JValue*)+216)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #49 pc 000000000027d8ac  /system/lib64/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+940)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #50 pc 000000000052a280  /system/lib64/libart.so (MterpInvokeVirtual+588)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #51 pc 000000000054d214  /system/lib64/libart.so (ExecuteMterpImpl+14228)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #52 pc 00000000004bd762  /system/framework/boot-framework.vdex (android.app.ActivityThread.performLaunchActivity+864)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #53 pc 00000000002575cc  /system/lib64/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.3090282045+488)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #54 pc 000000000025d0c0  /system/lib64/libart.so (art::interpreter::ArtInterpreterToInterpreterBridge(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*, art::JValue*)+216)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #55 pc 000000000027d8ac  /system/lib64/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+940)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #56 pc 000000000052b5c0  /system/lib64/libart.so (MterpInvokeDirect+296)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #57 pc 000000000054d314  /system/lib64/libart.so (ExecuteMterpImpl+14484)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #58 pc 00000000004bd37a  /system/framework/boot-framework.vdex (android.app.ActivityThread.handleLaunchActivity+72)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #59 pc 00000000002575cc  /system/lib64/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.3090282045+488)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #60 pc 000000000025d0c0  /system/lib64/libart.so (art::interpreter::ArtInterpreterToInterpreterBridge(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*, art::JValue*)+216)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #61 pc 000000000027d8ac  /system/lib64/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+940)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #62 pc 000000000052a280  /system/lib64/libart.so (MterpInvokeVirtual+588)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #63 pc 000000000054d214  /system/lib64/libart.so (ExecuteMterpImpl+14228)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #64 pc 00000000005050cc  /system/framework/boot-framework.vdex (android.app.servertransaction.LaunchActivityItem.execute+114)\r\n2020-02-11 14:56:46.349 26572-26572/? A/DEBUG:     #65 pc 00000000002575cc  /system/lib64/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.3090282045+488)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #66 pc 000000000025d0c0  /system/lib64/libart.so (art::interpreter::ArtInterpreterToInterpreterBridge(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*, art::JValue*)+216)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #67 pc 000000000027d8ac  /system/lib64/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+940)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #68 pc 000000000052a280  /system/lib64/libart.so (MterpInvokeVirtual+588)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #69 pc 000000000054d214  /system/lib64/libart.so (ExecuteMterpImpl+14228)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #70 pc 0000000000505d50  /system/framework/boot-framework.vdex (android.app.servertransaction.TransactionExecutor.executeCallbacks+198)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #71 pc 00000000002575cc  /system/lib64/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.3090282045+488)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #72 pc 000000000025d0c0  /system/lib64/libart.so (art::interpreter::ArtInterpreterToInterpreterBridge(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*, art::JValue*)+216)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #73 pc 000000000027d8ac  /system/lib64/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+940)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #74 pc 000000000052a280  /system/lib64/libart.so (MterpInvokeVirtual+588)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #75 pc 000000000054d214  /system/lib64/libart.so (ExecuteMterpImpl+14228)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #76 pc 0000000000505c62  /system/framework/boot-framework.vdex (android.app.servertransaction.TransactionExecutor.execute+68)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #77 pc 00000000002575cc  /system/lib64/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.3090282045+488)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #78 pc 000000000025d0c0  /system/lib64/libart.so (art::interpreter::ArtInterpreterToInterpreterBridge(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*, art::JValue*)+216)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #79 pc 000000000027d8ac  /system/lib64/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+940)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #80 pc 000000000052a280  /system/lib64/libart.so (MterpInvokeVirtual+588)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #81 pc 000000000054d214  /system/lib64/libart.so (ExecuteMterpImpl+14228)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #82 pc 00000000004bcb2c  /system/framework/boot-framework.vdex (android.app.ActivityThread$H.handleMessage+208)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #83 pc 00000000002575cc  /system/lib64/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.3090282045+488)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #84 pc 000000000025d0c0  /system/lib64/libart.so (art::interpreter::ArtInterpreterToInterpreterBridge(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*, art::JValue*)+216)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #85 pc 000000000027d8ac  /system/lib64/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+940)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #86 pc 000000000052a280  /system/lib64/libart.so (MterpInvokeVirtual+588)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #87 pc 000000000054d214  /system/lib64/libart.so (ExecuteMterpImpl+14228)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #88 pc 0000000000c637de  /system/framework/boot-framework.vdex (android.os.Handler.dispatchMessage+42)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #89 pc 00000000002575cc  /system/lib64/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.3090282045+488)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #90 pc 000000000025d0c0  /system/lib64/libart.so (art::interpreter::ArtInterpreterToInterpreterBridge(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*, art::JValue*)+216)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #91 pc 000000000027d8ac  /system/lib64/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+940)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #92 pc 000000000052a280  /system/lib64/libart.so (MterpInvokeVirtual+588)\r\n2020-02-11 14:56:46.350 26572-26572/? A/DEBUG:     #93 pc 000000000054d214  /system/lib64/libart.so (ExecuteMterpImpl+14228)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #94 pc 0000000000c6c452  /system/framework/boot-framework.vdex (android.os.Looper.loop+406)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #95 pc 00000000002575cc  /system/lib64/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.3090282045+488)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #96 pc 000000000025d0c0  /system/lib64/libart.so (art::interpreter::ArtInterpreterToInterpreterBridge(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*, art::JValue*)+216)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #97 pc 000000000027d8ac  /system/lib64/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+940)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #98 pc 000000000052b784  /system/lib64/libart.so (MterpInvokeStatic+204)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #99 pc 000000000054d394  /system/lib64/libart.so (ExecuteMterpImpl+14612)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #100 pc 00000000004c27b8  /system/framework/boot-framework.vdex (android.app.ActivityThread.main+220)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #101 pc 00000000002575cc  /system/lib64/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.3090282045+488)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #102 pc 000000000051ab14  /system/lib64/libart.so (artQuickToInterpreterBridge+1020)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #103 pc 0000000000563cfc  /system/lib64/libart.so (art_quick_to_interpreter_bridge+92)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #104 pc 000000000055ae4c  /system/lib64/libart.so (art_quick_invoke_static_stub+604)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #105 pc 00000000000d04e8  /system/lib64/libart.so (art::ArtMethod::Invoke(art::Thread*, unsigned int*, unsigned int, art::JValue*, char const*)+232)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #106 pc 00000000004618ac  /system/lib64/libart.so (art::(anonymous namespace)::InvokeWithArgArray(art::ScopedObjectAccessAlreadyRunnable const&, art::ArtMethod*, art::(anonymous namespace)::ArgArray*, art::JValue*, char const*)+104)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #107 pc 0000000000463300  /system/lib64/libart.so (art::InvokeMethod(art::ScopedObjectAccessAlreadyRunnable const&, _jobject*, _jobject*, _jobject*, unsigned long)+1440)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #108 pc 00000000003f2984  /system/lib64/libart.so (art::Method_invoke(_JNIEnv*, _jobject*, _jobject*, _jobjectArray*)+52)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #109 pc 000000000011e7e4  /system/framework/arm64/boot.oat (offset 0x114000) (java.lang.Class.getDeclaredMethodInternal [DEDUPED]+180)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #110 pc 000000000055ab88  /system/lib64/libart.so (art_quick_invoke_stub+584)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #111 pc 00000000000d04c8  /system/lib64/libart.so (art::ArtMethod::Invoke(art::Thread*, unsigned int*, unsigned int, art::JValue*, char const*)+200)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #112 pc 00000000002838c0  /system/lib64/libart.so (art::interpreter::ArtInterpreterToCompiledCodeBridge(art::Thread*, art::ArtMethod*, art::ShadowFrame*, unsigned short, art::JValue*)+344)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #113 pc 000000000027d8c8  /system/lib64/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+968)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #114 pc 000000000052a280  /system/lib64/libart.so (MterpInvokeVirtual+588)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #115 pc 000000000054d214  /system/lib64/libart.so (ExecuteMterpImpl+14228)\r\n2020-02-11 14:56:46.351 26572-26572/? A/DEBUG:     #116 pc 00000000013d1462  /system/framework/boot-framework.vdex (com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run+22)\r\n2020-02-11 14:56:46.352 26572-26572/? A/DEBUG:     #117 pc 00000000002575cc  /system/lib64/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.3090282045+488)\r\n2020-02-11 14:56:46.352 26572-26572/? A/DEBUG:     #118 pc 000000000051ab14  /system/lib64/libart.so (artQuickToInterpreterBridge+1020)\r\n2020-02-11 14:56:46.352 26572-26572/? A/DEBUG:     #119 pc 0000000000563cfc  /system/lib64/libart.so (art_quick_to_interpreter_bridge+92)\r\n2020-02-11 14:56:46.352 26572-26572/? A/DEBUG:     #120 pc 0000000000e17090  /system/framework/arm64/boot-framework.oat (offset 0x41f000) (com.android.internal.os.ZygoteInit.main+2208)\r\n2020-02-11 14:56:46.352 26572-26572/? A/DEBUG:     #121 pc 000000000055ae4c  /system/lib64/libart.so (art_quick_invoke_static_stub+604)\r\n2020-02-11 14:56:46.352 26572-26572/? A/DEBUG:     #122 pc 00000000000d04e8  /system/lib64/libart.so (art::ArtMethod::Invoke(art::Thread*, unsigned int*, unsigned int, art::JValue*, char const*)+232)\r\n2020-02-11 14:56:46.352 26572-26572/? A/DEBUG:     #123 pc 00000000004618ac  /system/lib64/libart.so (art::(anonymous namespace)::InvokeWithArgArray(art::ScopedObjectAccessAlreadyRunnable const&, art::ArtMethod*, art::(anonymous namespace)::ArgArray*, art::JValue*, char const*)+104)\r\n2020-02-11 14:56:46.352 26572-26572/? A/DEBUG:     #124 pc 000000000046150c  /system/lib64/libart.so (art::InvokeWithVarArgs(art::ScopedObjectAccessAlreadyRunnable const&, _jobject*, _jmethodID*, std::__va_list)+424)\r\n2020-02-11 14:56:46.352 26572-26572/? A/DEBUG:     #125 pc 0000000000366214  /system/lib64/libart.so (art::JNI::CallStaticVoidMethodV(_JNIEnv*, _jclass*, _jmethodID*, std::__va_list)+652)\r\n2020-02-11 14:56:46.352 26572-26572/? A/DEBUG:     #126 pc 00000000000b8ebc  /system/lib64/libandroid_runtime.so (_JNIEnv::CallStaticVoidMethod(_jclass*, _jmethodID*, ...)+120)\r\n2020-02-11 14:56:46.352 26572-26572/? A/DEBUG:     #127 pc 00000000000bba78  /system/lib64/libandroid_runtime.so (android::AndroidRuntime::start(char const*, android::Vector<android::String8> const&, bool)+772)\r\n2020-02-11 14:56:46.352 26572-26572/? A/DEBUG:     #128 pc 000000000000498c  /system/bin/app_process64 (main+1200)\r\n2020-02-11 14:56:46.352 26572-26572/? A/DEBUG:     #129 pc 00000000000ae8f0  /system/lib64/libc.so (__libc_init+88)\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36650", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36650/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36650/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36650/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36650", "id": 563069844, "node_id": "MDU6SXNzdWU1NjMwNjk4NDQ=", "number": 36650, "title": "Custom layer weights all have the same name by default", "user": {"login": "zaccharieramzi", "id": 6387497, "node_id": "MDQ6VXNlcjYzODc0OTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/6387497?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zaccharieramzi", "html_url": "https://github.com/zaccharieramzi", "followers_url": "https://api.github.com/users/zaccharieramzi/followers", "following_url": "https://api.github.com/users/zaccharieramzi/following{/other_user}", "gists_url": "https://api.github.com/users/zaccharieramzi/gists{/gist_id}", "starred_url": "https://api.github.com/users/zaccharieramzi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zaccharieramzi/subscriptions", "organizations_url": "https://api.github.com/users/zaccharieramzi/orgs", "repos_url": "https://api.github.com/users/zaccharieramzi/repos", "events_url": "https://api.github.com/users/zaccharieramzi/events{/privacy}", "received_events_url": "https://api.github.com/users/zaccharieramzi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-02-11T09:22:50Z", "updated_at": "2020-02-21T18:44:11Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04 \r\n- TensorFlow installed from (source or binary): no\r\n- TensorFlow version (use command below): 2.1\r\n- Python version: 3.6.7\r\n- GPU model and memory: no GPU\r\n\r\n**Describe the current behavior**\r\nI am writing a custom layer and stumbled upon the following error: https://github.com/tensorflow/tensorflow/issues/27688. The comment [here](https://github.com/tensorflow/tensorflow/issues/27688#issuecomment-582829374) made me realize that this was probably due to the custom layer weights I was using and realized that in my custom layer the weights all have by default the same name.\r\nBut it's not only my custom layer, if I use the code example from the [documentation](https://www.tensorflow.org/guide/keras/custom_layers_and_models#best_practice_deferring_weight_creation_until_the_shape_of_the_inputs_is_known), I also notice that the weights all have the same name (this is why I answered no to the question of whether I had written custom code, because it fails also in the code provided).\r\n\r\n**Describe the expected behavior**\r\n\r\nTo me it's more of a bug than a documentation issue because we expect the weights to have different names by default (increasing ids I mean). However, naming the weights indeed solves the problem.\r\n\r\n**Code to reproduce the issue**\r\n\r\n```python\r\nimport tensorflow as tf\r\n\r\nclass Linear(tf.keras.layers.Layer):\r\n\r\n  def __init__(self, units=32):\r\n    super(Linear, self).__init__()\r\n    self.units = units\r\n\r\n  def build(self, input_shape):\r\n    self.w = self.add_weight(shape=(input_shape[-1], self.units),\r\n                             initializer='random_normal',\r\n                             trainable=True)\r\n    self.b = self.add_weight(shape=(self.units,),\r\n                             initializer='random_normal',\r\n                             trainable=True)\r\n\r\n  def call(self, inputs):\r\n    return tf.matmul(inputs, self.w) + self.b\r\n\r\nl = Linear(32)\r\nl.build((128,))\r\nprint([w.name for w in l.weights])\r\n```\r\n\r\n**Other info / logs**\r\nThe code above gives:\r\n\r\n```\r\n['Variable:0', 'Variable:0']\r\n```\r\n\r\nThis causes a problem when saving the model for example with the  `ModelCheckpoint` callback.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36649", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36649/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36649/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36649/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36649", "id": 563013921, "node_id": "MDU6SXNzdWU1NjMwMTM5MjE=", "number": 36649, "title": "IndexError: list index out of range when using tf.dataset and keras for autoencoder", "user": {"login": "jdchancellor", "id": 56981293, "node_id": "MDQ6VXNlcjU2OTgxMjkz", "avatar_url": "https://avatars2.githubusercontent.com/u/56981293?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdchancellor", "html_url": "https://github.com/jdchancellor", "followers_url": "https://api.github.com/users/jdchancellor/followers", "following_url": "https://api.github.com/users/jdchancellor/following{/other_user}", "gists_url": "https://api.github.com/users/jdchancellor/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdchancellor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdchancellor/subscriptions", "organizations_url": "https://api.github.com/users/jdchancellor/orgs", "repos_url": "https://api.github.com/users/jdchancellor/repos", "events_url": "https://api.github.com/users/jdchancellor/events{/privacy}", "received_events_url": "https://api.github.com/users/jdchancellor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-02-11T07:06:49Z", "updated_at": "2020-02-21T18:48:04Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\nYes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10, anaconda, python 3.7.6\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): tensorflow 2.0.0 (using tensorflow gpu)\r\n- Python version:3.7.6\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: cudnn -7.6.5 /  cuda - 10.0\r\n- GPU model and memory: GeForce GTX 1050Ti, 4Gb of memory (anaconda sees 2996MB)\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\nunknown 2.0.0\r\n**Describe the current behavior**\r\nI'm trying to build an autoencoder using tensorflow keras using a sample of png files.   I've built a pipeline using the tensor flow dataset following closely to the tutorial provided here - https://www.tensorflow.org/guide/data#decoding_image_data_and_resizing_it .   I can see a tensor properly generated with the expected batch and shape.   The model also summarizes and compiles successfully, but when I do a model.fit to begin training, I get an error: IndexError: list index out of range. (full stack track below).  \r\n\r\n\r\n**Describe the expected behavior**\r\nModel should begin training.\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n`import tensorflow as tf\r\nPNG_ROOT = 'g:/data/video/'\r\ndata_dir = PNG_ROOT + \"*/*\"\r\nlist_ds = tf.data.Dataset.list_files(data_dir)\r\n\r\ndef decode_img(img):\r\n  # convert the compressed string to a 3D uint8 tensor\r\n  IMG_WIDTH = 360\r\n  IMG_HEIGHT = 360\r\n  img = tf.io.decode_png(img, channels=3)\r\n  img = tf.image.resize_with_crop_or_pad(img, target_height=IMG_HEIGHT, target_width=IMG_WIDTH)  \r\n  # Use `convert_image_dtype` to convert to floats in the [0,1] range.\r\n  img = tf.image.convert_image_dtype(img, tf.float32) \r\n  return img\r\n\r\ndef process_path(file_path):\r\n  img = tf.io.read_file(file_path)\r\n  image_tensor = decode_img(img)  \r\n  image_tensor = tf.reshape(image_tensor,(360,360,3))\r\n  #return img, label\r\n  return image_tensor\r\n\r\nbatch_size = 8\r\nlabeled_ds = list_ds.map(process_path)\r\nlabeled_ds = labeled_ds.batch(batch_size)\r\nds_train= labeled_ds.take(1000)\r\nds_validate = labeled_ds.take(50)\r\n\r\nfrom tensorflow.keras.models import Model\r\nfrom tensorflow.keras.layers import Conv2D, Input, MaxPooling2D, UpSampling2D\r\nfrom tensorflow.keras.optimizers import Adam\r\nfrom tensorflow.keras.callbacks import EarlyStopping, ModelCheckpoint\r\n\r\n\r\n#Build Model\r\ninput_feature = Input(batch_shape=(8,360,360,3))\r\n\r\nx = Conv2D(512, (3,3), activation='relu', input_shape=(8,360,360,3), padding='same')(input_feature)\r\nx = Conv2D(256, (3,3), activation='relu', padding='same')(x)\r\nx = MaxPooling2D(pool_size=2, padding='same')(x)\r\nx = Conv2D(128, (3,3), activation='relu', padding='same')(x)\r\nx = Conv2D(64, (3,3), activation='relu', padding='same')(x)\r\nencoded = MaxPooling2D(pool_size=2, padding='same')(x)\r\n\r\nx = Conv2D(64, (3,3), activation='relu', padding='same')(encoded)\r\nx = Conv2D(128, (3,3), activation='relu', padding='same')(x)\r\nx = UpSampling2D((2))(x)\r\nx = Conv2D(256, (3,3), activation='relu', padding='same')(x)\r\nx = Conv2D(512, (3,3), activation='relu', padding='same')(x)\r\nx = UpSampling2D((2))(x)\r\ndecoded = Conv2D(3, (3,3), activation='sigmoid', padding='same')(x)\r\n\r\nautoencoder = Model(inputs=input_feature, outputs=decoded)\r\noptimizer = tf.keras.optimizers.Adam()\r\nautoencoder.compile(optimizer='adam', loss=tf.keras.losses.MeanSquaredError(), metrics=['accuracy'])\r\nautoencoder.summary()\r\n\r\ncheckpoint = ModelCheckpoint(\"best_conv2d_png_v1.hdf5\", monitor=\"val_loss\", verbose = 1, save_best_only=True, mode='auto', save_freq=100)\r\nhistory = autoencoder.fit(ds_train, epochs=5, callbacks=[checkpoint])\r\n`\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\nEpoch 1/5\r\n      1/Unknown - 0s 143ms/step\r\n---------------------------------------------------------------------------\r\nIndexError                                Traceback (most recent call last)\r\n<ipython-input-150-e74e2479945a> in <module>\r\n      1 #early_stopping = EarlyStopping(monitor='loss', min_delta=0, patience=10, verbose=5, mode='auto')\r\n      2 checkpoint = ModelCheckpoint(\"best_conv2d_video_v1.hdf5\", monitor=\"val_loss\", verbose = 1, save_best_only=True, mode='auto', save_freq=100)\r\n----> 3 history = autoencoder.fit(ds_train, epochs=5, callbacks=[checkpoint])\r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\training.py in fit(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_freq, max_queue_size, workers, use_multiprocessing, **kwargs)\r\n    726         max_queue_size=max_queue_size,\r\n    727         workers=workers,\r\n--> 728         use_multiprocessing=use_multiprocessing)\r\n    729 \r\n    730   def evaluate(self,\r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\training_v2.py in fit(self, model, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_freq, **kwargs)\r\n    322                 mode=ModeKeys.TRAIN,\r\n    323                 training_context=training_context,\r\n--> 324                 total_epochs=epochs)\r\n    325             cbks.make_logs(model, epoch_logs, training_result, ModeKeys.TRAIN)\r\n    326 \r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\training_v2.py in run_one_epoch(model, iterator, execution_function, dataset_size, batch_size, strategy, steps_per_epoch, num_samples, mode, training_context, total_epochs)\r\n    121         step=step, mode=mode, size=current_batch_size) as batch_logs:\r\n    122       try:\r\n--> 123         batch_outs = execution_function(iterator)\r\n    124       except (StopIteration, errors.OutOfRangeError):\r\n    125         # TODO(kaftan): File bug about tf function and errors.OutOfRangeError?\r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\training_v2_utils.py in execution_function(input_fn)\r\n     84     # `numpy` translates Tensors to values in Eager mode.\r\n     85     return nest.map_structure(_non_none_constant_value,\r\n---> 86                               distributed_function(input_fn))\r\n     87 \r\n     88   return execution_function\r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\eager\\def_function.py in __call__(self, *args, **kwds)\r\n    455 \r\n    456     tracing_count = self._get_tracing_count()\r\n--> 457     result = self._call(*args, **kwds)\r\n    458     if tracing_count == self._get_tracing_count():\r\n    459       self._call_counter.called_without_tracing()\r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\eager\\def_function.py in _call(self, *args, **kwds)\r\n    501       # This is the first call of __call__, so we have to initialize.\r\n    502       initializer_map = object_identity.ObjectIdentityDictionary()\r\n--> 503       self._initialize(args, kwds, add_initializers_to=initializer_map)\r\n    504     finally:\r\n    505       # At this point we know that the initialization is complete (or less\r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\eager\\def_function.py in _initialize(self, args, kwds, add_initializers_to)\r\n    406     self._concrete_stateful_fn = (\r\n    407         self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access\r\n--> 408             *args, **kwds))\r\n    409 \r\n    410     def invalid_creator_scope(*unused_args, **unused_kwds):\r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\eager\\function.py in _get_concrete_function_internal_garbage_collected(self, *args, **kwargs)\r\n   1846     if self.input_signature:\r\n   1847       args, kwargs = None, None\r\n-> 1848     graph_function, _, _ = self._maybe_define_function(args, kwargs)\r\n   1849     return graph_function\r\n   1850 \r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\eager\\function.py in _maybe_define_function(self, args, kwargs)\r\n   2148         graph_function = self._function_cache.primary.get(cache_key, None)\r\n   2149         if graph_function is None:\r\n-> 2150           graph_function = self._create_graph_function(args, kwargs)\r\n   2151           self._function_cache.primary[cache_key] = graph_function\r\n   2152         return graph_function, args, kwargs\r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\eager\\function.py in _create_graph_function(self, args, kwargs, override_flat_arg_shapes)\r\n   2039             arg_names=arg_names,\r\n   2040             override_flat_arg_shapes=override_flat_arg_shapes,\r\n-> 2041             capture_by_value=self._capture_by_value),\r\n   2042         self._function_attributes,\r\n   2043         # Tell the ConcreteFunction to clean up its graph once it goes out of\r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\framework\\func_graph.py in func_graph_from_py_func(name, python_func, args, kwargs, signature, func_graph, autograph, autograph_options, add_control_dependencies, arg_names, op_return_value, collections, capture_by_value, override_flat_arg_shapes)\r\n    913                                           converted_func)\r\n    914 \r\n--> 915       func_outputs = python_func(*func_args, **func_kwargs)\r\n    916 \r\n    917       # invariant: `func_outputs` contains only Tensors, CompositeTensors,\r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\eager\\def_function.py in wrapped_fn(*args, **kwds)\r\n    356         # __wrapped__ allows AutoGraph to swap in a converted function. We give\r\n    357         # the function a weak reference to itself to avoid a reference cycle.\r\n--> 358         return weak_wrapped_fn().__wrapped__(*args, **kwds)\r\n    359     weak_wrapped_fn = weakref.ref(wrapped_fn)\r\n    360 \r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\training_v2_utils.py in distributed_function(input_iterator)\r\n     71     strategy = distribution_strategy_context.get_strategy()\r\n     72     outputs = strategy.experimental_run_v2(\r\n---> 73         per_replica_function, args=(model, x, y, sample_weights))\r\n     74     # Out of PerReplica outputs reduce or pick values to return.\r\n     75     all_outputs = dist_utils.unwrap_output_dict(\r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\distribute\\distribute_lib.py in experimental_run_v2(self, fn, args, kwargs)\r\n    758       fn = autograph.tf_convert(fn, ag_ctx.control_status_ctx(),\r\n    759                                 convert_by_default=False)\r\n--> 760       return self._extended.call_for_each_replica(fn, args=args, kwargs=kwargs)\r\n    761 \r\n    762   def reduce(self, reduce_op, value, axis):\r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\distribute\\distribute_lib.py in call_for_each_replica(self, fn, args, kwargs)\r\n   1785       kwargs = {}\r\n   1786     with self._container_strategy().scope():\r\n-> 1787       return self._call_for_each_replica(fn, args, kwargs)\r\n   1788 \r\n   1789   def _call_for_each_replica(self, fn, args, kwargs):\r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\distribute\\distribute_lib.py in _call_for_each_replica(self, fn, args, kwargs)\r\n   2130         self._container_strategy(),\r\n   2131         replica_id_in_sync_group=constant_op.constant(0, dtypes.int32)):\r\n-> 2132       return fn(*args, **kwargs)\r\n   2133 \r\n   2134   def _reduce_to(self, reduce_op, value, destinations):\r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\autograph\\impl\\api.py in wrapper(*args, **kwargs)\r\n    290   def wrapper(*args, **kwargs):\r\n    291     with ag_ctx.ControlStatusCtx(status=ag_ctx.Status.DISABLED):\r\n--> 292       return func(*args, **kwargs)\r\n    293 \r\n    294   if inspect.isfunction(func) or inspect.ismethod(func):\r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\training_v2_utils.py in train_on_batch(model, x, y, sample_weight, class_weight, reset_metrics)\r\n    262       y,\r\n    263       sample_weights=sample_weights,\r\n--> 264       output_loss_metrics=model._output_loss_metrics)\r\n    265 \r\n    266   if reset_metrics:\r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\training_eager.py in train_on_batch(model, inputs, targets, sample_weights, output_loss_metrics)\r\n    309           sample_weights=sample_weights,\r\n    310           training=True,\r\n--> 311           output_loss_metrics=output_loss_metrics))\r\n    312   if not isinstance(outs, list):\r\n    313     outs = [outs]\r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\training_eager.py in _process_single_batch(model, inputs, targets, output_loss_metrics, sample_weights, training)\r\n    250               output_loss_metrics=output_loss_metrics,\r\n    251               sample_weights=sample_weights,\r\n--> 252               training=training))\r\n    253       if total_loss is None:\r\n    254         raise ValueError('The model cannot be run '\r\n\r\nZ:\\anaconda\\envs\\tf-gpu\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\training_eager.py in _model_loss(model, inputs, targets, output_loss_metrics, sample_weights, training)\r\n    164 \r\n    165         if hasattr(loss_fn, 'reduction'):\r\n--> 166           per_sample_losses = loss_fn.call(targets[i], outs[i])\r\n    167           weighted_losses = losses_utils.compute_weighted_loss(\r\n    168               per_sample_losses,\r\n\r\nIndexError: list index out of `range`\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36646", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36646/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36646/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36646/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36646", "id": 563003159, "node_id": "MDU6SXNzdWU1NjMwMDMxNTk=", "number": 36646, "title": "keras.callbacks.Tensorboard cannot reduce loss and produces error", "user": {"login": "Feri73", "id": 8180783, "node_id": "MDQ6VXNlcjgxODA3ODM=", "avatar_url": "https://avatars3.githubusercontent.com/u/8180783?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Feri73", "html_url": "https://github.com/Feri73", "followers_url": "https://api.github.com/users/Feri73/followers", "following_url": "https://api.github.com/users/Feri73/following{/other_user}", "gists_url": "https://api.github.com/users/Feri73/gists{/gist_id}", "starred_url": "https://api.github.com/users/Feri73/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Feri73/subscriptions", "organizations_url": "https://api.github.com/users/Feri73/orgs", "repos_url": "https://api.github.com/users/Feri73/repos", "events_url": "https://api.github.com/users/Feri73/events{/privacy}", "received_events_url": "https://api.github.com/users/Feri73/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-02-11T06:31:40Z", "updated_at": "2020-02-24T23:46:11Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code: Yes\r\n- OS Platform and Distribution: Windows 10\r\n- TensorFlow installed from: binary\r\n- TensorFlow version: 1.15.0\r\n- Python version: 3.6.8\r\n- CUDA/cuDNN version: No GPU\r\n\r\n**Describe the current behavior**\r\nWhen using keras.callbacks.Tensorboard as a callback for fitting a keras model, this error is raised:\r\n\r\n`ValueError: can only convert an array of size 1 to a Python scalar`\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport tensorflow.keras as keras\r\nimport numpy as np\r\n\r\nmodel = keras.Sequential()\r\nmodel.add(keras.Input(shape=(), batch_size=5))\r\nmodel.add(keras.layers.Activation('sigmoid'))\r\nmodel.compile(loss=keras.losses.BinaryCrossentropy())\r\nxs = np.random.normal(size=200)\r\nys = np.random.randint(0, 2, 200)\r\ncb = keras.callbacks.TensorBoard('tmp')\r\nmodel.fit(xs, ys, callbacks=[cb], batch_size=5)\r\n```\r\nThe code above produces error. If TF 2.0 is used, OR if batch_size=1, the error is gone.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36645", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36645/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36645/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36645/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36645", "id": 562990225, "node_id": "MDU6SXNzdWU1NjI5OTAyMjU=", "number": 36645, "title": "Tensorflow lite NnApiDelegate crashes on Pixel 3a XL", "user": {"login": "helloworld1", "id": 247316, "node_id": "MDQ6VXNlcjI0NzMxNg==", "avatar_url": "https://avatars3.githubusercontent.com/u/247316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/helloworld1", "html_url": "https://github.com/helloworld1", "followers_url": "https://api.github.com/users/helloworld1/followers", "following_url": "https://api.github.com/users/helloworld1/following{/other_user}", "gists_url": "https://api.github.com/users/helloworld1/gists{/gist_id}", "starred_url": "https://api.github.com/users/helloworld1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/helloworld1/subscriptions", "organizations_url": "https://api.github.com/users/helloworld1/orgs", "repos_url": "https://api.github.com/users/helloworld1/repos", "events_url": "https://api.github.com/users/helloworld1/events{/privacy}", "received_events_url": "https://api.github.com/users/helloworld1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, {"login": "miaowang14", "id": 13321498, "node_id": "MDQ6VXNlcjEzMzIxNDk4", "avatar_url": "https://avatars3.githubusercontent.com/u/13321498?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaowang14", "html_url": "https://github.com/miaowang14", "followers_url": "https://api.github.com/users/miaowang14/followers", "following_url": "https://api.github.com/users/miaowang14/following{/other_user}", "gists_url": "https://api.github.com/users/miaowang14/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaowang14/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaowang14/subscriptions", "organizations_url": "https://api.github.com/users/miaowang14/orgs", "repos_url": "https://api.github.com/users/miaowang14/repos", "events_url": "https://api.github.com/users/miaowang14/events{/privacy}", "received_events_url": "https://api.github.com/users/miaowang14/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2020-02-11T05:44:07Z", "updated_at": "2020-03-07T00:18:31Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\nAndroid\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\nArch Linux\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\nPixel 3A XL running on Android 10\r\n- TensorFlow installed from (source or binary):\r\nbinary\r\n- TensorFlow version (use command below):\r\n2.1.0\r\n- Python version:\r\n3.7.0\r\n\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nRun tensorflow lite and specify the intepreter options with NnApiDelegete()\r\n```\r\n            val opts = Interpreter.Options()\r\n            opts.setNumThreads(NUM_LITE_THREADS)\r\n            opts.addDelegate(NnApiDelegate())\r\n            return@use Interpreter(modelBuffer, opts)\r\n```\r\n**Describe the expected behavior**\r\nThe code runs fine on emulator\r\n\r\n**Code to reproduce the issue**\r\nAdd NnApiDelegete and the code crashes on Pixel 3a XL\r\n\r\n**Other info / logs**\r\n```\r\n020-02-10 21:38:54.173 18949-18999/org.liberty.android.nlplib_demo E/ExecutionBuilder: ANeuralNetworksExecution_setInputFromMemory: Setting with operand type that is not fully specified\r\n    \r\n    --------- beginning of crash\r\n2020-02-10 21:38:54.182 18949-18949/org.liberty.android.nlplib_demo E/AndroidRuntime: FATAL EXCEPTION: main\r\n    Process: org.liberty.android.nlplib_demo, PID: 18949\r\n    java.lang.IllegalArgumentException: Internal error: Failed to run on the given Interpreter: NN API returned error ANEURALNETWORKS_BAD_DATA at line 3126 while associating NNAPI execution input with a memory object.\r\n    \r\n    Node number 2428 (TfLiteNnapiDelegate) failed to invoke.\r\n    \r\n        at org.tensorflow.lite.NativeInterpreterWrapper.run(Native Method)\r\n        at org.tensorflow.lite.NativeInterpreterWrapper.run(NativeInterpreterWrapper.java:154)\r\n        at org.tensorflow.lite.Interpreter.runForMultipleInputsOutputs(Interpreter.java:311)\r\n        at org.liberty.android.nlplib.gpt2.GPT2Client$generate$1.invokeSuspend(GPT2Client.kt:70)\r\n        at org.liberty.android.nlplib.gpt2.GPT2Client$generate$1.invoke(Unknown Source:10)\r\n        at kotlinx.coroutines.flow.SafeFlow.collect(Builders.kt:53)\r\n        at org.liberty.android.nlplib_demo.MainActivity$onCreate$4$1$1.invokeSuspend(MainActivity.kt:65)\r\n        at kotlin.coroutines.jvm.internal.BaseContinuationImpl.resumeWith(ContinuationImpl.kt:33)\r\n        at kotlinx.coroutines.DispatchedTask.run(Dispatched.kt:241)\r\n        at kotlinx.coroutines.scheduling.CoroutineScheduler.runSafely(CoroutineScheduler.kt:594)\r\n        at kotlinx.coroutines.scheduling.CoroutineScheduler.access$runSafely(CoroutineScheduler.kt:60)\r\n        at kotlinx.coroutines.scheduling.CoroutineScheduler$Worker.run(CoroutineScheduler.kt:740)\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36643", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36643/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36643/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36643/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36643", "id": 562960354, "node_id": "MDU6SXNzdWU1NjI5NjAzNTQ=", "number": 36643, "title": "Error Thrown When Decoration Used: Suggests Using Decoration", "user": {"login": "1-willAll-0", "id": 41842698, "node_id": "MDQ6VXNlcjQxODQyNjk4", "avatar_url": "https://avatars1.githubusercontent.com/u/41842698?v=4", "gravatar_id": "", "url": "https://api.github.com/users/1-willAll-0", "html_url": "https://github.com/1-willAll-0", "followers_url": "https://api.github.com/users/1-willAll-0/followers", "following_url": "https://api.github.com/users/1-willAll-0/following{/other_user}", "gists_url": "https://api.github.com/users/1-willAll-0/gists{/gist_id}", "starred_url": "https://api.github.com/users/1-willAll-0/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/1-willAll-0/subscriptions", "organizations_url": "https://api.github.com/users/1-willAll-0/orgs", "repos_url": "https://api.github.com/users/1-willAll-0/repos", "events_url": "https://api.github.com/users/1-willAll-0/events{/privacy}", "received_events_url": "https://api.github.com/users/1-willAll-0/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1190546177, "node_id": "MDU6TGFiZWwxMTkwNTQ2MTc3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:autograph", "name": "comp:autograph", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-02-11T03:40:59Z", "updated_at": "2020-02-21T18:48:02Z", "closed_at": null, "author_association": "NONE", "body": "- I am going through the DeepDream tutorial for Tensorflow 2.0 located here:\r\nhttps://www.tensorflow.org/tutorials/generative/deepdream\r\n\r\n- OS Platform and Distribution: Clear Linux OS, VERSION_ID=32270\r\n- TensorFlow installed from (source or binary): clear linux machine-learning-tensorflow bundle\r\n- TensorFlow version (use command below): 2.0.0\r\n- Python version: 3.8.1\r\n- CPU model and memory: Intel(R) Xeon(R) Gold 6136 CPU @ 3.00GHz\r\n\r\n**Describe the current behavior**\r\n\r\nThis works:\r\n\r\n```\r\nclass DeepDream(tf.Module):\r\n  def __init__(self, model):\r\n    self.model = model\r\n\r\n# !!!!! NOTICE THAT THESE LINES ARE COMMENTED OUT !!!!!\r\n# :\r\n#   @tf.function(\r\n#       input_signature=(\r\n#         tf.TensorSpec(shape=[None,None,3], dtype=tf.float32),\r\n#         tf.TensorSpec(shape=[], dtype=tf.int32),\r\n#         tf.TensorSpec(shape=[], dtype=tf.float32),)\r\n#   )\r\n  def __call__(self, img, steps, step_size):\r\n      print(\"Tracing\")\r\n      loss = tf.constant(0.0)\r\n      for n in tf.range(steps):\r\n        with tf.GradientTape() as tape:\r\n          # This needs gradients relative to `img`\r\n          # `GradientTape` only watches `tf.Variable`s by default\r\n          tape.watch(img)\r\n          loss = calc_loss(img, self.model)\r\n\r\n        # Calculate the gradient of the loss with respect to the pixels of the input image.\r\n        gradients = tape.gradient(loss, img)\r\n\r\n        # Normalize the gradients.\r\n        gradients /= tf.math.reduce_std(gradients) + 1e-8 \r\n\r\n        # In gradient ascent, the \"loss\" is maximized so that the input image increasingly \"excites\" the layers.\r\n        # You can update the image by directly adding the gradients (because they're the same shape!)\r\n        img = img + gradients*step_size\r\n        img = tf.clip_by_value(img, -1, 1)\r\n\r\n      return loss, img\r\n```\r\n\r\nThis (as is given in the tutorial) does not:\r\n\r\n```\r\nclass DeepDream(tf.Module):\r\n  def __init__(self, model):\r\n    self.model = model\r\n\r\n  @tf.function(\r\n      input_signature=(\r\n        tf.TensorSpec(shape=[None,None,3], dtype=tf.float32),\r\n        tf.TensorSpec(shape=[], dtype=tf.int32),\r\n        tf.TensorSpec(shape=[], dtype=tf.float32),)\r\n  )\r\n  def __call__(self, img, steps, step_size):\r\n      print(\"Tracing\")\r\n      loss = tf.constant(0.0)\r\n      for n in tf.range(steps):\r\n        with tf.GradientTape() as tape:\r\n          # This needs gradients relative to `img`\r\n          # `GradientTape` only watches `tf.Variable`s by default\r\n          tape.watch(img)\r\n          loss = calc_loss(img, self.model)\r\n\r\n        # Calculate the gradient of the loss with respect to the pixels of the input image.\r\n        gradients = tape.gradient(loss, img)\r\n\r\n        # Normalize the gradients.\r\n        gradients /= tf.math.reduce_std(gradients) + 1e-8 \r\n\r\n        # In gradient ascent, the \"loss\" is maximized so that the input image increasingly \"excites\" the layers.\r\n        # You can update the image by directly adding the gradients (because they're the same shape!)\r\n        img = img + gradients*step_size\r\n        img = tf.clip_by_value(img, -1, 1)\r\n\r\n      return loss, img\r\n```\r\nI've put the error that's thrown in the sections below.  \r\n\r\n**Describe the expected behavior**\r\n\r\nI would expect it to work with the decoration tag and (perhaps) not work with the decoration tag commented out. However when I run it with the decoration it throws an error that seems to suggest adding the decoration that appears to already be there, and when I comment out the decoration tag it works.  When I use the decoration tag the final error is:\r\n\r\n`OperatorNotAllowedInGraphError: iterating over `tf.Tensor` is not allowed: AutoGraph did not convert this function. Try decorating it directly with @tf.function.`\r\n\r\n(more detailed log below)\r\n\r\nHowever when I remove the decoration by commenting it out, that is when it works.\r\n\r\nNOTE:  I have Tensorflow 2.0.0 setup on google collab as well with python 3.6.9 and it does not display the same behavior.  It works either with or without the decoration.\r\n\r\nAll of this was installed on a fresh Clear Linux install tonight with no tinkering.  I had another installation earlier where I tried a fix seen elsewhere which included downgrading gast to 0.2.2.  I did that and that did not work.\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n```\r\n# [CURRENT DEEP DREAM TUTORIAL AT: https://www.tensorflow.org/tutorials/generative/deepdream\r\n\r\ndef run_deep_dream_simple(img, steps=100, step_size=0.01):\r\n  # Convert from uint8 to the range expected by the model.\r\n  img = tf.keras.applications.inception_v3.preprocess_input(img)\r\n  img = tf.convert_to_tensor(img)\r\n  step_size = tf.convert_to_tensor(step_size)\r\n  steps_remaining = steps\r\n  step = 0\r\n  while steps_remaining:\r\n    if steps_remaining>100:\r\n      run_steps = tf.constant(100)\r\n    else:\r\n      run_steps = tf.constant(steps_remaining)\r\n    steps_remaining -= run_steps\r\n    step += run_steps\r\n\r\n    loss, img = deepdream(img, run_steps, tf.constant(step_size))\r\n    \r\n    display.clear_output(wait=True)\r\n    show(deprocess(img))\r\n    print (\"Step {}, loss {}\".format(step, loss))\r\n\r\n\r\n  result = deprocess(img)\r\n  display.clear_output(wait=True)\r\n  show(result)\r\n\r\n  return result\r\n```\r\n```\r\nfrom datetime import datetime\r\nstartTime = datetime.now()\r\n\r\ndream_img = run_deep_dream_simple(img=original_img, \r\n                                  steps=100, step_size=0.01)\r\n\r\nprint(datetime.now() - startTime)\r\n```\r\n\r\n**Other info / logs**\r\n\r\n```\r\nWARNING:tensorflow:Entity <bound method DeepDream.__call__ of <tensorflow.python.eager.function.TfMethodTarget object at 0x7faea2d46d30>> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: invalid value for \"node\": expected \"ast.AST\", got \"<class 'NoneType'>\"; to visit lists of nodes, use \"visit_block\" instead\r\nWARNING: Entity <bound method DeepDream.__call__ of <tensorflow.python.eager.function.TfMethodTarget object at 0x7faea2d46d30>> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: invalid value for \"node\": expected \"ast.AST\", got \"<class 'NoneType'>\"; to visit lists of nodes, use \"visit_block\" instead\r\nTracing\r\n---------------------------------------------------------------------------\r\nValueError                                Traceback (most recent call last)\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/impl/api.py in converted_call(f, options, args, kwargs, caller_fn_scope)\r\n    505         options=options, autograph_module=tf_inspect.getmodule(converted_call))\r\n--> 506     converted_f = conversion.convert(target_entity, program_ctx)\r\n    507 \r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/impl/conversion.py in convert(entity, program_ctx)\r\n    320 \r\n--> 321   converted_entity_info = _convert_with_cache(entity, program_ctx,\r\n    322                                               free_nonglobal_var_names)\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/impl/conversion.py in _convert_with_cache(entity, program_ctx, free_nonglobal_var_names)\r\n    238 \r\n--> 239     nodes, converted_name, entity_info = convert_entity_to_ast(\r\n    240         entity, program_ctx)\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/impl/conversion.py in convert_entity_to_ast(o, program_ctx)\r\n    470   elif tf_inspect.ismethod(o):\r\n--> 471     nodes, name, entity_info = convert_func_to_ast(o, program_ctx)\r\n    472   elif hasattr(o, '__class__'):\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/impl/conversion.py in convert_func_to_ast(f, program_ctx, do_rename)\r\n    668   context = converter.EntityContext(namer, entity_info, program_ctx, new_name)\r\n--> 669   node = node_to_graph(node, context)\r\n    670 \r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/impl/conversion.py in node_to_graph(node, context)\r\n    697 \r\n--> 698   node = converter.standard_analysis(node, context, is_initial=True)\r\n    699   node = converter.apply_(node, context, function_scopes)\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/core/converter.py in standard_analysis(node, context, is_initial)\r\n    383   node = qual_names.resolve(node)\r\n--> 384   node = activity.resolve(node, context, None)\r\n    385   node = reaching_definitions.resolve(node, context, graphs, AnnotatedDef)\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/pyct/static_analysis/activity.py in resolve(node, context, parent_scope)\r\n    497 def resolve(node, context, parent_scope=None):\r\n--> 498   return ActivityAnalyzer(context, parent_scope).visit(node)\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/pyct/transformer.py in visit(self, node)\r\n    479     if not anno.hasanno(node, anno.Basic.SKIP_PROCESSING):\r\n--> 480       result = super(Base, self).visit(node)\r\n    481     self.ctx.current_origin = parent_origin\r\n\r\n/usr/lib/python3.8/ast.py in visit(self, node)\r\n    359         visitor = getattr(self, method, self.generic_visit)\r\n--> 360         return visitor(node)\r\n    361 \r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/pyct/static_analysis/activity.py in visit_FunctionDef(self, node)\r\n    441     self._enter_scope(False)\r\n--> 442     node.body = self.visit_block(node.body)\r\n    443     anno.setanno(node, NodeAnno.BODY_SCOPE, self.scope)\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/pyct/transformer.py in visit_block(self, nodes, before_visit, after_visit)\r\n    370 \r\n--> 371       replacement = self.visit(node)\r\n    372 \r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/pyct/transformer.py in visit(self, node)\r\n    479     if not anno.hasanno(node, anno.Basic.SKIP_PROCESSING):\r\n--> 480       result = super(Base, self).visit(node)\r\n    481     self.ctx.current_origin = parent_origin\r\n\r\n/usr/lib/python3.8/ast.py in visit(self, node)\r\n    359         visitor = getattr(self, method, self.generic_visit)\r\n--> 360         return visitor(node)\r\n    361 \r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/pyct/static_analysis/activity.py in visit_Expr(self, node)\r\n    265   def visit_Expr(self, node):\r\n--> 266     return self._process_statement(node)\r\n    267 \r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/pyct/static_analysis/activity.py in _process_statement(self, node)\r\n    259     self._enter_scope(False)\r\n--> 260     node = self.generic_visit(node)\r\n    261     anno.setanno(node, anno.Static.SCOPE, self.scope)\r\n\r\n/usr/lib/python3.8/ast.py in generic_visit(self, node)\r\n    444             elif isinstance(old_value, AST):\r\n--> 445                 new_node = self.visit(old_value)\r\n    446                 if new_node is None:\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/pyct/transformer.py in visit(self, node)\r\n    479     if not anno.hasanno(node, anno.Basic.SKIP_PROCESSING):\r\n--> 480       result = super(Base, self).visit(node)\r\n    481     self.ctx.current_origin = parent_origin\r\n\r\n/usr/lib/python3.8/ast.py in visit(self, node)\r\n    359         visitor = getattr(self, method, self.generic_visit)\r\n--> 360         return visitor(node)\r\n    361 \r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/pyct/static_analysis/activity.py in visit_Call(self, node)\r\n    327     self._enter_scope(False)\r\n--> 328     node.args = self.visit_block(node.args)\r\n    329     node.keywords = self.visit_block(node.keywords)\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/pyct/transformer.py in visit_block(self, nodes, before_visit, after_visit)\r\n    370 \r\n--> 371       replacement = self.visit(node)\r\n    372 \r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/pyct/transformer.py in visit(self, node)\r\n    457                  type(node))\r\n--> 458       raise ValueError(msg)\r\n    459 \r\n\r\nValueError: invalid value for \"node\": expected \"ast.AST\", got \"<class 'NoneType'>\"; to visit lists of nodes, use \"visit_block\" instead\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nOperatorNotAllowedInGraphError            Traceback (most recent call last)\r\n<ipython-input-9-43912bcedaa9> in <module>\r\n      2 startTime = datetime.now()\r\n      3 \r\n----> 4 dream_img = run_deep_dream_simple(img=original_img, \r\n      5                                   steps=100, step_size=0.01)\r\n      6 \r\n\r\n<ipython-input-8-193f882b4182> in run_deep_dream_simple(img, steps, step_size)\r\n     14     step += run_steps\r\n     15 \r\n---> 16     loss, img = deepdream(img, run_steps, tf.constant(step_size))\r\n     17 \r\n     18     display.clear_output(wait=True)\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/eager/def_function.py in __call__(self, *args, **kwds)\r\n    455 \r\n    456     tracing_count = self._get_tracing_count()\r\n--> 457     result = self._call(*args, **kwds)\r\n    458     if tracing_count == self._get_tracing_count():\r\n    459       self._call_counter.called_without_tracing()\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/eager/def_function.py in _call(self, *args, **kwds)\r\n    501       # This is the first call of __call__, so we have to initialize.\r\n    502       initializer_map = object_identity.ObjectIdentityDictionary()\r\n--> 503       self._initialize(args, kwds, add_initializers_to=initializer_map)\r\n    504     finally:\r\n    505       # At this point we know that the initialization is complete (or less\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/eager/def_function.py in _initialize(self, args, kwds, add_initializers_to)\r\n    405     self._graph_deleter = FunctionDeleter(self._lifted_initializer_graph)\r\n    406     self._concrete_stateful_fn = (\r\n--> 407         self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access\r\n    408             *args, **kwds))\r\n    409 \r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/eager/function.py in _get_concrete_function_internal_garbage_collected(self, *args, **kwargs)\r\n   1846     if self.input_signature:\r\n   1847       args, kwargs = None, None\r\n-> 1848     graph_function, _, _ = self._maybe_define_function(args, kwargs)\r\n   1849     return graph_function\r\n   1850 \r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/eager/function.py in _maybe_define_function(self, args, kwargs)\r\n   2148         graph_function = self._function_cache.primary.get(cache_key, None)\r\n   2149         if graph_function is None:\r\n-> 2150           graph_function = self._create_graph_function(args, kwargs)\r\n   2151           self._function_cache.primary[cache_key] = graph_function\r\n   2152         return graph_function, args, kwargs\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/eager/function.py in _create_graph_function(self, args, kwargs, override_flat_arg_shapes)\r\n   2029     arg_names = base_arg_names + missing_arg_names\r\n   2030     graph_function = ConcreteFunction(\r\n-> 2031         func_graph_module.func_graph_from_py_func(\r\n   2032             self._name,\r\n   2033             self._python_function,\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/framework/func_graph.py in func_graph_from_py_func(name, python_func, args, kwargs, signature, func_graph, autograph, autograph_options, add_control_dependencies, arg_names, op_return_value, collections, capture_by_value, override_flat_arg_shapes)\r\n    913                                           converted_func)\r\n    914 \r\n--> 915       func_outputs = python_func(*func_args, **func_kwargs)\r\n    916 \r\n    917       # invariant: `func_outputs` contains only Tensors, CompositeTensors,\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/eager/def_function.py in wrapped_fn(*args, **kwds)\r\n    356         # __wrapped__ allows AutoGraph to swap in a converted function. We give\r\n    357         # the function a weak reference to itself to avoid a reference cycle.\r\n--> 358         return weak_wrapped_fn().__wrapped__(*args, **kwds)\r\n    359     weak_wrapped_fn = weakref.ref(wrapped_fn)\r\n    360 \r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/eager/function.py in bound_method_wrapper(*args, **kwargs)\r\n   2656     # However, the replacer is still responsible for attaching self properly.\r\n   2657     # TODO(mdan): Is it possible to do it here instead?\r\n-> 2658     return wrapped_fn(*args, **kwargs)\r\n   2659   weak_bound_method_wrapper = weakref.ref(bound_method_wrapper)\r\n   2660 \r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/framework/func_graph.py in wrapper(*args, **kwargs)\r\n    894           # TODO(mdan): Push this block higher in tf.function's call stack.\r\n    895           try:\r\n--> 896             return autograph.converted_call(\r\n    897                 original_func,\r\n    898                 autograph.ConversionOptions(\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/impl/api.py in converted_call(f, options, args, kwargs, caller_fn_scope)\r\n    532         ' the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and'\r\n    533         ' attach the full output. Cause: %s', target_entity, e)\r\n--> 534     return _call_unconverted(f, args, kwargs, options)\r\n    535 \r\n    536   with StackTraceMapper(converted_f), tf_stack.CurrentModuleFilter():\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/autograph/impl/api.py in _call_unconverted(f, args, kwargs, options, update_cache)\r\n    324 \r\n    325   if inspect_utils.istfmethodtarget(f):\r\n--> 326     return f.__self__.call(args, kwargs)\r\n    327 \r\n    328   try:\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/eager/function.py in call(self, args, kwargs)\r\n   2618     if tf_inspect.ismethod(wrapped_fn):\r\n   2619       wrapped_fn = six.get_unbound_function(wrapped_fn)\r\n-> 2620     return wrapped_fn(self.weakrefself_target__(), *args, **kwargs)\r\n   2621 \r\n   2622 \r\n\r\n<ipython-input-6-3ac13775042b> in __call__(self, img, steps, step_size)\r\n     12       print(\"Tracing\")\r\n     13       loss = tf.constant(0.0)\r\n---> 14       for n in tf.range(steps):\r\n     15         with tf.GradientTape() as tape:\r\n     16           # This needs gradients relative to `img`\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/framework/ops.py in __iter__(self)\r\n    545   def __iter__(self):\r\n    546     if not context.executing_eagerly():\r\n--> 547       self._disallow_iteration()\r\n    548 \r\n    549     shape = self._shape_tuple()\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/framework/ops.py in _disallow_iteration(self)\r\n    538       self._disallow_when_autograph_disabled(\"iterating over `tf.Tensor`\")\r\n    539     elif ag_ctx.control_status_ctx().status == ag_ctx.Status.ENABLED:\r\n--> 540       self._disallow_when_autograph_enabled(\"iterating over `tf.Tensor`\")\r\n    541     else:\r\n    542       # Default: V1-style Graph execution.\r\n\r\n/usr/lib/python3.8/site-packages/tensorflow_core/python/framework/ops.py in _disallow_when_autograph_enabled(self, task)\r\n    514 \r\n    515   def _disallow_when_autograph_enabled(self, task):\r\n--> 516     raise errors.OperatorNotAllowedInGraphError(\r\n    517         \"{} is not allowed: AutoGraph did not convert this function. Try\"\r\n    518         \" decorating it directly with @tf.function.\".format(task))\r\n\r\nOperatorNotAllowedInGraphError: iterating over `tf.Tensor` is not allowed: AutoGraph did not convert this function. Try decorating it directly with @tf.function.\r\n```\r\n\r\nThank you!\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36642", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36642/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36642/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36642/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36642", "id": 562922828, "node_id": "MDU6SXNzdWU1NjI5MjI4Mjg=", "number": 36642, "title": "Throw an error when connecting inputs to weight-shared-embedding-layer more than 5 times.", "user": {"login": "tsuzukit", "id": 1654502, "node_id": "MDQ6VXNlcjE2NTQ1MDI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1654502?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tsuzukit", "html_url": "https://github.com/tsuzukit", "followers_url": "https://api.github.com/users/tsuzukit/followers", "following_url": "https://api.github.com/users/tsuzukit/following{/other_user}", "gists_url": "https://api.github.com/users/tsuzukit/gists{/gist_id}", "starred_url": "https://api.github.com/users/tsuzukit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tsuzukit/subscriptions", "organizations_url": "https://api.github.com/users/tsuzukit/orgs", "repos_url": "https://api.github.com/users/tsuzukit/repos", "events_url": "https://api.github.com/users/tsuzukit/events{/privacy}", "received_events_url": "https://api.github.com/users/tsuzukit/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2020-02-11T01:14:20Z", "updated_at": "2020-03-07T18:31:10Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Google Colaboratory with Ubuntu 18.04.3 LTS (Bionic Beaver)\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: No\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): v2.1.0-0-ge5bf8de410 2.1.0\r\n- Python version: 3.6.9\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source): N/A\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: N/A\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\n\r\nWhen inputs are connected to weight-shared-embedding-layer more than 5 times, tensorflow throws an error while training.\r\n\r\nThis behavior is not seen with below condition.\r\n- connections to weight-shared-embedding-layer are less than 4\r\n- using tensorflow version 1.15\r\n\r\n**Describe the expected behavior**\r\n\r\nSuccessfully train a model using weight-shared-embedding-layer connecting more than 5 inputs.\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n```\r\nimport tensorflow as tf\r\nimport tensorflow.keras.backend as K\r\nimport numpy as np\r\n\r\n# changing this to 4 make train success\r\nn_inputs = 5\r\ndim_embedding = 10\r\n\r\ninputs = []\r\nfor i in range(n_inputs):\r\n  inputs.append(tf.keras.Input(shape=(1,), dtype='int32'))\r\n\r\nembeds = []\r\nshared_embed = tf.keras.layers.Embedding(n_input, dim_embedding)\r\nfor i in range(n_inputs):\r\n  embed = shared_embed(inputs[i])\r\n  flatten = tf.keras.layers.Flatten()(embed)\r\n  embeds.append(flatten)\r\n\r\nconcat = tf.keras.layers.Concatenate(axis=1)(embeds)\r\noutput = tf.keras.layers.Dense(1)(concat)\r\nmodel = tf.keras.Model(inputs=[inputs], outputs=[output])\r\nmodel.summary()\r\n\r\nmodel.compile(optimizer='adam', loss='mse')\r\n\r\n# run\r\ndummy_input = []\r\nfor i in range(n_shared_layers):\r\n  dummy_input.append(np.random.randint(0, n_input, size=(1000, )))\r\n\r\ndummy = np.arange(1000).reshape(1000, 1, 1)\r\n\r\nmodel.fit(x=dummy_input, y=dummy, batch_size=32, epochs=1, verbose=1)\r\n```\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\nhttps://colab.research.google.com/drive/1NV_KXlKRv148H50SExVYdHkVCh9Acnp_?hl=ja#scrollTo=13C17fSiwhAC\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36641", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36641/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36641/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36641/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36641", "id": 562922248, "node_id": "MDExOlB1bGxSZXF1ZXN0MzczNDMxNDUz", "number": 36641, "title": "[ROCm] CUDA/ROCm shared interface", "user": {"login": "ekuznetsov139", "id": 12205429, "node_id": "MDQ6VXNlcjEyMjA1NDI5", "avatar_url": "https://avatars2.githubusercontent.com/u/12205429?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ekuznetsov139", "html_url": "https://github.com/ekuznetsov139", "followers_url": "https://api.github.com/users/ekuznetsov139/followers", "following_url": "https://api.github.com/users/ekuznetsov139/following{/other_user}", "gists_url": "https://api.github.com/users/ekuznetsov139/gists{/gist_id}", "starred_url": "https://api.github.com/users/ekuznetsov139/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ekuznetsov139/subscriptions", "organizations_url": "https://api.github.com/users/ekuznetsov139/orgs", "repos_url": "https://api.github.com/users/ekuznetsov139/repos", "events_url": "https://api.github.com/users/ekuznetsov139/events{/privacy}", "received_events_url": "https://api.github.com/users/ekuznetsov139/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 1169365494, "node_id": "MDU6TGFiZWwxMTY5MzY1NDk0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:M", "name": "size:M", "color": "adafea", "default": false, "description": "CL Change Size: Medium"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-02-11T01:12:26Z", "updated_at": "2020-03-13T11:56:51Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36641", "html_url": "https://github.com/tensorflow/tensorflow/pull/36641", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36641.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36641.patch"}, "body": "This PR adds several macros and typedefs to assist with writing kernels that seamlessly work with both CUDA and ROCm."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36640", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36640/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36640/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36640/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36640", "id": 562921256, "node_id": "MDExOlB1bGxSZXF1ZXN0MzczNDMwNjQ4", "number": 36640, "title": "[ROCm] Create a wrapper header for rocprim and cub", "user": {"login": "ekuznetsov139", "id": 12205429, "node_id": "MDQ6VXNlcjEyMjA1NDI5", "avatar_url": "https://avatars2.githubusercontent.com/u/12205429?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ekuznetsov139", "html_url": "https://github.com/ekuznetsov139", "followers_url": "https://api.github.com/users/ekuznetsov139/followers", "following_url": "https://api.github.com/users/ekuznetsov139/following{/other_user}", "gists_url": "https://api.github.com/users/ekuznetsov139/gists{/gist_id}", "starred_url": "https://api.github.com/users/ekuznetsov139/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ekuznetsov139/subscriptions", "organizations_url": "https://api.github.com/users/ekuznetsov139/orgs", "repos_url": "https://api.github.com/users/ekuznetsov139/repos", "events_url": "https://api.github.com/users/ekuznetsov139/events{/privacy}", "received_events_url": "https://api.github.com/users/ekuznetsov139/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1169365682, "node_id": "MDU6TGFiZWwxMTY5MzY1Njgy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:L", "name": "size:L", "color": "adafea", "default": false, "description": "CL Change Size: Large"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-02-11T01:08:38Z", "updated_at": "2020-03-19T12:44:32Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36640", "html_url": "https://github.com/tensorflow/tensorflow/pull/36640", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36640.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36640.patch"}, "body": "This PR creates a header that includes either rocprim or cub, depending on the selected build architecture."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36635", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36635/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36635/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36635/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36635", "id": 562880691, "node_id": "MDExOlB1bGxSZXF1ZXN0MzczMzk3MTkx", "number": 36635, "title": "Make callbacks serializable", "user": {"login": "ivanlen", "id": 28719944, "node_id": "MDQ6VXNlcjI4NzE5OTQ0", "avatar_url": "https://avatars2.githubusercontent.com/u/28719944?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ivanlen", "html_url": "https://github.com/ivanlen", "followers_url": "https://api.github.com/users/ivanlen/followers", "following_url": "https://api.github.com/users/ivanlen/following{/other_user}", "gists_url": "https://api.github.com/users/ivanlen/gists{/gist_id}", "starred_url": "https://api.github.com/users/ivanlen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ivanlen/subscriptions", "organizations_url": "https://api.github.com/users/ivanlen/orgs", "repos_url": "https://api.github.com/users/ivanlen/repos", "events_url": "https://api.github.com/users/ivanlen/events{/privacy}", "received_events_url": "https://api.github.com/users/ivanlen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1169365494, "node_id": "MDU6TGFiZWwxMTY5MzY1NDk0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:M", "name": "size:M", "color": "adafea", "default": false, "description": "CL Change Size: Medium"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-02-10T23:01:21Z", "updated_at": "2020-03-19T12:43:55Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36635", "html_url": "https://github.com/tensorflow/tensorflow/pull/36635", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36635.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36635.patch"}, "body": "Following the suggestion of @fchollet I follow up an old PR of the [keras](https://github.com/keras-team/keras/pull/13001) repository.\r\n\r\n### Summary\r\n\r\nAdd get_config method to callback classes:\r\n\r\nCallbacks as well as layers and optimizers have lots of arguments. The get_config method in the callbacks returns a dictionary with the configuration of the callback allowing us to inspect the parameters of the instance. This allow us to understand better the callbacks and even change them if it is necessary easily.\r\n\r\n### Objectives \r\n\r\n- This method allows to easily obtain the configuration of a callback without knowing the arguments of the callback. \r\n- For the sake of completeness classes such as the `layers`, and `optimizers` have the `get_config` method, thus I think that it will be useful to add this method to callback objects.\r\nAdditionally:\r\n- It is known that keras object are not pickleable, adding a get_config method to optimizers may enable to share different optimizers configuration without the need of sharing the object themselves.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36634", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36634/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36634/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36634/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36634", "id": 562870939, "node_id": "MDU6SXNzdWU1NjI4NzA5Mzk=", "number": 36634, "title": "How to create new cuda stream in custom op", "user": {"login": "chaaland", "id": 5944266, "node_id": "MDQ6VXNlcjU5NDQyNjY=", "avatar_url": "https://avatars1.githubusercontent.com/u/5944266?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chaaland", "html_url": "https://github.com/chaaland", "followers_url": "https://api.github.com/users/chaaland/followers", "following_url": "https://api.github.com/users/chaaland/following{/other_user}", "gists_url": "https://api.github.com/users/chaaland/gists{/gist_id}", "starred_url": "https://api.github.com/users/chaaland/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chaaland/subscriptions", "organizations_url": "https://api.github.com/users/chaaland/orgs", "repos_url": "https://api.github.com/users/chaaland/repos", "events_url": "https://api.github.com/users/chaaland/events{/privacy}", "received_events_url": "https://api.github.com/users/chaaland/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-02-10T22:37:02Z", "updated_at": "2020-03-11T00:55:58Z", "closed_at": null, "author_association": "NONE", "body": "I've written a custom op for the GPU that takes X with shape ```(n,p)``` and Y with shape ```(m,p)``` and returns Z with shape ```(n,m)```. \r\n\r\nIn the backward pass, dX and dY are independent computations so I'd like to have launch two separate CUDA kernels and have them run in separate streams. I know the cuDNN RNN is capable of doing kernels in parallel but I cannot find the source code for how to do this. It seems the only usable stream is provided by the OpKernelContext. \r\n\r\nMatrix multiplication must have a similar parallelism when doing the backward pass but I have not found anywhere in the source making use of multiple streams. This is essentially a reopening of [this issue](https://github.com/tensorflow/tensorflow/issues/6675) as there doesn't appear to a public answer\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36632", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36632/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36632/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36632/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36632", "id": 562754408, "node_id": "MDU6SXNzdWU1NjI3NTQ0MDg=", "number": 36632, "title": "Able to disable auto-insert quantize de-quantize node to quantized model.", "user": {"login": "psunn", "id": 55463253, "node_id": "MDQ6VXNlcjU1NDYzMjUz", "avatar_url": "https://avatars3.githubusercontent.com/u/55463253?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psunn", "html_url": "https://github.com/psunn", "followers_url": "https://api.github.com/users/psunn/followers", "following_url": "https://api.github.com/users/psunn/following{/other_user}", "gists_url": "https://api.github.com/users/psunn/gists{/gist_id}", "starred_url": "https://api.github.com/users/psunn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psunn/subscriptions", "organizations_url": "https://api.github.com/users/psunn/orgs", "repos_url": "https://api.github.com/users/psunn/repos", "events_url": "https://api.github.com/users/psunn/events{/privacy}", "received_events_url": "https://api.github.com/users/psunn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jianlijianli", "id": 43797323, "node_id": "MDQ6VXNlcjQzNzk3MzIz", "avatar_url": "https://avatars3.githubusercontent.com/u/43797323?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jianlijianli", "html_url": "https://github.com/jianlijianli", "followers_url": "https://api.github.com/users/jianlijianli/followers", "following_url": "https://api.github.com/users/jianlijianli/following{/other_user}", "gists_url": "https://api.github.com/users/jianlijianli/gists{/gist_id}", "starred_url": "https://api.github.com/users/jianlijianli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jianlijianli/subscriptions", "organizations_url": "https://api.github.com/users/jianlijianli/orgs", "repos_url": "https://api.github.com/users/jianlijianli/repos", "events_url": "https://api.github.com/users/jianlijianli/events{/privacy}", "received_events_url": "https://api.github.com/users/jianlijianli/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jianlijianli", "id": 43797323, "node_id": "MDQ6VXNlcjQzNzk3MzIz", "avatar_url": "https://avatars3.githubusercontent.com/u/43797323?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jianlijianli", "html_url": "https://github.com/jianlijianli", "followers_url": "https://api.github.com/users/jianlijianli/followers", "following_url": "https://api.github.com/users/jianlijianli/following{/other_user}", "gists_url": "https://api.github.com/users/jianlijianli/gists{/gist_id}", "starred_url": "https://api.github.com/users/jianlijianli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jianlijianli/subscriptions", "organizations_url": "https://api.github.com/users/jianlijianli/orgs", "repos_url": "https://api.github.com/users/jianlijianli/repos", "events_url": "https://api.github.com/users/jianlijianli/events{/privacy}", "received_events_url": "https://api.github.com/users/jianlijianli/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-02-10T18:44:06Z", "updated_at": "2020-03-18T21:13:42Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (or github SHA if from source): 1.15.2, 2.1.0\r\n\r\n\r\nTFLiteConverter will automatically insert quantize and dequantize node to quantized model, so that input and output of the quantized model are float32. (check the code, and model example graph below)\r\n\r\n```python\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\ndef gen_calibration_dataset():\r\n    for _ in range(10):\r\n        yield [np.random.rand(1,2,2,2).astype(np.float32)]\r\n\r\ndef get_keras_model_conv():\r\n    input_0 = tf.keras.layers.Input(shape=[2, 2, 2])\r\n    conv_0 = tf.keras.layers.Conv2D(filters=2, kernel_size=(2, 2),\r\n                                    activation=tf.nn.relu)(input_0)\r\n    model = tf.keras.models.Model(inputs=[input_0], outputs=[conv_0])\r\n    model.summary()\r\n    return model\r\n\r\ndef gen_model():\r\n\r\n    keras_model = get_keras_model_conv()\r\n    converter = tf.lite.TFLiteConverter.from_keras_model(keras_model)\r\n    converter.optimizations = [tf.lite.Optimize.DEFAULT]\r\n    converter.target_spec.supported_ops = [tf.lite.OpsSet.TFLITE_BUILTINS_INT8]\r\n    converter.representative_dataset = gen_calibration_dataset\r\n    tflite_quant_model = converter.convert()\r\n    open('test.tflite', 'wb').write(tflite_quant_model)\r\n\r\nprint(\"TF version: {}\".format(tf.__version__))\r\ngen_model()\r\n```\r\n\r\n![image](https://user-images.githubusercontent.com/55463253/74179096-ac3e5d00-4c34-11ea-8f92-6eb1015a1f16.png)\r\n\r\nIs there any convenient way (through python api) to force the model input,output remain int8 (not auto insert quantize, dequantize node)? I didn't find official doc about this.\r\nIf not, is it reasonable to add such feature to TFLiteConverter?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36627", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36627/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36627/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36627/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36627", "id": 562693753, "node_id": "MDU6SXNzdWU1NjI2OTM3NTM=", "number": 36627, "title": "GPU memory not released until Java process terminates", "user": {"login": "TheSentry", "id": 2415237, "node_id": "MDQ6VXNlcjI0MTUyMzc=", "avatar_url": "https://avatars0.githubusercontent.com/u/2415237?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TheSentry", "html_url": "https://github.com/TheSentry", "followers_url": "https://api.github.com/users/TheSentry/followers", "following_url": "https://api.github.com/users/TheSentry/following{/other_user}", "gists_url": "https://api.github.com/users/TheSentry/gists{/gist_id}", "starred_url": "https://api.github.com/users/TheSentry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TheSentry/subscriptions", "organizations_url": "https://api.github.com/users/TheSentry/orgs", "repos_url": "https://api.github.com/users/TheSentry/repos", "events_url": "https://api.github.com/users/TheSentry/events{/privacy}", "received_events_url": "https://api.github.com/users/TheSentry/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-02-10T16:53:59Z", "updated_at": "2020-02-21T18:44:08Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\nNo\r\n\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\nUbuntu 18.04.4 LTS, Kernel 4.15.0-76-generic\r\n\r\n- TensorFlow installed from (source or binary):\r\nBinary\r\n\r\n- TensorFlow version (use command below):\r\n1.15.0\r\n\r\n- Python version:\r\nPython 3.6.9\r\n\r\n- CUDA/cuDNN version:\r\n10.0.130\r\n\r\n- GPU model and memory:\r\nGeForce GTX 1080 Ti, 11177MiB\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nAfter closing all Tensors, Graphs and Sessions in our Java programm, the Java process still holds the previously used GPU memory until the Java process terminates.\r\n\r\n**Describe the expected behavior**\r\nAfter closing all Tensors, Graphs and Sessions, the Java process should release all allocated GPU memory.\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n```java\r\npackage de.tensorflowtest;\r\n\r\nimport static org.apache.commons.io.IOUtils.toByteArray;\r\nimport java.io.Console;\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport org.tensorflow.Graph;\r\nimport org.tensorflow.Session;\r\nimport org.tensorflow.framework.ConfigProto;\r\nimport de.tensorflowtest.Constants;\r\n\r\npublic class GpuLeakDebug {\r\n    public static void main(String[] args) throws IOException, InterruptedException {\r\n\r\n        waitWithMessage(\"Create Session\");\r\n\r\n        Session session = null;\r\n        Graph graph = null;\r\n        ConfigProto sessionConfig;\r\n        try {\r\n            byte[] graphdef = null;\r\n            try (InputStream graphStream = Constants.class.getResourceAsStream(\"/tensorflow/inception_v3.pb\")) {\r\n                graphdef = toByteArray(graphStream);\r\n            } catch (IOException e) {\r\n                System.exit(1);\r\n            }\r\n            graph = new Graph();\r\n            graph.importGraphDef(graphdef);\r\n            sessionConfig = ConfigProto.newBuilder().build();\r\n            session = new Session(graph, sessionConfig.toByteArray());\r\n\r\n        } catch (UnsatisfiedLinkError e) {\r\n\r\n            throw e;\r\n        } finally {\r\n            waitWithMessage(\"Close Session\");\r\n            session.close();\r\n            graph.close();\r\n        }\r\n        session = null;\r\n        graph = null;\r\n        sessionConfig = null;\r\n\r\n        waitWithMessage(\"Terminate\");\r\n    }\r\n\r\n    private static void waitWithMessage(String message, Object... args) {\r\n        Console c = System.console();\r\n        if (c != null) {\r\n            // printf-like arguments\r\n            if (message != null)\r\n                c.format(message, args);\r\n            c.format(\" Press ENTER to proceed.\\n\");\r\n            c.readLine();\r\n        }\r\n    }\r\n}\r\n```\r\n\r\n**Other info / logs**\r\nThis is the output of `nvidia-smi` **before the session is created** (\"Create Session\") and **after the JVM terminates** (\"Terminate\").\r\n```\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 430.50       Driver Version: 430.50       CUDA Version: 10.1     |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce GTX 108...  Off  | 00000000:03:00.0 Off |                  N/A |\r\n| 25%   57C    P5    30W / 250W |      0MiB / 11177MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|  No running processes found                                                 |\r\n+-----------------------------------------------------------------------------+\r\n```\r\nThis is the output of `nvidia-smi` **after the session has been created** and **after the session has been closed**.\r\n```\r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 430.50       Driver Version: 430.50       CUDA Version: 10.1     |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  GeForce GTX 108...  Off  | 00000000:03:00.0 Off |                  N/A |\r\n| 19%   53C    P5    24W / 250W |    145MiB / 11177MiB |      0%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n                                                                               \r\n+-----------------------------------------------------------------------------+\r\n| Processes:                                                       GPU Memory |\r\n|  GPU       PID   Type   Process name                             Usage      |\r\n|=============================================================================|\r\n|    0     20221      C   /usr/bin/java                                135MiB |\r\n+-----------------------------------------------------------------------------+\r\n```\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36626", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36626/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36626/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36626/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36626", "id": 562662697, "node_id": "MDU6SXNzdWU1NjI2NjI2OTc=", "number": 36626, "title": "Dataset.shuffle leads to worse training performance due to chunked processing", "user": {"login": "Flamefire", "id": 309017, "node_id": "MDQ6VXNlcjMwOTAxNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/309017?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Flamefire", "html_url": "https://github.com/Flamefire", "followers_url": "https://api.github.com/users/Flamefire/followers", "following_url": "https://api.github.com/users/Flamefire/following{/other_user}", "gists_url": "https://api.github.com/users/Flamefire/gists{/gist_id}", "starred_url": "https://api.github.com/users/Flamefire/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Flamefire/subscriptions", "organizations_url": "https://api.github.com/users/Flamefire/orgs", "repos_url": "https://api.github.com/users/Flamefire/repos", "events_url": "https://api.github.com/users/Flamefire/events{/privacy}", "received_events_url": "https://api.github.com/users/Flamefire/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-02-10T16:05:59Z", "updated_at": "2020-02-12T13:09:32Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Mint\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 2.1.0\r\n- Python version: 3.7.4\r\n\r\n**Describe the current behavior**\r\n\r\nDataset.shuffle is (essentially) described as buffering N elements, then choosing 1 out of those N to return. Hence the input data is processed in chunks. In the extreme consider a shuffle buffer of size 2: In the first epoch only the first 2 elements can be returned. And the following code (using the 3rd and 4th element) produces only values of 0-4:\r\n\r\n```\r\ndataset = tf.data.Dataset.range(10)\r\ndataset = dataset.shuffle(2)\r\nfor _ in range(20):\r\n    print(list(dataset.as_numpy_iterator())[2:4])\r\n```\r\n\r\nFor good training performance (as in accuracy reaches high values fast) a complete shuffling of the dataset is required. This becomes obvious if one considers (accidentally or purposely) order sets of training data (in the MNIST example: First all zeros, then all ones, etc). There will be many batches mostly or completely consisting of only 1 label value. This does not work well with SGD approaches.\r\n\r\nSome statistics on MNIST (validation after 10 epochs by shuffle buffer size):\r\n```\r\n  100: Eval loss: 0.29262512158124876, accuracy: 0.9161659\r\n 1000: Eval loss: 0.2921471730925334,  accuracy: 0.9165665\r\n10000: Eval loss: 0.2914975070131895,  accuracy: 0.9171675\r\n60000: Eval loss: 0.29154436285488117, accuracy: 0.91696715\r\n```\r\nAs you can see the accuracy increases with the buffer size with everything else constant.\r\n\r\n**Describe the expected behavior**\r\n\r\nThe whole dataset should be shuffled. This requires the concept of random access datasets. I believe the TFRecord format supports random access(?) So the shuffle operation can take random data from the whole dataset.\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport tensorflow_datasets as tfds\r\nimport tensorflow as tf\r\ntfds.disable_progress_bar()\r\n\r\n\r\ndef make_datasets_unbatched():\r\n    # Scaling MNIST data from (0, 255] to (0., 1.]\r\n    def scale(image, label):\r\n        image = tf.cast(image, tf.float32)\r\n        image /= 255\r\n        return image, label\r\n\r\n    datasets, info = tfds.load(name='mnist',\r\n                               with_info=True,\r\n                               as_supervised=True)\r\n\r\n    return {key: ds.map(scale).cache()\r\n            for key, ds in datasets.items()}, info.splits\r\n\r\n\r\ndef build_and_compile_cnn_model():\r\n    model = tf.keras.Sequential([\r\n        tf.keras.layers.Conv2D(32,\r\n                               3,\r\n                               activation='relu',\r\n                               input_shape=(28, 28, 1)),\r\n        tf.keras.layers.MaxPooling2D(),\r\n        tf.keras.layers.Flatten(),\r\n        tf.keras.layers.Dense(64, activation='relu'),\r\n        tf.keras.layers.Dense(10, activation='softmax')\r\n    ])\r\n    model.compile(loss=tf.keras.losses.sparse_categorical_crossentropy,\r\n                  optimizer=tf.keras.optimizers.SGD(learning_rate=0.001),\r\n                  metrics=['accuracy'])\r\n    return model\r\n\r\n\r\ndatasets, infos = make_datasets_unbatched()\r\nmodel = build_and_compile_cnn_model()\r\n# Init\r\nmodel.train_on_batch(datasets['train'].batch(64))\r\nWEIGHTS_PATH = './init-weights'\r\nmodel.save_weights(WEIGHTS_PATH)\r\n\r\nfor buffer_size in (100, 1000, 5000, 10000, 60000):\r\n    print(\"Buffer size: %s\" % buffer_size)\r\n    model.load_weights(WEIGHTS_PATH)\r\n\r\n    model.fit(x=datasets['train'].shuffle(buffer_size).batch(64).repeat(),\r\n              epochs=10,\r\n              steps_per_epoch=infos['train'].num_examples // 64)\r\n    eval_loss, eval_acc = model.evaluate(datasets['test'].batch(64),\r\n                                         steps=infos['test'].num_examples //\r\n                                         64)\r\n    print(\"Eval loss: %s, accuracy: %s\" % (eval_loss, eval_acc))\r\n```\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36621", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36621/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36621/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36621/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36621", "id": 562522107, "node_id": "MDU6SXNzdWU1NjI1MjIxMDc=", "number": 36621, "title": "Expected int for argument 'ksizes' not tf.Tensor", "user": {"login": "mindis", "id": 3082556, "node_id": "MDQ6VXNlcjMwODI1NTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/3082556?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mindis", "html_url": "https://github.com/mindis", "followers_url": "https://api.github.com/users/mindis/followers", "following_url": "https://api.github.com/users/mindis/following{/other_user}", "gists_url": "https://api.github.com/users/mindis/gists{/gist_id}", "starred_url": "https://api.github.com/users/mindis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mindis/subscriptions", "organizations_url": "https://api.github.com/users/mindis/orgs", "repos_url": "https://api.github.com/users/mindis/repos", "events_url": "https://api.github.com/users/mindis/events{/privacy}", "received_events_url": "https://api.github.com/users/mindis/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-02-10T12:14:48Z", "updated_at": "2020-02-26T09:42:12Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Centos 7.7\r\n- TensorFlow installed from (source or binary): Binary\r\n- TensorFlow version (use command below): 2.1\r\n- Python version: 3.6\r\n\r\n\r\n**Describe the current behavior**\r\ntf.image.extract_patches only accepts static integers as ksize arguments in data.Dataset API pipeline.\r\n\r\n**Describe the expected behavior**\r\nAccept variable data dimension as size argument\r\n\r\n**Code to reproduce the issue**\r\nI'm trying to create sliding window feature across all rows in tensor simultaneously. Each tensor can have different number of rows.\r\n```\r\nimage=tf.constant([[[[1], [2], [3], [4], [5], [6], [7], [8], [9], [10]],\r\n  [[11], [12], [13], [14], [15], [16], [17], [18], [19], [20]],\r\n  [[21], [22], [23], [24], [25], [26], [27], [28], [29], [30]],\r\n  [[31], [32], [33], [34], [35], [36], [37], [38], [39], [40]],\r\n  [[41], [42], [43], [44], [45], [46], [47], [48], [49], [50]],\r\n  [[51], [52], [53], [54], [55], [56], [57], [58], [59], [60]],\r\n  [[61], [62], [63], [64], [65], [66], [67], [68], [69], [70]],\r\n  [[71], [72], [73], [74], [75], [76], [77], [78], [79], [80]],\r\n  [[81], [82], [83], [84], [85], [86], [87], [88], [89], [90]],\r\n  [[91], [92], [93], [94], [95], [96], [97], [98], [99], [100]]]])\r\n\r\nds=tf.data.Dataset.from_tensor_slices(image)\r\n\r\ndef create_patches(image):\r\n    return tf.image.extract_patches(image[None,...],\r\n                           [1, tf.shape(image)[1], 3, 1],\r\n                           [1, 1, 1, 1],\r\n                           [1, 1, 1, 1],\r\n                           padding='VALID')\r\nds=ds.map(create_patches)\r\n\r\nfor i in ds:\r\n    print(i)\r\n```\r\n\r\n**Other info / logs**\r\n`TypeError: Expected int for argument 'ksizes' not <tf.Tensor 'strided_slice_1:0' shape=() dtype=int32>.`\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36619", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36619/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36619/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36619/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36619", "id": 562469706, "node_id": "MDU6SXNzdWU1NjI0Njk3MDY=", "number": 36619, "title": "unable to save the tensorflow hub model of universal lite with tensorflow 1.15", "user": {"login": "zayedrais", "id": 16205110, "node_id": "MDQ6VXNlcjE2MjA1MTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/16205110?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zayedrais", "html_url": "https://github.com/zayedrais", "followers_url": "https://api.github.com/users/zayedrais/followers", "following_url": "https://api.github.com/users/zayedrais/following{/other_user}", "gists_url": "https://api.github.com/users/zayedrais/gists{/gist_id}", "starred_url": "https://api.github.com/users/zayedrais/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zayedrais/subscriptions", "organizations_url": "https://api.github.com/users/zayedrais/orgs", "repos_url": "https://api.github.com/users/zayedrais/repos", "events_url": "https://api.github.com/users/zayedrais/events{/privacy}", "received_events_url": "https://api.github.com/users/zayedrais/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-02-10T10:36:22Z", "updated_at": "2020-02-11T11:17:39Z", "closed_at": null, "author_association": "NONE", "body": "I'm unable to save the model, after trained my data by using hub model of universal lite 2( https://tfhub.dev/google/universal-sentence-encoder-lite/2).\r\n\r\ntensorflow== 1.15 tensorflow_hub=0.7.0 python =3.7.6 OS = Window 10 64 bit\r\n\r\n** model local**\r\n\r\npath =\"C:/Users/771556/Downloads/ModelLiteUSE\" #url =\"https://tfhub.dev/google/universal-sentence-encoder-lite/2\" liteModule = hub.Module(path)\r\n\r\ninput_placeholder = tf.sparse_placeholder(tf.int64, shape=[None, None]) encodings = liteModule( inputs=dict( values=input_placeholder.values, indices=input_placeholder.indices, dense_shape=input_placeholder.dense_shape))\r\n\r\nwith tf.Session() as sess: spm_path = sess.run(liteModule(signature=\"spm_path\"))\r\n\r\nsp = spm.SentencePieceProcessor() sp.Load(spm_path) print(\"SentencePiece model loaded at {}.\".format(spm_path))\r\n\r\ndef process_to_IDs_in_sparse_format(sp, sentences): ids = [sp.EncodeAsIds(x) for x in sentences] max_len = max(len(x) for x in ids) dense_shape=(len(ids), max_len) values=[item for sublist in ids for item in sublist] indices=[[row,col] for row in range(len(ids)) for col in range(len(ids[row]))] return (values, indices, dense_shape)\r\n\r\ndef embed(input): values, indices, dense_shape = process_to_IDs_in_sparse_format(sp, input) # Reduce logging output. logging.set_verbosity(logging.ERROR) with tf.Session() as session: session.run([tf.global_variables_initializer(), tf.tables_initializer()]) message_embeddings = session.run( encodings, feed_dict={input_placeholder.values: values, input_placeholder.indices: indices, input_placeholder.dense_shape: dense_shape}) return message_embeddings **Training the data**\r\n\r\nTrainModel= embed(file_data.text)\r\n\r\n**Saving model**\r\n\r\ntf.saved_model.save(TrainModel,'D:/liteTrainmodel')\r\n\r\n**Error**\r\n![Capture](https://user-images.githubusercontent.com/16205110/74142686-67f49200-4c1f-11ea-8b2f-07720ffc0f28.JPG)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36616", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36616/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36616/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36616/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36616", "id": 562404227, "node_id": "MDU6SXNzdWU1NjI0MDQyMjc=", "number": 36616, "title": "tf.signal.inverse_stft does not reconstructs the original signal", "user": {"login": "grzjab", "id": 3876664, "node_id": "MDQ6VXNlcjM4NzY2NjQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/3876664?v=4", "gravatar_id": "", "url": "https://api.github.com/users/grzjab", "html_url": "https://github.com/grzjab", "followers_url": "https://api.github.com/users/grzjab/followers", "following_url": "https://api.github.com/users/grzjab/following{/other_user}", "gists_url": "https://api.github.com/users/grzjab/gists{/gist_id}", "starred_url": "https://api.github.com/users/grzjab/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/grzjab/subscriptions", "organizations_url": "https://api.github.com/users/grzjab/orgs", "repos_url": "https://api.github.com/users/grzjab/repos", "events_url": "https://api.github.com/users/grzjab/events{/privacy}", "received_events_url": "https://api.github.com/users/grzjab/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-02-10T08:36:22Z", "updated_at": "2020-02-25T11:55:21Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- I have used an example from tf doc\r\n- Ubuntu 18.04.4\r\n- TensorFlow 2.1.0 installed via pip\r\n- Python version: 3.7.3\r\n\r\nFollowing the official example from inverse_stft code to reconstruct signal I got either totally different signal or when frame_step>=frame_length I got nan's every frame_step elements starting at position 0. For clarity, the lengths from the official example were divided by 10.\r\n```\r\nimport tensorflow as tf\r\nframe_length = 40\r\nframe_step = 16\r\nwaveform = tf.random.normal(dtype=tf.float32, shape=[100])\r\nstft = tf.signal.stft(waveform, frame_length, frame_step)\r\ninverse_stft = tf.signal.inverse_stft(\r\n    stft, frame_length, frame_step,\r\n    window_fn=tf.signal.inverse_stft_window_fn(frame_step))\r\nprint(inverse_stft)\r\nprint(waveform)\r\ntf.Tensor(\r\n[ 0.00000000e+00  3.99959536e-05 -2.40500085e-04 -1.59982394e-03\r\n  5.19763958e-03 -4.16988507e-03  2.64100209e-02 -9.08877850e-02\r\n  3.40112969e-02  3.86196673e-01  5.13033606e-02 -2.86520272e-01\r\n  6.11472845e-01  4.98466581e-01  1.13349378e+00  1.09166965e-01\r\n -9.97731745e-01 -5.43629766e-01 -2.73563933e+00  7.85581648e-01\r\n -8.19584429e-01  1.79670918e+00  9.02783334e-01 -1.48530865e+00\r\n -2.47491312e+00 -1.24023890e+00  1.15495408e+00  1.42492950e+00\r\n -7.37325311e-01 -1.20595813e+00 -3.62768292e-01  1.35240197e+00\r\n -3.68225783e-01 -7.91088283e-01  1.89298892e+00  5.07700205e-01\r\n  6.15092158e-01 -1.92212605e+00 -8.31669629e-01  7.79488802e-01\r\n -3.24547052e-01 -5.50925493e-01 -7.81439543e-01  8.75341117e-01\r\n -6.82320118e-01  7.01450050e-01 -4.50847566e-01  6.66174769e-01\r\n -1.23529518e+00 -1.24680352e+00  3.43645632e-01  1.09950686e+00\r\n  5.97586334e-01 -3.48894447e-01  6.68327957e-02 -1.43280745e+00\r\n -6.64948940e-01 -7.94504046e-01  1.14265656e+00 -9.80610073e-01\r\n -4.60786790e-01 -3.97007465e-01 -9.27713037e-01  1.07594097e+00\r\n  5.27661502e-01 -1.61613131e+00 -2.59635901e+00 -3.46627653e-01\r\n  3.27228665e-01 -1.07391989e+00  9.76892650e-01 -2.26863116e-01\r\n -1.79977849e-01 -7.51911581e-01 -1.52214825e-01 -2.73942560e-01\r\n -5.64359844e-01  5.01259208e-01  4.91654649e-02 -1.36436284e-01\r\n  1.09956011e-01  7.98072666e-02 -1.27519906e-01  1.10613126e-02\r\n -3.04599851e-03  1.31062159e-04 -4.15140385e-05  3.23910135e-05], shape=(88,), dtype=float32)\r\ntf.Tensor(\r\n[ 1.4038084   1.0222757  -0.39947665 -0.54522014  0.5803976  -0.19679223\r\n  0.61842763 -1.1810968   0.26712915  1.9677812   0.18064204 -0.73945624\r\n  1.2229462   0.81378937  1.5831046   0.13582362 -1.1432989  -0.58895135\r\n -2.8576777   0.8025885  -0.8269907   1.8019977   0.9033268  -1.4853681\r\n -2.4749134  -1.2402394   1.1549553   1.4249299  -0.73732626 -1.205959\r\n -0.36276835  1.3524033  -0.36822623 -0.7910883   1.8929895   0.50770015\r\n  0.615092   -1.922127   -0.8316696   0.77948934 -0.32454705 -0.5509257\r\n -0.7814399   0.87534165 -0.6823204   0.7014507  -0.45084816  0.6661754\r\n -1.2352954  -1.2468035   0.34364572  1.0995075   0.59758615 -0.34889427\r\n  0.06683233 -1.4328083  -0.6649485  -0.7945043   1.1426575  -0.98061115\r\n -0.46078658 -0.39700815 -0.9277131   1.0759422   0.527661   -1.616195\r\n -2.5979242  -0.34764734  0.33018574 -1.0971678   1.0204725  -0.24577658\r\n -0.2062361  -0.9355164  -0.21259227 -0.44723493 -1.1287199   1.293658\r\n  0.1731153  -0.6951827   0.8636062   1.0371045  -2.9860606   0.5220258\r\n -0.34013367  0.04466997 -0.06895867  0.82789123  0.43297967  0.7684806\r\n -0.6908023   0.57721597  0.9199321   1.3768114   1.2351048  -0.9184835\r\n  0.5188774   0.88726586  1.4416382  -0.40344936], shape=(100,), dtype=float32)\r\n```\r\n\r\n```\r\nimport tensorflow as tf\r\nframe_length = 40\r\nframe_step = 40\r\nwaveform = tf.random.normal(dtype=tf.float32, shape=[100])\r\nstft = tf.signal.stft(waveform, frame_length, frame_step)\r\ninverse_stft = tf.signal.inverse_stft(\r\n    stft, frame_length, frame_step,\r\n    window_fn=tf.signal.inverse_stft_window_fn(frame_step))\r\nprint(inverse_stft)\r\nprint(waveform)\r\ntf.Tensor(\r\n[        nan -0.5289995  -0.42322898  1.7522525   0.34771994 -0.7660091\r\n  1.6534201  -0.23190129 -0.64468837 -1.1712008  -2.6483274   1.3840579\r\n -1.0050658   0.87601507 -0.5170545   0.6623281  -1.0479059  -0.5475797\r\n -1.2517245  -1.1959579   0.58061975 -0.1989309   0.18141915 -1.7858055\r\n -0.7680144  -0.21199739  0.2686664   0.06079084 -0.68268234  0.9945366\r\n  2.2236376  -0.56432855  1.281768    0.8328386  -0.6435259   0.85617316\r\n -0.09510866  0.7118371   2.0645704   0.63955176         nan  0.15469487\r\n  1.0494236   0.3661145  -1.4089363  -1.3391382   1.0011977  -0.07683202\r\n -1.4500219  -0.0392501   1.1920362   1.8719866   0.7821921  -0.45498323\r\n -1.890665    0.67334163 -2.023159   -0.29750296 -0.2908026   0.38893116\r\n -0.10589531  0.7326803   1.2091097  -0.34784627  1.311726    0.79103297\r\n -0.91987884  0.51282054 -0.20457014  0.50253487 -0.46842676  2.5228522\r\n -0.07464705  1.7176666  -0.40536413 -0.06539667  1.0447518  -0.42340115\r\n  0.1290549   0.53456116], shape=(80,), dtype=float32)\r\ntf.Tensor(\r\n[-2.005882   -0.5290042  -0.42322478  1.7522544   0.34772    -0.76600945\r\n  1.6534219  -0.23190151 -0.64468867 -1.1712015  -2.6483283   1.3840592\r\n -1.0050665   0.8760156  -0.5170555   0.66232944 -1.0479063  -0.54757965\r\n -1.2517256  -1.1959581   0.5806202  -0.19893074  0.1814189  -1.7858069\r\n -0.76801383 -0.21199743  0.2686672   0.06079032 -0.6826823   0.9945371\r\n  2.2236395  -0.56433004  1.2817682   0.8328381  -0.64352524  0.8561739\r\n -0.09510913  0.7118365   2.064576    0.6395979   0.7826336   0.15469465\r\n  1.0494274   0.36611095 -1.4089363  -1.339139    1.0011992  -0.07683332\r\n -1.4500217  -0.03925065  1.1920377   1.8719873   0.78219193 -0.4549838\r\n -1.8906664   0.67334247 -2.0231593  -0.2975028  -0.2908029   0.3889313\r\n -0.1058953   0.7326806   1.2091101  -0.34784687  1.3117266   0.79103285\r\n -0.91987914  0.5128205  -0.20457047  0.5025352  -0.46842635  2.5228539\r\n -0.07464796  1.7176673  -0.40536594 -0.06539585  1.0447516  -0.42340097\r\n  0.12904675  0.5345574  -0.12362233 -1.9486434   0.53776556 -0.32944998\r\n  0.48096088 -1.0506314  -1.2964804  -0.34489468 -0.38139907  0.49959585\r\n -0.25842932 -0.8132113   1.0629432  -0.5591399   0.11014029 -0.4576707\r\n -0.15766484 -0.07155921  0.2819425   0.40777263], shape=(100,), dtype=float32)\r\n```\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36615", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36615/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36615/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36615/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36615", "id": 562402101, "node_id": "MDU6SXNzdWU1NjI0MDIxMDE=", "number": 36615, "title": "tf.saved_model.save can not save a model containing DenseHashTable", "user": {"login": "doldre", "id": 2703603, "node_id": "MDQ6VXNlcjI3MDM2MDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/2703603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/doldre", "html_url": "https://github.com/doldre", "followers_url": "https://api.github.com/users/doldre/followers", "following_url": "https://api.github.com/users/doldre/following{/other_user}", "gists_url": "https://api.github.com/users/doldre/gists{/gist_id}", "starred_url": "https://api.github.com/users/doldre/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/doldre/subscriptions", "organizations_url": "https://api.github.com/users/doldre/orgs", "repos_url": "https://api.github.com/users/doldre/repos", "events_url": "https://api.github.com/users/doldre/events{/privacy}", "received_events_url": "https://api.github.com/users/doldre/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-02-10T08:31:48Z", "updated_at": "2020-02-10T18:34:47Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): colab\r\n- TensorFlow installed from (source or binary): source \r\n- TensorFlow version (use command below):  tf-nightly(2.2.0.dev20200208)\r\n\r\n**Describe the current behavior**\r\nA keras model which contains DenseHashTable cannot be saved by tf.saved_model.save function.\r\nGot a \"RuntimeError: Attempting to capture an EagerTensor without building a function.\"\r\n\r\n**Describe the expected behavior**\r\nSave the model correctly.\r\n\r\n**Code to reproduce the issue**\r\nHere is the simplest situation.\r\n```python\r\nimport tensorflow as tf\r\n\r\nclass Model(tf.keras.Model):\r\n\r\n  def __init__(self):\r\n    super(Model, self).__init__()\r\n    self.table = tf.lookup.experimental.DenseHashTable(\r\n        key_dtype=tf.int64,\r\n        value_dtype=tf.int64,\r\n        default_value=-1,\r\n        empty_key=0,\r\n        deleted_key=-1)\r\n\r\n  @tf.function(input_signature=[tf.TensorSpec(shape=[None], dtype=tf.int64)])\r\n  def call(self, input):\r\n    return self.table.lookup(input)\r\n\r\nm = Model()\r\ntf.saved_model.save(m, '/tmp/test')\r\n```\r\n\r\n[Here](https://colab.research.google.com/drive/1ENfP-3vp1c7hoRQU-0egTngatcMMYsMp) is the code gist.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36612", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36612/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36612/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36612/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36612", "id": 562327996, "node_id": "MDU6SXNzdWU1NjIzMjc5OTY=", "number": 36612, "title": "ReduceLROnPlateau callback crashed when learning rate is of type tf.keras.optimizers.schedules", "user": {"login": "dd1923", "id": 22530039, "node_id": "MDQ6VXNlcjIyNTMwMDM5", "avatar_url": "https://avatars0.githubusercontent.com/u/22530039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dd1923", "html_url": "https://github.com/dd1923", "followers_url": "https://api.github.com/users/dd1923/followers", "following_url": "https://api.github.com/users/dd1923/following{/other_user}", "gists_url": "https://api.github.com/users/dd1923/gists{/gist_id}", "starred_url": "https://api.github.com/users/dd1923/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dd1923/subscriptions", "organizations_url": "https://api.github.com/users/dd1923/orgs", "repos_url": "https://api.github.com/users/dd1923/repos", "events_url": "https://api.github.com/users/dd1923/events{/privacy}", "received_events_url": "https://api.github.com/users/dd1923/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-02-10T05:09:31Z", "updated_at": "2020-02-11T20:18:18Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04\r\n- TensorFlow installed from (source or binary): pip3\r\n- TensorFlow version (use command below): 2.0.0\r\n- Python version: 3.6\r\n\r\n**Describe the current behavior**\r\n\r\nWhen using tf.keras.callbacks.ReduceLROnPlateau in callbacks in model.fit(), it fails with an error if model.optimizer.lr is of type  tf.keras.optimizers.schedules. *. \r\n\r\nFor example, one can use tf.keras.optimizers.schedules.ExponentialDecay in an optimizer. This would cause the following line to fail:\r\n\r\n[https://github.com/tensorflow/tensorflow/blob/6dd3403a89f2f0f9a6219ba926091e203693ff9f/tensorflow/python/keras/callbacks.py#L2021](https://github.com/tensorflow/tensorflow/blob/6dd3403a89f2f0f9a6219ba926091e203693ff9f/tensorflow/python/keras/callbacks.py#L2021)\r\n\r\nAbove line assumes lr to be a float.\r\n\r\nThe error it gives in this case is :\r\n\r\nTypeError: float() argument must be a string or a number, not 'ExponentialDecay' \r\n\r\n\r\n**Describe the expected behavior**\r\n\r\nReduceLROnPlateau should also work with learning rate whose type is of tf.keras.optimizers.schedules\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36611", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36611/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36611/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36611/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36611", "id": 562323436, "node_id": "MDU6SXNzdWU1NjIzMjM0MzY=", "number": 36611, "title": "Buid failed in redhat system..", "user": {"login": "daixiangzi", "id": 24811131, "node_id": "MDQ6VXNlcjI0ODExMTMx", "avatar_url": "https://avatars2.githubusercontent.com/u/24811131?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daixiangzi", "html_url": "https://github.com/daixiangzi", "followers_url": "https://api.github.com/users/daixiangzi/followers", "following_url": "https://api.github.com/users/daixiangzi/following{/other_user}", "gists_url": "https://api.github.com/users/daixiangzi/gists{/gist_id}", "starred_url": "https://api.github.com/users/daixiangzi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daixiangzi/subscriptions", "organizations_url": "https://api.github.com/users/daixiangzi/orgs", "repos_url": "https://api.github.com/users/daixiangzi/repos", "events_url": "https://api.github.com/users/daixiangzi/events{/privacy}", "received_events_url": "https://api.github.com/users/daixiangzi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2020-02-10T04:53:17Z", "updated_at": "2020-02-13T10:10:52Z", "closed_at": null, "author_association": "NONE", "body": "ERROR: /root/.cache/bazel/_bazel_daixiangzi/7c0ccbbd924a8f891a09b57c04646026/external/boringssl/BUILD:130:1: C++ compilation of rule '@boringssl//:crypto' failed (Exit 1)\r\ngcc: error trying to exec 'cc1': execvp: No such file or directory\r\nTarget //tensorflow/tools/graph_transforms:transform_graph failed to build\r\nINFO: Elapsed time: 29.467s, Critical Path: 4.82s\r\nINFO: 9 processes: 9 local.\r\nFAILED: Build did NOT complete successfully\r\nGcc and g++ version is 4.8.5\r\nNO CUDA"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36610", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36610/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36610/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36610/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36610", "id": 562315121, "node_id": "MDU6SXNzdWU1NjIzMTUxMjE=", "number": 36610, "title": "Successfully convert model through full-integer, but leave nodes with int8 instead of uint8", "user": {"login": "DLMasterCat", "id": 60849247, "node_id": "MDQ6VXNlcjYwODQ5MjQ3", "avatar_url": "https://avatars0.githubusercontent.com/u/60849247?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DLMasterCat", "html_url": "https://github.com/DLMasterCat", "followers_url": "https://api.github.com/users/DLMasterCat/followers", "following_url": "https://api.github.com/users/DLMasterCat/following{/other_user}", "gists_url": "https://api.github.com/users/DLMasterCat/gists{/gist_id}", "starred_url": "https://api.github.com/users/DLMasterCat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DLMasterCat/subscriptions", "organizations_url": "https://api.github.com/users/DLMasterCat/orgs", "repos_url": "https://api.github.com/users/DLMasterCat/repos", "events_url": "https://api.github.com/users/DLMasterCat/events{/privacy}", "received_events_url": "https://api.github.com/users/DLMasterCat/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-02-10T04:20:15Z", "updated_at": "2020-02-22T00:58:20Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-55-generic x86_64)\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: would run on Raspberry Pi4 +edge TPU or Dev-board\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version (use command below): v1.15.0-0-g590d6eef7e 1.15.0\r\n- Python version: 3.7.4\r\n- Bazel version (if compiling from source): 0.24.1\r\n- GCC/Compiler version (if compiling from source): GCC 7.3.0\r\n- CUDA/cuDNN version: Cuda compilation tools, release 10.1, V10.1.243\r\n- GPU model and memory: 2080Ti\r\n**(but TensorFlow was not compiled with CUDA support)**\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nI convert my model from pytorch->onnx->tensorflow->tensorflow lite. And I would run on Edge TPU, thus my tensorflow version should be 1.15.0 as suggestion. However, due to lack of \"split\", and incorrect of \"min and max\". I rebuild from source based on the two links below.\r\n\r\n[https://github.com/tensorflow/tensorflow/commit/3c2be61e68acea533030b8f70fa0db3339b19f93](url)\r\n[https://github.com/tensorflow/tensorflow/pull/32582/files?file-filters%5B%5D=.cc&file-filters%5B%5D=.h&file-filters%5B%5D=No+extension#diff-71a783b5a7624430897d44e42f816444](url)\r\n\r\nI use full-integer quantization, and all the conversion is successful. The tflite file works fine on interpreter. Input and Output datatype are tf.uint8 correctly. But almost every node in the model except input and output is tf.int8 (quantization).\r\n\r\n**Describe the expected behavior**\r\nI think these nodes should be tf.uint8. And I wonder that whether I could just load the tflite file via \"JSON\" format and change the model[\"subgraphs\"][0][\"tensors\"][\"type\"] \"INT8\" to \"UINT8\".\r\n\r\nThis idea based on the link below.\r\n[https://towardsdatascience.com/hacking-google-coral-edge-tpu-motion-blur-and-lanczos-resize-9b60ebfaa552](url)\r\nActually, it failed. I want to know the reasons.\r\n\r\n**Code to reproduce the issue**\r\n```\r\n\r\nimport tensorflow as tf\r\nimport torch\r\nfrom PIL import Image\r\nimport numpy as np\r\nimport pathlib\r\n\r\n#tf.compat.v1.enable_eager_execution()\r\n#tf.logging.set_verbosity(tf.logging.DEBUG)\r\n\r\n#import matplotlib.pyplot as plt\r\nprint(tf.__version__)\r\nprint(torch.__version__)\r\n\r\n\r\nval = \"./ILSVRC2012_img_val/\"\r\nval=pathlib.Path(val)\r\nitem=np.array([i.name for i in val.glob(\"*\")])\r\n\r\nimage_generator = tf.keras.preprocessing.image.ImageDataGenerator(rescale=1./255,data_format=\"channels_first\")\r\n\r\ntrain_data_gen = image_generator.flow_from_directory(directory=str(val),\r\n                                                     batch_size=100,\r\n                                                     shuffle=True,\r\n                                                     target_size=(320,320),\r\n                                                     classes = list(item))\r\n\r\nimage_batch, label_batch = next(train_data_gen)\r\nimage_batch=np.expand_dims(image_batch,1)\r\n\r\nprint(((image_batch).dtype))\r\n\r\nimage_batch, label_batch = next(train_data_gen)\r\nmean=([0.485, 0.456, 0.406])\r\nstd=([0.229, 0.224, 0.225])\r\nfor i in range(3):\r\n    image_batch[:,i,:,:]=(image_batch[:,i,:,:]-mean[i])/(std[i])\r\nprint(image_batch.shape)\r\nimage_batch=(np.expand_dims(image_batch,1))\r\n\r\n\r\ndef representative_data_gen():\r\n    for i in range(100):\r\n        yield [image_batch[i]]\r\n\r\ngraph_def_file = \"test_320.pb\"\r\ninputs=['input.1']\r\noutputs=['655']\r\nconverter = tf.lite.TFLiteConverter.from_frozen_graph(graph_def_file,inputs, outputs)\r\nconverter.optimizations = [tf.lite.Optimize.DEFAULT]\r\n#converter.inference_type=tf.uint8\r\nconverter.representative_dataset = representative_data_gen\r\nconverter.target_spec.supported_ops = [tf.lite.OpsSet.TFLITE_BUILTINS_INT8]\r\nconverter.inference_input_type = tf.uint8\r\nconverter.inference_output_type = tf.uint8\r\n#converter.experimental_new_quantizer= True\r\n#converter.experimental_enable_mlir_converter = True\r\ntflite_model_op= converter.convert()\r\nopen(\"cvted_model_320_quant_op.tflite\", \"wb\").write(tflite_model_op)\r\n\r\n\r\n```\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\nI tried compile with Edge TPU Compiler, and find out \"unsupported data type\". Then I use netron find that most of them are tf.int8.\r\n\r\nHere is the Edge TPU compiler log, result of Netron and my model. \r\n\r\n```\r\nEdge TPU Compiler version 2.0.291256449\r\n\r\nModel compiled successfully in 45 ms.\r\n\r\nInput model: /home/xxxxx01/39dstest/cvted_model_320_quant_op.tflite\r\nInput size: 6.28MiB\r\nOutput model: cvted_model_320_quant_op_edgetpu.tflite\r\nOutput size: 6.03MiB\r\nOn-chip memory available for caching model parameters: 0.00B\r\nOn-chip memory used for caching model parameters: 0.00B\r\nOff-chip memory used for streaming uncached model parameters: 0.00B\r\nNumber of Edge TPU subgraphs: 0\r\nTotal number of operations: 7950\r\nOperation log: cvted_model_320_quant_op_edgetpu.log\r\n\r\nModel successfully compiled but not all operations are supported by the Edge TPU. A percentage of the model will instead run on the CPU, which is slower. If possible, consider updating your model to use only operations supported by the Edge TPU. For details, visit g.co/coral/model-reqs.\r\nNumber of operations that will run on Edge TPU: 0\r\nNumber of operations that will run on CPU: 7950\r\n\r\nOperator                       Count      Status\r\n\r\nSPLIT                          36         Operation is working on an unsupported data type\r\nQUANTIZE                       3729       Operation is otherwise supported, but not mapped due to some unspecified limitation\r\nMUL                            74         Operation is working on an unsupported data type\r\nMAXIMUM                        38         Operation is working on an unsupported data type\r\nMINIMUM                        38         Operation is working on an unsupported data type\r\nADD                            74         Operation is working on an unsupported data type\r\nCONCATENATION                  56         Operation is working on an unsupported data type\r\nPAD                            37         Operation is working on an unsupported data type\r\nCONV_2D                        38         Operation is working on an unsupported data type\r\nDEPTHWISE_CONV_2D              3680       Operation is working on an unsupported data type\r\nTRANSPOSE                      148        Operation is working on an unsupported data type\r\nMEAN                           1          Operation is working on an unsupported data type\r\nFULLY_CONNECTED                1          Operation is working on an unsupported data type\r\n\r\n```\r\n**Result of Netron**\r\n![Results of Netron](https://user-images.githubusercontent.com/60849247/74120385-1be52580-4bfe-11ea-8909-7d636b97be14.PNG)\r\n\r\n**My model**\r\n[test_320.zip](https://github.com/tensorflow/tensorflow/files/4178930/test_320.zip)\r\n\r\n\r\nNew to Github, Thx ><"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36605", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36605/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36605/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36605/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36605", "id": 562283500, "node_id": "MDU6SXNzdWU1NjIyODM1MDA=", "number": 36605, "title": "fft2d different results between tensorflow and numpy", "user": {"login": "why702", "id": 21079425, "node_id": "MDQ6VXNlcjIxMDc5NDI1", "avatar_url": "https://avatars1.githubusercontent.com/u/21079425?v=4", "gravatar_id": "", "url": "https://api.github.com/users/why702", "html_url": "https://github.com/why702", "followers_url": "https://api.github.com/users/why702/followers", "following_url": "https://api.github.com/users/why702/following{/other_user}", "gists_url": "https://api.github.com/users/why702/gists{/gist_id}", "starred_url": "https://api.github.com/users/why702/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/why702/subscriptions", "organizations_url": "https://api.github.com/users/why702/orgs", "repos_url": "https://api.github.com/users/why702/repos", "events_url": "https://api.github.com/users/why702/events{/privacy}", "received_events_url": "https://api.github.com/users/why702/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-02-10T01:58:47Z", "updated_at": "2020-02-21T10:51:33Z", "closed_at": null, "author_association": "NONE", "body": "Hi,\r\n\r\nI have one question about the fft2d and fftshift. \r\nThe following code shows the similar process (fft2d > fftshift > * filter(LPF) > ifftshift > ifft2d) with numpy and tensorflow.\r\nHowever the result is mush different. And the result of tensorflow is so weird.\r\nCould anyone help me figure out what's wrong in the code?\r\nThanks a lot.\r\n\r\n`    \r\n    img = cv2.imread(\"xxx.png\")\r\n    img = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY).astype(np.float32)\r\n    width = img.shape[1]\r\n    height = img.shape[0]\r\n\r\n    filter = LPF_Butterworth(width, height, 33, 4)\r\n\r\n    # use numpy fft2 ===========\r\n    f = np.fft.fft2(img)\r\n    f = np.fft.fftshift(f)\r\n    f_l = f * filter\r\n    f_l = np.fft.ifftshift(f_l)\r\n    f_l = np.fft.ifft2(f_l)\r\n    f_np = np.real(f_l)\r\n    #===========================\r\n\r\n    input_placeholder = tf.compat.v1.placeholder(tf.float32,\r\n                                       shape=[height, width, 1],\r\n                                       name='input')\r\n\r\n    # use tensorflow fft2d ===========\r\n    tf_filter = tf.convert_to_tensor(filter, dtype=tf.float32)\r\n    tf_filter_comx = tf.expand_dims(tf.complex(tf_filter, tf.zeros(tf_filter.shape)),2)\r\n    fft_org = tf.fft2d(tf.cast(input_placeholder, tf.complex64))\r\n    fft_org = tf.signal.fftshift(fft_org, axes=[0,1])\r\n    fft_filter = fft_org * tf_filter_comx\r\n    fft_filter = tf.ifft2d(tf.signal.ifftshift(fft_filter, axes=[0,1]))\r\n    fft_filter = tf.real(fft_filter)\r\n    #================================\r\n\r\n    sess = tf.Session(config=tf.ConfigProto(device_count={'GPU': 0}))\r\n    sess.run(tf.global_variables_initializer())\r\n    sess.run(tf.local_variables_initializer())\r\n\r\n    with sess.as_default():\r\n        feed_dict = {input_placeholder: np.expand_dims(img, axis=2)}\r\n        f_tf = sess.run(fft_filter, feed_dict=feed_dict)\r\n\r\n    f_np = cv2.normalize(f_np, None, 0, 255, cv2.NORM_MINMAX).astype(np.uint8)\r\n    f_tf = cv2.normalize(f_tf, None, 0, 255, cv2.NORM_MINMAX).astype(np.uint8)\r\n    cv2.imshow(\"numpy\", f_np)\r\n    cv2.imshow(\"tensorflow\", f_tf)\r\n    cv2.waitKey()\r\n`\r\nresult: https://i.stack.imgur.com/0vLSd.png\r\n\r\n[](https://i.stack.imgur.com/0vLSd.png)\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): win10\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): pip\r\n- TensorFlow version (use command below): 1.15\r\n- Python version: 3.6\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: 10.0\r\n- GPU model and memory: 2080Ti 11G\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36603", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36603/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36603/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36603/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36603", "id": 562267188, "node_id": "MDU6SXNzdWU1NjIyNjcxODg=", "number": 36603, "title": "TensorRT plugins", "user": {"login": "soldierofhell", "id": 45559276, "node_id": "MDQ6VXNlcjQ1NTU5Mjc2", "avatar_url": "https://avatars0.githubusercontent.com/u/45559276?v=4", "gravatar_id": "", "url": "https://api.github.com/users/soldierofhell", "html_url": "https://github.com/soldierofhell", "followers_url": "https://api.github.com/users/soldierofhell/followers", "following_url": "https://api.github.com/users/soldierofhell/following{/other_user}", "gists_url": "https://api.github.com/users/soldierofhell/gists{/gist_id}", "starred_url": "https://api.github.com/users/soldierofhell/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/soldierofhell/subscriptions", "organizations_url": "https://api.github.com/users/soldierofhell/orgs", "repos_url": "https://api.github.com/users/soldierofhell/repos", "events_url": "https://api.github.com/users/soldierofhell/events{/privacy}", "received_events_url": "https://api.github.com/users/soldierofhell/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1754777628, "node_id": "MDU6TGFiZWwxNzU0Nzc3NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu:tensorrt", "name": "comp:gpu:tensorrt", "color": "ea98ba", "default": false, "description": "Issues specific to TensorRT"}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, {"login": "bixia1", "id": 35820639, "node_id": "MDQ6VXNlcjM1ODIwNjM5", "avatar_url": "https://avatars1.githubusercontent.com/u/35820639?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bixia1", "html_url": "https://github.com/bixia1", "followers_url": "https://api.github.com/users/bixia1/followers", "following_url": "https://api.github.com/users/bixia1/following{/other_user}", "gists_url": "https://api.github.com/users/bixia1/gists{/gist_id}", "starred_url": "https://api.github.com/users/bixia1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bixia1/subscriptions", "organizations_url": "https://api.github.com/users/bixia1/orgs", "repos_url": "https://api.github.com/users/bixia1/repos", "events_url": "https://api.github.com/users/bixia1/events{/privacy}", "received_events_url": "https://api.github.com/users/bixia1/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-02-10T00:30:35Z", "updated_at": "2020-03-13T08:26:02Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): 2.1\r\n- Are you willing to contribute it (Yes/No): Maybe\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\nIs it possible to use TensorRT plugin in TrtGraphConverterV2? Should I register the plugin in TF? I noticed there's some code for  plugins here: https://github.com/tensorflow/tensorflow/tree/master/tensorflow/compiler/tf2tensorrt/plugin, but I can't find any example.\r\nIt would be best to be able to use plugins directly from TrtGraphConverterV2\r\n\r\n**Will this change the current api? How?**\r\n\r\nNot necessary\r\n\r\n**Who will benefit with this feature?**\r\n\r\nEveryone who want to speed up with TensorRT. Current set od convertable layers is very limited\r\n\r\n**Any Other info.**\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36600", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36600/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36600/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36600/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36600", "id": 562256881, "node_id": "MDU6SXNzdWU1NjIyNTY4ODE=", "number": 36600, "title": "Tensorflow 2.1 BERt embeddings - Variable is unhashable if Tensor equality is enabled. Instead, use tensor.experimental_ref() as the key", "user": {"login": "TheGlobalist", "id": 19427963, "node_id": "MDQ6VXNlcjE5NDI3OTYz", "avatar_url": "https://avatars1.githubusercontent.com/u/19427963?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TheGlobalist", "html_url": "https://github.com/TheGlobalist", "followers_url": "https://api.github.com/users/TheGlobalist/followers", "following_url": "https://api.github.com/users/TheGlobalist/following{/other_user}", "gists_url": "https://api.github.com/users/TheGlobalist/gists{/gist_id}", "starred_url": "https://api.github.com/users/TheGlobalist/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TheGlobalist/subscriptions", "organizations_url": "https://api.github.com/users/TheGlobalist/orgs", "repos_url": "https://api.github.com/users/TheGlobalist/repos", "events_url": "https://api.github.com/users/TheGlobalist/events{/privacy}", "received_events_url": "https://api.github.com/users/TheGlobalist/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1105108936, "node_id": "MDU6TGFiZWwxMTA1MTA4OTM2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:model", "name": "comp:model", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2020-02-09T23:17:09Z", "updated_at": "2020-02-21T18:47:58Z", "closed_at": null, "author_association": "NONE", "body": "I'm trying to load the [following](https://tfhub.dev/tensorflow/bert_multi_cased_L-12_H-768_A-12/1) BERt presaved model from tensorflow hub. As per the previously mentioned page, this is the code that I'm trying to execute\r\n\r\n```\r\nmax_seq_length = 128  # Your choice here.\r\ninput_word_ids = tf.keras.layers.Input(shape=(max_seq_length,), dtype=tf.int32,\r\n                                       name=\"input_word_ids\")\r\ninput_mask = tf.keras.layers.Input(shape=(max_seq_length,), dtype=tf.int32,\r\n                                   name=\"input_mask\")\r\nsegment_ids = tf.keras.layers.Input(shape=(max_seq_length,), dtype=tf.int32,\r\n                                    name=\"segment_ids\")\r\nbert_layer = hub.KerasLayer(\"https://tfhub.dev/tensorflow/bert_multi_cased_L-12_H-768_A-12/1\",\r\n                            trainable=True)\r\npooled_output, sequence_output = bert_layer([input_word_ids, input_mask, segment_ids])\r\n```\r\nHowever, as soon as I get to execute the hub.KerasLayer, I'm getting the following exception.\r\n\r\n\r\n```\r\nIn [10]: bert_layer = hub.KerasLayer(\"https://tfhub.dev/tensorflow/bert_multi_cased_L-12_H-768_A-12/1\", \r\n    ...:                             trainable=True)                                                                                                                                                        \r\n\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-10-f1fd8e265590> in <module>\r\n      1 bert_layer = hub.KerasLayer(\"https://tfhub.dev/tensorflow/bert_multi_cased_L-12_H-768_A-12/1\",\r\n----> 2                             trainable=True)\r\n\r\n~/anaconda3/lib/python3.7/site-packages/tensorflow_hub/keras_layer.py in __init__(self, handle, trainable, arguments, **kwargs)\r\n    111       for v in self._func.trainable_variables:\r\n    112         self._add_existing_weight(v, trainable=True)\r\n--> 113       trainable_variables = set(self._func.trainable_variables)\r\n    114     else:\r\n    115       trainable_variables = set()\r\n\r\n~/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/ops/variables.py in __hash__(self)\r\n   1087   def __hash__(self):\r\n   1088     if ops.Tensor._USE_EQUALITY and ops.executing_eagerly_outside_functions():  # pylint: disable=protected-access\r\n-> 1089       raise TypeError(\"Variable is unhashable if Tensor equality is enabled. \"\r\n   1090                       \"Instead, use tensor.experimental_ref() as the key.\")\r\n   1091     else:\r\n\r\nTypeError: Variable is unhashable if Tensor equality is enabled. Instead, use tensor.experimental_ref() as the key.\r\n```\r\n\r\nWhat am I missing? I'm running all of the above on macOS 10.15 and TF 2.1\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36596", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36596/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36596/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36596/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36596", "id": 562208289, "node_id": "MDU6SXNzdWU1NjIyMDgyODk=", "number": 36596, "title": "tf.keras GradientTape: get gradient with respect to input", "user": {"login": "dmus", "id": 464378, "node_id": "MDQ6VXNlcjQ2NDM3OA==", "avatar_url": "https://avatars1.githubusercontent.com/u/464378?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dmus", "html_url": "https://github.com/dmus", "followers_url": "https://api.github.com/users/dmus/followers", "following_url": "https://api.github.com/users/dmus/following{/other_user}", "gists_url": "https://api.github.com/users/dmus/gists{/gist_id}", "starred_url": "https://api.github.com/users/dmus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dmus/subscriptions", "organizations_url": "https://api.github.com/users/dmus/orgs", "repos_url": "https://api.github.com/users/dmus/repos", "events_url": "https://api.github.com/users/dmus/events{/privacy}", "received_events_url": "https://api.github.com/users/dmus/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-02-09T17:11:57Z", "updated_at": "2020-03-17T00:25:57Z", "closed_at": null, "author_association": "NONE", "body": "Tensorflow 2.1\r\n\r\nI want to get the gradients with respect to the input instead of the gradient with respect to the trainable weights. I adjust the example from https://www.tensorflow.org/guide/keras/train_and_evaluate to\r\n\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\nphysical_devices = tf.config.experimental.list_physical_devices('GPU')\r\nassert len(physical_devices) > 0, 'Not enough GPU hardware devices available'\r\ntf.config.experimental.set_memory_growth(physical_devices[0], True)\r\n\r\ndef loss_fun(y_true, y_pred):\r\n    loss = tf.reduce_mean(tf.square(y_true - y_pred), axis=-1)\r\n    return loss\r\n\r\n# Create a dataset\r\nx = np.random.rand(10, 180, 320, 3).astype(np.float32)\r\ny = np.random.rand(10, 1).astype(np.float32)\r\ndataset = tf.data.Dataset.from_tensor_slices((x, y)).batch(1)\r\n\r\n# Create a model\r\nbase_model = tf.keras.applications.MobileNet(input_shape=(180, 320, 3), weights=None, include_top=False)\r\nx = tf.keras.layers.GlobalAveragePooling2D()(base_model.output)\r\noutput = tf.keras.layers.Dense(1)(x)\r\nmodel = tf.keras.models.Model(inputs=base_model.input, outputs=output)\r\n\r\nfor input, target in dataset:\r\n\r\n    for iteration in range(400):\r\n        with tf.GradientTape() as tape:\r\n            # Run the forward pass of the layer.\r\n            # The operations that the layer applies\r\n            # to its inputs are going to be recorded\r\n            # on the GradientTape.\r\n            prediction = model(input, training=False)  # Logits for this minibatch\r\n\r\n            # Compute the loss value for this minibatch.\r\n            loss_value = loss_fun(target, prediction)\r\n\r\n        # Use the gradient tape to automatically retrieve\r\n        # the gradients of the trainable variables with respect to the loss.\r\n        grads = tape.gradient(loss_value, model.inputs)\r\n        print(grads)  # output: [None]\r\n        # Run one step of gradient descent by updating\r\n        # the value of the variables to minimize the loss.\r\n        optimizer = tf.keras.optimizers.Adam(learning_rate=0.001)\r\n        optimizer.apply_gradients(zip(grads, model.inputs))\r\n\r\n        print('Iteration {}'.format(iteration))\r\n```\r\n\r\n\r\nHowever, this doesnot work, because grads = tape.gradient(loss_value, model.inputs) returns [None]. Is this intended behaviour or not? If yes, what is the recommended way to get the gradients with respect to the input?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36592", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36592/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36592/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36592/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36592", "id": 562183528, "node_id": "MDU6SXNzdWU1NjIxODM1Mjg=", "number": 36592, "title": "Heatmap function", "user": {"login": "generationzcode", "id": 43435971, "node_id": "MDQ6VXNlcjQzNDM1OTcx", "avatar_url": "https://avatars2.githubusercontent.com/u/43435971?v=4", "gravatar_id": "", "url": "https://api.github.com/users/generationzcode", "html_url": "https://github.com/generationzcode", "followers_url": "https://api.github.com/users/generationzcode/followers", "following_url": "https://api.github.com/users/generationzcode/following{/other_user}", "gists_url": "https://api.github.com/users/generationzcode/gists{/gist_id}", "starred_url": "https://api.github.com/users/generationzcode/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/generationzcode/subscriptions", "organizations_url": "https://api.github.com/users/generationzcode/orgs", "repos_url": "https://api.github.com/users/generationzcode/repos", "events_url": "https://api.github.com/users/generationzcode/events{/privacy}", "received_events_url": "https://api.github.com/users/generationzcode/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-02-09T14:18:40Z", "updated_at": "2020-03-06T23:28:21Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using):2.0(I use colab so the latest probably)\r\n- Are you willing to contribute it (Yes/No):\r\nYes\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nPresently I have to write lots of code to create a heatmap for images. I would like to have a function that automatically generates one for you\r\n**Will this change the current api? How?**\r\nIt will add another function to the API\r\n**Who will benefit with this feature?**\r\nBeginners at ML and others who don't want to write lots of code to do this\r\n**Any Other info.**\r\n"}]