[{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36227", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36227/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36227/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36227/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36227", "id": 555289301, "node_id": "MDU6SXNzdWU1NTUyODkzMDE=", "number": 36227, "title": "Poor performance and warning for GradientTape.jacobian with experimental_use_pfor=False", "user": {"login": "cmichelenstrofer", "id": 25060182, "node_id": "MDQ6VXNlcjI1MDYwMTgy", "avatar_url": "https://avatars2.githubusercontent.com/u/25060182?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cmichelenstrofer", "html_url": "https://github.com/cmichelenstrofer", "followers_url": "https://api.github.com/users/cmichelenstrofer/followers", "following_url": "https://api.github.com/users/cmichelenstrofer/following{/other_user}", "gists_url": "https://api.github.com/users/cmichelenstrofer/gists{/gist_id}", "starred_url": "https://api.github.com/users/cmichelenstrofer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cmichelenstrofer/subscriptions", "organizations_url": "https://api.github.com/users/cmichelenstrofer/orgs", "repos_url": "https://api.github.com/users/cmichelenstrofer/repos", "events_url": "https://api.github.com/users/cmichelenstrofer/events{/privacy}", "received_events_url": "https://api.github.com/users/cmichelenstrofer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 736653459, "node_id": "MDU6TGFiZWw3MzY2NTM0NTk=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:eager", "name": "comp:eager", "color": "0052cc", "default": false, "description": ""}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2020-01-26T21:16:58Z", "updated_at": "2020-03-17T01:15:25Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Scientific Linux 7\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): conda\r\n- TensorFlow version (use command below): 2\r\n- Python version: 3.7\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nExtremely slow gradient calculation. \r\nAlso the following warning: \r\n```\r\nWARNING:tensorflow:From /home/grad3/cmich/miniconda3/envs/3.7/lib/python3.7/site-packages/tensorflow_core/python/ops/array_grad.py:502: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse tf.identity instead.\r\n```\r\n\r\n**Describe the expected behavior**\r\nThere most be a much faster way of getting these gradients. After all the TensorFlow optimization must use these and those evaluations do not take so long. \r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n```python\r\nimport time\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\nclass Model(tf.keras.Model):\r\n    def __init__(self,):\r\n        super(Model, self).__init__()\r\n        self.layers_list = [tf.keras.layers.Dense(2)] + \\\r\n            [tf.keras.layers.Dense(1000)] + \\\r\n            [tf.keras.layers.Dense(500)]\r\n\r\n    def call(self, x):\r\n        for layer in self.layers_list:\r\n            x = layer(x)\r\n        return x\r\n\r\nmodel = Model()\r\nmodel.build((1,2))\r\nweights = model.trainable_variables\r\n\r\ninput = np.zeros([1,2])\r\n\r\nwith tf.GradientTape(persistent=True) as tape:\r\n    ts = time.time()\r\n    output = model(input)\r\n    print(f'Forward took {time.time()-ts:.2f}s')\r\n\r\nts = time.time()\r\ngradients = tape.jacobian(output, weights, experimental_use_pfor=False)\r\nprint(f'Backward took {time.time()-ts:.2f}s')\r\n```\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\nOutput:\r\n```\r\nForward took 0.01s\r\nWARNING:tensorflow:From /home/grad3/cmich/miniconda3/envs/3.7/lib/python3.7/site-packages/tensorflow_core/python/ops/array_grad.py:502: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse tf.identity instead.\r\nBackward took 5.75s\r\n```\r\nThe gradient calculation takes several orders of magnitude more time (for my real case the respective times are about 0.03s and 18s which is too much). \r\n\r\nIs this the best way of doing this or this a faster way? Also should I care about the warning?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36224", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36224/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36224/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36224/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36224", "id": 555280230, "node_id": "MDU6SXNzdWU1NTUyODAyMzA=", "number": 36224, "title": "tf.keras NaN loss when using multiple GPUs", "user": {"login": "rodyt", "id": 36773880, "node_id": "MDQ6VXNlcjM2NzczODgw", "avatar_url": "https://avatars2.githubusercontent.com/u/36773880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rodyt", "html_url": "https://github.com/rodyt", "followers_url": "https://api.github.com/users/rodyt/followers", "following_url": "https://api.github.com/users/rodyt/following{/other_user}", "gists_url": "https://api.github.com/users/rodyt/gists{/gist_id}", "starred_url": "https://api.github.com/users/rodyt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rodyt/subscriptions", "organizations_url": "https://api.github.com/users/rodyt/orgs", "repos_url": "https://api.github.com/users/rodyt/repos", "events_url": "https://api.github.com/users/rodyt/events{/privacy}", "received_events_url": "https://api.github.com/users/rodyt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2020-01-26T20:06:53Z", "updated_at": "2020-02-06T09:36:20Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: No\r\n- TensorFlow installed from (source or binary): Pip\r\n- TensorFlow version (use command below): 2.0\r\n- Python version: 3.7.3\r\n- Bazel version (if compiling from source): no\r\n- GCC/Compiler version (if compiling from source): no\r\n- CUDA/cuDNN version: 10\r\n- GPU model and memory: 2x NVIDIA GTX 1080 Ti 11GB\r\n- Driver Version: 440.33.01\r\n\r\n\r\nI am currently using Tensorflow 2.0 (Python) and the` tf.keras` library to train a CNN. However, I am encountering an issue when I try to train my model by calling `model.fit()`. \r\n\r\nAfter I begin training, the loss is normal for 1 ~ 2 steps for the first epoch. But after that, it suddenly becomes **NaN** loss.\r\n\r\nThis issue only happens when using multiple GPUs. The code I'm using works perfectly fine on a single GPU. I have wrapped all of my code inside the scope of a `tf.distribute.MirroredStrategy ` using `with strategy.scope():`. I am feeding my network with data from a `tf.data.Dataset` (though this error occurs regardless of the data format).\r\n\r\nI then ran some tests:\r\n\r\n1) I tried to replace the data in my dataset with random number, but the loss still went to **NaN**.\r\n\r\n2) I also tried feeding the numpy arrays directly to `.fit()`, but that didn't solve the issue.\r\n\r\n3) I tried using different optimizers (Adam, RMSprop, SGD), batch sizes (4, 8, 16, 32), and learning rates, none of which helped to solve this problem.\r\n\r\n4) I swapped out my network for a simple Multi-layer Perceptron, but the error persisted.\r\n\r\nThis doesn't appear to be an OOM issue, since the data is relatively small and running `watch -n0.1 nvidia-smi` reveals that memory usage never exceeds 30% on either of my GPUs. There doesn't seem to be any warning or error in the console output that might hint at the issue either.\r\n\r\nAny help is appreciated"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36219", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36219/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36219/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36219/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36219", "id": 555218538, "node_id": "MDU6SXNzdWU1NTUyMTg1Mzg=", "number": 36219, "title": "tf.lite.converter.convert() Erroe", "user": {"login": "pramodjayram", "id": 22176659, "node_id": "MDQ6VXNlcjIyMTc2NjU5", "avatar_url": "https://avatars2.githubusercontent.com/u/22176659?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pramodjayram", "html_url": "https://github.com/pramodjayram", "followers_url": "https://api.github.com/users/pramodjayram/followers", "following_url": "https://api.github.com/users/pramodjayram/following{/other_user}", "gists_url": "https://api.github.com/users/pramodjayram/gists{/gist_id}", "starred_url": "https://api.github.com/users/pramodjayram/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pramodjayram/subscriptions", "organizations_url": "https://api.github.com/users/pramodjayram/orgs", "repos_url": "https://api.github.com/users/pramodjayram/repos", "events_url": "https://api.github.com/users/pramodjayram/events{/privacy}", "received_events_url": "https://api.github.com/users/pramodjayram/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2020-01-26T12:01:34Z", "updated_at": "2020-02-21T18:47:29Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution Ubuntu 18.04\r\n- TensorFlow version (or github SHA if from source):2.0.0b1\r\n\r\nI am trying to test LSTM/GRU code using TensorFlow 2.0.0b1 in ubuntu 18.04.\r\nBelow you can find my simple model and converter code\r\n\r\n```\r\ndef create_gru_model():\r\n    model = tf.keras.models.Sequential();\r\n    model.add(tf.keras.layers.GRU(128))\r\n    model.add(tf.keras.layers.Flatten())\r\n    model.add(tf.keras.layers.Dense(49,activation=tf.nn.softmax))\r\n    model.compile(optimizer='adam',loss=customLoss,metrics = ['accuracy'])\r\n    return model\r\nmodel = create_gru_model()\r\nmodel.fit(x_train, y_train, epochs = 3, callbacks = [cp_callback], validation_data = (x_valid,y_valid), verbose=0)\r\nconverter = tf.lite.TFLiteConverter.from_keras_model(model)\r\nconverter.experimental_new_converter=True\r\ntflite_model = converter.convert()\r\n```\r\n\r\nI get the following error\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 148, in <module>\r\n    tflite_model = converter.convert()\r\n  File \"/home/pramod/.local/lib/python3.7/site-packages/tensorflow/lite/python/lite.py\", line 392, in convert\r\n    **converter_kwargs)\r\n  File \"/home/pramod/.local/lib/python3.7/site-packages/tensorflow/lite/python/convert.py\", line 404, in toco_convert_impl\r\n    input_data.SerializeToString())\r\n  File \"/home/pramod/.local/lib/python3.7/site-packages/tensorflow/lite/python/convert.py\", line 172, in toco_convert_protos\r\n    \"TOCO failed. See console for info.\\n%s\\n%s\\n\" % (stdout, stderr))\r\ntensorflow.lite.python.convert.ConverterError: TOCO failed. See console for info.\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint8 = np.dtype([(\"qint8\", np.int8, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint8 = np.dtype([(\"quint8\", np.uint8, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint16 = np.dtype([(\"qint16\", np.int16, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint16 = np.dtype([(\"quint16\", np.uint16, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint32 = np.dtype([(\"qint32\", np.int32, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  np_resource = np.dtype([(\"resource\", np.ubyte, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint8 = np.dtype([(\"qint8\", np.int8, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint8 = np.dtype([(\"quint8\", np.uint8, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint16 = np.dtype([(\"qint16\", np.int16, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint16 = np.dtype([(\"quint16\", np.uint16, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint32 = np.dtype([(\"qint32\", np.int32, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  np_resource = np.dtype([(\"resource\", np.ubyte, 1)])\r\n2020-01-26 12:56:17.818849: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 20\r\n2020-01-26 12:56:17.818886: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 20\r\n2020-01-26 12:56:17.818892: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 20\r\n2020-01-26 12:56:17.818987: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: StatefulPartitionedCall\r\n2020-01-26 12:56:17.827230: F tensorflow/lite/toco/import_tensorflow.cc:114] Check failed: attr.value_case() == AttrValue::kType (1 vs. 6)\r\nFatal Python error: Aborted\r\n\r\nCurrent thread 0x00007f4c3f6b7740 (most recent call first):\r\n  File \"/home/pramod/.local/lib/python3.7/site-packages/tensorflow/lite/toco/python/toco_from_protos.py\", line 33 in execute\r\n  File \"/home/pramod/.local/lib/python3.7/site-packages/absl/app.py\", line 250 in _run_main\r\n  File \"/home/pramod/.local/lib/python3.7/site-packages/absl/app.py\", line 299 in run\r\n  File \"/home/pramod/.local/lib/python3.7/site-packages/tensorflow/python/platform/app.py\", line 40 in run\r\n  File \"/home/pramod/.local/lib/python3.7/site-packages/tensorflow/lite/toco/python/toco_from_protos.py\", line 59 in main\r\n  File \"/home/pramod/.local/bin/toco_from_protos\", line 11 in <module>\r\nAborted (core dumped)\r\n\r\n\r\n\r\nError in sys.excepthook:\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3/dist-packages/apport_python_hook.py\", line 63, in apport_excepthook\r\n    from apport.fileutils import likely_packaged, get_recent_crashes\r\n  File \"/usr/lib/python3/dist-packages/apport/__init__.py\", line 5, in <module>\r\n    from apport.report import Report\r\n  File \"/usr/lib/python3/dist-packages/apport/report.py\", line 30, in <module>\r\n    import apport.fileutils\r\n  File \"/usr/lib/python3/dist-packages/apport/fileutils.py\", line 23, in <module>\r\n    from apport.packaging_impl import impl as packaging\r\n  File \"/usr/lib/python3/dist-packages/apport/packaging_impl.py\", line 24, in <module>\r\n    import apt\r\n  File \"/usr/lib/python3/dist-packages/apt/__init__.py\", line 23, in <module>\r\n    import apt_pkg\r\nModuleNotFoundError: No module named 'apt_pkg'\r\n\r\nOriginal exception was:\r\nTraceback (most recent call last):\r\n  File \"test.py\", line 148, in <module>\r\n    tflite_model = converter.convert()\r\n  File \"/home/pramod/.local/lib/python3.7/site-packages/tensorflow/lite/python/lite.py\", line 392, in convert\r\n    **converter_kwargs)\r\n  File \"/home/pramod/.local/lib/python3.7/site-packages/tensorflow/lite/python/convert.py\", line 404, in toco_convert_impl\r\n    input_data.SerializeToString())\r\n  File \"/home/pramod/.local/lib/python3.7/site-packages/tensorflow/lite/python/convert.py\", line 172, in toco_convert_protos\r\n    \"TOCO failed. See console for info.\\n%s\\n%s\\n\" % (stdout, stderr))\r\ntensorflow.lite.python.convert.ConverterError: TOCO failed. See console for info.\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint8 = np.dtype([(\"qint8\", np.int8, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint8 = np.dtype([(\"quint8\", np.uint8, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint16 = np.dtype([(\"qint16\", np.int16, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint16 = np.dtype([(\"quint16\", np.uint16, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint32 = np.dtype([(\"qint32\", np.int32, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  np_resource = np.dtype([(\"resource\", np.ubyte, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint8 = np.dtype([(\"qint8\", np.int8, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint8 = np.dtype([(\"quint8\", np.uint8, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint16 = np.dtype([(\"qint16\", np.int16, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint16 = np.dtype([(\"quint16\", np.uint16, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint32 = np.dtype([(\"qint32\", np.int32, 1)])\r\n/home/pramod/.local/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  np_resource = np.dtype([(\"resource\", np.ubyte, 1)])\r\n2020-01-26 12:56:17.818849: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 20\r\n2020-01-26 12:56:17.818886: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 20\r\n2020-01-26 12:56:17.818892: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 20\r\n2020-01-26 12:56:17.818987: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: StatefulPartitionedCall\r\n2020-01-26 12:56:17.827230: F tensorflow/lite/toco/import_tensorflow.cc:114] Check failed: attr.value_case() == AttrValue::kType (1 vs. 6)\r\nFatal Python error: Aborted\r\n\r\nCurrent thread 0x00007f4c3f6b7740 (most recent call first):\r\n  File \"/home/pramod/.local/lib/python3.7/site-packages/tensorflow/lite/toco/python/toco_from_protos.py\", line 33 in execute\r\n  File \"/home/pramod/.local/lib/python3.7/site-packages/absl/app.py\", line 250 in _run_main\r\n  File \"/home/pramod/.local/lib/python3.7/site-packages/absl/app.py\", line 299 in run\r\n  File \"/home/pramod/.local/lib/python3.7/site-packages/tensorflow/python/platform/app.py\", line 40 in run\r\n  File \"/home/pramod/.local/lib/python3.7/site-packages/tensorflow/lite/toco/python/toco_from_protos.py\", line 59 in main\r\n  File \"/home/pramod/.local/bin/toco_from_protos\", line 11 in <module>\r\nAborted (core dumped)\r\n\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36216", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36216/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36216/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36216/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36216", "id": 555175917, "node_id": "MDU6SXNzdWU1NTUxNzU5MTc=", "number": 36216, "title": "Keras: expose loss metric of singular output", "user": {"login": "phemmer", "id": 1826947, "node_id": "MDQ6VXNlcjE4MjY5NDc=", "avatar_url": "https://avatars3.githubusercontent.com/u/1826947?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phemmer", "html_url": "https://github.com/phemmer", "followers_url": "https://api.github.com/users/phemmer/followers", "following_url": "https://api.github.com/users/phemmer/following{/other_user}", "gists_url": "https://api.github.com/users/phemmer/gists{/gist_id}", "starred_url": "https://api.github.com/users/phemmer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phemmer/subscriptions", "organizations_url": "https://api.github.com/users/phemmer/orgs", "repos_url": "https://api.github.com/users/phemmer/repos", "events_url": "https://api.github.com/users/phemmer/events{/privacy}", "received_events_url": "https://api.github.com/users/phemmer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-01-26T04:24:55Z", "updated_at": "2020-03-02T08:23:55Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using): 2.1.0\r\n- Are you willing to contribute it (Yes/No): maybe\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nCurrently when training a keras model with multiple outputs, you get multiple \"loss\" metrics. One for each output, and then an overall loss for the whole model. However when your model only contains a single output, the metrics only contain a single loss value. [The documentation](https://www.tensorflow.org/api_docs/python/tf/keras/Model?version=stable#compile) implies that this is because the overall loss is simply a weighted sum of the individual outputs, and thus is irrelevant when only one output is present. However this is incorrect. The overall loss used to train the model also includes other factors, such as [layer losses due to regularizer penalties](https://www.tensorflow.org/api_docs/python/tf/keras/regularizers/Regularizer). Thus even with a single output, the output's loss can be different from the model's overall loss.\r\nTo address this discrepancy, a metric for the output loss should be provided even when the model only has one output.\r\n\r\n**Will this change the current api? How?**\r\nNo\r\n\r\n**Who will benefit with this feature?**\r\nAnyone with layer losses, such as due to regularizers.\r\n\r\n**Any Other info.**\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36198", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36198/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36198/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36198/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36198", "id": 555048688, "node_id": "MDU6SXNzdWU1NTUwNDg2ODg=", "number": 36198, "title": "model.summary() Does not Work in Some Cases", "user": {"login": "yourtheron", "id": 51472988, "node_id": "MDQ6VXNlcjUxNDcyOTg4", "avatar_url": "https://avatars1.githubusercontent.com/u/51472988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yourtheron", "html_url": "https://github.com/yourtheron", "followers_url": "https://api.github.com/users/yourtheron/followers", "following_url": "https://api.github.com/users/yourtheron/following{/other_user}", "gists_url": "https://api.github.com/users/yourtheron/gists{/gist_id}", "starred_url": "https://api.github.com/users/yourtheron/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yourtheron/subscriptions", "organizations_url": "https://api.github.com/users/yourtheron/orgs", "repos_url": "https://api.github.com/users/yourtheron/repos", "events_url": "https://api.github.com/users/yourtheron/events{/privacy}", "received_events_url": "https://api.github.com/users/yourtheron/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-01-25T06:10:44Z", "updated_at": "2020-03-09T00:36:03Z", "closed_at": null, "author_association": "NONE", "body": "Tf Version 2.1\r\nHaving been suggested by @reedwm I am filing this bug. Please see the last comment in issue #35441 for details.\r\n/CC @reedwm"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36189", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36189/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36189/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36189/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36189", "id": 554915534, "node_id": "MDU6SXNzdWU1NTQ5MTU1MzQ=", "number": 36189, "title": "Unable to build \"Hello World\" for ESP32", "user": {"login": "mr-goldhands", "id": 3122202, "node_id": "MDQ6VXNlcjMxMjIyMDI=", "avatar_url": "https://avatars2.githubusercontent.com/u/3122202?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mr-goldhands", "html_url": "https://github.com/mr-goldhands", "followers_url": "https://api.github.com/users/mr-goldhands/followers", "following_url": "https://api.github.com/users/mr-goldhands/following{/other_user}", "gists_url": "https://api.github.com/users/mr-goldhands/gists{/gist_id}", "starred_url": "https://api.github.com/users/mr-goldhands/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mr-goldhands/subscriptions", "organizations_url": "https://api.github.com/users/mr-goldhands/orgs", "repos_url": "https://api.github.com/users/mr-goldhands/repos", "events_url": "https://api.github.com/users/mr-goldhands/events{/privacy}", "received_events_url": "https://api.github.com/users/mr-goldhands/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rockyrhodes", "id": 7253968, "node_id": "MDQ6VXNlcjcyNTM5Njg=", "avatar_url": "https://avatars2.githubusercontent.com/u/7253968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rockyrhodes", "html_url": "https://github.com/rockyrhodes", "followers_url": "https://api.github.com/users/rockyrhodes/followers", "following_url": "https://api.github.com/users/rockyrhodes/following{/other_user}", "gists_url": "https://api.github.com/users/rockyrhodes/gists{/gist_id}", "starred_url": "https://api.github.com/users/rockyrhodes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rockyrhodes/subscriptions", "organizations_url": "https://api.github.com/users/rockyrhodes/orgs", "repos_url": "https://api.github.com/users/rockyrhodes/repos", "events_url": "https://api.github.com/users/rockyrhodes/events{/privacy}", "received_events_url": "https://api.github.com/users/rockyrhodes/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rockyrhodes", "id": 7253968, "node_id": "MDQ6VXNlcjcyNTM5Njg=", "avatar_url": "https://avatars2.githubusercontent.com/u/7253968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rockyrhodes", "html_url": "https://github.com/rockyrhodes", "followers_url": "https://api.github.com/users/rockyrhodes/followers", "following_url": "https://api.github.com/users/rockyrhodes/following{/other_user}", "gists_url": "https://api.github.com/users/rockyrhodes/gists{/gist_id}", "starred_url": "https://api.github.com/users/rockyrhodes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rockyrhodes/subscriptions", "organizations_url": "https://api.github.com/users/rockyrhodes/orgs", "repos_url": "https://api.github.com/users/rockyrhodes/repos", "events_url": "https://api.github.com/users/rockyrhodes/events{/privacy}", "received_events_url": "https://api.github.com/users/rockyrhodes/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-01-24T19:34:57Z", "updated_at": "2020-02-02T01:40:52Z", "closed_at": null, "author_association": "NONE", "body": "@tensorflow/micro\r\n\r\n**System information**\r\n- Host OS Platform and Distribution: Linux Ubuntu 16.04\r\n- TensorFlow installed from: source\r\n- Tensorflow version: ca0d5142f640d42037f22367ce3530b6b7a23b44\r\n- Target platform: ESP32\r\n\r\n**Describe the problem**\r\nBuilding the example Hello World for ESp32 fails.\r\n\r\n**Please provide the exact sequence of commands/steps when you ran into the problem**\r\n1. I successfully generated example by command:\r\n`make -f tensorflow/lite/micro/tools/make/Makefile TARGET=esp generate_hello_world_esp_project`\r\n\r\n2. I run building project by command:\r\n`idf.py build`\r\n\r\n3. I receved compilation error:\r\n`[ 84%] Building C object esp-idf/protocomm/CMakeFiles/__idf_protocomm.dir/proto-c/constants.pb-c.c.obj\r\nIn file included from /home/dmytro/esp/projects/hello_world_tf/components/tfmicro/tensorflow/lite/micro/kernels/svdf.cc:25:\r\n/home/dmytro/esp/projects/hello_world_tf/components/tfmicro/tensorflow/lite/micro/kernels/activation_utils.h: In function 'float tflite::ops::micro::ActivationValFloat(TfLiteFusedActivation, float)':\r\n/home/dmytro/esp/projects/hello_world_tf/components/tfmicro/tensorflow/lite/micro/kernels/activation_utils.h:45:1: error: control reaches end of non-void function [-Werror=return-type]\r\n }\r\n ^\r\n`\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36183", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36183/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36183/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36183/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36183", "id": 554843999, "node_id": "MDU6SXNzdWU1NTQ4NDM5OTk=", "number": 36183, "title": "TFLite new quantizer brokes ALBERT model", "user": {"login": "Rexhaif", "id": 5154447, "node_id": "MDQ6VXNlcjUxNTQ0NDc=", "avatar_url": "https://avatars3.githubusercontent.com/u/5154447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Rexhaif", "html_url": "https://github.com/Rexhaif", "followers_url": "https://api.github.com/users/Rexhaif/followers", "following_url": "https://api.github.com/users/Rexhaif/following{/other_user}", "gists_url": "https://api.github.com/users/Rexhaif/gists{/gist_id}", "starred_url": "https://api.github.com/users/Rexhaif/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Rexhaif/subscriptions", "organizations_url": "https://api.github.com/users/Rexhaif/orgs", "repos_url": "https://api.github.com/users/Rexhaif/repos", "events_url": "https://api.github.com/users/Rexhaif/events{/privacy}", "received_events_url": "https://api.github.com/users/Rexhaif/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "suharshs", "id": 1450614, "node_id": "MDQ6VXNlcjE0NTA2MTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/1450614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suharshs", "html_url": "https://github.com/suharshs", "followers_url": "https://api.github.com/users/suharshs/followers", "following_url": "https://api.github.com/users/suharshs/following{/other_user}", "gists_url": "https://api.github.com/users/suharshs/gists{/gist_id}", "starred_url": "https://api.github.com/users/suharshs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suharshs/subscriptions", "organizations_url": "https://api.github.com/users/suharshs/orgs", "repos_url": "https://api.github.com/users/suharshs/repos", "events_url": "https://api.github.com/users/suharshs/events{/privacy}", "received_events_url": "https://api.github.com/users/suharshs/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "suharshs", "id": 1450614, "node_id": "MDQ6VXNlcjE0NTA2MTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/1450614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suharshs", "html_url": "https://github.com/suharshs", "followers_url": "https://api.github.com/users/suharshs/followers", "following_url": "https://api.github.com/users/suharshs/following{/other_user}", "gists_url": "https://api.github.com/users/suharshs/gists{/gist_id}", "starred_url": "https://api.github.com/users/suharshs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suharshs/subscriptions", "organizations_url": "https://api.github.com/users/suharshs/orgs", "repos_url": "https://api.github.com/users/suharshs/repos", "events_url": "https://api.github.com/users/suharshs/events{/privacy}", "received_events_url": "https://api.github.com/users/suharshs/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-01-24T16:49:26Z", "updated_at": "2020-02-21T18:43:52Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): docker container with ubuntu 16.04, running on host with fedora 31\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (or github SHA if from source): 2.2.0-dev20200119\r\n\r\n\r\n**Command used to run the converter or code if you\u2019re using the Python API**\r\n\r\n```\r\nconfig = tr.AlbertConfig.from_pretrained(model_dir)\r\n    model = tr.TFAlbertForSequenceClassification.from_pretrained(\r\n        model_dir + 'pytorch_model.bin',\r\n        from_pt=True,\r\n        config=config\r\n    )\r\n    \r\ninput_ids: tf.TensorSpec = tf.TensorSpec((1, 128), dtype=tf.int32, name='input_ids')\r\nattn_mask: tf.TensorSpec = tf.TensorSpec((1, 128), dtype=tf.int32, name='attn_mask')\r\nmodel._set_inputs([input_ids, attn_mask], training=False)\r\n\r\nconverter = tf.lite.TFLiteConverter.from_keras_model(model)\r\nconverter.experimental_new_converter = True\r\nconverter.experimental_new_quantizer = True\r\nconverter.target_spec.supported_ops = [tf.lite.OpsSet.TFLITE_BUILTINS]\r\n\r\nconverter.optimizations = [tf.lite.Optimize.OPTIMIZE_FOR_SIZE]\r\nconverter.representative_dataset = representative_dataset\r\ntflite_model = converter.convert()\r\n\r\n```\r\n\r\n**The output from the converter invocation**\r\n\r\n```\r\n2020-01-24 16:32:16.530758: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.\r\n2020-01-24 16:32:16.554102: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1\r\n2020-01-24 16:32:16.557035: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected\r\n2020-01-24 16:32:16.557052: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:169] retrieving CUDA diagnostic information for host: bb9f01c415b3\r\n2020-01-24 16:32:16.557059: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:176] hostname: bb9f01c415b3\r\n2020-01-24 16:32:16.557145: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:200] libcuda reported version is: 435.21.0\r\n2020-01-24 16:32:16.557160: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:204] kernel reported version is: 435.21.0\r\n2020-01-24 16:32:16.557164: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:310] kernel version seems to match DSO: 435.21.0\r\n2020-01-24 16:32:16.557353: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2020-01-24 16:32:16.574660: I tensorflow/core/platform/profile_utils/cpu_utils.cc:101] CPU Frequency: 3892860000 Hz\r\n2020-01-24 16:32:16.575312: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562d071745f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n2020-01-24 16:32:16.575337: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\n2020-01-24 16:32:18.432 | INFO     | __main__:<module>:114 - loaded model & tokenizer\r\n2020-01-24 16:32:18.443 | INFO     | __main__:<module>:117 - loaded representative dataset\r\n2020-01-24 16:32:19.227068: I tensorflow/core/grappler/devices.cc:55] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0\r\n2020-01-24 16:32:19.227222: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2020-01-24 16:32:19.254757: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:815] Optimization results for grappler item: graph_to_optimize\r\n2020-01-24 16:32:19.254798: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: function_optimizer did nothing. time = 0.004ms.\r\n2020-01-24 16:32:19.254802: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-24 16:32:21.189883: I tensorflow/core/grappler/devices.cc:55] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0\r\n2020-01-24 16:32:21.190007: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2020-01-24 16:32:22.539819: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:815] Optimization results for grappler item: graph_to_optimize\r\n2020-01-24 16:32:22.539870: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   constant_folding: Graph size after: 2861 nodes (-184), 3659 edges (-361), time = 906.902ms.\r\n2020-01-24 16:32:22.539875: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   constant_folding: Graph size after: 2861 nodes (0), 3659 edges (0), time = 359.704ms.\r\nINFO:absl:Using experimental converter: If you encountered a problem please file a bug. You can opt-out by setting experimental_new_converter=False\r\n2020-01-24 16:35:00.745 | INFO     | __main__:<module>:123 - model conversion finished, writing to file..\r\n2020-01-24 16:35:00.752 | INFO     | __main__:<module>:128 - All Done!\r\n```\r\n\r\n**Also, please include a link to the saved model or GraphDef**\r\n\r\nSadly, tensorflow fails to save my model. I'm using fine-tuned version of ALBERT-base-v2(for sequence classification) from huggingface\\transformers.\r\n\r\n**Failure details**\r\nConversion went without any failures, but produced model is completely wrong, as it is 18x slower than model produced without calibration and experimental_new_quantizer(but with experimantal_new_converter) and this model produces trashed metrics:\r\n```\r\n# experimental_new_quantizer=True, experimental_new_converter=True and calibration is on\r\n{\"accuracy\": 0.025161092359619514, \"micro-f1\": 0.3419799704482023, \"macro-f1\": 0.17553049991957947}\r\ninference time: 18 sec \\ sample (on x86_64)\r\n# experimantal_new_quantizer=False, experimental_new_converter=True and no calibration\r\n{\"accuracy\": 0.4894139306535747, \"micro-f1\": 0.6913144244564617, \"macro-f1\": 0.5892280589520447}\r\ninference time: 1 sec \\ sample (on x86_64)\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36181", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36181/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36181/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36181/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36181", "id": 554746600, "node_id": "MDU6SXNzdWU1NTQ3NDY2MDA=", "number": 36181, "title": "AttributeError: 'Tensor' object has no attribute 'log_prob'", "user": {"login": "nbro", "id": 9349000, "node_id": "MDQ6VXNlcjkzNDkwMDA=", "avatar_url": "https://avatars2.githubusercontent.com/u/9349000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nbro", "html_url": "https://github.com/nbro", "followers_url": "https://api.github.com/users/nbro/followers", "following_url": "https://api.github.com/users/nbro/following{/other_user}", "gists_url": "https://api.github.com/users/nbro/gists{/gist_id}", "starred_url": "https://api.github.com/users/nbro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nbro/subscriptions", "organizations_url": "https://api.github.com/users/nbro/orgs", "repos_url": "https://api.github.com/users/nbro/repos", "events_url": "https://api.github.com/users/nbro/events{/privacy}", "received_events_url": "https://api.github.com/users/nbro/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvdillon", "id": 1137078, "node_id": "MDQ6VXNlcjExMzcwNzg=", "avatar_url": "https://avatars0.githubusercontent.com/u/1137078?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvdillon", "html_url": "https://github.com/jvdillon", "followers_url": "https://api.github.com/users/jvdillon/followers", "following_url": "https://api.github.com/users/jvdillon/following{/other_user}", "gists_url": "https://api.github.com/users/jvdillon/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvdillon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvdillon/subscriptions", "organizations_url": "https://api.github.com/users/jvdillon/orgs", "repos_url": "https://api.github.com/users/jvdillon/repos", "events_url": "https://api.github.com/users/jvdillon/events{/privacy}", "received_events_url": "https://api.github.com/users/jvdillon/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvdillon", "id": 1137078, "node_id": "MDQ6VXNlcjExMzcwNzg=", "avatar_url": "https://avatars0.githubusercontent.com/u/1137078?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvdillon", "html_url": "https://github.com/jvdillon", "followers_url": "https://api.github.com/users/jvdillon/followers", "following_url": "https://api.github.com/users/jvdillon/following{/other_user}", "gists_url": "https://api.github.com/users/jvdillon/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvdillon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvdillon/subscriptions", "organizations_url": "https://api.github.com/users/jvdillon/orgs", "repos_url": "https://api.github.com/users/jvdillon/repos", "events_url": "https://api.github.com/users/jvdillon/events{/privacy}", "received_events_url": "https://api.github.com/users/jvdillon/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2020-01-24T13:50:40Z", "updated_at": "2020-02-21T18:47:24Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Mac OS Catalina (Version: 10.15.2 (19C57))\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 2.1\r\n- Python version: 3.7.5\r\n- GPU model and memory: Intel Iris Pro 1536 MB\r\n\r\n**Describe the current behavior**\r\n\r\nI get the error\r\n\r\n> AttributeError: 'Tensor' object has no attribute 'log_prob'\r\n\r\nwith TensorFlow Probability 0.9 (and TF 2.1).\r\n\r\n**Describe the expected behavior**\r\n\r\nNo error.\r\n\r\n**Code to reproduce the issue**\r\n\r\nThe following code\r\n\r\n```\r\nimport tensorflow as tf\r\nimport tensorflow_probability as tfp\r\nfrom tensorflow_probability import distributions as tfd\r\n\r\n\r\ndef get_mnist_data(normalize=True):\r\n    img_rows, img_cols = 28, 28\r\n    (x_train, y_train), (x_test, y_test) = tf.keras.datasets.mnist.load_data()\r\n\r\n    if tf.keras.backend.image_data_format() == 'channels_first':\r\n        x_train = x_train.reshape(x_train.shape[0], 1, img_rows, img_cols)\r\n        x_test = x_test.reshape(x_test.shape[0], 1, img_rows, img_cols)\r\n        input_shape = (1, img_rows, img_cols)\r\n    else:\r\n        x_train = x_train.reshape(x_train.shape[0], img_rows, img_cols, 1)\r\n        x_test = x_test.reshape(x_test.shape[0], img_rows, img_cols, 1)\r\n        input_shape = (img_rows, img_cols, 1)\r\n\r\n    x_train = x_train.astype('float32')\r\n    x_test = x_test.astype('float32')\r\n\r\n    if normalize:\r\n        x_train /= 255\r\n        x_test /= 255\r\n\r\n    return x_train, y_train, x_test, y_test, input_shape\r\n\r\n\r\ndef get_bayesian_cnn(input_shape, num_classes=10):\r\n    model_input = tf.keras.layers.Input(shape=input_shape)\r\n\r\n    # kernel_divergence_fn=None to solve a symbolic exception.\r\n    x = tfp.layers.Convolution2DFlipout(6, kernel_size=(5, 5), padding=\"SAME\", activation=tf.nn.relu,\r\n                                        kernel_divergence_fn=None)(model_input)\r\n    x = tf.keras.layers.Flatten()(x)\r\n    x = tfp.layers.DenseFlipout(84, activation=tf.nn.relu)(x)\r\n    x = tfp.layers.DenseFlipout(num_classes)(x)\r\n\r\n    model_output = tfp.layers.DistributionLambda(lambda t: tfd.Categorical(logits=t, validate_args=True))(x)\r\n\r\n    model = tf.keras.Model(model_input, model_output)\r\n\r\n    return model\r\n\r\n\r\ndef neg_log_likelihood(y_true, y_pred):\r\n    return -tf.reduce_mean(y_pred.log_prob(tf.cast(tf.argmax(y_true, axis=-1), tf.int32)))\r\n\r\n\r\ndef train():\r\n    x_train, y_train, x_test, y_test, input_shape = get_mnist_data()\r\n\r\n    model = get_bayesian_cnn(input_shape=input_shape)\r\n\r\n    model.compile(optimizer=tf.keras.optimizers.Adam(), loss=neg_log_likelihood,\r\n                  metrics=[neg_log_likelihood])\r\n\r\n    model.fit(x_train, y_train, batch_size=128, epochs=1, verbose=1)\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    train()\r\n```\r\n\r\n**Comments**\r\n\r\nThis error seems to be due to the fact that `y_pred` is a tensor when the loss is called, while it should be a distribution. Meanwhile, I found a [question on Stack Overflow related to the third issue I mentioned above](https://stackoverflow.com/q/59743872/3924118). \r\n\r\n(_This is a duplicate issue of https://github.com/tensorflow/probability/issues/742, but, for completeness, I decided to open it here too._)"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36180", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36180/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36180/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36180/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36180", "id": 554693215, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY2ODAxMTI3", "number": 36180, "title": "TFLite: add cmake support", "user": {"login": "jsee23", "id": 5591937, "node_id": "MDQ6VXNlcjU1OTE5Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/5591937?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsee23", "html_url": "https://github.com/jsee23", "followers_url": "https://api.github.com/users/jsee23/followers", "following_url": "https://api.github.com/users/jsee23/following{/other_user}", "gists_url": "https://api.github.com/users/jsee23/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsee23/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsee23/subscriptions", "organizations_url": "https://api.github.com/users/jsee23/orgs", "repos_url": "https://api.github.com/users/jsee23/repos", "events_url": "https://api.github.com/users/jsee23/events{/privacy}", "received_events_url": "https://api.github.com/users/jsee23/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1169365682, "node_id": "MDU6TGFiZWwxMTY5MzY1Njgy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:L", "name": "size:L", "color": "adafea", "default": false, "description": "CL Change Size: Large"}, {"id": 474725938, "node_id": "MDU6TGFiZWw0NzQ3MjU5Mzg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stalled", "name": "stalled", "color": "d4c5f9", "default": false, "description": null}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2020-01-24T11:51:29Z", "updated_at": "2020-03-15T00:42:59Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36180", "html_url": "https://github.com/tensorflow/tensorflow/pull/36180", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36180.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36180.patch"}, "body": "Motivation:\r\nRaspberry Pi4 is gaining OpenGL ES3.1 support with Mesa 19.3. Additionally, many SoC's in the embedded space also supporting 3.1 or OpenCL 2.0. Also, there are desktop GPUs which support OpenCL 2.0. Make it possible to compile the GL & CL delegates easily and separatly (e.g. if just OpenGL ES3.1 is available).\r\n\r\nThis PR adds support for compiling TF Lite with CMake. CMake was choosen, because it's a settled build system, used very often in embedded area and also support by abseil & flatbuffers (which are requirements for GL & CL delegates). It mainly adds a lot of #ifdefs to the code... The PR isn't complete yet, but I quickly want to discuss, if CMake support is desired and if yes, we should deprecate Makefile support.\r\n\r\nTo use it:\r\n1. run download_dependencies.sh in tools/make\r\n2. run build.sh in tools/cmake (this will run cmake twice, first compiling flatc for the host, then TFLite for the target; additional parameters of build.sh are passed to the \"target\"-cmake run)\r\n\r\nMissing stuff: documentation/README.md, don't compile flatc when no delegate is built, etc."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36170", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36170/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36170/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36170/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36170", "id": 554512085, "node_id": "MDU6SXNzdWU1NTQ1MTIwODU=", "number": 36170, "title": "Build fails with messages including \"undefined reference to symbol 'acos@@GLIBC_2.2.5' \", \"Linking of rule '@flatbuffers//:flatc' failed\"", "user": {"login": "dbonner", "id": 241474, "node_id": "MDQ6VXNlcjI0MTQ3NA==", "avatar_url": "https://avatars3.githubusercontent.com/u/241474?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbonner", "html_url": "https://github.com/dbonner", "followers_url": "https://api.github.com/users/dbonner/followers", "following_url": "https://api.github.com/users/dbonner/following{/other_user}", "gists_url": "https://api.github.com/users/dbonner/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbonner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbonner/subscriptions", "organizations_url": "https://api.github.com/users/dbonner/orgs", "repos_url": "https://api.github.com/users/dbonner/repos", "events_url": "https://api.github.com/users/dbonner/events{/privacy}", "received_events_url": "https://api.github.com/users/dbonner/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2020-01-24T02:21:42Z", "updated_at": "2020-01-27T21:20:41Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- TensorFlow installed from (source or binary): Attempting to build from source\r\n- TensorFlow version: 2.1.0 (attempting to build from master)\r\n- Python version: 3.8.0\r\n- Installed using virtualenv? pip? conda?: virtualenv\r\n- Bazel version (if compiling from source): 1.2.1\r\n- GCC/Compiler version (if compiling from source): 7.4.0\r\n- CUDA/cuDNN version: CUDA 10.1 / cuDNN 7.6.5\r\n- GPU model and memory: NVidia RTX 2080 Ti\r\n\r\n**Describe the problem**\r\n\r\nI am trying to build for python 3.8.0 since issues relating to python 3.8.0 should now be fixed (see #34433 ).  There is also no pip package that you can install with \"pip install tensorflow\" for python 3.8.0.\r\n\r\nBuild fails with the following messages:\r\n\r\n```\r\nINFO: Analyzed target //tensorflow/tools/pip_package:build_pip_package (345 packages loaded, 27926 targets configured).\r\nINFO: Found 1 target...\r\nINFO: Deleting stale sandbox base /home/daniel/.cache/bazel/_bazel_daniel/79db702fc9f94af7d11e11c5d64854d0/sandbox\r\nINFO: From Compiling tensorflow/core/platform/default/logging.cc [for host]:\r\ntensorflow/core/platform/default/logging.cc: In member function \u2018bool tensorflow::internal::LogFirstNState::ShouldLog(int)\u2019:\r\ntensorflow/core/platform/default/logging.cc:369:21: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\r\n   if (counter_value < n) {\r\n       ~~~~~~~~~~~~~~^~~\r\nINFO: From Compiling external/snappy/snappy-sinksource.cc [for host]:\r\ncc1plus: warning: command line option \u2018-Wno-implicit-function-declaration\u2019 is valid for C/ObjC but not for C++\r\nINFO: From Compiling external/snappy/snappy-stubs-internal.cc [for host]:\r\ncc1plus: warning: command line option \u2018-Wno-implicit-function-declaration\u2019 is valid for C/ObjC but not for C++\r\nINFO: From Compiling external/snappy/snappy.cc [for host]:\r\ncc1plus: warning: command line option \u2018-Wno-implicit-function-declaration\u2019 is valid for C/ObjC but not for C++\r\nINFO: From Compiling tensorflow/core/platform/protobuf.cc [for host]:\r\ntensorflow/core/platform/protobuf.cc: In member function \u2018virtual bool tensorflow::TStringOutputStream::Next(void**, int*)\u2019:\r\ntensorflow/core/platform/protobuf.cc:30:16: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\r\n   if (old_size < target_->capacity()) {\r\n       ~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~\r\nINFO: From Compiling tensorflow/core/platform/numbers.cc [for host]:\r\ntensorflow/core/platform/numbers.cc: In instantiation of \u2018T tensorflow::{anonymous}::locale_independent_strtonum(const char*, const char**) [with T = double]\u2019:\r\ntensorflow/core/platform/numbers.cc:197:60:   required from here\r\ntensorflow/core/platform/numbers.cc:65:21: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\r\n   for (int i = 0; i < special_num_str.length(); ++i) {\r\n                   ~~^~~~~~~~~~~~~~~~~~~~~~~~~~\r\ntensorflow/core/platform/numbers.cc: In function \u2018std::__cxx11::string tensorflow::strings::HumanReadableNumBytes(tensorflow::int64)\u2019:\r\ntensorflow/core/platform/numbers.cc:459:8: warning: \u2018%lld\u2019 directive output may be truncated writing between 1 and 19 bytes into a region of size between 7 and 8 [-Wformat-truncation=]\r\n string HumanReadableNumBytes(int64 num_bytes) {\r\n        ^~~~~~~~~~~~~~~~~~~~~\r\ntensorflow/core/platform/numbers.cc:459:8: note: directive argument in the range [0, 9223372036854775807]\r\nIn file included from /usr/include/stdio.h:862:0,\r\n                 from /usr/include/c++/7/cstdio:42,\r\n                 from /usr/include/c++/7/ext/string_conversions.h:43,\r\n                 from /usr/include/c++/7/bits/basic_string.h:6361,\r\n                 from /usr/include/c++/7/string:52,\r\n                 from ./tensorflow/core/platform/numbers.h:19,\r\n                 from tensorflow/core/platform/numbers.cc:15:\r\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:65:44: note: \u2018__builtin_snprintf\u2019 output between 3 and 22 bytes into a destination of size 8\r\n        __bos (__s), __fmt, __va_arg_pack ());\r\n                                            ^\r\nINFO: From Compiling external/llvm-project/llvm/lib/Support/APFloat.cpp [for host]:\r\nexternal/llvm-project/llvm/lib/Support/APFloat.cpp: In member function \u2018llvm::Expected<llvm::APFloatBase::opStatus> llvm::detail::IEEEFloat::convertFromDecimalString(llvm::StringRef, llvm::APFloatBase::roundingMode)\u2019:\r\nexternal/llvm-project/llvm/lib/Support/APFloat.cpp:2625:38: warning: \u2018D.llvm::decimalInfo::exponent\u2019 may be used uninitialized in this function [-Wmaybe-uninitialized]\r\n     fs = roundSignificandWithExponent(decSignificand, partCount,\r\n          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n                                       D.exponent, rounding_mode);\r\n                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nexternal/llvm-project/llvm/lib/Support/APFloat.cpp:2561:36: warning: \u2018D.llvm::decimalInfo::normalizedExponent\u2019 may be used uninitialized in this function [-Wmaybe-uninitialized]\r\n              (D.normalizedExponent + 1) * 28738 <=\r\n              ~~~~~~~~~~~~~~~~~~~~~~^~~~\r\nexternal/llvm-project/llvm/lib/Support/APFloat.cpp:2622:16: warning: \u2018D.llvm::decimalInfo::lastSigDigit\u2019 may be used uninitialized in this function [-Wmaybe-uninitialized]\r\n     } while (p <= D.lastSigDigit);\r\n              ~~^~~~~~~~~~~~~~~~~\r\nexternal/llvm-project/llvm/lib/Support/APFloat.cpp:2581:58: warning: \u2018D.llvm::decimalInfo::firstSigDigit\u2019 may be used uninitialized in this function [-Wmaybe-uninitialized]\r\n     partCount = static_cast<unsigned int>(D.lastSigDigit - D.firstSigDigit) + 1;\r\n                                           ~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~\r\nINFO: From Compiling external/llvm-project/llvm/lib/Support/UnicodeCaseFold.cpp [for host]:\r\nexternal/llvm-project/llvm/lib/Support/UnicodeCaseFold.cpp:8:1: warning: multi-line comment [-Wcomment]\r\n //   utils/unicode-case-fold.py \\\r\n ^\r\nINFO: From Compiling external/llvm-project/llvm/lib/Support/VirtualFileSystem.cpp [for host]:\r\nexternal/llvm-project/llvm/lib/Support/VirtualFileSystem.cpp: In member function \u2018std::unique_ptr<llvm::vfs::RedirectingFileSystem::Entry> llvm::vfs::RedirectingFileSystemParser::parseEntry(llvm::yaml::Node*, llvm::vfs::RedirectingFileSystem*, bool)\u2019:\r\nexternal/llvm-project/llvm/lib/Support/VirtualFileSystem.cpp:1471:5: warning: \u2018Kind\u2019 may be used uninitialized in this function [-Wmaybe-uninitialized]\r\n     switch (Kind) {\r\n     ^~~~~~\r\nINFO: From Compiling external/llvm-project/llvm/lib/MC/ELFObjectWriter.cpp [for host]:\r\nexternal/llvm-project/llvm/lib/MC/ELFObjectWriter.cpp: In function \u2018uint64_t {anonymous}::ELFWriter::writeObject(llvm::MCAssembler&, const llvm::MCAsmLayout&)\u2019:\r\nexternal/llvm-project/llvm/lib/MC/ELFObjectWriter.cpp:1193:36: warning: \u2018AddrsigSection\u2019 may be used uninitialized in this function [-Wmaybe-uninitialized]\r\n       SectionOffsets[AddrsigSection] = std::make_pair(SecStart, SecEnd);\r\n                                    ^\r\nINFO: From Compiling external/llvm-project/llvm/lib/MC/MachObjectWriter.cpp [for host]:\r\nexternal/llvm-project/llvm/lib/MC/MachObjectWriter.cpp: In member function \u2018void llvm::MachObjectWriter::writeNlist(llvm::MachObjectWriter::MachSymbolData&, const llvm::MCAsmLayout&)\u2019:\r\nexternal/llvm-project/llvm/lib/MC/MachObjectWriter.cpp:381:13: warning: \u2018AliaseeInfo\u2019 may be used uninitialized in this function [-Wmaybe-uninitialized]\r\n     Address = AliaseeInfo->StringIndex;\r\n     ~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~\r\nERROR: /home/daniel/.cache/bazel/_bazel_daniel/79db702fc9f94af7d11e11c5d64854d0/external/flatbuffers/BUILD.bazel:51:1: Linking of rule '@flatbuffers//:flatc' failed (Exit 1)\r\n/usr/bin/ld: bazel-out/host/bin/external/flatbuffers/src/libflatbuffers.a(idl_parser.o): undefined reference to symbol 'acos@@GLIBC_2.2.5'\r\n//lib/x86_64-linux-gnu/libm.so.6: error adding symbols: DSO missing from command line\r\ncollect2: error: ld returned 1 exit status\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nUse --verbose_failures to see the command lines of failed build steps.\r\nERROR: /home/daniel/tensorflow/tensorflow/python/tools/BUILD:141:1 Linking of rule '@flatbuffers//:flatc' failed (Exit 1)\r\nINFO: Elapsed time: 103.160s, Critical Path: 25.44s\r\nINFO: 1225 processes: 1225 local.\r\nFAILED: Build did NOT complete successfully\r\n```\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n\r\n```\r\ngit clone https://github.com/tensorflow/tensorflow.git\r\ncd tensorflow\r\n./configure\r\nYou have bazel 1.2.1 installed.\r\nPlease specify the location of python. [Default is /home/daniel/tf38/bin/python]: Default accepted\r\nPython library path to use.  Default is [/home/daniel/tf38/lib/python3.8/site-packages]: Default accepted\r\nDo you wish to build TensorFlow with XLA JIT support? [Y/n]: Y\r\nXLA JIT support will be enabled for TensorFlow.\r\nDo you wish to build TensorFlow with OpenCL SYCL support? [y/N]: N\r\nNo OpenCL SYCL support will be enabled for TensorFlow.\r\nDo you wish to build TensorFlow with ROCm support? [y/N]: N\r\nNo ROCm support will be enabled for TensorFlow.\r\nDo you wish to build TensorFlow with CUDA support? [y/N]: y\r\nCUDA support will be enabled for TensorFlow.\r\nDo you wish to build TensorFlow with TensorRT support? [y/N]: y\r\nTensorRT support will be enabled for TensorFlow.\r\nFound CUDA 10.1 in:\r\n    /usr/local/cuda/lib64\r\n    /usr/local/cuda/include\r\nFound cuDNN 7 in:\r\n    /usr/lib/x86_64-linux-gnu\r\n    /usr/include\r\nFound TensorRT 6 in:\r\n    /usr/lib/x86_64-linux-gnu\r\n    /usr/include/x86_64-linux-gnu\r\nCUDA compute capabilities [Default is: 3.5,7.0]: 7.5\r\nDo you want to use clang as CUDA compiler? [y/N]: N\r\nnvcc will be used as CUDA compiler.\r\nPlease specify which gcc should be used by nvcc as the host compiler. [Default is /usr/bin/gcc]: Default accepted\r\nPlease specify optimization flags to use during compilation when bazel option \"--config=opt\" is specified [Default is -march=native -Wno-sign-compare]: Default accepted\r\nWould you like to interactively configure ./WORKSPACE for Android builds? [y/N]: N\r\nNot configuring the WORKSPACE for Android builds.\r\nConfiguration finished.\r\nbazel build --config=opt --config=cuda //tensorflow/tools/pip_package:build_pip_package\r\n```\r\nBuild fails with the above messages.\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\nI have noticed in the past that builds can sometimes build with different bazel versions.  I tried bazel 0.26.1, 1.0.0 and 2.0.0.  However the build still fails with all these bazel versions."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36168", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36168/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36168/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36168/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36168", "id": 554379456, "node_id": "MDU6SXNzdWU1NTQzNzk0NTY=", "number": 36168, "title": "@tf.custom_gradient does not behave as expected when used with @tf.function (for 2nd order derivatives)", "user": {"login": "maxiwelian", "id": 33183718, "node_id": "MDQ6VXNlcjMzMTgzNzE4", "avatar_url": "https://avatars2.githubusercontent.com/u/33183718?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maxiwelian", "html_url": "https://github.com/maxiwelian", "followers_url": "https://api.github.com/users/maxiwelian/followers", "following_url": "https://api.github.com/users/maxiwelian/following{/other_user}", "gists_url": "https://api.github.com/users/maxiwelian/gists{/gist_id}", "starred_url": "https://api.github.com/users/maxiwelian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maxiwelian/subscriptions", "organizations_url": "https://api.github.com/users/maxiwelian/orgs", "repos_url": "https://api.github.com/users/maxiwelian/repos", "events_url": "https://api.github.com/users/maxiwelian/events{/privacy}", "received_events_url": "https://api.github.com/users/maxiwelian/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1478826728, "node_id": "MDU6TGFiZWwxNDc4ODI2NzI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:core", "name": "comp:core", "color": "024391", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "allenlavoie", "id": 3731025, "node_id": "MDQ6VXNlcjM3MzEwMjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3731025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allenlavoie", "html_url": "https://github.com/allenlavoie", "followers_url": "https://api.github.com/users/allenlavoie/followers", "following_url": "https://api.github.com/users/allenlavoie/following{/other_user}", "gists_url": "https://api.github.com/users/allenlavoie/gists{/gist_id}", "starred_url": "https://api.github.com/users/allenlavoie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allenlavoie/subscriptions", "organizations_url": "https://api.github.com/users/allenlavoie/orgs", "repos_url": "https://api.github.com/users/allenlavoie/repos", "events_url": "https://api.github.com/users/allenlavoie/events{/privacy}", "received_events_url": "https://api.github.com/users/allenlavoie/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "allenlavoie", "id": 3731025, "node_id": "MDQ6VXNlcjM3MzEwMjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3731025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allenlavoie", "html_url": "https://github.com/allenlavoie", "followers_url": "https://api.github.com/users/allenlavoie/followers", "following_url": "https://api.github.com/users/allenlavoie/following{/other_user}", "gists_url": "https://api.github.com/users/allenlavoie/gists{/gist_id}", "starred_url": "https://api.github.com/users/allenlavoie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allenlavoie/subscriptions", "organizations_url": "https://api.github.com/users/allenlavoie/orgs", "repos_url": "https://api.github.com/users/allenlavoie/repos", "events_url": "https://api.github.com/users/allenlavoie/events{/privacy}", "received_events_url": "https://api.github.com/users/allenlavoie/received_events", "type": "User", "site_admin": false}, {"login": "saxenasaurabh", "id": 3967488, "node_id": "MDQ6VXNlcjM5Njc0ODg=", "avatar_url": "https://avatars0.githubusercontent.com/u/3967488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saxenasaurabh", "html_url": "https://github.com/saxenasaurabh", "followers_url": "https://api.github.com/users/saxenasaurabh/followers", "following_url": "https://api.github.com/users/saxenasaurabh/following{/other_user}", "gists_url": "https://api.github.com/users/saxenasaurabh/gists{/gist_id}", "starred_url": "https://api.github.com/users/saxenasaurabh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saxenasaurabh/subscriptions", "organizations_url": "https://api.github.com/users/saxenasaurabh/orgs", "repos_url": "https://api.github.com/users/saxenasaurabh/repos", "events_url": "https://api.github.com/users/saxenasaurabh/events{/privacy}", "received_events_url": "https://api.github.com/users/saxenasaurabh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-01-23T20:08:59Z", "updated_at": "2020-02-21T18:43:50Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 18.04\r\n\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: 2.2.0-dev20200123 (observed in other versions)\r\n- **Python version**: 3.7.6\r\n\r\n\r\n\r\n- **CUDA/cuDNN version**: These are examples of versions though this has been replicated in other versions of cuda/cudnn\r\n```\r\nCUDA Version 10.1.243\r\n\r\n#define CUDNN_MAJOR 7\r\n#define CUDNN_MINOR 6\r\n#define CUDNN_PATCHLEVEL 4\r\n--\r\n#define CUDNN_VERSION (CUDNN_MAJOR * 1000 + CUDNN_MINOR * 100 + CUDNN_PATCHLEVEL)\r\n\r\n\r\n- **GPU model and memory**: \r\n+-----------------------------------------------------------------------------+\r\n| NVIDIA-SMI 440.33.01    Driver Version: 440.33.01    CUDA Version: 10.1     |\r\n|-------------------------------+----------------------+----------------------+\r\n| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\r\n|===============================+======================+======================|\r\n|   0  Quadro P3200        On   | 00000000:01:00.0 Off |                  N/A |\r\n| N/A   53C    P5     9W /  N/A |   5949MiB /  6078MiB |     10%      Default |\r\n+-------------------------------+----------------------+----------------------+\r\n```\r\n\r\n- **Exact command to reproduce**:\r\n```\r\nimport tensorflow as tf\r\n\r\nprint(tf.__version__)\r\n\r\n@tf.function\r\n@tf.custom_gradient\r\ndef _fn2(a, logdet_a):\r\n\r\n    def sec_order_grad(a_dash): # bug still appears if this fn outside custom grad call\r\n        return a_dash * 5., tf.ones_like(logdet_a) * 2.\r\n    \r\n    return a, sec_order_grad\r\n\r\n@tf.function\r\n@tf.custom_gradient\r\ndef fwd(a):\r\n    sign_a, logdet_a = tf.linalg.slogdet(a)\r\n\r\n#     logdet_a = tf.stop_gradient(logdet_a) # include to function\r\n    def grad(dy):\r\n        da = _fn2(a, logdet_a)\r\n        return dy * da\r\n\r\n    return 1., grad\r\n\r\nndim = 2\r\n\r\ndef call_gradient_1st():\r\n    a = tf.zeros((ndim, ndim))\r\n    with tf.GradientTape() as g:\r\n        g.watch(a)\r\n        y = fwd(a)\r\n    z = g.gradient(y, a)\r\n    return y, z\r\n\r\n\r\ndef call_gradient_2nd():\r\n    a = tf.zeros((ndim, ndim))\r\n    with tf.GradientTape() as g:\r\n        g.watch(a)\r\n        with tf.GradientTape() as gg:\r\n            gg.watch(a)\r\n            y = fwd(a)\r\n        z = gg.gradient(y, a)\r\n    gg = g.gradient(z, a)\r\n    return y, z, gg\r\n\r\ny, z = call_gradient_1st()\r\nprint(y, z)\r\ny, z, gg = call_gradient_2nd()\r\nprint(y, z, gg)\r\n```\r\n\r\n### Describe the problem\r\n\r\nAutograd attempts to call the gradient of a variable inside a custom gradient function. If the gradient is not computable (i.e. in this case when logdet has inf values) then it crashes. \r\n\r\nThis only appears in the second order (see trace: first order calls, second order doesn't).\r\n\r\nThis doesn't appear if we stop the gradient (see note in function 'fwd').\r\n\r\nThis doesn't appear if we *do not* use the @tf.function wrapper.\r\n\r\n### Source code / logs\r\n```\r\n2.2.0-dev20200123\r\ntf.Tensor(1.0, shape=(), dtype=float32) tf.Tensor(\r\n[[0. 0.]\r\n [0. 0.]], shape=(2, 2), dtype=float32)\r\n\r\n---------------------------------------------------------------------------\r\nInvalidArgumentError                      Traceback (most recent call last)\r\n<ipython-input-6-af7d2f010d71> in <module>\r\n     48 y, z = call_gradient_1st()\r\n     49 print(y, z)\r\n---> 50 y, z, gg = call_gradient_2nd()\r\n     51 print(y, z, gg)\r\n\r\n<ipython-input-6-af7d2f010d71> in call_gradient_2nd()\r\n     42             gg.watch(a)\r\n     43             y = fwd(a)\r\n---> 44         z = gg.gradient(y, a)\r\n     45     gg = g.gradient(z, a)\r\n     46     return y, z, gg\r\n\r\n~/anaconda3/envs/fermi21/lib/python3.7/site-packages/tensorflow_core/python/eager/backprop.py in gradient(self, target, sources, output_gradients, unconnected_gradients)\r\n   1032         output_gradients=output_gradients,\r\n   1033         sources_raw=flat_sources_raw,\r\n-> 1034         unconnected_gradients=unconnected_gradients)\r\n   1035 \r\n   1036     if not self._persistent:\r\n\r\n~/anaconda3/envs/fermi21/lib/python3.7/site-packages/tensorflow_core/python/eager/imperative_grad.py in imperative_grad(tape, target, sources, output_gradients, sources_raw, unconnected_gradients)\r\n     75       output_gradients,\r\n     76       sources_raw,\r\n---> 77       compat.as_str(unconnected_gradients.value))\r\n\r\n~/anaconda3/envs/fermi21/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py in _backward_function_wrapper(*args)\r\n   1303           break\r\n   1304       return backward._call_flat(  # pylint: disable=protected-access\r\n-> 1305           processed_args, remapped_captures)\r\n   1306 \r\n   1307     return _backward_function_wrapper, recorded_outputs\r\n\r\n~/anaconda3/envs/fermi21/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py in _call_flat(self, args, captured_inputs, cancellation_manager)\r\n   1748       flat_outputs = forward_function.call(\r\n   1749           ctx, args_with_tangents,\r\n-> 1750           cancellation_manager=cancellation_manager)\r\n   1751     else:\r\n   1752       with ops.get_default_graph()._override_gradient_function(  # pylint: disable=protected-access\r\n\r\n~/anaconda3/envs/fermi21/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py in call(self, ctx, args, cancellation_manager)\r\n    596               inputs=args,\r\n    597               attrs=attrs,\r\n--> 598               ctx=ctx)\r\n    599         else:\r\n    600           outputs = execute.execute_with_cancellation(\r\n\r\n~/anaconda3/envs/fermi21/lib/python3.7/site-packages/tensorflow_core/python/eager/execute.py in quick_execute(op_name, num_outputs, inputs, attrs, ctx, name)\r\n     58     ctx.ensure_initialized()\r\n     59     tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,\r\n---> 60                                         inputs, attrs, num_outputs)\r\n     61   except core._NotOkStatusException as e:\r\n     62     if name is not None:\r\n\r\nInvalidArgumentError: 2 root error(s) found.\r\n  (0) Invalid argument:  Input is not invertible.\r\n\t [[node gradients/LogMatrixDeterminant_grad/MatrixInverse (defined at <ipython-input-6-af7d2f010d71>:43) ]]\r\n\t [[gradients/grad_ys_0/_4]]\r\n  (1) Invalid argument:  Input is not invertible.\r\n\t [[node gradients/LogMatrixDeterminant_grad/MatrixInverse (defined at <ipython-input-6-af7d2f010d71>:43) ]]\r\n0 successful operations.\r\n0 derived errors ignored. [Op:__forward___backward_fwd_655_746]\r\n\r\nFunction call stack:\r\n__backward_fwd_655 -> __backward_fwd_655\r\n```\r\n\r\nThanks for any insight!\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36164", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36164/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36164/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36164/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36164", "id": 554318070, "node_id": "MDU6SXNzdWU1NTQzMTgwNzA=", "number": 36164, "title": "Memory leaks when doing a random tf.op on a previously converted to NumPy Tensor in TF2.1 ", "user": {"login": "lerobitaille", "id": 59838807, "node_id": "MDQ6VXNlcjU5ODM4ODA3", "avatar_url": "https://avatars2.githubusercontent.com/u/59838807?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lerobitaille", "html_url": "https://github.com/lerobitaille", "followers_url": "https://api.github.com/users/lerobitaille/followers", "following_url": "https://api.github.com/users/lerobitaille/following{/other_user}", "gists_url": "https://api.github.com/users/lerobitaille/gists{/gist_id}", "starred_url": "https://api.github.com/users/lerobitaille/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lerobitaille/subscriptions", "organizations_url": "https://api.github.com/users/lerobitaille/orgs", "repos_url": "https://api.github.com/users/lerobitaille/repos", "events_url": "https://api.github.com/users/lerobitaille/events{/privacy}", "received_events_url": "https://api.github.com/users/lerobitaille/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-01-23T18:06:55Z", "updated_at": "2020-03-03T19:07:37Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: Nope\r\n- TensorFlow installed from (source or binary): binary (docker image)\r\n- TensorFlow version (use command below): 2.1.0\r\n- Python version: 3.6\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source): N/A\r\n- CUDA/cuDNN version: 10.1\r\n- GPU model and memory: GeForce GTX TITAN X (12Go)\r\n\r\n**Describe the current behavior**\r\n\r\nWhen converting a Tensor to NumPy before doing a random operation, there is a quite intense memory leak. Intriguingly, if we do not set a general seed or if we don't convert to numpy before doing the random operation, the leak is not happening. I really don't see why this is happening. I'm maybe doing something wrong, but I'm sceptical about it, the example code below being very very simple.\r\n\r\n**Describe the expected behavior**\r\n\r\nThere should not be a leak.\r\n\r\n**Code to reproduce the issue**\r\n\r\nHere is a script that uses [memory-profiler](https://pypi.org/project/memory-profiler/) to profile memory in each functions. \r\n\r\nTo generate the profiling data: \r\n\r\n`mprof run --python <script-name>`\r\n\r\nTo generate the figure below:\r\n\r\n`mprof plot -o <figure-name>` \r\n\r\n```python\r\n\"\"\"This script aims to show the memory leak that exists when tf has a\r\ngeneral seed and a conversion to numpy is done.\r\n\"\"\"\r\n\r\nimport os\r\nimport random\r\n\r\nimport numpy as np\r\nimport tensorflow as tf\r\nimport tqdm\r\n\r\n\r\ndef transform_with_numpy():\r\n    def transform(x):\r\n        x = x.numpy() # Get a numpy version of x\r\n        # Some NumPy operations here\r\n        x = tf.cast(x, tf.float32) # Repass to tf version of x\r\n        # A random TF function\r\n        x = tf.image.random_contrast(x, 0.1, 0.8)\r\n        return x\r\n    return transform\r\n\r\n\r\ndef transform_with_tf():\r\n    def transform(x):\r\n        # Some TF operations here\r\n        x = tf.cast(x, tf.float32) # Recast, just to isolate cause\r\n        x = tf.image.random_contrast(x, 0.1, 0.8)\r\n        return x\r\n    return transform\r\n\r\n\r\ndef get_example(T):\r\n    example = tf.cast(np.random.rand(224, 224), tf.float32)[tf.newaxis]\r\n    return T(example)\r\n\r\n\r\n#-----------------------------------------------------------------------\r\n\r\n\r\n@profile\r\ndef function_with_conversion():\r\n    T = transform_with_numpy()\r\n    print(f'function_with_conversion')\r\n    for i in tqdm.tqdm(range(1000)):\r\n        examples = [get_example(T) for i in range(32)]\r\n\r\n\r\n@profile\r\ndef function_with_seed():\r\n    np.random.seed(100)\r\n    random.seed(100)\r\n    tf.random.set_seed(100)\r\n    T = transform_with_tf()\r\n    print(f'function_with_seed')\r\n    for i in tqdm.tqdm(range(1000)):\r\n        examples = [get_example(T) for i in range(32)]\r\n\r\n\r\n@profile\r\ndef function_with_seed_and_conversion():\r\n    np.random.seed(100)\r\n    random.seed(100)\r\n    tf.random.set_seed(100)\r\n    T = transform_with_numpy()\r\n    print(f'function_with_seed_and_conversion')\r\n    for i in tqdm.tqdm(range(1000)):\r\n        examples = [get_example(T) for i in range(32)]\r\n\r\n\r\nif __name__ == '__main__':\r\n    # Disable INFO and WARNING tf messages\r\n    os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'\r\n\r\n    # Sets the memory growth, experimental...\r\n    physical_devices = tf.config.experimental.list_physical_devices('GPU')\r\n    if physical_devices:\r\n        tf.config.experimental.set_memory_growth(physical_devices[0], True)\r\n\r\n    function_with_conversion()\r\n    function_with_seed()\r\n    function_with_seed_and_conversion()\r\n```\r\n\r\n**Other info / logs**\r\n\r\n![test_mem_leak_2](https://user-images.githubusercontent.com/59838807/73010435-6aae5500-3de0-11ea-8615-1887894d7594.png)\r\n\r\n**Maybe related to**\r\n- https://github.com/tensorflow/tensorflow/issues/36034\r\n- https://github.com/tensorflow/tensorflow/issues/30873\r\n\r\n**EDIT:** \r\n\r\nAfter running the script a few more times, the output of the memory profiling data is more random than I thought. The second time I run the script, the leak disappears from the third function, but there seem to be a problem with the second function:\r\n\r\n![test_mem_leak_all_seed2](https://user-images.githubusercontent.com/59838807/73025706-0ac6a700-3dfe-11ea-9031-592d829af162.png)\r\n\r\nThen, I change the size of the examples to be (112, 112) and the leak reappears in the third function:\r\n\r\n![test_mem_leak_7](https://user-images.githubusercontent.com/59838807/73025808-41042680-3dfe-11ea-8730-f70024673baa.png)\r\n\r\nThen I rerun the code with (224, 224) sized examples and the leak reappears here as well:\r\n\r\n![test_mem_leak_all_seed1](https://user-images.githubusercontent.com/59838807/73025871-5bd69b00-3dfe-11ea-974a-5de5f24fc897.png)\r\n\r\n**EDIT 2:**\r\n\r\nThe memory leak is actually also there where the seed is set but no conversion is made. The conversion only makes it worst. For more details see [this repo](https://github.com/lerobitaille/tf-issue-36164-workaround).   "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36161", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36161/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36161/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36161/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36161", "id": 554301408, "node_id": "MDU6SXNzdWU1NTQzMDE0MDg=", "number": 36161, "title": "Logic Error in memory planner", "user": {"login": "namitajadhav", "id": 60232974, "node_id": "MDQ6VXNlcjYwMjMyOTc0", "avatar_url": "https://avatars2.githubusercontent.com/u/60232974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/namitajadhav", "html_url": "https://github.com/namitajadhav", "followers_url": "https://api.github.com/users/namitajadhav/followers", "following_url": "https://api.github.com/users/namitajadhav/following{/other_user}", "gists_url": "https://api.github.com/users/namitajadhav/gists{/gist_id}", "starred_url": "https://api.github.com/users/namitajadhav/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/namitajadhav/subscriptions", "organizations_url": "https://api.github.com/users/namitajadhav/orgs", "repos_url": "https://api.github.com/users/namitajadhav/repos", "events_url": "https://api.github.com/users/namitajadhav/events{/privacy}", "received_events_url": "https://api.github.com/users/namitajadhav/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "srjoglekar246", "id": 2099293, "node_id": "MDQ6VXNlcjIwOTkyOTM=", "avatar_url": "https://avatars3.githubusercontent.com/u/2099293?v=4", "gravatar_id": "", "url": "https://api.github.com/users/srjoglekar246", "html_url": "https://github.com/srjoglekar246", "followers_url": "https://api.github.com/users/srjoglekar246/followers", "following_url": "https://api.github.com/users/srjoglekar246/following{/other_user}", "gists_url": "https://api.github.com/users/srjoglekar246/gists{/gist_id}", "starred_url": "https://api.github.com/users/srjoglekar246/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/srjoglekar246/subscriptions", "organizations_url": "https://api.github.com/users/srjoglekar246/orgs", "repos_url": "https://api.github.com/users/srjoglekar246/repos", "events_url": "https://api.github.com/users/srjoglekar246/events{/privacy}", "received_events_url": "https://api.github.com/users/srjoglekar246/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "srjoglekar246", "id": 2099293, "node_id": "MDQ6VXNlcjIwOTkyOTM=", "avatar_url": "https://avatars3.githubusercontent.com/u/2099293?v=4", "gravatar_id": "", "url": "https://api.github.com/users/srjoglekar246", "html_url": "https://github.com/srjoglekar246", "followers_url": "https://api.github.com/users/srjoglekar246/followers", "following_url": "https://api.github.com/users/srjoglekar246/following{/other_user}", "gists_url": "https://api.github.com/users/srjoglekar246/gists{/gist_id}", "starred_url": "https://api.github.com/users/srjoglekar246/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/srjoglekar246/subscriptions", "organizations_url": "https://api.github.com/users/srjoglekar246/orgs", "repos_url": "https://api.github.com/users/srjoglekar246/repos", "events_url": "https://api.github.com/users/srjoglekar246/events{/privacy}", "received_events_url": "https://api.github.com/users/srjoglekar246/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2020-01-23T17:31:59Z", "updated_at": "2020-02-21T18:47:21Z", "closed_at": null, "author_association": "NONE", "body": "Host OS Platform and Distribution \r\nNAME=\"Ubuntu\"\r\nVERSION=\"18.04 LTS\"\r\nID=ubuntu\r\nPRETTY_NAME=\"Ubuntu 18.04 LTS\"\r\nVERSION_ID=\"18.04\"\r\nPython versionL 2.7.15+\r\nTarget platform : K64F\r\n\r\nDescribe the problem\r\nI am trying to deploy a GRU model on the ARM Cortex M board(K64F). During memory allocation of the tensor, I get the following error message. I don't understand the error.\r\nIt would be quite helpful if somebody knows the solution or an explanation for this following error report.\r\n\r\n```\r\nLogic error in memory planner, tensor 17 has an invalid lifetime\r\nAllocateTensors() failed\r\n```\r\n\r\nThank You"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36155", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36155/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36155/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36155/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36155", "id": 554116804, "node_id": "MDU6SXNzdWU1NTQxMTY4MDQ=", "number": 36155, "title": "Memory leak in Tensorflow Graph on CPU", "user": {"login": "yutkin", "id": 2982775, "node_id": "MDQ6VXNlcjI5ODI3NzU=", "avatar_url": "https://avatars3.githubusercontent.com/u/2982775?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yutkin", "html_url": "https://github.com/yutkin", "followers_url": "https://api.github.com/users/yutkin/followers", "following_url": "https://api.github.com/users/yutkin/following{/other_user}", "gists_url": "https://api.github.com/users/yutkin/gists{/gist_id}", "starred_url": "https://api.github.com/users/yutkin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yutkin/subscriptions", "organizations_url": "https://api.github.com/users/yutkin/orgs", "repos_url": "https://api.github.com/users/yutkin/repos", "events_url": "https://api.github.com/users/yutkin/events{/privacy}", "received_events_url": "https://api.github.com/users/yutkin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "penpornk", "id": 38085909, "node_id": "MDQ6VXNlcjM4MDg1OTA5", "avatar_url": "https://avatars3.githubusercontent.com/u/38085909?v=4", "gravatar_id": "", "url": "https://api.github.com/users/penpornk", "html_url": "https://github.com/penpornk", "followers_url": "https://api.github.com/users/penpornk/followers", "following_url": "https://api.github.com/users/penpornk/following{/other_user}", "gists_url": "https://api.github.com/users/penpornk/gists{/gist_id}", "starred_url": "https://api.github.com/users/penpornk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/penpornk/subscriptions", "organizations_url": "https://api.github.com/users/penpornk/orgs", "repos_url": "https://api.github.com/users/penpornk/repos", "events_url": "https://api.github.com/users/penpornk/events{/privacy}", "received_events_url": "https://api.github.com/users/penpornk/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "penpornk", "id": 38085909, "node_id": "MDQ6VXNlcjM4MDg1OTA5", "avatar_url": "https://avatars3.githubusercontent.com/u/38085909?v=4", "gravatar_id": "", "url": "https://api.github.com/users/penpornk", "html_url": "https://github.com/penpornk", "followers_url": "https://api.github.com/users/penpornk/followers", "following_url": "https://api.github.com/users/penpornk/following{/other_user}", "gists_url": "https://api.github.com/users/penpornk/gists{/gist_id}", "starred_url": "https://api.github.com/users/penpornk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/penpornk/subscriptions", "organizations_url": "https://api.github.com/users/penpornk/orgs", "repos_url": "https://api.github.com/users/penpornk/repos", "events_url": "https://api.github.com/users/penpornk/events{/privacy}", "received_events_url": "https://api.github.com/users/penpornk/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2020-01-23T12:06:00Z", "updated_at": "2020-03-10T15:24:31Z", "closed_at": null, "author_association": "NONE", "body": "I have a Face Detector that I'm trying to use for inference in Golang via official [Tensorflow bindings](https://godoc.org/github.com/tensorflow/tensorflow/tensorflow/go). However, I faced a stepwise memory leak that causes the killing of an application due to OOM.\r\n\r\n\r\n# Screenshot with the leak:\r\n![image](https://user-images.githubusercontent.com/2982775/72971506-d8f01900-3dda-11ea-8b7e-8057879f15de.png)\r\n\r\nHeap samples from pprof does not show anything interesting in Go code. It looks like the leak on C++ backend side:\r\n```\r\ngo tool pprof http://localhost:8200/debug/pprof/heap\r\nFetching profile over HTTP from http://localhost:8200/debug/pprof/heap\r\nSaved profile in /pprof.facedetector.alloc_objects.alloc_space.inuse_objects.inuse_space.073.pb.gz\r\nFile: facedetector\r\nBuild ID: c4dba901e690718468bdd4fa7d1a631daca9e65a\r\nType: inuse_space\r\nTime: Jan 22, 2020 at 11:44pm (MSK)\r\nEntering interactive mode (type \"help\" for commands, \"o\" for options)\r\n(pprof)\r\n(pprof) top20\r\nShowing nodes accounting for 1861.64kB, 100% of 1861.64kB total\r\n      flat  flat%   sum%        cum   cum%\r\n  930.82kB 50.00% 50.00%   930.82kB 50.00%  bytes.makeSlice\r\n  930.82kB 50.00%   100%   930.82kB 50.00%  main.(*FaceDetector).FindFaces\r\n         0     0%   100%   930.82kB 50.00%  bytes.(*Buffer).Grow\r\n         0     0%   100%   930.82kB 50.00%  bytes.(*Buffer).grow\r\n         0     0%   100%   930.82kB 50.00%  io/ioutil.ReadFile\r\n         0     0%   100%   930.82kB 50.00%  io/ioutil.readAll\r\n         0     0%   100%  1861.64kB   100%  main.main\r\n         0     0%   100%  1861.64kB   100%  runtime.main\r\n```\r\n\r\n\r\n# Code to reproduce the issue\r\nThis code just reading an image from a file system in a for-loop and feed it to the model.\r\n\r\n```go\r\npackage main\r\n\r\nimport (\r\n\t\"io/ioutil\"\r\n\t\"log\"\r\n\ttf \"github.com/tensorflow/tensorflow/tensorflow/go\"\r\n\t\"net/http\"\r\n\t_ \"net/http/pprof\"\r\n)\r\n\r\ntype FaceDetector struct {\r\n\tsession         *tf.Session\r\n\tgraph           *tf.Graph\r\n\r\n\tinputOp  tf.Output\r\n\tbboxesOp tf.Output\r\n\tscoresOp tf.Output\r\n}\r\n\r\nfunc NewFaceDetector(frozenGraphPath string) (*FaceDetector, error) {\r\n\tfd := &FaceDetector{}\r\n\tmodel, err := ioutil.ReadFile(frozenGraphPath)\r\n\tif err != nil {\r\n\t\treturn nil, err\r\n\t}\r\n\r\n\tfd.graph = tf.NewGraph()\r\n\tif err := fd.graph.Import(model, \"\"); err != nil {\r\n\t\treturn nil, err\r\n\t}\r\n\r\n\tfd.session, err = tf.NewSession(fd.graph, nil)\r\n\tif err != nil {\r\n\t\treturn nil, err\r\n\t}\r\n\r\n\tfd.inputOp = fd.graph.Operation(\"input_image\").Output(0)\r\n\tfd.bboxesOp = fd.graph.Operation(\"bboxes\").Output(0)\r\n\tfd.scoresOp = fd.graph.Operation(\"scores_1/GatherV2\").Output(0)\r\n\r\n\treturn fd, nil\r\n}\r\n\r\nfunc (fd *FaceDetector) Close() error {\r\n\tif err := fd.session.Close(); err != nil {\r\n\t\treturn err\r\n\t}\r\n\treturn nil\r\n}\r\n\r\nfunc (fd *FaceDetector) FindFaces(image []byte) ([]float32, [][]int32, error) {\r\n\timageTensor, err := tf.NewTensor(string(image))\r\n\tif err != nil {\r\n\t\treturn nil, nil, err\r\n\t}\r\n\r\n\toutput, err := fd.session.Run(\r\n\t\tmap[tf.Output]*tf.Tensor{\r\n\t\t\tfd.inputOp: imageTensor,\r\n\t\t},\r\n\t\t[]tf.Output{\r\n\t\t\tfd.bboxesOp,\r\n\t\t\tfd.scoresOp,\r\n\t\t},\r\n\t\tnil)\r\n\r\n\tif err != nil {\r\n\t\treturn nil, nil, err\r\n\t}\r\n\r\n\tbboxes := output[0].Value().([][]int32)\r\n\tscores := output[1].Value().([]float32)\r\n\r\n\treturn scores, bboxes, nil\r\n}\r\n\r\nfunc main() {\r\n\tlog.SetFlags(log.LstdFlags | log.Lshortfile | log.Lmicroseconds)\r\n\r\n\tgo func() {\r\n\t\tlog.Println(http.ListenAndServe(\"0.0.0.0:8200\", nil))\r\n\t}()\r\n\r\n\tfd, err := NewFaceDetector(\"OptimizedGraph.pb\")\r\n\r\n\tif err != nil {\r\n\t\tpanic(err)\r\n\t}\r\n\r\n\tdefer fd.Close()\r\n\r\n\tfor {\r\n\t\timg, err := ioutil.ReadFile(\"photo.jpg\")\r\n\r\n\t\tif err != nil {\r\n\t\t\tlog.Println(\"Fail to read image:\", err)\r\n\t\t}\r\n\r\n\t\tscores, boxes, err := fd.FindFaces(img)\r\n\r\n\t\tif err != nil {\r\n\t\t\tlog.Println(\"Fail to infer:\", err)\r\n\t\t}\r\n\r\n\t\tlog.Println(scores, boxes)\r\n\t}\r\n}\r\n\r\n```\r\n\r\n\r\n# System information\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): **Yes**.\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): **Ubuntu-based Docker images**\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: **Not tested**\r\n- TensorFlow installed from (source or binary): **Binary/Pre-compiled** (https://storage.googleapis.com/tensorflow/libtensorflow/libtensorflow-cpu-linux-x86_64-1.15.0.tar.gz)\r\n- TensorFlow version (use command below): **1.15.0**\r\n- Python version: -\r\n- Bazel version (if compiling from source): -\r\n- GCC/Compiler version (if compiling from source): -\r\n- CUDA/cuDNN version: -\r\n- GPU model and memory: -\r\n- Golang version: **1.13**\r\n\r\n**photo.jpg:** https://user-images.githubusercontent.com/2982775/72982648-96393b80-3df0-11ea-807f-c4979b4c3af2.jpg\r\n**TF Graph:** [graph.zip](https://github.com/tensorflow/tensorflow/files/4102930/graph.zip)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36154", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36154/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36154/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36154/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36154", "id": 554094379, "node_id": "MDU6SXNzdWU1NTQwOTQzNzk=", "number": 36154, "title": "Error while converting to quantized tflite.", "user": {"login": "shashank-industrail", "id": 55377244, "node_id": "MDQ6VXNlcjU1Mzc3MjQ0", "avatar_url": "https://avatars2.githubusercontent.com/u/55377244?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shashank-industrail", "html_url": "https://github.com/shashank-industrail", "followers_url": "https://api.github.com/users/shashank-industrail/followers", "following_url": "https://api.github.com/users/shashank-industrail/following{/other_user}", "gists_url": "https://api.github.com/users/shashank-industrail/gists{/gist_id}", "starred_url": "https://api.github.com/users/shashank-industrail/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shashank-industrail/subscriptions", "organizations_url": "https://api.github.com/users/shashank-industrail/orgs", "repos_url": "https://api.github.com/users/shashank-industrail/repos", "events_url": "https://api.github.com/users/shashank-industrail/events{/privacy}", "received_events_url": "https://api.github.com/users/shashank-industrail/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "suharshs", "id": 1450614, "node_id": "MDQ6VXNlcjE0NTA2MTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/1450614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suharshs", "html_url": "https://github.com/suharshs", "followers_url": "https://api.github.com/users/suharshs/followers", "following_url": "https://api.github.com/users/suharshs/following{/other_user}", "gists_url": "https://api.github.com/users/suharshs/gists{/gist_id}", "starred_url": "https://api.github.com/users/suharshs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suharshs/subscriptions", "organizations_url": "https://api.github.com/users/suharshs/orgs", "repos_url": "https://api.github.com/users/suharshs/repos", "events_url": "https://api.github.com/users/suharshs/events{/privacy}", "received_events_url": "https://api.github.com/users/suharshs/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "suharshs", "id": 1450614, "node_id": "MDQ6VXNlcjE0NTA2MTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/1450614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suharshs", "html_url": "https://github.com/suharshs", "followers_url": "https://api.github.com/users/suharshs/followers", "following_url": "https://api.github.com/users/suharshs/following{/other_user}", "gists_url": "https://api.github.com/users/suharshs/gists{/gist_id}", "starred_url": "https://api.github.com/users/suharshs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suharshs/subscriptions", "organizations_url": "https://api.github.com/users/suharshs/orgs", "repos_url": "https://api.github.com/users/suharshs/repos", "events_url": "https://api.github.com/users/suharshs/events{/privacy}", "received_events_url": "https://api.github.com/users/suharshs/received_events", "type": "User", "site_admin": false}, {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2020-01-23T11:17:57Z", "updated_at": "2020-02-19T03:27:05Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04.3 LTS\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (or github SHA if from source): 2.1.0\r\n- Python version : 3.5.6 anaconda\r\n\r\n**Describe the Problem**\r\nI implemented lite-weight custom model based on SSD Paper to detect just one Object, Person.\r\nI want to run that model on Coral EdgeTpu which is connected to Raspberry Pi 4 B.\r\nI follow this doc (https://coral.ai/docs/accelerator/get-started/)  to set up coral on rpi and \r\nfollow this doc (https://coral.ai/docs/edgetpu/compiler/) to install EdgeTpu Compiler on my laptop.\r\nWant to convert tflite to edgetpu_tflite, but tflite need to be quantized so follow that doc\r\n(https://www.tensorflow.org/lite/performance/post_training_integer_quant) to do that.\r\n\r\n**Command used to run the converter or code if you\u2019re using the Python API**\r\n\r\n```\r\nimport tensorflow as tf\r\nimport cv2\r\nimport numpy as np\r\nimport os\r\n\r\nconverter = tf.lite.TFLiteConverter.from_saved_model('./frozen_models/ssd_tf/')\r\n# fitst set the optimizations flag to optimize for size\r\nconverter.optimizations = [tf.lite.Optimize.OPTIMIZE_FOR_SIZE]\r\n\r\ntrain_data_dir = '/home/shashank/Documents/SSD7_tf/Training-data/test/'\r\n\r\nimages = []\r\nfor each_img in os.listdir(train_data_dir):\r\n    read_img = cv2.imread(train_data_dir + each_img).astype(np.float32)\r\n    norm_img = (read_img - np.min(read_img, axis=(0,1,2), keepdims=True))/ (np.max(read_img, axis=(0,1,2), keepdims=True) - np.min(read_img, axis=(0,1,2), keepdims=True))\r\n    images.append(norm_img)\r\n\r\nimages = np.array(images)\r\nimages_ds = tf.data.Dataset.from_tensor_slices((images)).batch(1)\r\n\r\ndef representative_data_gen():\r\n    for input_value in images_ds.take(100):\r\n        yield [input_value]\r\n\r\nconverter.representative_dataset = representative_data_gen\r\nconverter.target_spec.supported_ops = [tf.lite.OpsSet.TFLITE_BUILTINS_INT8]\r\nconverter.inference_input_type = tf.uint8\r\nconverter.inference_output_type = tf.uint8\r\n\r\ntflite_model_quant = converter.convert()\r\ntflite_model_quant_file = 'model_quant_io.tflite'\r\ntflite_model_quant_file.write_bytes(tflite_model_quant)\r\nprint('Done!')\r\n```\r\n\r\n**The output from the converter invocation**\r\n\r\n```\r\n2020-01-23 15:15:34.464864: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory\r\n2020-01-23 15:15:34.464958: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory\r\n2020-01-23 15:15:34.464974: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.\r\n2020-01-23 15:15:35.849036: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\r\n2020-01-23 15:15:35.849060: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)\r\n2020-01-23 15:15:35.849095: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (shashank): /proc/driver/nvidia/version does not exist\r\n2020-01-23 15:15:35.849245: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2020-01-23 15:15:35.873039: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 1800000000 Hz\r\n2020-01-23 15:15:35.873694: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559e284c8740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n2020-01-23 15:15:35.873733: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\n2020-01-23 15:15:38.481817: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 544320000 exceeds 10% of system memory.\r\n2020-01-23 15:15:38.675897: I tensorflow/core/grappler/devices.cc:55] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0\r\n2020-01-23 15:15:38.676034: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2020-01-23 15:15:38.717217: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: graph_to_optimize\r\n2020-01-23 15:15:38.717254: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: Graph size after: 543 nodes (474), 995 edges (926), time = 12.469ms.\r\n2020-01-23 15:15:38.717260: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: Graph size after: 543 nodes (0), 995 edges (0), time = 8.12ms.\r\n2020-01-23 15:15:38.717264: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_model_1_decoded_predictions_cond_true_2404_6083\r\n2020-01-23 15:15:38.717287: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-01-23 15:15:38.717290: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-23 15:15:38.717294: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_cond_1_false_2596_2599\r\n2020-01-23 15:15:38.717298: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-23 15:15:38.717301: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-23 15:15:38.717305: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_cond_false_2547_5852\r\n2020-01-23 15:15:38.717308: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-01-23 15:15:38.717312: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-23 15:15:38.717315: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_cond_true_2546_1326\r\n2020-01-23 15:15:38.717319: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-01-23 15:15:38.717323: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-23 15:15:38.717326: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_model_1_decoded_predictions_loop_over_batch_while_cond_2488_1300\r\n2020-01-23 15:15:38.717331: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-23 15:15:38.717335: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-23 15:15:38.717339: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_cond_2_false_2652_4375\r\n2020-01-23 15:15:38.717343: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-23 15:15:38.717346: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-01-23 15:15:38.717350: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_model_1_decoded_predictions_loop_over_batch_while_body_2489_5925\r\n2020-01-23 15:15:38.717354: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: Graph size after: 80 nodes (0), 85 edges (0), time = 1.227ms.\r\n2020-01-23 15:15:38.717357: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: Graph size after: 80 nodes (0), 85 edges (0), time = 1.357ms.\r\n2020-01-23 15:15:38.717361: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_cond_2_true_2651_2758\r\n2020-01-23 15:15:38.717365: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-01-23 15:15:38.717369: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-23 15:15:38.717372: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_cond_1_true_2595_4150\r\n2020-01-23 15:15:38.717377: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-23 15:15:38.717381: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-23 15:15:38.717384: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_model_1_decoded_predictions_cond_false_2405_759\r\n2020-01-23 15:15:38.717388: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-01-23 15:15:38.717392: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-23 15:15:39.008345: I tensorflow/core/grappler/devices.cc:55] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0\r\n2020-01-23 15:15:39.008521: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2020-01-23 15:15:39.071925: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: graph_to_optimize\r\n2020-01-23 15:15:39.071961: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 435 nodes (-60), 804 edges (-126), time = 21.02ms.\r\n2020-01-23 15:15:39.071983: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 435 nodes (0), 804 edges (0), time = 11.699ms.\r\n2020-01-23 15:15:39.071987: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_model_1_decoded_predictions_cond_true_2404_6083_frozen\r\n2020-01-23 15:15:39.071992: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 26 nodes (0), 24 edges (0), time = 0.477ms.\r\n2020-01-23 15:15:39.072011: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 26 nodes (0), 24 edges (0), time = 0.382ms.\r\n2020-01-23 15:15:39.072016: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_model_1_decoded_predictions_cond_false_2405_759_frozen\r\n2020-01-23 15:15:39.072020: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 22 nodes (0), 16 edges (0), time = 0.366ms.\r\n2020-01-23 15:15:39.072023: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 22 nodes (0), 16 edges (0), time = 0.293ms.\r\n2020-01-23 15:15:39.072026: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_cond_2_false_2652_4375_frozen\r\n2020-01-23 15:15:39.072030: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 22 nodes (0), 24 edges (0), time = 0.473ms.\r\n2020-01-23 15:15:39.072033: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 22 nodes (0), 24 edges (0), time = 0.391ms.\r\n2020-01-23 15:15:39.072037: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_cond_true_2546_1326_frozen\r\n2020-01-23 15:15:39.072040: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 4 nodes (-1), 1 edges (-1), time = 0.226ms.\r\n2020-01-23 15:15:39.072044: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 4 nodes (0), 1 edges (0), time = 0.066ms.\r\n2020-01-23 15:15:39.072047: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_model_1_decoded_predictions_loop_over_batch_while_cond_2488_1300_frozen\r\n2020-01-23 15:15:39.072051: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 14 nodes (0), 8 edges (0), time = 0.255ms.\r\n2020-01-23 15:15:39.072055: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 14 nodes (0), 8 edges (0), time = 0.179ms.\r\n2020-01-23 15:15:39.072059: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_cond_2_true_2651_2758_frozen\r\n2020-01-23 15:15:39.072062: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 11 nodes (0), 11 edges (0), time = 0.284ms.\r\n2020-01-23 15:15:39.072066: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 11 nodes (0), 11 edges (0), time = 0.188ms.\r\n2020-01-23 15:15:39.072069: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_cond_1_true_2595_4150_frozen\r\n2020-01-23 15:15:39.072073: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 4 nodes (-1), 1 edges (-1), time = 0.21ms.\r\n2020-01-23 15:15:39.072077: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 4 nodes (0), 1 edges (0), time = 0.078ms.\r\n2020-01-23 15:15:39.072081: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_cond_1_false_2596_2599_frozen\r\n2020-01-23 15:15:39.072084: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 39 nodes (0), 43 edges (0), time = 0.726ms.\r\n2020-01-23 15:15:39.072088: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 39 nodes (0), 43 edges (0), time = 0.745ms.\r\n2020-01-23 15:15:39.072092: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_model_1_decoded_predictions_loop_over_batch_while_body_2489_5925_frozen\r\n2020-01-23 15:15:39.072096: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 81 nodes (1), 87 edges (2), time = 2.628ms.\r\n2020-01-23 15:15:39.072100: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 81 nodes (0), 87 edges (0), time = 1.5ms.\r\n2020-01-23 15:15:39.072103: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_cond_false_2547_5852_frozen\r\n2020-01-23 15:15:39.072107: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 37 nodes (1), 41 edges (2), time = 1.256ms.\r\n2020-01-23 15:15:39.072111: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 37 nodes (0), 41 edges (0), time = 0.653ms.\r\nTraceback (most recent call last):\r\n  File \"generate_quant_tflite.py\", line 30, in <module>\r\n    tflite_model_quant = converter.convert()\r\n  File \"/home/shashank/ENTER/envs/dl_py35/lib/python3.5/site-packages/tensorflow_core/lite/python/lite.py\", line 464, in convert\r\n    **converter_kwargs)\r\n  File \"/home/shashank/ENTER/envs/dl_py35/lib/python3.5/site-packages/tensorflow_core/lite/python/convert.py\", line 457, in toco_convert_impl\r\n    enable_mlir_converter=enable_mlir_converter)\r\n  File \"/home/shashank/ENTER/envs/dl_py35/lib/python3.5/site-packages/tensorflow_core/lite/python/convert.py\", line 203, in toco_convert_protos\r\n    raise ConverterError(\"See console for info.\\n%s\\n%s\\n\" % (stdout, stderr))\r\ntensorflow.lite.python.convert.ConverterError: See console for info.\r\n2020-01-23 15:15:40.457472: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory\r\n2020-01-23 15:15:40.457547: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory\r\n2020-01-23 15:15:40.457557: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.\r\n2020-01-23 15:15:41.229352: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2020-01-23 15:15:41.253051: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 1800000000 Hz\r\n2020-01-23 15:15:41.253841: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f574b1d500 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n2020-01-23 15:15:41.253867: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\n2020-01-23 15:15:41.255187: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\r\n2020-01-23 15:15:41.255200: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)\r\n2020-01-23 15:15:41.255215: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (shashank): /proc/driver/nvidia/version does not exist\r\n2020-01-23 15:15:41.266040: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: StatelessIf\r\n2020-01-23 15:15:41.266100: F tensorflow/lite/toco/import_tensorflow.cc:114] Check failed: attr.value_case() == AttrValue::kType (1 vs. 6)\r\nFatal Python error: Aborted\r\n\r\nCurrent thread 0x00007f4c7a502740 (most recent call first):\r\n  File \"/home/shashank/ENTER/envs/dl_py35/lib/python3.5/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 56 in execute\r\n  File \"/home/shashank/ENTER/envs/dl_py35/lib/python3.5/site-packages/absl/app.py\", line 250 in _run_main\r\n  File \"/home/shashank/ENTER/envs/dl_py35/lib/python3.5/site-packages/absl/app.py\", line 299 in run\r\n  File \"/home/shashank/ENTER/envs/dl_py35/lib/python3.5/site-packages/tensorflow_core/python/platform/app.py\", line 40 in run\r\n  File \"/home/shashank/ENTER/envs/dl_py35/lib/python3.5/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 93 in main\r\n  File \"/home/shashank/ENTER/envs/dl_py35/bin/toco_from_protos\", line 8 in <module>\r\nAborted (core dumped)\r\n```\r\n\r\n**Also, please include a link to the saved model or GraphDef**\r\n\r\n```\r\nPlease copy and paste this link to browser.\r\n(https://github.com/tensorflow/tensorflow/files/4102761/tflite_bug_related_folder.zip)\r\nThis folder contains source code to generate the saved model folder.\r\nIt also contain saved model folder also.\r\nrun python ssd7_inference.py\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36153", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36153/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36153/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36153/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36153", "id": 554061791, "node_id": "MDU6SXNzdWU1NTQwNjE3OTE=", "number": 36153, "title": "MultiWorkerMirroredStrategy training does not work with multiple epochs", "user": {"login": "Flamefire", "id": 309017, "node_id": "MDQ6VXNlcjMwOTAxNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/309017?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Flamefire", "html_url": "https://github.com/Flamefire", "followers_url": "https://api.github.com/users/Flamefire/followers", "following_url": "https://api.github.com/users/Flamefire/following{/other_user}", "gists_url": "https://api.github.com/users/Flamefire/gists{/gist_id}", "starred_url": "https://api.github.com/users/Flamefire/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Flamefire/subscriptions", "organizations_url": "https://api.github.com/users/Flamefire/orgs", "repos_url": "https://api.github.com/users/Flamefire/repos", "events_url": "https://api.github.com/users/Flamefire/events{/privacy}", "received_events_url": "https://api.github.com/users/Flamefire/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2020-01-23T10:15:49Z", "updated_at": "2020-02-27T02:36:11Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Minor adaption of https://www.tensorflow.org/tutorials/distribute/multi_worker_with_keras\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): RHEL 7.5\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version (use command below):2.1.0\r\n- Python version: 3.7.4\r\n- Bazel version (if compiling from source): 0.29.1\r\n- GCC/Compiler version (if compiling from source): 8.3.0\r\n- CUDA/cuDNN version: 10.1\r\n- GPU model and memory: K80\r\n\r\n**Describe the current behavior**\r\n\r\nExecuting training over multiple epochs and workers as per the example fails with \"Empty training data\" and\r\n> WARNING:tensorflow:Your input ran out of data; interrupting training. Make sure that your dataset or generator can generate at least `steps_per_epoch * epochs` batches (in this case, 1407 batches). You may need to use the repeat() function when building your dataset.\r\n\r\n**Describe the expected behavior**\r\n\r\nRunning training over multiple epochs automatically repeats the training data\r\n\r\n**Code to reproduce the issue**\r\n\r\nPretty much the exact example code from the MultiWorkerDistributed tutorial:\r\n\r\n```\r\n#!/usr/bin/env python\r\n\r\nimport os\r\nimport json\r\nimport tensorflow_datasets as tfds\r\nimport tensorflow as tf\r\nfrom slurm_utils import create_tf_config\r\ntfds.disable_progress_bar()\r\n\r\nBUFFER_SIZE = 10000\r\nBATCH_SIZE = 64\r\n\r\n\r\ndef make_datasets_unbatched():\r\n    # Scaling MNIST data from (0, 255] to (0., 1.]\r\n    def scale(image, label):\r\n        image = tf.cast(image, tf.float32)\r\n        image /= 255\r\n        return image, label\r\n\r\n    datasets, info = tfds.load(name='mnist',\r\n                               with_info=True,\r\n                               as_supervised=True)\r\n\r\n    return datasets['train'].map(scale).cache().shuffle(BUFFER_SIZE)\r\n\r\n\r\ndef build_and_compile_cnn_model():\r\n    model = tf.keras.Sequential([\r\n        tf.keras.layers.Conv2D(32,\r\n                               3,\r\n                               activation='relu',\r\n                               input_shape=(28, 28, 1)),\r\n        tf.keras.layers.MaxPooling2D(),\r\n        tf.keras.layers.Flatten(),\r\n        tf.keras.layers.Dense(64, activation='relu'),\r\n        tf.keras.layers.Dense(10, activation='softmax')\r\n    ])\r\n    model.compile(loss=tf.keras.losses.sparse_categorical_crossentropy,\r\n                  optimizer=tf.keras.optimizers.SGD(learning_rate=0.001),\r\n                  metrics=['accuracy'])\r\n    return model\r\n\r\n\r\ntfConfig = create_tf_config(gpus_per_task=2)\r\nprint('Used Config: {}'.format(tfConfig))\r\nos.environ['TF_CONFIG'] = json.dumps(tfConfig)\r\n\r\nstrategy = tf.distribute.experimental.MultiWorkerMirroredStrategy()\r\nprint('Number of workers: {}\\nParameter devices: {}\\nWorkers: {}'.format(\r\n    strategy.num_replicas_in_sync, strategy.extended.parameter_devices,\r\n    strategy.extended.worker_devices))\r\n\r\n# Here the batch size scales up by number of workers since\r\n# `tf.data.Dataset.batch` expects the global batch size.\r\nGLOBAL_BATCH_SIZE = BATCH_SIZE * strategy.num_replicas_in_sync\r\nwith strategy.scope():\r\n    # Creation of dataset, and model building/compiling need to be within\r\n    # `strategy.scope()`.\r\n    train_datasets = make_datasets_unbatched().batch(GLOBAL_BATCH_SIZE)\r\n    multi_worker_model = build_and_compile_cnn_model()\r\n\r\nmulti_worker_model.fit(x=train_datasets, epochs=3)\r\n```\r\n\r\n**Other info / logs**\r\nThe above `create_tf_config` creates the following config from SLURM environment: `{'cluster': {'worker': ['taurusa9:8888']}, 'task': {'type': 'worker', 'index': 0, 'trial': 1}, 'job': None}`\r\n\r\n\r\nRunning with 1 epoch works without any other code changes"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36147", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36147/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36147/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36147/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36147", "id": 553928428, "node_id": "MDU6SXNzdWU1NTM5Mjg0Mjg=", "number": 36147, "title": "What factors influence training time through distributed strategy?", "user": {"login": "JiayuanSternLi", "id": 33815430, "node_id": "MDQ6VXNlcjMzODE1NDMw", "avatar_url": "https://avatars3.githubusercontent.com/u/33815430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JiayuanSternLi", "html_url": "https://github.com/JiayuanSternLi", "followers_url": "https://api.github.com/users/JiayuanSternLi/followers", "following_url": "https://api.github.com/users/JiayuanSternLi/following{/other_user}", "gists_url": "https://api.github.com/users/JiayuanSternLi/gists{/gist_id}", "starred_url": "https://api.github.com/users/JiayuanSternLi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JiayuanSternLi/subscriptions", "organizations_url": "https://api.github.com/users/JiayuanSternLi/orgs", "repos_url": "https://api.github.com/users/JiayuanSternLi/repos", "events_url": "https://api.github.com/users/JiayuanSternLi/events{/privacy}", "received_events_url": "https://api.github.com/users/JiayuanSternLi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-01-23T04:22:28Z", "updated_at": "2020-02-05T03:38:37Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\nYes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\nUbuntu 16.04\r\n- TensorFlow installed from (source or binary):\r\nSource\r\n- TensorFlow version (use command below):\r\nTF2.1.0\r\n- Python version:\r\nPython3.5\r\n- CUDA/cuDNN version:\r\ncuda10.1\r\n- GPU model and memory:\r\nv100 \r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nI tried to get the training time / epoch under [1, 2, 4, 8] GPUs with tf.distribute.MirroredStrategy. However, I got a very interesting result: the time cost is not only linear to the size fo dataset or GPU num, but also influenced by the training loop style, custom training loop or Keras API.\r\nHere is the result table I make. It's not a  serious experiment but hopefully, we could get some inspiration.\r\n![image](https://user-images.githubusercontent.com/33815430/72955745-25862500-3dd8-11ea-9e0f-ea8b00ab28db.png)\r\n\r\n\r\nSome key points should know beforehand\r\n1. I accumulate and average last 4 epochs out of total 5 epochs, since the first epoch always takes longer than the rest of epochs. \r\n2. loading styles are two: tfds.load() and the TFrecords loading recommended by tensorflow.\r\n3. For TFrecords loading style, I first converted original images into TFrecords files, and then using TFRecords loading.\r\n4. I promise shards number of TFrecords, global_total_batch_size, loading style don't affect training time greatly.\r\n5. I downloaded the original datasets of tf_flowers to my disk. The meaning of _n_ in tf_flowers * n are the times I copied and pasted.  The only purpose is to enlarge the size of the dataset.\r\n6. Please look at the rows of tf_fowers*n. With the size of the tf_flowers doubles, training time doubles with all GPU numbers. It makes sense and is same with our expectation.\r\n7. However, changing the dataset from tf_flowers to 10k dogs(my datasets including 10k dogs of 10 classes), but keep an equivalent size. The time doesn't change as expects. \r\ntf_flowers*8 and 10k dogs are in similar size but tf_flowers*8 takes 3 times longer than 10k dogs\r\ntf_flowers*20 and 10k dogs*2 are in similar size but tf_flowers*20 takes 3 times longer than 10k dogs*2\r\n8. Keras API performs strangely as well. GPU number doesn't affect the training time linearly\r\n\r\n\r\n**Describe the expected behavior**\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\nKeras API\r\n```python\r\nfrom __future__ import absolute_import\r\nfrom __future__ import division\r\nfrom __future__ import print_function\r\nfrom __future__ import unicode_literals\r\n\r\nimport tensorflow as tf\r\nimport tensorflow_datasets as tfds\r\nimport time\r\nimport datetime\r\n\r\nimport argparse\r\nimport sys\r\nimport shutil\r\nimport time\r\nimport os\r\nimport numpy as np\r\n\r\nfrom functools import partial\r\nfrom tensorflow.keras.layers import Input, Dense, Flatten, Conv2D, GlobalAveragePooling2D\r\nfrom tensorflow.keras import Model\r\nfrom tensorflow.keras.datasets.fashion_mnist import load_data\r\nimport tensorflow_datasets as tfds\r\nimport read_params\r\nfrom train_config import configure_model, configure_optimizer, configure_lossfunc\r\nfrom datasets.readtf_utils.dataset import get_dataset \r\nfrom datasets.readtf_utils.dataset import _parse_fn\r\n\r\nos.environ[\"CUDA_VISIBLE_DEVICES\"] = \"0,1,2,3,4,5,6,7\"\r\ngpus = tf.config.experimental.list_physical_devices('GPU')\r\nif gpus:\r\n  try:\r\n    # Currently, memory growth needs to be the same across GPUs\r\n    for gpu in gpus:\r\n      tf.config.experimental.set_memory_growth(gpu, True)\r\n    logical_gpus = tf.config.experimental.list_logical_devices('GPU')\r\n  except RuntimeError as e:\r\n    # Memory growth must be set before GPUs have been initialized\r\n    print(e)\r\n\r\n\r\nnum_epochs = 5\r\nbatch_size_per_replica = 128\r\nlearning_rate = 0.001\r\nsetting_GPUs_num = 8\r\ndevices = [\"/gpu:\"+str(i) for i in range(setting_GPUs_num)]\r\n\r\nstrategy = tf.distribute.MirroredStrategy(devices)\r\nGPUs_num = strategy.num_replicas_in_sync\r\nprint('Number of devices: %d' % GPUs_num)  # \u8f93\u51fa\u8bbe\u5907\u6570\u91cf\r\n\r\nbatch_size = batch_size_per_replica\r\n\r\n# \u8f7d\u5165\u6570\u636e\u96c6\u5e76\u9884\u5904\u7406\r\ndef resize(image, label):\r\n    image = tf.image.resize(image, [224, 224]) / 255.0\r\n    return image, label\r\n\r\n\r\n\r\nclass MyCustomCallback(tf.keras.callbacks.Callback):\r\n    def on_train_begin(self, logs={}):\r\n        self.train_begin = time.time()\r\n        self.times = []\r\n        # print('trian begins at {}'.format(self.train_begin))\r\n        # d\r\n\r\n    def on_epoch_begin(self, epoch, logs=None):\r\n        self.epoch_begin = time.time()\r\n        # print('epoch: {} begins at {}'.format(epoch, self.epoch_begin))\r\n\r\n    def on_epoch_end(self, epoch, logs=None):\r\n        self.epoch_end = time.time()\r\n        self.epoch = epoch\r\n        # print('epoch: {} ends at {}'.format(epoch, self.epoch_end))\r\n        self.times.append(self.epoch_end-self.epoch_begin)\r\n        print(\" epoch: {} takes: {}\".format(epoch, self.epoch_end-self.epoch_begin))\r\n\r\n    def on_train_end(self, epoch, logs=None):\r\n        self.train_end = time.time()\r\n        # print('training takes {} secs/epoch: '.format((self.train_end - self.train_begin)/self.epoch))\r\n        print('training takes average {:.2f} secs/epoch'.format(sum(self.times[1::]) / (self.epoch)))\r\n\r\n\r\n\r\ntfrecords_dir = \"/data121/lijiayuan/test/classify_flowers/datasets/\"\r\ndataset, _ = get_dataset(tfrecords_dir, subset=\"train\", batch_size=batch_size)\r\n\r\n\r\nif GPUs_num == 1:\r\n    model = tf.keras.applications.MobileNetV2()\r\n    model.compile(\r\n        optimizer=tf.keras.optimizers.SGD(learning_rate=learning_rate),\r\n        loss=tf.keras.losses.sparse_categorical_crossentropy,\r\n        metrics=[tf.keras.metrics.sparse_categorical_accuracy]\r\n    )\r\nelse:\r\n    with strategy.scope():\r\n        model = tf.keras.applications.MobileNetV2()\r\n        model.compile(\r\n            optimizer=tf.keras.optimizers.SGD(learning_rate=learning_rate),\r\n            loss=tf.keras.losses.sparse_categorical_crossentropy,\r\n            metrics=[tf.keras.metrics.sparse_categorical_accuracy]\r\n            # run_eagerly=False\r\n        )\r\n\r\n\r\nstart = time.time()\r\nmodel.fit(dataset, epochs=num_epochs, callbacks=[MyCustomCallback()])\r\nend = time.time()\r\n\r\nprint(\"{} GPUs takes {:.2f} secs/epoch = {:.2f} mins/epoch\".format(strategy.num_replicas_in_sync, \r\n                                                                    (end-start)/num_epochs, \r\n                                                                    (end-start)/60/num_epochs))\r\n\r\n```\r\n\r\nCustom training loop\r\n```python\r\nfrom __future__ import absolute_import, division, print_function, unicode_literals\r\n\r\n# Import TensorFlow\r\nimport tensorflow as tf\r\n\r\n# Helper libraries\r\nimport numpy as np\r\nimport os\r\nimport time\r\nimport tensorflow_datasets as tfds\r\nfrom datasets.readtf_utils.dataset import get_dataset \r\nfrom tensorflow.keras.layers import Input, Dense, Flatten, Conv2D, GlobalAveragePooling2D\r\n\r\n\r\n\r\nos.environ[\"CUDA_VISIBLE_DEVICES\"] = \"0,1,2,3,4,5,6,7\"\r\ngpus = tf.config.experimental.list_physical_devices('GPU')\r\nif gpus:\r\n  try:\r\n    # Currently, memory growth needs to be the same across GPUs\r\n    for gpu in gpus:\r\n      tf.config.experimental.set_memory_growth(gpu, True)\r\n    logical_gpus = tf.config.experimental.list_logical_devices('GPU')\r\n  except RuntimeError as e:\r\n    # Memory growth must be set before GPUs have been initialized\r\n    print(e)\r\n\r\n\r\n\r\ndef resize(image, label):\r\n    image = tf.image.resize(image, [224, 224]) / 255.0\r\n    return image, label\r\n\r\ndef assemble_model(num_classes, model_name='MobileNetV2'):\r\n    import tensorflow as tf \r\n    base_model = tf.keras.applications.ResNet50(input_shape=(224,224,3),\r\n                                                    weights='imagenet',\r\n                                                    include_top=False)\r\n    model = tf.keras.Sequential([\r\n                                base_model,\r\n                                GlobalAveragePooling2D(),\r\n                                Dense(num_classes, activation='softmax')\r\n                                ])\r\n    model.trainable = True\r\n    return model\r\n\r\n\r\nprint(tf.__version__)\r\n\r\nsetting_GPUs_num = 8\r\ndevices = [\"/gpu:\"+str(i) for i in range(setting_GPUs_num)]\r\n\r\nstrategy = tf.distribute.MirroredStrategy(devices)\r\nprint ('Number of devices: {}'.format(strategy.num_replicas_in_sync))\r\nBATCH_SIZE_PER_REPLICA = 256\r\nGLOBAL_BATCH_SIZE = BATCH_SIZE_PER_REPLICA * strategy.num_replicas_in_sync\r\n\r\nEPOCHS = 5\r\n\r\n\r\n##-----dataset------##\r\ntfrecords_dir = \"/data121/lijiayuan/test/classify_flowers/datasets\"\r\ntrain_ds, classes_num = get_dataset(tfrecords_dir, subset=\"train\", batch_size=GLOBAL_BATCH_SIZE)\r\n\r\n\r\ntrain_ds = strategy.experimental_distribute_dataset(train_ds)\r\n\r\n\r\n\r\n\r\n\r\n\r\nwith strategy.scope():\r\n  # Set reduction to `none` so we can do the reduction afterwards and divide by\r\n  # global batch size.\r\n  loss_object = tf.keras.losses.SparseCategoricalCrossentropy(\r\n      reduction=tf.keras.losses.Reduction.NONE)\r\n  # or loss_fn = tf.keras.losses.sparse_categorical_crossentropy\r\n  def compute_loss(labels, predictions):\r\n    per_example_loss = loss_object(labels, predictions)\r\n    return tf.nn.compute_average_loss(per_example_loss, global_batch_size=GLOBAL_BATCH_SIZE)\r\n\r\n\r\nwith strategy.scope():\r\n\r\n  train_accuracy = tf.keras.metrics.SparseCategoricalAccuracy(\r\n      name='train_accuracy')\r\n\r\n# model and optimizer must be created under `strategy.scope`.\r\nwith strategy.scope():\r\n  model = assemble_model(num_classes=classes_num)\r\n  optimizer = tf.keras.optimizers.Adam()\r\n  checkpoint = tf.train.Checkpoint(optimizer=optimizer, model=model)\r\n\r\nwith strategy.scope():\r\n  def train_step(inputs):\r\n    images, labels = inputs\r\n\r\n    with tf.GradientTape() as tape:\r\n      predictions = model(images, training=True)\r\n      loss = compute_loss(labels, predictions)\r\n\r\n    gradients = tape.gradient(loss, model.trainable_variables)\r\n    optimizer.apply_gradients(zip(gradients, model.trainable_variables))\r\n\r\n    train_accuracy.update_state(labels, predictions)\r\n    return loss \r\n\r\n\r\n\r\n\r\nwith strategy.scope():\r\n\r\n  @tf.function\r\n  def distributed_train_step(dataset_inputs):\r\n    per_replica_losses = strategy.experimental_run_v2(train_step,\r\n                                                      args=(dataset_inputs,))\r\n    return strategy.reduce(tf.distribute.ReduceOp.SUM, per_replica_losses,\r\n                           axis=None)\r\n \r\n \r\n  times = []\r\n  for epoch in range(EPOCHS):\r\n    # TRAIN LOOP\r\n\r\n    total_loss = 0.0\r\n    num_batches = 0\r\n    epoch_start = time.time()\r\n    for x in train_ds:\r\n      total_loss += distributed_train_step(x)\r\n      num_batches += 1\r\n    train_loss = total_loss / num_batches\r\n    epoch_end = time.time()\r\n    \r\n    if epoch != 0:\r\n      times.append(epoch_end-epoch_start)\r\n    \r\n\r\n\r\n\r\n    template = (\"Epoch {}, Loss: {:.2f}, Accuracy: {:.2f}, \"\r\n                \" Takes: {:.2f}\")\r\n    print (template.format(epoch+1, train_loss,\r\n                           train_accuracy.result()*100, \r\n                           epoch_end-epoch_start))\r\n\r\n    train_accuracy.reset_states()\r\n  print(\"{} GPUs takes average {:.2f} secs\".format(setting_GPUs_num, \r\n                                                    sum(times)/(EPOCHS-1)))\r\n\r\n\r\n```\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36146", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36146/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36146/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36146/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36146", "id": 553894482, "node_id": "MDU6SXNzdWU1NTM4OTQ0ODI=", "number": 36146, "title": "tf.function and tf.nest break for valid Mapping instances", "user": {"login": "ethereon", "id": 337985, "node_id": "MDQ6VXNlcjMzNzk4NQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/337985?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ethereon", "html_url": "https://github.com/ethereon", "followers_url": "https://api.github.com/users/ethereon/followers", "following_url": "https://api.github.com/users/ethereon/following{/other_user}", "gists_url": "https://api.github.com/users/ethereon/gists{/gist_id}", "starred_url": "https://api.github.com/users/ethereon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ethereon/subscriptions", "organizations_url": "https://api.github.com/users/ethereon/orgs", "repos_url": "https://api.github.com/users/ethereon/repos", "events_url": "https://api.github.com/users/ethereon/events{/privacy}", "received_events_url": "https://api.github.com/users/ethereon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1478826728, "node_id": "MDU6TGFiZWwxNDc4ODI2NzI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:core", "name": "comp:core", "color": "024391", "default": false, "description": ""}, {"id": 1256103877, "node_id": "MDU6TGFiZWwxMjU2MTAzODc3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/good%20first%20issue", "name": "good first issue", "color": "c4ef8b", "default": true, "description": "Good first issue for newcomers."}, {"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 17, "created_at": "2020-01-23T01:51:21Z", "updated_at": "2020-02-17T12:55:27Z", "closed_at": null, "author_association": "NONE", "body": "`tf.function` makes invalid assumptions about arguments that are `Mapping` instances. In general, there are no requirements for `Mapping` instances to have constructors that accept `[(key, value)] ` initializers, [as assumed here](https://github.com/tensorflow/tensorflow/blob/v2.1.0/tensorflow/python/util/nest.py#L145).\r\n\r\nThis leads to cryptic exceptions when used with perfectly valid `Mapping` subclasses such as this one:\r\n```python\r\nclass CustomMapping(Mapping):\r\n\r\n  def __init__(self, **kwargs):\r\n    self.mapping = kwargs\r\n  \r\n  def __getitem__(self, key):\r\n    return self.mapping[key]\r\n  \r\n  def __iter__(self):\r\n    return iter(self.mapping)\r\n\r\n  def __len__(self):\r\n    return len(self.mapping)\r\n```\r\n\r\nSee this [Colab notebook for an example](https://colab.research.google.com/drive/1sIbvyPVtQexCWqVO7QD3KlY7PoLdPeKq).\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36144", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36144/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36144/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36144/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36144", "id": 553845965, "node_id": "MDU6SXNzdWU1NTM4NDU5NjU=", "number": 36144, "title": "makefile fails to execute a.out file", "user": {"login": "applied-math-K", "id": 60202303, "node_id": "MDQ6VXNlcjYwMjAyMzAz", "avatar_url": "https://avatars1.githubusercontent.com/u/60202303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/applied-math-K", "html_url": "https://github.com/applied-math-K", "followers_url": "https://api.github.com/users/applied-math-K/followers", "following_url": "https://api.github.com/users/applied-math-K/following{/other_user}", "gists_url": "https://api.github.com/users/applied-math-K/gists{/gist_id}", "starred_url": "https://api.github.com/users/applied-math-K/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/applied-math-K/subscriptions", "organizations_url": "https://api.github.com/users/applied-math-K/orgs", "repos_url": "https://api.github.com/users/applied-math-K/repos", "events_url": "https://api.github.com/users/applied-math-K/events{/privacy}", "received_events_url": "https://api.github.com/users/applied-math-K/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-01-22T23:04:40Z", "updated_at": "2020-02-21T18:47:19Z", "closed_at": null, "author_association": "NONE", "body": "I am new to TensorFlow. At the moment, I am learning TensorFlow for C code on my Macbook. I follow the instructions by Google and manage to run the 'hello world' in C.\r\n\r\nI set the paths on my bash_profile as follows:\r\n\r\nexport LIBRARY_PATH=$LIBRARY_PATH:/usr/local/tensorflow/lib\r\n\r\nexport DYLD_LIBRARY_PATH=$DYLD_LIBRARY_PATH:/usr/local/tensorflow/lib.\r\n\r\nMy makefile is as follow.\r\n\r\ntensorlib = -L/usr/local/tensorflow-1.15.0/lib/\r\n\r\ntensorlnk = -I/usr/local/tensorflow-1.15.0/include/\r\n\r\ntask:\r\n\r\nmpicc -c hello.c $(tensorlnk)\r\n\r\nmpicc    hello.o $(tensorlib)\r\nrun:\r\n\r\nmpirun -np 4 ./a.out\r\nI can compile the program and generate the executable, a.out. In my terminal, I can run the program using 'mpirun -np 4 ./a.out' to execute. But the command 'make run' fails. Here is the error message\r\n\r\ndyld: Library not loaded: @rpath/libtensorflow.1.dylib Referenced from: /Users/usr/Documents/code/dev/TensorFlow/c/./a.out Reason: image not found\r\n\r\nCould anyone tell me what the problem is?\r\n\r\nMany thanks in advance.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36143", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36143/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36143/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36143/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36143", "id": 553844902, "node_id": "MDU6SXNzdWU1NTM4NDQ5MDI=", "number": 36143, "title": "Memory leak at tflite::Interpreter::Invoke()", "user": {"login": "tvlenin", "id": 6051923, "node_id": "MDQ6VXNlcjYwNTE5MjM=", "avatar_url": "https://avatars1.githubusercontent.com/u/6051923?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tvlenin", "html_url": "https://github.com/tvlenin", "followers_url": "https://api.github.com/users/tvlenin/followers", "following_url": "https://api.github.com/users/tvlenin/following{/other_user}", "gists_url": "https://api.github.com/users/tvlenin/gists{/gist_id}", "starred_url": "https://api.github.com/users/tvlenin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tvlenin/subscriptions", "organizations_url": "https://api.github.com/users/tvlenin/orgs", "repos_url": "https://api.github.com/users/tvlenin/repos", "events_url": "https://api.github.com/users/tvlenin/events{/privacy}", "received_events_url": "https://api.github.com/users/tvlenin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "karimnosseir", "id": 44206880, "node_id": "MDQ6VXNlcjQ0MjA2ODgw", "avatar_url": "https://avatars1.githubusercontent.com/u/44206880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karimnosseir", "html_url": "https://github.com/karimnosseir", "followers_url": "https://api.github.com/users/karimnosseir/followers", "following_url": "https://api.github.com/users/karimnosseir/following{/other_user}", "gists_url": "https://api.github.com/users/karimnosseir/gists{/gist_id}", "starred_url": "https://api.github.com/users/karimnosseir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karimnosseir/subscriptions", "organizations_url": "https://api.github.com/users/karimnosseir/orgs", "repos_url": "https://api.github.com/users/karimnosseir/repos", "events_url": "https://api.github.com/users/karimnosseir/events{/privacy}", "received_events_url": "https://api.github.com/users/karimnosseir/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "karimnosseir", "id": 44206880, "node_id": "MDQ6VXNlcjQ0MjA2ODgw", "avatar_url": "https://avatars1.githubusercontent.com/u/44206880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karimnosseir", "html_url": "https://github.com/karimnosseir", "followers_url": "https://api.github.com/users/karimnosseir/followers", "following_url": "https://api.github.com/users/karimnosseir/following{/other_user}", "gists_url": "https://api.github.com/users/karimnosseir/gists{/gist_id}", "starred_url": "https://api.github.com/users/karimnosseir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karimnosseir/subscriptions", "organizations_url": "https://api.github.com/users/karimnosseir/orgs", "repos_url": "https://api.github.com/users/karimnosseir/repos", "events_url": "https://api.github.com/users/karimnosseir/events{/privacy}", "received_events_url": "https://api.github.com/users/karimnosseir/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-01-22T23:01:50Z", "updated_at": "2020-03-09T00:35:58Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): tflite example to inference with mobilenetV2\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: NO\r\n- TensorFlow installed from (source or binary): Source\r\n- TensorFlow version (use command below): tflite 2.1\r\n- Python version: 3.6\r\n- Bazel version (if compiling from source): 1.1.0\r\n- GCC/Compiler version (if compiling from source): 7.4.0\r\n- CUDA/cuDNN version: NO\r\n- GPU model and memory: NO\r\n\r\n\r\n**Describe the current behavior**\r\nWe are running and tflite example using the tensorflow-lite.a library generated by `./tensorflow/lite/tools/make/build_lib.sh`  this command.\r\nThe example works but it has a memory leak\r\n**Other info / logs**\r\nThis is the log that I get using heapusage, as you can see in bold the problem is with tflite::Interpreter::Invoke() \r\n\r\n`\r\n==1359== 1216 bytes in 4 block(s) are lost, originally allocated at:\r\n==1359==    at 0x00007fd0cce977f2: calloc + 68\r\n==1359==    at 0x00007fd0cd0ba4a7: _dl_allocate_tls + 39\r\n==1359==    at 0x00007fd0cbdc1228: pthread_create + 2168\r\n==1359==    at 0x00007fd0cc64b925: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) + 21\r\n==1359==    at 0x00007fd0ccb488f5: tflite::eigen_support::GetThreadPoolDevice(TfLiteContext*) + 2005\r\n==1359==    at 0x00007fd0ccb1d9d2: void tflite::ops::builtin::conv::EvalFloat<(tflite::ops::builtin::conv::KernelType)2>(TfLiteContext*, TfLiteNode*, TfLiteConvParams*, tflite::ops::builtin::conv::OpData*, TfLiteTensor*, TfLiteTensor*, TfLiteTensor*, TfLiteTensor*, TfLiteTensor*, TfLiteTensor*) + 1250\r\n==1359==    at 0x00007fd0ccb1e515: TfLiteStatus tflite::ops::builtin::conv::Eval<(tflite::ops::builtin::conv::KernelType)2>(TfLiteContext*, TfLiteNode*) + 501\r\n==1359==    at 0x00007fd0cca71ba7: tflite::Subgraph::Invoke() + 775\r\n**==1359==    at 0x00007fd0cc9d7b89: tflite::Interpreter::Invoke() + 25\r\n==1359==    at 0x00007fd0cc9caa44: r2i::tflite::Engine::Predict(std::shared_ptr<r2i::IFrame>, r2i::RuntimeError&) + 1122**\r\n==1359==    at 0x000055f42ee148eb: \r\n==1359==    at 0x00007fd0cb9e9b97: __libc_start_main + 231\r\n==1359==    at 0x000055f42edf2bda: \r\n==1359== \r\n\r\n`\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36141", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36141/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36141/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36141/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36141", "id": 553773054, "node_id": "MDU6SXNzdWU1NTM3NzMwNTQ=", "number": 36141, "title": "HadoopFileSystem load error: libhdfs.so: cannot open shared object file: No such file or directory", "user": {"login": "tuomassiren", "id": 1219552, "node_id": "MDQ6VXNlcjEyMTk1NTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1219552?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tuomassiren", "html_url": "https://github.com/tuomassiren", "followers_url": "https://api.github.com/users/tuomassiren/followers", "following_url": "https://api.github.com/users/tuomassiren/following{/other_user}", "gists_url": "https://api.github.com/users/tuomassiren/gists{/gist_id}", "starred_url": "https://api.github.com/users/tuomassiren/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tuomassiren/subscriptions", "organizations_url": "https://api.github.com/users/tuomassiren/orgs", "repos_url": "https://api.github.com/users/tuomassiren/repos", "events_url": "https://api.github.com/users/tuomassiren/events{/privacy}", "received_events_url": "https://api.github.com/users/tuomassiren/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 38, "created_at": "2020-01-22T20:24:05Z", "updated_at": "2020-03-05T16:56:21Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Linux tutkain 4.19.93-v7l+ #1290 SMP Fri Jan 10 16:45:11 GMT 2020 armv7l GNU/Linux\r\n- Debian 10.2 on Raspberry PI 4+ 4GB\r\n\r\n**Describe the problem**\r\n(venv) tas@tutkain:~ $ python -c \"import tensorflow as tf;print(tf.reduce_sum(tf.random.normal([1000, 1000])))\"\r\n2020-01-22 20:21:52.312444: E tensorflow/core/platform/hadoop/hadoop_file_system.cc:132] HadoopFileSystem load error: libhdfs.so: cannot open shared object file: No such file or directory\r\nTensor(\"Sum:0\", shape=(), dtype=float32)\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n- Installation exactly as described https://www.tensorflow.org/install/pip\r\n\r\n**Any other info / logs**\r\n(venv) tas@tutkain:~ $ pip list\r\nPackage              Version\r\n-------------------- ---------\r\nabsl-py              0.9.0\r\nasn1crypto           0.24.0\r\nastor                0.8.1\r\ncachetools           4.0.0\r\ncertifi              2018.8.24\r\nchardet              3.0.4\r\ncryptography         2.6.1\r\ndistro-info          0.21\r\nentrypoints          0.3\r\ngast                 0.2.2\r\ngoogle-auth          1.10.2\r\ngoogle-auth-oauthlib 0.4.1\r\ngoogle-pasta         0.1.8\r\ngrpcio               1.26.0\r\nh5py                 2.8.0\r\nidna                 2.6\r\nKeras-Applications   1.0.8\r\nKeras-Preprocessing  1.1.0\r\nkeyring              17.1.1\r\nkeyrings.alt         3.1.1\r\nMarkdown             3.1.1\r\nnumpy                1.16.2\r\noauthlib             3.1.0\r\nopt-einsum           3.1.0\r\npip                  20.0.1\r\nprotobuf             3.11.2\r\npyasn1               0.4.8\r\npyasn1-modules       0.2.8\r\npycrypto             2.6.1\r\npycurl               7.43.0.2\r\nPyGObject            3.30.4\r\npython-apt           1.8.4\r\npyxdg                0.25\r\nrequests             2.21.0\r\nrequests-oauthlib    1.3.0\r\nrsa                  4.0\r\nSecretStorage        2.3.1\r\nsetuptools           45.1.0\r\nsix                  1.12.0\r\nssh-import-id        5.7\r\ntensorboard          2.0.2\r\ntensorflow           1.14.0\r\ntensorflow-estimator 1.14.0\r\ntermcolor            1.1.0\r\nunattended-upgrades  0.1\r\nurllib3              1.24.1\r\nvirtualenv           16.7.9\r\nWerkzeug             0.16.0\r\nwheel                0.33.6\r\nwrapt                1.11.2\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36138", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36138/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36138/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36138/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36138", "id": 553720057, "node_id": "MDU6SXNzdWU1NTM3MjAwNTc=", "number": 36138, "title": "Tensorflow 2.0.0 cpu, import error: DLL load failed", "user": {"login": "faltinl", "id": 22592465, "node_id": "MDQ6VXNlcjIyNTkyNDY1", "avatar_url": "https://avatars2.githubusercontent.com/u/22592465?v=4", "gravatar_id": "", "url": "https://api.github.com/users/faltinl", "html_url": "https://github.com/faltinl", "followers_url": "https://api.github.com/users/faltinl/followers", "following_url": "https://api.github.com/users/faltinl/following{/other_user}", "gists_url": "https://api.github.com/users/faltinl/gists{/gist_id}", "starred_url": "https://api.github.com/users/faltinl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/faltinl/subscriptions", "organizations_url": "https://api.github.com/users/faltinl/orgs", "repos_url": "https://api.github.com/users/faltinl/repos", "events_url": "https://api.github.com/users/faltinl/events{/privacy}", "received_events_url": "https://api.github.com/users/faltinl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1188421838, "node_id": "MDU6TGFiZWwxMTg4NDIxODM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:windows", "name": "subtype:windows", "color": "b619ea", "default": false, "description": "Windows Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 16, "created_at": "2020-01-22T18:35:07Z", "updated_at": "2020-02-21T18:43:48Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution: x86_64-w64-mingw32/x64 (64-bit) under Win10 x64 (build 18363),\r\n  Bios V1.08\r\n- Processor: Intel(R) Pentium(R) CPU N3710 @ 1,6GHz, RAM 4GB (DDR), 4 cores, L1 Cache 56kB, \r\n  L2 Cache 1024kB\r\n- Maker & Model: Acer Notebook TravelMate B117-M Signature Edition\r\n- TensorFlow installed from (source or binary): binary \r\n  i. under Rstudio 1.2.5033 with R 3.6.2 (20191212) & Miniconda3 4.7.12 (Py 3.7.4-64bit)\r\n  ii. under conda (since i. failed, see below)\r\n- TensorFlow version: 2.0.0\r\n- Python version: 3.6.10 (under conda)\r\n- Installed using virtualenv? pip? conda?: conda=>pip install \r\n\r\n**Describe the problem**\r\ni. Since I used keras (including reticulate & tensorflow) for the last 3 yrs under RStudio, but had various problems with my very old installation, I definitely want to continue with tensorflow + keras under RStudio and tried to install tensorflow 2.0.0. [under RStudio](https://tensorflow.rstudio.com/installation/):\r\n```\r\ninstall.packages(\"tensorflow\", version = \"2.0.0.\")   \r\nlibrary(tensorflow)\r\ninstall_tensorflow(method = \"conda\")\r\n```\r\nthen test sequence - is tensorflow installed?\r\n```\r\nlibrary(reticulate)\r\nuse_condaenv(condaenv = \"r-reticulate\", required = TRUE)\r\nlibrary(tensorflow)\r\n```\r\n```\r\n> reticulate::py_config()\r\npython:         C:/.../Miniconda3/envs/r-reticulate/python.exe\r\nlibpython:      C:/.../Miniconda3/envs/r-reticulate/python36.dll\r\npythonhome:     C:/.../Miniconda3/envs/r-reticulate\r\nversion:        3.6.10 |Anaconda, Inc.| (default, Jan  7 2020, 15:18:16) [MSC v.1916 64 bit (AMD64)]\r\nArchitecture:   64bit\r\nnumpy:          C:/.../Miniconda3/envs/r-reticulate/Lib/site-packages/numpy\r\nnumpy_version:  1.18.1\r\ntensorflow:     C:\\...\\MINICO~1\\envs\\R-RETI~1\\lib\\site-packages\\tensorflow\\__init__.p\r\npython versions found: \r\n C:/.../Miniconda3/envs/r-reticulate/python.exe\r\n C:/.../Miniconda3/python.exe\r\n```\r\n```\r\n> tensorflow::tf_config()\r\n**Installation of TensorFlow not found.**\r\nPython environments searched for 'tensorflow' package:\r\n C:\\...\\Miniconda3\\envs\\r-reticulate\\python.exe\r\n C:\\...Miniconda3\\python.exe\r\n**You can install TensorFlow using the install_tensorflow() function.**\r\n```\r\nThus, although installation was terminated correctly, tensorflow was not found, i.e. not working.\r\n\r\nii. After forwarding this issue under [Installation w/ Miniconda, Reticulate 1.14, Tensorflow 2.0.0 & Keras 2.2.5.0 failing #964](https://github.com/rstudio/keras/issues/964) to RStudio/keras, tests were made to get tensorflow 2.0.0 pip installed directly under Miniconda3 (also under Anaconda3 and starting with R3.5.3 and R3.6.1), all with the same result: \r\n```\r\nconda activate r-reticulate\r\npip install tensorflow==2.0\r\npython \r\nimport tensorflow as tf\r\n```\r\nThis produced the following error log (sorry, I'm unable to copy text from the python shell window), indicating `ImportError: DLL load failed` twice:\r\n\r\n![import_tensorflow_as_tf_20200122-1800](https://user-images.githubusercontent.com/22592465/72921761-2a04fc00-3d4c-11ea-9fe5-57ab7aaa1545.PNG)\r\n\r\n**Any other info**\r\nUnfortunately, I am an absolute newbie as regards Python - taking that into account, please help...\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36137", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36137/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36137/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36137/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36137", "id": 553701717, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY1OTg3NjQw", "number": 36137, "title": "add attribute '_estimator_type' to KerasRegressor and KerasClassifier", "user": {"login": "rushabh-v", "id": 46084304, "node_id": "MDQ6VXNlcjQ2MDg0MzA0", "avatar_url": "https://avatars3.githubusercontent.com/u/46084304?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rushabh-v", "html_url": "https://github.com/rushabh-v", "followers_url": "https://api.github.com/users/rushabh-v/followers", "following_url": "https://api.github.com/users/rushabh-v/following{/other_user}", "gists_url": "https://api.github.com/users/rushabh-v/gists{/gist_id}", "starred_url": "https://api.github.com/users/rushabh-v/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rushabh-v/subscriptions", "organizations_url": "https://api.github.com/users/rushabh-v/orgs", "repos_url": "https://api.github.com/users/rushabh-v/repos", "events_url": "https://api.github.com/users/rushabh-v/events{/privacy}", "received_events_url": "https://api.github.com/users/rushabh-v/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1178505529, "node_id": "MDU6TGFiZWwxMTc4NTA1NTI5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/prtype:bugfix", "name": "prtype:bugfix", "color": "159b2e", "default": false, "description": "PR to fix a bug"}, {"id": 1169364259, "node_id": "MDU6TGFiZWwxMTY5MzY0MjU5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:XS", "name": "size:XS", "color": "adafea", "default": false, "description": "CL Change Size: Extra Small"}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-01-22T17:57:20Z", "updated_at": "2020-02-13T11:16:14Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36137", "html_url": "https://github.com/tensorflow/tensorflow/pull/36137", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36137.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36137.patch"}, "body": "resolves: #36074 "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36136", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36136/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36136/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36136/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36136", "id": 553673899, "node_id": "MDU6SXNzdWU1NTM2NzM4OTk=", "number": 36136, "title": "TPU Socket Closed", "user": {"login": "Ryandry1st", "id": 20748832, "node_id": "MDQ6VXNlcjIwNzQ4ODMy", "avatar_url": "https://avatars2.githubusercontent.com/u/20748832?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ryandry1st", "html_url": "https://github.com/Ryandry1st", "followers_url": "https://api.github.com/users/Ryandry1st/followers", "following_url": "https://api.github.com/users/Ryandry1st/following{/other_user}", "gists_url": "https://api.github.com/users/Ryandry1st/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ryandry1st/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ryandry1st/subscriptions", "organizations_url": "https://api.github.com/users/Ryandry1st/orgs", "repos_url": "https://api.github.com/users/Ryandry1st/repos", "events_url": "https://api.github.com/users/Ryandry1st/events{/privacy}", "received_events_url": "https://api.github.com/users/Ryandry1st/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097541661, "node_id": "MDU6TGFiZWwxMDk3NTQxNjYx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tpus", "name": "comp:tpus", "color": "0052cc", "default": false, "description": "tpu, tpuestimator"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jhseu", "id": 170179, "node_id": "MDQ6VXNlcjE3MDE3OQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/170179?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jhseu", "html_url": "https://github.com/jhseu", "followers_url": "https://api.github.com/users/jhseu/followers", "following_url": "https://api.github.com/users/jhseu/following{/other_user}", "gists_url": "https://api.github.com/users/jhseu/gists{/gist_id}", "starred_url": "https://api.github.com/users/jhseu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jhseu/subscriptions", "organizations_url": "https://api.github.com/users/jhseu/orgs", "repos_url": "https://api.github.com/users/jhseu/repos", "events_url": "https://api.github.com/users/jhseu/events{/privacy}", "received_events_url": "https://api.github.com/users/jhseu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jhseu", "id": 170179, "node_id": "MDQ6VXNlcjE3MDE3OQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/170179?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jhseu", "html_url": "https://github.com/jhseu", "followers_url": "https://api.github.com/users/jhseu/followers", "following_url": "https://api.github.com/users/jhseu/following{/other_user}", "gists_url": "https://api.github.com/users/jhseu/gists{/gist_id}", "starred_url": "https://api.github.com/users/jhseu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jhseu/subscriptions", "organizations_url": "https://api.github.com/users/jhseu/orgs", "repos_url": "https://api.github.com/users/jhseu/repos", "events_url": "https://api.github.com/users/jhseu/events{/privacy}", "received_events_url": "https://api.github.com/users/jhseu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2020-01-22T17:03:26Z", "updated_at": "2020-03-18T14:44:27Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\nPlatform: Colab TPU\r\n- TensorFlow version (use command below): 2.1.0rc1\r\n\r\n**Describe the current behavior**\r\n[TPU_Socket_Traceback.pdf](https://github.com/tensorflow/tensorflow/files/4098637/TPU_Socket_Traceback.pdf)\r\n\r\n\r\nUsing model.fit raises an error which does not occur with GPU backend.\r\n\r\n`UnavailableError: Socket closed\r\nAdditional GRPC error information:\r\n{\"created\":\"@1579711911.023658059\",\"description\":\"Error received from peer\",\"file\":\"external/grpc/src/core/lib/surface/call.cc\",\"file_line\":1039,\"grpc_message\":\"Socket closed\",\"grpc_status\":14}`\r\n\r\n**Describe the expected behavior**\r\nCode should run the same in both instances.\r\n\r\n**Code to reproduce the issue**\r\nhttps://colab.research.google.com/drive/156Q2BsM9gVS3cvDytovQzEGKmjJpP4s8\r\n\r\n**Other info / logs**\r\nAttached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36130", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36130/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36130/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36130/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36130", "id": 553581129, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY1ODg2OTA5", "number": 36130, "title": "[TFLite int16] 16-bit reference kernel operators MAX_POOL_2D and AVERAGE_POOL_2D", "user": {"login": "wwwind", "id": 1513336, "node_id": "MDQ6VXNlcjE1MTMzMzY=", "avatar_url": "https://avatars0.githubusercontent.com/u/1513336?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wwwind", "html_url": "https://github.com/wwwind", "followers_url": "https://api.github.com/users/wwwind/followers", "following_url": "https://api.github.com/users/wwwind/following{/other_user}", "gists_url": "https://api.github.com/users/wwwind/gists{/gist_id}", "starred_url": "https://api.github.com/users/wwwind/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wwwind/subscriptions", "organizations_url": "https://api.github.com/users/wwwind/orgs", "repos_url": "https://api.github.com/users/wwwind/repos", "events_url": "https://api.github.com/users/wwwind/events{/privacy}", "received_events_url": "https://api.github.com/users/wwwind/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 987666414, "node_id": "MDU6TGFiZWw5ODc2NjY0MTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/ready%20to%20pull", "name": "ready to pull", "color": "2cd643", "default": false, "description": ""}, {"id": 1169365494, "node_id": "MDU6TGFiZWwxMTY5MzY1NDk0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:M", "name": "size:M", "color": "adafea", "default": false, "description": "CL Change Size: Medium"}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2020-01-22T14:34:26Z", "updated_at": "2020-03-18T22:18:03Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36130", "html_url": "https://github.com/tensorflow/tensorflow/pull/36130", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36130.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36130.patch"}, "body": "This PR is one of steps to extend 8-bit quantization to support symmetric 16-bit activations.\r\n\r\nEach activation is of type int16 and symmetric around zero. The weight tensor precision remains at 8-bit signed values. The bias is set to int64 precision.\r\n\r\nIn this PR we introduce implementation and tests for MAX_POOL_2D and AVERAGE_POOL_2D kernel reference functions.\r\n\r\nAVERAGE_POOL_2D \r\n\u202f Input 0: \r\n\u202f \u202f data_type \u202f: int16 \r\n\u202f \u202f range \u202f \u202f \u202f: [-32768, 32767] \r\n\u202f \u202f granularity: per-tensor, zero_point=0 \r\n\u202f Output 0: \r\n\u202f \u202f data_type \u202f: int8 \r\n\u202f \u202f range \u202f \u202f \u202f: [-32768, 32767] \r\n\u202f \u202f granularity: per-tensor, zero_point=0 \r\n\u202f restriction: Input and outputs must all have same scale\r\n\r\nMAX_POOL_2D \r\n\u202f Input 0: \r\n\u202f \u202f data_type \u202f: int16 \r\n\u202f \u202f range \u202f \u202f \u202f: [-32768, 32767] \r\n\u202f \u202f granularity: per-tensor, zero_point=0 \r\n\u202f Output 0: \r\n\u202f \u202f data_type \u202f: int16 \r\n\u202f \u202f range \u202f \u202f \u202f: [-32768, 32767] \r\n\u202f \u202f granularity: per-tensor, zero_point=0 \r\n\u202f restriction: Input and outputs must all have same scale\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36128", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36128/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36128/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36128/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36128", "id": 553497733, "node_id": "MDU6SXNzdWU1NTM0OTc3MzM=", "number": 36128, "title": "Tensorflow.summary.histogram produces wrong output", "user": {"login": "paloha", "id": 15421925, "node_id": "MDQ6VXNlcjE1NDIxOTI1", "avatar_url": "https://avatars3.githubusercontent.com/u/15421925?v=4", "gravatar_id": "", "url": "https://api.github.com/users/paloha", "html_url": "https://github.com/paloha", "followers_url": "https://api.github.com/users/paloha/followers", "following_url": "https://api.github.com/users/paloha/following{/other_user}", "gists_url": "https://api.github.com/users/paloha/gists{/gist_id}", "starred_url": "https://api.github.com/users/paloha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/paloha/subscriptions", "organizations_url": "https://api.github.com/users/paloha/orgs", "repos_url": "https://api.github.com/users/paloha/repos", "events_url": "https://api.github.com/users/paloha/events{/privacy}", "received_events_url": "https://api.github.com/users/paloha/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 284285184, "node_id": "MDU6TGFiZWwyODQyODUxODQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tensorboard", "name": "comp:tensorboard", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "nfelt", "id": 710113, "node_id": "MDQ6VXNlcjcxMDExMw==", "avatar_url": "https://avatars0.githubusercontent.com/u/710113?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nfelt", "html_url": "https://github.com/nfelt", "followers_url": "https://api.github.com/users/nfelt/followers", "following_url": "https://api.github.com/users/nfelt/following{/other_user}", "gists_url": "https://api.github.com/users/nfelt/gists{/gist_id}", "starred_url": "https://api.github.com/users/nfelt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nfelt/subscriptions", "organizations_url": "https://api.github.com/users/nfelt/orgs", "repos_url": "https://api.github.com/users/nfelt/repos", "events_url": "https://api.github.com/users/nfelt/events{/privacy}", "received_events_url": "https://api.github.com/users/nfelt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nfelt", "id": 710113, "node_id": "MDQ6VXNlcjcxMDExMw==", "avatar_url": "https://avatars0.githubusercontent.com/u/710113?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nfelt", "html_url": "https://github.com/nfelt", "followers_url": "https://api.github.com/users/nfelt/followers", "following_url": "https://api.github.com/users/nfelt/following{/other_user}", "gists_url": "https://api.github.com/users/nfelt/gists{/gist_id}", "starred_url": "https://api.github.com/users/nfelt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nfelt/subscriptions", "organizations_url": "https://api.github.com/users/nfelt/orgs", "repos_url": "https://api.github.com/users/nfelt/repos", "events_url": "https://api.github.com/users/nfelt/events{/privacy}", "received_events_url": "https://api.github.com/users/nfelt/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-01-22T12:05:44Z", "updated_at": "2020-01-23T18:29:03Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): **yes**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): \r\n**Tested on my machine with Linux Ubuntu 16.04 and in Google Colab**\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: NA\r\n- TensorFlow installed from (source or binary): \r\n**Installed with pip on my machine or using the one preinstalled in Colab**\r\n- TensorFlow version (use command below): \r\n**v2.0.0-rc2-26-g64c3d38 2.0.0 on my machine or v2.1.0-rc1-0-g064e1535a7 2.1.0-rc1 in Colab**\r\n- Python version: \r\n**3.5.2 on my machine or 3.6.9 in Colab**\r\n- Bazel version (if compiling from source): -\r\n- GCC/Compiler version (if compiling from source): -\r\n- CUDA/cuDNN version: \r\n**run on CPU on my machine or run on CPU in Colab or run on GPU in 10.0, V10.0.130 in Colab (there seems to be no problem when running on GPU)**\r\n- GPU model and memory: \r\n**no GPU on my machine or Colab GPU Tesla P100-PCIE-16GB**\r\n\r\n**Describe the current behavior**\r\n;tldr\r\n`tensorboard.plugins.histogram.summary_v2._buckets` produces wrong result when run with CPU on arrays with more than approx. `7e7` elements.\r\n\r\nLonger description:\r\nI wanted to add a histogram of my model outputs (not only weights) to tensorboard using `tf.summary.histogram()` in a custom keras callback. All works, histogram is shown, but the values displayed are not correct. After I have inspected further, I found out that the function `tensorboard.plugins.histogram.summary_v2._buckets`, which is internally used in the `tf.summary.histogram()` produces wrong results for larger inputs. Namely it returns incorrect counts for some of the buckets. It is very simple to check this, because the size of the data should equal the sum of counts, which are stored in the first column of the `_buckets` output. For larger arrays, this is not true.\r\n\r\nWierdly, the discrepancy seems to occur only when the code is run on CPU. On the GPU, the histogram is correct (up to some tiny difference - missing one or two elements). But I can not check larger arrays than `100e6`, because running in Colab on GPU gives an error when calling `_buckets()`: \r\n`InternalError: Failed copying input tensor from /job:localhost/replica:0/task:0/device:GPU:0 to /job:localhost/replica:0/task:0/device:CPU:0 in order to run LinSpace: GPU sync failed [Op:LinSpace]`\r\n\r\nDescription of each step is in Gist along with the code.\r\n\r\n**Describe the expected behavior**\r\nExpected behavior of `tensorboard.plugins.histogram.summary_v2._buckets` would be to produce the correct counts of elements in a specific bucket for all sizes of data.\r\n\r\n**Code to reproduce the issue**\r\n\r\nSimplified code:\r\n```python\r\nimport numpy as np\r\nfrom tensorboard.plugins.histogram.summary_v2 import _buckets\r\n# Create random data\r\ndata = np.random.standard_normal(int(100e6)).astype(np.float16)\r\n# Compute the histogram with tf\r\ntfhist = _buckets(data, bucket_count=20)\r\ncounts_tf = tfhist[:,2] # Counts are in the last column\r\nedges_tf = tfhist[:,0] # Edges are in the first column\r\nnp.equal(np.sum(counts_tf), data.size)  # If false, there is a bug\r\n```\r\n\r\nFull example in Gist (can be run in Colab): https://gist.github.com/paloha/d079aa9afb832b996657fb97a2763a47#file-tensorflow-produces-wrong-histogram-ipynb\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\nI think that the error I get when running the gist on GPU in Colab (mentioned above) should be addressed as well."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36127", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36127/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36127/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36127/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36127", "id": 553493782, "node_id": "MDU6SXNzdWU1NTM0OTM3ODI=", "number": 36127, "title": "Make TensorFlow build with system packages", "user": {"login": "Flamefire", "id": 309017, "node_id": "MDQ6VXNlcjMwOTAxNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/309017?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Flamefire", "html_url": "https://github.com/Flamefire", "followers_url": "https://api.github.com/users/Flamefire/followers", "following_url": "https://api.github.com/users/Flamefire/following{/other_user}", "gists_url": "https://api.github.com/users/Flamefire/gists{/gist_id}", "starred_url": "https://api.github.com/users/Flamefire/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Flamefire/subscriptions", "organizations_url": "https://api.github.com/users/Flamefire/orgs", "repos_url": "https://api.github.com/users/Flamefire/repos", "events_url": "https://api.github.com/users/Flamefire/events{/privacy}", "received_events_url": "https://api.github.com/users/Flamefire/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-01-22T11:57:48Z", "updated_at": "2020-01-23T05:25:49Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "We want to control what versions of libraries are getting used on our cluster. TF using included and downloaded stuff is a misbehavor.\r\n\r\nIs it possible to get a list of dependencies and whether the system version is used/found?\r\n\r\nCan we interactively pass some arguments and have it use the system versions with TF showing if it does before running the build?\r\n\r\nExamples that I've seen are zlib and protobuf with the protoc.\r\n\r\nWe are using a Github release and running `./configure && bazel <...>` with lots of TF_NEED_* and *_PATH variables already set."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36123", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36123/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36123/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36123/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36123", "id": 553430629, "node_id": "MDU6SXNzdWU1NTM0MzA2Mjk=", "number": 36123, "title": "ERROR: intel-tensorflow has an invalid wheel", "user": {"login": "djstrong", "id": 1849959, "node_id": "MDQ6VXNlcjE4NDk5NTk=", "avatar_url": "https://avatars1.githubusercontent.com/u/1849959?v=4", "gravatar_id": "", "url": "https://api.github.com/users/djstrong", "html_url": "https://github.com/djstrong", "followers_url": "https://api.github.com/users/djstrong/followers", "following_url": "https://api.github.com/users/djstrong/following{/other_user}", "gists_url": "https://api.github.com/users/djstrong/gists{/gist_id}", "starred_url": "https://api.github.com/users/djstrong/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/djstrong/subscriptions", "organizations_url": "https://api.github.com/users/djstrong/orgs", "repos_url": "https://api.github.com/users/djstrong/repos", "events_url": "https://api.github.com/users/djstrong/events{/privacy}", "received_events_url": "https://api.github.com/users/djstrong/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "TensorFlow-MKL", "id": 44416303, "node_id": "MDQ6VXNlcjQ0NDE2MzAz", "avatar_url": "https://avatars2.githubusercontent.com/u/44416303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TensorFlow-MKL", "html_url": "https://github.com/TensorFlow-MKL", "followers_url": "https://api.github.com/users/TensorFlow-MKL/followers", "following_url": "https://api.github.com/users/TensorFlow-MKL/following{/other_user}", "gists_url": "https://api.github.com/users/TensorFlow-MKL/gists{/gist_id}", "starred_url": "https://api.github.com/users/TensorFlow-MKL/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TensorFlow-MKL/subscriptions", "organizations_url": "https://api.github.com/users/TensorFlow-MKL/orgs", "repos_url": "https://api.github.com/users/TensorFlow-MKL/repos", "events_url": "https://api.github.com/users/TensorFlow-MKL/events{/privacy}", "received_events_url": "https://api.github.com/users/TensorFlow-MKL/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "TensorFlow-MKL", "id": 44416303, "node_id": "MDQ6VXNlcjQ0NDE2MzAz", "avatar_url": "https://avatars2.githubusercontent.com/u/44416303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TensorFlow-MKL", "html_url": "https://github.com/TensorFlow-MKL", "followers_url": "https://api.github.com/users/TensorFlow-MKL/followers", "following_url": "https://api.github.com/users/TensorFlow-MKL/following{/other_user}", "gists_url": "https://api.github.com/users/TensorFlow-MKL/gists{/gist_id}", "starred_url": "https://api.github.com/users/TensorFlow-MKL/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TensorFlow-MKL/subscriptions", "organizations_url": "https://api.github.com/users/TensorFlow-MKL/orgs", "repos_url": "https://api.github.com/users/TensorFlow-MKL/repos", "events_url": "https://api.github.com/users/TensorFlow-MKL/events{/privacy}", "received_events_url": "https://api.github.com/users/TensorFlow-MKL/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-01-22T10:00:39Z", "updated_at": "2020-02-26T09:29:07Z", "closed_at": null, "author_association": "NONE", "body": "Are you maintaining intel-tensorflow?\r\n\r\nWith pip 20.0.1:\r\n```\r\n$ pip install intel-tensorflow\r\nCollecting intel-tensorflow\r\n  Downloading intel_tensorflow-2.0.0-cp36-cp36m-manylinux2010_x86_64.whl (133.7 MB)\r\n     |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 133.7 MB 53.8 MB/s \r\nERROR: intel-tensorflow has an invalid wheel, multiple .dist-info directories found: intel_tensorflow-2.0.0.dist-info, tensorflow-2.0.0.dist-info\r\n```\r\nI guess the error is related to new pip."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36121", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36121/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36121/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36121/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36121", "id": 553405133, "node_id": "MDU6SXNzdWU1NTM0MDUxMzM=", "number": 36121, "title": "Installation broken - Tensorflow 2.1 Cuda 10.1 Ubuntu 18.04", "user": {"login": "igorhoogerwoord", "id": 13174854, "node_id": "MDQ6VXNlcjEzMTc0ODU0", "avatar_url": "https://avatars3.githubusercontent.com/u/13174854?v=4", "gravatar_id": "", "url": "https://api.github.com/users/igorhoogerwoord", "html_url": "https://github.com/igorhoogerwoord", "followers_url": "https://api.github.com/users/igorhoogerwoord/followers", "following_url": "https://api.github.com/users/igorhoogerwoord/following{/other_user}", "gists_url": "https://api.github.com/users/igorhoogerwoord/gists{/gist_id}", "starred_url": "https://api.github.com/users/igorhoogerwoord/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/igorhoogerwoord/subscriptions", "organizations_url": "https://api.github.com/users/igorhoogerwoord/orgs", "repos_url": "https://api.github.com/users/igorhoogerwoord/repos", "events_url": "https://api.github.com/users/igorhoogerwoord/events{/privacy}", "received_events_url": "https://api.github.com/users/igorhoogerwoord/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "lamberta", "id": 43051, "node_id": "MDQ6VXNlcjQzMDUx", "avatar_url": "https://avatars2.githubusercontent.com/u/43051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lamberta", "html_url": "https://github.com/lamberta", "followers_url": "https://api.github.com/users/lamberta/followers", "following_url": "https://api.github.com/users/lamberta/following{/other_user}", "gists_url": "https://api.github.com/users/lamberta/gists{/gist_id}", "starred_url": "https://api.github.com/users/lamberta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lamberta/subscriptions", "organizations_url": "https://api.github.com/users/lamberta/orgs", "repos_url": "https://api.github.com/users/lamberta/repos", "events_url": "https://api.github.com/users/lamberta/events{/privacy}", "received_events_url": "https://api.github.com/users/lamberta/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "lamberta", "id": 43051, "node_id": "MDQ6VXNlcjQzMDUx", "avatar_url": "https://avatars2.githubusercontent.com/u/43051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lamberta", "html_url": "https://github.com/lamberta", "followers_url": "https://api.github.com/users/lamberta/followers", "following_url": "https://api.github.com/users/lamberta/following{/other_user}", "gists_url": "https://api.github.com/users/lamberta/gists{/gist_id}", "starred_url": "https://api.github.com/users/lamberta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lamberta/subscriptions", "organizations_url": "https://api.github.com/users/lamberta/orgs", "repos_url": "https://api.github.com/users/lamberta/repos", "events_url": "https://api.github.com/users/lamberta/events{/privacy}", "received_events_url": "https://api.github.com/users/lamberta/received_events", "type": "User", "site_admin": false}, {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, {"login": "goldiegadde", "id": 43185254, "node_id": "MDQ6VXNlcjQzMTg1MjU0", "avatar_url": "https://avatars2.githubusercontent.com/u/43185254?v=4", "gravatar_id": "", "url": "https://api.github.com/users/goldiegadde", "html_url": "https://github.com/goldiegadde", "followers_url": "https://api.github.com/users/goldiegadde/followers", "following_url": "https://api.github.com/users/goldiegadde/following{/other_user}", "gists_url": "https://api.github.com/users/goldiegadde/gists{/gist_id}", "starred_url": "https://api.github.com/users/goldiegadde/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/goldiegadde/subscriptions", "organizations_url": "https://api.github.com/users/goldiegadde/orgs", "repos_url": "https://api.github.com/users/goldiegadde/repos", "events_url": "https://api.github.com/users/goldiegadde/events{/privacy}", "received_events_url": "https://api.github.com/users/goldiegadde/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2020-01-22T09:14:18Z", "updated_at": "2020-02-21T18:47:14Z", "closed_at": null, "author_association": "NONE", "body": "Having followed the installation guide for GPU support multiple times, each time starting from a blank Ubuntu 18.04 LTS instance it breaks when installing cuda 10-1 after installing the driver and rebooting.\r\n\r\nSee guide for Ubuntu 18.04 + Cuda 10.1: https://www.tensorflow.org/install/gpu\r\nCuda 10.1 is the version with which Tensorflow 2.1 is compiled and therefore Cuda 10.1 needs to be installed.\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04 LTS\r\n- TensorFlow installed from (source or binary): Tensorflow 2.1 binary\r\n- TensorFlow version: 2.1\r\n- Python version: 3.6\r\n- Installed using virtualenv? pip? conda?: virtualenv\r\n- CUDA/cuDNN version: 10.1\r\n- GPU model and memory: Tesla T4\r\n\r\nHaving restarted the machine and confirmed that the driver recognises the GPU:\r\nThe installation guide for GPU support breaks at this section:\r\n```\r\nsudo apt-get install --no-install-recommends \\\r\n    cuda-10-1 \\\r\n    libcudnn7=7.6.4.38-1+cuda10.1  \\\r\n    libcudnn7-dev=7.6.4.38-1+cuda10.1\r\n```\r\nWhich results in:\r\n```\r\nSome packages could not be installed. This may mean that you have\r\nrequested an impossible situation or if you are using the unstable\r\ndistribution that some required packages have not yet been created\r\nor been moved out of Incoming.\r\nThe following information may help to resolve the situation:\r\n\r\nThe following packages have unmet dependencies:\r\n cuda-10-1 : Depends: cuda-runtime-10-1 (>= 10.1.243) but it is not going to be installed\r\n             Depends: cuda-demo-suite-10-1 (>= 10.1.243) but it is not going to be installed\r\nE: Unable to correct problems, you have held broken packages.\r\n```\r\nHaving searched stackoverflow, github and the Tensorflow website, it seems that the dependencies list can not be installed. \r\n\r\nAgain, I have rerun this installation multiple times on a *blank* machine, without running *anything else* before trying to run this installation.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36120", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36120/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36120/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36120/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36120", "id": 553381138, "node_id": "MDU6SXNzdWU1NTMzODExMzg=", "number": 36120, "title": "TFLite for Microcontrollers: Compilation issues for operators for bare metal", "user": {"login": "wrd90", "id": 3441341, "node_id": "MDQ6VXNlcjM0NDEzNDE=", "avatar_url": "https://avatars1.githubusercontent.com/u/3441341?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wrd90", "html_url": "https://github.com/wrd90", "followers_url": "https://api.github.com/users/wrd90/followers", "following_url": "https://api.github.com/users/wrd90/following{/other_user}", "gists_url": "https://api.github.com/users/wrd90/gists{/gist_id}", "starred_url": "https://api.github.com/users/wrd90/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wrd90/subscriptions", "organizations_url": "https://api.github.com/users/wrd90/orgs", "repos_url": "https://api.github.com/users/wrd90/repos", "events_url": "https://api.github.com/users/wrd90/events{/privacy}", "received_events_url": "https://api.github.com/users/wrd90/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rockyrhodes", "id": 7253968, "node_id": "MDQ6VXNlcjcyNTM5Njg=", "avatar_url": "https://avatars2.githubusercontent.com/u/7253968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rockyrhodes", "html_url": "https://github.com/rockyrhodes", "followers_url": "https://api.github.com/users/rockyrhodes/followers", "following_url": "https://api.github.com/users/rockyrhodes/following{/other_user}", "gists_url": "https://api.github.com/users/rockyrhodes/gists{/gist_id}", "starred_url": "https://api.github.com/users/rockyrhodes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rockyrhodes/subscriptions", "organizations_url": "https://api.github.com/users/rockyrhodes/orgs", "repos_url": "https://api.github.com/users/rockyrhodes/repos", "events_url": "https://api.github.com/users/rockyrhodes/events{/privacy}", "received_events_url": "https://api.github.com/users/rockyrhodes/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rockyrhodes", "id": 7253968, "node_id": "MDQ6VXNlcjcyNTM5Njg=", "avatar_url": "https://avatars2.githubusercontent.com/u/7253968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rockyrhodes", "html_url": "https://github.com/rockyrhodes", "followers_url": "https://api.github.com/users/rockyrhodes/followers", "following_url": "https://api.github.com/users/rockyrhodes/following{/other_user}", "gists_url": "https://api.github.com/users/rockyrhodes/gists{/gist_id}", "starred_url": "https://api.github.com/users/rockyrhodes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rockyrhodes/subscriptions", "organizations_url": "https://api.github.com/users/rockyrhodes/orgs", "repos_url": "https://api.github.com/users/rockyrhodes/repos", "events_url": "https://api.github.com/users/rockyrhodes/events{/privacy}", "received_events_url": "https://api.github.com/users/rockyrhodes/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-01-22T08:23:36Z", "updated_at": "2020-01-23T11:28:21Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Host: macOS 10.14.6, Target Tiva TM4C123\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version: 1.14 \r\n    - The pre-generated projects in the [porting guide of the TFLite micro readme](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/lite/micro/README.md) are based on 1.14, I tried to upgrade to a more recent version but somehow the micro interpreter fails to read the model correctly.\r\n    - When verifying the model and its inputs, `input->dims->size` contains a very large number which is incorrect.\r\n- Python version: 3.6.9 (Anaconda)\r\n- Installed using virtualenv? pip? conda?: conda\r\n- Bazel version (if compiling from source): 1.2.1\r\n- GCC/Compiler version (if compiling from source): TI ARM C/C++ Compiler                   v18.12.4.LTS\r\n- CUDA/cuDNN version: none\r\n- GPU model and memory: none\r\n\r\n**Describe the problem**\r\nI am trying to port tflite for microcontrollers to a new target. As described in [this guide](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/lite/micro/README.md), I used an example project (the fully connected test project), which I managed to compile quickly without any issues. I am aware that I am not using a compiler for which there are any example projects but that has not been an issue so far. I have managed to initialize and run the model, up to the point where some TF operators are missing, such as `SUB`, or `CAST`. \r\n\r\nNow that I've added `lite/kernels/sub.cc` (there is no `sub.cc` in the folder `experimental/micro`) I need to include `lite/kernels/optimized/cpu_check.h` which depends on `lite/kernels/cpu_backend_context.h`, which in turn depends on `gemmlowp`. I haven't managed to compile `gemmlowp` because it depends on many OS dependent sources. However I read in the readme for TFLite for microcontrollers that there should be no such dependencies.\r\n\r\nIt seems to me that these operators have not yet been ported, and I am aware that this is in a highly experimental state and subject to radical changes. Can someone give me any hints on what I could do? Is there a way that could help me include these operators in the project by maybe stripping things from the \"normal\" tflite implementation? I don't think I need anything from `unistd.h` which `gemmlowp` depends on.\r\n\r\n**Any other info / logs**\r\nMy model is generated by [ml-agents](https://github.com/Unity-Technologies/ml-agents) which uses `tensorflow>=1.7,<2.1`, and stores the models as frozen graphs. This may cause limitations, if not issues.\r\n\r\nI am more than happy to provide anything that might provide any more necessary information\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36118", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36118/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36118/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36118/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36118", "id": 553354732, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY1NzAyMDMx", "number": 36118, "title": "Riscv 32 mcu", "user": {"login": "zhoupeng", "id": 1014132, "node_id": "MDQ6VXNlcjEwMTQxMzI=", "avatar_url": "https://avatars0.githubusercontent.com/u/1014132?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zhoupeng", "html_url": "https://github.com/zhoupeng", "followers_url": "https://api.github.com/users/zhoupeng/followers", "following_url": "https://api.github.com/users/zhoupeng/following{/other_user}", "gists_url": "https://api.github.com/users/zhoupeng/gists{/gist_id}", "starred_url": "https://api.github.com/users/zhoupeng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zhoupeng/subscriptions", "organizations_url": "https://api.github.com/users/zhoupeng/orgs", "repos_url": "https://api.github.com/users/zhoupeng/repos", "events_url": "https://api.github.com/users/zhoupeng/events{/privacy}", "received_events_url": "https://api.github.com/users/zhoupeng/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 1169365494, "node_id": "MDU6TGFiZWwxMTY5MzY1NDk0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:M", "name": "size:M", "color": "adafea", "default": false, "description": "CL Change Size: Medium"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-01-22T07:18:21Z", "updated_at": "2020-03-19T12:39:38Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36118", "html_url": "https://github.com/tensorflow/tensorflow/pull/36118", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36118.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36118.patch"}, "body": "Update for this pull request(reviewed by @nkreeger before):\r\nhttps://github.com/tensorflow/tensorflow/pull/33680  (Will close) \r\nhttps://github.com/tensorflow/tensorflow/pull/36095 (by @jpienaar before) \r\n\r\nrelated issues:\r\nhttps://github.com/tensorflow/tensorflow/issues/32041\r\nhttps://github.com/tensorflow/tensorflow/issues/33677\r\n\r\nIf possible, pls review as soon as possible, the tensorflow repo is very easy to get conflict because update so quickly.  Thanks,\r\n\r\nAbout the three patches for review:\r\n1) lite:micro:tools:make: Move the default target(all) up before any others.\r\n    \r\n The default Makefile target `all` is compiled if there's no command-line arguments.\r\n\r\n2) lite:micro:riscv32_mcu:Fix build failure of undefined references.\r\n    \r\n    Fix the ld error:\r\n    undefined references to `__wrap_puts` for build commands like `make -f tensorflow/lite/micro/tools/make/Makefile TARGET=riscv32_mcu hello_world_bin`\r\n    The related issue is tensorflow#32041\r\n\r\n    Refactoring, suggested by Nick Kreeger(nick.kreeger@gmail.com):\r\n    The targets/mcu_riscv_makefile.inc should only include the bare-bones parts for building for this platform.\r\n    So move platform specific items from targets/mcu_riscv_makefile.inc to the actual example folder.\r\n    Create a riscv32_mcu folder in each example directory. In those directories, create a new Makefile.inc that adds these rules moved out.    \r\n\r\n    The bug's original reasons:\r\n    The Makefile variables XXX_TEST_SRCS/XXX_SRCS in targets/mcu_riscv_makefile.inc are overridden by the the examples's respective makefile.inc (eg. hello_world/Makefile.inc), which leads to the   architecture special __wrap__funs are not included correctly.\r\n\r\n3) lite:micro:riscv32_mcu: Fix hidden symbol `__dso_handle' isn't defined.\r\n For arduino sketch in riscv_mcu examples, this patch fix by declare the global variable `void* __dso_handle;`.\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36116", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36116/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36116/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36116/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36116", "id": 553240478, "node_id": "MDU6SXNzdWU1NTMyNDA0Nzg=", "number": 36116, "title": "Multiple outputs from a keras model", "user": {"login": "Bidski", "id": 2320984, "node_id": "MDQ6VXNlcjIzMjA5ODQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/2320984?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Bidski", "html_url": "https://github.com/Bidski", "followers_url": "https://api.github.com/users/Bidski/followers", "following_url": "https://api.github.com/users/Bidski/following{/other_user}", "gists_url": "https://api.github.com/users/Bidski/gists{/gist_id}", "starred_url": "https://api.github.com/users/Bidski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Bidski/subscriptions", "organizations_url": "https://api.github.com/users/Bidski/orgs", "repos_url": "https://api.github.com/users/Bidski/repos", "events_url": "https://api.github.com/users/Bidski/events{/privacy}", "received_events_url": "https://api.github.com/users/Bidski/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-01-22T00:47:29Z", "updated_at": "2020-02-27T02:34:02Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): Source\r\n- TensorFlow version (use command below): 1.15.0-rc1-11276-gc9f7f636eb 2.1.0\r\n- Python version: 3.6.9\r\n- Bazel version (if compiling from source): 2.0.0\r\n- GCC/Compiler version (if compiling from source): gcc-7\r\n- CUDA/cuDNN version: 10.1/7.6.3\r\n- GPU model and memory: GTX1080Ti 11GB\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nI have a custom (keras) CNN model as well as a custom loss function.\r\n\r\nThe model has two inputs at one resolution and multiple (6) outputs at different resolutions (each output has a different resolution). \r\n\r\nThe dataset, from a TFRecord file, has the 2 image inputs and 1 ground truth image as an output.\r\n\r\nThe loss function expects to receive the single ground truth image as `y_true` and the 6 outputs in a list as `y_pred` and will then calculate the loss value based on this.\r\n\r\nWith this scenario, I get the following error\r\n```\r\nValueError: Error when checking model target: the list of Numpy arrays that you are passing to your model is not the size the model expected. Expected to see 6 array(s), for inputs ['output_1', 'output_2', 'output_3', 'output_4', 'output_5', 'output_6'] but instead got the following list of 1 arrays: [<tf.Tensor 'args_5:0' shape=(None, 384, 768, 1) dtype=float32>]...\r\n```\r\n\r\nIf I modify my dataset loading code so that it resizes the ground truth image into a list of images with appropriate resolutions to match my networks output, I get the following error\r\n```\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Shapes of all inputs must match: values[0].shape = [270,480,1] != values[1].shape = [135,240,1]\r\n\t [[{{node packed}}]]\r\n```\r\n\r\n**Describe the expected behavior**\r\nI expect that TF/keras would allow at least one of these scenarios.\r\n\r\n\r\nIs there an accepted way to handle this sort of situation?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36115", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36115/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36115/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36115/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36115", "id": 553238858, "node_id": "MDU6SXNzdWU1NTMyMzg4NTg=", "number": 36115, "title": "Sampled Softmax for Tensorflow Keras", "user": {"login": "John-8704", "id": 58213113, "node_id": "MDQ6VXNlcjU4MjEzMTEz", "avatar_url": "https://avatars1.githubusercontent.com/u/58213113?v=4", "gravatar_id": "", "url": "https://api.github.com/users/John-8704", "html_url": "https://github.com/John-8704", "followers_url": "https://api.github.com/users/John-8704/followers", "following_url": "https://api.github.com/users/John-8704/following{/other_user}", "gists_url": "https://api.github.com/users/John-8704/gists{/gist_id}", "starred_url": "https://api.github.com/users/John-8704/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/John-8704/subscriptions", "organizations_url": "https://api.github.com/users/John-8704/orgs", "repos_url": "https://api.github.com/users/John-8704/repos", "events_url": "https://api.github.com/users/John-8704/events{/privacy}", "received_events_url": "https://api.github.com/users/John-8704/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-01-22T00:41:42Z", "updated_at": "2020-01-22T21:47:52Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): 2.1.0\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\nThis is a feature request for sampled softmax loss in Tensorflow-2 Keras. The sampled softmax loss is important when dealing with large number of target classes mainly in sequence to sequence models.\r\n\r\nSampled softmax is available in tensorflow via `tf.nn.sampled_softmax` but I couldn't find any resource that can help me to use it with tensorflow keras.\r\n\r\n_\r\n\r\n> **Note: If anyone have **implemented it**, **please** share the sample code on how you've achieved it. There are 10's of questions in StackOverflow regarding this without any answer. **\r\n\r\n_\r\n\r\n**Will this change the current api? How?**\r\nNo.\r\n**Who will benefit with this feature?**\r\nThis will benefit those who are dealing with large number of target classes to predict. In such cases softmax is not a ideal solution."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36111", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36111/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36111/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36111/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36111", "id": 553142147, "node_id": "MDU6SXNzdWU1NTMxNDIxNDc=", "number": 36111, "title": "cudart64_101.dll not found, but I have CUDA installed", "user": {"login": "frogtd", "id": 31412003, "node_id": "MDQ6VXNlcjMxNDEyMDAz", "avatar_url": "https://avatars0.githubusercontent.com/u/31412003?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frogtd", "html_url": "https://github.com/frogtd", "followers_url": "https://api.github.com/users/frogtd/followers", "following_url": "https://api.github.com/users/frogtd/following{/other_user}", "gists_url": "https://api.github.com/users/frogtd/gists{/gist_id}", "starred_url": "https://api.github.com/users/frogtd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frogtd/subscriptions", "organizations_url": "https://api.github.com/users/frogtd/orgs", "repos_url": "https://api.github.com/users/frogtd/repos", "events_url": "https://api.github.com/users/frogtd/events{/privacy}", "received_events_url": "https://api.github.com/users/frogtd/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1188421838, "node_id": "MDU6TGFiZWwxMTg4NDIxODM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:windows", "name": "subtype:windows", "color": "b619ea", "default": false, "description": "Windows Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 17, "created_at": "2020-01-21T21:31:11Z", "updated_at": "2020-03-09T15:54:01Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10 (10.0.18362 Build 18362)\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version: 2.1.0\r\n- Python version: 3.7.6 (from windows store)\r\n- Installed using virtualenv? pip? conda?: pip\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: 10 and 10.1, but I also tried with just 10.1 and just 10.2\r\n- GPU model and memory: NVIDIA GeForce GTX 1060 OC with 6GB GDDR5\r\n\r\n\r\n\r\n**Describe the problem**\r\nI'm getting the error Could not load dynamic library \"'cudart64_101.dll'; dlerror: cudart64_101.dll\r\n not found\", even though cuda is installed and the file exists on my computer\r\n![Annotation 2020-01-21 162719](https://user-images.githubusercontent.com/31412003/72844651-f7cf9d80-3c6a-11ea-8133-ffec9d410cca.png)\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\nimport tensorflow as tf\r\nimport pathlib\r\nimport matplotlib.pyplot as plt\r\nimport pandas as pd\r\nimport numpy as np\r\nnp.set_printoptions(precision=4)\r\n\r\nI get these from [https://www.tensorflow.org/guide/data](https://www.tensorflow.org/guide/data)\r\n\r\n**Any other info / logs**\r\n2020-01-21 16:18:17.197417: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'cudart64_101.dll'; dlerror: cudart64_101.dll not found\r\n2020-01-21 16:18:17.197832: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36109", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36109/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36109/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36109/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36109", "id": 553114873, "node_id": "MDU6SXNzdWU1NTMxMTQ4NzM=", "number": 36109, "title": "TFTRT not converting dilated convolutions", "user": {"login": "fferroni", "id": 16327442, "node_id": "MDQ6VXNlcjE2MzI3NDQy", "avatar_url": "https://avatars1.githubusercontent.com/u/16327442?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fferroni", "html_url": "https://github.com/fferroni", "followers_url": "https://api.github.com/users/fferroni/followers", "following_url": "https://api.github.com/users/fferroni/following{/other_user}", "gists_url": "https://api.github.com/users/fferroni/gists{/gist_id}", "starred_url": "https://api.github.com/users/fferroni/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fferroni/subscriptions", "organizations_url": "https://api.github.com/users/fferroni/orgs", "repos_url": "https://api.github.com/users/fferroni/repos", "events_url": "https://api.github.com/users/fferroni/events{/privacy}", "received_events_url": "https://api.github.com/users/fferroni/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 1754777628, "node_id": "MDU6TGFiZWwxNzU0Nzc3NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu:tensorrt", "name": "comp:gpu:tensorrt", "color": "ea98ba", "default": false, "description": "Issues specific to TensorRT"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, {"login": "bixia1", "id": 35820639, "node_id": "MDQ6VXNlcjM1ODIwNjM5", "avatar_url": "https://avatars1.githubusercontent.com/u/35820639?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bixia1", "html_url": "https://github.com/bixia1", "followers_url": "https://api.github.com/users/bixia1/followers", "following_url": "https://api.github.com/users/bixia1/following{/other_user}", "gists_url": "https://api.github.com/users/bixia1/gists{/gist_id}", "starred_url": "https://api.github.com/users/bixia1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bixia1/subscriptions", "organizations_url": "https://api.github.com/users/bixia1/orgs", "repos_url": "https://api.github.com/users/bixia1/repos", "events_url": "https://api.github.com/users/bixia1/events{/privacy}", "received_events_url": "https://api.github.com/users/bixia1/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-01-21T20:35:32Z", "updated_at": "2020-03-09T00:12:06Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): pip\r\n- TensorFlow version (use command below): 1.15\r\n- Python version: 3.6\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: 10, 7\r\n- TensorRT: 5\r\n- GPU model and memory:\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n1.15.0\r\n\r\n**Describe the current behavior**\r\nTFTRT skips dilated convolutions and gives leaves this in the output. Other convolutions work fine.\r\n\r\nThis is what it looks like in Tensorboard: \r\n![dilated_convolution](https://user-images.githubusercontent.com/16327442/72840584-da172e00-3c94-11ea-9068-4c6c93b80c18.png)\r\n\r\nIt appears that there are some BatchToSpaceND and SpaceToBatchND operations. Perhaps these are not supported?\r\n\r\n**Describe the expected behavior**\r\n\r\nBased on the PR that was merged into Tensorflow in January last year (TFTRT: Support Dilated Convolutions #24674) I would expect that converting a convolution with dilations would be supported. Instead it's not... I tried dilation rates of 2, 8, 16...\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n```\r\nfrom tensorflow.python.compiler.tensorrt import trt_convert as trt\r\n\r\nimport tensorflow as tf\r\n\r\ninp = tf.keras.layers.Input(input=(400, 400, 3))\r\nx = tf.keras.layers.Conv2D(8, kernel_size=(3,3), strides=(1,1), dilation_rate=(16,16))(inp)\r\nmodel = tf.keras.models.Model(inp, x) \r\n\r\nsess = tf.keras.backend.get_session()\r\n\r\noutput_nodes = [n.name[:-2] for n in model.outputs]\r\n\r\ngraph_def = tf.graph_util.convert_variables_to_constants(sess, sess.graph.as_graph_def(), output_nodes)\r\n\r\nconverter = trt.TrtGraphConverter(input_graph_def=graph_def,\r\n                                              nodes_blacklist=model.outputs,\r\n                                              precision_mode=\"FP32\",\r\n                                              max_batch_size=1,\r\n                                              minimum_segment_size=1,\r\n                                              max_workspace_size_bytes=(2048>>20),\r\n                                              use_calibration=True)\r\ncalib_graph = converter.convert()\r\n\r\nwith tf.gfile.GFile(\"model.trt.pbtxt\", \"w\") as f:\r\n        f.write(str(calib_graph))\r\n```\r\n\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36107", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36107/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36107/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36107/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36107", "id": 553056318, "node_id": "MDU6SXNzdWU1NTMwNTYzMTg=", "number": 36107, "title": "Tensorflow install breaks curl on Ubuntu", "user": {"login": "John-Nagle", "id": 942608, "node_id": "MDQ6VXNlcjk0MjYwOA==", "avatar_url": "https://avatars3.githubusercontent.com/u/942608?v=4", "gravatar_id": "", "url": "https://api.github.com/users/John-Nagle", "html_url": "https://github.com/John-Nagle", "followers_url": "https://api.github.com/users/John-Nagle/followers", "following_url": "https://api.github.com/users/John-Nagle/following{/other_user}", "gists_url": "https://api.github.com/users/John-Nagle/gists{/gist_id}", "starred_url": "https://api.github.com/users/John-Nagle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/John-Nagle/subscriptions", "organizations_url": "https://api.github.com/users/John-Nagle/orgs", "repos_url": "https://api.github.com/users/John-Nagle/repos", "events_url": "https://api.github.com/users/John-Nagle/events{/privacy}", "received_events_url": "https://api.github.com/users/John-Nagle/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-01-21T18:37:23Z", "updated_at": "2020-02-03T23:10:58Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04 LTS\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary):\r\n- TensorFlow version: 1.15\r\n- Python version: 3.6.7\r\n- Installed using virtualenv? pip? conda?: Virtualenv/pip\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory: NVidia 640\r\n\r\n**Describe the problem**\r\n\r\nRasa install of Tensorflow 1.15 causes a Ubuntu dependency error which prevents \"curl\" from installing, which silently breaks the iDrive backup system.\r\n\r\nThe underlying problem seems to be that Tensorflow tries to build a modified \"curl\" with support for some Google remote file system. See this Tensorflow mod to Curl:\r\n\r\nhttps://github.com/tensorflow/tensorflow/commit/bb890ea5fa4c8a2100a295e93c5bf37b3c88b55a\r\n\r\nThat would be fine if the modified \"curl\" was private to the Tensorflow environment, but somehow the nonstandard version of \"curl\" or \"libcurl\" got installed in the Ubuntu system. This broke the Ubuntu package dependency system, and now a standard \"curl\" cannot be installed. This, in turn, broke things which depend on \"curl\" being present, such as iDrive backups. \r\n\r\nDetails here: https://ubuntuforums.org/showthread.php?t=2435412\r\n\r\nAlso see: https://github.com/RasaHQ/rasa/issues/5104"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36106", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36106/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36106/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36106/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36106", "id": 553004238, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY1NDA4ODk4", "number": 36106, "title": "[ROCm] add ROCm support for XLA RCCL thunk", "user": {"login": "jeffdaily", "id": 904248, "node_id": "MDQ6VXNlcjkwNDI0OA==", "avatar_url": "https://avatars1.githubusercontent.com/u/904248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jeffdaily", "html_url": "https://github.com/jeffdaily", "followers_url": "https://api.github.com/users/jeffdaily/followers", "following_url": "https://api.github.com/users/jeffdaily/following{/other_user}", "gists_url": "https://api.github.com/users/jeffdaily/gists{/gist_id}", "starred_url": "https://api.github.com/users/jeffdaily/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jeffdaily/subscriptions", "organizations_url": "https://api.github.com/users/jeffdaily/orgs", "repos_url": "https://api.github.com/users/jeffdaily/repos", "events_url": "https://api.github.com/users/jeffdaily/events{/privacy}", "received_events_url": "https://api.github.com/users/jeffdaily/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-01-21T16:55:01Z", "updated_at": "2020-03-13T02:11:36Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36106", "html_url": "https://github.com/tensorflow/tensorflow/pull/36106", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36106.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36106.patch"}, "body": ""}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36103", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36103/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36103/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36103/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36103", "id": 552955695, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY1MzY5NzI1", "number": 36103, "title": "Fix: Can't set None on TextVectorization layer's split parameter problem", "user": {"login": "rushabh-v", "id": 46084304, "node_id": "MDQ6VXNlcjQ2MDg0MzA0", "avatar_url": "https://avatars3.githubusercontent.com/u/46084304?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rushabh-v", "html_url": "https://github.com/rushabh-v", "followers_url": "https://api.github.com/users/rushabh-v/followers", "following_url": "https://api.github.com/users/rushabh-v/following{/other_user}", "gists_url": "https://api.github.com/users/rushabh-v/gists{/gist_id}", "starred_url": "https://api.github.com/users/rushabh-v/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rushabh-v/subscriptions", "organizations_url": "https://api.github.com/users/rushabh-v/orgs", "repos_url": "https://api.github.com/users/rushabh-v/repos", "events_url": "https://api.github.com/users/rushabh-v/events{/privacy}", "received_events_url": "https://api.github.com/users/rushabh-v/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1178505529, "node_id": "MDU6TGFiZWwxMTc4NTA1NTI5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/prtype:bugfix", "name": "prtype:bugfix", "color": "159b2e", "default": false, "description": "PR to fix a bug"}, {"id": 987666414, "node_id": "MDU6TGFiZWw5ODc2NjY0MTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/ready%20to%20pull", "name": "ready to pull", "color": "2cd643", "default": false, "description": ""}, {"id": 1169364259, "node_id": "MDU6TGFiZWwxMTY5MzY0MjU5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:XS", "name": "size:XS", "color": "adafea", "default": false, "description": "CL Change Size: Extra Small"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 15, "created_at": "2020-01-21T15:37:03Z", "updated_at": "2020-02-13T11:14:13Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36103", "html_url": "https://github.com/tensorflow/tensorflow/pull/36103", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36103.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36103.patch"}, "body": "resolves: #36071 "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36096", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36096/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36096/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36096/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36096", "id": 552836704, "node_id": "MDU6SXNzdWU1NTI4MzY3MDQ=", "number": 36096, "title": "Performance problems with tf.nn.embedding_lookup in eager mode", "user": {"login": "jjedele", "id": 779877, "node_id": "MDQ6VXNlcjc3OTg3Nw==", "avatar_url": "https://avatars3.githubusercontent.com/u/779877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jjedele", "html_url": "https://github.com/jjedele", "followers_url": "https://api.github.com/users/jjedele/followers", "following_url": "https://api.github.com/users/jjedele/following{/other_user}", "gists_url": "https://api.github.com/users/jjedele/gists{/gist_id}", "starred_url": "https://api.github.com/users/jjedele/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jjedele/subscriptions", "organizations_url": "https://api.github.com/users/jjedele/orgs", "repos_url": "https://api.github.com/users/jjedele/repos", "events_url": "https://api.github.com/users/jjedele/events{/privacy}", "received_events_url": "https://api.github.com/users/jjedele/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-01-21T12:08:09Z", "updated_at": "2020-01-23T18:22:52Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code: Yes - I condensed it to a self-contained example and attach it to the issue.\r\n- OS Platform and Distribution: Ubuntu 18.04.3 LTS\r\n- TensorFlow installed from: binary (pip)\r\n- TensorFlow version: 2.0.0\r\n- Python version: 3.6.8\r\n- CUDA/cuDNN version: CPU only\r\n- GPU model and memory: CPU only\r\n\r\n**Describe the current behavior**\r\ntf.nn.embedding_lookup with eager mode enabled is so slow for me that it is practically unusable. Falling back to Numpy is faster by an order of magnitude.\r\n\r\n**Describe the expected behavior**\r\nThe embedding lookup should perform well enough to be used. Or the information on how to use it properly should be improved.\r\n\r\n**Code to reproduce the issue**\r\nBelow is my benchmarking code. It simulates a static word2vec (3M, 300d) lookup with artificial data under different configurations. I use a static document length of 500 tokens which I found to be the average of my dataset (OpenWebText sample).\r\n[tf-embedding-benchmark.zip](https://github.com/tensorflow/tensorflow/files/4090909/tf-embedding-benchmark.zip)\r\n\r\n**Other info / logs**\r\nBelow is a plot of my benchmarks. I did the benchmarks with little data and therefore there's a bit of variance in the charts. I'm currently running them with some more data, but it takes time because it is so slow. As far I can tell already, the results do not look significantly different though. `embedding_type` refers to the embedding lookup: `numpy` means Numpy indexing using `tf.py_func`. The TensorFlow variants refer to the underlying embedding data structure: `tf.constant` and `tf.Variable` with and without the `trainable` flag set.\r\n\r\n![embedding_lookup_bm](https://user-images.githubusercontent.com/779877/72803346-2be89580-3c4e-11ea-9fd7-c0a4a5525eeb.png)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36094", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36094/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36094/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36094/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36094", "id": 552759363, "node_id": "MDU6SXNzdWU1NTI3NTkzNjM=", "number": 36094, "title": "SlurmClusterResolver should use env variables ob job step and return correct num_accelerators", "user": {"login": "Flamefire", "id": 309017, "node_id": "MDQ6VXNlcjMwOTAxNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/309017?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Flamefire", "html_url": "https://github.com/Flamefire", "followers_url": "https://api.github.com/users/Flamefire/followers", "following_url": "https://api.github.com/users/Flamefire/following{/other_user}", "gists_url": "https://api.github.com/users/Flamefire/gists{/gist_id}", "starred_url": "https://api.github.com/users/Flamefire/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Flamefire/subscriptions", "organizations_url": "https://api.github.com/users/Flamefire/orgs", "repos_url": "https://api.github.com/users/Flamefire/repos", "events_url": "https://api.github.com/users/Flamefire/events{/privacy}", "received_events_url": "https://api.github.com/users/Flamefire/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-01-21T09:45:07Z", "updated_at": "2020-01-23T15:01:39Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "The [SlurmClusterResolver](https://github.com/tensorflow/tensorflow/blob/96d0f42d1b236d21157d32805d4aa87e136083b3/tensorflow/python/distribute/cluster_resolver/slurm_cluster_resolver.py) has a few issues:\r\n\r\n- `num_accelerators` returns the GPUs per **node**  although they should be per ** task** according to usage\r\n- It uses scontrol which may not return the correct values (see next point)\r\n- Slurm job steps might use different configurations than its job. E.g. after allocating 1 task with 10 cpus and gpus one might run a job step with 10 tasks and 1 cpu and gpu each. This is currently ignored leading to wrong behavior\r\n\r\nExample: From inside an allocation with 1 task and 1 node the following will print a single hostname each, and not 2 times the same hostname each: `srun --ntasks 2 --cpus-per-task=5 scontrol show hostname`\r\n\r\nProposed fix:\r\n- Use environment variables `SLURM_*` instead of `scontrol`\r\n- When exists, use `SLURM_STEP_*` variables instead of its corresponding job variable. It might even be reasonable to NOT use the job variables at all as it doesn't make sense to run TF in the context of a job and not a job step (difference: after `salloc` or `sbatch` you'll run in the context of a job in a single instance, `srun` from inside such an allocation then starts a step and distributes execution. `srun` can also be used to implicitly call `salloc`)\r\n\r\nI have developed a version based on the current cluster resolver which implements the above and uses https://pypi.org/project/python-hostlist to parse the tasks per node (it is possible that slurm allocates 3 tasks on the first node and 2 tasks on the second when allocating 5 tasks) and expanding the hostlist (the format used is something like `[n1-n3, n5]`.   \r\n\r\nIn the current version it makes heavy use of default values so it is possible to simply create an instance of `SlurmClusterResolver` with **no** arguments and it will fill out everything from the environment of the current job step or job. The goal was to relieve users from any fiddling with information available already and just use e.g. `MultiWorkerMirroredStrategy`\r\n\r\nIs there interest in reviewing and accepting a PR with my improved version?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36081", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36081/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36081/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36081/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36081", "id": 552573428, "node_id": "MDU6SXNzdWU1NTI1NzM0Mjg=", "number": 36081, "title": "Which distributed strategy should I use when running training without GPU?", "user": {"login": "pingsutw", "id": 37936015, "node_id": "MDQ6VXNlcjM3OTM2MDE1", "avatar_url": "https://avatars2.githubusercontent.com/u/37936015?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pingsutw", "html_url": "https://github.com/pingsutw", "followers_url": "https://api.github.com/users/pingsutw/followers", "following_url": "https://api.github.com/users/pingsutw/following{/other_user}", "gists_url": "https://api.github.com/users/pingsutw/gists{/gist_id}", "starred_url": "https://api.github.com/users/pingsutw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pingsutw/subscriptions", "organizations_url": "https://api.github.com/users/pingsutw/orgs", "repos_url": "https://api.github.com/users/pingsutw/repos", "events_url": "https://api.github.com/users/pingsutw/events{/privacy}", "received_events_url": "https://api.github.com/users/pingsutw/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-01-21T01:14:00Z", "updated_at": "2020-01-22T10:08:48Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "There are many distributed strategy in Tensorflow,\r\n\r\n- MirroredStrategy\r\n- TPUStrategy\r\n- MultiWorkerMirroredStrategy\r\n- CentralStorageStrategy\r\n- ParameterServerStrategy\r\n- OneDeviceStrategy\r\n\r\nSome of them run on one machine and broadcast model to different GPUs, and some of them use different GPUs on different machines.\r\n\r\nMy question if I don't have GPU in my server, which strategy should I use, so I can get the benefit when running distributed training?\r\n\r\nI try to run MirroredStrategy, ParameterServerStrategy on four machines, but it seems that it's slower than running on a single machine."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36072", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36072/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36072/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36072/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36072", "id": 552429490, "node_id": "MDU6SXNzdWU1NTI0Mjk0OTA=", "number": 36072, "title": "hangs on model.fit", "user": {"login": "liuxingbaoyu", "id": 30521560, "node_id": "MDQ6VXNlcjMwNTIxNTYw", "avatar_url": "https://avatars2.githubusercontent.com/u/30521560?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liuxingbaoyu", "html_url": "https://github.com/liuxingbaoyu", "followers_url": "https://api.github.com/users/liuxingbaoyu/followers", "following_url": "https://api.github.com/users/liuxingbaoyu/following{/other_user}", "gists_url": "https://api.github.com/users/liuxingbaoyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/liuxingbaoyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liuxingbaoyu/subscriptions", "organizations_url": "https://api.github.com/users/liuxingbaoyu/orgs", "repos_url": "https://api.github.com/users/liuxingbaoyu/repos", "events_url": "https://api.github.com/users/liuxingbaoyu/events{/privacy}", "received_events_url": "https://api.github.com/users/liuxingbaoyu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 17, "created_at": "2020-01-20T17:28:39Z", "updated_at": "2020-03-15T18:17:09Z", "closed_at": null, "author_association": "NONE", "body": "Although I can't extract the code to reproduce the problem, I think that documenting it here will help improve this project and anyone who encounters the same problem.\r\n\r\nSystem: Windows 10\r\nVersion: tf-nightly-gpu 2020.1.19\r\n\r\nI use `tf.data.Dataset` to provide samples\r\nWhen I use `GPU + eager + batch_size > 16`, it will hang on `model.fit` and continue to occupy a core CPU\r\nWhen I use cpu or turn off eager mode or set batch <= 16, he will run normally.\r\n\r\nIt will continue like this\r\n\r\n> 2020-01-21 01:20:24.249995: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_10.dll\r\n2020-01-21 01:20:28.403903: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll\r\n2020-01-21 01:20:29.708097: W tensorflow/stream_executor/gpu/redzone_allocator.cc:312] Internal: Invoking GPU asm compilation is supported on Cuda non-Windows platforms only\r\nRelying on driver to perform ptx compilation. \r\nModify $PATH to customize ptxas location.\r\nThis message will be only logged once.\r\n   9/1406 [..............................] - ETA: 42:30 - loss: 30.3274 - accuracy: 0.0000e+00"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36071", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36071/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36071/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36071/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36071", "id": 552424756, "node_id": "MDU6SXNzdWU1NTI0MjQ3NTY=", "number": 36071, "title": "Can't set None on TextVectorization layer's split parameter.", "user": {"login": "stefanondisponibile", "id": 20441825, "node_id": "MDQ6VXNlcjIwNDQxODI1", "avatar_url": "https://avatars3.githubusercontent.com/u/20441825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stefanondisponibile", "html_url": "https://github.com/stefanondisponibile", "followers_url": "https://api.github.com/users/stefanondisponibile/followers", "following_url": "https://api.github.com/users/stefanondisponibile/following{/other_user}", "gists_url": "https://api.github.com/users/stefanondisponibile/gists{/gist_id}", "starred_url": "https://api.github.com/users/stefanondisponibile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stefanondisponibile/subscriptions", "organizations_url": "https://api.github.com/users/stefanondisponibile/orgs", "repos_url": "https://api.github.com/users/stefanondisponibile/repos", "events_url": "https://api.github.com/users/stefanondisponibile/events{/privacy}", "received_events_url": "https://api.github.com/users/stefanondisponibile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-01-20T17:17:18Z", "updated_at": "2020-01-30T01:18:26Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): `no`\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): `Ubuntu 18.04`\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: `no`\r\n- TensorFlow installed from (source or binary): `no`\r\n- TensorFlow version (use command below): `2.0.0`\r\n- Python version: `3.7.3`\r\n- Bazel version (if compiling from source): `-`\r\n- GCC/Compiler version (if compiling from source): `-`\r\n- CUDA/cuDNN version: `-`\r\n- GPU model and memory: `-`\r\n\r\n**Describe the current behavior**\r\nThe TextVectorization layer `split` parameter expects `None` as a possible value but can't handle it.\r\n\r\n**Describe the expected behavior**\r\nThe layer should work properly when `None` is passed as a `split` parameter, or documentation should be updated.\r\n\r\n**Code to reproduce the issue**\r\n```python\r\nimport numpy as np\r\nimport tensorflow as tf\r\nfrom tensorflow.keras.layers.experimental.preprocessing import TextVectorization\r\nfrom pprint import pprint\r\nassert tf.__version__ == '2.1.0-rc1'\r\n\r\ndummy_data = [\"Foo\", \"bar\", \"foo foo\", \"foo bar\", \"foobar.\"]\r\npredict_data = [\"foo\", \"bar\", \"foobar\", \"foo foo\", \"OOV\"]\r\ninputs = tf.keras.layers.Input(shape=(1, ), dtype=tf.string, name=\"text\")\r\nvectorize_layer = TextVectorization(output_mode=\"binary\", max_tokens=5, split=None)\r\nvectorize_layer.adapt(np.asarray(dummy_data))\r\nprint(f\"Vocabulary:\\t\\t{vectorize_layer.get_vocabulary()}\")\r\noutputs = vectorize_layer(inputs)\r\nmodel = tf.keras.Model(inputs, outputs)\r\nprint(f\"Prediction data:\\t{predict_data}\")\r\npredictions = model.predict(predict_data)\r\nprint(f\"Predictions:\")\r\npprint(predictions)\r\n\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-3-f1a03cb1e414> in <module>()\r\n      9 inputs = tf.keras.layers.Input(shape=(1, ), dtype=tf.string, name=\"text\")\r\n     10 vectorize_layer = TextVectorization(output_mode=\"binary\", max_tokens=5, split=None)\r\n---> 11 vectorize_layer.adapt(np.asarray(dummy_data))\r\n     12 print(f\"Vocabulary:\\t\\t{vectorize_layer.get_vocabulary()}\")\r\n     13 outputs = vectorize_layer(inputs)\r\n\r\n/tensorflow-2.1.0/python3.6/tensorflow_core/python/keras/layers/preprocessing/text_vectorization.py in _to_numpy(self, preprocessed_data)\r\n    334     if isinstance(preprocessed_data, np.ndarray):\r\n    335       return preprocessed_data\r\n    336     return np.array(preprocessed_data.to_list())\r\nAttributeError: 'tensorflow.python.framework.ops.EagerTensor' object has no attribute 'to_list'\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36059", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36059/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36059/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36059/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36059", "id": 552218087, "node_id": "MDU6SXNzdWU1NTIyMTgwODc=", "number": 36059, "title": "Cannot convert between a TensorFlowLite buffer with 1392640 bytes and a Java Buffer with 4177920 bytes.", "user": {"login": "nauyan", "id": 16066688, "node_id": "MDQ6VXNlcjE2MDY2Njg4", "avatar_url": "https://avatars3.githubusercontent.com/u/16066688?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nauyan", "html_url": "https://github.com/nauyan", "followers_url": "https://api.github.com/users/nauyan/followers", "following_url": "https://api.github.com/users/nauyan/following{/other_user}", "gists_url": "https://api.github.com/users/nauyan/gists{/gist_id}", "starred_url": "https://api.github.com/users/nauyan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nauyan/subscriptions", "organizations_url": "https://api.github.com/users/nauyan/orgs", "repos_url": "https://api.github.com/users/nauyan/repos", "events_url": "https://api.github.com/users/nauyan/events{/privacy}", "received_events_url": "https://api.github.com/users/nauyan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 14, "created_at": "2020-01-20T10:44:21Z", "updated_at": "2020-02-14T07:00:42Z", "closed_at": null, "author_association": "NONE", "body": "I am using Tensorflow.Lite.Support function for Inference of a model that takes two input and gives output in the form of Image. The first input is an RGB image whereas the second image is a single-channel image.When I run the application for inference I get the error that is:\r\n\r\n**Cannot convert between a TensorFlowLite buffer with 1392640 bytes and a Java Buffer with 4177920 bytes.**\r\n\r\nI have attached my code snippet below:\r\n```\r\nprotected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_main);\r\n        Toolbar toolbar = findViewById(R.id.toolbar);\r\n        setSupportActionBar(toolbar);\r\n\r\n        FloatingActionButton fab = findViewById(R.id.fab);\r\n        fab.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                Snackbar.make(view, \"Replace with your own action\", Snackbar.LENGTH_LONG)\r\n                        .setAction(\"Action\", null).show();\r\n            }\r\n        });\r\n\r\n        try {\r\n            tflite = new Interpreter(loadModelFile(MainActivity.this, \"converted_model.tflite\"));\r\n\r\n\r\n            Bitmap Image = getBitmapFromAsset(this,\"001.png\");\r\n            Bitmap Mask = getBitmapFromAsset(this,\"tmp_mask.png\");\r\n\r\n            int imageTensorIndex = 0;\r\n            int[] imageShape = tflite.getInputTensor(imageTensorIndex).shape(); // {1, height, width, 3}\r\n            int imageSizeY = imageShape[1];\r\n            int imageSizeX = imageShape[2];\r\n            DataType imageDataType = tflite.getInputTensor(imageTensorIndex).dataType();\r\n\r\n            TensorImage inputImageBuffer = new TensorImage(imageDataType);\r\n            inputImageBuffer.load(Image);\r\n\r\n            int imageTensorIndex1 = 1;\r\n            int[] imageShape1 = tflite.getInputTensor(imageTensorIndex1).shape(); // {1, height, width, 3}\r\n            int imageSizeY1 = imageShape1[1];\r\n            int imageSizeX1 = imageShape1[2];\r\n            DataType imageDataType1 = tflite.getInputTensor(imageTensorIndex1).dataType();\r\n\r\n            TensorImage inputImageBuffer1 = new TensorImage(imageDataType1);\r\n            inputImageBuffer1.load(Mask);\r\n\r\n\r\n            int OutputTensorIndex = 0;\r\n            int[] OutputShape =\r\n                    tflite.getOutputTensor(OutputTensorIndex).shape(); // {1, NUM_CLASSES}\r\n            DataType OutputDataType = tflite.getOutputTensor(OutputTensorIndex).dataType();\r\n\r\n            TensorBuffer outputBuffer = TensorBuffer.createFixedSize(OutputShape, OutputDataType);\r\n\r\n            Object[] Inputs = {inputImageBuffer.getBuffer(),inputImageBuffer1.getBuffer()};\r\n\r\n            Map<Integer, Object> outputs = new HashMap<>();\r\n            outputs.put(0,outputBuffer);\r\n            tflite.runForMultipleInputsOutputs(Inputs, outputs);\r\n\r\n            Toast.makeText(this,\"Working\",Toast.LENGTH_LONG).show();\r\n  \r\n        } catch (IOException e) {\r\n            Toast.makeText(this,\"Failed\",Toast.LENGTH_LONG).show();\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36057", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36057/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36057/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36057/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36057", "id": 552177811, "node_id": "MDU6SXNzdWU1NTIxNzc4MTE=", "number": 36057, "title": "Execution platform: @bazel_tools//platforms:host_platform: bash failed: error executing command", "user": {"login": "jiapei100", "id": 154013, "node_id": "MDQ6VXNlcjE1NDAxMw==", "avatar_url": "https://avatars1.githubusercontent.com/u/154013?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jiapei100", "html_url": "https://github.com/jiapei100", "followers_url": "https://api.github.com/users/jiapei100/followers", "following_url": "https://api.github.com/users/jiapei100/following{/other_user}", "gists_url": "https://api.github.com/users/jiapei100/gists{/gist_id}", "starred_url": "https://api.github.com/users/jiapei100/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jiapei100/subscriptions", "organizations_url": "https://api.github.com/users/jiapei100/orgs", "repos_url": "https://api.github.com/users/jiapei100/repos", "events_url": "https://api.github.com/users/jiapei100/events{/privacy}", "received_events_url": "https://api.github.com/users/jiapei100/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-01-20T09:32:53Z", "updated_at": "2020-02-21T18:47:08Z", "closed_at": null, "author_association": "NONE", "body": "\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): 18.04.3\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version: 2.x\r\n- Python version: 3.8.1\r\n- Installed using virtualenv? pip? conda?: pip \r\n- Bazel version (if compiling from source): 0.26.1 with \r\n- GCC/Compiler version (if compiling from source): gcc (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0\r\n- CUDA/cuDNN version: 10.2 / 7.6.5\r\n- TensorRT: 7.0.0\r\n- GPU model and memory: compute capability 5.2 \r\n\r\n\r\n\r\n**Describe the problem**\r\n\r\n```console\r\nERROR: ....../tensorflow/python/BUILD:7692:1: Executing genrule //tensorflow/python:framework/fast_tensor_util.pyx_cython_translation failed (Profiling timer expired): bash failed: error executing command \r\n  (cd ~/.cache/bazel/_bazel_longervision/90066176d51f3058b5ce7c4e1b3a40d7/execroot/org_tensorflow && \\\r\n  exec env - \\\r\n    CUDA_TOOLKIT_PATH=/usr/local/cuda \\\r\n    GCC_HOST_COMPILER_PATH=/usr/bin/x86_64-linux-gnu-gcc-7 \\\r\n    LD_LIBRARY_PATH=/opt/Qt/Current/gcc_64/lib:/opt/Qt/Current/gcc_64/plugins/platforms:/usr/local/lib:/usr/lib/x86_64-linux-gnu:/usr/lib:/lib:/lib64:/lib/x86_64-linux-gnu:/opt/intel/compilers_and_libraries/linux/daal/lib/intel64:/opt/intel/compilers_and_libraries/linux/ipp/lib/intel64:/opt/intel/compilers_and_libraries/linux/mkl/lib/intel64:/opt/intel/compilers_and_libraries/linux/mpi/intel64/lib:/opt/intel/compilers_and_libraries/linux/mpi/intel64/lib/release:/opt/intel/compilers_and_libraries/linux/tbb/lib/intel64/gcc4.7:/opt/intel/compilers_and_libraries/linux/lib/intel64:/opt/intel/openvino/inference_engine/lib/intel64:/usr/local/cuda/targets/x86_64-linux/lib:/opt/mcu/arduino/lib:/usr/lib/jvm/default-java/lib: \\\r\n    PATH=~/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/opt/Qt/Current/gcc_64/bin:/opt/intel/compilers_and_libraries/linux/daal/bin:/opt/intel/compilers_and_libraries/linux/ipp/bin:/opt/intel/compilers_and_libraries/linux/mkl/bin:/opt/intel/compilers_and_libraries/linux/mpi/intel64/bin:/opt/intel/compilers_and_libraries/linux/tbb/bin:/opt/intel/compilers_and_libraries/linux/bin:/usr/local/cuda/bin:/usr/local/cuda/samples/bin/x86_64/linux/release:/opt/node/bin:/usr/lib/jvm/default-java/bin \\\r\n    PYTHONPATH=~/.local/lib/python3.8/site-packages:/usr/lib/python3.8/site-packages:/usr/local/lib/python3.8/site-packages:/usr/lib/python3/dist-packages \\\r\n    PYTHON_BIN_PATH=/usr/bin/python \\\r\n    PYTHON_LIB_PATH=~/.local/lib/python3.8/site-packages \\\r\n    TF2_BEHAVIOR=1 \\\r\n    TF_CONFIGURE_IOS=0 \\\r\n    TF_CUDA_COMPUTE_CAPABILITIES=5.2 \\\r\n    TF_NEED_CUDA=1 \\\r\n    TF_NEED_TENSORRT=1 \\\r\n  /bin/bash -c 'source external/bazel_tools/tools/genrule/genrule-setup.sh; PYTHONHASHSEED=0 bazel-out/host/bin/external/cython/cython_binary --cplus tensorflow/python/framework/fast_tensor_util.pyx --output-file bazel-out/k8-opt/bin/tensorflow/python/framework/fast_tensor_util.cpp')\r\nExecution platform: @bazel_tools//platforms:host_platform: bash failed: error executing command \r\n  (cd ~/.cache/bazel/_bazel_longervision/90066176d51f3058b5ce7c4e1b3a40d7/execroot/org_tensorflow && \\\r\n  exec env - \\\r\n    CUDA_TOOLKIT_PATH=/usr/local/cuda \\\r\n    GCC_HOST_COMPILER_PATH=/usr/bin/x86_64-linux-gnu-gcc-7 \\\r\n    LD_LIBRARY_PATH=/opt/Qt/Current/gcc_64/lib:/opt/Qt/Current/gcc_64/plugins/platforms:/usr/local/lib:/usr/lib/x86_64-linux-gnu:/usr/lib:/lib:/lib64:/lib/x86_64-linux-gnu:/opt/intel/compilers_and_libraries/linux/daal/lib/intel64:/opt/intel/compilers_and_libraries/linux/ipp/lib/intel64:/opt/intel/compilers_and_libraries/linux/mkl/lib/intel64:/opt/intel/compilers_and_libraries/linux/mpi/intel64/lib:/opt/intel/compilers_and_libraries/linux/mpi/intel64/lib/release:/opt/intel/compilers_and_libraries/linux/tbb/lib/intel64/gcc4.7:/opt/intel/compilers_and_libraries/linux/lib/intel64:/opt/intel/openvino/inference_engine/lib/intel64:/usr/local/cuda/targets/x86_64-linux/lib:/opt/mcu/arduino/lib:/usr/lib/jvm/default-java/lib: \\\r\n    PATH=~/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/opt/Qt/Current/gcc_64/bin:/opt/intel/compilers_and_libraries/linux/daal/bin:/opt/intel/compilers_and_libraries/linux/ipp/bin:/opt/intel/compilers_and_libraries/linux/mkl/bin:/opt/intel/compilers_and_libraries/linux/mpi/intel64/bin:/opt/intel/compilers_and_libraries/linux/tbb/bin:/opt/intel/compilers_and_libraries/linux/bin:/usr/local/cuda/bin:/usr/local/cuda/samples/bin/x86_64/linux/release:/opt/node/bin:/usr/lib/jvm/default-java/bin \\\r\n    PYTHONPATH=~/.local/lib/python3.8/site-packages:/usr/lib/python3.8/site-packages:/usr/local/lib/python3.8/site-packages:/usr/lib/python3/dist-packages \\\r\n    PYTHON_BIN_PATH=/usr/bin/python \\\r\n    PYTHON_LIB_PATH=~/.local/lib/python3.8/site-packages \\\r\n    TF2_BEHAVIOR=1 \\\r\n    TF_CONFIGURE_IOS=0 \\\r\n    TF_CUDA_COMPUTE_CAPABILITIES=5.2 \\\r\n    TF_NEED_CUDA=1 \\\r\n    TF_NEED_TENSORRT=1 \\\r\n  /bin/bash -c 'source external/bazel_tools/tools/genrule/genrule-setup.sh; PYTHONHASHSEED=0 bazel-out/host/bin/external/cython/cython_binary --cplus tensorflow/python/framework/fast_tensor_util.pyx --output-file bazel-out/k8-opt/bin/tensorflow/python/framework/fast_tensor_util.cpp')\r\nExecution platform: @bazel_tools//platforms:host_platform\r\n/bin/bash: line 1:  2347 Profiling timer expired PYTHONHASHSEED=0 bazel-out/host/bin/external/cython/cython_binary --cplus tensorflow/python/framework/fast_tensor_util.pyx --output-file bazel-out/k8-opt/bin/tensorflow/python/framework/fast_tensor_util.cpp\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nINFO: Elapsed time: 374.150s, Critical Path: 84.85s\r\nINFO: 1334 processes: 1334 local.\r\nFAILED: Build did NOT complete successfully\r\n\u279c  tensorflow git:(master) \u2717 \r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36055", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36055/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36055/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36055/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36055", "id": 552121455, "node_id": "MDU6SXNzdWU1NTIxMjE0NTU=", "number": 36055, "title": "TFLite Android Model Benchmark Tool -- results not showing up in adb logcat", "user": {"login": "forresti", "id": 2020010, "node_id": "MDQ6VXNlcjIwMjAwMTA=", "avatar_url": "https://avatars1.githubusercontent.com/u/2020010?v=4", "gravatar_id": "", "url": "https://api.github.com/users/forresti", "html_url": "https://github.com/forresti", "followers_url": "https://api.github.com/users/forresti/followers", "following_url": "https://api.github.com/users/forresti/following{/other_user}", "gists_url": "https://api.github.com/users/forresti/gists{/gist_id}", "starred_url": "https://api.github.com/users/forresti/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/forresti/subscriptions", "organizations_url": "https://api.github.com/users/forresti/orgs", "repos_url": "https://api.github.com/users/forresti/repos", "events_url": "https://api.github.com/users/forresti/events{/privacy}", "received_events_url": "https://api.github.com/users/forresti/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "multiverse-tf", "id": 48348070, "node_id": "MDQ6VXNlcjQ4MzQ4MDcw", "avatar_url": "https://avatars0.githubusercontent.com/u/48348070?v=4", "gravatar_id": "", "url": "https://api.github.com/users/multiverse-tf", "html_url": "https://github.com/multiverse-tf", "followers_url": "https://api.github.com/users/multiverse-tf/followers", "following_url": "https://api.github.com/users/multiverse-tf/following{/other_user}", "gists_url": "https://api.github.com/users/multiverse-tf/gists{/gist_id}", "starred_url": "https://api.github.com/users/multiverse-tf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/multiverse-tf/subscriptions", "organizations_url": "https://api.github.com/users/multiverse-tf/orgs", "repos_url": "https://api.github.com/users/multiverse-tf/repos", "events_url": "https://api.github.com/users/multiverse-tf/events{/privacy}", "received_events_url": "https://api.github.com/users/multiverse-tf/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "multiverse-tf", "id": 48348070, "node_id": "MDQ6VXNlcjQ4MzQ4MDcw", "avatar_url": "https://avatars0.githubusercontent.com/u/48348070?v=4", "gravatar_id": "", "url": "https://api.github.com/users/multiverse-tf", "html_url": "https://github.com/multiverse-tf", "followers_url": "https://api.github.com/users/multiverse-tf/followers", "following_url": "https://api.github.com/users/multiverse-tf/following{/other_user}", "gists_url": "https://api.github.com/users/multiverse-tf/gists{/gist_id}", "starred_url": "https://api.github.com/users/multiverse-tf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/multiverse-tf/subscriptions", "organizations_url": "https://api.github.com/users/multiverse-tf/orgs", "repos_url": "https://api.github.com/users/multiverse-tf/repos", "events_url": "https://api.github.com/users/multiverse-tf/events{/privacy}", "received_events_url": "https://api.github.com/users/multiverse-tf/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-01-20T07:41:48Z", "updated_at": "2020-03-06T08:22:52Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution: Ubuntu 18.04\r\n- Mobile device: Pixel 3\r\n- TensorFlow installed from: source\r\n- TensorFlow version: From master branch, commit hash 69ac54d92de18ca18f9a110d6dd464aeb1116342. Compiled tensorflow with `./configure` and then `bazel build --config=v1 //tensorflow/tools/pip_package:build_pip_package`.\r\n- Python version: 3.6\r\n- Installed using: conda\r\n- Bazel version (if compiling from source): 1.2.1\r\n- GCC/Compiler version (if compiling from source): 7.4, and compiling with c++14 flag\r\n- CUDA/cuDNN version: not using gpu for this experiment\r\n- GPU model and memory: not using gpu for this experiment\r\n- TFLite model that I am trying to benchmark: `mobilenet_v1_0.25_192_quant.tflite` from [this page](https://www.tensorflow.org/lite/guide/hosted_models). Note that I do have some more exotic models that I'd like to benchmark, but I am starting with an off-the-shelf model from an official tensorflow page.\r\n\r\n\r\n**Describe the problem**\r\n\r\nI am trying to benchmark the speed of a tflite model on a pixel 3. \r\n\r\nOn an ubuntu computer, with a Pixel 3 in developer mode connected via USB, I followed steps 1 to 5 in **[this readme](https://github.com/tensorflow/tensorflow/tree/master/tensorflow/lite/tools/benchmark/android/README.md)**. I did not get a single error message. When I get to step 4, I get the following output:\r\n\r\n```\r\nStopping: org.tensorflow.lite.benchmark\r\nStarting: Intent { cmp=org.tensorflow.lite.benchmark/.BenchmarkModelActivity (has extras) }\r\n```\r\n\r\nWhile running step 4, I have an other terminal window open with `adb logcat` running. Unfortunately, the phrase `Average inference` doesn't show up in the `logcat` output, and the only relevant thing in `logcat` is `01-19 23:30:20.449  1357  3307 I ActivityTaskManager: START u0 {flg=0x10000000 cmp=org.tensorflow.lite.benchmark/.BenchmarkModelActivity (has extras)} from uid 2000`, but there are no latency numbers showing up in `logcat`. \r\n\r\nAny idea what I am doing wrong, and what's preventing the latency numbers from showing up in `logcat`?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36054", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36054/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36054/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36054/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36054", "id": 552090556, "node_id": "MDU6SXNzdWU1NTIwOTA1NTY=", "number": 36054, "title": "Failed build on windows wtih MKL", "user": {"login": "Korsar13", "id": 44565681, "node_id": "MDQ6VXNlcjQ0NTY1Njgx", "avatar_url": "https://avatars0.githubusercontent.com/u/44565681?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Korsar13", "html_url": "https://github.com/Korsar13", "followers_url": "https://api.github.com/users/Korsar13/followers", "following_url": "https://api.github.com/users/Korsar13/following{/other_user}", "gists_url": "https://api.github.com/users/Korsar13/gists{/gist_id}", "starred_url": "https://api.github.com/users/Korsar13/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Korsar13/subscriptions", "organizations_url": "https://api.github.com/users/Korsar13/orgs", "repos_url": "https://api.github.com/users/Korsar13/repos", "events_url": "https://api.github.com/users/Korsar13/events{/privacy}", "received_events_url": "https://api.github.com/users/Korsar13/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1104829434, "node_id": "MDU6TGFiZWwxMTA0ODI5NDM0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:mkl", "name": "comp:mkl", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1188421838, "node_id": "MDU6TGFiZWwxMTg4NDIxODM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:windows", "name": "subtype:windows", "color": "b619ea", "default": false, "description": "Windows Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, {"login": "preethivenkatesh", "id": 32650358, "node_id": "MDQ6VXNlcjMyNjUwMzU4", "avatar_url": "https://avatars2.githubusercontent.com/u/32650358?v=4", "gravatar_id": "", "url": "https://api.github.com/users/preethivenkatesh", "html_url": "https://github.com/preethivenkatesh", "followers_url": "https://api.github.com/users/preethivenkatesh/followers", "following_url": "https://api.github.com/users/preethivenkatesh/following{/other_user}", "gists_url": "https://api.github.com/users/preethivenkatesh/gists{/gist_id}", "starred_url": "https://api.github.com/users/preethivenkatesh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/preethivenkatesh/subscriptions", "organizations_url": "https://api.github.com/users/preethivenkatesh/orgs", "repos_url": "https://api.github.com/users/preethivenkatesh/repos", "events_url": "https://api.github.com/users/preethivenkatesh/events{/privacy}", "received_events_url": "https://api.github.com/users/preethivenkatesh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-01-20T06:16:46Z", "updated_at": "2020-02-18T17:08:46Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10 Pro\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version: 2.1 master branch, git rev-parse HEAD : 6bc6e8df2c515c229735c4bd85b7ff5084dfccef\r\n- Python version: 3.8\r\n- Installed using virtualenv? pip? conda?: virtualenv\r\n- Bazel version (if compiling from source): 1.2.1\r\n- GCC/Compiler version (if compiling from source): msvc 2019\r\n- CUDA/cuDNN version: disabled\r\n- GPU model and memory: \r\n\r\nconfigure: No XLA/Cuda/RocM, no \"disable Eigen strong inline\"\r\noptimization flags: -O2 -fp:fast -Ob3\r\n\r\napplied patch from https://github.com/tensorflow/tensorflow/issues/25213#issuecomment-501564390\r\n\r\nbuild command:\r\n`bazel --output_base=C:\\Lib\\.bazel\\tf-noavx-mkl build --jobs 6 --config=mkl --config=monolithic --config=opt --config=v2 //tensorflow/tools/pip_package:build_pip_package`\r\n\r\nbuild error:\r\n```\r\nERROR: F:/lib/tensorflow/tensorflow/BUILD:868:1: Executing genrule //tensorflow:tf_python_api_gen_v2 failed (Exit 1)\r\nTraceback (most recent call last):\r\n  File \"\\\\?\\F:\\Temp\\Bazel.runfiles_ejm1kz55\\runfiles\\org_tensorflow\\tensorflow\\python\\pywrap_tensorflow.py\", line 58, in <module>\r\n    from tensorflow.python.pywrap_tensorflow_internal import *\r\n  File \"\\\\?\\F:\\Temp\\Bazel.runfiles_ejm1kz55\\runfiles\\org_tensorflow\\tensorflow\\python\\pywrap_tensorflow_internal.py\", line 28, in <module>\r\n    _pywrap_tensorflow_internal = swig_import_helper()\r\n  File \"\\\\?\\F:\\Temp\\Bazel.runfiles_ejm1kz55\\runfiles\\org_tensorflow\\tensorflow\\python\\pywrap_tensorflow_internal.py\", line 24, in swig_import_helper\r\n    _mod = imp.load_module('_pywrap_tensorflow_internal', fp, pathname, description)\r\n  File \"C:\\K13\\tf-noavx\\lib\\imp.py\", line 242, in load_module\r\n    return load_dynamic(name, filename, file)\r\n  File \"C:\\K13\\tf-noavx\\lib\\imp.py\", line 342, in load_dynamic\r\n    return _load(spec)\r\nImportError: DLL load failed while importing _pywrap_tensorflow_internal: The specified module could not be found.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"\\\\?\\F:\\Temp\\Bazel.runfiles_ejm1kz55\\runfiles\\org_tensorflow\\tensorflow\\python\\tools\\api\\generator\\create_python_api.py\", line 27, in <module>\r\n    from tensorflow.python.tools.api.generator import doc_srcs\r\n  File \"\\\\?\\F:\\Temp\\Bazel.runfiles_ejm1kz55\\runfiles\\org_tensorflow\\tensorflow\\python\\__init__.py\", line 50, in <module>\r\n    from tensorflow.python import pywrap_tensorflow\r\n  File \"\\\\?\\F:\\Temp\\Bazel.runfiles_ejm1kz55\\runfiles\\org_tensorflow\\tensorflow\\python\\pywrap_tensorflow.py\", line 74, in <module>\r\n    raise ImportError(msg)\r\nImportError: Traceback (most recent call last):\r\n  File \"\\\\?\\F:\\Temp\\Bazel.runfiles_ejm1kz55\\runfiles\\org_tensorflow\\tensorflow\\python\\pywrap_tensorflow.py\", line 58, in <module>\r\n    from tensorflow.python.pywrap_tensorflow_internal import *\r\n  File \"\\\\?\\F:\\Temp\\Bazel.runfiles_ejm1kz55\\runfiles\\org_tensorflow\\tensorflow\\python\\pywrap_tensorflow_internal.py\", line 28, in <module>\r\n    _pywrap_tensorflow_internal = swig_import_helper()\r\n  File \"\\\\?\\F:\\Temp\\Bazel.runfiles_ejm1kz55\\runfiles\\org_tensorflow\\tensorflow\\python\\pywrap_tensorflow_internal.py\", line 24, in swig_import_helper\r\n    _mod = imp.load_module('_pywrap_tensorflow_internal', fp, pathname, description)\r\n  File \"C:\\K13\\tf-noavx\\lib\\imp.py\", line 242, in load_module\r\n    return load_dynamic(name, filename, file)\r\n  File \"C:\\K13\\tf-noavx\\lib\\imp.py\", line 342, in load_dynamic\r\n    return _load(spec)\r\nImportError: DLL load failed while importing _pywrap_tensorflow_internal: The specified module could not be found.\r\n\r\n\r\nFailed to load the native TensorFlow runtime.\r\n\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36044", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36044/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36044/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36044/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36044", "id": 551999712, "node_id": "MDU6SXNzdWU1NTE5OTk3MTI=", "number": 36044, "title": "Simple keras model, Model.fit() does not learn unless experimental_run_tf_function=False at compile", "user": {"login": "fcarsten", "id": 554786, "node_id": "MDQ6VXNlcjU1NDc4Ng==", "avatar_url": "https://avatars1.githubusercontent.com/u/554786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fcarsten", "html_url": "https://github.com/fcarsten", "followers_url": "https://api.github.com/users/fcarsten/followers", "following_url": "https://api.github.com/users/fcarsten/following{/other_user}", "gists_url": "https://api.github.com/users/fcarsten/gists{/gist_id}", "starred_url": "https://api.github.com/users/fcarsten/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fcarsten/subscriptions", "organizations_url": "https://api.github.com/users/fcarsten/orgs", "repos_url": "https://api.github.com/users/fcarsten/repos", "events_url": "https://api.github.com/users/fcarsten/events{/privacy}", "received_events_url": "https://api.github.com/users/fcarsten/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2020-01-19T22:56:59Z", "updated_at": "2020-02-21T18:43:44Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Windos 10, 64 Bit\r\n- TensorFlow installed from pip\r\n- TensorFlow version: v2.1.0-rc2-17-ge5bf8de410 2.1.0\r\n- Python version: 3.7\r\n\r\n**Describe the current behavior**\r\n\r\nSimple Model (see below), compiles without error. It is used in a reinforcement scenario, i.e. iterations of `predict()` and `fit()` calls to iteratively train the model. \r\nCurrently the model does not seem to improve with calls to `fit()` unless `compile()` was called with `compile(..., experimental_run_tf_function = False)`. \r\n\r\n**Describe the expected behavior**\r\n\r\nModel should train equally well whether `experimental_run_tf_function = False` was passed to `model.compile()` or not.\r\n\r\n**Code to reproduce the issue**\r\n\r\nExample code can be found at [https://github.com/fcarsten/tic-tac-toe/blob/tf-2.1-issue/test_nn_q_tf2.py]( https://github.com/fcarsten/tic-tac-toe/blob/tf-2.1-issue/test_nn_q_tf2.py) - need to check out the whole branch as it uses other code from this repository. \r\n\r\nEither run as is `run_test(True)` to see failing, or `run_test(False)` to see how it should run. \r\n\r\nWhen running as expected \"Player 1 win %\" should increase and end up over 80%, usually somewhere around 90%. When not running as expected, \"Player 1 win %\" will randomly meander up and down.\r\n\r\nThe model is defined in File SimpleNNQPlayerTF2.py line 29 ff:\r\n```\r\ninput_layer = tf.keras.Input(shape=(BOARD_SIZE * 3,))\r\nx = tf.keras.layers.Dense(BOARD_SIZE * 3 * 9, activation='relu')(input_layer)\r\nx = tf.keras.layers.Dense(BOARD_SIZE * 3 * 100, activation='relu')(x)\r\nx = tf.keras.layers.Dense(BOARD_SIZE * 3 * 9, activation='relu')(x)\r\nq_values = tf.keras.layers.Dense(BOARD_SIZE, activation=None, name='q_values')(x)\r\nprobabilities = tf.keras.layers.Softmax(name='probabilities')(q_values)\r\n\r\nself.model = tf.keras.Model(inputs=input_layer, outputs=[probabilities, q_values])\r\nif run_tf_function:\r\n    self.model.compile(optimizer='adam', loss = [None, tf.keras.losses.MeanSquaredError()])\r\nelse:\r\n    self.model.compile(optimizer='adam', loss = [None, tf.keras.losses.MeanSquaredError()], experimental_run_tf_function = False)\r\n```\r\n\r\n**Other info / logs**\r\n\r\nWhile the model is a very simple sequential model, note that it has 2 output layers and the training target layer is not the final layer in the model. Not sure this makes any difference, \r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36042", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36042/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36042/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36042/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36042", "id": 551951068, "node_id": "MDU6SXNzdWU1NTE5NTEwNjg=", "number": 36042, "title": "NotImplementedError in conv2 when i use in tf.distribute.experimental.CentralStorageStrategy() for multi gpus in tf2", "user": {"login": "14asaf", "id": 39865699, "node_id": "MDQ6VXNlcjM5ODY1Njk5", "avatar_url": "https://avatars0.githubusercontent.com/u/39865699?v=4", "gravatar_id": "", "url": "https://api.github.com/users/14asaf", "html_url": "https://github.com/14asaf", "followers_url": "https://api.github.com/users/14asaf/followers", "following_url": "https://api.github.com/users/14asaf/following{/other_user}", "gists_url": "https://api.github.com/users/14asaf/gists{/gist_id}", "starred_url": "https://api.github.com/users/14asaf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/14asaf/subscriptions", "organizations_url": "https://api.github.com/users/14asaf/orgs", "repos_url": "https://api.github.com/users/14asaf/repos", "events_url": "https://api.github.com/users/14asaf/events{/privacy}", "received_events_url": "https://api.github.com/users/14asaf/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-01-19T16:57:35Z", "updated_at": "2020-03-13T19:11:09Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 18.04):\r\n- TensorFlow installed from conda install tensorflow.\r\n- TensorFlow version : 2.0.0\r\n- Python version: Python 3.7.6 \r\n- GCC/Compiler version (if compiling from source): gcc version 7.4.0\r\n- CUDA/cuDNN version: CUDA Version 10.1.243\r\n- GPU model and memory: 4 gpus of Tesla V100-SXM2-16Gb\r\n\r\n**Describe the current behavior**\r\nI used in `tf.distribute.experimental.CentralStorageStrategy()` for use all the gpus in my computer\r\n I run the following code and got `NotImplementedError`\r\n\r\n```python\r\nimport numpy as np\r\nimport tensorflow as tf\r\nfrom tensorflow.keras.layers import Conv2D, Input\r\n\r\nstrategy = tf.distribute.experimental.CentralStorageStrategy()\r\nwith strategy.scope():\r\n    Xi = np.zeros((2,1,1,396))\r\n    Pi = Input(shape=(1,1,4), name = 'input_layer_preamble')\r\n    Pd = Conv2D(int(Xi.shape[3]//Pi.shape[3]), (1, 1), padding='same', data_format='channels_first', use_bias=False)(Pi)\r\n```\r\n \r\n\r\n\r\n**Describe the current behavior**\r\n```python\r\nTraceback (most recent call last):\r\n  File \"/home/ubuntu/anaconda3/envs/my_tf2/lib/python3.7/contextlib.py\", line 130, in __exit__\r\n    self.gen.throw(type, value, traceback)\r\n  File \"/home/ubuntu/anaconda3/envs/my_tf2/lib/python3.7/site-packages/tensorflow_core/python/ops/variable_scope.py\", line 2712, in variable_creator_scope\r\n    yield\r\n  File \"tf2_nulty_gpus.py\", line 9, in <module>\r\n    Pd = Conv2D(int(Xi.shape[3]//Pi.shape[3]), (1, 1), padding='same', data_format='channels_first', use_bias=False)(Pi)\r\n  File \"/home/ubuntu/anaconda3/envs/my_tf2/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/base_layer.py\", line 817, in __call__\r\n    self._maybe_build(inputs)\r\n  File \"/home/ubuntu/anaconda3/envs/my_tf2/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/base_layer.py\", line 2141, in _maybe_build\r\n    self.build(input_shapes)\r\n  File \"/home/ubuntu/anaconda3/envs/my_tf2/lib/python3.7/site-packages/tensorflow_core/python/keras/layers/convolutional.py\", line 165, in build\r\n    dtype=self.dtype)\r\n  File \"/home/ubuntu/anaconda3/envs/my_tf2/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/base_layer.py\", line 2311, in __setattr__\r\n    if val.trainable:\r\n  File \"/home/ubuntu/anaconda3/envs/my_tf2/lib/python3.7/site-packages/tensorflow_core/python/ops/variables.py\", line 477, in trainable\r\n    raise NotImplementedError\r\nNotImplementedError\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36038", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36038/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36038/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36038/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36038", "id": 551935716, "node_id": "MDU6SXNzdWU1NTE5MzU3MTY=", "number": 36038, "title": "Showing index instead of labels in word embedding projector", "user": {"login": "zynabsmaan", "id": 11578500, "node_id": "MDQ6VXNlcjExNTc4NTAw", "avatar_url": "https://avatars0.githubusercontent.com/u/11578500?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zynabsmaan", "html_url": "https://github.com/zynabsmaan", "followers_url": "https://api.github.com/users/zynabsmaan/followers", "following_url": "https://api.github.com/users/zynabsmaan/following{/other_user}", "gists_url": "https://api.github.com/users/zynabsmaan/gists{/gist_id}", "starred_url": "https://api.github.com/users/zynabsmaan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zynabsmaan/subscriptions", "organizations_url": "https://api.github.com/users/zynabsmaan/orgs", "repos_url": "https://api.github.com/users/zynabsmaan/repos", "events_url": "https://api.github.com/users/zynabsmaan/events{/privacy}", "received_events_url": "https://api.github.com/users/zynabsmaan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1093464312, "node_id": "MDU6TGFiZWwxMDkzNDY0MzEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:others", "name": "type:others", "color": "159b2e", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-01-19T15:08:35Z", "updated_at": "2020-01-22T10:22:02Z", "closed_at": null, "author_association": "NONE", "body": "For large embedding words, I can't show the word itself but the index instead appear. And so, I can't estimate the performance of the word embedding. So, I think words should appear instead of index so, how I can benefit from it?\r\n\r\n**System information**\r\n- http://projector.tensorflow.org/\r\n\r\nYou can add an option so, I can choose either index or words.\r\n\r\nSorry for my bad English.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36036", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36036/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36036/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36036/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36036", "id": 551917202, "node_id": "MDU6SXNzdWU1NTE5MTcyMDI=", "number": 36036, "title": "Allow CuDNN 7.2 to convert float -> fp16 for tensor core ops", "user": {"login": "ThisIsIsaac", "id": 49523965, "node_id": "MDQ6VXNlcjQ5NTIzOTY1", "avatar_url": "https://avatars1.githubusercontent.com/u/49523965?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ThisIsIsaac", "html_url": "https://github.com/ThisIsIsaac", "followers_url": "https://api.github.com/users/ThisIsIsaac/followers", "following_url": "https://api.github.com/users/ThisIsIsaac/following{/other_user}", "gists_url": "https://api.github.com/users/ThisIsIsaac/gists{/gist_id}", "starred_url": "https://api.github.com/users/ThisIsIsaac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ThisIsIsaac/subscriptions", "organizations_url": "https://api.github.com/users/ThisIsIsaac/orgs", "repos_url": "https://api.github.com/users/ThisIsIsaac/repos", "events_url": "https://api.github.com/users/ThisIsIsaac/events{/privacy}", "received_events_url": "https://api.github.com/users/ThisIsIsaac/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-01-19T12:44:40Z", "updated_at": "2020-02-06T06:38:24Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): Tensorflow using cuDNN 7.2 and above\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nNow, if users want, cuDNN can convert fp32 inputs to fp16 to allow using tensor cores even when inputs are fp32. Before, users had to explicitly convert fp32 to fp16 using AMP. [Link](https://devblogs.nvidia.com/tensor-ops-made-easier-in-cudnn/). This is as simple as setting `CUDNN_TENSOR_OP_MATH_ALLOW_CONVERSION` enum value and passing it to `cudnnSetConvolutionMathType()` functioin.\r\n\r\n```cpp\r\ncudnnSetConvolutionMathType(cudnnConvDesc, CUDNN_TENSOR_OP_MATH_ALLOW_CONVERSION)\r\n```\r\n\r\nand this is the counterpart for RNN:\r\n\r\n```cpp\r\ncudnnSetRNNMatrixMathType(cudnnRnnDesc, CUDNN_TENSOR_OP_MATH_ALLOW_CONVERSION)\r\n```\r\n\r\n\r\nWe should let users chose if they want this option, since it involves converting fp32 to fp16."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36034", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36034/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36034/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36034/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36034", "id": 551897473, "node_id": "MDU6SXNzdWU1NTE4OTc0NzM=", "number": 36034, "title": "Possible mem leak in tf.random.categorical", "user": {"login": "feidieufo", "id": 34419187, "node_id": "MDQ6VXNlcjM0NDE5MTg3", "avatar_url": "https://avatars1.githubusercontent.com/u/34419187?v=4", "gravatar_id": "", "url": "https://api.github.com/users/feidieufo", "html_url": "https://github.com/feidieufo", "followers_url": "https://api.github.com/users/feidieufo/followers", "following_url": "https://api.github.com/users/feidieufo/following{/other_user}", "gists_url": "https://api.github.com/users/feidieufo/gists{/gist_id}", "starred_url": "https://api.github.com/users/feidieufo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/feidieufo/subscriptions", "organizations_url": "https://api.github.com/users/feidieufo/orgs", "repos_url": "https://api.github.com/users/feidieufo/repos", "events_url": "https://api.github.com/users/feidieufo/events{/privacy}", "received_events_url": "https://api.github.com/users/feidieufo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "wangpengmit", "id": 7817365, "node_id": "MDQ6VXNlcjc4MTczNjU=", "avatar_url": "https://avatars2.githubusercontent.com/u/7817365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wangpengmit", "html_url": "https://github.com/wangpengmit", "followers_url": "https://api.github.com/users/wangpengmit/followers", "following_url": "https://api.github.com/users/wangpengmit/following{/other_user}", "gists_url": "https://api.github.com/users/wangpengmit/gists{/gist_id}", "starred_url": "https://api.github.com/users/wangpengmit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wangpengmit/subscriptions", "organizations_url": "https://api.github.com/users/wangpengmit/orgs", "repos_url": "https://api.github.com/users/wangpengmit/repos", "events_url": "https://api.github.com/users/wangpengmit/events{/privacy}", "received_events_url": "https://api.github.com/users/wangpengmit/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "wangpengmit", "id": 7817365, "node_id": "MDQ6VXNlcjc4MTczNjU=", "avatar_url": "https://avatars2.githubusercontent.com/u/7817365?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wangpengmit", "html_url": "https://github.com/wangpengmit", "followers_url": "https://api.github.com/users/wangpengmit/followers", "following_url": "https://api.github.com/users/wangpengmit/following{/other_user}", "gists_url": "https://api.github.com/users/wangpengmit/gists{/gist_id}", "starred_url": "https://api.github.com/users/wangpengmit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wangpengmit/subscriptions", "organizations_url": "https://api.github.com/users/wangpengmit/orgs", "repos_url": "https://api.github.com/users/wangpengmit/repos", "events_url": "https://api.github.com/users/wangpengmit/events{/privacy}", "received_events_url": "https://api.github.com/users/wangpengmit/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2020-01-19T10:02:59Z", "updated_at": "2020-03-05T12:07:19Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:No\r\n- TensorFlow installed from (source or binary):binary\r\n- TensorFlow version (use command below):2.0.0\r\n- Python version:3.6.9\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:10.0.130\r\n- GPU model and memory:1060  6G\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nIf I set seed, the memory keeps increasing between loops.But if I remove seed, the memory will remains the same.\r\n\r\n**Describe the expected behavior**\r\nWhether I set random seed or not\uff0cthe memory will remains the same.\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n```python\r\nimport tensorflow as tf\r\nimport numpy as np\r\nimport tensorflow_probability as tfp\r\nimport psutil\r\nimport os\r\n\r\nif __name__ == '__main__':\r\n    act_dim = 8\r\n\r\n    model = tf.keras.Sequential([tf.keras.layers.Input(500, ),\r\n                                 tf.keras.layers.Dense(500, activation=\"relu\"),\r\n                                 tf.keras.layers.Dense(act_dim, activation=\"softmax\")])\r\n\r\n    tf.random.set_seed(0)\r\n    print(\"memory used:\", psutil.Process(os.getpid()).memory_info().rss)\r\n\r\n    for j in range(100):\r\n        for i in range(1000):\r\n            x = np.random.rand(500, 500)\r\n            prob = model(x)\r\n\r\n            dist = tfp.distributions.Categorical(probs=prob)\r\n            a = dist.sample()\r\n        print(\"memory used:\", psutil.Process(os.getpid()).memory_info().rss)\r\n```\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36033", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36033/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36033/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36033/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36033", "id": 551889302, "node_id": "MDU6SXNzdWU1NTE4ODkzMDI=", "number": 36033, "title": "tensorflow1.12 hangs at MapAndBatchDatasetOp::Dataset::Iterator::RunnerThread", "user": {"login": "yanqingshang", "id": 59996162, "node_id": "MDQ6VXNlcjU5OTk2MTYy", "avatar_url": "https://avatars2.githubusercontent.com/u/59996162?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yanqingshang", "html_url": "https://github.com/yanqingshang", "followers_url": "https://api.github.com/users/yanqingshang/followers", "following_url": "https://api.github.com/users/yanqingshang/following{/other_user}", "gists_url": "https://api.github.com/users/yanqingshang/gists{/gist_id}", "starred_url": "https://api.github.com/users/yanqingshang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yanqingshang/subscriptions", "organizations_url": "https://api.github.com/users/yanqingshang/orgs", "repos_url": "https://api.github.com/users/yanqingshang/repos", "events_url": "https://api.github.com/users/yanqingshang/events{/privacy}", "received_events_url": "https://api.github.com/users/yanqingshang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1162044565, "node_id": "MDU6TGFiZWwxMTYyMDQ0NTY1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.12", "name": "TF 1.12", "color": "c2e0c6", "default": false, "description": "Issues related to TF 1.12"}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-01-19T08:58:21Z", "updated_at": "2020-02-24T01:57:28Z", "closed_at": null, "author_association": "NONE", "body": "- OS Platform and Distribution: aarch64 \r\n- TensorFlow installed from (source or binary):source\r\n- TensorFlow version: 1.12\r\n- Python version: 3.6.1\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n\r\npreprocessing script is MapAndBatchDataset+PrefetchDataset, When we run training for a long time, we find that the training will be hung. We found that when hanging, the value of batch_results_.front()->num_calls in the following logic of map_and_batch_dataset_op.cc is always 1\r\n\r\n    Status GetNextInternal(IteratorContext* ctx,\r\n                             std::vector<Tensor>* out_tensors,\r\n                             bool* end_of_sequence) override {\r\n        std::shared_ptr<BatchResult> result;\r\n        {\r\n          mutex_lock l(*mu_);\r\n          EnsureRunnerThreadStarted(ctx);\r\n          while (batch_results_.empty() ||\r\n                 batch_results_.front()->num_calls > 0) {\r\n            RecordStop(ctx);\r\n            cond_var_->wait(l);\r\n            RecordStart(ctx);\r\n          }\r\n          std::swap(result, batch_results_.front());\r\n          batch_results_.pop_front();\r\n          cond_var_->notify_all();\r\n        }\r\n        return ProcessResult(ctx, result, out_tensors, end_of_sequence);\r\n      }\r\n\r\nWe found another function, which will reduce result-> num_calls by one. We will modify the property of result-> num_calls to atomic and there will be no problem. Does this mean that this code does not have a memory barrier.\r\n     void CallCompleted(const std::shared_ptr<BatchResult>& result)\r\n          LOCKS_EXCLUDED(*mu_) {\r\n        mutex_lock l(*mu_);\r\n        num_calls_--;\r\n        result->num_calls--;\r\n        cond_var_->notify_all();\r\n      }\r\n\r\nOne more thing to say is that we only found the problem on ARM OS(aarch64), but not on Linux Ubuntu OS(X86).\r\n\r\nWe want to know if there is a bug in this snippet of TensorFlow on aarch64 and how to fix it.\r\n\r\nHere is the call stack when hung:\r\nThread 374 (LWP 20847):\r\n#0  0x0000ffffb997d22c in pthread_cond_wait@@GLIBC_2.17 () from target:/lib/aarch64-linux-gnu/libpthread.so.0\r\n#1  0x0000ffffb11adb30 in std::condition_variable::wait(std::unique_lock<std::mutex>&) () from target:/usr/lib/aarch64-linux-gnu/libstdc++.so.6\r\n#2  0x0000ffffb5501c5c in nsync::nsync_mu_semaphore_p_with_deadline(nsync::nsync_semaphore_s_*, timespec) ()\r\n   from target:/usr/local/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n#3  0x0000ffffb55012d4 in nsync::nsync_sem_wait_with_cancel_(nsync::waiter*, timespec, nsync::nsync_note_s_*) ()\r\n   from target:/usr/local/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n#4  0x0000ffffb54fe7f0 in nsync::nsync_cv_wait_with_deadline_generic(nsync::nsync_cv_s_*, void*, void (*)(void*), void (*)(void*), timespec, nsync::nsync_note_s_*) ()\r\n   from target:/usr/local/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n#5  0x0000ffffb3c962d4 in tensorflow::data::(anonymous namespace)::MapAndBatchDatasetOp::Dataset::Iterator::RunnerThread(std::shared_ptr<tensorflow::data::IteratorContext> const&) ()\r\n   from target:/usr/local/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n#6  0x0000ffffb11b3e14 in ?? () from target:/usr/lib/aarch64-linux-gnu/libstdc++.so.6\r\n#7  0x0000ffffb9977088 in start_thread () from target:/lib/aarch64-linux-gnu/libpthread.so.0\r\n#8  0x0000ffffb98054ec in ?? () from target:/lib/aarch64-linux-gnu/libc.so.6\r\n\r\nThread 372 (LWP 20844):\r\n#0  0x0000ffffb997d22c in pthread_cond_wait@@GLIBC_2.17 () from target:/lib/aarch64-linux-gnu/libpthread.so.0\r\n#1  0x0000ffffb11adb30 in std::condition_variable::wait(std::unique_lock<std::mutex>&) () from target:/usr/lib/aarch64-linux-gnu/libstdc++.so.6\r\n#2  0x0000ffffb5501c5c in nsync::nsync_mu_semaphore_p_with_deadline(nsync::nsync_semaphore_s_*, timespec) ()\r\n   from target:/usr/local/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n#3  0x0000ffffb55012d4 in nsync::nsync_sem_wait_with_cancel_(nsync::waiter*, timespec, nsync::nsync_note_s_*) ()\r\n   from target:/usr/local/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n#4  0x0000ffffb54fe7f0 in nsync::nsync_cv_wait_with_deadline_generic(nsync::nsync_cv_s_*, void*, void (*)(void*), void (*)(void*), timespec, nsync::nsync_note_s_*) ()\r\n   from target:/usr/local/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n#5  0x0000ffffb3c938e4 in tensorflow::data::(anonymous namespace)::MapAndBatchDatasetOp::Dataset::Iterator::GetNextInternal(tensorflow::data::IteratorContext*, std::vector<tensorflow::Tensor, std::allocator<tensorflow::Tensor> >*, bool*) () from target:/usr/local/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n#6  0x0000ffffb3c41918 in tensorflow::data::DatasetBaseIterator::GetNext(tensorflow::data::IteratorContext*, std::vector<tensorflow::Tensor, std::allocator<tensorflow::Tensor> >*, bool*) ()\r\n   from target:/usr/local/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n#7  0x0000ffffb3d25644 in std::_Function_handler<void (), tensorflow::data::PrefetchDatasetOp::Dataset::Iterator::EnsurePrefetchThreadStarted(tensorflow::data::IteratorContext*)::{lambda()#1}>::_M_invoke(std::_Any_data const&) () from target:/usr/local/lib/python3.6/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n#8  0x0000ffffb11b3e14 in ?? () from target:/usr/lib/aarch64-linux-gnu/libstdc++.so.6\r\n#9  0x0000ffffb9977088 in start_thread () from target:/lib/aarch64-linux-gnu/libpthread.so.0\r\n#10 0x0000ffffb98054ec in ?? () from target:/lib/aarch64-linux-gnu/libc.so.6"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36028", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36028/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36028/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36028/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36028", "id": 551846082, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY0NDgwNzg4", "number": 36028, "title": "Fix missing git depenendency for Jupyter docker image.", "user": {"login": "traviscollins", "id": 923065, "node_id": "MDQ6VXNlcjkyMzA2NQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/923065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/traviscollins", "html_url": "https://github.com/traviscollins", "followers_url": "https://api.github.com/users/traviscollins/followers", "following_url": "https://api.github.com/users/traviscollins/following{/other_user}", "gists_url": "https://api.github.com/users/traviscollins/gists{/gist_id}", "starred_url": "https://api.github.com/users/traviscollins/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/traviscollins/subscriptions", "organizations_url": "https://api.github.com/users/traviscollins/orgs", "repos_url": "https://api.github.com/users/traviscollins/repos", "events_url": "https://api.github.com/users/traviscollins/events{/privacy}", "received_events_url": "https://api.github.com/users/traviscollins/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}, {"id": 474725938, "node_id": "MDU6TGFiZWw0NzQ3MjU5Mzg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stalled", "name": "stalled", "color": "d4c5f9", "default": false, "description": null}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2020-01-19T00:41:25Z", "updated_at": "2020-03-19T01:16:25Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36028", "html_url": "https://github.com/tensorflow/tensorflow/pull/36028", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36028.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36028.patch"}, "body": "The jupyter notebook docker image includes a tutorial named \"overfit and underfit\" that has a step that requires git to run. The nightly-py3-jupyter image does not include git in the docker image. This is my attempt to add git to that image. \r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36025", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36025/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36025/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36025/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36025", "id": 551825161, "node_id": "MDU6SXNzdWU1NTE4MjUxNjE=", "number": 36025, "title": "Unknown: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.", "user": {"login": "abcdabcd987", "id": 2470081, "node_id": "MDQ6VXNlcjI0NzAwODE=", "avatar_url": "https://avatars0.githubusercontent.com/u/2470081?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abcdabcd987", "html_url": "https://github.com/abcdabcd987", "followers_url": "https://api.github.com/users/abcdabcd987/followers", "following_url": "https://api.github.com/users/abcdabcd987/following{/other_user}", "gists_url": "https://api.github.com/users/abcdabcd987/gists{/gist_id}", "starred_url": "https://api.github.com/users/abcdabcd987/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abcdabcd987/subscriptions", "organizations_url": "https://api.github.com/users/abcdabcd987/orgs", "repos_url": "https://api.github.com/users/abcdabcd987/repos", "events_url": "https://api.github.com/users/abcdabcd987/events{/privacy}", "received_events_url": "https://api.github.com/users/abcdabcd987/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-01-18T21:12:25Z", "updated_at": "2020-01-27T21:04:13Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Manjaro, Kernel 5.3.18\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): `v2.1.0-rc2-17-ge5bf8de 2.1.0`\r\n- Python version: 3.7.4\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: Cuda 10.1, cuDNN 7.6.5\r\n- GPU model and memory: RTX 2070 8GB\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\n\r\nImport a ResNet .pb model and run it. The following error will occur and whether setting `allow_growth` or not does not help:\r\n\r\n```\r\n2020-01-18 12:56:02.661655: E tensorflow/stream_executor/cuda/cuda_dnn.cc:329] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\n2020-01-18 12:56:02.666829: E tensorflow/stream_executor/cuda/cuda_dnn.cc:329] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR\r\nTraceback (most recent call last):\r\n  File \"/home/abcdabcd987/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow_core/python/client/session.py\", line 1367, in _do_call\r\n    return fn(*args)\r\n  File \"/home/abcdabcd987/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow_core/python/client/session.py\", line 1352, in _run_fn\r\n    target_list, run_metadata)\r\n  File \"/home/abcdabcd987/.pyenv/versions/3.7.4/lib/python3.7/site-packages/tensorflow_core/python/client/session.py\", line 1445, in _call_tf_sessionrun\r\n    run_metadata)\r\ntensorflow.python.framework.errors_impl.UnknownError: 2 root error(s) found.\r\n  (0) Unknown: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n\t [[{{node resnet_v1_50/conv1/Conv2D}}]]\r\n\t [[output/_3]]\r\n  (1) Unknown: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n\t [[{{node resnet_v1_50/conv1/Conv2D}}]]\r\n0 successful operations.\r\n0 derived errors ignored.\r\n```\r\n\r\n**Describe the expected behavior**\r\n\r\nRun it successfully\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n```python\r\nimport os\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\nMODEL_PB_FILENAME = 'resnet_v1_50.pb'\r\nINPUT_TENSOR_NAME = 'input:0'\r\nOUTPUT_TENSOR_NAME = 'output:0'\r\n\r\ndef main():\r\n    with tf.device('/GPU:0'):\r\n        with tf.compat.v1.gfile.GFile(MODEL_PB_FILENAME, \"rb\") as f:\r\n            graph_def = tf.compat.v1.GraphDef()\r\n            graph_def.ParseFromString(f.read())\r\n            g_in = tf.import_graph_def(graph_def, name=\"\")\r\n\r\n    config = tf.compat.v1.ConfigProto()\r\n    # config.allow_soft_placement = True\r\n    # config.log_device_placement = True\r\n    # config.gpu_options.allow_growth = True\r\n\r\n    sess = tf.compat.v1.Session(graph=g_in, config=config)\r\n\r\n    batch_x = np.random.randn(1, 224, 224, 3);\r\n    output = sess.run(\r\n        OUTPUT_TENSOR_NAME,\r\n        feed_dict={INPUT_TENSOR_NAME: batch_x})[0]\r\n    print(output)\r\n    print(tf.test.is_gpu_available())\r\n    print('config', list(map(hex, config.SerializeToString())))\r\n\r\n\r\nmain()\r\n```\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\n[test_tf.log](https://github.com/tensorflow/tensorflow/files/4081770/test_tf.log)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36021", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36021/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36021/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36021/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36021", "id": 551818386, "node_id": "MDU6SXNzdWU1NTE4MTgzODY=", "number": 36021, "title": "Loading a tf.Module with tf.saved_model.load missing attributes", "user": {"login": "hartikainen", "id": 2308543, "node_id": "MDQ6VXNlcjIzMDg1NDM=", "avatar_url": "https://avatars1.githubusercontent.com/u/2308543?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hartikainen", "html_url": "https://github.com/hartikainen", "followers_url": "https://api.github.com/users/hartikainen/followers", "following_url": "https://api.github.com/users/hartikainen/following{/other_user}", "gists_url": "https://api.github.com/users/hartikainen/gists{/gist_id}", "starred_url": "https://api.github.com/users/hartikainen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hartikainen/subscriptions", "organizations_url": "https://api.github.com/users/hartikainen/orgs", "repos_url": "https://api.github.com/users/hartikainen/repos", "events_url": "https://api.github.com/users/hartikainen/events{/privacy}", "received_events_url": "https://api.github.com/users/hartikainen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "allenlavoie", "id": 3731025, "node_id": "MDQ6VXNlcjM3MzEwMjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3731025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allenlavoie", "html_url": "https://github.com/allenlavoie", "followers_url": "https://api.github.com/users/allenlavoie/followers", "following_url": "https://api.github.com/users/allenlavoie/following{/other_user}", "gists_url": "https://api.github.com/users/allenlavoie/gists{/gist_id}", "starred_url": "https://api.github.com/users/allenlavoie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allenlavoie/subscriptions", "organizations_url": "https://api.github.com/users/allenlavoie/orgs", "repos_url": "https://api.github.com/users/allenlavoie/repos", "events_url": "https://api.github.com/users/allenlavoie/events{/privacy}", "received_events_url": "https://api.github.com/users/allenlavoie/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "allenlavoie", "id": 3731025, "node_id": "MDQ6VXNlcjM3MzEwMjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3731025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allenlavoie", "html_url": "https://github.com/allenlavoie", "followers_url": "https://api.github.com/users/allenlavoie/followers", "following_url": "https://api.github.com/users/allenlavoie/following{/other_user}", "gists_url": "https://api.github.com/users/allenlavoie/gists{/gist_id}", "starred_url": "https://api.github.com/users/allenlavoie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allenlavoie/subscriptions", "organizations_url": "https://api.github.com/users/allenlavoie/orgs", "repos_url": "https://api.github.com/users/allenlavoie/repos", "events_url": "https://api.github.com/users/allenlavoie/events{/privacy}", "received_events_url": "https://api.github.com/users/allenlavoie/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-01-18T20:15:30Z", "updated_at": "2020-02-14T21:10:09Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): macos Catalina\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: n/a\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): `v2.1.0-rc2-17-ge5bf8de410 2.1.0`\r\n- Python version: `3.7.5`\r\n- Bazel version (if compiling from source): n/a\r\n- GCC/Compiler version (if compiling from source): n/a\r\n- CUDA/cuDNN version: n/a\r\n- GPU model and memory: n/a\r\n\r\n**Describe the current behavior**\r\nWhen saving and then loading a `tf.Module` instance using `tf.saved_model`, some of the attributes, such as `trainable_variables` are missing from the loaded object.\r\n\r\n**Describe the expected behavior**\r\nI would expect attributes like `trainable_variables` to persist through the serialization/deserialization.\r\n\r\n**Code and logs to reproduce the issue**\r\nFor example:\r\n\r\n```python\r\nimport tensorflow as tf\r\n\r\n\r\nclass TestModule(tf.Module):\r\n    def __init__(self, value):\r\n        self.variable = tf.Variable(value)\r\n\r\n\r\nmodule_1 = TestModule(value=9000)\r\ntf.saved_model.save(module_1, \"./foo\")\r\nmodule_2 = tf.saved_model.load(\"./foo\")\r\n\r\nassert module_1.variable.numpy() == module_2.variable.numpy()\r\nassert module_1.trainable_variables == (module_1.variable, )\r\nassert module_2.trainable_variables == (module_2.variable, )\r\nassert module_1.trainable_variables == module_2.trainable_variables\r\n```\r\n\r\nraises \r\n\r\n```\r\n$ python -m tests.test_tf_saved_model_trainable_variables_missing\r\nTraceback (most recent call last):\r\n  File \"/Users/hartikainen/conda/envs/softlearning-3/lib/python3.7/runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"/Users/hartikainen/conda/envs/softlearning-3/lib/python3.7/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/Users/hartikainen/github/rail-berkeley/softlearning-3/tests/test_tf_saved_model_trainable_variables_missing.py\", line 15, in <module>\r\n    assert module_2.trainable_variables == (module_2.variable, )\r\nAttributeError: '_UserObject' object has no attribute 'trainable_variables'\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36016", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36016/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36016/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36016/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36016", "id": 551772191, "node_id": "MDU6SXNzdWU1NTE3NzIxOTE=", "number": 36016, "title": "Error optimizing my TFLite model for GPU usage", "user": {"login": "aboerzel", "id": 6959156, "node_id": "MDQ6VXNlcjY5NTkxNTY=", "avatar_url": "https://avatars1.githubusercontent.com/u/6959156?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aboerzel", "html_url": "https://github.com/aboerzel", "followers_url": "https://api.github.com/users/aboerzel/followers", "following_url": "https://api.github.com/users/aboerzel/following{/other_user}", "gists_url": "https://api.github.com/users/aboerzel/gists{/gist_id}", "starred_url": "https://api.github.com/users/aboerzel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aboerzel/subscriptions", "organizations_url": "https://api.github.com/users/aboerzel/orgs", "repos_url": "https://api.github.com/users/aboerzel/repos", "events_url": "https://api.github.com/users/aboerzel/events{/privacy}", "received_events_url": "https://api.github.com/users/aboerzel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "talumbau", "id": 1891418, "node_id": "MDQ6VXNlcjE4OTE0MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/1891418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/talumbau", "html_url": "https://github.com/talumbau", "followers_url": "https://api.github.com/users/talumbau/followers", "following_url": "https://api.github.com/users/talumbau/following{/other_user}", "gists_url": "https://api.github.com/users/talumbau/gists{/gist_id}", "starred_url": "https://api.github.com/users/talumbau/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/talumbau/subscriptions", "organizations_url": "https://api.github.com/users/talumbau/orgs", "repos_url": "https://api.github.com/users/talumbau/repos", "events_url": "https://api.github.com/users/talumbau/events{/privacy}", "received_events_url": "https://api.github.com/users/talumbau/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "talumbau", "id": 1891418, "node_id": "MDQ6VXNlcjE4OTE0MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/1891418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/talumbau", "html_url": "https://github.com/talumbau", "followers_url": "https://api.github.com/users/talumbau/followers", "following_url": "https://api.github.com/users/talumbau/following{/other_user}", "gists_url": "https://api.github.com/users/talumbau/gists{/gist_id}", "starred_url": "https://api.github.com/users/talumbau/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/talumbau/subscriptions", "organizations_url": "https://api.github.com/users/talumbau/orgs", "repos_url": "https://api.github.com/users/talumbau/repos", "events_url": "https://api.github.com/users/talumbau/events{/privacy}", "received_events_url": "https://api.github.com/users/talumbau/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-01-18T13:52:33Z", "updated_at": "2020-02-25T14:03:48Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10 Pro for Workstations (Build: 18363.592)\r\n- TensorFlow installed from (source or binary): pip install tf-nightly\r\n- TensorFlow version (or github SHA if from source): 2.2.0-dev20200115\r\n\r\n\r\n**Command used to run the converter or code if you\u2019re using the Python API**\r\n\r\n```\r\ntf_lite_converter.py :\r\n\r\nimport tensorflow as tf\r\nfrom tensorflow_core.lite.python.interpreter import Interpreter\r\nfrom tensorflow_core.lite.python.lite import TFLiteConverter, Optimize\r\n\r\nMODEL_PATH = <path to keras model file>\r\nTFLITE_MODEL_PATH = <path to optimized TFLite model file>\r\n\r\nconverter = TFLiteConverter.from_keras_model_file(MODEL_PATH)\r\nconverter.optimizations.append(Optimize.DEFAULT)\r\nconverter.target_spec.supported_types.append(tf.float16)\r\nconverter.experimental_new_converter = True\r\ntflite_model = converter.convert()\r\n\r\nopen(TFLITE_MODEL_PATH, \"wb\").write(tflite_model)\r\n\r\n```\r\n\r\n**The output from the converter invocation**\r\n\r\n```\r\n(tf-n) D:\\development\\tensorflow\\ANPR>python tf_lite_converter.py\r\n2020-01-18 14:20:47.702258: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_101.dll\r\nOptimizer:    adagrad\r\nModel path:   output\\adagrad\\glpr-model.h5\r\n2020-01-18 14:20:53.240667: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library nvcuda.dll\r\n2020-01-18 14:20:53.279154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties:\r\npciBusID: 0000:01:00.0 name: GeForce RTX 2070 computeCapability: 7.5\r\ncoreClock: 1.83GHz coreCount: 36 deviceMemorySize: 8.00GiB deviceMemoryBandwidth: 417.29GiB/s\r\n2020-01-18 14:20:53.287304: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_101.dll\r\n2020-01-18 14:20:53.361116: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_10.dll\r\n2020-01-18 14:20:53.421716: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_10.dll\r\n2020-01-18 14:20:53.447055: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_10.dll\r\n2020-01-18 14:20:53.530899: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_10.dll\r\n2020-01-18 14:20:53.570409: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_10.dll\r\n2020-01-18 14:20:53.702842: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll\r\n2020-01-18 14:20:53.708873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0\r\n2020-01-18 14:20:53.715765: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2\r\n2020-01-18 14:20:53.723989: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties:\r\npciBusID: 0000:01:00.0 name: GeForce RTX 2070 computeCapability: 7.5\r\ncoreClock: 1.83GHz coreCount: 36 deviceMemorySize: 8.00GiB deviceMemoryBandwidth: 417.29GiB/s\r\n2020-01-18 14:20:53.734035: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_101.dll\r\n2020-01-18 14:20:53.739179: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_10.dll\r\n2020-01-18 14:20:53.744328: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_10.dll\r\n2020-01-18 14:20:53.749625: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_10.dll\r\n2020-01-18 14:20:53.754539: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_10.dll\r\n2020-01-18 14:20:53.759888: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_10.dll\r\n2020-01-18 14:20:53.764633: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll\r\n2020-01-18 14:20:53.768758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0\r\n2020-01-18 14:20:56.460164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2020-01-18 14:20:56.464829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      0\r\n2020-01-18 14:20:56.467340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0:   N\r\n2020-01-18 14:20:56.485286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1244] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6302 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2070, pci bus id: 0000:01:00.0, compute capability: 7.5)\r\nWARNING:tensorflow:No training configuration found in save file: the model was *not* compiled. Compile it manually.\r\n2020-01-18 14:20:58.024625: I tensorflow/core/grappler/devices.cc:55] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 1\r\n2020-01-18 14:20:58.029712: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2020-01-18 14:20:58.039753: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties:\r\npciBusID: 0000:01:00.0 name: GeForce RTX 2070 computeCapability: 7.5\r\ncoreClock: 1.83GHz coreCount: 36 deviceMemorySize: 8.00GiB deviceMemoryBandwidth: 417.29GiB/s\r\n2020-01-18 14:20:58.049235: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_101.dll\r\n2020-01-18 14:20:58.055409: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_10.dll\r\n2020-01-18 14:20:58.061247: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_10.dll\r\n2020-01-18 14:20:58.066364: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_10.dll\r\n2020-01-18 14:20:58.072194: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_10.dll\r\n2020-01-18 14:20:58.077274: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_10.dll\r\n2020-01-18 14:20:58.081844: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll\r\n2020-01-18 14:20:58.086684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0\r\n2020-01-18 14:20:58.090252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2020-01-18 14:20:58.094291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      0\r\n2020-01-18 14:20:58.097674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0:   N\r\n2020-01-18 14:20:58.101224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1244] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6302 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2070, pci bus id: 0000:01:00.0, compute capability: 7.5)\r\n2020-01-18 14:20:58.210900: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:815] Optimization results for grappler item: graph_to_optimize\r\n2020-01-18 14:20:58.215597: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: Graph size after: 402 nodes (0), 510 edges (0), time = 12.053ms.\r\n2020-01-18 14:20:58.223386: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: Graph size after: 402 nodes (0), 510 edges (0), time = 3.914ms.\r\n2020-01-18 14:20:58.228466: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:815] Optimization results for grappler item: model_1_bidirectional_1_forward_gru_1_while_body_1537\r\n2020-01-18 14:20:58.234325: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-18 14:20:58.239123: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-18 14:20:58.243351: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:815] Optimization results for grappler item: model_1_bidirectional_1_forward_gru_1_while_cond_1536\r\n2020-01-18 14:20:58.249016: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-01-18 14:20:58.253361: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-18 14:20:58.257939: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:815] Optimization results for grappler item: model_1_bidirectional_1_backward_gru_1_while_body_1693\r\n2020-01-18 14:20:58.263220: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-18 14:20:58.267683: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-18 14:20:58.271917: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:815] Optimization results for grappler item: model_1_bidirectional_backward_gru_while_body_1380\r\n2020-01-18 14:20:58.277337: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-18 14:20:58.281620: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: function_optimizer did nothing. time = 0.001ms.\r\n2020-01-18 14:20:58.286374: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:815] Optimization results for grappler item: model_1_bidirectional_backward_gru_while_cond_1379\r\n2020-01-18 14:20:58.291542: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-18 14:20:58.296176: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-18 14:20:58.300253: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:815] Optimization results for grappler item: model_1_bidirectional_forward_gru_while_body_1224\r\n2020-01-18 14:20:58.305713: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-18 14:20:58.309768: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-18 14:20:58.314440: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:815] Optimization results for grappler item: model_1_bidirectional_forward_gru_while_cond_1223\r\n2020-01-18 14:20:58.319815: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-18 14:20:58.323996: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-18 14:20:58.328567: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:815] Optimization results for grappler item: model_1_bidirectional_1_backward_gru_1_while_cond_1692\r\n2020-01-18 14:20:58.333697: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2020-01-18 14:20:58.338136: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:817]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\nTraceback (most recent call last):\r\n  File \"tf_lite_converter.py\", line 30, in <module>\r\n    tflite_model = converter.convert()\r\n  File \"C:\\Users\\Andreas\\Anaconda3\\lib\\site-packages\\tensorflow_core\\lite\\python\\lite.py\", line 1051, in convert\r\n    **converter_kwargs)\r\n  File \"C:\\Users\\Andreas\\Anaconda3\\lib\\site-packages\\tensorflow_core\\lite\\python\\convert.py\", line 476, in toco_convert_impl\r\n    enable_mlir_converter=enable_mlir_converter)\r\n  File \"C:\\Users\\Andreas\\Anaconda3\\lib\\site-packages\\tensorflow_core\\lite\\python\\convert.py\", line 215, in toco_convert_protos\r\n    raise ConverterError(\"See console for info.\\n%s\\n%s\\n\" % (stdout, stderr))\r\ntensorflow.lite.python.convert.ConverterError: See console for info.\r\n2020-01-18 14:20:59.719318: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_101.dll\r\n2020-01-18 14:21:01.906381: W tensorflow/compiler/mlir/lite/python/graphdef_to_tfl_flatbuffer.cc:108] Ignored output_format.\r\n2020-01-18 14:21:01.906537: W tensorflow/compiler/mlir/lite/python/graphdef_to_tfl_flatbuffer.cc:111] Ignored drop_control_dependency.\r\n2020-01-18 14:21:02.036186: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2\r\n2020-01-18 14:21:02.040149: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library nvcuda.dll\r\n2020-01-18 14:21:02.059114: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties:\r\npciBusID: 0000:01:00.0 name: GeForce RTX 2070 computeCapability: 7.5\r\ncoreClock: 1.83GHz coreCount: 36 deviceMemorySize: 8.00GiB deviceMemoryBandwidth: 417.29GiB/s\r\n2020-01-18 14:21:02.059504: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_101.dll\r\n2020-01-18 14:21:02.062864: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_10.dll\r\n2020-01-18 14:21:02.065500: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cufft64_10.dll\r\n2020-01-18 14:21:02.066696: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library curand64_10.dll\r\n2020-01-18 14:21:02.069723: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusolver64_10.dll\r\n2020-01-18 14:21:02.071795: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cusparse64_10.dll\r\n2020-01-18 14:21:02.076283: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudnn64_7.dll\r\n2020-01-18 14:21:02.076923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0\r\n2020-01-18 14:21:02.582665: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2020-01-18 14:21:02.582866: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105]      0\r\n2020-01-18 14:21:02.582978: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0:   N\r\n2020-01-18 14:21:02.583637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1244] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6287 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2070, pci bus id: 0000:01:00.0, compute capability: 7.5)\r\n2020-01-18 14:21:05.868343: E tensorflow/lite/tools/optimize/quantize_weights.cc:474] Quantize weights tool only supports tflite models with one subgraph.\r\nTraceback (most recent call last):\r\n  File \"c:\\users\\andreas\\anaconda3\\lib\\runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"c:\\users\\andreas\\anaconda3\\lib\\runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"C:\\Users\\Andreas\\Anaconda3\\Scripts\\toco_from_protos.exe\\__main__.py\", line 7, in <module>\r\n  File \"c:\\users\\andreas\\anaconda3\\lib\\site-packages\\tensorflow_core\\lite\\toco\\python\\toco_from_protos.py\", line 93, in main\r\n    app.run(main=execute, argv=[sys.argv[0]] + unparsed)\r\n  File \"c:\\users\\andreas\\anaconda3\\lib\\site-packages\\tensorflow_core\\python\\platform\\app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"c:\\users\\andreas\\anaconda3\\lib\\site-packages\\absl\\app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"c:\\users\\andreas\\anaconda3\\lib\\site-packages\\absl\\app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"c:\\users\\andreas\\anaconda3\\lib\\site-packages\\tensorflow_core\\lite\\toco\\python\\toco_from_protos.py\", line 56, in execute\r\n    enable_mlir_converter)\r\nException: Quantize weights transformation failed.\r\n```\r\n\r\n**Also, please include a link to the saved model or GraphDef**\r\n\r\n[download keras-model](https://drive.google.com/open?id=1GpQkBigddPvprAdplkr8ksT2nYRiAQNQ)\r\n\r\n[download saved_model](https://drive.google.com/open?id=1uEpnjYdWuC9yni9iqS4-Lt-A2sA-l4WB)\r\n\r\n**Failure details**\r\n\r\n**Any other info / logs**\r\n\r\nWithout using the GPU optimization I can convert the Keras model to a TFLite model. This works correctly, but under Android unfortunately only very slowly!\r\n\r\n[GitHub-Project](https://github.com/aboerzel/ALPR-keras)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36013", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36013/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36013/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36013/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36013", "id": 551704950, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY0Mzc5Mjk4", "number": 36013, "title": "Add GPU headers to //tensorflow/core:headers.", "user": {"login": "abcdabcd987", "id": 2470081, "node_id": "MDQ6VXNlcjI0NzAwODE=", "avatar_url": "https://avatars0.githubusercontent.com/u/2470081?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abcdabcd987", "html_url": "https://github.com/abcdabcd987", "followers_url": "https://api.github.com/users/abcdabcd987/followers", "following_url": "https://api.github.com/users/abcdabcd987/following{/other_user}", "gists_url": "https://api.github.com/users/abcdabcd987/gists{/gist_id}", "starred_url": "https://api.github.com/users/abcdabcd987/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abcdabcd987/subscriptions", "organizations_url": "https://api.github.com/users/abcdabcd987/orgs", "repos_url": "https://api.github.com/users/abcdabcd987/repos", "events_url": "https://api.github.com/users/abcdabcd987/events{/privacy}", "received_events_url": "https://api.github.com/users/abcdabcd987/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1178505529, "node_id": "MDU6TGFiZWwxMTc4NTA1NTI5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/prtype:bugfix", "name": "prtype:bugfix", "color": "159b2e", "default": false, "description": "PR to fix a bug"}, {"id": 1169364259, "node_id": "MDU6TGFiZWwxMTY5MzY0MjU5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:XS", "name": "size:XS", "color": "adafea", "default": false, "description": "CL Change Size: Extra Small"}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-01-18T01:52:54Z", "updated_at": "2020-02-20T08:50:54Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36013", "html_url": "https://github.com/tensorflow/tensorflow/pull/36013", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36013.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36013.patch"}, "body": "Fixes #35576"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36008", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36008/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36008/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36008/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36008", "id": 551672509, "node_id": "MDU6SXNzdWU1NTE2NzI1MDk=", "number": 36008, "title": "XLA drops performance across the nodes", "user": {"login": "vilmara", "id": 30601934, "node_id": "MDQ6VXNlcjMwNjAxOTM0", "avatar_url": "https://avatars0.githubusercontent.com/u/30601934?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vilmara", "html_url": "https://github.com/vilmara", "followers_url": "https://api.github.com/users/vilmara/followers", "following_url": "https://api.github.com/users/vilmara/following{/other_user}", "gists_url": "https://api.github.com/users/vilmara/gists{/gist_id}", "starred_url": "https://api.github.com/users/vilmara/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vilmara/subscriptions", "organizations_url": "https://api.github.com/users/vilmara/orgs", "repos_url": "https://api.github.com/users/vilmara/repos", "events_url": "https://api.github.com/users/vilmara/events{/privacy}", "received_events_url": "https://api.github.com/users/vilmara/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1133285679, "node_id": "MDU6TGFiZWwxMTMzMjg1Njc5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:xla", "name": "comp:xla", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "dubey", "id": 2314265, "node_id": "MDQ6VXNlcjIzMTQyNjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/2314265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dubey", "html_url": "https://github.com/dubey", "followers_url": "https://api.github.com/users/dubey/followers", "following_url": "https://api.github.com/users/dubey/following{/other_user}", "gists_url": "https://api.github.com/users/dubey/gists{/gist_id}", "starred_url": "https://api.github.com/users/dubey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dubey/subscriptions", "organizations_url": "https://api.github.com/users/dubey/orgs", "repos_url": "https://api.github.com/users/dubey/repos", "events_url": "https://api.github.com/users/dubey/events{/privacy}", "received_events_url": "https://api.github.com/users/dubey/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "dubey", "id": 2314265, "node_id": "MDQ6VXNlcjIzMTQyNjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/2314265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dubey", "html_url": "https://github.com/dubey", "followers_url": "https://api.github.com/users/dubey/followers", "following_url": "https://api.github.com/users/dubey/following{/other_user}", "gists_url": "https://api.github.com/users/dubey/gists{/gist_id}", "starred_url": "https://api.github.com/users/dubey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dubey/subscriptions", "organizations_url": "https://api.github.com/users/dubey/orgs", "repos_url": "https://api.github.com/users/dubey/repos", "events_url": "https://api.github.com/users/dubey/events{/privacy}", "received_events_url": "https://api.github.com/users/dubey/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2020-01-17T23:05:17Z", "updated_at": "2020-01-22T21:13:11Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): TF benchmarks\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):  Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: n/a\r\n- TensorFlow installed from (source or binary): Running with Horovod 0.18.2 via docker\r\n- TensorFlow version (use command below): v1.14.0-rc1-22-gaf24dc91b5\r\n- Python version: 2.7\r\n- Bazel version (if compiling from source): n/a\r\n- GCC/Compiler version (if compiling from source): 4.8\r\n- CUDA/cuDNN version: 10.0 / 7.6.5\r\n- GPU model and memory: 8xV100-16GB (2 nodes, each with 4xV100GPU's)\r\n- MPI version: 4.0.0\r\n- Mellanox OFED version: 4.7-3.2.9.0\r\n- GPUDirect RDMA - nvidia-peer-memory version: 1.0-8\r\n\r\n**Describe the current behavior**\r\nI am running TF benchmarks with Horovod in distributed mode, I see the scaling efficiency drops to from 76% (within the node) to 98% (when crossing the nodes), see below the throughput:\r\n\r\n-1xGPU within the node total images/sec:     ~1200\r\n-4xGPU's within the node total images/sec:   ~4712  | Scaling Efficiency (1200x4) / 4712 = 98%\r\n-8xGPU's across the nodes total images/sec: ~7302 |  Scaling Efficiency (1200x8) / 7302 = 76%\r\n\r\n**Describe the expected behavior**\r\nWe are expecting scaling efficiency across the nodes over 95%, it is around ~9120 img/sec. Please notice that the scaling efficiency drops only when crossing the nodes\r\n\r\n**Code to reproduce the issue**\r\n`mpirun -np 8 -H <ib>:4,<ib>:4 --allow-run-as-root -x NCCL_NET_GDR_LEVEL=3 -x NCCL_DEBUG_SUBSYS=NET -x NCCL_IB_DISABLE=0 -mca btl_tcp_if_include ib0 -x NCCL_SOCKET_IFNAME=ib0 -x NCCL_DEBUG=INFO -x HOROVOD_MPI_THREADS_DISABLE=1 --bind-to none --map-by slot --mca plm_rsh_args \"-p 12345\" python tf_cnn_benchmarks.py --data_format=NCHW --distortions=false --use_fp16=True --variable_update=horovod --model=resnet50 --batch_size=128 --xla=true`\r\n\r\n**Other info / logs**\r\n\r\n**Tracelog 1xGPU:**\r\n```\r\nStep    Img/sec total_loss\r\n1       images/sec: 1187.6 +/- 0.0 (jitter = 0.0)       7.817\r\n10      images/sec: 1201.3 +/- 3.4 (jitter = 9.5)       7.869\r\n20      images/sec: 1200.5 +/- 2.5 (jitter = 6.3)       7.915\r\n30      images/sec: 1202.0 +/- 3.3 (jitter = 8.5)       7.884\r\n40      images/sec: 1202.0 +/- 2.7 (jitter = 7.0)       7.836\r\n50      images/sec: 1200.3 +/- 2.2 (jitter = 6.4)       7.806\r\n60      images/sec: 1201.2 +/- 2.0 (jitter = 6.4)       7.852\r\n70      images/sec: 1202.1 +/- 2.0 (jitter = 7.5)       7.856\r\n80      images/sec: 1201.1 +/- 1.9 (jitter = 7.2)       7.754\r\n90      images/sec: 1200.5 +/- 1.7 (jitter = 6.8)       7.806\r\n100     images/sec: 1200.7 +/- 1.6 (jitter = 6.7)       7.764\r\n----------------------------------------------------------------\r\ntotal images/sec: 1199.87\r\n----------------------------------------------------------------\r\n```\r\n\r\n\r\n**Tracelog 8xGPU's:**\r\n```\r\nStep    Img/sec total_loss\r\n1       images/sec: 922.9 +/- 0.0 (jitter = 0.0)        7.787\r\n1       images/sec: 926.8 +/- 0.0 (jitter = 0.0)        7.707\r\n1       images/sec: 927.0 +/- 0.0 (jitter = 0.0)        7.720\r\n1       images/sec: 925.4 +/- 0.0 (jitter = 0.0)        7.881\r\n1       images/sec: 922.4 +/- 0.0 (jitter = 0.0)        7.846\r\n1       images/sec: 926.3 +/- 0.0 (jitter = 0.0)        7.694\r\n1       images/sec: 924.9 +/- 0.0 (jitter = 0.0)        7.683\r\n1       images/sec: 902.0 +/- 0.0 (jitter = 0.0)        7.762\r\n10      images/sec: 926.2 +/- 7.6 (jitter = 25.6)       7.725\r\n10      images/sec: 926.6 +/- 8.5 (jitter = 18.2)       7.647\r\n10      images/sec: 926.6 +/- 7.6 (jitter = 26.9)       7.659\r\n10      images/sec: 926.7 +/- 7.4 (jitter = 26.2)       7.703\r\n10      images/sec: 927.9 +/- 8.2 (jitter = 8.3)        7.613\r\n10      images/sec: 927.2 +/- 7.9 (jitter = 23.9)       7.708\r\n10      images/sec: 927.6 +/- 7.0 (jitter = 11.8)       7.710\r\n10      images/sec: 927.2 +/- 7.4 (jitter = 24.8)       7.669\r\n20      images/sec: 925.7 +/- 4.5 (jitter = 20.9)       7.620\r\n20      images/sec: 926.0 +/- 4.5 (jitter = 21.1)       7.585\r\n20      images/sec: 926.0 +/- 5.1 (jitter = 18.1)       7.530\r\n20      images/sec: 926.0 +/- 4.7 (jitter = 21.0)       7.600\r\n20      images/sec: 926.8 +/- 4.5 (jitter = 17.3)       7.524\r\n20      images/sec: 926.9 +/- 4.9 (jitter = 14.5)       7.638\r\n20      images/sec: 926.6 +/- 4.4 (jitter = 21.8)       7.588\r\n20      images/sec: 926.5 +/- 5.1 (jitter = 19.2)       7.682\r\n30      images/sec: 919.9 +/- 4.1 (jitter = 25.1)       7.567\r\n30      images/sec: 920.1 +/- 4.4 (jitter = 24.5)       7.529\r\n30      images/sec: 920.1 +/- 4.1 (jitter = 24.0)       7.546\r\n30      images/sec: 920.0 +/- 4.1 (jitter = 24.5)       7.578\r\n30      images/sec: 920.5 +/- 4.4 (jitter = 23.7)       7.469\r\n30      images/sec: 920.5 +/- 4.2 (jitter = 24.9)       7.483\r\n30      images/sec: 920.7 +/- 4.2 (jitter = 18.8)       7.489\r\n30      images/sec: 920.6 +/- 4.3 (jitter = 25.2)       7.526\r\n40      images/sec: 916.3 +/- 3.9 (jitter = 25.3)       7.541\r\n40      images/sec: 916.2 +/- 3.9 (jitter = 23.2)       7.444\r\n40      images/sec: 916.2 +/- 4.1 (jitter = 25.1)       7.515\r\n40      images/sec: 915.9 +/- 4.0 (jitter = 26.4)       7.476\r\n40      images/sec: 917.0 +/- 4.1 (jitter = 26.4)       7.534\r\n40      images/sec: 916.8 +/- 4.1 (jitter = 27.9)       7.502\r\n40      images/sec: 916.7 +/- 4.0 (jitter = 26.5)       7.500\r\n40      images/sec: 916.5 +/- 4.3 (jitter = 23.3)       7.529\r\n50      images/sec: 911.2 +/- 3.7 (jitter = 24.8)       7.523\r\n50      images/sec: 911.2 +/- 3.8 (jitter = 31.4)       7.461\r\n50      images/sec: 911.1 +/- 3.7 (jitter = 27.8)       7.461\r\n50      images/sec: 911.6 +/- 3.9 (jitter = 29.1)       7.524\r\n50      images/sec: 911.7 +/- 3.8 (jitter = 24.2)       7.512\r\n50      images/sec: 911.7 +/- 3.9 (jitter = 24.0)       7.419\r\n50      images/sec: 910.9 +/- 3.7 (jitter = 27.9)       7.446\r\n50      images/sec: 911.8 +/- 3.8 (jitter = 27.6)       7.467\r\n60      images/sec: 910.2 +/- 3.5 (jitter = 29.9)       7.513\r\n60      images/sec: 910.1 +/- 3.4 (jitter = 29.8)       7.435\r\n60      images/sec: 910.2 +/- 3.5 (jitter = 23.2)       7.478\r\n60      images/sec: 910.2 +/- 3.4 (jitter = 31.2)       7.463\r\n60      images/sec: 910.7 +/- 3.5 (jitter = 26.3)       7.487\r\n60      images/sec: 910.5 +/- 3.6 (jitter = 28.8)       7.436\r\n60      images/sec: 910.6 +/- 3.6 (jitter = 26.5)       7.408\r\n60      images/sec: 910.6 +/- 3.5 (jitter = 27.9)       7.446\r\n70      images/sec: 913.4 +/- 3.2 (jitter = 26.4)       7.409\r\n70      images/sec: 913.3 +/- 3.2 (jitter = 28.5)       7.441\r\n70      images/sec: 913.4 +/- 3.2 (jitter = 27.8)       7.459\r\n70      images/sec: 913.4 +/- 3.3 (jitter = 24.5)       7.440\r\n70      images/sec: 913.8 +/- 3.4 (jitter = 27.0)       7.459\r\n70      images/sec: 913.8 +/- 3.3 (jitter = 26.4)       7.483\r\n70      images/sec: 913.9 +/- 3.2 (jitter = 28.7)       7.385\r\n70      images/sec: 913.6 +/- 3.3 (jitter = 26.3)       7.445\r\n80      images/sec: 915.7 +/- 3.0 (jitter = 30.2)       7.407\r\n80      images/sec: 915.8 +/- 3.0 (jitter = 26.0)       7.407\r\n80      images/sec: 915.8 +/- 3.0 (jitter = 25.1)       7.468\r\n80      images/sec: 915.8 +/- 3.0 (jitter = 25.3)       7.472\r\n80      images/sec: 916.2 +/- 3.0 (jitter = 27.4)       7.467\r\n80      images/sec: 916.3 +/- 3.1 (jitter = 27.9)       7.443\r\n80      images/sec: 916.1 +/- 3.1 (jitter = 27.7)       7.491\r\n80      images/sec: 915.4 +/- 3.2 (jitter = 24.0)       7.553\r\n90      images/sec: 914.7 +/- 2.8 (jitter = 26.5)       7.404\r\n90      images/sec: 914.6 +/- 2.8 (jitter = 28.5)       7.408\r\n90      images/sec: 914.7 +/- 2.8 (jitter = 25.3)       7.457\r\n90      images/sec: 914.7 +/- 2.9 (jitter = 25.1)       7.405\r\n90      images/sec: 915.0 +/- 2.9 (jitter = 24.0)       7.437\r\n90      images/sec: 915.0 +/- 2.8 (jitter = 27.7)       7.504\r\n90      images/sec: 915.0 +/- 3.0 (jitter = 28.1)       7.431\r\n90      images/sec: 915.1 +/- 2.9 (jitter = 26.5)       7.430\r\n100     images/sec: 913.2 +/- 2.6 (jitter = 26.9)       7.890\r\n----------------------------------------------------------------\r\ntotal images/sec: 7301.54\r\n----------------------------------------------------------------\r\n```\r\n\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36005", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36005/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36005/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36005/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36005", "id": 551664937, "node_id": "MDU6SXNzdWU1NTE2NjQ5Mzc=", "number": 36005, "title": "Compiling tf.keras.Model with hub.KerasLayer fails in distributed scope", "user": {"login": "uchua", "id": 11432284, "node_id": "MDQ6VXNlcjExNDMyMjg0", "avatar_url": "https://avatars1.githubusercontent.com/u/11432284?v=4", "gravatar_id": "", "url": "https://api.github.com/users/uchua", "html_url": "https://github.com/uchua", "followers_url": "https://api.github.com/users/uchua/followers", "following_url": "https://api.github.com/users/uchua/following{/other_user}", "gists_url": "https://api.github.com/users/uchua/gists{/gist_id}", "starred_url": "https://api.github.com/users/uchua/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/uchua/subscriptions", "organizations_url": "https://api.github.com/users/uchua/orgs", "repos_url": "https://api.github.com/users/uchua/repos", "events_url": "https://api.github.com/users/uchua/events{/privacy}", "received_events_url": "https://api.github.com/users/uchua/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 1097541661, "node_id": "MDU6TGFiZWwxMDk3NTQxNjYx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tpus", "name": "comp:tpus", "color": "0052cc", "default": false, "description": "tpu, tpuestimator"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rxsang", "id": 6399870, "node_id": "MDQ6VXNlcjYzOTk4NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6399870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rxsang", "html_url": "https://github.com/rxsang", "followers_url": "https://api.github.com/users/rxsang/followers", "following_url": "https://api.github.com/users/rxsang/following{/other_user}", "gists_url": "https://api.github.com/users/rxsang/gists{/gist_id}", "starred_url": "https://api.github.com/users/rxsang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rxsang/subscriptions", "organizations_url": "https://api.github.com/users/rxsang/orgs", "repos_url": "https://api.github.com/users/rxsang/repos", "events_url": "https://api.github.com/users/rxsang/events{/privacy}", "received_events_url": "https://api.github.com/users/rxsang/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rxsang", "id": 6399870, "node_id": "MDQ6VXNlcjYzOTk4NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6399870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rxsang", "html_url": "https://github.com/rxsang", "followers_url": "https://api.github.com/users/rxsang/followers", "following_url": "https://api.github.com/users/rxsang/following{/other_user}", "gists_url": "https://api.github.com/users/rxsang/gists{/gist_id}", "starred_url": "https://api.github.com/users/rxsang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rxsang/subscriptions", "organizations_url": "https://api.github.com/users/rxsang/orgs", "repos_url": "https://api.github.com/users/rxsang/repos", "events_url": "https://api.github.com/users/rxsang/events{/privacy}", "received_events_url": "https://api.github.com/users/rxsang/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2020-01-17T22:38:56Z", "updated_at": "2020-02-21T18:43:42Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code: Yes\r\n- OS Platform and Distribution: Debian 9.11 (Google Cloud tf2-latest-gpu image)\r\n- TensorFlow installed from: Preinstalled on Google Cloud image\r\n- TensorFlow version: v2.1.0-rc2-17-ge5bf8de\r\n- Python version: 3.5.3\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: None (Using Google Cloud TPU v3-8)\r\n\r\n**Describe the current behavior**\r\nWhen compiling a tf.keras.Model that includes a hub.KerasLayer (tensorflow hub), it fails to compile in a distribution strategy scope:\r\n\r\n```\r\nValueError                                Traceback (most recent call last)\r\n<ipython-input-23-7b06371889c9> in <module>\r\n     16         optimizer=tf.keras.optimizers.Adam(learning_rate=LEARNING_RATE),\r\n     17         loss=tf.keras.losses.binary_crossentropy,\r\n---> 18         metrics=[\"accuracy\"]\r\n     19     )\r\n\r\n1 frames\r\n/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/training/tracking/base.py in _method_wrapper(self, *args, **kwargs)\r\n    455     self._self_setattr_tracking = False  # pylint: disable=protected-access\r\n    456     try:\r\n--> 457       result = method(self, *args, **kwargs)\r\n    458     finally:\r\n    459       self._self_setattr_tracking = previous_value  # pylint: disable=protected-access\r\n\r\n/usr/local/lib/python3.5/dist-packages/tensorflow_core/python/keras/engine/training.py in compile(self, optimizer, loss, metrics, loss_weights, sample_weight_mode, weighted_metrics, target_tensors, distribute, **kwargs)\r\n    469                 'with strategy.scope():\\n'\r\n    470                 '  model=_create_model()\\n'\r\n--> 471                 '  model.compile(...)'% (v, strategy))\r\n    472 \r\n    473   @trackable.no_automatic_dependency_tracking\r\n\r\nValueError: Variable (<tf.Variable 'bert/embeddings/word_embeddings:0' shape=(119547, 768) dtype=float32>) was not created in the distribution strategy scope of (<tensorflow.python.distribute.tpu_strategy.TPUStrategy object at 0x7f4df23cddd8>). It is most likely due to not all layers or the model or optimizer being created outside the distribution strategy scope. Try to make sure your code looks similar to the following.\r\nwith strategy.scope():\r\n  model=_create_model()\r\n  model.compile(...)\r\n```\r\n\r\n**Describe the expected behavior**\r\nModel should be able to compile.\r\n\r\n**Code to reproduce the issue**\r\nCode used to create scope:\r\n```python3\r\nTPU_ADDRESS = \"grpc://\" + \"10.0.0.2:8470\"\r\n\r\nwith tf.compat.v1.Session(TPU_ADDRESS) as session:\r\n    print('TPU devices:')\r\n    pprint.pprint(session.list_devices())\r\n\r\nresolver = tf.distribute.cluster_resolver.TPUClusterResolver(TPU_ADDRESS)\r\ntry:\r\n    tf.config.experimental_connect_to_cluster(resolver)\r\nexcept tf.errors.UnimplementedError as uie:\r\n    print(uie, \"This appears to be caused by the TPU already being connected. Ignoring.\", sep='\\n')\r\ntf.tpu.experimental.initialize_tpu_system(resolver)\r\ntpu_strategy = tf.distribute.experimental.TPUStrategy(resolver)\r\n```\r\n\r\nCode used to compile model:\r\n```python3\r\nwith tpu_strategy.scope():\r\n    in_id = tf.keras.layers.Input(shape=(MAX_SEQ_LENGTH,), name=\"input_ids\", dtype=np.int32)\r\n    in_mask = tf.keras.layers.Input(shape=(MAX_SEQ_LENGTH,), name=\"input_masks\", dtype=np.int32)\r\n    in_segment = tf.keras.layers.Input(shape=(MAX_SEQ_LENGTH,), name=\"segment_ids\", dtype=np.int32)\r\n    bert_inputs = {\"input_ids\": in_id, \"input_mask\": in_mask, \"segment_ids\": in_segment}\r\n\r\n    bert_layer = hub.KerasLayer(BERT_MODEL_HUB, signature=\"tokens\", output_key=\"pooled_output\")(bert_inputs)\r\n    bert_layer.trainable = True\r\n\r\n    dense = tf.keras.layers.Dense(256, activation='relu')(bert_layer)\r\n    pred = tf.keras.layers.Dense(len(unique_labels), activation='sigmoid')(dense)\r\n\r\n    model = tf.keras.Model(inputs=bert_inputs, outputs=pred)\r\n\r\n    model.compile(\r\n        optimizer=tf.keras.optimizers.Adam(learning_rate=LEARNING_RATE),\r\n        loss=tf.keras.losses.binary_crossentropy,\r\n        metrics=[\"accuracy\"]\r\n    )\r\n```\r\n\r\n**Other info / logs**\r\nPreviously opened issue with TF Hub here: https://github.com/tensorflow/hub/issues/469\r\n\r\nGoogle Cloud TPU v3-8 is running TPU Software 2.1\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36004", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36004/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36004/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36004/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36004", "id": 551646284, "node_id": "MDU6SXNzdWU1NTE2NDYyODQ=", "number": 36004, "title": "`python': double free or corruption", "user": {"login": "Joshuaalbert", "id": 14807032, "node_id": "MDQ6VXNlcjE0ODA3MDMy", "avatar_url": "https://avatars2.githubusercontent.com/u/14807032?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Joshuaalbert", "html_url": "https://github.com/Joshuaalbert", "followers_url": "https://api.github.com/users/Joshuaalbert/followers", "following_url": "https://api.github.com/users/Joshuaalbert/following{/other_user}", "gists_url": "https://api.github.com/users/Joshuaalbert/gists{/gist_id}", "starred_url": "https://api.github.com/users/Joshuaalbert/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Joshuaalbert/subscriptions", "organizations_url": "https://api.github.com/users/Joshuaalbert/orgs", "repos_url": "https://api.github.com/users/Joshuaalbert/repos", "events_url": "https://api.github.com/users/Joshuaalbert/events{/privacy}", "received_events_url": "https://api.github.com/users/Joshuaalbert/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 16, "created_at": "2020-01-17T21:45:05Z", "updated_at": "2020-02-05T23:13:40Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): **yes**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): \r\n**Scientific Linux 7.7 (Nitrogen) \r\nLinux 3.10.0-1062.9.1.el7.x86_64** \r\n- TensorFlow installed from (source or binary): **binary**\r\n- TensorFlow version (use command below):\r\n**v1.15.0-rc3-22-g590d6ee 1.15.0**\r\nSame problem occurs with tf 1.14\r\n- Python version:\r\n**3.6**\r\n- Bazel version (if compiling from source):\r\n**NA**\r\n- GCC/Compiler version (if compiling from source):\r\n**4.8.5**\r\n- CUDA/cuDNN version:\r\n**NA, running on CPU**\r\n- GPU model and memory:\r\n**NA**\r\n\r\n**Describe the current behavior**\r\n\r\nI am using PBS to submit jobs to a homogeneous cluster. Each job is allocated up to 192GB memory, and the job itself uses only 50GB at peak. Each job is a loop that iteratively solves around 1000 Gaussian process regression problems using TF. In pseudo-code it is,\r\n``` python\r\ndef job():\r\n  N=1000\r\n  for i in range(N):\r\n    with tf.Session(graph=tf.Graph()) as sess:\r\n      solve_gp_problem(sess, sess.graph)\r\n      # around i ~ 300 we get `python': double free or corruption\r\n      # but only in ~50% of the jobs that are submitted (with the exact same data)\r\n```\r\nEach Gaussian process problem creates its own graph and session, and lasts approximately 10 seconds. Then the graph and session are not referenced again (and should be garbage collected). The job uses no multiprocessing or threading outside of TF's inherent use. \r\n\r\nApproximately 50% of my jobs are abruptly failing with ``python': double free or corruption` and a long stack trace, after approximately 1/3 of the work is done. This happens also when I give the jobs the exact same input data.\r\n\r\n**Describe the expected behavior**\r\n\r\nSome memory is trying to be freed twice in tensorflow, which should not happen. \r\n\r\n**Code to reproduce the issue**\r\nThis error cannot be deterministically reproduced since it doesn't occur all of the time. However, it looks like this,\r\n``` python\r\nimport tensorflow.compat.v1 as tf\r\ndef loss(x):\r\n  return tf.reduce_sum(x ** 2)\r\n\r\ndef loss_and_grad(x):\r\n  l = loss(x)\r\n  return l, tf.gradients(l, [x])[0]\r\n\r\ndef build_loss_np(sess):\r\n  x_pl = tf.placeholder(tf.float32)\r\n  l_g = loss_and_grad(x_pl)\r\n  def _loss(x):\r\n    return sess.run(l_g, {x_pl: x})\r\n  return _loss\r\n\r\nfrom scipy.optimize import minimize\r\nfor i in range(1000):\r\n  with tf.Session(graph=tf.Graph()) as sess:\r\n    loss_func = build_loss_np(sess)\r\n    # stand-in for GP hyper parameter optimisation and regression\r\n    res = minimize(loss_func, [0], method='BFGS', jac=True)\r\n```\r\n\r\n**Other info / logs**\r\nThe only consistent thing I notice is that the failure usually occurs around the same point after about 300 loops. Therefore there would be 300 graphs and sessions created.\r\nThe code that performs the gaussian process regression is a solid code base called GPFlow.\r\n[traceback.log](https://github.com/tensorflow/tensorflow/files/4079155/traceback.log)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36002", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36002/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36002/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36002/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/36002", "id": 551634805, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY0MzIxNzg3", "number": 36002, "title": "Allow Optimizers to perform global gradient clipping", "user": {"login": "artemmavrin", "id": 12015989, "node_id": "MDQ6VXNlcjEyMDE1OTg5", "avatar_url": "https://avatars2.githubusercontent.com/u/12015989?v=4", "gravatar_id": "", "url": "https://api.github.com/users/artemmavrin", "html_url": "https://github.com/artemmavrin", "followers_url": "https://api.github.com/users/artemmavrin/followers", "following_url": "https://api.github.com/users/artemmavrin/following{/other_user}", "gists_url": "https://api.github.com/users/artemmavrin/gists{/gist_id}", "starred_url": "https://api.github.com/users/artemmavrin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/artemmavrin/subscriptions", "organizations_url": "https://api.github.com/users/artemmavrin/orgs", "repos_url": "https://api.github.com/users/artemmavrin/repos", "events_url": "https://api.github.com/users/artemmavrin/events{/privacy}", "received_events_url": "https://api.github.com/users/artemmavrin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1178505529, "node_id": "MDU6TGFiZWwxMTc4NTA1NTI5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/prtype:bugfix", "name": "prtype:bugfix", "color": "159b2e", "default": false, "description": "PR to fix a bug"}, {"id": 1169364259, "node_id": "MDU6TGFiZWwxMTY5MzY0MjU5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:XS", "name": "size:XS", "color": "adafea", "default": false, "description": "CL Change Size: Extra Small"}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-01-17T21:14:45Z", "updated_at": "2020-02-20T08:49:48Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/36002", "html_url": "https://github.com/tensorflow/tensorflow/pull/36002", "diff_url": "https://github.com/tensorflow/tensorflow/pull/36002.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/36002.patch"}, "body": "Fixes #36001"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36001", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36001/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36001/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/36001/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/36001", "id": 551634426, "node_id": "MDU6SXNzdWU1NTE2MzQ0MjY=", "number": 36001, "title": "Allow Optimizers to perform global gradient clipping", "user": {"login": "artemmavrin", "id": 12015989, "node_id": "MDQ6VXNlcjEyMDE1OTg5", "avatar_url": "https://avatars2.githubusercontent.com/u/12015989?v=4", "gravatar_id": "", "url": "https://api.github.com/users/artemmavrin", "html_url": "https://github.com/artemmavrin", "followers_url": "https://api.github.com/users/artemmavrin/followers", "following_url": "https://api.github.com/users/artemmavrin/following{/other_user}", "gists_url": "https://api.github.com/users/artemmavrin/gists{/gist_id}", "starred_url": "https://api.github.com/users/artemmavrin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/artemmavrin/subscriptions", "organizations_url": "https://api.github.com/users/artemmavrin/orgs", "repos_url": "https://api.github.com/users/artemmavrin/repos", "events_url": "https://api.github.com/users/artemmavrin/events{/privacy}", "received_events_url": "https://api.github.com/users/artemmavrin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-01-17T21:13:46Z", "updated_at": "2020-03-07T00:59:17Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- TensorFlow version: 2.1\r\n- Are you willing to contribute it: Yes\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\nCurrently, passing `clipnorm` to a `tf.keras.optimizers.Optimizer` makes it clip the gradient for each weight tensor locally, or *independently of other weight gradients*:\r\n\r\nhttps://github.com/tensorflow/tensorflow/blob/d8bcf5e4a24f9904e9a97b41da393e53149e999e/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L357-L358\r\n\r\nI am proposing clipping the weight gradient *globally*, i.e.,\r\n\r\n```python\r\n    if hasattr(self, 'clipnorm'):\r\n      grads, _ = clip_ops.clip_by_global_norm(grads, self.clipnorm)\r\n```\r\n\r\nThis was already proposed in #29108 and #29114.\r\n\r\nThis change has at least two benefits:\r\n\r\n1. Theoretical: the per-batch descent direction is preserved when gradients are clipped globally, but not when clipped locally.\r\n2. Practical: [standalone Keras implements global gradient clipping](https://github.com/keras-team/keras/blob/7a39b6c62d43c25472b2c2476bd2a8983ae4f682/keras/optimizers.py#L98-L100):\r\n    ```python\r\n        if hasattr(self, 'clipnorm') and self.clipnorm > 0:\r\n            norm = K.sqrt(sum([K.sum(K.square(g)) for g in grads]))\r\n            grads = [clip_norm(g, self.clipnorm, norm) for g in grads]\r\n    ```\r\n    so this change will unify `keras` and `tf.keras` behavior.\r\n\r\nIn fact, clipping by global norm is the behavior I *expected* when I first learned about the `clipnorm` parameter. The documentation does not clarify whether gradients are clipped locally or globally:\r\n\r\nhttps://github.com/tensorflow/tensorflow/blob/d8bcf5e4a24f9904e9a97b41da393e53149e999e/tensorflow/python/keras/optimizer_v2/optimizer_v2.py#L241-L245\r\n\r\n**Will this change the current api? How?**\r\n\r\nThe API will remain the same. Only the weight update behavior will change when the user passes `clipnorm` to an optimizer.\r\n\r\n**Who will benefit with this feature?**\r\n\r\nUsers who use `clipnorm` with their optimizers.\r\n\r\n**Any Other info.**\r\n\r\nOne of the first papers introducing gradient clipping by norm is [Pascanu, Mikolov, Bengio (2013)](http://proceedings.mlr.press/v28/pascanu13.html), where they propose\r\n![Screen Shot 2020-01-17 at 12 28 38 PM](https://user-images.githubusercontent.com/12015989/72644067-f299e800-3924-11ea-8a27-2c4d48880e52.png)\r\n\r\nIn Section 1.1, \u03b8 is defined to be the collection of *all* weights in the model, not just a particular weight matrix or bias vector. This addresses [a question](https://github.com/tensorflow/tensorflow/pull/29114/files#r294862824\r\n) In #29114 about whether the paper proposes global clipping or local clipping. Moreover, following Algorithm 1, Pascanu *et al* write,\r\n\r\n> we only diverged from the original proposal in an attempt to provide a better theoretical justification (see section 2.3; we also move in a descent direction for the current mini-batch)\r\n\r\nso they appear to be advocating altering the gradient in a way that preserves the descent direction (i.e., using global clipping).\r\n\r\nOther recent sources also appear to suggest *global* gradient clipping (e.g., see equation (5) of [this ICLR 2020 paper](https://openreview.net/forum?id=BJgnXpVYwS))."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35998", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35998/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35998/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35998/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/35998", "id": 551598416, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY0MjkxNTQ0", "number": 35998, "title": "Change collection.Sequence to collection.abc.Sequence in keras recurrent.py (with python2 switch)", "user": {"login": "ulf1", "id": 8018044, "node_id": "MDQ6VXNlcjgwMTgwNDQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/8018044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ulf1", "html_url": "https://github.com/ulf1", "followers_url": "https://api.github.com/users/ulf1/followers", "following_url": "https://api.github.com/users/ulf1/following{/other_user}", "gists_url": "https://api.github.com/users/ulf1/gists{/gist_id}", "starred_url": "https://api.github.com/users/ulf1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ulf1/subscriptions", "organizations_url": "https://api.github.com/users/ulf1/orgs", "repos_url": "https://api.github.com/users/ulf1/repos", "events_url": "https://api.github.com/users/ulf1/events{/privacy}", "received_events_url": "https://api.github.com/users/ulf1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1178505529, "node_id": "MDU6TGFiZWwxMTc4NTA1NTI5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/prtype:bugfix", "name": "prtype:bugfix", "color": "159b2e", "default": false, "description": "PR to fix a bug"}, {"id": 1169364259, "node_id": "MDU6TGFiZWwxMTY5MzY0MjU5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:XS", "name": "size:XS", "color": "adafea", "default": false, "description": "CL Change Size: Extra Small"}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-01-17T19:42:41Z", "updated_at": "2020-02-13T11:13:22Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/35998", "html_url": "https://github.com/tensorflow/tensorflow/pull/35998", "diff_url": "https://github.com/tensorflow/tensorflow/pull/35998.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/35998.patch"}, "body": "see https://github.com/tensorflow/tensorflow/pull/35895#issuecomment-575684267\r\n@gunan \r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35997", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35997/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35997/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35997/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/35997", "id": 551590499, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY0Mjg1MTAx", "number": 35997, "title": "Add 16 bit support to kernel operator TRANSPOSE_CONVOLUTION", "user": {"login": "psunn", "id": 55463253, "node_id": "MDQ6VXNlcjU1NDYzMjUz", "avatar_url": "https://avatars3.githubusercontent.com/u/55463253?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psunn", "html_url": "https://github.com/psunn", "followers_url": "https://api.github.com/users/psunn/followers", "following_url": "https://api.github.com/users/psunn/following{/other_user}", "gists_url": "https://api.github.com/users/psunn/gists{/gist_id}", "starred_url": "https://api.github.com/users/psunn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psunn/subscriptions", "organizations_url": "https://api.github.com/users/psunn/orgs", "repos_url": "https://api.github.com/users/psunn/repos", "events_url": "https://api.github.com/users/psunn/events{/privacy}", "received_events_url": "https://api.github.com/users/psunn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1169365682, "node_id": "MDU6TGFiZWwxMTY5MzY1Njgy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:L", "name": "size:L", "color": "adafea", "default": false, "description": "CL Change Size: Large"}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-01-17T19:23:58Z", "updated_at": "2020-03-19T01:15:24Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/35997", "html_url": "https://github.com/tensorflow/tensorflow/pull/35997", "diff_url": "https://github.com/tensorflow/tensorflow/pull/35997.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/35997.patch"}, "body": "This PR is one of steps to extend TFLite to support symmetric 16-bit activations.\r\n\r\nIn this PR we introduce implementation and tests for TRANSPOSE_CONV kernel reference function.\r\nThe specification of this operator:\r\n\r\nTRANSPOSE_CONVOLUTION\r\n\u202f Input 0:\r\n\u202f \u202f data_type \u202f: int16\r\n\u202f \u202f range \u202f \u202f \u202f: [-32768, 32767]\r\n\u202f \u202f granularity: per-tensor, zero_point=0\r\n\u202f Input 1 (Weight):\r\n\u202f \u202f data_type \u202f: int8\r\n\u202f \u202f range \u202f \u202f \u202f: [-127, 127]\r\n\u202f \u202f granularity: per-axis (dim = 0), zero_point=0\r\n\u202f Output 0:\r\n\u202f \u202f data_type \u202f: int16\r\n\u202f \u202f range \u202f \u202f \u202f: [-32768,32767]\r\n\u202f \u202f granularity: per-tensor, zero_point=0"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35996", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35996/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35996/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35996/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/35996", "id": 551579622, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY0Mjc2Mjgy", "number": 35996, "title": "Add 16 bit support to kernel operator SOFTMAX", "user": {"login": "psunn", "id": 55463253, "node_id": "MDQ6VXNlcjU1NDYzMjUz", "avatar_url": "https://avatars3.githubusercontent.com/u/55463253?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psunn", "html_url": "https://github.com/psunn", "followers_url": "https://api.github.com/users/psunn/followers", "following_url": "https://api.github.com/users/psunn/following{/other_user}", "gists_url": "https://api.github.com/users/psunn/gists{/gist_id}", "starred_url": "https://api.github.com/users/psunn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psunn/subscriptions", "organizations_url": "https://api.github.com/users/psunn/orgs", "repos_url": "https://api.github.com/users/psunn/repos", "events_url": "https://api.github.com/users/psunn/events{/privacy}", "received_events_url": "https://api.github.com/users/psunn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1169365682, "node_id": "MDU6TGFiZWwxMTY5MzY1Njgy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:L", "name": "size:L", "color": "adafea", "default": false, "description": "CL Change Size: Large"}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2020-01-17T18:58:29Z", "updated_at": "2020-03-19T09:44:20Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/35996", "html_url": "https://github.com/tensorflow/tensorflow/pull/35996", "diff_url": "https://github.com/tensorflow/tensorflow/pull/35996.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/35996.patch"}, "body": "This PR is one of steps to extend TFLite to support symmetric 16-bit activations.\r\n\r\nIn this PR we introduce implementation and tests for SOFTMAX kernel reference function.\r\nThe specification of this operator:\r\n\r\nSOFTMAX\r\n\u202f Input 0:\r\n\u202f \u202f data_type \u202f: int16\r\n\u202f \u202f range \u202f \u202f \u202f: [-32768, 32767]\r\n\u202f \u202f granularity: per-tensor, zero_point=0\r\n\u202f Output 0:\r\n\u202f \u202f data_type \u202f: int16\r\n\u202f \u202f range \u202f \u202f \u202f: [-32768,32767]\r\n\u202f \u202f granularity: per-tensor, zero_point=0"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35995", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35995/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35995/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35995/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35995", "id": 551555346, "node_id": "MDU6SXNzdWU1NTE1NTUzNDY=", "number": 35995, "title": "The summary method could be changed for improved understandability and readability", "user": {"login": "nbro", "id": 9349000, "node_id": "MDQ6VXNlcjkzNDkwMDA=", "avatar_url": "https://avatars2.githubusercontent.com/u/9349000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nbro", "html_url": "https://github.com/nbro", "followers_url": "https://api.github.com/users/nbro/followers", "following_url": "https://api.github.com/users/nbro/following{/other_user}", "gists_url": "https://api.github.com/users/nbro/gists{/gist_id}", "starred_url": "https://api.github.com/users/nbro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nbro/subscriptions", "organizations_url": "https://api.github.com/users/nbro/orgs", "repos_url": "https://api.github.com/users/nbro/repos", "events_url": "https://api.github.com/users/nbro/events{/privacy}", "received_events_url": "https://api.github.com/users/nbro/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-01-17T18:02:11Z", "updated_at": "2020-03-11T06:49:37Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using): 2.0\r\n- Are you willing to contribute it (Yes/No): Maybe\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\nConsider the following program\r\n\r\n```\r\nimport tensorflow as tf\r\nimport tensorflow_probability as tfp\r\n\r\n\r\ndef get_model():\r\n    inp = tf.keras.layers.Input(shape=(1,))\r\n    x = tfp.layers.DenseFlipout(8)(inp)\r\n    x = tfp.layers.DenseFlipout(16)(x)\r\n    out = tfp.layers.DenseFlipout(1)(x)\r\n    model = tf.keras.Model(inputs=inp, outputs=out)\r\n    model.summary()\r\n    return model\r\n\r\n\r\nif __name__ == '__main__':\r\n    get_model()\r\n```\r\n\r\nwhich produces the following output\r\n\r\n```\r\nModel: \"model\"\r\n_________________________________________________________________\r\nLayer (type)                 Output Shape              Param #   \r\n=================================================================\r\ninput_1 (InputLayer)         [(None, 1)]               0         \r\n_________________________________________________________________\r\ndense_flipout (DenseFlipout) (None, 8)                 24        \r\n_________________________________________________________________\r\ndense_flipout_1 (DenseFlipou (None, 16)                272       \r\n_________________________________________________________________\r\ndense_flipout_2 (DenseFlipou (None, 1)                 33        \r\n=================================================================\r\nTotal params: 329\r\nTrainable params: 329\r\nNon-trainable params: 0\r\n_________________________________________________________________\r\n```\r\n\r\nThe first layer has 24 parameters because there are 8 means, 8 standard deviations and 8 biases, for a total of `8+8+8=24`. Similarly, the second contains 272 parameters because there are `8*16` means \r\n `8*16` standard deviations and 16 biases. And the last layer contains 16 means, 16 standard deviations and 1 biases.  Now, in this case, I have domain knowledge and I was able to understand these numbers, but, in certain cases, for example, when Bayesian convolution layers are used, the number of parameters of certain layers may not be obvious. \r\n\r\nTherefore, if possible, it would be nice that `my_model.summary()` provided a more detailed description of the number of parameters for each layer (e.g. the actual calculation with a description).  This feature may be implemented by providing a `verbose` parameter for the `summary` method, which allows us to set the verbosity level of the output.\r\n\r\nFurthermore, there are cases where the output is also cut. For example, consider the following output of the `summary` method\r\n\r\n```\r\nModel: \"model\"\r\n__________________________________________________________________________________________________\r\nLayer (type)                    Output Shape         Param #     Connected to                     \r\n==================================================================================================\r\ncamera (InputLayer)             [(None, 64, 80, 3)]  0                                            \r\n__________________________________________________________________________________________________\r\nconv2d_flipout (Conv2DFlipout)  (None, 64, 80, 8)    441         camera[0][0]                     \r\n__________________________________________________________________________________________________\r\nactivation (Activation)         (None, 64, 80, 8)    0           conv2d_flipout[0][0]             \r\n__________________________________________________________________________________________________\r\nmax_pooling2d (MaxPooling2D)    (None, 32, 40, 8)    0           activation[0][0]                 \r\n__________________________________________________________________________________________________\r\nflatten (Flatten)               (None, 10240)        0           max_pooling2d[0][0]              \r\n__________________________________________________________________________________________________\r\ndense_flipout (DenseFlipout)    (None, 512)          10486273    flatten[0][0]                    \r\n__________________________________________________________________________________________________\r\ntarget_locations (DenseFlipout) (None, 289)          296226      dense_flipout[0][0]              \r\n__________________________________________________________________________________________________\r\ntarget_rhos (DenseFlipout)      (None, 289)          296226      dense_flipout[0][0]              \r\n__________________________________________________________________________________________________\r\ntarget (DistributionLambda)     ((None, 289), (None, 0           target_locations[0][0]           \r\n                                                                 target_rhos[0][0]                \r\n==================================================================================================\r\n```\r\n\r\nIn this case, the output partially cuts the output shape of the last layer, so there should also be a way of adjusting the style of the output of `summary`.\r\n\r\n**Will this change the current api? How?**\r\n\r\nI am not sure.\r\n\r\n**Who will benefit with this feature?**\r\n\r\nEveryone."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35994", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35994/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35994/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35994/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35994", "id": 551554644, "node_id": "MDU6SXNzdWU1NTE1NTQ2NDQ=", "number": 35994, "title": "Expand registered kernels for variable ops on GPU", "user": {"login": "dirktheeng", "id": 830362, "node_id": "MDQ6VXNlcjgzMDM2Mg==", "avatar_url": "https://avatars2.githubusercontent.com/u/830362?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dirktheeng", "html_url": "https://github.com/dirktheeng", "followers_url": "https://api.github.com/users/dirktheeng/followers", "following_url": "https://api.github.com/users/dirktheeng/following{/other_user}", "gists_url": "https://api.github.com/users/dirktheeng/gists{/gist_id}", "starred_url": "https://api.github.com/users/dirktheeng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dirktheeng/subscriptions", "organizations_url": "https://api.github.com/users/dirktheeng/orgs", "repos_url": "https://api.github.com/users/dirktheeng/repos", "events_url": "https://api.github.com/users/dirktheeng/events{/privacy}", "received_events_url": "https://api.github.com/users/dirktheeng/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "alextp", "id": 5061, "node_id": "MDQ6VXNlcjUwNjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/5061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alextp", "html_url": "https://github.com/alextp", "followers_url": "https://api.github.com/users/alextp/followers", "following_url": "https://api.github.com/users/alextp/following{/other_user}", "gists_url": "https://api.github.com/users/alextp/gists{/gist_id}", "starred_url": "https://api.github.com/users/alextp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alextp/subscriptions", "organizations_url": "https://api.github.com/users/alextp/orgs", "repos_url": "https://api.github.com/users/alextp/repos", "events_url": "https://api.github.com/users/alextp/events{/privacy}", "received_events_url": "https://api.github.com/users/alextp/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alextp", "id": 5061, "node_id": "MDQ6VXNlcjUwNjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/5061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alextp", "html_url": "https://github.com/alextp", "followers_url": "https://api.github.com/users/alextp/followers", "following_url": "https://api.github.com/users/alextp/following{/other_user}", "gists_url": "https://api.github.com/users/alextp/gists{/gist_id}", "starred_url": "https://api.github.com/users/alextp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alextp/subscriptions", "organizations_url": "https://api.github.com/users/alextp/orgs", "repos_url": "https://api.github.com/users/alextp/repos", "events_url": "https://api.github.com/users/alextp/events{/privacy}", "received_events_url": "https://api.github.com/users/alextp/received_events", "type": "User", "site_admin": false}, {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2020-01-17T18:00:30Z", "updated_at": "2020-01-30T23:41:56Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using):1.14/1.15\r\n- Are you willing to contribute it (Yes/No): yes\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\nThe current variable op on GPU is restricted to float, double, and int64.  Through the TF_CALL_GPU_NUMBER_TYPES and\r\nTF_CALL_int64 macros.\r\n\r\nThe notes say to restrict the dtype to those supported by the assignment op.  The assignment op has a broader range of dtypes registered through the\r\nTF_CALL_GPU_ALL_TYPES and \r\nTF_CALL_int64 macros.\r\n\r\nThis disallows users to store boolian data with small memory footprints and forces unnecessary casts.  For that matter int32's and half precision could probably also be added.\r\n\r\nIts a very easy change to make.  However, I am not sure if there is further rational for the restricted types.\r\n\r\n**Will this change the current api? How?**\r\nNothing other than allowing more dtypes to be passed into variable constuctors\r\n\r\n\r\n**Who will benefit with this feature?**\r\nAnyone who wants to lower variable memory footprint \r\n\r\n\r\n**Any Other info.**\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35992", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35992/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35992/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35992/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35992", "id": 551539939, "node_id": "MDU6SXNzdWU1NTE1Mzk5Mzk=", "number": 35992, "title": "Keras TextVectorization AttributeError during save_weights", "user": {"login": "tripzero", "id": 1034370, "node_id": "MDQ6VXNlcjEwMzQzNzA=", "avatar_url": "https://avatars1.githubusercontent.com/u/1034370?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tripzero", "html_url": "https://github.com/tripzero", "followers_url": "https://api.github.com/users/tripzero/followers", "following_url": "https://api.github.com/users/tripzero/following{/other_user}", "gists_url": "https://api.github.com/users/tripzero/gists{/gist_id}", "starred_url": "https://api.github.com/users/tripzero/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tripzero/subscriptions", "organizations_url": "https://api.github.com/users/tripzero/orgs", "repos_url": "https://api.github.com/users/tripzero/repos", "events_url": "https://api.github.com/users/tripzero/events{/privacy}", "received_events_url": "https://api.github.com/users/tripzero/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-01-17T17:25:37Z", "updated_at": "2020-01-20T10:57:51Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Colab code: https://colab.research.google.com/drive/1Lf1s9O6Z5ss33GEtb4UXEgjq4wiHw7iy\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 19.04/19.10, Google Colab\r\n- TensorFlow installed from (source or binary): pypi binary\r\n- TensorFlow version (use command below): 2.1.0\r\n- Python version: 3.7\r\n\r\n**Describe the current behavior**\r\n\r\nAttributeError when calling save_weights on a trained model.\r\n\r\n```\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/backend.py in <listcomp>(.0)\r\n   3274   \"\"\"\r\n   3275   if context.executing_eagerly():\r\n-> 3276     return [x.numpy() for x in tensors]\r\n   3277   elif ops.inside_function():  # pylint: disable=protected-access\r\n   3278     raise RuntimeError('Cannot get value inside Tensorflow graph function.')\r\n\r\nAttributeError: 'TrackableWeightHandler' object has no attribute 'numpy'\r\n```\r\n\r\n**Describe the expected behavior**\r\n\r\nModel weights can be saved\r\n\r\n**Code to reproduce the issue**\r\n\r\nI simply modified Fran\u00e7ois Chollet's (@fchollet) collab and added save_weights at the end:\r\n\r\nhttps://colab.research.google.com/drive/1Lf1s9O6Z5ss33GEtb4UXEgjq4wiHw7iy#scrollTo=ZXQKEh53v948\r\n\r\nOriginal colab here:\r\n\r\nhttps://colab.research.google.com/drive/1RvCnR7h0_l4Ekn5vINWToI9TNJdpUZB3\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35987", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35987/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35987/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35987/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35987", "id": 551418242, "node_id": "MDU6SXNzdWU1NTE0MTgyNDI=", "number": 35987, "title": "interpreter.invoke() of tflite model causes Aborted (core dumped) despite successful tflite conversion under tensorflow version 1.14.0", "user": {"login": "lllAlexanderlll", "id": 12560547, "node_id": "MDQ6VXNlcjEyNTYwNTQ3", "avatar_url": "https://avatars1.githubusercontent.com/u/12560547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lllAlexanderlll", "html_url": "https://github.com/lllAlexanderlll", "followers_url": "https://api.github.com/users/lllAlexanderlll/followers", "following_url": "https://api.github.com/users/lllAlexanderlll/following{/other_user}", "gists_url": "https://api.github.com/users/lllAlexanderlll/gists{/gist_id}", "starred_url": "https://api.github.com/users/lllAlexanderlll/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lllAlexanderlll/subscriptions", "organizations_url": "https://api.github.com/users/lllAlexanderlll/orgs", "repos_url": "https://api.github.com/users/lllAlexanderlll/repos", "events_url": "https://api.github.com/users/lllAlexanderlll/events{/privacy}", "received_events_url": "https://api.github.com/users/lllAlexanderlll/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gargn", "id": 1900612, "node_id": "MDQ6VXNlcjE5MDA2MTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1900612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gargn", "html_url": "https://github.com/gargn", "followers_url": "https://api.github.com/users/gargn/followers", "following_url": "https://api.github.com/users/gargn/following{/other_user}", "gists_url": "https://api.github.com/users/gargn/gists{/gist_id}", "starred_url": "https://api.github.com/users/gargn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gargn/subscriptions", "organizations_url": "https://api.github.com/users/gargn/orgs", "repos_url": "https://api.github.com/users/gargn/repos", "events_url": "https://api.github.com/users/gargn/events{/privacy}", "received_events_url": "https://api.github.com/users/gargn/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gargn", "id": 1900612, "node_id": "MDQ6VXNlcjE5MDA2MTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1900612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gargn", "html_url": "https://github.com/gargn", "followers_url": "https://api.github.com/users/gargn/followers", "following_url": "https://api.github.com/users/gargn/following{/other_user}", "gists_url": "https://api.github.com/users/gargn/gists{/gist_id}", "starred_url": "https://api.github.com/users/gargn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gargn/subscriptions", "organizations_url": "https://api.github.com/users/gargn/orgs", "repos_url": "https://api.github.com/users/gargn/repos", "events_url": "https://api.github.com/users/gargn/events{/privacy}", "received_events_url": "https://api.github.com/users/gargn/received_events", "type": "User", "site_admin": false}, {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2020-01-17T13:33:59Z", "updated_at": "2020-02-19T13:03:44Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Kubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): pip3\r\n- TensorFlow version (use command below): 1.14.0\r\n- Python version: 3.6.9\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\n**Describe the current behavior**\r\nThe  [mobilenetvlad model](https://github.com/ethz-asl/hierarchical_loc/tree/master/global-loc/models/mobilenetvlad_depth-0.35) was successfuly converted to a tf lite model by [the sample code provided](https://www.tensorflow.org/versions/r1.15/api_docs/python/tf/lite/TFLiteConverter) from the tensorflow website.  To archieve this I added the parameter `input_shapes` to the `from_saved_model` call:\r\n```converter = tf.lite.TFLiteConverter.from_saved_model(saved_model_dir, input_shapes={\"image\": [1, 640, 480, None]})```\r\n\r\nBut if inference is tested with the according [sample code](https://www.tensorflow.org/lite/guide/inference#load_and_run_a_model_in_python) from the tensorflow website, the program is aborted and the core dumped.\r\n\r\n**Describe the expected behavior**\r\nSucessfull inference and output of a [1, 4096] sized image descriptor.\r\n\r\n**Code to reproduce the issue**\r\n1. Download the  [mobilenetvlad model](https://github.com/ethz-asl/hierarchical_loc/tree/master/global-loc/models/mobilenetvlad_depth-0.35)\r\n2. With tensorflow 1.14.0 (tf2 will not work): Convert the saved_model to tflite, by setting an input shape (was set to None, None, None, 1]) in the [model description](https://github.com/ethz-asl/hierarchical_loc/blob/master/retrievalnet/retrievalnet/models/mobilenetvlad.py), but should be 640x480 according to the [paper.pdf](https://arxiv.org/pdf/1809.01019.pdf):\r\n```\r\nimport tensorflow as tf\r\nsaved_model_dir='hierarchical_loc/global-loc/models/mobilenetvlad_depth-0.35'\r\nconverter = tf.lite.TFLiteConverter.from_saved_model(saved_model_dir, input_shapes={\"image\": [1, 640, 480, None]}) #only change of code beside filenames\r\ntflite_model = converter.convert()\r\nopen(\"converted_model_1_640_480.tflite\", \"wb\").write(tflite_model) \r\n```\r\n3. Run the inference with the [sample code](https://www.tensorflow.org/lite/guide/inference#load_and_run_a_model_in_python):\r\n```\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\nprint(tf.__version__)\r\n\r\n# Load TFLite model and allocate tensors.\r\ninterpreter = tf.lite.Interpreter(model_path=\"converted_model_1_640_480.tflite\")\r\ninterpreter.allocate_tensors()\r\n\r\n# Get input and output tensors.\r\ninput_details = interpreter.get_input_details()\r\noutput_details = interpreter.get_output_details()\r\nprint(input_details)\r\nprint(output_details)\r\n\r\n# Test model on random input data.\r\ninput_shape = input_details[0]['shape']\r\ninput_data = np.array(np.random.random_sample(input_shape), dtype=np.float32)\r\nprint(input_data.shape)\r\ninterpreter.set_tensor(input_details[0]['index'], input_data)\r\n\r\ninterpreter.invoke()\r\n\r\noutput_data = interpreter.get_tensor(output_details[0]['index'])\r\nprint(output_data)\r\n```\r\n\r\n\r\n\r\n**Other info / logs**\r\n\r\nOutput of the tflite conversion. [Edited: copied the wrong output, sorry]. \r\nAnd don't worry about the virtual environmnet naming `VirtualEnvironments/tensorflow_1_15/`. I initially wanted to install tf 1.15.0, but only tf 1.14.0 worked:\r\n```/home/alex/Documents/VirtualEnvironments/tensorflow_1_15/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint8 = np.dtype([(\"qint8\", np.int8, 1)])\r\n/home/alex/Documents/VirtualEnvironments/tensorflow_1_15/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint8 = np.dtype([(\"quint8\", np.uint8, 1)])\r\n/home/alex/Documents/VirtualEnvironments/tensorflow_1_15/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint16 = np.dtype([(\"qint16\", np.int16, 1)])\r\n/home/alex/Documents/VirtualEnvironments/tensorflow_1_15/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint16 = np.dtype([(\"quint16\", np.uint16, 1)])\r\n/home/alex/Documents/VirtualEnvironments/tensorflow_1_15/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint32 = np.dtype([(\"qint32\", np.int32, 1)])\r\n/home/alex/Documents/VirtualEnvironments/tensorflow_1_15/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  np_resource = np.dtype([(\"resource\", np.ubyte, 1)])\r\n/home/alex/Documents/VirtualEnvironments/tensorflow_1_15/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint8 = np.dtype([(\"qint8\", np.int8, 1)])\r\n/home/alex/Documents/VirtualEnvironments/tensorflow_1_15/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint8 = np.dtype([(\"quint8\", np.uint8, 1)])\r\n/home/alex/Documents/VirtualEnvironments/tensorflow_1_15/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint16 = np.dtype([(\"qint16\", np.int16, 1)])\r\n/home/alex/Documents/VirtualEnvironments/tensorflow_1_15/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint16 = np.dtype([(\"quint16\", np.uint16, 1)])\r\n/home/alex/Documents/VirtualEnvironments/tensorflow_1_15/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint32 = np.dtype([(\"qint32\", np.int32, 1)])\r\n/home/alex/Documents/VirtualEnvironments/tensorflow_1_15/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  np_resource = np.dtype([(\"resource\", np.ubyte, 1)])\r\n2020-01-22 14:00:03.226815: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2020-01-22 14:00:03.250753: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2194920000 Hz\r\n2020-01-22 14:00:03.251151: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4a4df80 executing computations on platform Host. Devices:\r\n2020-01-22 14:00:03.251185: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>\r\nWARNING:tensorflow:From /home/alex/Documents/VirtualEnvironments/tensorflow_1_15/lib/python3.6/site-packages/tensorflow/lite/python/convert_saved_model.py:60: load (from tensorflow.python.saved_model.loader_impl) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nThis function will only be available through the v1 compatibility library as tf.compat.v1.saved_model.loader.load or tf.compat.v1.saved_model.load. There will be a new function for importing SavedModels in Tensorflow 2.0.\r\nWARNING:tensorflow:From /home/alex/Documents/VirtualEnvironments/tensorflow_1_15/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse standard file APIs to check for files with this prefix.\r\n2020-01-22 14:00:06.393038: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1412] (One-time warning): Not using XLA:CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that envvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cache=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.\r\n2020-01-22 14:00:10.226966: I tensorflow/core/grappler/devices.cc:60] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0 (Note: TensorFlow was not compiled with CUDA support)\r\n2020-01-22 14:00:10.227122: I tensorflow/core/grappler/clusters/single_machine.cc:359] Starting new session                                                                                                                                 \r\n2020-01-22 14:00:10.347863: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:716] Optimization results for grappler item: graph_to_optimize                                                                                          \r\n2020-01-22 14:00:10.347910: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:718]   function_optimizer: function_optimizer did nothing. time = 0.002ms.                                                                              \r\n2020-01-22 14:00:10.347930: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:718]   function_optimizer: function_optimizer did nothing. time = 0.001ms.                                                                              \r\nWARNING:tensorflow:From /home/alex/Documents/VirtualEnvironments/tensorflow_1_15/lib/python3.6/site-packages/tensorflow/lite/python/util.py:238: convert_variables_to_constants (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.                                                                                                                                                                                               \r\nInstructions for updating:                                                                                                                                                                                                                  \r\nUse `tf.compat.v1.graph_util.convert_variables_to_constants`                                                                                                                                                                                \r\nWARNING:tensorflow:From /home/alex/Documents/VirtualEnvironments/tensorflow_1_15/lib/python3.6/site-packages/tensorflow/python/framework/graph_util_impl.py:270: extract_sub_graph (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.                                                                                                                                                                                            \r\nInstructions for updating:                                                                                                                                                                                                                  \r\nUse `tf.compat.v1.graph_util.extract_sub_graph`                                                                                                                                                                                             \r\n2020-01-22 14:00:11.150707: I tensorflow/core/grappler/devices.cc:60] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0 (Note: TensorFlow was not compiled with CUDA support)                                         \r\n2020-01-22 14:00:11.151014: I tensorflow/core/grappler/clusters/single_machine.cc:359] Starting new session                                                                                                                                 \r\n2020-01-22 14:00:12.806255: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:716] Optimization results for grappler item: graph_to_optimize                                                                                          \r\n2020-01-22 14:00:12.806306: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:718]   constant folding: Graph size after: 554 nodes (-265), 570 edges (-265), time = 1091.39502ms.                                                     \r\n2020-01-22 14:00:12.806326: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:718]   constant folding: Graph size after: 554 nodes (0), 570 edges (0), time = 372.614ms.      \r\n```\r\nThe created model is then used within tfLiteInference.py:\r\n```\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\nprint(tf.__version__)\r\n\r\n# Load TFLite model and allocate tensors.\r\ninterpreter = tf.lite.Interpreter(model_path=\"converted_model_1_640_480_test.tflite\")\r\ninterpreter.allocate_tensors()\r\n\r\n# Get input and output tensors.\r\ninput_details = interpreter.get_input_details()\r\noutput_details = interpreter.get_output_details()\r\nprint(input_details)\r\nprint(output_details)\r\n\r\n# Test model on random input data.\r\ninput_shape = input_details[0]['shape']\r\ninput_data = np.array(np.random.random_sample(input_shape), dtype=np.float32)\r\nprint(input_data.shape)\r\ninterpreter.set_tensor(input_details[0]['index'], input_data)\r\n\r\ninterpreter.invoke()\r\n\r\noutput_data = interpreter.get_tensor(output_details[0]['index'])\r\nprint(output_data)\r\n```\r\n\r\nOutput of gdb debugging `gdb -ex r --args python3 tfLiteinference.py ` --> Aborted --> `py-list:`\r\n```\r\nThread 1 \"python3\" received signal SIGABRT, Aborted.\r\n__GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\r\n51      ../sysdeps/unix/sysv/linux/raise.c: No such file or directory.\r\n(gdb) py-list\r\n 104    \r\n 105        def AllocateTensors(self):\r\n 106            return _tensorflow_wrap_interpreter_wrapper.InterpreterWrapper_AllocateTensors(self)\r\n 107    \r\n 108        def Invoke(self):\r\n>109            return _tensorflow_wrap_interpreter_wrapper.InterpreterWrapper_Invoke(self)\r\n 110    \r\n 111        def InputIndices(self):\r\n 112            return _tensorflow_wrap_interpreter_wrapper.InterpreterWrapper_InputIndices(self)\r\n 113    \r\n 114        def OutputIndices(self):\r\n```\r\n\r\nI hope anyone can help me with this.\r\n\r\nCheers,\r\nAlex"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35985", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35985/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35985/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35985/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/35985", "id": 551392452, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY0MTIyNTM3", "number": 35985, "title": "[TFLite int16] 16-bit version of ADD/SUB reference kernel operators", "user": {"login": "wwwind", "id": 1513336, "node_id": "MDQ6VXNlcjE1MTMzMzY=", "avatar_url": "https://avatars0.githubusercontent.com/u/1513336?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wwwind", "html_url": "https://github.com/wwwind", "followers_url": "https://api.github.com/users/wwwind/followers", "following_url": "https://api.github.com/users/wwwind/following{/other_user}", "gists_url": "https://api.github.com/users/wwwind/gists{/gist_id}", "starred_url": "https://api.github.com/users/wwwind/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wwwind/subscriptions", "organizations_url": "https://api.github.com/users/wwwind/orgs", "repos_url": "https://api.github.com/users/wwwind/repos", "events_url": "https://api.github.com/users/wwwind/events{/privacy}", "received_events_url": "https://api.github.com/users/wwwind/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1169365494, "node_id": "MDU6TGFiZWwxMTY5MzY1NDk0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:M", "name": "size:M", "color": "adafea", "default": false, "description": "CL Change Size: Medium"}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-01-17T12:39:05Z", "updated_at": "2020-03-19T17:44:56Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/35985", "html_url": "https://github.com/tensorflow/tensorflow/pull/35985", "diff_url": "https://github.com/tensorflow/tensorflow/pull/35985.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/35985.patch"}, "body": "This PR is one of steps to extend 8-bit quantization to support symmetric 16-bit activations.\r\n\r\nEach activation is of type int16 and symmetric around zero. The weight tensor precision remains at 8-bit signed values. The bias is set to int64 precision.\r\n\r\nIn this PR we introduce implementation and tests for ADD/SUB kernel reference function.\r\nThe specification of this operator:\r\n\r\nSUB \r\n\u202f Input 0: \r\n\u202f \u202f data_type \u202f: int16 \r\n\u202f \u202f range \u202f \u202f \u202f: [-32768, 32767] \r\n\u202f \u202f granularity: per-tensor, zero_point=0 \r\n\u202f Input 1: \r\n\u202f \u202f data_type \u202f: int16 \r\n\u202f \u202f range \u202f \u202f \u202f: [-32768, 32767] \r\n\u202f \u202f granularity: per-tensor, zero_point=0 \r\n\u202f Output 0: \r\n\u202f \u202f data_type \u202f: int16 \r\n\u202f \u202f range \u202f \u202f \u202f: [-32768, 32767] \r\n\u202f \u202f granularity: per-tensor, zero_point=0 \r\n\r\nADD \r\n\u202f Input 0: \r\n\u202f \u202f data_type \u202f: int16 \r\n\u202f \u202f range \u202f \u202f \u202f: [-32768, 32767] \r\n\u202f \u202f granularity: per-tensor, zero_point=0 \r\n\u202f Input 1: \r\n\u202f \u202f data_type \u202f: int16 \r\n\u202f \u202f range \u202f \u202f \u202f: [-32768, 32767] \r\n\u202f \u202f granularity: per-tensor, zero_point=0 \r\n\u202f Output 0: \r\n\u202f \u202f data_type \u202f: int16 \r\n\u202f \u202f range \u202f \u202f \u202f: [-32768, 32767] \r\n\u202f \u202f granularity: per-tensor, zero_point=0"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35984", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35984/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35984/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35984/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/35984", "id": 551391288, "node_id": "MDExOlB1bGxSZXF1ZXN0MzY0MTIxNTYw", "number": 35984, "title": "Add Usage Example to Keras Nadam Optimizer", "user": {"login": "jedlimlx", "id": 42632089, "node_id": "MDQ6VXNlcjQyNjMyMDg5", "avatar_url": "https://avatars1.githubusercontent.com/u/42632089?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jedlimlx", "html_url": "https://github.com/jedlimlx", "followers_url": "https://api.github.com/users/jedlimlx/followers", "following_url": "https://api.github.com/users/jedlimlx/following{/other_user}", "gists_url": "https://api.github.com/users/jedlimlx/gists{/gist_id}", "starred_url": "https://api.github.com/users/jedlimlx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jedlimlx/subscriptions", "organizations_url": "https://api.github.com/users/jedlimlx/orgs", "repos_url": "https://api.github.com/users/jedlimlx/repos", "events_url": "https://api.github.com/users/jedlimlx/events{/privacy}", "received_events_url": "https://api.github.com/users/jedlimlx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-01-17T12:36:10Z", "updated_at": "2020-02-13T11:12:21Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/35984", "html_url": "https://github.com/tensorflow/tensorflow/pull/35984", "diff_url": "https://github.com/tensorflow/tensorflow/pull/35984.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/35984.patch"}, "body": ""}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35983", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35983/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35983/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35983/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35983", "id": 551385356, "node_id": "MDU6SXNzdWU1NTEzODUzNTY=", "number": 35983, "title": "AOT tests fail on Windows (MSVC 2019)", "user": {"login": "patrikohlsson", "id": 5068038, "node_id": "MDQ6VXNlcjUwNjgwMzg=", "avatar_url": "https://avatars1.githubusercontent.com/u/5068038?v=4", "gravatar_id": "", "url": "https://api.github.com/users/patrikohlsson", "html_url": "https://github.com/patrikohlsson", "followers_url": "https://api.github.com/users/patrikohlsson/followers", "following_url": "https://api.github.com/users/patrikohlsson/following{/other_user}", "gists_url": "https://api.github.com/users/patrikohlsson/gists{/gist_id}", "starred_url": "https://api.github.com/users/patrikohlsson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/patrikohlsson/subscriptions", "organizations_url": "https://api.github.com/users/patrikohlsson/orgs", "repos_url": "https://api.github.com/users/patrikohlsson/repos", "events_url": "https://api.github.com/users/patrikohlsson/events{/privacy}", "received_events_url": "https://api.github.com/users/patrikohlsson/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1188421838, "node_id": "MDU6TGFiZWwxMTg4NDIxODM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:windows", "name": "subtype:windows", "color": "b619ea", "default": false, "description": "Windows Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-01-17T12:22:06Z", "updated_at": "2020-01-27T11:40:11Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\nWindows 10 Pro x64\r\n- TensorFlow installed from (source or binary):\r\nSource\r\n- TensorFlow version:\r\nmaster (7be9f53)\r\n- Python version:\r\nPython 3.7.4 (Miniconda3)\r\n- Bazel version (if compiling from source):\r\nBuild label: 1.2.1\r\nBuild time: Tue Nov 26 15:24:17 2019 (1574781857)\r\nBuild timestamp: 1574781857\r\nBuild timestamp as int: 1574781857\r\n- GCC/Compiler version (if compiling from source):\r\nMSVC 2019\r\n- CUDA/cuDNN version:\r\n10.1/7\r\n- GPU model and memory:\r\nGTX 1080 Ti 11 GB\r\n\r\n**Describe the current behavior**\r\nCompiling a graph using AOT fails with linker error LNK1107:\r\n```\r\nINFO: Analyzed target //tensorflow/compiler/aot:test_graph_tfadd (172 packages loaded, 15111 targets configured).\r\nINFO: Found 1 target...\r\nINFO: Deleting stale sandbox base E:/tmp/_bazel_patrik/asdmfctl/sandbox\r\n[10 / 1,550] [Prepa] BazelWorkspaceStatusAction stable-status.txt\r\n[727 / 4,195] checking cached actions\r\n[7,806 / 7,807] [Prepa] Linking tensorflow/compiler/aot/test_graph_tfadd.lib\r\nERROR: E:/doremir/onset-detector/graph/tensorflow/tensorflow/compiler/aot/BUILD:121:1: Linking of rule '//tensorflow/compiler/aot:test_graph_tfadd' failed (Exit 1107)\r\nbazel-out\\x64_windows-opt\\bin\\tensorflow\\compiler\\aot\\test_graph_tfadd_tfcompile_function.o : fatal error LNK1107: invalid or corrupt file: cannot read at 0x340\r\nTarget //tensorflow/compiler/aot:test_graph_tfadd failed to build\r\nINFO: Elapsed time: 13.822s, Critical Path: 1.89s\r\nINFO: 0 processes.\r\nFAILED: Build did NOT complete successfully\r\nFAILED: Build did NOT complete successfully\r\n```\r\n**Describe the expected behavior**\r\nSuccessful build with a functioning executable at \r\n`bazel-bin/tensorflow/compiler/aot/test_graph_tfadd`.\r\n**Code to reproduce the issue**\r\nUsing MSYS2 (GNU bash, version 4.4.23(1)-release (x86_64-pc-msys))\r\n```bash\r\ngit clone --depth=1 https://github.com/tensorflow/tensorflow\r\ncd tensorflow\r\npython configure.py # xla - yes, rest default.\r\nbazel build //tensorflow/compiler/aot:test_graph_tfadd\r\n```\r\n**Other info / logs**\r\nEnvironment setup:\r\n```bash\r\n# Use a temporary directory with a short name.\r\nexport TMPDIR=\"E:/tmp\"\r\nexport TMP=\"E:/tmp\"\r\nexport TEMP=\"E:/tmp\"\r\nexport TEMPDIR=\"E:/tmp\"\r\nexport TEST_TMPDIR=\"E:/tmp\"\r\n\r\n# Add timestamps before each command.\r\nexport PS4='+ $(date) + '\r\n\r\n# Set bash path\r\nexport BAZEL_SH=\"E:/msys64/usr/bin/bash\"\r\nexport BAZEL_VC=\"E:/Program Files (x86)/Microsoft Visual Studio/2019/Community/VC\"\r\nexport BAZEL_VS=\"\"\r\n\r\nexport PYTHON_BASE_PATH=\"E:/Miniconda3/envs/tf2.0\"\r\n\r\n# Set the path to find bazel.\r\nexport PATH=\"/c/bazel-root/:$PATH\"\r\n\r\n# Set Python path for ./configure\r\nexport PYTHON_BIN_PATH=\"${PYTHON_BASE_PATH}/python.exe\"\r\nexport PYTHON_LIB_PATH=\"${PYTHON_BASE_PATH}/lib/site-packages\"\r\n\r\n# Add python into PATH, it's needed because gen_git_source.py uses\r\n# '/usr/bin/env python' as a shebang\r\nexport PATH=\"${PYTHON_BASE_PATH}:$PATH\"\r\n\r\n# Make sure we have pip in PATH\r\nexport PATH=\"${PYTHON_BASE_PATH}/Scripts:$PATH\"\r\n\r\n# Setting default values to CUDA related environment variables\r\nexport TF_CUDA_VERSION=${TF_CUDA_VERSION:-10.1}\r\nexport TF_CUDNN_VERSION=${TF_CUDNN_VERSION:-7}\r\nexport TF_CUDA_COMPUTE_CAPABILITIES=${TF_CUDA_COMPUTE_CAPABILITIES:-6.0}\r\nexport CUDA_TOOLKIT_PATH=\"C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v${TF_CUDA_VERSION}\"\r\nexport CUDNN_INSTALL_PATH=\"E:/cuda\"\r\n\r\n# Add Cuda and Cudnn dll directories into PATH\r\nexport PATH=\"${CUDA_TOOLKIT_PATH}/bin:$PATH\"\r\nexport PATH=\"${CUDA_TOOLKIT_PATH}/extras/CUPTI/libx64:$PATH\"\r\nexport PATH=\"${CUDNN_INSTALL_PATH}/bin:$PATH\"\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35982", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35982/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35982/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35982/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35982", "id": 551384367, "node_id": "MDU6SXNzdWU1NTEzODQzNjc=", "number": 35982, "title": "model.fit requests and leaks extra data from validation_data generator than the specified validation_steps", "user": {"login": "mostafa-mahmoud", "id": 895345, "node_id": "MDQ6VXNlcjg5NTM0NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/895345?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mostafa-mahmoud", "html_url": "https://github.com/mostafa-mahmoud", "followers_url": "https://api.github.com/users/mostafa-mahmoud/followers", "following_url": "https://api.github.com/users/mostafa-mahmoud/following{/other_user}", "gists_url": "https://api.github.com/users/mostafa-mahmoud/gists{/gist_id}", "starred_url": "https://api.github.com/users/mostafa-mahmoud/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mostafa-mahmoud/subscriptions", "organizations_url": "https://api.github.com/users/mostafa-mahmoud/orgs", "repos_url": "https://api.github.com/users/mostafa-mahmoud/repos", "events_url": "https://api.github.com/users/mostafa-mahmoud/events{/privacy}", "received_events_url": "https://api.github.com/users/mostafa-mahmoud/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-01-17T12:19:54Z", "updated_at": "2020-03-12T02:39:33Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\nI tried this in two environments:\r\n\r\nThe first enviornment is: \r\n```\r\nmacOS Catalina 10.15.2\r\npython 3.6.5\r\ntensorflow 2.1 (v2.1.0-rc2-17-ge5bf8de410 2.1.0)\r\nkeras 2.3.1\r\n```\r\nThe second environment is:\r\n```\r\nLinux Ubuntu 16.04\r\npython 3.5.2\r\ntensorflow-gpu 2.1  (v2.1.0-rc2-17-ge5bf8de 2.1.0)\r\nkeras 2.3.1\r\n```\r\n\r\n\r\n**Describe the current behavior**\r\nUpon using the validation generator while fitting the model, the validation generator is somehow requested to generate more data batches per epoch than the actually needed for validation (specified by `validation_steps`). I'm unable to identify where this extra data is used, however, this extra data grows indefinitely with more training (as shown when I increase the number of epochs from 2 to 5). This irregular behavior ruins the validation because it's not exactly the same data that is being passed every epoch.\r\n\r\nThis behavior only happens when I used `tensorflow.keras`, however, it works properly when using just `keras`.\r\n\r\n**Describe the expected behavior**\r\nFor every epoch, the validation generator generates a fixed number of data batches, and if there's extra data, it shouldn't grow indefinitely with more training epochs. This expected behavior happens below in the first two examples when I used `keras` instead of `tensorflow.keras`.\r\n\r\n**Code to reproduce the issue**\r\n\r\n```\r\n#!/usr/bin/env python3                                                                                                     \r\nimport os                                                                                                                  \r\nimport sys                                                                                                                 \r\nos.environ['TF_CPP_MIN_LOG_LEVEL'] = '3'                                                                                   \r\n                                                                                                                           \r\nimport numpy as np                                                                                                         \r\n# Environment setup, using keras vs. tensorflow.keras                                                                      \r\n                                                                                                                           \r\nimport tensorflow as tf                                                                                                    \r\nif sys.argv[1] == 'tensorflow':                                                                                            \r\n    import tensorflow.keras as K                                                                                           \r\n    from tensorflow.keras.models import Model                                                                              \r\n    from tensorflow.keras.layers import Dense, Input, Dropout                                                              \r\nelif sys.argv[1] == 'keras':                                                                                               \r\n    import keras as K                                                                                                      \r\n    from keras.models import Model                                                                                         \r\n    from keras.layers import Dense, Input, Dropout                                                                         \r\nelse:                                                                                                                      \r\n    sys.exit()                                                                                                             \r\n                                                                                                                           \r\nepochs = int(sys.argv[2])                                                                                                  \r\n                                                                                                                           \r\n                                                                                                                           \r\n# Trackers of the generated data                                                                                           \r\ntrain_cntX = 0  # updated for each extracted training batch                                                                \r\ntrain_cntY = 0  # updated for each extracted training batch                                                                \r\nhacked = []  # updated for each extracted validation batch                                                                 \r\n                                                                                                                           \r\n# Reporting the size of hacked before/after each epoch                                                                     \r\nclass TrackingCB(K.callbacks.Callback):                                                                                    \r\n    def __init__(self, steps, *args, **kwargs):                                                                            \r\n        super().__init__(*args, **kwargs)                                                                                  \r\n        self.steps = steps                                                                                                 \r\n                                                                                                                           \r\n    def on_epoch_begin(self, epoch, logs={}):                                                                              \r\n        self.start_length = len(hacked)                                                                                    \r\n                                                                                                                           \r\n    def on_epoch_end(self, epoch, logs={}):                                                                                \r\n        for _ in range(self.steps):                                                                                        \r\n            hacked.pop(0)                                                                                                  \r\n        print('start: %d, end: %d' % (self.start_length, len(hacked)))                                                     \r\n        del self.start_length                                                                                              \r\n                                                                                                                           \r\n# Data generators                                                                                                          \r\ndef genX(stddev=0.01, update=True):                                                                                        \r\n    while True:                                                                                                            \r\n        for i in range(20):                                                                                                \r\n            if update:                                                                                                     \r\n                global train_cntX                                                                                          \r\n                train_cntX += 1                                                                                            \r\n            yield {'input': np.random.normal(i + 1, stddev, (32, 10))}                                                     \r\n    return                                                                                                                 \r\n                                                                                                                           \r\ndef geny(update=True):                                                                                                     \r\n    while True:                                                                                                            \r\n        for i in range(20):                                                                                                \r\n            if update:                                                                                                     \r\n                global train_cntY                                                                                          \r\n                train_cntY += 1                                                                                            \r\n            yield {'output': np.ones((32, 1)) * ((i + 10) % 20)}                                                           \r\n    return                                                                                                                 \r\n                                                                                                                           \r\ndef genTrain():                                                                                                            \r\n    for x, y in zip(genX(), geny()):                                                                                       \r\n        yield x, y                                                                                                         \r\n    return                                                                                                                 \r\n                                                                                                                           \r\ndef genValid():                                                                                                            \r\n    for x, y in zip(genX(1e-4, update=False), geny(update=False)):                                                         \r\n        data = x, y                                                                                                        \r\n        hacked.append(data)                                                                                                \r\n        yield data                                                                                                         \r\n    return                                                                                                                 \r\n                                                                                                                           \r\n                                                                                                                           \r\n# Model & training                                                                                                         \r\ninp = Input((10,), name='input')                                                                                           \r\nout = Dense(20, activation='relu')(inp)                                                                                    \r\nout = Dense(20, activation='relu')(out)                                                                                    \r\nout = Dropout(0.5)(out)                                                                                                    \r\nout = Dense(1, name='output')(out)                                                                                         \r\nmodel = Model(inp, out)                                                                                                    \r\nmodel.compile(loss=K.losses.mean_squared_error,                                                                            \r\n              optimizer=K.optimizers.Adadelta(0.1, decay=0.01))                                                            \r\n                                                                                                                           \r\nmodel.fit(genTrain(),                                                                                                      \r\n          epochs=epochs, steps_per_epoch=20,                                                                               \r\n          validation_data=genValid(), validation_steps=20,                                                                 \r\n          callbacks=[TrackingCB(20)], verbose=0)                                                                           \r\n                                                                                                                           \r\n                                                                                                                           \r\nprint('tensorflow:', tf.__version__)                                                                                       \r\nprint('keras:', K.__version__)                                                                                             \r\nprint('train generator counts:', train_cntX, train_cntY)                                                                   \r\nprint('validation remaining data length:', len(hacked))                                                                    \r\n\r\n```\r\n**Other info / logs**\r\n\r\nIn keras, the amount of extra data extracted is fixed after each epoch, and it doesn't grow with more epochs, which shows that the generator is used for exactly 20 validation steps as specified.\r\n```\r\n$ python3 keras_gen_debug.py keras 2\r\nUsing TensorFlow backend.\r\nstart: 0, end: 11\r\nstart: 11, end: 11\r\ntensorflow: 2.1.0\r\nkeras: 2.3.1\r\ntrain generator counts: 51 51\r\nvalidation remaining data length: 11\r\n```\r\n\r\n```\r\n$ python3 keras_gen_debug.py keras 5\r\nUsing TensorFlow backend.\r\nstart: 0, end: 11\r\nstart: 11, end: 11\r\nstart: 11, end: 11\r\nstart: 11, end: 11\r\nstart: 11, end: 11\r\ntensorflow: 2.1.0\r\nkeras: 2.3.1\r\ntrain generator counts: 111 111\r\nvalidation remaining data length: 11\r\n```\r\n\r\nIn tensorflow.keras, the amount of extra data extracted is growing after each epoch, which shows that after the 20 validation steps, there are extra 13 batches that were generated after each epoch. (this can be noticed in detail when `verbose=1`)\r\n\r\n```\r\n$ python3 keras_gen_debug.py tensorflow 2\r\nWARNING:tensorflow:sample_weight modes were coerced from\r\n  {'output': '...'}\r\n    to  \r\n  ['...']\r\nWARNING:tensorflow:sample_weight modes were coerced from\r\n  {'output': '...'}\r\n    to  \r\n  ['...']\r\nstart: 1, end: 13\r\nstart: 13, end: 26\r\ntensorflow: 2.1.0\r\nkeras: 2.2.4-tf\r\ntrain generator counts: 53 53\r\nvalidation remaining data length: 26\r\n```\r\n\r\n```\r\n$ python3 keras_gen_debug.py tensorflow 5\r\nWARNING:tensorflow:sample_weight modes were coerced from\r\n  {'output': '...'}\r\n    to  \r\n  ['...']\r\nWARNING:tensorflow:sample_weight modes were coerced from\r\n  {'output': '...'}\r\n    to  \r\n  ['...']\r\nstart: 1, end: 13\r\nstart: 13, end: 26\r\nstart: 26, end: 39\r\nstart: 39, end: 52\r\nstart: 52, end: 65\r\ntensorflow: 2.1.0\r\nkeras: 2.2.4-tf\r\ntrain generator counts: 113 113\r\nvalidation remaining data length: 65\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35981", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35981/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35981/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35981/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35981", "id": 551374155, "node_id": "MDU6SXNzdWU1NTEzNzQxNTU=", "number": 35981, "title": "Error while generating TensorflowLite file", "user": {"login": "vipulraut", "id": 3470816, "node_id": "MDQ6VXNlcjM0NzA4MTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/3470816?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vipulraut", "html_url": "https://github.com/vipulraut", "followers_url": "https://api.github.com/users/vipulraut/followers", "following_url": "https://api.github.com/users/vipulraut/following{/other_user}", "gists_url": "https://api.github.com/users/vipulraut/gists{/gist_id}", "starred_url": "https://api.github.com/users/vipulraut/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vipulraut/subscriptions", "organizations_url": "https://api.github.com/users/vipulraut/orgs", "repos_url": "https://api.github.com/users/vipulraut/repos", "events_url": "https://api.github.com/users/vipulraut/events{/privacy}", "received_events_url": "https://api.github.com/users/vipulraut/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "srjoglekar246", "id": 2099293, "node_id": "MDQ6VXNlcjIwOTkyOTM=", "avatar_url": "https://avatars3.githubusercontent.com/u/2099293?v=4", "gravatar_id": "", "url": "https://api.github.com/users/srjoglekar246", "html_url": "https://github.com/srjoglekar246", "followers_url": "https://api.github.com/users/srjoglekar246/followers", "following_url": "https://api.github.com/users/srjoglekar246/following{/other_user}", "gists_url": "https://api.github.com/users/srjoglekar246/gists{/gist_id}", "starred_url": "https://api.github.com/users/srjoglekar246/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/srjoglekar246/subscriptions", "organizations_url": "https://api.github.com/users/srjoglekar246/orgs", "repos_url": "https://api.github.com/users/srjoglekar246/repos", "events_url": "https://api.github.com/users/srjoglekar246/events{/privacy}", "received_events_url": "https://api.github.com/users/srjoglekar246/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "srjoglekar246", "id": 2099293, "node_id": "MDQ6VXNlcjIwOTkyOTM=", "avatar_url": "https://avatars3.githubusercontent.com/u/2099293?v=4", "gravatar_id": "", "url": "https://api.github.com/users/srjoglekar246", "html_url": "https://github.com/srjoglekar246", "followers_url": "https://api.github.com/users/srjoglekar246/followers", "following_url": "https://api.github.com/users/srjoglekar246/following{/other_user}", "gists_url": "https://api.github.com/users/srjoglekar246/gists{/gist_id}", "starred_url": "https://api.github.com/users/srjoglekar246/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/srjoglekar246/subscriptions", "organizations_url": "https://api.github.com/users/srjoglekar246/orgs", "repos_url": "https://api.github.com/users/srjoglekar246/repos", "events_url": "https://api.github.com/users/srjoglekar246/events{/privacy}", "received_events_url": "https://api.github.com/users/srjoglekar246/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-01-17T11:55:54Z", "updated_at": "2020-02-06T04:57:38Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\n- TensorFlow installed from (source or binary):\r\n- TensorFlow version (or github SHA if from source):\r\n\r\n\r\n**Provide the text output from tflite_convert**\r\n\r\n```\r\nException ignored in: <bound method _CheckpointRestoreCoordinator.__del__ of <tensorflow.python.training.tracking.util._CheckpointRestoreCoordinator object at 0x7f0f9ab16f98>>\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/training/tracking/util.py\", line 244, in __del__\r\n    .format(pretty_printer.node_names[node_id]))\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/training/tracking/util.py\", line 93, in node_names\r\n    path_to_root[node_id] + (child.local_name,))\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/training/tracking/object_identity.py\", line 76, in __getitem__\r\n    return self._storage[self._wrap_key(key)]\r\nKeyError: (<tensorflow.python.training.tracking.object_identity._ObjectIdentityWrapper object at 0x7f0f91483ac8>,)\r\n---------------------------------------------------------------------------\r\nConverterError                            Traceback (most recent call last)\r\n<ipython-input-64-e4d06fcc1815> in <module>()\r\n     13 # Convert the model to standard TensorFlow Lite model\r\n     14 converter = tf.lite.TFLiteConverter.from_concrete_functions([concrete_func])\r\n---> 15 converted_tflite_model = converter.convert()\r\n     16 open(TFLITE_MODEL, \"wb\").write(converted_tflite_model)\r\n\r\n2 frames\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/lite/python/convert.py in toco_convert_protos(model_flags_str, toco_flags_str, input_data_str)\r\n    170       stderr = _try_convert_to_unicode(stderr)\r\n    171       raise ConverterError(\r\n--> 172           \"TOCO failed. See console for info.\\n%s\\n%s\\n\" % (stdout, stderr))\r\n    173   finally:\r\n    174     # Must manually cleanup files.\r\n\r\nConverterError: TOCO failed. See console for info.\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint8 = np.dtype([(\"qint8\", np.int8, 1)])\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint8 = np.dtype([(\"quint8\", np.uint8, 1)])\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint16 = np.dtype([(\"qint16\", np.int16, 1)])\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint16 = np.dtype([(\"quint16\", np.uint16, 1)])\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint32 = np.dtype([(\"qint32\", np.int32, 1)])\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  np_resource = np.dtype([(\"resource\", np.ubyte, 1)])\r\n/usr/local/lib/python3.6/dist-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint8 = np.dtype([(\"qint8\", np.int8, 1)])\r\n/usr/local/lib/python3.6/dist-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint8 = np.dtype([(\"quint8\", np.uint8, 1)])\r\n/usr/local/lib/python3.6/dist-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint16 = np.dtype([(\"qint16\", np.int16, 1)])\r\n/usr/local/lib/python3.6/dist-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_quint16 = np.dtype([(\"quint16\", np.uint16, 1)])\r\n/usr/local/lib/python3.6/dist-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  _np_qint32 = np.dtype([(\"qint32\", np.int32, 1)])\r\n/usr/local/lib/python3.6/dist-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\r\n  np_resource = np.dtype([(\"resource\", np.ubyte, 1)])\r\n2020-01-17 11:53:28.108739: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: IdentityN\r\n2020-01-17 11:53:28.144111: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 707 operators, 1294 arrays (0 quantized)\r\n2020-01-17 11:53:28.168667: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 707 operators, 1294 arrays (0 quantized)\r\n2020-01-17 11:53:28.306950: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 1: 128 operators, 326 arrays (0 quantized)\r\n2020-01-17 11:53:28.316129: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 2: 125 operators, 321 arrays (0 quantized)\r\n2020-01-17 11:53:28.319357: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 3: 124 operators, 319 arrays (0 quantized)\r\n2020-01-17 11:53:28.322587: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before Group bidirectional sequence lstm/rnn: 124 operators, 319 arrays (0 quantized)\r\n2020-01-17 11:53:28.325002: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before dequantization graph transformations: 124 operators, 319 arrays (0 quantized)\r\n2020-01-17 11:53:28.333533: I tensorflow/lite/toco/allocate_transient_arrays.cc:345] Total transient array allocated size: 11139584 bytes, theoretical optimal value: 8297856 bytes.\r\n2020-01-17 11:53:28.334861: E tensorflow/lite/toco/toco_tooling.cc:462] We are continually in the process of adding support to TensorFlow Lite for more ops. It would be helpful if you could inform us of how this conversion went by opening a github issue at https://github.com/tensorflow/tensorflow/issues/new?template=40-tflite-op-request.md\r\n and pasting the following:\r\n\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime. If those are native TensorFlow operators, you might be able to use the extended runtime by passing --enable_select_tf_ops, or by setting target_ops=TFLITE_BUILTINS,SELECT_TF_OPS when calling tf.lite.TFLiteConverter(). Otherwise, if you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: AVERAGE_POOL_2D, CONCATENATION, CONV_2D, FULLY_CONNECTED, MAX_POOL_2D, MEAN, RESHAPE, SOFTMAX. Here is a list of operators for which you will need custom implementations: IdentityN.\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/toco_from_protos\", line 8, in <module>\r\n    sys.exit(main())\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/lite/toco/python/toco_from_protos.py\", line 59, in main\r\n    app.run(main=execute, argv=[sys.argv[0]] + unparsed)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/usr/local/lib/python3.6/dist-packages/absl/app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"/usr/local/lib/python3.6/dist-packages/absl/app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/lite/toco/python/toco_from_protos.py\", line 33, in execute\r\n    output_str = tensorflow_wrap_toco.TocoConvert(model_str, toco_str, input_str)\r\nException: We are continually in the process of adding support to TensorFlow Lite for more ops. It would be helpful if you could inform us of how this conversion went by opening a github issue at https://github.com/tensorflow/tensorflow/issues/new?template=40-tflite-op-request.md\r\n and pasting the following:\r\n\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime. If those are native TensorFlow operators, you might be able to use the extended runtime by passing --enable_select_tf_ops, or by setting target_ops=TFLITE_BUILTINS,SELECT_TF_OPS when calling tf.lite.TFLiteConverter(). Otherwise, if you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: AVERAGE_POOL_2D, CONCATENATION, CONV_2D, FULLY_CONNECTED, MAX_POOL_2D, MEAN, RESHAPE, SOFTMAX. Here is a list of operators for which you will need custom implementations: IdentityN.\r\n\r\n\r\n```\r\n\r\nAlso, please include a link to a GraphDef or the model if possible.\r\n\r\n**Any other info / logs**\r\n\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35979", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35979/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35979/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35979/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35979", "id": 551326556, "node_id": "MDU6SXNzdWU1NTEzMjY1NTY=", "number": 35979, "title": "What's the difference between Keras applications and TF Model Garden?", "user": {"login": "haimat", "id": 6633976, "node_id": "MDQ6VXNlcjY2MzM5NzY=", "avatar_url": "https://avatars2.githubusercontent.com/u/6633976?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haimat", "html_url": "https://github.com/haimat", "followers_url": "https://api.github.com/users/haimat/followers", "following_url": "https://api.github.com/users/haimat/following{/other_user}", "gists_url": "https://api.github.com/users/haimat/gists{/gist_id}", "starred_url": "https://api.github.com/users/haimat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haimat/subscriptions", "organizations_url": "https://api.github.com/users/haimat/orgs", "repos_url": "https://api.github.com/users/haimat/repos", "events_url": "https://api.github.com/users/haimat/events{/privacy}", "received_events_url": "https://api.github.com/users/haimat/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1105108936, "node_id": "MDU6TGFiZWwxMTA1MTA4OTM2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:model", "name": "comp:model", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-01-17T10:17:39Z", "updated_at": "2020-01-22T21:09:32Z", "closed_at": null, "author_association": "NONE", "body": "## URL(s) with the issue:\r\n\r\nhttps://www.tensorflow.org/api_docs/python/tf/keras/applications\r\nhttps://github.com/tensorflow/models/tree/master/official\r\n\r\n## Description of issue (what needs changing):\r\n\r\nThere are the pre-trained models for Keras found in `tf.keras.applications`. And there are those models found on GitHub in the Model Garden (under `/models`, as linked above). Now, from reading the docs (both for the applications as well as those in the Model Garden) I don't get the difference. Why do we have those two different model repos?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35977", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35977/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35977/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35977/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35977", "id": 551290058, "node_id": "MDU6SXNzdWU1NTEyOTAwNTg=", "number": 35977, "title": "windows build failed with master branch", "user": {"login": "alanpurple", "id": 4515120, "node_id": "MDQ6VXNlcjQ1MTUxMjA=", "avatar_url": "https://avatars1.githubusercontent.com/u/4515120?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanpurple", "html_url": "https://github.com/alanpurple", "followers_url": "https://api.github.com/users/alanpurple/followers", "following_url": "https://api.github.com/users/alanpurple/following{/other_user}", "gists_url": "https://api.github.com/users/alanpurple/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanpurple/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanpurple/subscriptions", "organizations_url": "https://api.github.com/users/alanpurple/orgs", "repos_url": "https://api.github.com/users/alanpurple/repos", "events_url": "https://api.github.com/users/alanpurple/events{/privacy}", "received_events_url": "https://api.github.com/users/alanpurple/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1188421838, "node_id": "MDU6TGFiZWwxMTg4NDIxODM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:windows", "name": "subtype:windows", "color": "b619ea", "default": false, "description": "Windows Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2020-01-17T09:04:42Z", "updated_at": "2020-03-13T02:57:38Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10 x64\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version: master 2.1.0\r\n- Python version: 3.7.6\r\n- Installed using virtualenv? pip? conda?: N/A\r\n- Bazel version (if compiling from source): 1.2.1\r\n- GCC/Compiler version (if compiling from source):  Visual Studio 2019 C++ compiler\r\n- CUDA/cuDNN version: 10.2 / 7.6.5\r\n- GPU model and memory:\r\n\r\nRTX2080Ti GDDR6 11GB\r\n\r\n\r\n\r\n**Describe the problem**\r\nbazel build failed\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\nbazel build //tensorflwo/tools/pip_package:build_pip_package\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\n```\r\nERROR: D:/repo/tensorflow/tensorflow/BUILD:867:1: Executing genrule //tensorflow:tf_python_api_gen_v2 failed (Exit 1)\r\nC:\\Anaconda3\\lib\\site-packages\\numpy\\__init__.py:140: UserWarning: mkl-service package failed to import, therefore Intel(R) MKL initialization ensuring its correct out-of-the box operation under condition when Gnu OpenMP had already been loaded by Python process is not assured. Please install mkl-service package, see http://github.com/IntelPython/mkl-service\r\n  from . import _distributor_init\r\nTraceback (most recent call last):\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\numpy\\core\\__init__.py\", line 24, in <module>\r\n    from . import multiarray\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\numpy\\core\\multiarray.py\", line 14, in <module>\r\n    from . import overrides\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\numpy\\core\\overrides.py\", line 7, in <module>\r\n    from numpy.core._multiarray_umath import (\r\nImportError: DLL load failed: The specified module could not be found.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"\\\\?\\C:\\Users\\ALAN-W~1\\AppData\\Local\\Temp\\Bazel.runfiles_t25kvwuy\\runfiles\\org_tensorflow\\tensorflow\\python\\tools\\api\\generator\\create_python_api.py\", line 27, in <module>\r\n    from tensorflow.python.tools.api.generator import doc_srcs\r\n  File \"\\\\?\\C:\\Users\\ALAN-W~1\\AppData\\Local\\Temp\\Bazel.runfiles_t25kvwuy\\runfiles\\org_tensorflow\\tensorflow\\python\\__init__.py\", line 48, in <module>\r\n    import numpy as np\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\numpy\\__init__.py\", line 142, in <module>\r\n    from . import core\r\n  File \"C:\\Anaconda3\\lib\\site-packages\\numpy\\core\\__init__.py\", line 54, in <module>\r\n    raise ImportError(msg)\r\nImportError:\r\n\r\nIMPORTANT: PLEASE READ THIS FOR ADVICE ON HOW TO SOLVE THIS ISSUE!\r\n\r\nImporting the numpy c-extensions failed.\r\n- Try uninstalling and reinstalling numpy.\r\n- If you have already done that, then:\r\n  1. Check that you expected to use Python3.7 from \"C:\\Anaconda3\\python.exe\",\r\n     and that you have no directories in your PATH or PYTHONPATH that can\r\n     interfere with the Python and numpy version \"1.18.1\" you're trying to use.\r\n  2. If (1) looks fine, you can open a new issue at\r\n     https://github.com/numpy/numpy/issues.  Please include details on:\r\n     - how you installed Python\r\n     - how you installed numpy\r\n     - your operating system\r\n     - whether or not you have multiple versions of Python installed\r\n     - if you built from source, your compiler versions and ideally a build log\r\n\r\n- If you're working with a numpy git repository, try `git clean -xdf`\r\n  (removes all files not under version control) and rebuild numpy.\r\n\r\nNote: this error has many possible causes, so please don't comment on\r\nan existing issue about this - open a new one instead.\r\n\r\nOriginal error was: DLL load failed: The specified module could not be found.\r\n\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nERROR: D:/repo/tensorflow/tensorflow/tools/pip_package/BUILD:229:1 Executing genrule //tensorflow:tf_python_api_gen_v2 failed (Exit 1)\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35975", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35975/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35975/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35975/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35975", "id": 551274097, "node_id": "MDU6SXNzdWU1NTEyNzQwOTc=", "number": 35975, "title": "ResNet model in keras and tf.keras give different output for the same image", "user": {"login": "NagabhushanSN95", "id": 16269001, "node_id": "MDQ6VXNlcjE2MjY5MDAx", "avatar_url": "https://avatars0.githubusercontent.com/u/16269001?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NagabhushanSN95", "html_url": "https://github.com/NagabhushanSN95", "followers_url": "https://api.github.com/users/NagabhushanSN95/followers", "following_url": "https://api.github.com/users/NagabhushanSN95/following{/other_user}", "gists_url": "https://api.github.com/users/NagabhushanSN95/gists{/gist_id}", "starred_url": "https://api.github.com/users/NagabhushanSN95/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NagabhushanSN95/subscriptions", "organizations_url": "https://api.github.com/users/NagabhushanSN95/orgs", "repos_url": "https://api.github.com/users/NagabhushanSN95/repos", "events_url": "https://api.github.com/users/NagabhushanSN95/events{/privacy}", "received_events_url": "https://api.github.com/users/NagabhushanSN95/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-01-17T08:27:49Z", "updated_at": "2020-02-28T06:27:35Z", "closed_at": null, "author_association": "NONE", "body": "For a given image, I'm extracting ResNet features i.e. after all conv layers and global max pooling, which gives a 2048 length vector per image. \r\n\r\nEarlier, I was using `keras==2.3.1` with backend `tensorflow==1.13.1`. Now, I've shifted to `tensorflow==2.0.0` since keras has been merged with tensorflow. I replaced my code with `tf.keras` instead of `keras`.\r\n\r\nBut now the features extracted are not the same as the features extracted earlier. ResNet is a model which is independent of tensorflow/keras or even pytorch for that matter. It's functionality is predefined. Why is this difference occuring? Are there any parameters that can be tweaked to get the same functionality?\\\r\n\r\n```\r\n    from tensorflow.keras.applications.resnet50 import ResNet50, preprocess_input\r\n    resnet_model = ResNet50(include_top=False)\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35970", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35970/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35970/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35970/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35970", "id": 551205659, "node_id": "MDU6SXNzdWU1NTEyMDU2NTk=", "number": 35970, "title": "Allow relative min_delta for EarlyStopping", "user": {"login": "phemmer", "id": 1826947, "node_id": "MDQ6VXNlcjE4MjY5NDc=", "avatar_url": "https://avatars3.githubusercontent.com/u/1826947?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phemmer", "html_url": "https://github.com/phemmer", "followers_url": "https://api.github.com/users/phemmer/followers", "following_url": "https://api.github.com/users/phemmer/following{/other_user}", "gists_url": "https://api.github.com/users/phemmer/gists{/gist_id}", "starred_url": "https://api.github.com/users/phemmer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phemmer/subscriptions", "organizations_url": "https://api.github.com/users/phemmer/orgs", "repos_url": "https://api.github.com/users/phemmer/repos", "events_url": "https://api.github.com/users/phemmer/events{/privacy}", "received_events_url": "https://api.github.com/users/phemmer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-01-17T05:22:07Z", "updated_at": "2020-03-18T22:17:59Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using): 2.1.0\r\n- Are you willing to contribute it (Yes/No): maybe\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nCurrently the [EarlyStopping callback](https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/EarlyStopping) `min_delta` is an absolute value. Meaning that the metric being monitored must improve by that fixed amount. The proposal is to add the ability to use a relative threshold instead (e.g. a ratio or percentage).\r\n\r\nAn example use case is probably easier to understand. Lets say we're doing a hyperparameter search, so we're running a bunch of different models, and we want to stop early on the bad ones. On good models our loss value is in the single digits. So we set the parameters `baseline=50` (a little high so that we allow models to start off somewhat bad), and `min_delta=0.1`. Now with this, if a model gets under 50, but drops to just 48.9, that'll keep it from triggering the abort threshold. If this were instead a ratio, such that `min_delta=0.1` means `10%`, the loss would have to go from 50 to 45 to keep it from triggering, and a good model at say 1.2 would only have to drop to 1.08.\r\n\r\nNow we could try other approaches to address this problem, such as lowering `baseline`, and increasing `patience` (allowing bad starts a little longer to come down further), but by increasing patience, this increases the amount of time we have to wait for good models to stop as well.\r\n\r\n&nbsp;\r\n\r\nInstead of adding a flag for toggling whether `min_delta` is absolute or relative, I think it might be better to allow the user to provide their own \"is this new value good enough\" function/lambda. Currently you can technically override `EarlyStopping.monitor_op`, but it's clearly not designed to operate that way as the arguments to `monitor_op` aren't simple \"best\" and \"current\" values, and there's also code which directly checks whether `monitor_op == np.less`, which overriding breaks.\r\n\r\nSo ultimately the request is to either add a new argument to the initializer accepting the signature `(current:float, best:float) -> bool`, or adjust the code to allow overriding `monitor_op` with that signature.\r\n\r\n**Will this change the current api? How?**\r\nMaybe, if the direction is to add an additional parameter to the initializer.\r\n\r\n**Who will benefit with this feature?**\r\nThose doing hyperparameter searches, or potentially other cases.\r\n\r\n**Any Other info.**\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35966", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35966/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35966/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35966/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/35966", "id": 551184802, "node_id": "MDExOlB1bGxSZXF1ZXN0MzYzOTUyMTky", "number": 35966, "title": "[ROCm] Complex sparse ops", "user": {"login": "ekuznetsov139", "id": 12205429, "node_id": "MDQ6VXNlcjEyMjA1NDI5", "avatar_url": "https://avatars2.githubusercontent.com/u/12205429?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ekuznetsov139", "html_url": "https://github.com/ekuznetsov139", "followers_url": "https://api.github.com/users/ekuznetsov139/followers", "following_url": "https://api.github.com/users/ekuznetsov139/following{/other_user}", "gists_url": "https://api.github.com/users/ekuznetsov139/gists{/gist_id}", "starred_url": "https://api.github.com/users/ekuznetsov139/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ekuznetsov139/subscriptions", "organizations_url": "https://api.github.com/users/ekuznetsov139/orgs", "repos_url": "https://api.github.com/users/ekuznetsov139/repos", "events_url": "https://api.github.com/users/ekuznetsov139/events{/privacy}", "received_events_url": "https://api.github.com/users/ekuznetsov139/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 1169365494, "node_id": "MDU6TGFiZWwxMTY5MzY1NDk0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:M", "name": "size:M", "color": "adafea", "default": false, "description": "CL Change Size: Medium"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-01-17T03:58:31Z", "updated_at": "2020-03-13T11:57:38Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/35966", "html_url": "https://github.com/tensorflow/tensorflow/pull/35966", "diff_url": "https://github.com/tensorflow/tensorflow/pull/35966.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/35966.patch"}, "body": "This PR enables the following kernels for complex64 and complex128 on ROCm:\r\nCSRSparseMatrixToDense\r\nDenseToCSRSparseMatrix\r\nSparseMatrixMul\r\nCSRSparseMatrixComponents\r\nDenseToCSRSparseMatrix\r\nSparseTensorToCSRSparseMatrix\r\n\r\nIn addition, it fixes a problem in one of the sparse kernel implementations, and enables unit tests for all of the above."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35965", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35965/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35965/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35965/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/35965", "id": 551184062, "node_id": "MDExOlB1bGxSZXF1ZXN0MzYzOTUxNjE0", "number": 35965, "title": "[ROCm] Enabling the kernel Relu for float16", "user": {"login": "ekuznetsov139", "id": 12205429, "node_id": "MDQ6VXNlcjEyMjA1NDI5", "avatar_url": "https://avatars2.githubusercontent.com/u/12205429?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ekuznetsov139", "html_url": "https://github.com/ekuznetsov139", "followers_url": "https://api.github.com/users/ekuznetsov139/followers", "following_url": "https://api.github.com/users/ekuznetsov139/following{/other_user}", "gists_url": "https://api.github.com/users/ekuznetsov139/gists{/gist_id}", "starred_url": "https://api.github.com/users/ekuznetsov139/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ekuznetsov139/subscriptions", "organizations_url": "https://api.github.com/users/ekuznetsov139/orgs", "repos_url": "https://api.github.com/users/ekuznetsov139/repos", "events_url": "https://api.github.com/users/ekuznetsov139/events{/privacy}", "received_events_url": "https://api.github.com/users/ekuznetsov139/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-01-17T03:55:11Z", "updated_at": "2020-03-13T11:58:19Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/35965", "html_url": "https://github.com/tensorflow/tensorflow/pull/35965", "diff_url": "https://github.com/tensorflow/tensorflow/pull/35965.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/35965.patch"}, "body": "This PR enables the kernel Relu for float16 on ROCm and removes some obsolete #ifdef's from relu_op_gpu.cu.cc."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35960", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35960/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35960/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35960/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35960", "id": 551151015, "node_id": "MDU6SXNzdWU1NTExNTEwMTU=", "number": 35960, "title": "Add python dev (alpha version) for testing and building in CI", "user": {"login": "stevenleeS0ht", "id": 41497963, "node_id": "MDQ6VXNlcjQxNDk3OTYz", "avatar_url": "https://avatars1.githubusercontent.com/u/41497963?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stevenleeS0ht", "html_url": "https://github.com/stevenleeS0ht", "followers_url": "https://api.github.com/users/stevenleeS0ht/followers", "following_url": "https://api.github.com/users/stevenleeS0ht/following{/other_user}", "gists_url": "https://api.github.com/users/stevenleeS0ht/gists{/gist_id}", "starred_url": "https://api.github.com/users/stevenleeS0ht/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stevenleeS0ht/subscriptions", "organizations_url": "https://api.github.com/users/stevenleeS0ht/orgs", "repos_url": "https://api.github.com/users/stevenleeS0ht/repos", "events_url": "https://api.github.com/users/stevenleeS0ht/events{/privacy}", "received_events_url": "https://api.github.com/users/stevenleeS0ht/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-01-17T01:42:22Z", "updated_at": "2020-01-30T23:53:56Z", "closed_at": null, "author_association": "NONE", "body": "Add python dev in CI can efficiently avoid the problem in next release. it it can make TensorFlow always support latest python stable release."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35956", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35956/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35956/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35956/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/35956", "id": 551095347, "node_id": "MDExOlB1bGxSZXF1ZXN0MzYzODgwMTE4", "number": 35956, "title": "[TF_MICRO]  Adding cwrapper and compiler option example for building library", "user": {"login": "cdknorow", "id": 884424, "node_id": "MDQ6VXNlcjg4NDQyNA==", "avatar_url": "https://avatars1.githubusercontent.com/u/884424?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cdknorow", "html_url": "https://github.com/cdknorow", "followers_url": "https://api.github.com/users/cdknorow/followers", "following_url": "https://api.github.com/users/cdknorow/following{/other_user}", "gists_url": "https://api.github.com/users/cdknorow/gists{/gist_id}", "starred_url": "https://api.github.com/users/cdknorow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cdknorow/subscriptions", "organizations_url": "https://api.github.com/users/cdknorow/orgs", "repos_url": "https://api.github.com/users/cdknorow/repos", "events_url": "https://api.github.com/users/cdknorow/events{/privacy}", "received_events_url": "https://api.github.com/users/cdknorow/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 1169365682, "node_id": "MDU6TGFiZWwxMTY5MzY1Njgy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:L", "name": "size:L", "color": "adafea", "default": false, "description": "CL Change Size: Large"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2020-01-16T22:36:04Z", "updated_at": "2020-03-05T11:19:24Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/35956", "html_url": "https://github.com/tensorflow/tensorflow/pull/35956", "diff_url": "https://github.com/tensorflow/tensorflow/pull/35956.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/35956.patch"}, "body": "- adding example cwrapper which generates the projects with simple api\r\n- adding make library option to the makefile template\r\n- make project have the compiler path defined setting\r\n- adds a parser to pull out only the used ops from a tflite model"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35952", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35952/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35952/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35952/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35952", "id": 550947323, "node_id": "MDU6SXNzdWU1NTA5NDczMjM=", "number": 35952, "title": "Device placement function for placing network variables on specific device", "user": {"login": "baiztencale", "id": 44966014, "node_id": "MDQ6VXNlcjQ0OTY2MDE0", "avatar_url": "https://avatars3.githubusercontent.com/u/44966014?v=4", "gravatar_id": "", "url": "https://api.github.com/users/baiztencale", "html_url": "https://github.com/baiztencale", "followers_url": "https://api.github.com/users/baiztencale/followers", "following_url": "https://api.github.com/users/baiztencale/following{/other_user}", "gists_url": "https://api.github.com/users/baiztencale/gists{/gist_id}", "starred_url": "https://api.github.com/users/baiztencale/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/baiztencale/subscriptions", "organizations_url": "https://api.github.com/users/baiztencale/orgs", "repos_url": "https://api.github.com/users/baiztencale/repos", "events_url": "https://api.github.com/users/baiztencale/events{/privacy}", "received_events_url": "https://api.github.com/users/baiztencale/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-01-16T17:20:51Z", "updated_at": "2020-01-17T12:46:15Z", "closed_at": null, "author_association": "NONE", "body": "Hey guys,\r\n\r\nI'm having trouble with using a placement function inside `tf.device(...)`. Basically I want that all network variables are placed on a specific device (e.g. cpu). All other tensors and operations should be placed at the current scope. Because a placement function inside `tf.decive(...)` needs always to return a device I implemented the function `pin_network_variables`, which separates the variables, tensors and ops to two devices.\r\nMy problem with that is, that now nesting multiple device scopes doesn't work any more. Now all variables, tensors and ops are placed accordingly to `pin_network_variables`.\r\nHere is a minimal example to illustrate the behavior:\r\n\r\n```\r\nimport tensorflow as tf\r\nfrom tensorflow.keras.layers import Dense\r\n\r\ndef pin_network_variables(var_device, op_device):\r\n    \"\"\"\r\n    Pins network variables to the specified device.\r\n\r\n    Args:\r\n        var_device: Device to put network variables on.\r\n        op_device: Device for everything except network variables.\r\n    \"\"\"\r\n\r\n    VAR_NAME_TYPS = ['kernel', 'bias', 'gamma', 'beta', 'moving_mean', 'moving_variance', 'recurrent_kernel']\r\n    def _is_network_var(op):\r\n        for var_type in VAR_NAME_TYPS:\r\n            if op.name.endswith('/' + var_type):\r\n                return True\r\n        return False\r\n\r\n    def _assign(op):\r\n        if _is_network_var(op):\r\n            return var_device\r\n        else:\r\n            return op_device\r\n\r\n    return _assign\r\n\r\ndef main(unused_argv):\r\n\r\n    # normally all network varibles whould be placed on cpu and everything else on gpu\r\n    with tf.device(pin_network_variables('/cpu:0', '/gpu:0')):\r\n\r\n        input_tensor = tf.ones((1, 5), tf.float32, 'input_tensor')\r\n\r\n        # the kernel and bias tensors are placed on cpu correctly\r\n        dense_1 = Dense(units=3,\r\n                        activation='softmax',\r\n                        use_bias=True,\r\n                        kernel_initializer='glorot_uniform',\r\n                        bias_initializer='zeros',\r\n                        name='dense_1')\r\n        dense_2 = Dense(units=3,\r\n                        activation='softmax',\r\n                        use_bias=True,\r\n                        kernel_initializer='glorot_uniform',\r\n                        bias_initializer='zeros',\r\n                        name='dense_2')\r\n\r\n        # the call ops of the layers are placed on gpu correctly\r\n        dense_1_out = dense_1(input_tensor)\r\n        dense_2_out = dense_2(input_tensor)\r\n\r\n        # in this scope are for example tensors and ops that need to be put on cpu, for computational reason\r\n        with tf.device('/cpu:0'):\r\n\r\n            # this op shoud be placed on cpu, but its put on gpu (due to 'pin_network_variables')\r\n            output_tensor = tf.add(dense_1_out, dense_2_out)\r\n\r\n    print('--------------------')\r\n    print('input_tensor\\t', input_tensor.device)\r\n    print('dense_1.kernel\\t', dense_1.kernel.device)\r\n    print('dense_1.bias\\t', dense_1.bias.device)\r\n    print('dense_2.kernel\\t', dense_2.kernel.device)\r\n    print('dense_2.bias\\t', dense_2.bias.device)\r\n    print('dense_1_out\\t', dense_1_out.device)\r\n    print('dense_2_out\\t', dense_2_out.device)\r\n    print('output_tensor\\t', output_tensor.device) # this should be put on cpu\r\n    print('--------------------')\r\n\r\n    # create, initialise and session\r\n    sess = tf.compat.v1.Session()\r\n    sess.run(tf.compat.v1.global_variables_initializer())\r\n    output = sess.run(output_tensor)\r\n    print(output)\r\n\r\nif __name__ == '__main__':\r\n    tf.compat.v1.app.run()\r\n```\r\n\r\nDoes anybody now a fix to this?\r\n\r\nOS Platform and Distribution: Windows 10\r\nTensorFlow installed from: pip\r\nTensorFlow version: 1.14.0\r\nPython version: 3.6"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35949", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35949/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35949/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35949/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35949", "id": 550920641, "node_id": "MDU6SXNzdWU1NTA5MjA2NDE=", "number": 35949, "title": "AttributeError: 'Tensor' object has no attribute '_datatype_enum'", "user": {"login": "nbro", "id": 9349000, "node_id": "MDQ6VXNlcjkzNDkwMDA=", "avatar_url": "https://avatars2.githubusercontent.com/u/9349000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nbro", "html_url": "https://github.com/nbro", "followers_url": "https://api.github.com/users/nbro/followers", "following_url": "https://api.github.com/users/nbro/following{/other_user}", "gists_url": "https://api.github.com/users/nbro/gists{/gist_id}", "starred_url": "https://api.github.com/users/nbro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nbro/subscriptions", "organizations_url": "https://api.github.com/users/nbro/orgs", "repos_url": "https://api.github.com/users/nbro/repos", "events_url": "https://api.github.com/users/nbro/events{/privacy}", "received_events_url": "https://api.github.com/users/nbro/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-01-16T16:32:58Z", "updated_at": "2020-03-01T11:54:25Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Mac OS X Catalina (10.15.2)\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): v2.0.0-rc2-26-g64c3d382ca 2.0.0\r\n- Python version: 3.7.5\r\n- GPU model and memory: Intel Iris Pro 1536 MB\r\n\r\n**Describe the current behavior**\r\n\r\nI get the errors\r\n\r\n> tensorflow.python.eager.core._FallbackException: This function does not handle the case of the path where all inputs are not already EagerTensors.\r\n\r\nthen \r\n\r\n> AttributeError: 'Tensor' object has no attribute '_datatype_enum'\r\n\r\nand then\r\n\r\n> AttributeError: 'ProgbarLogger' object has no attribute 'log_values'\r\n\r\nwhen I add the following callback to the list of callbacks of `my_model.fit`\r\n\r\n```\r\nmy_callback = tf.keras.callbacks.LambdaCallback(on_batch_begin=lambda batch, logs: tf.print(my_model.losses))\r\n```\r\n\r\n**Describe the expected behavior**\r\n\r\nNo error.\r\n\r\n**Code to reproduce the issue**\r\n\r\n```\r\nimport tensorflow as tf\r\n\r\n\r\ndef get_model():\r\n    inp = tf.keras.layers.Input(shape=(1,))\r\n    x = tf.keras.layers.Dense(8, activity_regularizer=tf.keras.regularizers.l1(0.01))(inp)\r\n    x = tf.keras.layers.Dense(16, activity_regularizer=tf.keras.regularizers.l1(0.01))(x)\r\n    out = tf.keras.layers.Dense(1)(x)\r\n    model = tf.keras.Model(inputs=inp, outputs=out)\r\n    return model\r\n\r\n\r\ndef train():\r\n    my_model = get_model()\r\n    my_model.compile(optimizer=\"adam\", loss=\"mse\")\r\n    my_callback = tf.keras.callbacks.LambdaCallback(on_batch_begin=lambda batch, logs: tf.print(my_model.losses))\r\n    my_model.fit([1, 2, 3, 4], [0.1, 0.2, 0.4, 0.2], callbacks=[my_callback])\r\n\r\n\r\nif __name__ == '__main__':\r\n    train()\r\n```\r\n\r\nThis issue may be related to https://github.com/tensorflow/tensorflow/issues/28924 and https://github.com/tensorflow/tensorflow/issues/29931. Note that, if I don't use any regulariser, `tf.print` prints an empty list and no error occurs."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35948", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35948/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35948/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35948/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35948", "id": 550915423, "node_id": "MDU6SXNzdWU1NTA5MTU0MjM=", "number": 35948, "title": "Support for saved_model (tf2.*) in tf_compile", "user": {"login": "Arjuna197", "id": 34486624, "node_id": "MDQ6VXNlcjM0NDg2NjI0", "avatar_url": "https://avatars2.githubusercontent.com/u/34486624?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Arjuna197", "html_url": "https://github.com/Arjuna197", "followers_url": "https://api.github.com/users/Arjuna197/followers", "following_url": "https://api.github.com/users/Arjuna197/following{/other_user}", "gists_url": "https://api.github.com/users/Arjuna197/gists{/gist_id}", "starred_url": "https://api.github.com/users/Arjuna197/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Arjuna197/subscriptions", "organizations_url": "https://api.github.com/users/Arjuna197/orgs", "repos_url": "https://api.github.com/users/Arjuna197/repos", "events_url": "https://api.github.com/users/Arjuna197/events{/privacy}", "received_events_url": "https://api.github.com/users/Arjuna197/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2020-01-16T16:24:12Z", "updated_at": "2020-01-17T19:11:58Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): 2.*\r\n- Are you willing to contribute it (Yes/No): No\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nTF_Compile doesn't accept saved_model\r\n**Will this change the current api? How?**\r\nit would add a saved_model entry under tf_library macro\r\n**Who will benefit with this feature?**\r\nAnyone using tf2.* and tf-compile. Frozen graphs are deprecated in 2.0\r\n**Any Other info.**\r\n<3"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35946", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35946/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35946/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35946/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/35946", "id": 550892951, "node_id": "MDExOlB1bGxSZXF1ZXN0MzYzNzE0NTE0", "number": 35946, "title": "[TFLite int16] Symmetric 16-bit activations and 8-bit weights: reference kernel CONV_2D", "user": {"login": "wwwind", "id": 1513336, "node_id": "MDQ6VXNlcjE1MTMzMzY=", "avatar_url": "https://avatars0.githubusercontent.com/u/1513336?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wwwind", "html_url": "https://github.com/wwwind", "followers_url": "https://api.github.com/users/wwwind/followers", "following_url": "https://api.github.com/users/wwwind/following{/other_user}", "gists_url": "https://api.github.com/users/wwwind/gists{/gist_id}", "starred_url": "https://api.github.com/users/wwwind/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wwwind/subscriptions", "organizations_url": "https://api.github.com/users/wwwind/orgs", "repos_url": "https://api.github.com/users/wwwind/repos", "events_url": "https://api.github.com/users/wwwind/events{/privacy}", "received_events_url": "https://api.github.com/users/wwwind/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 987666414, "node_id": "MDU6TGFiZWw5ODc2NjY0MTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/ready%20to%20pull", "name": "ready to pull", "color": "2cd643", "default": false, "description": ""}, {"id": 1169365682, "node_id": "MDU6TGFiZWwxMTY5MzY1Njgy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:L", "name": "size:L", "color": "adafea", "default": false, "description": "CL Change Size: Large"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2020-01-16T15:47:45Z", "updated_at": "2020-03-19T07:10:48Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/35946", "html_url": "https://github.com/tensorflow/tensorflow/pull/35946", "diff_url": "https://github.com/tensorflow/tensorflow/pull/35946.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/35946.patch"}, "body": "This PR is one of steps to extend 8-bit quantization to support symmetric 16-bit activations.\r\n\r\nEach activation is of type int16 and symmetric around zero. The weight tensor precision remains at 8-bit signed values. The bias is set to int64 precision.\r\n\r\nIn this PR we introduce implementation and tests for CONV_2D kernel reference function.\r\nThe specification of this operator:\r\n\r\nCONV_2D \r\n\u202f Input 0: \r\n\u202f \u202f data_type \u202f: int16 \r\n\u202f \u202f range \u202f \u202f \u202f: [-32768, 32767] \r\n\u202f \u202f granularity: per-tensor, zero_point=0 \r\n\u202f Input 1 (Weight): \r\n\u202f \u202f data_type \u202f: int8 \r\n\u202f \u202f range \u202f \u202f \u202f: [-127, 127] \r\n\u202f \u202f granularity: per-axis (dim = 0), zero_point=0 \r\n\u202f Input 2 (Bias): \r\n\u202f \u202f data_type \u202f: int64 \r\n\u202f \u202f range \u202f \u202f \u202f: [-(1<<39), (1<<39)-1] \r\n\u202f \u202f granularity: per-axis (dim = 0), zero_point=0 \r\n\u202f \u202f restriction: (scale, zero_point) = (input0_scale * input1_scale[...], 0) \r\n\u202f Output 0: \r\n\u202f \u202f data_type \u202f: int16 \r\n\u202f \u202f range \u202f \u202f \u202f: [-32768,32767] \r\n\u202f \u202f granularity: per-tensor, zero_point=0"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35944", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35944/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35944/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35944/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35944", "id": 550842331, "node_id": "MDU6SXNzdWU1NTA4NDIzMzE=", "number": 35944, "title": "tf.data.Dataset.from_generator converts input argument types implicitly instead of just forwarding", "user": {"login": "mxmlnkn", "id": 6842824, "node_id": "MDQ6VXNlcjY4NDI4MjQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/6842824?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mxmlnkn", "html_url": "https://github.com/mxmlnkn", "followers_url": "https://api.github.com/users/mxmlnkn/followers", "following_url": "https://api.github.com/users/mxmlnkn/following{/other_user}", "gists_url": "https://api.github.com/users/mxmlnkn/gists{/gist_id}", "starred_url": "https://api.github.com/users/mxmlnkn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mxmlnkn/subscriptions", "organizations_url": "https://api.github.com/users/mxmlnkn/orgs", "repos_url": "https://api.github.com/users/mxmlnkn/repos", "events_url": "https://api.github.com/users/mxmlnkn/events{/privacy}", "received_events_url": "https://api.github.com/users/mxmlnkn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-01-16T14:28:01Z", "updated_at": "2020-02-21T18:43:40Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- custom code\r\n- Ubuntu 18.04.1 LTS\r\n- Thinkpad X240\r\n- TensorFlow installed via pip3\r\n- TensorFlow v2.0.0-rc2-26-g64c3d38 2.0.0\r\n- Python 3.6.8\r\n- no CUDA/cuDNN\r\n\r\n**Describe the current behavior**\r\n\r\nThe code below generates the output `(1, 0)` for the first print when using the generator directly and the exception below when wrapping the generator using `tf.data.Dataset.from_generator`.\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nInvalidArgumentError                      Traceback (most recent call last)\r\n<ipython-input-35-36b15431cf1a> in <module>()\r\n     17 \r\n     18 print( next( movingWindow( data, window_size ) ) )\r\n---> 19 print( next( iter( dataset ) ) )\r\n\r\n/home/maximiliank/.local/lib/python3.6/site-packages/tensorflow_core/python/data/ops/iterator_ops.py in __next__(self)\r\n    620 \r\n    621   def __next__(self):  # For Python 3 compatibility\r\n--> 622     return self.next()\r\n    623 \r\n    624   def _next_internal(self):\r\n\r\n/home/maximiliank/.local/lib/python3.6/site-packages/tensorflow_core/python/data/ops/iterator_ops.py in next(self)\r\n    664     \"\"\"Returns a nested structure of `Tensor`s containing the next element.\"\"\"\r\n    665     try:\r\n--> 666       return self._next_internal()\r\n    667     except errors.OutOfRangeError:\r\n    668       raise StopIteration\r\n\r\n/home/maximiliank/.local/lib/python3.6/site-packages/tensorflow_core/python/data/ops/iterator_ops.py in _next_internal(self)\r\n    649             self._iterator_resource,\r\n    650             output_types=self._flat_output_types,\r\n--> 651             output_shapes=self._flat_output_shapes)\r\n    652 \r\n    653       try:\r\n\r\n/home/maximiliank/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/gen_dataset_ops.py in iterator_get_next_sync(iterator, output_types, output_shapes, name)\r\n   2671       else:\r\n   2672         message = e.message\r\n-> 2673       _six.raise_from(_core._status_to_exception(e.code, message), None)\r\n   2674   # Add nodes to the TensorFlow graph.\r\n   2675   if not isinstance(output_types, (list, tuple)):\r\n\r\n/usr/lib/python3/dist-packages/six.py in raise_from(value, from_value)\r\n\r\nInvalidArgumentError: TypeError: an integer is required\r\nTraceback (most recent call last):\r\n\r\n  File \"/home/maximiliank/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/script_ops.py\", line 221, in __call__\r\n    ret = func(*args)\r\n\r\n  File \"/home/maximiliank/.local/lib/python3.6/site-packages/tensorflow_core/python/data/ops/dataset_ops.py\", line 585, in generator_py_func\r\n    values = next(generator_state.get_iterator(iterator_id))\r\n\r\n  File \"<ipython-input-35-36b15431cf1a>\", line 3, in movingWindow\r\n    buffer = collections.deque( data[:window_size-1], maxlen = window_size )\r\n\r\nTypeError: an integer is required\r\n\r\n\r\n\t [[{{node PyFunc}}]] [Op:IteratorGetNextSync]\r\n```\r\n\r\nAs it turns out this is because the `window_size` given in the `args` argument is unexpectedly converted from `int` to `np.int32`, which can't be used interchangeably for slicing or the deque maxlen parameter.\r\n\r\n**Describe the expected behavior**\r\n\r\nThe example should work without exception. Which means, from_generator should not change the types of any arguments given via the `args` parameter.\r\n\r\n**Code to reproduce the issue**\r\n\r\n\r\n```Python3\r\nimport tensorflow as tf\r\nimport numpy as np\r\nimport collections\r\n\r\ndef movingWindow( data, window_size ):\r\n    #window_size = int( window_size )\r\n    buffer = collections.deque( data[:window_size-1], maxlen = window_size )\r\n    for i, datum in enumerate( data[window_size-1:] ):\r\n        buffer.append( datum )\r\n        for b in buffer:\r\n            yield datum, b\r\n\r\nwindow_size = 2\r\ndata = np.arange( 10 )\r\n\r\ndataset = tf.data.Dataset.from_generator( \r\n    movingWindow,\r\n    args = ( data, window_size ),\r\n    output_types = ( np.int32, np.int32 )\r\n)\r\n\r\nprint( next( movingWindow( data, window_size ) ) )\r\nprint( next( iter( dataset ) ) )\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35942", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35942/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35942/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35942/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35942", "id": 550831818, "node_id": "MDU6SXNzdWU1NTA4MzE4MTg=", "number": 35942, "title": "Loading model with tf.keras.models.load_model not working on multi GPU", "user": {"login": "MariaHeuss", "id": 52407215, "node_id": "MDQ6VXNlcjUyNDA3MjE1", "avatar_url": "https://avatars2.githubusercontent.com/u/52407215?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MariaHeuss", "html_url": "https://github.com/MariaHeuss", "followers_url": "https://api.github.com/users/MariaHeuss/followers", "following_url": "https://api.github.com/users/MariaHeuss/following{/other_user}", "gists_url": "https://api.github.com/users/MariaHeuss/gists{/gist_id}", "starred_url": "https://api.github.com/users/MariaHeuss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MariaHeuss/subscriptions", "organizations_url": "https://api.github.com/users/MariaHeuss/orgs", "repos_url": "https://api.github.com/users/MariaHeuss/repos", "events_url": "https://api.github.com/users/MariaHeuss/events{/privacy}", "received_events_url": "https://api.github.com/users/MariaHeuss/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2020-01-16T14:10:56Z", "updated_at": "2020-03-12T06:49:59Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Custom code\r\n- TensorFlow version 2.1.0\r\n- Python version: 3.7\r\n- GPU model: 4 V100 GPUs on Kubernetes Engine\r\n\r\n**Describe the current behavior**\r\nOn multi GPU loading the model from a h5 file is not working. \r\n\r\n**Describe the expected behavior**\r\nSaving and reloading the model from a h5 file using model.save and  keras.models.load_model should work on both single and multi GPU.\r\n\r\n**Code to reproduce the issue**\r\n``` python \r\nimport tensorflow as tf \r\nimport os\r\nimport contextlib\r\nimport numpy as np\r\nimport tensorflow.keras as keras  \r\n\r\ndef get_model():\r\n    model = keras.Sequential([\r\n        keras.layers.Flatten(input_shape=(28, 28)),\r\n        keras.layers.Dense(10, activation=tf.nn.softmax)\r\n    ])\r\n    model.compile(optimizer=tf.keras.optimizers.Adam(),\r\n                      loss='sparse_categorical_crossentropy')\r\n    return model\r\n\r\ndef get_model_path():\r\n    model_dir = '/tmp/m' + str(np.random.randint(0, 1000000))\r\n    os.makedirs(model_dir)\r\n    model_path = os.path.join(model_dir, 'model')\r\n    return model_path + \".h5\"\r\n\r\ndef attempt_save_and_reload(model_path, distributed_training=False):\r\n    fashion_mnist = keras.datasets.fashion_mnist\r\n    (train_images, train_labels), (test_images, test_labels) = fashion_mnist.load_data()\r\n    train_images = train_images / 255.0\r\n    test_images = test_images / 255.0\r\n\r\n    with strategy.scope() if distributed_training else contextlib.nullcontext():\r\n        model = get_model()\r\n        model.fit(\r\n            train_images,\r\n            train_labels,\r\n            epochs=1,\r\n        )\r\n        model.save(model_path)\r\n        model = tf.keras.models.load_model(model_path)\r\n\r\nif __name__ == '__main__':\r\n    strategy = tf.distribute.MirroredStrategy()\r\n    for distributed_training in [False, True]:\r\n        print('distributed training: ', distributed_training)\r\n        model_path = get_model_path()\r\n        try:\r\n            attempt_save_and_reload(model_path, distributed_training)\r\n        except Exception as e:\r\n            print('Exception raised: \\n', e)\r\n        print()\r\n```\r\n\r\n\r\n\r\n**other info/ logs**\r\nI need to use h5 files since saving the optimizer state does not work otherwise (see #33424).  The logs I get are: \r\n```\r\nINFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1', '/job:localhost/replica:0/task:0/device:GPU:2', '/job:localhost/replica:0/task:0/device:GPU:3')\r\ndistributed training:  False\r\nTrain on 60000 samples\r\n60000/60000 [==============================] - 3s 52us/sample - loss: 0.5991\r\n\r\ndistributed training:  True\r\nTrain on 60000 samples\r\nINFO:tensorflow:batch_all_reduce: 2 all-reduces with algorithm = nccl, num_packs = 1, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nINFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).\r\nINFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).\r\nINFO:tensorflow:batch_all_reduce: 2 all-reduces with algorithm = nccl, num_packs = 1, agg_small_grads_max_bytes = 0 and agg_small_grads_max_group = 10\r\nINFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).\r\nINFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).\r\n60000/60000 [==============================] - 9s 152us/sample - loss: 0.6016\r\nException raised: \r\n `handle` is not available outside the replica context or a `tf.distribute.Strategy.update()` call.\r\n```\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35940", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35940/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35940/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35940/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35940", "id": 550798749, "node_id": "MDU6SXNzdWU1NTA3OTg3NDk=", "number": 35940, "title": "Incorrect mention of dataset....", "user": {"login": "ManishAradwad", "id": 29497701, "node_id": "MDQ6VXNlcjI5NDk3NzAx", "avatar_url": "https://avatars0.githubusercontent.com/u/29497701?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ManishAradwad", "html_url": "https://github.com/ManishAradwad", "followers_url": "https://api.github.com/users/ManishAradwad/followers", "following_url": "https://api.github.com/users/ManishAradwad/following{/other_user}", "gists_url": "https://api.github.com/users/ManishAradwad/gists{/gist_id}", "starred_url": "https://api.github.com/users/ManishAradwad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ManishAradwad/subscriptions", "organizations_url": "https://api.github.com/users/ManishAradwad/orgs", "repos_url": "https://api.github.com/users/ManishAradwad/repos", "events_url": "https://api.github.com/users/ManishAradwad/events{/privacy}", "received_events_url": "https://api.github.com/users/ManishAradwad/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2020-01-16T13:12:37Z", "updated_at": "2020-01-31T16:59:19Z", "closed_at": null, "author_association": "NONE", "body": "## URL(s) with the issue:\r\n\r\nhttps://github.com/tensorflow/examples/blob/master/courses/udacity_intro_to_tensorflow_lite/tflite_c05_exercise_rock_paper_scissors.ipynb\r\n---------------------------------------------------------------\r\n![Screenshot from 2020-01-16 18-37-30](https://user-images.githubusercontent.com/29497701/72527695-5d004900-388f-11ea-84f8-57ed0c12c915.png)\r\n----------------------------------------------------------------\r\n\r\n## Description of issue (what needs changing):\r\n\r\nI think this exercise doesn't make use of cats_vs_dogs dataset, right??\r\n\r\n### Clear description\r\n\r\nIn place of `cats_vs_dogs` dataset, `rock_paper_scissors` dataset should be mentioned.\r\n\r\n### Submit a pull request?\r\n\r\nYes, shortly"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35939", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35939/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35939/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35939/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35939", "id": 550783205, "node_id": "MDU6SXNzdWU1NTA3ODMyMDU=", "number": 35939, "title": "Problems when compiling with Clang", "user": {"login": "aabadie", "id": 1375137, "node_id": "MDQ6VXNlcjEzNzUxMzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/1375137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aabadie", "html_url": "https://github.com/aabadie", "followers_url": "https://api.github.com/users/aabadie/followers", "following_url": "https://api.github.com/users/aabadie/following{/other_user}", "gists_url": "https://api.github.com/users/aabadie/gists{/gist_id}", "starred_url": "https://api.github.com/users/aabadie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aabadie/subscriptions", "organizations_url": "https://api.github.com/users/aabadie/orgs", "repos_url": "https://api.github.com/users/aabadie/repos", "events_url": "https://api.github.com/users/aabadie/events{/privacy}", "received_events_url": "https://api.github.com/users/aabadie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "wangtz", "id": 34290063, "node_id": "MDQ6VXNlcjM0MjkwMDYz", "avatar_url": "https://avatars1.githubusercontent.com/u/34290063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wangtz", "html_url": "https://github.com/wangtz", "followers_url": "https://api.github.com/users/wangtz/followers", "following_url": "https://api.github.com/users/wangtz/following{/other_user}", "gists_url": "https://api.github.com/users/wangtz/gists{/gist_id}", "starred_url": "https://api.github.com/users/wangtz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wangtz/subscriptions", "organizations_url": "https://api.github.com/users/wangtz/orgs", "repos_url": "https://api.github.com/users/wangtz/repos", "events_url": "https://api.github.com/users/wangtz/events{/privacy}", "received_events_url": "https://api.github.com/users/wangtz/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "wangtz", "id": 34290063, "node_id": "MDQ6VXNlcjM0MjkwMDYz", "avatar_url": "https://avatars1.githubusercontent.com/u/34290063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wangtz", "html_url": "https://github.com/wangtz", "followers_url": "https://api.github.com/users/wangtz/followers", "following_url": "https://api.github.com/users/wangtz/following{/other_user}", "gists_url": "https://api.github.com/users/wangtz/gists{/gist_id}", "starred_url": "https://api.github.com/users/wangtz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wangtz/subscriptions", "organizations_url": "https://api.github.com/users/wangtz/orgs", "repos_url": "https://api.github.com/users/wangtz/repos", "events_url": "https://api.github.com/users/wangtz/events{/privacy}", "received_events_url": "https://api.github.com/users/wangtz/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2020-01-16T12:42:04Z", "updated_at": "2020-02-21T18:43:39Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "@tensorflow/micro\r\n\r\n**System information**\r\n- Host OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 19.10\r\n- TensorFlow installed from (source or binary): source (for inference), python (for training)\r\n- Tensorflow version (commit SHA if source): 1768c8f2fa155d4c6406e8ff7addf374c83de7ad for inference, release 2.0 or 2.1 for training.\r\n- Target platform (e.g. Arm Mbed OS, Arduino Nano 33 etc.): [RIOT](https://github.com/RIOT-OS/RIOT), ARM Cortex-M3/4/7\r\n\r\n**Describe the problem**\r\n\r\nI recently ported TensorFlow Lite to RIOT, an operating system for microcontrollers, using the package mechanism provided by the RIOT build system: this allows to build TensorFlow-Lite on the fly when generating a RIOT firmware and to use it's API from a RIOT application.\r\nSee https://github.com/RIOT-OS/RIOT/pull/12847 for details.\r\n\r\nRIOT provides support for many boards including many ARM based boards. It also supports both the GCC and the LLVM (Clang) toolchains.\r\n\r\nOur CI showed problems when building with Clang, see below for details and [this issue](https://github.com/RIOT-OS/RIOT/issues/13133). In short, the firmware is crashing when evaluating the FullyConnected operator on ARM Cortex-M but the same thing works fine with GCC.\r\n\r\nThe [example application in RIOT](https://github.com/RIOT-OS/RIOT/tree/master/tests/pkg_tensorflow-lite) is just running a very basic MLP model (with Dense and Softmax layers) on an image taken from the MNIST dataset. For details of the application, you can have a look at the [main_functions.cc file](https://github.com/RIOT-OS/RIOT/blob/master/tests/pkg_tensorflow-lite/mnist/main_functions.cc) and [the script](https://github.com/RIOT-OS/RIOT/blob/master/tests/pkg_tensorflow-lite/mnist/mnist_mlp.py) used to generate the flatbuffers file containing the model.\r\n\r\nNote that `hello_world` example is running fine, even when built with LLVM so I don't know what's wrong here: is the Python script or is it the way the `MicroMutableOpResolver` is built ?\r\n\r\nSorry for the long description but I wanted to make as complete as possible.\r\n\r\n**Please provide the exact sequence of commands/steps when you ran into the problem**\r\n\r\n- Software required on the host:\r\n  - **clang**: on Ubuntu, can be installed with `apt install clang`\r\n  - **ARM Cortex-M gdb**, from the [GNU ARM toolchain](https://developer.arm.com/tools-and-software/open-source-software/developer-tools/gnu-toolchain/gnu-rm) (this is for the debug command below).\r\n  - pyocd, can be installed with `pip3 install --user pyocd`\r\n  - socat, on Ubuntu, can be installed with `apt install socat`\r\n- Build/flash/run the default tensorflow-lite example of RIOT on an [nrf52832-mdk](https://wiki.makerdiary.com/nrf52832-mdk/):\r\n```\r\nDEVELHELP=1 RIOT_TERMINAL=socat TOOLCHAIN=llvm make BOARD=nrf52832-mdk -C tests/pkg_tensorflow-lite flash term\r\n```\r\n- You can check where the program crashed using the `debug` target (just follow the instructions reported by the RIOT crash):\r\n```\r\nmake BOARD=nrf52832-mdk -C tests/pkg_tensorflow-lite debug\r\n```\r\nThen in gdb:\r\n```gdb\r\nset $pc=0x8006b04\r\nframe 0\r\nbt\r\n```\r\nYou get the following output:\r\n```gdb\r\nReading symbols from /work/riot/RIOT/tests/pkg_tensorflow-lite/bin/stm32f723e-disco/tests_pkg_tensorflow-lite.elf...\r\nRemote debugging using :3333\r\nhard_fault_handler (sp=0x20001bb8 <setup()::static_interpreter+16>, corrupted=1132396544, \r\n    exc_return=536882079, r4_to_r11_stack=0x310) at vectors_cortexm.c:393\r\n393\t    __BKPT(1);\r\n(gdb) set $pc=0x8006bbe\r\n(gdb) frame 0\r\n#0  tflite::GetOptionalInputTensor (context=0x20001bb8 <setup()::static_interpreter+16>, node=0xc46c, \r\n    index=2)\r\n    at /work/riot/RIOT/tests/pkg_tensorflow-lite/bin/pkg/stm32f723e-disco/tensorflow-lite/tensorflow/lite/kernels/kernel_util.h:80\r\n80\t  const bool use_tensor = index < node->inputs->size &&\r\n(gdb) bt\r\n#0  tflite::GetOptionalInputTensor (context=0x20001bb8 <setup()::static_interpreter+16>, node=0xc46c, \r\n    index=2)\r\n    at /work/riot/RIOT/tests/pkg_tensorflow-lite/bin/pkg/stm32f723e-disco/tensorflow-lite/tensorflow/lite/kernels/kernel_util.h:80\r\n#1  tflite::ops::micro::fully_connected::Eval (context=0x20001bb8 <setup()::static_interpreter+16>, \r\n    node=0xc46c) at fully_connected.cc:172\r\n#2  0x08002276 in tflite::MicroInterpreter::Invoke (this=0x20001ba8 <setup()::static_interpreter>)\r\n    at micro_interpreter.cc:201\r\n#3  0x080018b0 in setup () at main_functions.cc:100\r\n#4  0x0800164e in main (argc=5, argv=0xc46c) at main.cpp:28\r\n(gdb) quit\r\n```\r\n\r\nThe board is not very important, this command can be adapted for a lot of other ARM based boards supported by RIOT: STM32 nucleo, kinetis, etc. Note that you'll have to install the right tool for flashing the boards (OpenOCD, JLink, etc) depending on the board configuration.\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35935", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35935/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35935/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35935/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35935", "id": 550755790, "node_id": "MDU6SXNzdWU1NTA3NTU3OTA=", "number": 35935, "title": "conda install tensorflow or any command to install the Tensroflow is not working.", "user": {"login": "vishwas1234567", "id": 48592314, "node_id": "MDQ6VXNlcjQ4NTkyMzE0", "avatar_url": "https://avatars0.githubusercontent.com/u/48592314?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vishwas1234567", "html_url": "https://github.com/vishwas1234567", "followers_url": "https://api.github.com/users/vishwas1234567/followers", "following_url": "https://api.github.com/users/vishwas1234567/following{/other_user}", "gists_url": "https://api.github.com/users/vishwas1234567/gists{/gist_id}", "starred_url": "https://api.github.com/users/vishwas1234567/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vishwas1234567/subscriptions", "organizations_url": "https://api.github.com/users/vishwas1234567/orgs", "repos_url": "https://api.github.com/users/vishwas1234567/repos", "events_url": "https://api.github.com/users/vishwas1234567/events{/privacy}", "received_events_url": "https://api.github.com/users/vishwas1234567/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1188421838, "node_id": "MDU6TGFiZWwxMTg4NDIxODM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:windows", "name": "subtype:windows", "color": "b619ea", "default": false, "description": "Windows Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2020-01-16T11:46:01Z", "updated_at": "2020-03-10T18:33:58Z", "closed_at": null, "author_association": "NONE", "body": "(base) C:\\Users\\vishwasnarayan>conda install -c anaconda tensorflow\r\nCollecting package metadata (current_repodata.json): done\r\nSolving environment: done\r\n\r\n## Package Plan ##\r\n\r\n  environment location: C:\\Users\\vishwasnarayan\\AppData\\Local\\Continuum\\anaconda3\r\n\r\n  added / updated specs:\r\n    - tensorflow\r\n\r\n\r\nThe following packages will be downloaded:\r\n\r\n    package                    |            build\r\n    ---------------------------|-----------------\r\n    _tflow_select-2.3.0        |              mkl           3 KB  anaconda\r\n    absl-py-0.8.1              |           py37_0         162 KB  anaconda\r\n    astor-0.8.0                |           py37_0          45 KB  anaconda\r\n    gast-0.2.2                 |           py37_0         138 KB  anaconda\r\n    google-pasta-0.1.8         |             py_0          43 KB  anaconda\r\n    keras-applications-1.0.8   |             py_0          33 KB  anaconda\r\n    keras-preprocessing-1.1.0  |             py_1          36 KB  anaconda\r\n    libmklml-2019.0.5          |                0        21.4 MB  anaconda\r\n    libprotobuf-3.11.2         |       h7bd577a_0         2.3 MB  anaconda\r\n    markdown-3.1.1             |           py37_0         132 KB  anaconda\r\n    opt_einsum-3.1.0           |             py_0          54 KB  anaconda\r\n    protobuf-3.11.2            |   py37h33f27b4_0         597 KB  anaconda\r\n    tensorboard-2.0.0          |     pyhb38c66f_1         3.3 MB  anaconda\r\n    tensorflow-2.0.0           |mkl_py37he1bbcac_0           4 KB  anaconda\r\n    tensorflow-base-2.0.0      |mkl_py37hd1d5974_0        41.9 MB  anaconda\r\n    tensorflow-estimator-2.0.0 |     pyh2649769_0         272 KB  anaconda\r\n    termcolor-1.1.0            |           py37_1           7 KB  anaconda\r\n    ------------------------------------------------------------\r\n                                           Total:        70.4 MB\r\n\r\nThe following NEW packages will be INSTALLED:\r\n\r\n  _tflow_select      anaconda/win-64::_tflow_select-2.3.0-mkl\r\n  absl-py            anaconda/win-64::absl-py-0.8.1-py37_0\r\n  astor              anaconda/win-64::astor-0.8.0-py37_0\r\n  gast               anaconda/win-64::gast-0.2.2-py37_0\r\n  google-pasta       anaconda/noarch::google-pasta-0.1.8-py_0\r\n  grpcio             pkgs/main/win-64::grpcio-1.16.1-py37h351948d_1\r\n  keras-applications anaconda/noarch::keras-applications-1.0.8-py_0\r\n  keras-preprocessi~ anaconda/noarch::keras-preprocessing-1.1.0-py_1\r\n  libmklml           anaconda/win-64::libmklml-2019.0.5-0\r\n  libprotobuf        anaconda/win-64::libprotobuf-3.11.2-h7bd577a_0\r\n  markdown           anaconda/win-64::markdown-3.1.1-py37_0\r\n  opt_einsum         anaconda/noarch::opt_einsum-3.1.0-py_0\r\n  protobuf           anaconda/win-64::protobuf-3.11.2-py37h33f27b4_0\r\n  tensorboard        anaconda/noarch::tensorboard-2.0.0-pyhb38c66f_1\r\n  tensorflow         anaconda/win-64::tensorflow-2.0.0-mkl_py37he1bbcac_0\r\n  tensorflow-base    anaconda/win-64::tensorflow-base-2.0.0-mkl_py37hd1d5974_0\r\n  tensorflow-estima~ anaconda/noarch::tensorflow-estimator-2.0.0-pyh2649769_0\r\n  termcolor          anaconda/win-64::termcolor-1.1.0-py37_1\r\n\r\n\r\nProceed ([y]/n)? y\r\n\r\n\r\nDownloading and Extracting Packages\r\ngast-0.2.2           | 138 KB    | ############################################################################ | 100%\r\ntensorflow-estimator | 272 KB    | ############################################################################ | 100%\r\ntensorflow-base-2.0. | 41.9 MB   | ############################################################################ | 100%\r\ntensorflow-2.0.0     | 4 KB      | ############################################################################ | 100%\r\nastor-0.8.0          | 45 KB     | ############################################################################ | 100%\r\nabsl-py-0.8.1        | 162 KB    | ############################################################################ | 100%\r\n_tflow_select-2.3.0  | 3 KB      | ############################################################################ | 100%\r\nlibmklml-2019.0.5    | 21.4 MB   | ############################################################################ | 100%\r\ntensorboard-2.0.0    | 3.3 MB    | ############################################################################ | 100%\r\nlibprotobuf-3.11.2   | 2.3 MB    | ############################################################################ | 100%\r\nopt_einsum-3.1.0     | 54 KB     | ############################################################################ | 100%\r\nmarkdown-3.1.1       | 132 KB    | ############################################################################ | 100%\r\ngoogle-pasta-0.1.8   | 43 KB     | ############################################################################ | 100%\r\nkeras-applications-1 | 33 KB     | ############################################################################ | 100%\r\ntermcolor-1.1.0      | 7 KB      | ############################################################################ | 100%\r\nkeras-preprocessing- | 36 KB     | ############################################################################ | 100%\r\nprotobuf-3.11.2      | 597 KB    | ############################################################################ | 100%\r\nPreparing transaction: done\r\nVerifying transaction: failed\r\n\r\nCondaVerificationError: The package for tensorflow-base located at C:\\Users\\vishwasnarayan\\AppData\\Local\\Continuum\\anaconda3\\pkgs\\tensorflow-base-2.0.0-mkl_py37hd1d5974_0\r\nappears to be corrupted. The path 'Lib/site-packages/tensorflow-2.0.0.data/purelib/tensorflow_core/include/tensorflow_core/core/grappler/optimizers/generic_layout_optimizer_transposer_factory.h'\r\nspecified in the package manifest cannot be found."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35932", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35932/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35932/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35932/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35932", "id": 550728393, "node_id": "MDU6SXNzdWU1NTA3MjgzOTM=", "number": 35932, "title": "Could not find matching function to call loaded from the SavedModel", "user": {"login": "mrinalsardar", "id": 13099048, "node_id": "MDQ6VXNlcjEzMDk5MDQ4", "avatar_url": "https://avatars1.githubusercontent.com/u/13099048?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mrinalsardar", "html_url": "https://github.com/mrinalsardar", "followers_url": "https://api.github.com/users/mrinalsardar/followers", "following_url": "https://api.github.com/users/mrinalsardar/following{/other_user}", "gists_url": "https://api.github.com/users/mrinalsardar/gists{/gist_id}", "starred_url": "https://api.github.com/users/mrinalsardar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrinalsardar/subscriptions", "organizations_url": "https://api.github.com/users/mrinalsardar/orgs", "repos_url": "https://api.github.com/users/mrinalsardar/repos", "events_url": "https://api.github.com/users/mrinalsardar/events{/privacy}", "received_events_url": "https://api.github.com/users/mrinalsardar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2020-01-16T10:53:07Z", "updated_at": "2020-03-13T23:23:27Z", "closed_at": null, "author_association": "NONE", "body": "My code works in `GPU` based tensorflow environment without any fuss but fails in `CPU` based environments. Some other people also are facing the same issue. `Training` works without any issues but it's the `predict` method that's failing.\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- TensorFlow installed from (source or binary): Source\r\n- Other system related information below:\r\n\r\n```\r\nCollecting system information...\r\n/tmp/check_os.py:18: DeprecationWarning: dist() and linux_distribution() functions are deprecated in Python 3.5\r\n  platform.linux_distribution(),\r\n/tmp/check_os.py:19: DeprecationWarning: dist() and linux_distribution() functions are deprecated in Python 3.5\r\n  platform.dist(),\r\ncat: /proc/1/cgroup: No such file or directory\r\n2020-01-16 15:58:53.661018: I tensorflow/core/platform/cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA\r\nTo enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.\r\n2020-01-16 15:58:53.661360: I tensorflow/core/common_runtime/process_util.cc:115] Creating new thread pool with default inter op setting: 12. Tune using inter_op_parallelism_threads for best performance.\r\n')\r\narchitecture: ('64bit', '')\r\nmachine: x86_64\r\n\r\n\r\n== are we in docker =============================================\r\nNo\r\n\r\n== compiler =====================================================\r\nApple LLVM version 10.0.1 (clang-1001.0.46.4)\r\nTarget: x86_64-apple-darwin18.7.0\r\nThread model: posix\r\nInstalledDir: /Library/Developer/CommandLineTools/usr/bin\r\n\r\n== check pips ===================================================\r\nnumpy                         1.17.4             \r\nprotobuf                      3.11.2             \r\ntensorflow                    2.1.0              \r\ntensorflow-estimator          2.1.0              \r\ntensorflow-hub                0.7.0              \r\n\r\n== check for virtualenv =========================================\r\nFalse\r\n\r\n== tensorflow import ============================================\r\ntf.version.VERSION = 2.0.0\r\ntf.version.GIT_VERSION = unknown\r\ntf.version.COMPILER_VERSION = 4.2.1 Compatible Clang 4.0.1 (tags/RELEASE_401/final)\r\nSanity check: array([1], dtype=int32)\r\n\r\n== env ==========================================================\r\nLD_LIBRARY_PATH is unset\r\nDYLD_LIBRARY_PATH is unset\r\n\r\n== nvidia-smi ===================================================\r\ntf_env_cololect.sh: line 147: nvidia-smi: command not found\r\n\r\n== cuda libs  ===================================================\r\n\r\n== tensorflow installed from info ==================\r\nName: tensorflow\r\nVersion: 2.1.0\r\nSummary: TensorFlow is an open source machine learning framework for everyone.\r\nHome-page: https://www.tensorflow.org/\r\nAuthor-email: packages@tensorflow.org\r\nLicense: Apache 2.0\r\nLocation: /Users/sardarmrinal/anaconda3/lib/python3.7/site-packages\r\nRequired-by: \r\n\r\n== python version  ==============================================\r\n(major, minor, micro, releaselevel, serial)\r\n(3, 7, 6, 'final', 0)\r\n\r\n== bazel version  ===============================================\r\nBuild label: 1.2.1\r\nBuild time: Tue Nov 26 15:27:31 2019 (1574782051)\r\nBuild timestamp: 1574782051\r\nBuild timestamp as int: 1574782051\r\n```\r\n\r\n**Describe the current behavior**\r\nThe code is running successfully in `GPU` based environment and failing in `CPU` based environments.\r\n\r\n**Describe the expected behavior**\r\nIt should run/fail in the same way in both `GPU` and `CPU` based environments.\r\n\r\n**Code to reproduce the issue**\r\nCode in the following link has the same behavior:\r\nhttps://www.kaggle.com/xhlulu/disaster-nlp-keras-bert-using-tfhub\r\n\r\nAnd also people are talking about this issue in the comments.\r\n\r\n\r\n**Other info / logs**\r\n```\r\nMaking predictions\r\nTraceback (most recent call last):\r\n  File \"/Users/sardarmrinal/Egnyte/Private/sardar.mrinal/workspace/competitions/kaggle_nlp_disaster/working/NLP_disaster_bert.py\", line 218, in <module>\r\n    df_sub = model_bert.predict(df_eval)\r\n  File \"/Users/sardarmrinal/Egnyte/Private/sardar.mrinal/workspace/competitions/kaggle_nlp_disaster/working/NLP_disaster_bert.py\", line 186, in predict\r\n    prediction = self.model.predict(x=X)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py\", line 909, in predict\r\n    use_multiprocessing=use_multiprocessing)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 462, in predict\r\n    steps=steps, callbacks=callbacks, **kwargs)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 444, in _model_iteration\r\n    total_epochs=1)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 123, in run_one_epoch\r\n    batch_outs = execution_function(iterator)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py\", line 86, in execution_function\r\n    distributed_function(input_fn))\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py\", line 457, in __call__\r\n    result = self._call(*args, **kwds)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py\", line 503, in _call\r\n    self._initialize(args, kwds, add_initializers_to=initializer_map)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py\", line 408, in _initialize\r\n    *args, **kwds))\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 1848, in _get_concrete_function_internal_garbage_collected\r\n    graph_function, _, _ = self._maybe_define_function(args, kwargs)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 2150, in _maybe_define_function\r\n    graph_function = self._create_graph_function(args, kwargs)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 2041, in _create_graph_function\r\n    capture_by_value=self._capture_by_value),\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/framework/func_graph.py\", line 915, in func_graph_from_py_func\r\n    func_outputs = python_func(*func_args, **func_kwargs)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py\", line 358, in wrapped_fn\r\n    return weak_wrapped_fn().__wrapped__(*args, **kwds)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py\", line 73, in distributed_function\r\n    per_replica_function, args=(model, x, y, sample_weights))\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/distribute/distribute_lib.py\", line 760, in experimental_run_v2\r\n    return self._extended.call_for_each_replica(fn, args=args, kwargs=kwargs)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/distribute/distribute_lib.py\", line 1787, in call_for_each_replica\r\n    return self._call_for_each_replica(fn, args, kwargs)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/distribute/distribute_lib.py\", line 2132, in _call_for_each_replica\r\n    return fn(*args, **kwargs)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/autograph/impl/api.py\", line 292, in wrapper\r\n    return func(*args, **kwargs)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py\", line 162, in _predict_on_batch\r\n    return predict_on_batch(model, x)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py\", line 370, in predict_on_batch\r\n    return model(inputs)  # pylint: disable=not-callable\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/base_layer.py\", line 847, in __call__\r\n    outputs = call_fn(cast_inputs, *args, **kwargs)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/network.py\", line 708, in call\r\n    convert_kwargs_to_constants=base_layer_utils.call_context().saving)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/network.py\", line 860, in _run_internal_graph\r\n    output_tensors = layer(computed_tensors, **kwargs)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/base_layer.py\", line 847, in __call__\r\n    outputs = call_fn(cast_inputs, *args, **kwargs)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/autograph/impl/api.py\", line 292, in wrapper\r\n    return func(*args, **kwargs)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_hub/keras_layer.py\", line 218, in call\r\n    lambda: f(training=False))\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/framework/smart_cond.py\", line 56, in smart_cond\r\n    return false_fn()\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_hub/keras_layer.py\", line 218, in <lambda>\r\n    lambda: f(training=False))\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/saved_model/load.py\", line 436, in _call_attribute\r\n    return instance.__call__(*args, **kwargs)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py\", line 457, in __call__\r\n    result = self._call(*args, **kwds)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py\", line 494, in _call\r\n    results = self._stateful_fn(*args, **kwds)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 1822, in __call__\r\n    graph_function, args, kwargs = self._maybe_define_function(args, kwargs)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 2150, in _maybe_define_function\r\n    graph_function = self._create_graph_function(args, kwargs)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 2041, in _create_graph_function\r\n    capture_by_value=self._capture_by_value),\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/framework/func_graph.py\", line 915, in func_graph_from_py_func\r\n    func_outputs = python_func(*func_args, **func_kwargs)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py\", line 358, in wrapped_fn\r\n    return weak_wrapped_fn().__wrapped__(*args, **kwds)\r\n  File \"/Users/sardarmrinal/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/saved_model/function_deserialization.py\", line 262, in restored_function_body\r\n    \"\\n\\n\".join(signature_descriptions)))\r\nValueError: Could not find matching function to call loaded from the SavedModel. Got:\r\n  Positional arguments (3 total):\r\n    * [<tf.Tensor 'inputs:0' shape=(None, 3) dtype=int64>, <tf.Tensor 'inputs_1:0' shape=(None, 3) dtype=int64>, <tf.Tensor 'inputs_2:0' shape=(None, 3) dtype=int64>]\r\n    * False\r\n    * None\r\n  Keyword arguments: {}\r\n\r\nExpected these arguments to match one of the following 4 option(s):\r\n\r\nOption 1:\r\n  Positional arguments (3 total):\r\n    * [TensorSpec(shape=(None, None), dtype=tf.int32, name='input_word_ids'), TensorSpec(shape=(None, None), dtype=tf.int32, name='input_mask'), TensorSpec(shape=(None, None), dtype=tf.int32, name='input_type_ids')]\r\n    * True\r\n    * None\r\n  Keyword arguments: {}\r\n\r\nOption 2:\r\n  Positional arguments (3 total):\r\n    * [TensorSpec(shape=(None, None), dtype=tf.int32, name='input_word_ids'), TensorSpec(shape=(None, None), dtype=tf.int32, name='input_mask'), TensorSpec(shape=(None, None), dtype=tf.int32, name='input_type_ids')]\r\n    * False\r\n    * None\r\n  Keyword arguments: {}\r\n\r\nOption 3:\r\n  Positional arguments (3 total):\r\n    * [TensorSpec(shape=(None, None), dtype=tf.int32, name='inputs/0'), TensorSpec(shape=(None, None), dtype=tf.int32, name='inputs/1'), TensorSpec(shape=(None, None), dtype=tf.int32, name='inputs/2')]\r\n    * True\r\n    * None\r\n  Keyword arguments: {}\r\n\r\nOption 4:\r\n  Positional arguments (3 total):\r\n    * [TensorSpec(shape=(None, None), dtype=tf.int32, name='inputs/0'), TensorSpec(shape=(None, None), dtype=tf.int32, name='inputs/1'), TensorSpec(shape=(None, None), dtype=tf.int32, name='inputs/2')]\r\n    * False\r\n    * None\r\n  Keyword arguments: {}\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35930", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35930/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35930/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35930/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35930", "id": 550697666, "node_id": "MDU6SXNzdWU1NTA2OTc2NjY=", "number": 35930, "title": "load_weights does not work when weights are saved in h5 format", "user": {"login": "bj1123", "id": 16620433, "node_id": "MDQ6VXNlcjE2NjIwNDMz", "avatar_url": "https://avatars0.githubusercontent.com/u/16620433?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bj1123", "html_url": "https://github.com/bj1123", "followers_url": "https://api.github.com/users/bj1123/followers", "following_url": "https://api.github.com/users/bj1123/following{/other_user}", "gists_url": "https://api.github.com/users/bj1123/gists{/gist_id}", "starred_url": "https://api.github.com/users/bj1123/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bj1123/subscriptions", "organizations_url": "https://api.github.com/users/bj1123/orgs", "repos_url": "https://api.github.com/users/bj1123/repos", "events_url": "https://api.github.com/users/bj1123/events{/privacy}", "received_events_url": "https://api.github.com/users/bj1123/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-01-16T09:58:58Z", "updated_at": "2020-03-13T23:07:08Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 2.1\r\n- Python version: 3.7\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\n**Describe the current behavior**\r\nmodel can't restore weights from h5 file\r\n\r\n**Describe the expected behavior**\r\n\r\n**Code to reproduce the issue**\r\n```\r\nclass Model(keras.Model):\r\n    def __init__(self, inp1, inp2):\r\n        super(Model, self).__init__()\r\n        self.x1 = self.add_weight('w1',[inp1])\r\n        self.x2 = self.add_weight('w2',[inp2])\r\n    def call(self,x):\r\n        return x\r\n# load_weights method works when save format is 'tf\r\nx = Model(100,200)\r\nx.save_weights('temp.tmp',save_format='tf')\r\nold = x.weights[0][0].numpy()\r\nprint(old)\r\nx = Model(100,200)\r\nx.load_weights('temp.tmp')\r\nnew = x.weights[0][0].numpy()\r\nprint(new)\r\nprint(old==new)\r\n\r\n# load_weights method does not work when save format is 'h5'\r\nx = Model(100,200)\r\nx.save_weights('temp.h5',save_format='h5')\r\nold = x.weights[0][0].numpy()\r\nprint(old)\r\nx = Model(100,200)\r\nx.load_weights('temp.h5')\r\nnew = x.weights[0][0].numpy()\r\nprint(new)\r\nprint(old==new)\r\n```\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35928", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35928/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35928/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35928/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35928", "id": 550654761, "node_id": "MDU6SXNzdWU1NTA2NTQ3NjE=", "number": 35928, "title": "Low performance when using persistent mode GradientTape with LSTM layers", "user": {"login": "zhuzhi-fairy", "id": 43736345, "node_id": "MDQ6VXNlcjQzNzM2MzQ1", "avatar_url": "https://avatars2.githubusercontent.com/u/43736345?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zhuzhi-fairy", "html_url": "https://github.com/zhuzhi-fairy", "followers_url": "https://api.github.com/users/zhuzhi-fairy/followers", "following_url": "https://api.github.com/users/zhuzhi-fairy/following{/other_user}", "gists_url": "https://api.github.com/users/zhuzhi-fairy/gists{/gist_id}", "starred_url": "https://api.github.com/users/zhuzhi-fairy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zhuzhi-fairy/subscriptions", "organizations_url": "https://api.github.com/users/zhuzhi-fairy/orgs", "repos_url": "https://api.github.com/users/zhuzhi-fairy/repos", "events_url": "https://api.github.com/users/zhuzhi-fairy/events{/privacy}", "received_events_url": "https://api.github.com/users/zhuzhi-fairy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2020-01-16T08:37:12Z", "updated_at": "2020-03-11T17:42:57Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code: Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04\r\n- TensorFlow installed from (source or binary): Conda\r\n- TensorFlow version (use command below): 2.0.0 and 2.1.0\r\n- Python version: 3.7.5\r\n- CUDA/cuDNN version: 10.0.130 / 7.6.4\r\n- GPU model and memory: GTX 980 Ti, GTX 2080 Ti\r\n\r\n**Describe the current behavior**\r\nThe performance was very low when using persistent mode tf.GradientTape or create multi-GradientTape objects in one ```with``` block.\r\nThis phenomenon only happens when the model includes a LSTM layer.\r\n\r\n**Code to reproduce the issue**\r\nHere is a sample code to reproduce the problem.\r\n```python\r\nimport timeit\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\nmodel0 = tf.keras.models.Sequential(\r\n    tf.keras.layers.LSTM(128, input_shape=(300, 40))\r\n)\r\nmodel1 = tf.keras.models.Sequential(\r\n    tf.keras.layers.Dense(1, activation='sigmoid', input_shape=(128,))\r\n)\r\nloss_object = tf.keras.losses.BinaryCrossentropy(from_logits=True)\r\n\r\n@tf.function\r\ndef train_step_0():\r\n  with tf.GradientTape() as tape0, tf.GradientTape() as tape1:\r\n    f = model0(tf.random.normal([256, 300, 40]))\r\n    y_p0 = model1(f)\r\n    y_p1 = model1(tf.random.normal((256, 128)))\r\n    loss0 = loss_object(tf.zeros_like(y_p0), y_p0)\r\n    loss1 = loss_object(tf.ones_like(y_p1), y_p1)\r\n  grad0 = tape0.gradient(loss0, model0.trainable_variables)\r\n  grad1 = tape1.gradient(loss1, model1.trainable_variables)\r\n\r\ntrain_step_0()\r\nprint(timeit.timeit('train_step_0()', globals=globals(), number=100))\r\n```\r\nIn this case, the GPU-Util was only about 30 % and the time was 37 seconds.\r\nThe following message was shown in screen.\r\n```\r\n2020-01-16 17:16:22.519978: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:502] function_optimizer failed: Invalid argument: Input 0 of node sequential/lstm/zeros_like was passed int32 from sequential/lstm/StatefulPartitionedCall:9 incompatible with expected variant.\r\n2020-01-16 17:16:22.667364: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:502] function_optimizer failed: Invalid argument: Input 0 of node sequential/lstm/zeros_like was passed int32 from sequential/lstm/StatefulPartitionedCall:9 incompatible with expected variant.\r\n2020-01-16 17:16:22.739393: W tensorflow/core/common_runtime/process_function_library_runtime.cc:675] Ignoring multi-device function optimization failure: Invalid argument: Input 0 of node sequential/lstm/zeros_like was passed int32 from sequential/lstm/StatefulPartitionedCall:9 incompatible with expected variant.\r\n```\r\n\r\n```python\r\n@tf.function\r\ndef train_step_1():\r\n  with tf.GradientTape(persistent=True) as tape:\r\n    f = model0(tf.random.normal([256, 300, 40]))\r\n    y_p0 = model1(f)\r\n    y_p1 = model1(tf.random.normal((256, 128)))\r\n    loss0 = loss_object(tf.zeros_like(y_p0), y_p0)\r\n    loss1 = loss_object(tf.ones_like(y_p1), y_p1)\r\n  grad0 = tape.gradient(loss0, model0.trainable_variables)\r\n  grad1 = tape.gradient(loss1, model1.trainable_variables)\r\n\r\ntrain_step_1()\r\nprint(timeit.timeit('train_step_1()', globals=globals(), number=100))\r\n```\r\nIn this case, the performance was similar to the previous one.\r\n\r\n```python\r\n@tf.function\r\ndef train_step_2():\r\n  with tf.GradientTape() as tape0:\r\n    f = model0(tf.random.normal([256, 300, 40]))\r\n    y_p0 = model1(f)\r\n    loss0 = loss_object(tf.zeros_like(y_p0), y_p0)\r\n  with tf.GradientTape() as tape1:\r\n    y_p1 = model1(tf.random.normal((256, 128)))\r\n    loss1 = loss_object(tf.ones_like(y_p1), y_p1)\r\n  grad0 = tape0.gradient(loss0, model0.trainable_variables)\r\n  grad1 = tape1.gradient(loss1, model1.trainable_variables)\r\n\r\ntrain_step_2()\r\nprint(timeit.timeit('train_step_2()', globals=globals(), number=100))\r\n```\r\nIn this case, the GPU-Util was almost 100 % and the time was only 4 seconds.\r\n\r\nIn my opinion, ```train_step_0```, ```train_step_1``` and ```train_step_2``` should have similar performance.\r\nI am wandering why the GPU-Util and process time were so that different.\r\nThe strangest thing is that this phenomenon only happens when the model includes a LSTM layer.\r\nIf we exchange the LSTM layer to Conv or Dense layer, the process time will be all same.\r\nHere is a colaboratory page to reproduce this problem.\r\nhttps://colab.research.google.com/drive/1sluVFuW1yYtH0Ye4reoOEmLUHYHDSGn7\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35925", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35925/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35925/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35925/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35925", "id": 550576513, "node_id": "MDU6SXNzdWU1NTA1NzY1MTM=", "number": 35925, "title": "Dataset with Keras Functional Model: tuple index out of range uin steps_per_epoch", "user": {"login": "jguhlin", "id": 1838344, "node_id": "MDQ6VXNlcjE4MzgzNDQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/1838344?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jguhlin", "html_url": "https://github.com/jguhlin", "followers_url": "https://api.github.com/users/jguhlin/followers", "following_url": "https://api.github.com/users/jguhlin/following{/other_user}", "gists_url": "https://api.github.com/users/jguhlin/gists{/gist_id}", "starred_url": "https://api.github.com/users/jguhlin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jguhlin/subscriptions", "organizations_url": "https://api.github.com/users/jguhlin/orgs", "repos_url": "https://api.github.com/users/jguhlin/repos", "events_url": "https://api.github.com/users/jguhlin/events{/privacy}", "received_events_url": "https://api.github.com/users/jguhlin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rsepassi", "id": 1115739, "node_id": "MDQ6VXNlcjExMTU3Mzk=", "avatar_url": "https://avatars3.githubusercontent.com/u/1115739?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsepassi", "html_url": "https://github.com/rsepassi", "followers_url": "https://api.github.com/users/rsepassi/followers", "following_url": "https://api.github.com/users/rsepassi/following{/other_user}", "gists_url": "https://api.github.com/users/rsepassi/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsepassi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsepassi/subscriptions", "organizations_url": "https://api.github.com/users/rsepassi/orgs", "repos_url": "https://api.github.com/users/rsepassi/repos", "events_url": "https://api.github.com/users/rsepassi/events{/privacy}", "received_events_url": "https://api.github.com/users/rsepassi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rsepassi", "id": 1115739, "node_id": "MDQ6VXNlcjExMTU3Mzk=", "avatar_url": "https://avatars3.githubusercontent.com/u/1115739?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsepassi", "html_url": "https://github.com/rsepassi", "followers_url": "https://api.github.com/users/rsepassi/followers", "following_url": "https://api.github.com/users/rsepassi/following{/other_user}", "gists_url": "https://api.github.com/users/rsepassi/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsepassi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsepassi/subscriptions", "organizations_url": "https://api.github.com/users/rsepassi/orgs", "repos_url": "https://api.github.com/users/rsepassi/repos", "events_url": "https://api.github.com/users/rsepassi/events{/privacy}", "received_events_url": "https://api.github.com/users/rsepassi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 14, "created_at": "2020-01-16T05:03:22Z", "updated_at": "2020-03-19T09:36:23Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\nYes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu, Newest\r\n- TensorFlow installed from (source or binary): **Pip (Binary)**\r\n- TensorFlow version (use command below): **2.1**\r\n- Python version: Python **3.7.6**\r\n- CUDA/cuDNN version: **10.2**\r\n- GPU model and memory: **GeForce 1070 8Gb**\r\n\r\n**Describe the current behavior**\r\nPassing in a dataset to model.fit from a model generated with tf.Keras layers results in **IndexError: tuple index out of range.** Error both with custom TFRecord dataset and datasets derived from tensorflow-datasets installed via pip. Looks like it is in the standardize_input_data function but since it is an instance of DatasetV2 it should not be hitting that if statement...\r\n\r\n**Describe the expected behavior**\r\nKeras models should accept tf DataSets.\r\n\r\n**Code to reproduce the issue**\r\n```Python\r\nfrom tensorflow.keras.layers import Dense, Embedding, Flatten, Lambda, Subtract, Input, Concatenate, Average, Reshape, GlobalAveragePooling1D, Dot, Dropout\r\nfrom tensorflow.keras.models import Model, Sequential\r\nfrom tensorflow.keras.utils import Sequence\r\nfrom tensorflow.keras import initializers\r\n\r\nimport tensorflow_datasets as tfds\r\ntfds.list_builders()\r\ndataset, info = tfds.load(\"mnist\", with_info=True)\r\ninputs = Input((28, 28, 1), name=\"image\")\r\nFirst = Dense(128, activation=\"relu\")\r\nSecond = Dropout(0.2)\r\nThird = Dense(10, activation=\"softmax\", name=\"label\")\r\n\r\nfirst = First(inputs)\r\nsecond = Second(first)\r\nthird = Third(second)\r\nmodel = Model(inputs=[inputs], outputs=[third])\r\nmodel.compile(optimizer='adam',\r\n              loss='sparse_categorical_crossentropy',\r\n              metrics=['accuracy'])\r\nmodel.fit(dataset['train'].batch(4096))\r\n```\r\n\r\n**Other info / logs**\r\n```\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py in fit(self, model, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_freq, max_queue_size, workers, use_multiprocessing,\r\n**kwargs)\r\n    340                 mode=ModeKeys.TRAIN,\r\n    341                 training_context=training_context,\r\n--> 342                 total_epochs=epochs)\r\n    343             cbks.make_logs(model, epoch_logs, training_result, ModeKeys.TRAIN)\r\n    344 \r\n\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py in run_one_epoch(model, iterator, execution_function, dataset_size, batch_size, strategy, steps_per_epoch, num_samples, mode, training_context, total_epochs)\r\n    126         step=step, mode=mode, size=current_batch_size) as batch_logs:\r\n    127       try:\r\n--> 128         batch_outs = execution_function(iterator)\r\n    129       except (StopIteration, errors.OutOfRangeError):\r\n    130         # TODO(kaftan): File bug about tf function and errors.OutOfRangeError?\r\n\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py in execution_function(input_fn)\r\n     96     # `numpy` translates Tensors to values in Eager mode.\r\n     97     return nest.map_structure(_non_none_constant_value,\r\n---> 98                               distributed_function(input_fn))\r\n     99 \r\n    100   return execution_function\r\n\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py in __call__(self, *args, **kwds)\r\n    566         xla_context.Exit()\r\n    567     else:\r\n--> 568       result = self._call(*args, **kwds)\r\n    569 \r\n    570     if tracing_count == self._get_tracing_count():\r\n\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py in _call(self, *args, **kwds)\r\n    613       # This is the first call of __call__, so we have to initialize.\r\n    614       initializers = []\r\n--> 615       self._initialize(args, kwds, add_initializers_to=initializers)\r\n    616     finally:\r\n    617       # At this point we know that the initialization is complete (or less\r\n\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py in _initialize(self, args, kwds, add_initializers_to)\r\n    495     self._concrete_stateful_fn = (\r\n    496         self._stateful_fn._get_concrete_function_internal_garbage_collected( \r\n# pylint: disable=protected-access\r\n--> 497             *args, **kwds))\r\n    498 \r\n    499     def invalid_creator_scope(*unused_args, **unused_kwds):\r\n\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py in _get_concrete_function_internal_garbage_collected(self, *args,\r\n**kwargs)    2387       args, kwargs = None, None    2388     with self._lock:\r\n-> 2389       graph_function, _, _ = self._maybe_define_function(args, kwargs)    2390     return graph_function    2391 \r\n\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py in _maybe_define_function(self, args, kwargs)    2701     2702       self._function_cache.missed.add(call_context_key)\r\n-> 2703       graph_function = self._create_graph_function(args, kwargs)    2704       self._function_cache.primary[cache_key] = graph_function    2705       return graph_function, args, kwargs\r\n\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py in _create_graph_function(self, args, kwargs, override_flat_arg_shapes)    2591             arg_names=arg_names,    2592             override_flat_arg_shapes=override_flat_arg_shapes,\r\n-> 2593             capture_by_value=self._capture_by_value),    2594         self._function_attributes,    2595         # Tell the ConcreteFunction to clean up its graph once it goes out of\r\n\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/framework/func_graph.py in func_graph_from_py_func(name, python_func, args, kwargs, signature, func_graph, autograph, autograph_options, add_control_dependencies, arg_names, op_return_value, collections, capture_by_value, override_flat_arg_shapes)\r\n    976                                           converted_func)\r\n    977 \r\n--> 978       func_outputs = python_func(*func_args, **func_kwargs)\r\n    979 \r\n    980       # invariant: `func_outputs` contains only Tensors, CompositeTensors,\r\n\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py in wrapped_fn(*args, **kwds)\r\n    437         # __wrapped__ allows AutoGraph to swap in a converted function. We give\r\n    438         # the function a weak reference to itself to avoid a reference cycle.\r\n--> 439         return weak_wrapped_fn().__wrapped__(*args, **kwds)\r\n    440     weak_wrapped_fn = weakref.ref(wrapped_fn)\r\n    441 \r\n\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py in distributed_function(input_iterator)\r\n     83     args = _prepare_feed_values(model, input_iterator, mode, strategy)\r\n     84     outputs = strategy.experimental_run_v2(\r\n---> 85         per_replica_function, args=args)\r\n     86     # Out of PerReplica outputs reduce or pick values to return.\r\n     87     all_outputs = dist_utils.unwrap_output_dict(\r\n\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/distribute/distribute_lib.py in experimental_run_v2(self, fn, args, kwargs)\r\n    761       fn = autograph.tf_convert(fn, ag_ctx.control_status_ctx(),\r\n    762                                 convert_by_default=False)\r\n--> 763       return self._extended.call_for_each_replica(fn, args=args, kwargs=kwargs)\r\n    764 \r\n    765   def reduce(self, reduce_op, value, axis):\r\n\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/distribute/distribute_lib.py in call_for_each_replica(self, fn, args, kwargs)    1817       kwargs\r\n= {}    1818     with self._container_strategy().scope():\r\n-> 1819       return self._call_for_each_replica(fn, args, kwargs)    1820     1821   def _call_for_each_replica(self, fn, args, kwargs):\r\n\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/distribute/distribute_lib.py in _call_for_each_replica(self, fn, args, kwargs)    2162         self._container_strategy(),    2163         replica_id_in_sync_group=constant_op.constant(0, dtypes.int32)):\r\n-> 2164       return fn(*args, **kwargs)    2165     2166   def _reduce_to(self, reduce_op, value, destinations):\r\n\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/autograph/impl/api.py in wrapper(*args, **kwargs)\r\n    290   def wrapper(*args, **kwargs):\r\n    291     with ag_ctx.ControlStatusCtx(status=ag_ctx.Status.DISABLED):\r\n--> 292       return func(*args, **kwargs)\r\n    293 \r\n    294   if inspect.isfunction(func) or inspect.ismethod(func):\r\n\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py in train_on_batch(model, x, y, sample_weight, class_weight, reset_metrics, standalone)\r\n    414   x, y, sample_weights = model._standardize_user_data(\r\n    415       x, y, sample_weight=sample_weight, class_weight=class_weight,\r\n--> 416       extract_tensors_from_dataset=True)\r\n    417   batch_size = array_ops.shape(nest.flatten(x, expand_composites=True)[0])[0]\r\n    418   # If `model._distribution_strategy` is True, then we are in a replica context\r\n\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py in _standardize_user_data(self, x, y, sample_weight, class_weight, batch_size, check_steps, steps_name, steps, validation_split, shuffle, extract_tensors_from_dataset)    2381         is_dataset=is_dataset,   2382         class_weight=class_weight,\r\n-> 2383         batch_size=batch_size)    2384     2385   def _standardize_tensors(self, x, y, sample_weight, run_eagerly, dict_inputs,\r\n\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py in _standardize_tensors(self, x, y, sample_weight, run_eagerly, dict_inputs, is_dataset, class_weight, batch_size)    2467           shapes=None,    2468           check_batch_axis=False,  # Don't enforce the batch size.\r\n-> 2469           exception_prefix='target')    2470     2471       # Generate sample-wise weight values given the `sample_weight` and\r\n\r\n~/miniconda3/envs/keras/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_utils.py in standardize_input_data(data, names, shapes, check_batch_axis, exception_prefix)\r\n    510                        'for each key in: ' + str(names))\r\n    511   elif isinstance(data, (list, tuple)):\r\n--> 512     if isinstance(data[0], (list, tuple)):\r\n    513       data = [np.asarray(d) for d in data]\r\n    514     elif len(names) == 1 and isinstance(data[0], (float, int)):\r\n\r\nIndexError: tuple index out of range\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35924", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35924/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35924/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35924/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/35924", "id": 550566290, "node_id": "MDExOlB1bGxSZXF1ZXN0MzYzNDQ5MTg2", "number": 35924, "title": "[ROCm] Optimized training apply ops", "user": {"login": "ekuznetsov139", "id": 12205429, "node_id": "MDQ6VXNlcjEyMjA1NDI5", "avatar_url": "https://avatars2.githubusercontent.com/u/12205429?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ekuznetsov139", "html_url": "https://github.com/ekuznetsov139", "followers_url": "https://api.github.com/users/ekuznetsov139/followers", "following_url": "https://api.github.com/users/ekuznetsov139/following{/other_user}", "gists_url": "https://api.github.com/users/ekuznetsov139/gists{/gist_id}", "starred_url": "https://api.github.com/users/ekuznetsov139/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ekuznetsov139/subscriptions", "organizations_url": "https://api.github.com/users/ekuznetsov139/orgs", "repos_url": "https://api.github.com/users/ekuznetsov139/repos", "events_url": "https://api.github.com/users/ekuznetsov139/events{/privacy}", "received_events_url": "https://api.github.com/users/ekuznetsov139/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1169365682, "node_id": "MDU6TGFiZWwxMTY5MzY1Njgy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:L", "name": "size:L", "color": "adafea", "default": false, "description": "CL Change Size: Large"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2020-01-16T04:26:45Z", "updated_at": "2020-03-15T00:41:54Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/35924", "html_url": "https://github.com/tensorflow/tensorflow/pull/35924", "diff_url": "https://github.com/tensorflow/tensorflow/pull/35924.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/35924.patch"}, "body": "This PR implements GPU kernels ApplyAdagrad, ApplyAdagradV2, ApplyAdadelta, ApplyRMSProp, and ApplyCenteredRMSProp for ROCm, and enables corresponding unit tests."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35920", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35920/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35920/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35920/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35920", "id": 550492379, "node_id": "MDU6SXNzdWU1NTA0OTIzNzk=", "number": 35920, "title": "TypeError: object of type 'NoneType' has no len()", "user": {"login": "cossio", "id": 10637482, "node_id": "MDQ6VXNlcjEwNjM3NDgy", "avatar_url": "https://avatars2.githubusercontent.com/u/10637482?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cossio", "html_url": "https://github.com/cossio", "followers_url": "https://api.github.com/users/cossio/followers", "following_url": "https://api.github.com/users/cossio/following{/other_user}", "gists_url": "https://api.github.com/users/cossio/gists{/gist_id}", "starred_url": "https://api.github.com/users/cossio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cossio/subscriptions", "organizations_url": "https://api.github.com/users/cossio/orgs", "repos_url": "https://api.github.com/users/cossio/repos", "events_url": "https://api.github.com/users/cossio/events{/privacy}", "received_events_url": "https://api.github.com/users/cossio/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2020-01-15T23:48:44Z", "updated_at": "2020-03-19T17:37:51Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- TensorFlow installed from (source or binary): from pip (binary?)\r\n- TensorFlow version (use command below): 2.1\r\n- Python version: 3.7\r\n- CUDA/cuDNN version: no\r\n- GPU model and memory: no\r\n\r\n**Describe the current behavior and code to reproduce**\r\n\r\nI am running this code:\r\n\r\nhttps://gist.github.com/cossio/dc761b2731b1428267b65333dbd3f321\r\n\r\nto train an RBM by contrastive divergence. Briefly I am using the Keras sub-classing API and I view the multiple Monte Carlo samples as layers.\r\n\r\nHowever it produces the following error:\r\n\r\n```\r\nTypeError: object of type 'NoneType' has no len()\r\n```\r\n\r\nPlease find the full error message and stack-trace as a comment on the above gist link."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35917", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35917/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35917/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35917/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35917", "id": 550478099, "node_id": "MDU6SXNzdWU1NTA0NzgwOTk=", "number": 35917, "title": "Compilation of TF2.1 with CUDA and TensorRT fails on Linux ", "user": {"login": "feranick", "id": 35967, "node_id": "MDQ6VXNlcjM1OTY3", "avatar_url": "https://avatars1.githubusercontent.com/u/35967?v=4", "gravatar_id": "", "url": "https://api.github.com/users/feranick", "html_url": "https://github.com/feranick", "followers_url": "https://api.github.com/users/feranick/followers", "following_url": "https://api.github.com/users/feranick/following{/other_user}", "gists_url": "https://api.github.com/users/feranick/gists{/gist_id}", "starred_url": "https://api.github.com/users/feranick/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/feranick/subscriptions", "organizations_url": "https://api.github.com/users/feranick/orgs", "repos_url": "https://api.github.com/users/feranick/repos", "events_url": "https://api.github.com/users/feranick/events{/privacy}", "received_events_url": "https://api.github.com/users/feranick/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2020-01-15T23:04:02Z", "updated_at": "2020-01-22T07:45:41Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: No\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version (use command below): 2.1.0\r\n- Python version: 3.6.8\r\n- Bazel version (if compiling from source): 0.29.1\r\n- GCC/Compiler version (if compiling from source): GCC 7.4.0\r\n- CUDA/cuDNN version: 10.1,10.2 CuDNN 7\r\n- GPU model and memory: NVidia GTX 1080 Ti\r\n- TensorRT: version 6 or 7.\r\n\r\n**Describe the current behavior**\r\nCompiling from source, as indicated in the official tensorflow manual, compilation fails, with the error listed in the log below.\r\n**Describe the expected behavior**\r\nCompilation should successfully complete\r\n\r\n**Code to reproduce the issue**\r\nNo code needed. After a checkout of the current v.2.1.0, configuration is carried out with no changes from default (other than enabling CUDA). \r\n\r\n**Other info / logs**\r\nLog: see attached log.txt\r\n[log.txt](https://github.com/tensorflow/tensorflow/files/4068010/log.txt)\r\n\r\n                                                                                                                                                   \r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35906", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35906/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35906/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/35906/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/35906", "id": 550378326, "node_id": "MDU6SXNzdWU1NTAzNzgzMjY=", "number": 35906, "title": "global numbering scheme of  tf.keras.layers.BatchNormalization layers seems like a wrong strategy", "user": {"login": "rcr1994", "id": 31768355, "node_id": "MDQ6VXNlcjMxNzY4MzU1", "avatar_url": "https://avatars0.githubusercontent.com/u/31768355?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rcr1994", "html_url": "https://github.com/rcr1994", "followers_url": "https://api.github.com/users/rcr1994/followers", "following_url": "https://api.github.com/users/rcr1994/following{/other_user}", "gists_url": "https://api.github.com/users/rcr1994/gists{/gist_id}", "starred_url": "https://api.github.com/users/rcr1994/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rcr1994/subscriptions", "organizations_url": "https://api.github.com/users/rcr1994/orgs", "repos_url": "https://api.github.com/users/rcr1994/repos", "events_url": "https://api.github.com/users/rcr1994/events{/privacy}", "received_events_url": "https://api.github.com/users/rcr1994/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-01-15T19:17:15Z", "updated_at": "2020-02-08T01:08:26Z", "closed_at": null, "author_association": "NONE", "body": "<em>I trained a model in Tensorflow and used 36 convolution layers, each holding a batch normalization layer. What I do not understand is why the numbering of batch normalization layer is global instead of starting from 0 for every name scope? \r\nI am not going to create the layers with the same name_scope in the same order in every model, sometimes I will insert a few layers before a particular layer and would like to restore the batch norm parameters from other model checkpoint, but it's not possible because batch norm layer is numbered globally, and because I created this layer at a step numerically bigger than the step at which I created the same layer in other model, the names will be different and I won't be able to restore parameters in the traditional way. </em>\r\n\r\n**System information**\r\n-\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Mint\r\n- TensorFlow installed from (source or binary): tf-gpu anaconda \r\n- TensorFlow version : tf.2.0.0\r\n- Python version: 3.7.4\r\n\r\n\r\nHere is the list of batch norm parameters in my original model, mind the layer: batch_normalization_18 , this name is batch_normalization_18 because this is the 19th (18 is in numbering because index starts from 0) batchnorm layer created.\r\n\r\n['Train/vgg_deconv_RGB_LSTM/Block1_conv1/batch_normalization/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block1_conv1/batch_normalization/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block1_conv1/batch_normalization/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block1_conv1/batch_normalization/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block1_conv2/batch_normalization_1/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block1_conv2/batch_normalization_1/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block1_conv2/batch_normalization_1/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block1_conv2/batch_normalization_1/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block2_conv1/batch_normalization_2/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block2_conv1/batch_normalization_2/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block2_conv1/batch_normalization_2/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block2_conv1/batch_normalization_2/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block2_conv2/batch_normalization_3/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block2_conv2/batch_normalization_3/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block2_conv2/batch_normalization_3/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block2_conv2/batch_normalization_3/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block3_conv1/batch_normalization_4/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block3_conv1/batch_normalization_4/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block3_conv1/batch_normalization_4/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block3_conv1/batch_normalization_4/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block3_conv2/batch_normalization_5/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block3_conv2/batch_normalization_5/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block3_conv2/batch_normalization_5/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block3_conv2/batch_normalization_5/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block3_conv3/batch_normalization_6/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block3_conv3/batch_normalization_6/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block3_conv3/batch_normalization_6/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block3_conv3/batch_normalization_6/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block3_conv4/batch_normalization_7/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block3_conv4/batch_normalization_7/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block3_conv4/batch_normalization_7/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block3_conv4/batch_normalization_7/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block4_conv1/batch_normalization_8/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block4_conv1/batch_normalization_8/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block4_conv1/batch_normalization_8/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block4_conv1/batch_normalization_8/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block4_conv2/batch_normalization_9/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block4_conv2/batch_normalization_9/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block4_conv2/batch_normalization_9/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block4_conv2/batch_normalization_9/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block4_conv3/batch_normalization_10/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block4_conv3/batch_normalization_10/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block4_conv3/batch_normalization_10/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block4_conv3/batch_normalization_10/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block4_conv4/batch_normalization_11/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block4_conv4/batch_normalization_11/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block4_conv4/batch_normalization_11/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block4_conv4/batch_normalization_11/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block5_conv1/batch_normalization_12/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block5_conv1/batch_normalization_12/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block5_conv1/batch_normalization_12/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block5_conv1/batch_normalization_12/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block5_conv2/batch_normalization_13/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block5_conv2/batch_normalization_13/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block5_conv2/batch_normalization_13/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block5_conv2/batch_normalization_13/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block5_conv3/batch_normalization_14/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block5_conv3/batch_normalization_14/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block5_conv3/batch_normalization_14/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block5_conv3/batch_normalization_14/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block5_conv4/batch_normalization_15/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block5_conv4/batch_normalization_15/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block5_conv4/batch_normalization_15/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block5_conv4/batch_normalization_15/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block6_conv1/batch_normalization_16/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block6_conv1/batch_normalization_16/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block6_conv1/batch_normalization_16/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block6_conv1/batch_normalization_16/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block6_conv2/batch_normalization_17/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block6_conv2/batch_normalization_17/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block6_conv2/batch_normalization_17/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Block6_conv2/batch_normalization_17/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock6_conv1/batch_normalization_18/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock6_conv1/batch_normalization_18/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock6_conv1/batch_normalization_18/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock6_conv1/batch_normalization_18/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock6_conv2/batch_normalization_19/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock6_conv2/batch_normalization_19/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock6_conv2/batch_normalization_19/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock6_conv2/batch_normalization_19/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock5_conv1/batch_normalization_20/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock5_conv1/batch_normalization_20/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock5_conv1/batch_normalization_20/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock5_conv1/batch_normalization_20/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock5_conv2/batch_normalization_21/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock5_conv2/batch_normalization_21/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock5_conv2/batch_normalization_21/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock5_conv2/batch_normalization_21/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock5_conv3/batch_normalization_22/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock5_conv3/batch_normalization_22/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock5_conv3/batch_normalization_22/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock5_conv3/batch_normalization_22/moving_variance:0']\r\n\r\n\r\nNow, I created another model, where I am creating the same layers, but I am inserting two layers before this 19th layer, and hence, this will be given a different name just because of this reason. \r\n\r\n ['Train/vgg_deconv_RGB_LSTM/Dlock6_conv1/batch_normalization_20/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock6_conv1/batch_normalization_20/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock6_conv1/batch_normalization_20/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock6_conv1/batch_normalization_20/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock6_conv2/batch_normalization_21/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock6_conv2/batch_normalization_21/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock6_conv2/batch_normalization_21/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/Dlock6_conv2/batch_normalization_21/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/extra_conv1_first/batch_normalization_18/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/extra_conv1_first/batch_normalization_18/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/extra_conv1_first/batch_normalization_18/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/extra_conv1_first/batch_normalization_18/moving_variance:0',\r\n 'Train/vgg_deconv_RGB_LSTM/extra_conv2_second/batch_normalization_19/beta:0',\r\n 'Train/vgg_deconv_RGB_LSTM/extra_conv2_second/batch_normalization_19/gamma:0',\r\n 'Train/vgg_deconv_RGB_LSTM/extra_conv2_second/batch_normalization_19/moving_mean:0',\r\n 'Train/vgg_deconv_RGB_LSTM/extra_conv2_second/batch_normalization_19/moving_variance:0']\r\n\r\n\r\nYou can see, now batch_normalization_18 name is given to another layer, and my original layer, which was given batch_normalization_18 in previous model, it is given the name of \r\nbatch_normalization_20, even though all the variable scope and name scope is same. \r\n\r\nShould'nt it be like local numbering for every name_scope? What's the point behind global numbering? \r\n\r\nPlease let me know if any more information is needed. \r\n"}]