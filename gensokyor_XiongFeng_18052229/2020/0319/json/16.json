[{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32322", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32322/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32322/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32322/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32322", "id": 490702068, "node_id": "MDU6SXNzdWU0OTA3MDIwNjg=", "number": 32322, "title": "compute_mask not called when custom layer does not alter inputs and mask is not None", "user": {"login": "deasmhumhna", "id": 3468977, "node_id": "MDQ6VXNlcjM0Njg5Nzc=", "avatar_url": "https://avatars0.githubusercontent.com/u/3468977?v=4", "gravatar_id": "", "url": "https://api.github.com/users/deasmhumhna", "html_url": "https://github.com/deasmhumhna", "followers_url": "https://api.github.com/users/deasmhumhna/followers", "following_url": "https://api.github.com/users/deasmhumhna/following{/other_user}", "gists_url": "https://api.github.com/users/deasmhumhna/gists{/gist_id}", "starred_url": "https://api.github.com/users/deasmhumhna/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/deasmhumhna/subscriptions", "organizations_url": "https://api.github.com/users/deasmhumhna/orgs", "repos_url": "https://api.github.com/users/deasmhumhna/repos", "events_url": "https://api.github.com/users/deasmhumhna/events{/privacy}", "received_events_url": "https://api.github.com/users/deasmhumhna/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-09-08T02:33:00Z", "updated_at": "2019-09-24T00:13:52Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 2.0.0-beta\r\n- Python version: 3.7.3-2\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nWhen the layer does not alter the inputs (but alters the mask), if `mask` is not `None`, the layer does not execute the `compute_mask` method. \r\n**Describe the expected behavior**\r\nCall `compute_mask` and attach the mask to output regardless.\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\nclass RandomMaskingNoAlter(tf.keras.layers.Layer):\r\n\r\n  def call(self, inputs):\r\n    return inputs\r\n\r\n  def compute_mask(self, inputs, mask=None):\r\n    print('no alter executed')\r\n    if mask is None:\r\n      return None\r\n    random_mask = tf.cast(tf.random.uniform(tf.shape(mask), 0, 1, dtype=tf.int32), tf.bool)\r\n    return tf.math.logical_and(random_mask, mask)\r\n\r\nclass RandomMaskingAlter(tf.keras.layers.Layer):\r\n    \r\n  def call(self, inputs):\r\n    return inputs + 0\r\n\r\n  def compute_mask(self, inputs, mask=None):\r\n    print('alter executed')\r\n    if mask is None:\r\n      return None\r\n    random_mask = tf.cast(tf.random.uniform(tf.shape(mask), 0, 1, dtype=tf.int32), tf.bool)\r\n    return tf.math.logical_and(random_mask, mask)\r\n\r\nx = np.array([[1, 4, 2, 2, 0, 0], [1, 1, 1, 0, 0, 0], [3, 2, 2, 3, 4, 1]], dtype='i4')\r\ny = tf.keras.layers.Embedding(5, 5, mask_zero=True)(x)\r\n\r\nz1 = RandomMaskingNoAlter()(x)\r\nz2 = RandomMaskingNoAlter()(y)\r\nz3 = RandomMaskingAlter()(x)\r\nz4 = RandomMaskingAlter()(y)\r\n```\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32315", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32315/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32315/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32315/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32315", "id": 490642662, "node_id": "MDU6SXNzdWU0OTA2NDI2NjI=", "number": 32315, "title": "Support for 32 bits architecture", "user": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": true, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 15, "created_at": "2019-09-07T14:38:48Z", "updated_at": "2019-09-18T17:10:01Z", "closed_at": null, "author_association": "COLLABORATOR", "body": "Several users are still using Python32 bits and they cannot install TensorFlow. For them, `pip install tensorflow` fails as no wheel matches the tags expected by their environment (to debug, `pip debug --verbose` shows only tags that don't math the filenames of our wheels).\r\n\r\nThere is some requests to support 32 bits, see for example #31431 \r\n\r\nThis is not going to be easy as we need to also compile the C++ codebase in 32 bits mode and that would cause issues with code written assuming types have a certain bit width.\r\n\r\nThere is no change in the user visible API, just a new set of wheels to support more users.\r\n\r\nOpening this to reference in all similar issues."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32287", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32287/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32287/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32287/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/32287", "id": 490325768, "node_id": "MDExOlB1bGxSZXF1ZXN0MzE0OTUzMzMw", "number": 32287, "title": "Image recognition example for Tensorflow Lite Micro", "user": {"login": "jenselofsson", "id": 1914691, "node_id": "MDQ6VXNlcjE5MTQ2OTE=", "avatar_url": "https://avatars2.githubusercontent.com/u/1914691?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jenselofsson", "html_url": "https://github.com/jenselofsson", "followers_url": "https://api.github.com/users/jenselofsson/followers", "following_url": "https://api.github.com/users/jenselofsson/following{/other_user}", "gists_url": "https://api.github.com/users/jenselofsson/gists{/gist_id}", "starred_url": "https://api.github.com/users/jenselofsson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jenselofsson/subscriptions", "organizations_url": "https://api.github.com/users/jenselofsson/orgs", "repos_url": "https://api.github.com/users/jenselofsson/repos", "events_url": "https://api.github.com/users/jenselofsson/events{/privacy}", "received_events_url": "https://api.github.com/users/jenselofsson/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 987666414, "node_id": "MDU6TGFiZWw5ODc2NjY0MTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/ready%20to%20pull", "name": "ready to pull", "color": "2cd643", "default": false, "description": ""}, {"id": 1173072136, "node_id": "MDU6TGFiZWwxMTczMDcyMTM2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:XL", "name": "size:XL", "color": "adafea", "default": false, "description": "CL Change Size:Extra Large"}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 25, "created_at": "2019-09-06T13:24:02Z", "updated_at": "2020-03-10T19:57:41Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/32287", "html_url": "https://github.com/tensorflow/tensorflow/pull/32287", "diff_url": "https://github.com/tensorflow/tensorflow/pull/32287.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/32287.patch"}, "body": "This is a demo showing how to use Tensorflow Lite Micro to perform image recognition using a STM32F746G-DISCO discovery board with a STM32F4DIS-CAM camera module attached."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32274", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32274/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32274/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32274/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/32274", "id": 490108450, "node_id": "MDExOlB1bGxSZXF1ZXN0MzE0Nzc4ODY3", "number": 32274, "title": "Update losses.py", "user": {"login": "praveenjune17", "id": 26601843, "node_id": "MDQ6VXNlcjI2NjAxODQz", "avatar_url": "https://avatars0.githubusercontent.com/u/26601843?v=4", "gravatar_id": "", "url": "https://api.github.com/users/praveenjune17", "html_url": "https://github.com/praveenjune17", "followers_url": "https://api.github.com/users/praveenjune17/followers", "following_url": "https://api.github.com/users/praveenjune17/following{/other_user}", "gists_url": "https://api.github.com/users/praveenjune17/gists{/gist_id}", "starred_url": "https://api.github.com/users/praveenjune17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/praveenjune17/subscriptions", "organizations_url": "https://api.github.com/users/praveenjune17/orgs", "repos_url": "https://api.github.com/users/praveenjune17/repos", "events_url": "https://api.github.com/users/praveenjune17/events{/privacy}", "received_events_url": "https://api.github.com/users/praveenjune17/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1178505529, "node_id": "MDU6TGFiZWwxMTc4NTA1NTI5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/prtype:bugfix", "name": "prtype:bugfix", "color": "159b2e", "default": false, "description": "PR to fix a bug"}, {"id": 1169364259, "node_id": "MDU6TGFiZWwxMTY5MzY0MjU5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:XS", "name": "size:XS", "color": "adafea", "default": false, "description": "CL Change Size: Extra Small"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-09-06T03:27:59Z", "updated_at": "2019-12-24T07:17:57Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/32274", "html_url": "https://github.com/tensorflow/tensorflow/pull/32274", "diff_url": "https://github.com/tensorflow/tensorflow/pull/32274.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/32274.patch"}, "body": "In response to [issue](https://github.com/tensorflow/tensorflow/issues/32231)\r\nThe current axis (1) works only for Rank 2 tensors so changed it to -1 which works for  higher rank tensors (> 2). "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32271", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32271/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32271/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32271/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32271", "id": 490082156, "node_id": "MDU6SXNzdWU0OTAwODIxNTY=", "number": 32271, "title": "XLA inference slower than plain TF inference for ResNet50 (0.084s vs 0.115s) .", "user": {"login": "sgambient", "id": 42156923, "node_id": "MDQ6VXNlcjQyMTU2OTIz", "avatar_url": "https://avatars0.githubusercontent.com/u/42156923?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sgambient", "html_url": "https://github.com/sgambient", "followers_url": "https://api.github.com/users/sgambient/followers", "following_url": "https://api.github.com/users/sgambient/following{/other_user}", "gists_url": "https://api.github.com/users/sgambient/gists{/gist_id}", "starred_url": "https://api.github.com/users/sgambient/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sgambient/subscriptions", "organizations_url": "https://api.github.com/users/sgambient/orgs", "repos_url": "https://api.github.com/users/sgambient/repos", "events_url": "https://api.github.com/users/sgambient/events{/privacy}", "received_events_url": "https://api.github.com/users/sgambient/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1133285679, "node_id": "MDU6TGFiZWwxMTMzMjg1Njc5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:xla", "name": "comp:xla", "color": "0052cc", "default": false, "description": ""}, {"id": 1166103538, "node_id": "MDU6TGFiZWwxMTY2MTAzNTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/contrib", "name": "contrib", "color": "5319e7", "default": false, "description": "Anything that comes under contrib directory"}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2019-09-06T01:21:47Z", "updated_at": "2019-09-27T01:14:39Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 1.14\r\n- Python version: 2.7\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:10.1\r\n- GPU model and memory: T4\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nDo not see any  inference speedup  with  XLA enabled through TF_XLA_FLAGS=--tf_xla_auto_jit=2\r\n\r\n**Describe the expected behavior**\r\nExpected to see some improvement.  \r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n```\r\n# to run python ./xla_resnet2x.py --runtime TFXLACOMP\r\nfrom tensorflow.contrib.slim.nets import resnet_v1\r\nimport tensorflow as tf\r\nimport tensorflow.contrib.slim as slim\r\nimport numpy as np\r\nimport time\r\nimport os\r\nfrom PIL import Image\r\nfrom tensorflow.contrib.compiler import xla\r\nimport argparse\r\n\r\nPATH_TO_CKPT = \"resnet_v1_50.ckpt\"\r\nTEST_IMAGE_PATHS = [ \"elephant_small.jpg\", \"tabby_tiger_cat.jpg\"]\r\nBATCH_SIZE=25\r\nMAX_BATCH_SIZE=1000\r\nHEIGHT=224\r\nWIDTH=224\r\nCHANNELS=3\r\n\r\n\r\ndef load_image_into_numpy_array(image, batch_size=1):\r\n  (im_width, im_height) = image.size\r\n  x = np.array(image.getdata()).reshape(\r\n      (HEIGHT, WIDTH, CHANNELS)).astype(np.uint8)\r\n  x = np.expand_dims(x, axis=0)\r\n  xsl = list (x.shape)\r\n  xsl[0] = batch_size#MAX_BATCH_SIZE\r\n  x = np.broadcast_to(x[0,:,:,:], xsl)\r\n  return x\r\n\r\ndef run_resnet_50():\r\n    # Create graph\r\n    inputs = tf.placeholder(tf.float32, shape=[BATCH_SIZE, HEIGHT, WIDTH, CHANNELS])\r\n    with slim.arg_scope(resnet_v1.resnet_arg_scope()):\r\n            net, end_points = resnet_v1.resnet_v1_50(inputs, is_training=False)\r\n\r\n    saver = tf.train.Saver()\r\n\r\n    with tf.Session() as sess:\r\n            saver.restore(sess, PATH_TO_CKPT)\r\n            representation_tensor = sess.graph.get_tensor_by_name('resnet_v1_50/pool5:0') # if you don't know names like these, consider referring to corresponding model file or generate .pbtxt file as mentioned in  @civilman628 's answer above\r\n            img = np.ones((batch_size, height, width, channels))   #load image here with size [1, 224,224, 3]\r\n            features = sess.run(representation_tensor, {'Placeholder:0': img})\r\n            print ( \"features\", features)\r\n\r\ndef renamed_ckpt_save(name):\r\n    with tf.Session() as sess:# Restore the TF checkpoint\r\n\r\n        for var_name, var_shape in tf.contrib.framework.list_variables(PATH_TO_CKPT):\r\n            var = tf.contrib.framework.load_variable(PATH_TO_CKPT, var_name)\r\n            new_name_parts = [name] + var_name.split('/')[1:]\r\n            new_name = '/'.join(new_name_parts)\r\n            var = tf.Variable(var, name=new_name)\r\n            print var_name, var_shape, var.name\r\n\r\n        ckpt_dir = \"/tmp/\"+name\r\n        if not os.path.exists(ckpt_dir):\r\n            os.mkdir(ckpt_dir)\r\n        sess.run(tf.global_variables_initializer())\r\n        saver = tf.train.Saver()\r\n        saver.save(sess, ckpt_dir)\r\n\r\ndef renamed_ckpt_mem(sess, name):\r\n\r\n        for var_name, var_shape in tf.contrib.framework.list_variables(PATH_TO_CKPT):\r\n            var = tf.contrib.framework.load_variable(PATH_TO_CKPT, var_name)\r\n            new_name_parts = [name] + var_name.split('/')[1:]\r\n            new_name = '/'.join(new_name_parts)\r\n            var = tf.Variable(var, name=new_name)\r\n            print var_name, var_shape, var.name\r\n\r\ndef build_graph_xla (inputs):\r\n\r\n    with slim.arg_scope(resnet_v1.resnet_arg_scope()):\r\n            net, end_points = resnet_v1.resnet_v1_50(inputs, is_training=False, scope=name)\r\n\r\n    if True: #with input_graph.as_default():\r\n      # Get handles to input and output tensors\r\n      ops = tf.get_default_graph().get_operations()\r\n      all_tensor_names = {output.name for op in ops for output in op.outputs}\r\n      tensor_dict = {}\r\n      for key in [\r\n          'pool5',\r\n      ]:\r\n        if name == '':\r\n            tensor_name = key + ':0'\r\n        else :\r\n            tensor_name = name+'/'+key + ':0'\r\n        if tensor_name in all_tensor_names:\r\n                tensor_dict[key] = tf.get_default_graph().get_tensor_by_name(\r\n                tensor_name)\r\n                print ( \"tensor_name\", tensor_name, tensor_dict[key])\r\n        else:\r\n           print( \"tensor_name \", tensor_name, \" not found\")\r\n\r\n    return tensor_dict\r\n\r\ndef restore_graph_xla (sess, name):\r\n    # Restore the TF checkpoint\r\n    saver = tf.train.Saver()\r\n    saver.restore(sess, \"/tmp/\"+name)\r\n\r\ndef build_graph (sess, input_graph, name='graph1'):\r\n\r\n    inputs = tf.placeholder(tf.float32, shape=[BATCH_SIZE, HEIGHT, WIDTH, CHANNELS])\r\n\r\n    with slim.arg_scope(resnet_v1.resnet_arg_scope()):\r\n            net, end_points = resnet_v1.resnet_v1_50(inputs, is_training=False, scope=name)\r\n\r\n    with input_graph.as_default():\r\n      # Get handles to input and output tensors\r\n      ops = tf.get_default_graph().get_operations()\r\n      all_tensor_names = {output.name for op in ops for output in op.outputs}\r\n      tensor_dict = {}\r\n      for key in [\r\n          'pool5',\r\n      ]:\r\n        if name == '':\r\n            tensor_name = key + ':0'\r\n        else :\r\n            tensor_name = name+'/'+key + ':0'\r\n        if tensor_name in all_tensor_names:\r\n                tensor_dict[key] = tf.get_default_graph().get_tensor_by_name(\r\n                tensor_name)\r\n                print ( \"tensor_name\", tensor_name, tensor_dict[key])\r\n        else:\r\n           print( \"tensor_name \", tensor_name, \" not found\")\r\n\r\n\r\n    # Restore the TF checkpoint\r\n    saver = tf.train.Saver()\r\n    saver.restore(sess, \"/tmp/\"+name)\r\n    return tensor_dict\r\n\r\nclass TfXla():\r\n    name = ''\r\n\r\n    @staticmethod\r\n    def build_graph_xla (inputs):\r\n\r\n        with slim.arg_scope(resnet_v1.resnet_arg_scope()):\r\n                net, end_points = resnet_v1.resnet_v1_50(inputs, is_training=False, scope=TfXla.name)\r\n\r\n        if True: #with input_graph.as_default():\r\n          # Get handles to input and output tensors\r\n          ops = tf.get_default_graph().get_operations()\r\n          all_tensor_names = {output.name for op in ops for output in op.outputs}\r\n          tensor_dict = {}\r\n          for key in [\r\n              'pool5',\r\n          ]:\r\n            if TfXla.name == '':\r\n                tensor_name = key + ':0'\r\n            else :\r\n                tensor_name = TfXla.name+'/'+key + ':0'\r\n            if tensor_name in all_tensor_names:\r\n                    tensor_dict[key] = tf.get_default_graph().get_tensor_by_name(\r\n                    tensor_name)\r\n                    print ( \"tensor_name\", tensor_name, tensor_dict[key])\r\n            else:\r\n               print( \"tensor_name \", tensor_name, \" not found\")\r\n\r\n        return tensor_dict\r\n\r\n    @staticmethod\r\n    def restore_graph_xla (sess, name):\r\n        # Restore the TF checkpoint\r\n        saver = tf.train.Saver()\r\n        saver.restore(sess, \"/tmp/\"+name)\r\n\r\n    @staticmethod\r\n    def build(sess, input_graph, name='', import_name='import'):\r\n        TfXla.name = name\r\n        with input_graph.as_default():\r\n            inputs = tf.placeholder(tf.float32, shape=[BATCH_SIZE, HEIGHT, WIDTH, CHANNELS])\r\n            tensor_dict = xla.compile (TfXla.build_graph_xla, [inputs,])\r\n            restore_graph_xla(sess, name)\r\n        return tensor_dict\r\n\r\n    @staticmethod\r\n    def run(sess, tensor_dict, image_tensor, image_np_expanded):\r\n        output_dict = sess.run(tensor_dict, feed_dict={image_tensor: image_np_expanded})\r\n        return output_dict\r\n\r\nclass Tf():\r\n\r\n    @staticmethod\r\n    def build(sess, graph, name='', import_name=None):\r\n        return build_graph(sess, graph, name=name)\r\n\r\n    @staticmethod\r\n    def run(sess, tensor_dict, image_tensor, image_np_expanded):\r\n        output_dict = sess.run(tensor_dict, feed_dict={image_tensor: image_np_expanded})\r\n        return output_dict\r\ndef run (runtime='TF', amp=False):\r\n\r\n    if runtime=='TF':\r\n        RunClass = Tf\r\n        import_name1= ''\r\n        import_name2= ''\r\n        placeholder_name1 = 'Placeholder:0'\r\n        placeholder_name2 = 'Placeholder_1:0'\r\n    elif runtime=='TFXLACOMP':\r\n        print (\"Setting XLA compile\")\r\n        RunClass = TfXla\r\n        #import_name1 = 'import1'\r\n        #import_name2 = 'import2'\r\n        #placeholder_name1 = 'import1/Placeholder:0'\r\n        #placeholder_name2 = 'import2/Placeholder_1:0'\r\n        import_name1= ''\r\n        import_name2= ''\r\n        placeholder_name1 = 'Placeholder:0'\r\n        placeholder_name2 = 'Placeholder_1:0'\r\n    elif runtime=='TFXLA':\r\n        os.environ['TF_XLA_FLAGS'] = \"--tf_xla_auto_jit=2\"\r\n        print (\"Setting XLA auto clustering\")\r\n        RunClass = Tf\r\n        #import_name1 = 'import1'\r\n        #import_name2 = 'import2'\r\n        #placeholder_name1 = 'import1/Placeholder:0'\r\n        #placeholder_name2 = 'import2/Placeholder_1:0'\r\n        import_name1= ''\r\n        import_name2= ''\r\n        placeholder_name1 = 'Placeholder:0'\r\n        placeholder_name2 = 'Placeholder_1:0'\r\n\r\n    graph = tf.Graph()\r\n\r\n    config = tf.ConfigProto()\r\n    config.gpu_options.allow_growth = True\r\n    #config.gpu_options.per_process_gpu_memory_fraction = 0.33\r\n    if amp:\r\n        config.graph_options.rewrite_options.auto_mixed_precision = 1\r\n        print \"Enabling AMP\"\r\n    with tf.Session(graph=graph, config=config) as sess:\r\n        #renamed_ckpt_mem(sess, 'resnet_v1_50_1')\r\n        #renamed_ckpt_mem(sess, 'resnet_v1_50_2')\r\n        tensor_dict1 = RunClass.build(sess, graph, name='resnet_v1_50_1', import_name=import_name1)\r\n        #tensor_dict2 = tensor_dict1 RunClass.build(sess, graph, name='resnet_v1_50_2', import_name=import_name2)\r\n        tensorboard_dir = os.environ['TENSORBOARD_DIR']\r\n        file_writer = tf.summary.FileWriter(tensorboard_dir, sess.graph)\r\n        image_path = TEST_IMAGE_PATHS[0]\r\n        print ( \"image_path {}\".format(image_path))\r\n        image = Image.open(image_path)\r\n        image = image.resize((WIDTH, HEIGHT))\r\n        image_np_expanded = load_image_into_numpy_array(image, batch_size=BATCH_SIZE)\r\n        image_tensor1 = graph.get_tensor_by_name(placeholder_name1)\r\n        #image_tensor2 = graph.get_tensor_by_name(placeholder_name2)\r\n        time0 = time.time()\r\n        for i in range(1,2001):\r\n            output_dict1 = RunClass.run(sess, tensor_dict1, image_tensor1, image_np_expanded)\r\n            #output_dict2 = RunClass.run(sess, tensor_dict2, image_tensor2, image_np_expanded)\r\n            if i % 100 == 0:\r\n                time_taken = (time.time() - time0 )/(i * 1.0)\r\n                print (i, time_taken)\r\n        time_taken = (time.time() - time0 )/(i * 1.0)\r\n        print (\"time_taken pb \", time_taken, \" pf \", time_taken/BATCH_SIZE , \"output_dict\", output_dict1, 'output_dict2')\r\n\r\nif __name__ == '__main__':\r\n    parser = argparse.ArgumentParser()\r\n    parser.add_argument('--runtime', default='TF', help='TF or TFXLA or TFXLACOMP')\r\n    parser.add_argument('--amp', action='store_true', help='enable AMP')\r\n    parser.add_argument('--rewrite_ckpt', action='store_true',  help='rename checkpoints')\r\n    args = parser.parse_args()\r\n    if args.rewrite_ckpt:\r\n        renamed_ckpt_save('resnet_v1_50_1')\r\n        renamed_ckpt_save('resnet_v1_50_2')\r\n\r\n    run (args.runtime, args.amp)\r\n\r\n\r\n```\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32268", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32268/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32268/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32268/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32268", "id": 490071893, "node_id": "MDU6SXNzdWU0OTAwNzE4OTM=", "number": 32268, "title": "TF.Keras model creation results in different output node when eager is enabled or not", "user": {"login": "vade", "id": 65011, "node_id": "MDQ6VXNlcjY1MDEx", "avatar_url": "https://avatars1.githubusercontent.com/u/65011?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vade", "html_url": "https://github.com/vade", "followers_url": "https://api.github.com/users/vade/followers", "following_url": "https://api.github.com/users/vade/following{/other_user}", "gists_url": "https://api.github.com/users/vade/gists{/gist_id}", "starred_url": "https://api.github.com/users/vade/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vade/subscriptions", "organizations_url": "https://api.github.com/users/vade/orgs", "repos_url": "https://api.github.com/users/vade/repos", "events_url": "https://api.github.com/users/vade/events{/privacy}", "received_events_url": "https://api.github.com/users/vade/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-09-06T00:29:30Z", "updated_at": "2019-09-10T21:39:22Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Google Collab\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): No\r\n- TensorFlow version (use command below):Google Collab default runtime / Tensorflow 1.14.0\r\ntf.keras 2.2.4-tf\r\n- Python version:Google Collab default runtime: 3.6.8 (default, Jan 14 2019, 11:02:34)\r\n[GCC 8.0.1 20180414 (experimental) [trunk revision 259383]]\r\n\r\n**Describe the current behavior**\r\n\r\nbuilding a tf.keras sequence model when eager mode is enabled vs not results in different output nodes.\r\n\r\n**Describe the expected behavior**\r\n\r\nGraph execution does not effect graph construction, the model should be the same.\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\nWith eager enabled:\r\n```\r\n# load tensorflow\r\nfrom __future__ import absolute_import, division, print_function, unicode_literals\r\nimport tensorflow as tf\r\nimport numpy as np\r\nprint(tf.__version__)\r\nAUTOTUNE = tf.data.experimental.AUTOTUNE\r\n#enable eager\r\ntf.enable_eager_execution()\r\nassert tf.multiply(6, 7).numpy() == 42\r\nprint(\"Eager execution: {}\".format(tf.executing_eagerly()))\r\n\r\n# build our model and print its outputs and summary\r\nbase_model = tf.keras.applications.NASNetMobile(input_shape=(IMG_SIZE, IMG_SIZE, 3),\r\n                                               include_top=False,\r\n                                               weights='imagenet')\r\nbase_model.trainable = False\r\noutput = tf.keras.layers.Dense(num_labels, activation = 'sigmoid', name=\"cinemanet_output\", input_shape=(None, 1056))\r\n\r\nmodel = tf.keras.Sequential([\r\n  base_model,\r\n  tf.keras.layers.GlobalAveragePooling2D(),\r\n  output])\r\nmodel.summary()\r\nprint(model.input.op.name)\r\nprint(model.output.op.name)\r\n```\r\n\r\nResults in:\r\n\r\n```\r\nModel: \"sequential\"\r\n_________________________________________________________________\r\nLayer (type)                 Output Shape              Param #   \r\n=================================================================\r\nNASNet (Model)               (None, 7, 7, 1056)        4269716   \r\n_________________________________________________________________\r\nglobal_average_pooling2d (Gl (None, 1056)              0         \r\n_________________________________________________________________\r\ncinemanet_output (Dense)     (None, 229)               242053    \r\n=================================================================\r\nTotal params: 4,511,769\r\nTrainable params: 242,053\r\nNon-trainable params: 4,269,716\r\n_________________________________________________________________\r\nNASNet_input\r\ncinemanet_output/Identity\r\n```\r\n\r\nWithout Eager:\r\n\r\n```\r\nModel: \"sequential\"\r\n_________________________________________________________________\r\nLayer (type)                 Output Shape              Param #   \r\n=================================================================\r\nNASNet (Model)               (None, 7, 7, 1056)        4269716   \r\n_________________________________________________________________\r\nglobal_average_pooling2d (Gl (None, 1056)              0         \r\n_________________________________________________________________\r\ncinemanet_output (Dense)     (None, 229)               242053    \r\n=================================================================\r\nTotal params: 4,511,769\r\nTrainable params: 242,053\r\nNon-trainable params: 4,269,716\r\n_________________________________________________________________\r\nNASNet_input\r\ncinemanet_output/Sigmoid\r\n```\r\n\r\nWhich results in a model with no output when saved to pb.\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32255", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32255/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32255/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32255/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32255", "id": 489969332, "node_id": "MDU6SXNzdWU0ODk5NjkzMzI=", "number": 32255, "title": "TPU with tensorflow 2.0 -- 'DeleteIterator' OpKernel missing", "user": {"login": "youngalou", "id": 25014968, "node_id": "MDQ6VXNlcjI1MDE0OTY4", "avatar_url": "https://avatars3.githubusercontent.com/u/25014968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/youngalou", "html_url": "https://github.com/youngalou", "followers_url": "https://api.github.com/users/youngalou/followers", "following_url": "https://api.github.com/users/youngalou/following{/other_user}", "gists_url": "https://api.github.com/users/youngalou/gists{/gist_id}", "starred_url": "https://api.github.com/users/youngalou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/youngalou/subscriptions", "organizations_url": "https://api.github.com/users/youngalou/orgs", "repos_url": "https://api.github.com/users/youngalou/repos", "events_url": "https://api.github.com/users/youngalou/events{/privacy}", "received_events_url": "https://api.github.com/users/youngalou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 1097541661, "node_id": "MDU6TGFiZWwxMDk3NTQxNjYx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tpus", "name": "comp:tpus", "color": "0052cc", "default": false, "description": "tpu, tpuestimator"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 14, "created_at": "2019-09-05T19:55:03Z", "updated_at": "2019-10-08T20:30:01Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): YES\r\n- OS Platform and Distribution: Debian GNU/Linux 9\r\n- TensorFlow installed from (source or binary): /usr/bin/pip3\r\n- TensorFlow version (use command below): 2.0.0b1\r\n- Python version: 3.5.3\r\n- TPU type: v2-8\r\n- TPU software version: 1.14 \r\n\r\n**Describe the current behavior**\r\nI am running a TPU allocated by `ctpu up` in tensorflow 2.0 (I'm aware this isn't fully supported atm). I have a simple training loop functioning mostly following the guidelines here:\r\nhttps://www.tensorflow.org/beta/guide/distribute_strategy#using_tfdistributestrategy_with_custom_training_loops\r\n\r\nTo my surprise I have encountered few issues along the way, but one that I can't seem to remedy on my end is this:\r\n`tensorflow.python.framework.errors_impl.NotFoundError: No registered 'DeleteIterator' OpKernel for TPU devices compatible with node {{node DeleteIterator}}`\r\n\r\nThis error doesn't seem to actually break anything, but I'm worried there could be a TPU memory leak or something and that is difficult to verify without any useable TPU profiling tools for TF 2.0.\r\nEDIT: The bug does actually cause the program to crash after a few iterations.\r\n\r\n**Describe the expected behavior**\r\nI expect to be able to delete the iterator object within the TPU strategy scope.\r\n\r\n**Code to reproduce the issue**\r\n```\r\nfor epoch in range(self.train_epochs):\r\n    with tf.device(self.device), self.distribution_strategy.scope():\r\n        dataset = self.fill_experience_buffer()\r\n        exp_buff = iter(dataset)\r\n\r\n        for step in tqdm(range(self.train_steps), \"Training epoch {}\".format(epoch)):\r\n            train_step(next(exp_buff))\r\n```\r\n\r\nThe issue occurs the second time around in the loop when the `exp_buff` variable is rewritten with `iter(dataset)`. I've tried explicitly freeing the object with 'del exp_buff' within and outside of the scope():, but the same error occurs regardless.\r\n\r\n**Other info / logs**\r\nFull error message here (the message appears 8 times, once for each TPU device, but the messages are identical:\r\n```\r\nException ignored in: <bound method IteratorResourceDeleter.__del__ of <tensorflow.python.data.ops.iterator_ops.IteratorResourceDeleter object at 0x7f0bac1883c8>>\r\nTraceback (most recent call last):\r\n  File \"/home/youngalou/.local/lib/python3.5/site-packages/tensorflow/python/data/ops/iterator_ops.py\", line 531, in __del__\r\n    handle=self._handle, deleter=self._deleter)\r\n  File \"/home/youngalou/.local/lib/python3.5/site-packages/tensorflow/python/ops/gen_dataset_ops.py\", line 800, in delete_iterator\r\n    _six.raise_from(_core._status_to_exception(e.code, message), None)\r\n  File \"<string>\", line 3, in raise_from\r\ntensorflow.python.framework.errors_impl.NotFoundError: No registered 'DeleteIterator' OpKernel for TPU devices compatible with node {{node DeleteIterator}}\r\n        .  Registered:  device='CPU'\r\n  device='GPU'\r\n\r\nAdditional GRPC error information:\r\n{\"created\":\"@1567559533.240191338\",\"description\":\"Error received from peer\",\"file\":\"external/grpc/src/core/lib/surface/call.cc\",\"file_line\":1039,\"grpc_message\":\"No registered 'DeleteIterator' OpKernel for TPU devices compatible with node {{node DeleteIterator}}\\n\\t.  Registered:  device='CPU'\\n  device='GPU'\\n\",\"grpc_status\":5} [Op:DeleteIterator]\r\nException ignored in: <bound method IteratorResourceDeleter.__del__ of <tensorflow.python.data.ops.iterator_ops.IteratorResourceDeleter object at 0x7f0bac188518>>\r\nTraceback (most recent call last):\r\n  File \"/home/youngalou/.local/lib/python3.5/site-packages/tensorflow/python/data/ops/iterator_ops.py\", line 531, in __del__\r\n    handle=self._handle, deleter=self._deleter)\r\n  File \"/home/youngalou/.local/lib/python3.5/site-packages/tensorflow/python/ops/gen_dataset_ops.py\", line 800, in delete_iterator\r\n    _six.raise_from(_core._status_to_exception(e.code, message), None)\r\n  File \"<string>\", line 3, in raise_from\r\ntensorflow.python.framework.errors_impl.NotFoundError: No registered 'DeleteIterator' OpKernel for TPU devices compatible with node {{node DeleteIterator}}\r\n        .  Registered:  device='CPU'\r\n  device='GPU'\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32248", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32248/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32248/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32248/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32248", "id": 489891981, "node_id": "MDU6SXNzdWU0ODk4OTE5ODE=", "number": 32248, "title": "Performance regression in sparse_dense_matmul", "user": {"login": "pavanky", "id": 364829, "node_id": "MDQ6VXNlcjM2NDgyOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/364829?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavanky", "html_url": "https://github.com/pavanky", "followers_url": "https://api.github.com/users/pavanky/followers", "following_url": "https://api.github.com/users/pavanky/following{/other_user}", "gists_url": "https://api.github.com/users/pavanky/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavanky/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavanky/subscriptions", "organizations_url": "https://api.github.com/users/pavanky/orgs", "repos_url": "https://api.github.com/users/pavanky/repos", "events_url": "https://api.github.com/users/pavanky/events{/privacy}", "received_events_url": "https://api.github.com/users/pavanky/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "ezhulenev", "id": 1174378, "node_id": "MDQ6VXNlcjExNzQzNzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/1174378?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezhulenev", "html_url": "https://github.com/ezhulenev", "followers_url": "https://api.github.com/users/ezhulenev/followers", "following_url": "https://api.github.com/users/ezhulenev/following{/other_user}", "gists_url": "https://api.github.com/users/ezhulenev/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezhulenev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezhulenev/subscriptions", "organizations_url": "https://api.github.com/users/ezhulenev/orgs", "repos_url": "https://api.github.com/users/ezhulenev/repos", "events_url": "https://api.github.com/users/ezhulenev/events{/privacy}", "received_events_url": "https://api.github.com/users/ezhulenev/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ezhulenev", "id": 1174378, "node_id": "MDQ6VXNlcjExNzQzNzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/1174378?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezhulenev", "html_url": "https://github.com/ezhulenev", "followers_url": "https://api.github.com/users/ezhulenev/followers", "following_url": "https://api.github.com/users/ezhulenev/following{/other_user}", "gists_url": "https://api.github.com/users/ezhulenev/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezhulenev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezhulenev/subscriptions", "organizations_url": "https://api.github.com/users/ezhulenev/orgs", "repos_url": "https://api.github.com/users/ezhulenev/repos", "events_url": "https://api.github.com/users/ezhulenev/events{/privacy}", "received_events_url": "https://api.github.com/users/ezhulenev/received_events", "type": "User", "site_admin": false}, {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2019-09-05T17:07:10Z", "updated_at": "2019-12-03T09:26:23Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\nYes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\nUbuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\nNo\r\n- TensorFlow installed from (source or binary):\r\nbinary\r\n- TensorFlow version (use command below):\r\n1.14.0\r\n- Python version:\r\n3.7\r\n\r\n**Describe the current behavior**\r\n\r\nPerformance of `sparse_dense_matmul` is significantly slower compared to 1.12\r\n \r\n**Describe the expected behavior**\r\n\r\nPerformance does not degrade between versions. If there is a regression, it should be included in the release notes.\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport os\r\nimport time\r\n\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\n\r\ndef create_sparse_tensor(batch_size, num_features, num_samples):\r\n  total_samples = num_samples * batch_size\r\n  batch_indices = np.sort(np.random.randint(0, batch_size, total_samples))\r\n  feature_indices = np.random.randint(0, num_features, total_samples)\r\n  indices = np.stack([batch_indices, feature_indices], axis=1)\r\n  values = np.random.random(total_samples).astype(np.float32)\r\n  return tf.SparseTensorValue(indices=indices, values=values,\r\n                              dense_shape=[batch_size, num_features])\r\n\r\n\r\ndef bench(batch_size=32, num_bits=18, num_samples=1000, num_runs=2000):\r\n  num_features = 1 << num_bits\r\n  experiment = (\"batch_size_%d_num_bits_%d\" % (batch_size, num_bits))\r\n  sparse_input = tf.sparse_placeholder(dtype=tf.float32,\r\n                                       shape=(batch_size, num_features),\r\n                                       name=\"sparse_input_\" + experiment)\r\n  dense_weight = tf.get_variable(name=\"dense_weight_\" + experiment,\r\n                                 shape=(num_features, 50),\r\n                                 dtype=tf.float32)\r\n\r\n  output_sparse = tf.sparse_tensor_dense_matmul(sparse_input, dense_weight)\r\n\r\n  with tf.Session() as sess:\r\n    print(experiment)\r\n    sparse_input_values = [\r\n      create_sparse_tensor(batch_size, num_features, num_samples)\r\n      for n in range(num_runs)\r\n    ]\r\n\r\n    sess.run(tf.initializers.global_variables())\r\n\r\n    start = time.time()\r\n    for n in range(num_runs):\r\n      sess.run(output_sparse, feed_dict={sparse_input: sparse_input_values[n]})\r\n    elapsed = time.time() - start\r\n    print(\"Avg time taken for sparse_matmul: %.4f\" % (elapsed / num_runs))\r\n\r\nif __name__ == \"__main__\":\r\n  tf.logging.set_verbosity(tf.logging.ERROR)\r\n  os.environ['TF_CPP_MIN_LOG_LEVEL'] = '3'\r\n  print(\"--------------------\")\r\n  print(tf.__version__)\r\n  print(\"--------------------\")\r\n  for b in [4, 16, 32]:\r\n    for n in [18, 22]:\r\n      bench(batch_size=b, num_bits=n)\r\n  print(\"--------------------\")\r\n```\r\n**Other info / logs**\r\n```\r\n--------------------\r\n1.14.0\r\n--------------------\r\nbatch_size_4_num_bits_18\r\nAvg time taken for sparse_matmul: 0.0015\r\nbatch_size_4_num_bits_22\r\nAvg time taken for sparse_matmul: 0.0020\r\nbatch_size_16_num_bits_18\r\nAvg time taken for sparse_matmul: 0.0049\r\nbatch_size_16_num_bits_22\r\nAvg time taken for sparse_matmul: 0.0072\r\nbatch_size_32_num_bits_18\r\nAvg time taken for sparse_matmul: 0.0100\r\nbatch_size_32_num_bits_22\r\nAvg time taken for sparse_matmul: 0.0117\r\n--------------------\r\n--------------------\r\n1.12.0\r\n--------------------\r\nbatch_size_4_num_bits_18\r\nAvg time taken for sparse_matmul: 0.0009\r\nbatch_size_4_num_bits_22\r\nAvg time taken for sparse_matmul: 0.0012\r\nbatch_size_16_num_bits_18\r\nAvg time taken for sparse_matmul: 0.0027\r\nbatch_size_16_num_bits_22\r\nAvg time taken for sparse_matmul: 0.0035\r\nbatch_size_32_num_bits_18\r\nAvg time taken for sparse_matmul: 0.0048\r\nbatch_size_32_num_bits_22\r\nAvg time taken for sparse_matmul: 0.0064\r\n--------------------\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32244", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32244/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32244/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32244/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32244", "id": 489863833, "node_id": "MDU6SXNzdWU0ODk4NjM4MzM=", "number": 32244, "title": "Please modify cuda-bin in cuda_configure.bzl to copy just needed files instead of directory", "user": {"login": "skeydan", "id": 469371, "node_id": "MDQ6VXNlcjQ2OTM3MQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/469371?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skeydan", "html_url": "https://github.com/skeydan", "followers_url": "https://api.github.com/users/skeydan/followers", "following_url": "https://api.github.com/users/skeydan/following{/other_user}", "gists_url": "https://api.github.com/users/skeydan/gists{/gist_id}", "starred_url": "https://api.github.com/users/skeydan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skeydan/subscriptions", "organizations_url": "https://api.github.com/users/skeydan/orgs", "repos_url": "https://api.github.com/users/skeydan/repos", "events_url": "https://api.github.com/users/skeydan/events{/privacy}", "received_events_url": "https://api.github.com/users/skeydan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-09-05T16:15:42Z", "updated_at": "2019-09-26T12:59:15Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Fedora 30\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version: master branch \r\n- Python version: 3.7\r\n- Installed using virtualenv? pip? conda?: N/A\r\n- Bazel version (if compiling from source): 0.25.2\r\n- GCC/Compiler version (if compiling from source): 7.4.1\r\n- CUDA/cuDNN version: 10.1 / 7.6\r\n- GPU model and memory: Quadro M2200\r\n\r\nIf you don't have CUDA installed in `/usr/local/cuda`, but in the \"normal RPM way\" (so that binaries end up in `/usr/bin`, libraries in `/usr/lib64` etc), the following `cuda-bin` rule\r\n\r\n```\r\n# in third_party/gpus/cuda_configure.bzl\r\ncopy_rules.append(make_copy_dir_rule(\r\n    repository_ctx,\r\n    name = \"cuda-bin\",\r\n    src_dir = cuda_config.cuda_toolkit_path + \"/bin\",\r\n    out_dir = \"cuda/bin\",\r\n))\r\n```\r\n\r\nwill end up trying to copy all the binaries in `/usr/bin`, which on some systems (where these commands are not other-readable) may lead to errors like this one:\r\n\r\n```\r\nERROR: /home/key/.cache/bazel/_bazel_key/8de93c72df6c3fec3e289f10fadff72b/external/local_config_cuda/cuda/BUILD:1399:1: Executing genrule @local_config_cuda//cuda:cuda-bin failed (Exit 1)\r\ncp: cannot open '/usr/bin/./sudoedit' for reading: Permission denied\r\ncp: cannot open '/usr/bin/./locate' for reading: Permission denied\r\ncp: cannot open '/usr/bin/./sudo' for reading: Permission denied\r\ncp: cannot open '/usr/bin/./sudoreplay' for reading: Permission denied\r\ncp: cannot open '/usr/bin/./chsh' for reading: Permission denied\r\ncp: cannot open '/usr/bin/./chfn' for reading: Permission denied\r\n\r\n```\r\n\r\nEvidently these files should in fact not be copied ... looking for what binaries really are wanted, I found this:\r\n\r\n```\r\n# in nccl/build_defs.bzl.tpl\r\n_device_link = rule(\r\n    implementation = _device_link_impl,\r\n    attrs = {\r\n        \"deps\": attr.label_list(),\r\n        \"out\": attr.output(mandatory = True),\r\n        \"gpu_archs\": attr.string_list(),\r\n        \"nvlink_args\": attr.string_list(),\r\n        \"_nvlink\": attr.label(\r\n            default = Label(\"@local_config_cuda//cuda:cuda/bin/nvlink\"),\r\n            allow_single_file = True,\r\n            executable = True,\r\n            cfg = \"host\",\r\n        ),\r\n        \"_fatbinary\": attr.label(\r\n            default = Label(\"@local_config_cuda//cuda:cuda/bin/fatbinary\"),\r\n            allow_single_file = True,\r\n            executable = True,\r\n            cfg = \"host\",\r\n        ),\r\n        \"_bin2c\": attr.label(\r\n            default = Label(\"@local_config_cuda//cuda:cuda/bin/bin2c\"),\r\n            allow_single_file = True,\r\n            executable = True,\r\n            cfg = \"host\",\r\n        ),\r\n        \"_link_stub\": attr.label(\r\n            default = Label(\"@local_config_cuda//cuda:cuda/bin/crt/link.stub\"),\r\n            allow_single_file = True,\r\n        ),\r\n    },\r\n```\r\n\r\nIn fact when I hard-code these 4 files, modifying the `cuda-bin` rule like this\r\n\r\n```\r\ncopy_rules.append(make_copy_files_rule(\r\n         repository_ctx,\r\n         name = \"cuda-bin\",\r\n         srcs = [\r\n            cuda_config.cuda_toolkit_path + \"/bin/\" + \"crt/link.stub\",\r\n            cuda_config.cuda_toolkit_path + \"/bin/\" + \"nvlink\",\r\n            cuda_config.cuda_toolkit_path + \"/bin/\" + \"fatbinary\",\r\n            cuda_config.cuda_toolkit_path + \"/bin/\" + \"bin2c\"\r\n        ],\r\n        outs = [\r\n            \"cuda/bin/\" + \"crt/link.stub\",\r\n            \"cuda/bin/\" + \"nvlink\",\r\n            \"cuda/bin/\" + \"fatbinary\",\r\n            \"cuda/bin/\" + \"bin2c\"\r\n        ],\r\n     ))\r\n```\r\n\r\nall works great.\r\n\r\nWould you be interested in adapting the build rule accordingly? Not only would it not fail, it'd be also cleaner not to try to copy files like `sudo` :-)\r\n\r\nI'd be happy to submit a PR but would probably need some guidance (assuming you don't want the file names hard coded as I'm doing for my workaround). Thanks!\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32243", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32243/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32243/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32243/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32243", "id": 489844595, "node_id": "MDU6SXNzdWU0ODk4NDQ1OTU=", "number": 32243, "title": "SpatialDropout2D", "user": {"login": "tonyreina", "id": 37851530, "node_id": "MDQ6VXNlcjM3ODUxNTMw", "avatar_url": "https://avatars3.githubusercontent.com/u/37851530?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tonyreina", "html_url": "https://github.com/tonyreina", "followers_url": "https://api.github.com/users/tonyreina/followers", "following_url": "https://api.github.com/users/tonyreina/following{/other_user}", "gists_url": "https://api.github.com/users/tonyreina/gists{/gist_id}", "starred_url": "https://api.github.com/users/tonyreina/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tonyreina/subscriptions", "organizations_url": "https://api.github.com/users/tonyreina/orgs", "repos_url": "https://api.github.com/users/tonyreina/repos", "events_url": "https://api.github.com/users/tonyreina/events{/privacy}", "received_events_url": "https://api.github.com/users/tonyreina/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-09-05T15:39:50Z", "updated_at": "2019-10-30T06:27:46Z", "closed_at": null, "author_association": "NONE", "body": "\r\n**System information**\r\n- TensorFlow version (you are using): 1.11\r\n- Are you willing to contribute it (Yes/No): No\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\nSpatialDropout2D is often used in CNNs (https://www.tensorflow.org/api_docs/python/tf/keras/layers/SpatialDropout2D).  At inference time, the layer should be treated just like a regular dropout layer where it just scales the coefficients by the dropout term. However, when I take a Keras model with SpatialDropout2D and saved it as a TF protobuf, TensorFlow converts SpatialDropout2D into a set of primitive operators to do the random dropout instead-- even for a TensorFlow serving graph where the model has been frozen and optimized for inference.  \r\n\r\n**Will this change the current api? How?**\r\n\r\nI'd like to see the SpatialDropout layers behave the same as the regular Dropout layers during inference.  So the TensorFlow Serving protobuf should not include SpatialDropout2D (or any set of random/slice ops to reconstruct it), but instead should just scale the convolutional filters by the dropout rate as explained in the original paper (https://arxiv.org/abs/1411.4280).\r\n\r\n**Who will benefit with this feature?**\r\n\r\nIf the SpatialDropout layers behave the same as the regular Dropout layers, it will reduce the number of operations during inference and speed up inference on these graphs.\r\n\r\n**Any Other info.**\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32242", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32242/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32242/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32242/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32242", "id": 489841925, "node_id": "MDU6SXNzdWU0ODk4NDE5MjU=", "number": 32242, "title": "[TF2.0] Checkpoint doesn't store non-TF objects", "user": {"login": "awav", "id": 24483645, "node_id": "MDQ6VXNlcjI0NDgzNjQ1", "avatar_url": "https://avatars0.githubusercontent.com/u/24483645?v=4", "gravatar_id": "", "url": "https://api.github.com/users/awav", "html_url": "https://github.com/awav", "followers_url": "https://api.github.com/users/awav/followers", "following_url": "https://api.github.com/users/awav/following{/other_user}", "gists_url": "https://api.github.com/users/awav/gists{/gist_id}", "starred_url": "https://api.github.com/users/awav/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/awav/subscriptions", "organizations_url": "https://api.github.com/users/awav/orgs", "repos_url": "https://api.github.com/users/awav/repos", "events_url": "https://api.github.com/users/awav/events{/privacy}", "received_events_url": "https://api.github.com/users/awav/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2019-09-05T15:35:11Z", "updated_at": "2019-10-02T06:26:10Z", "closed_at": null, "author_association": "NONE", "body": "Hello all,\r\n\r\nI found that `tf.train.Checkpoint` doesn't save non-TF objects and tf.Tensors. The MWE below shows the case:\r\n\r\n```python\r\nimport tensorflow as tf\r\n\r\nclass A(tf.Module):\r\n    def __init__(self):\r\n        super().__init__()\r\n        self.scalar = 1.\r\n        self.variable = tf.Variable(1.)\r\n        self.tensor = tf.convert_to_tensor(1.)\r\n        self.list = [tf.convert_to_tensor(10.0), 20.0, tf.Variable(0.0)]\r\n\r\n    def __str__(self):\r\n        return f\"scalar={self.scalar}, variable={self.variable.numpy()}, tensor={self.tensor}, list={self.list}\"\r\n\r\n\r\na_module = A()\r\ncheckpoint = tf.train.Checkpoint(a=a_module)\r\nmanager = tf.train.CheckpointManager(checkpoint, '/tmp/example', max_to_keep=3)\r\nmanager.save()\r\n\r\nprint(f\"1. {a_module}\")\r\n\r\n#### modify\r\n\r\na_module.scalar = -100.\r\na_module.variable.assign(123.)\r\na_module.tensor = tf.convert_to_tensor(-12.)\r\na_module.list = [3., 3.]\r\n\r\nprint(f\"2. {a_module}\")\r\n\r\n#### restore\r\ncheckpoint.restore(manager.latest_checkpoint)\r\n\r\nprint(f\"3. {a_module}\")\r\n```\r\n\r\nOutput:\r\n```python\r\n1. scalar=1.0, variable=1.0, tensor=1.0, list=ListWrapper([<tf.Tensor: id=9, shape=(), dtype=float32, numpy=10.0>, 20.0, <tf.Variable 'Variable:0' shape=() dtype=float32, numpy=0.0>])\r\n2. scalar=-100.0, variable=123.0, tensor=-12.0, list=ListWrapper([3.0, 3.0])\r\n3. scalar=-100.0, variable=1.0, tensor=-12.0, list=ListWrapper([3.0, 3.0])\r\n```\r\n\r\nIn the output you can see that the checkpointer restores only the variable and completely ignores other fields of the A object.\r\n\r\nI expected that at least pythonic objects, numpy and TF tensors should be stored by the checkpointer on the disk. Is that a normal behavior?\r\n\r\nIf the answer is **yes**: I think that this feature should be implemented, otherwise it is very confusing and not straightforward why the checkpoint saves some objects and others not.\r\n**no**: this is a bug, must be fixed.\r\n\r\n**System information**\r\n- OS Platform and Distribution: `macOS 10.14.6`\r\n- TensorFlow version: `v1.12.1-10419-g5138353309 2.0.0-dev20190905`\r\n- Python version: `3.6.8`\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32236", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32236/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32236/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32236/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32236", "id": 489780948, "node_id": "MDU6SXNzdWU0ODk3ODA5NDg=", "number": 32236, "title": "boolean_mask does not accept a Tensor as axis", "user": {"login": "javidcf", "id": 1098280, "node_id": "MDQ6VXNlcjEwOTgyODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/1098280?v=4", "gravatar_id": "", "url": "https://api.github.com/users/javidcf", "html_url": "https://github.com/javidcf", "followers_url": "https://api.github.com/users/javidcf/followers", "following_url": "https://api.github.com/users/javidcf/following{/other_user}", "gists_url": "https://api.github.com/users/javidcf/gists{/gist_id}", "starred_url": "https://api.github.com/users/javidcf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/javidcf/subscriptions", "organizations_url": "https://api.github.com/users/javidcf/orgs", "repos_url": "https://api.github.com/users/javidcf/repos", "events_url": "https://api.github.com/users/javidcf/events{/privacy}", "received_events_url": "https://api.github.com/users/javidcf/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-09-05T14:12:12Z", "updated_at": "2019-09-13T22:40:37Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10 x64\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: NA\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): unknown 1.14.0\r\n- Python version: 3.6.8 (Anaconda)\r\n- Bazel version (if compiling from source): NA\r\n- GCC/Compiler version (if compiling from source): NA\r\n- CUDA/cuDNN version: NA\r\n- GPU model and memory: NA\r\n\r\n**Describe the current behavior**\r\n\r\n[`tf.boolean_mask`](https://www.tensorflow.org/api_docs/python/tf/boolean_mask) does not accept a scalar [`tf.Tensor`](https://www.tensorflow.org/api_docs/python/tf/Tensor) object as axis parameter.\r\n\r\n**Describe the expected behavior**\r\n\r\nAs per the docs, [`tf.boolean_mask`](https://www.tensorflow.org/api_docs/python/tf/boolean_mask) should accept a scalar  [`tf.Tensor`](https://www.tensorflow.org/api_docs/python/tf/Tensor) object as axis parameter.\r\n\r\n> * `axis`: A 0-D int Tensor representing the axis in `tensor` to mask from. By default, axis is 0 which will mask from the first dimension. Otherwise K + axis <= N.\r\n\r\n**Code to reproduce the issue**\r\n\r\nThe following snippet:\r\n\r\n```py\r\nimport tensorflow as tf\r\ntf.boolean_mask([1, 2, 3], [True, False, True], axis=tf.constant(0, dtype=tf.int32))\r\n```\r\n\r\nCauses the exception:\r\n\r\n```none\r\nTypeError: slice indices must be integers or None or have an __index__ method\r\n```\r\n\r\nFor comparison, the equivalent operation with [`tf.gather`](https://www.tensorflow.org/api_docs/python/tf/gather) works correctly:\r\n\r\n```py\r\nimport tensorflow as tf\r\nwith tf.Session() as sess:\r\n    print(sess.run(tf.gather([1, 2, 3], [0, 1], axis=tf.constant(0, dtype=tf.int32))))\r\n    # [1 2]\r\n```\r\n\r\n\r\n**Other info / logs**\r\n\r\nFull traceback:\r\n\r\n```none\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-3-4beb5ed72842> in <module>\r\n      1 import tensorflow as tf\r\n----> 2 tf.boolean_mask([1, 2, 3], [True, False, True], axis=tf.constant(0, dtype=tf.int32))\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\tf_test\\lib\\site-packages\\tensorflow\\python\\ops\\array_ops.py in boolean_mask(tensor, mask, name, axis)\r\n   1369           \" are None.  E.g. shape=[None] is ok, but shape=None is not.\")\r\n   1370     axis = 0 if axis is None else axis\r\n-> 1371     shape_tensor[axis:axis + ndims_mask].assert_is_compatible_with(shape_mask)\r\n   1372\r\n   1373     leading_size = gen_math_ops.prod(shape(tensor)[axis:axis + ndims_mask], [0])\r\n\r\n~\\AppData\\Local\\Continuum\\anaconda3\\envs\\tf_test\\lib\\site-packages\\tensorflow\\python\\framework\\tensor_shape.py in __getitem__(self, key)\r\n    861     if self._dims is not None:\r\n    862       if isinstance(key, slice):\r\n--> 863         return TensorShape(self._dims[key])\r\n    864       else:\r\n    865         if self._v2_behavior:\r\n\r\nTypeError: slice indices must be integers or None or have an __index__ method\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32228", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32228/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32228/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32228/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32228", "id": 489572982, "node_id": "MDU6SXNzdWU0ODk1NzI5ODI=", "number": 32228, "title": "Build error C2589 on x64-Windows-static", "user": {"login": "JackBoosY", "id": 47264268, "node_id": "MDQ6VXNlcjQ3MjY0MjY4", "avatar_url": "https://avatars0.githubusercontent.com/u/47264268?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JackBoosY", "html_url": "https://github.com/JackBoosY", "followers_url": "https://api.github.com/users/JackBoosY/followers", "following_url": "https://api.github.com/users/JackBoosY/following{/other_user}", "gists_url": "https://api.github.com/users/JackBoosY/gists{/gist_id}", "starred_url": "https://api.github.com/users/JackBoosY/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JackBoosY/subscriptions", "organizations_url": "https://api.github.com/users/JackBoosY/orgs", "repos_url": "https://api.github.com/users/JackBoosY/repos", "events_url": "https://api.github.com/users/JackBoosY/events{/privacy}", "received_events_url": "https://api.github.com/users/JackBoosY/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1188421838, "node_id": "MDU6TGFiZWwxMTg4NDIxODM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:windows", "name": "subtype:windows", "color": "b619ea", "default": false, "description": "Windows Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-09-05T07:18:32Z", "updated_at": "2019-09-09T18:35:57Z", "closed_at": null, "author_association": "NONE", "body": "Hi Developers,\r\n\r\nI recently tried to build tensorflow using vcpkg, and I have encountered some compilation errors.\r\nAfter two days of research this issue, I gave up. And I am not familiar with the bazel compiler.\r\nSo can someone help me?\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): **Windows 10 x64 build 1903**\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: **N/A**\r\n- TensorFlow installed from (source or binary): **source**\r\n- TensorFlow version: **v1.14.0**\r\n- Python version: **3.7.3**\r\n- Installed using virtualenv? pip? conda?: **vcpkg**\r\n- Bazel version (if compiling from source): **0.25.2**\r\n- GCC/Compiler version (if compiling from source): **Visual Studio 2017 ver 15.9.13**\r\n- CUDA/cuDNN version:  **N/A**\r\n- GPU model and memory: **CPU model, 32GB Memory**\r\n\r\n\r\n\r\n**Describe the problem**\r\nFirst build, error like:\r\n`.\\tensorflow/stream_executor/rng.h(66): error C2589: 'constant': illegal token on right side of '::'`\r\nTried to build **again**, the build was **successful**. I don't know why. \r\n\r\n\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n1. Clone vcpkg from `https://github.com/microsoft/vcpkg.git`.\r\n2. Build vcpkg with command `.\\bootstrap.bat`.\r\n3. Install tensorflow with command `.\\vcpkg.exe install tensorflow:x64-windows-static`.\r\n\r\n\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n[build-x64-windows-static-err.log](https://github.com/tensorflow/tensorflow/files/3577942/build-x64-windows-static-err.log)\r\n[build-x64-windows-static-out.log](https://github.com/tensorflow/tensorflow/files/3577943/build-x64-windows-static-out.log)\r\n[config-x64-windows-static-err.log](https://github.com/tensorflow/tensorflow/files/3577944/config-x64-windows-static-err.log)\r\n[config-x64-windows-static-out.log](https://github.com/tensorflow/tensorflow/files/3577945/config-x64-windows-static-out.log)\r\n\r\n\r\nThanks."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32222", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32222/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32222/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32222/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32222", "id": 489467389, "node_id": "MDU6SXNzdWU0ODk0NjczODk=", "number": 32222, "title": "AttributeError: module 'tensorflow' has no attribute 'indices'", "user": {"login": "bionicles", "id": 24532336, "node_id": "MDQ6VXNlcjI0NTMyMzM2", "avatar_url": "https://avatars2.githubusercontent.com/u/24532336?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bionicles", "html_url": "https://github.com/bionicles", "followers_url": "https://api.github.com/users/bionicles/followers", "following_url": "https://api.github.com/users/bionicles/following{/other_user}", "gists_url": "https://api.github.com/users/bionicles/gists{/gist_id}", "starred_url": "https://api.github.com/users/bionicles/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bionicles/subscriptions", "organizations_url": "https://api.github.com/users/bionicles/orgs", "repos_url": "https://api.github.com/users/bionicles/repos", "events_url": "https://api.github.com/users/bionicles/events{/privacy}", "received_events_url": "https://api.github.com/users/bionicles/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-09-05T00:25:00Z", "updated_at": "2019-10-01T22:26:09Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using): 1.14 (colab)\r\n- Are you willing to contribute it (Yes/No): not sure how\r\n\r\n**Describe the feature and the current behavior/state.**\r\nnp.indices is useful to quickly get coordinates for each element in a shape, tensorflow doesn't have this so user must import numpy for this\r\n\r\n**Will this change the current api? How?**\r\nsure, `coordinates = tf.indices(x.shape[1:-1], dtype=DTYPE)` would allow one to get coordinates for a tensor. Ideally it would have a `normalize=True` kwarg where user can get normalized coordinates for coordinate convolution https://arxiv.org/abs/1807.03247\r\n\r\n**Who will benefit with this feature?**\r\nanyone who uses convolution, and wants code to run faster (i.e. by not importing numpy)\r\n\r\n**Any Other info.**\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\ncoordinates_np = np.indices((28, 28))  # works\r\ncoordinates_tf = tf.indices((28, 28))  # crashes\r\n```\r\n\r\n> AttributeError: module 'tensorflow' has no attribute 'indices'\r\n\r\n[https://docs.scipy.org/doc/numpy/reference/generated/numpy.indices.html](np.indices docs)"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32218", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32218/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32218/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32218/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32218", "id": 489372250, "node_id": "MDU6SXNzdWU0ODkzNzIyNTA=", "number": 32218, "title": "tf.signal.fft2d speed is slow and unstable in RTX2080Ti", "user": {"login": "YichengWu", "id": 20190237, "node_id": "MDQ6VXNlcjIwMTkwMjM3", "avatar_url": "https://avatars1.githubusercontent.com/u/20190237?v=4", "gravatar_id": "", "url": "https://api.github.com/users/YichengWu", "html_url": "https://github.com/YichengWu", "followers_url": "https://api.github.com/users/YichengWu/followers", "following_url": "https://api.github.com/users/YichengWu/following{/other_user}", "gists_url": "https://api.github.com/users/YichengWu/gists{/gist_id}", "starred_url": "https://api.github.com/users/YichengWu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/YichengWu/subscriptions", "organizations_url": "https://api.github.com/users/YichengWu/orgs", "repos_url": "https://api.github.com/users/YichengWu/repos", "events_url": "https://api.github.com/users/YichengWu/events{/privacy}", "received_events_url": "https://api.github.com/users/YichengWu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 1566679705, "node_id": "MDU6TGFiZWwxNTY2Njc5NzA1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:signal", "name": "comp:signal", "color": "0052cc", "default": false, "description": "tf.signal related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rryan", "id": 26527, "node_id": "MDQ6VXNlcjI2NTI3", "avatar_url": "https://avatars3.githubusercontent.com/u/26527?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rryan", "html_url": "https://github.com/rryan", "followers_url": "https://api.github.com/users/rryan/followers", "following_url": "https://api.github.com/users/rryan/following{/other_user}", "gists_url": "https://api.github.com/users/rryan/gists{/gist_id}", "starred_url": "https://api.github.com/users/rryan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rryan/subscriptions", "organizations_url": "https://api.github.com/users/rryan/orgs", "repos_url": "https://api.github.com/users/rryan/repos", "events_url": "https://api.github.com/users/rryan/events{/privacy}", "received_events_url": "https://api.github.com/users/rryan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rryan", "id": 26527, "node_id": "MDQ6VXNlcjI2NTI3", "avatar_url": "https://avatars3.githubusercontent.com/u/26527?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rryan", "html_url": "https://github.com/rryan", "followers_url": "https://api.github.com/users/rryan/followers", "following_url": "https://api.github.com/users/rryan/following{/other_user}", "gists_url": "https://api.github.com/users/rryan/gists{/gist_id}", "starred_url": "https://api.github.com/users/rryan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rryan/subscriptions", "organizations_url": "https://api.github.com/users/rryan/orgs", "repos_url": "https://api.github.com/users/rryan/repos", "events_url": "https://api.github.com/users/rryan/events{/privacy}", "received_events_url": "https://api.github.com/users/rryan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 21, "created_at": "2019-09-04T20:13:30Z", "updated_at": "2019-10-22T01:18:21Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform: Linux Ubuntu 18.04 (server)\r\n- TensorFlow installed from: docker tensorflow/tensorflow  1.14.0-gpu-py3-jupyter \r\n- TensorFlow version: 1.14.0\r\n- Python version: 3.6.8\r\n- CUDA:  v10.0\r\n- GPU model: RTX 2080Ti \r\n\r\n**Describe the current behavior**\r\nThe speed of fft2d operation `tf.signal.fft2d` is very unstable at different iterations. Here is an example output of time every 100 iterations (code is shown below):\r\n```\r\n2019-09-04 19:03:57.731947\r\n2019-09-04 19:04:33.715335\r\n2019-09-04 19:05:10.976109\r\n2019-09-04 19:05:44.012072\r\n2019-09-04 19:06:15.616308\r\n2019-09-04 19:07:14.961716\r\n2019-09-04 19:08:12.324199\r\n2019-09-04 19:09:11.560423\r\n2019-09-04 19:10:08.877960\r\n2019-09-04 19:11:08.102977\r\n```\r\nDuring the training, there is no other programs running.\r\n\r\nBur when running the same code in my local machine (GTX 1080Ti) with the same TensorFlow docker image. The speed is fast and stable.\r\n```\r\n2019-09-04 14:12:00.387114\r\n2019-09-04 14:12:07.363174\r\n2019-09-04 14:12:14.355784\r\n2019-09-04 14:12:21.384377\r\n2019-09-04 14:12:28.378524\r\n```\r\n\r\n**Describe the expected behavior**\r\nThe speed should be always very fast (about 7s/100iterations).\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport os\r\nimport datetime\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\nos.environ[\"CUDA_DEVICE_ORDER\"] = \"PCI_BUS_ID\"\r\nos.environ[\"CUDA_VISIBLE_DEVICES\"] = \"1\"\r\n\r\ndef main(_):\r\n    dp_train = tf.placeholder(tf.float32, shape=(41, 300, 300, 1))\r\n    dp = tf.complex(dp_train, 0.0)\r\n    dp_fft = tf.abs(tf.signal.fft2d(dp))\r\n    W = tf.get_variable('W_conv', [1, 1, 1, 1])  # not important, just want to make the training process to run.\r\n    cost_train = tf.reduce_mean(tf.nn.conv2d(dp_fft, W, strides=[1, 1, 1, 1], padding='SAME'))\r\n\r\n    opt = tf.train.AdamOptimizer(1e-4)\r\n    update_ops = tf.get_collection(tf.GraphKeys.UPDATE_OPS)\r\n    with tf.control_dependencies(update_ops):\r\n        train_op = opt.minimize(cost_train)  # var_list=vars_digital\r\n\r\n    with tf.Session() as sess:\r\n        sess.run(tf.global_variables_initializer())\r\n        sess.run(tf.local_variables_initializer())\r\n        coord = tf.train.Coordinator()\r\n        threads = tf.train.start_queue_runners(sess=sess, coord=coord)\r\n\r\n        for i in range(0, 5000):\r\n            data = np.random.rand(41,300,300,1)\r\n            sess.run(train_op, feed_dict={dp_train:data})\r\n            if i % 100 ==0:\r\n                old_time = datetime.datetime.now()\r\n                print(old_time)\r\n\r\n        coord.request_stop()\r\n        coord.join(threads)\r\n\r\nif __name__ == '__main__':\r\n    tf.app.run()\r\n\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32206", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32206/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32206/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32206/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32206", "id": 489122782, "node_id": "MDU6SXNzdWU0ODkxMjI3ODI=", "number": 32206, "title": "tflite: RandomStandardNormal not convertible with pure tensorflow, but works with keras", "user": {"login": "DocDriven", "id": 30296124, "node_id": "MDQ6VXNlcjMwMjk2MTI0", "avatar_url": "https://avatars2.githubusercontent.com/u/30296124?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DocDriven", "html_url": "https://github.com/DocDriven", "followers_url": "https://api.github.com/users/DocDriven/followers", "following_url": "https://api.github.com/users/DocDriven/following{/other_user}", "gists_url": "https://api.github.com/users/DocDriven/gists{/gist_id}", "starred_url": "https://api.github.com/users/DocDriven/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DocDriven/subscriptions", "organizations_url": "https://api.github.com/users/DocDriven/orgs", "repos_url": "https://api.github.com/users/DocDriven/repos", "events_url": "https://api.github.com/users/DocDriven/events{/privacy}", "received_events_url": "https://api.github.com/users/DocDriven/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jaeyoo", "id": 40815393, "node_id": "MDQ6VXNlcjQwODE1Mzkz", "avatar_url": "https://avatars1.githubusercontent.com/u/40815393?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaeyoo", "html_url": "https://github.com/jaeyoo", "followers_url": "https://api.github.com/users/jaeyoo/followers", "following_url": "https://api.github.com/users/jaeyoo/following{/other_user}", "gists_url": "https://api.github.com/users/jaeyoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaeyoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaeyoo/subscriptions", "organizations_url": "https://api.github.com/users/jaeyoo/orgs", "repos_url": "https://api.github.com/users/jaeyoo/repos", "events_url": "https://api.github.com/users/jaeyoo/events{/privacy}", "received_events_url": "https://api.github.com/users/jaeyoo/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jaeyoo", "id": 40815393, "node_id": "MDQ6VXNlcjQwODE1Mzkz", "avatar_url": "https://avatars1.githubusercontent.com/u/40815393?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaeyoo", "html_url": "https://github.com/jaeyoo", "followers_url": "https://api.github.com/users/jaeyoo/followers", "following_url": "https://api.github.com/users/jaeyoo/following{/other_user}", "gists_url": "https://api.github.com/users/jaeyoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaeyoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaeyoo/subscriptions", "organizations_url": "https://api.github.com/users/jaeyoo/orgs", "repos_url": "https://api.github.com/users/jaeyoo/repos", "events_url": "https://api.github.com/users/jaeyoo/events{/privacy}", "received_events_url": "https://api.github.com/users/jaeyoo/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-09-04T12:14:12Z", "updated_at": "2020-02-01T00:11:13Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- TensorFlow installed from (source or binary): docker\r\n- TensorFlow version (use command below): 1.15.0-dev20190821\r\n- Python version: 3.6.8\r\n\r\nI have an variational autoencoder model utilizing `tf.random.normal` function. I want to convert it into a tflite model.\r\n\r\nI have written code in keras that achieves that. The conversion works and I get reasonable results. However, if I re-write the model with tensorflow-only operations (no keras so to speak), the converter claims that RandomStandardNormal is not available for tflite:\r\n```\r\n2019-09-04 12:04:12.858787: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: RandomStandardNormal\r\n2019-09-04 12:04:12.859104: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 21 operators, 32 arrays (0 quantized)\r\n2019-09-04 12:04:12.859336: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 21 operators, 32 arrays (0 quantized)\r\n2019-09-04 12:04:12.859712: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 1: 9 operators, 21 arrays (0 quantized)\r\n2019-09-04 12:04:12.859823: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before Group bidirectional sequence lstm/rnn: 9 operators, 21 arrays (0 quantized)\r\n2019-09-04 12:04:12.859876: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before dequantization graph transformations: 9 operators, 21 arrays (0 quantized)\r\n2019-09-04 12:04:12.859972: I tensorflow/lite/toco/allocate_transient_arrays.cc:345] Total transient array allocated size: 320 bytes, theoretical optimal value: 256 bytes.\r\n2019-09-04 12:04:12.860009: I tensorflow/lite/toco/toco_tooling.cc:454] Number of parameters: 8592\r\n2019-09-04 12:04:12.860269: E tensorflow/lite/toco/toco_tooling.cc:481] We are continually in the process of adding support to TensorFlow Lite for more ops. It would be helpful if you could inform us of how this conversion went by opening a github issue at https://github.com/tensorflow/tensorflow/issues/new?template=40-tflite-op-request.md\r\n and pasting the following:\r\n\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime. If those are native TensorFlow operators, you might be able to use the extended runtime by passing --enable_select_tf_ops, or by setting target_ops=TFLITE_BUILTINS,SELECT_TF_OPS when calling tf.lite.TFLiteConverter(). Otherwise, if you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: ADD, FULLY_CONNECTED, LOGISTIC, MUL. Here is a list of operators for which you will need custom implementations: RandomStandardNormal.\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/toco_from_protos\", line 10, in <module>\r\n    sys.exit(main())\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 89, in main\r\n    app.run(main=execute, argv=[sys.argv[0]] + unparsed)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/usr/local/lib/python3.6/dist-packages/absl/app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"/usr/local/lib/python3.6/dist-packages/absl/app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 52, in execute\r\n    enable_mlir_converter)\r\nException: We are continually in the process of adding support to TensorFlow Lite for more ops. It would be helpful if you could inform us of how this conversion went by opening a github issue at https://github.com/tensorflow/tensorflow/issues/new?template=40-tflite-op-request.md\r\n and pasting the following:\r\n\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime. If those are native TensorFlow operators, you might be able to use the extended runtime by passing --enable_select_tf_ops, or by setting target_ops=TFLITE_BUILTINS,SELECT_TF_OPS when calling tf.lite.TFLiteConverter(). Otherwise, if you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: ADD, FULLY_CONNECTED, LOGISTIC, MUL. Here is a list of operators for which you will need custom implementations: RandomStandardNormal.\r\n```\r\nThis is very confusing, as the keras model used the very same function and it worked. Does keras do something under the hood?\r\n\r\n**Code to reproduce the issue**\r\nI have created a repo for this [HERE](https://github.com/DocDriven/tflite_tests). Steps to reproduce this issue:\r\n1. Execute `python keras_model.py` to train and save the keras model\r\n2. Execute `python keras_conversion.py` to create the tflite model without errors\r\n3. Execute `python tf_model.py` to train, save and freeze the pure tf model\r\n4. Execute `python tf_conversion.py` to try the conversion and get the error\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32202", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32202/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32202/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32202/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/32202", "id": 489057341, "node_id": "MDExOlB1bGxSZXF1ZXN0MzEzOTUwOTM2", "number": 32202, "title": "Check types of name parameters", "user": {"login": "grwlf", "id": 4477729, "node_id": "MDQ6VXNlcjQ0Nzc3Mjk=", "avatar_url": "https://avatars3.githubusercontent.com/u/4477729?v=4", "gravatar_id": "", "url": "https://api.github.com/users/grwlf", "html_url": "https://github.com/grwlf", "followers_url": "https://api.github.com/users/grwlf/followers", "following_url": "https://api.github.com/users/grwlf/following{/other_user}", "gists_url": "https://api.github.com/users/grwlf/gists{/gist_id}", "starred_url": "https://api.github.com/users/grwlf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/grwlf/subscriptions", "organizations_url": "https://api.github.com/users/grwlf/orgs", "repos_url": "https://api.github.com/users/grwlf/repos", "events_url": "https://api.github.com/users/grwlf/events{/privacy}", "received_events_url": "https://api.github.com/users/grwlf/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1169364259, "node_id": "MDU6TGFiZWwxMTY5MzY0MjU5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:XS", "name": "size:XS", "color": "adafea", "default": false, "description": "CL Change Size: Extra Small"}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-09-04T09:49:58Z", "updated_at": "2020-03-18T13:19:35Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/32202", "html_url": "https://github.com/tensorflow/tensorflow/pull/32202", "diff_url": "https://github.com/tensorflow/tensorflow/pull/32202.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/32202.patch"}, "body": "In case user pass non-string as a tensor name, the code raises ValueError. One common mistake is to specify tensor object instad of its name. Unfortunately, in this case current implementation fails to produce an error message resulting in misleading errors like shown below. This PR introduce explicit type-checks of input parameters.\r\n\r\n```\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/lite/python/util.py in get_tensors_from_tensor_names(graph, tensor_names)\r\n      114   if invalid_tensors:\r\n      115     raise ValueError(\"Invalid tensors '{}' were found.\".format(\r\n  --> 116         \",\".join(invalid_tensors)))\r\n      117   return tensors\r\n      118\r\n\r\n  TypeError: sequence item 0: expected str instance, Tensor found\r\n```\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32201", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32201/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32201/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32201/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32201", "id": 489026536, "node_id": "MDU6SXNzdWU0ODkwMjY1MzY=", "number": 32201, "title": "Bug in the Tensorflow .pb to .tflite conversion using TFLiteConverter", "user": {"login": "akssieg", "id": 32209750, "node_id": "MDQ6VXNlcjMyMjA5NzUw", "avatar_url": "https://avatars2.githubusercontent.com/u/32209750?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akssieg", "html_url": "https://github.com/akssieg", "followers_url": "https://api.github.com/users/akssieg/followers", "following_url": "https://api.github.com/users/akssieg/following{/other_user}", "gists_url": "https://api.github.com/users/akssieg/gists{/gist_id}", "starred_url": "https://api.github.com/users/akssieg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akssieg/subscriptions", "organizations_url": "https://api.github.com/users/akssieg/orgs", "repos_url": "https://api.github.com/users/akssieg/repos", "events_url": "https://api.github.com/users/akssieg/events{/privacy}", "received_events_url": "https://api.github.com/users/akssieg/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-09-04T08:49:47Z", "updated_at": "2019-09-26T00:28:16Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: No\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 1.13 (CPU version)\r\n- Python version: 3.6.9\r\n\r\n\r\n**Describe the current behavior**\r\nTFLiteConverter converts the first convolutional layer of tensorflow model into depthwise convolutional layer if the input to the model has single channel (In my case grey scale images with channel =1).\r\n\r\n**Describe the expected behavior**\r\n\r\nConvolutional layer in the tensorflow model should remain the same even after TFLiteConverter.\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\nlink to tensorflow model: https://drive.google.com/open?id=14R84txljdYdTIZRmHAD1Rkfl-_n9fCGb\r\n\r\nlink to the generated tflite model: https://drive.google.com/open?id=1WlmWhJYjxfLIjwZcUJ9vLq8ZB5oBmaUD\r\n\r\nCode used to generate tflite file from tensorflow model:\r\n\r\n```\r\nimport tensorflow as tf\r\ngraph_def_file = \"single_layer.pb\"\r\ninput_arrays =['s']\r\noutput_arrays =['conv/Relu']\r\noutput_file = \"single_layer.tflite\"\r\n\r\nconverter = tf.lite.TFLiteConverter.from_frozen_graph(graph_def_file, input_arrays, output_arrays)\r\ntflite_model = converter.convert()\r\nopen(output_file, \"wb\").write(tflite_model)\r\n\r\n```\r\n\r\nI used netron to visualise the .pb and .tflite graph, link: https://github.com/lutzroeder/netron\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\nTensorflow graph:\r\n![1](https://user-images.githubusercontent.com/32209750/64239177-0e659a00-cf00-11e9-9d99-67809d639104.PNG)\r\n\r\nTflite graph after TFLiteConverter:\r\n![image](https://user-images.githubusercontent.com/32209750/64239288-45d44680-cf00-11e9-9fb4-18eddf063b4f.png)\r\n\r\n\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32194", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32194/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32194/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32194/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32194", "id": 488844248, "node_id": "MDU6SXNzdWU0ODg4NDQyNDg=", "number": 32194, "title": "micro_speech preprocessing", "user": {"login": "piisku78", "id": 26620623, "node_id": "MDQ6VXNlcjI2NjIwNjIz", "avatar_url": "https://avatars0.githubusercontent.com/u/26620623?v=4", "gravatar_id": "", "url": "https://api.github.com/users/piisku78", "html_url": "https://github.com/piisku78", "followers_url": "https://api.github.com/users/piisku78/followers", "following_url": "https://api.github.com/users/piisku78/following{/other_user}", "gists_url": "https://api.github.com/users/piisku78/gists{/gist_id}", "starred_url": "https://api.github.com/users/piisku78/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/piisku78/subscriptions", "organizations_url": "https://api.github.com/users/piisku78/orgs", "repos_url": "https://api.github.com/users/piisku78/repos", "events_url": "https://api.github.com/users/piisku78/events{/privacy}", "received_events_url": "https://api.github.com/users/piisku78/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-09-03T21:58:24Z", "updated_at": "2019-09-09T08:04:37Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using): 1.14\r\n- Are you willing to contribute it (Yes/No): yes\r\n\r\ntensorflow/examples/speech_commands project defines 3 different preprocessing modes. It is possible to train a ML model using all of them. \r\n\r\nThen there is an experimental project which will use the ML model from the 1st project on a micro-controller: tensorflow/lite/experimental/micro/examples/micro_speech/\r\nThis project ignores the preprocessing modes from the first project. By looking at the code in the micro_speech project it assumes the preprocessing mode always to be 'micro'.  The preprocessing includes some scaling operations and it looks like those operations are done inside 'micro_features_generator.cc' \r\ntensorflow/lite/experimental/micro/examples/micro_speech/micro_features/micro_features_generator.cc\r\nThere is an comment related to this: 'These scaling values are derived from those used in input_data.py in the training pipeline.'\r\n\r\nThe problems I see at the moment:\r\n1 .It is very unclear how those magic scaling numbers in micro_features_generator.cc are derived from training pipeline. What if my pipeline parameters are not exactly the same as they were when those magic numbers where defined.   \r\n2. It is impossible to use another preprocessing mode as 'micro' because it is not implemented on micro_speech project.\r\n3. There is suspicious operation where pointer is always moved 160 steps forward. Why hardcoded 160? From where does this number come and why buffer pointer is always moved 160.  'frontend_input = input + 160; ' \r\n4. Documentation of the all preprocessing modes is lacking.\r\n\r\nSo at the moment if somebody use 'average' or 'mfcc' preprocessing mode then the input to the model is not correctly prepared in micro_speech project and it will fail to detect sounds. One should to implement all preprocessing modes in micro_features_generator.cc.\r\n\r\nI am also not sure if 'micro' works always correctly because there is that hardcoded 160 which is obviously depend on some ML model input parameters."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32193", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32193/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32193/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32193/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32193", "id": 488839402, "node_id": "MDU6SXNzdWU0ODg4Mzk0MDI=", "number": 32193, "title": "Inconsistent behavior of .shape when using sparse.placeholder", "user": {"login": "pavanky", "id": 364829, "node_id": "MDQ6VXNlcjM2NDgyOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/364829?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavanky", "html_url": "https://github.com/pavanky", "followers_url": "https://api.github.com/users/pavanky/followers", "following_url": "https://api.github.com/users/pavanky/following{/other_user}", "gists_url": "https://api.github.com/users/pavanky/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavanky/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavanky/subscriptions", "organizations_url": "https://api.github.com/users/pavanky/orgs", "repos_url": "https://api.github.com/users/pavanky/repos", "events_url": "https://api.github.com/users/pavanky/events{/privacy}", "received_events_url": "https://api.github.com/users/pavanky/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-09-03T21:44:48Z", "updated_at": "2019-09-17T23:34:26Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\nNo\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\nUbuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\nNo\r\n- TensorFlow installed from (source or binary):\r\nbinary\r\n- TensorFlow version (use command below):\r\n1.15.0-dev20190821\r\n- Python version:\r\n3.7.4\r\n\r\n**Describe the current behavior**\r\n\r\nsparse.placeholder does loses the shape entirely when batch is not provided. This is inconstent with how tf.placeholder behaves.\r\n**Describe the expected behavior**\r\ntf.placeholder and tf.sparse.placeholder have the same behavior.\r\n\r\n**Code to reproduce the issue**\r\n\r\n```\r\nimport tensorflow as tf\r\n\r\nprint(tf.__version__)\r\n\r\nprint(\"Printing shape of sparse placeholder when using (None, 1024)\")\r\nprint(tf.compat.v1.sparse.placeholder(dtype=tf.float32, shape=(None, 1024)).shape)\r\n\r\nprint(\"Printing shape of dense placeholder when using (None, 1024)\")\r\nprint(tf.compat.v1.placeholder(dtype=tf.float32, shape=(None, 1024)).shape)\r\n\r\nprint(\"Printing shape of sparse placeholder when using (-1, 1024)\")\r\nprint(tf.compat.v1.sparse.placeholder(dtype=tf.float32, shape=(-1, 1024)).shape)\r\n\r\nprint(\"Printing shape of dense placeholder when using (-1, 1024)\")\r\nprint(tf.compat.v1.placeholder(dtype=tf.float32, shape=(-1, 1024)).shape)\r\n```\r\n\r\n**Other info / logs**\r\n\r\n```\r\n1.15.0-dev20190821\r\nPrinting shape of sparse placeholder when using (None, 1024)\r\n(?, ?)\r\nPrinting shape of dense placeholder when using (None, 1024)\r\n(?, 1024)\r\nPrinting shape of sparse placeholder when using (-1, 1024)\r\n(?, 1024)\r\nPrinting shape of dense placeholder when using (-1, 1024)\r\nTraceback (most recent call last):\r\n  File \"/home/pyalamanchili/.local/lib/python3.7/site-packages/tensorflow_core/python/eager/execute.py\", line 206, in make_shape\r\n    shape = tensor_shape.as_shape(v)\r\n  File \"/home/pyalamanchili/.local/lib/python3.7/site-packages/tensorflow_core/python/framework/tensor_shape.py\", line 1216, in as_shape\r\n    return TensorShape(shape)\r\n  File \"/home/pyalamanchili/.local/lib/python3.7/site-packages/tensorflow_core/python/framework/tensor_shape.py\", line 776, in __init__\r\n    self._dims = [as_dimension(d) for d in dims_iter]\r\n  File \"/home/pyalamanchili/.local/lib/python3.7/site-packages/tensorflow_core/python/framework/tensor_shape.py\", line 776, in <listcomp>\r\n    self._dims = [as_dimension(d) for d in dims_iter]\r\n  File \"/home/pyalamanchili/.local/lib/python3.7/site-packages/tensorflow_core/python/framework/tensor_shape.py\", line 718, in as_dimension\r\n    return Dimension(value)\r\n  File \"/home/pyalamanchili/.local/lib/python3.7/site-packages/tensorflow_core/python/framework/tensor_shape.py\", line 198, in __init__\r\n    raise ValueError(\"Dimension %d must be >= 0\" % self._value)\r\nValueError: Dimension -1 must be >= 0\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/tmp/sparse_shape.py\", line 15, in <module>\r\n    print(tf.compat.v1.placeholder(dtype=tf.float32, shape=(-1, 1024)).shape)\r\n  File \"/home/pyalamanchili/.local/lib/python3.7/site-packages/tensorflow_core/python/ops/array_ops.py\", line 2619, in placeholder\r\n    return gen_array_ops.placeholder(dtype=dtype, shape=shape, name=name)\r\n  File \"/home/pyalamanchili/.local/lib/python3.7/site-packages/tensorflow_core/python/ops/gen_array_ops.py\", line 6667, in placeholder\r\n    shape = _execute.make_shape(shape, \"shape\")\r\n  File \"/home/pyalamanchili/.local/lib/python3.7/site-packages/tensorflow_core/python/eager/execute.py\", line 211, in make_shape\r\n    e))\r\nValueError: Error converting shape to a TensorShape: Dimension -1 must be >= 0.\r\n\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32192", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32192/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32192/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32192/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32192", "id": 488832282, "node_id": "MDU6SXNzdWU0ODg4MzIyODI=", "number": 32192, "title": "JSON serializable issue at RemoteMonitor", "user": {"login": "Telcoltar", "id": 54867569, "node_id": "MDQ6VXNlcjU0ODY3NTY5", "avatar_url": "https://avatars2.githubusercontent.com/u/54867569?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Telcoltar", "html_url": "https://github.com/Telcoltar", "followers_url": "https://api.github.com/users/Telcoltar/followers", "following_url": "https://api.github.com/users/Telcoltar/following{/other_user}", "gists_url": "https://api.github.com/users/Telcoltar/gists{/gist_id}", "starred_url": "https://api.github.com/users/Telcoltar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Telcoltar/subscriptions", "organizations_url": "https://api.github.com/users/Telcoltar/orgs", "repos_url": "https://api.github.com/users/Telcoltar/repos", "events_url": "https://api.github.com/users/Telcoltar/events{/privacy}", "received_events_url": "https://api.github.com/users/Telcoltar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-09-03T21:25:30Z", "updated_at": "2019-09-23T18:21:41Z", "closed_at": null, "author_association": "NONE", "body": "The Tensorflow implementation of RemoteMonitor callback raises the error\r\n`Object of type float32 is not JSON serializable.`\r\n\r\nKeras own implementation works fine with the same code.\r\n\r\nI think the relevant code difference is \r\n    \r\n```\r\nfor k, v in logs.items():\r\n      send[k] = v\r\n\r\n```\r\nin the Tensorflow implementation and\r\n\r\n```\r\nfor k, v in logs.items():\r\n            if isinstance(v, (np.ndarray, np.generic)):\r\n                send[k] = v.item()\r\n            else:\r\n                send[k] = v\r\n```\r\n\r\nin the Keras implementation.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32188", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32188/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32188/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32188/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32188", "id": 488789647, "node_id": "MDU6SXNzdWU0ODg3ODk2NDc=", "number": 32188, "title": "Efficient band matrix multiplication", "user": {"login": "ekuznetsov139", "id": 12205429, "node_id": "MDQ6VXNlcjEyMjA1NDI5", "avatar_url": "https://avatars2.githubusercontent.com/u/12205429?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ekuznetsov139", "html_url": "https://github.com/ekuznetsov139", "followers_url": "https://api.github.com/users/ekuznetsov139/followers", "following_url": "https://api.github.com/users/ekuznetsov139/following{/other_user}", "gists_url": "https://api.github.com/users/ekuznetsov139/gists{/gist_id}", "starred_url": "https://api.github.com/users/ekuznetsov139/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ekuznetsov139/subscriptions", "organizations_url": "https://api.github.com/users/ekuznetsov139/orgs", "repos_url": "https://api.github.com/users/ekuznetsov139/repos", "events_url": "https://api.github.com/users/ekuznetsov139/events{/privacy}", "received_events_url": "https://api.github.com/users/ekuznetsov139/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-09-03T19:48:26Z", "updated_at": "2019-09-18T12:32:30Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "Tensorflow appears to lack an efficient way to do a multiplication by band matrix.\r\n\r\nBy this I mean calculating \r\n\r\nC[i,j] = sum_k A[i,j+k] B[i, k] \r\n\r\nFor example, if B is\r\n\r\n[ b00 b01 b02 .. b07]\r\n[ b10 b11 b12 .. b17]\r\n[ b20 b21 b22 .. b27]\r\n\r\nthis is equivalent to multiplying A by\r\n\r\n[ b00  0   0 ...\r\n[ b10 b01 0 ...\r\n[ b20 b11 b02 ...\r\n[ 0     b21 b12 ... ]\r\n[ 0     0     b22 ... ]\r\n...\r\n[0   0 ...    b27]\r\n\r\nThis arises as part of the implementation of keras.layers.LocallyConnected1D(), which provides two possible implementations for it; both implementations are suboptimal. One creates a tensorflow op for every column, which means a lot of framework overhead, and the other expands B to the full form, which is inefficient and also seems to incur some overhead. (If B is 512x16, it should take one tensorflow op with 512x16 FMAs; implementation 1 would do 512 ops with 16 FMAs each;  implementation 2 would perform two ops, one with 512x529 float multiplications, and one with 512x529 FMAs less however much is saved internally by sparse_matmul().)\r\n\r\nI tried to replace some dense layers with LocallyConnected1D() layers in @tensor2tensor transformer. It would not load at all with implementation 1 (it was still trying to build the graph after 10 minutes) and it ran significantly slower than with dense() (despite doing fewer FMAs) with implementation 2. \r\n\r\nThe convolution would be easy to implement if one had direct access to tensor strides. (You simply set the second-to-last stride of A to stride[-2]+stride[-1] and do a regular matrix multiplication call.) And there is some internal support for it in the form of methods called Stream::ThenBlasGbmv() in stream_executor/stream.cc. But I don't see how to change strides from python, and ThenBlasGbmv() is never used in 1.x master."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32187", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32187/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32187/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32187/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32187", "id": 488771668, "node_id": "MDU6SXNzdWU0ODg3NzE2Njg=", "number": 32187, "title": "XLA compilation fails in replica context of distribution strategy", "user": {"login": "hakos", "id": 184179, "node_id": "MDQ6VXNlcjE4NDE3OQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/184179?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hakos", "html_url": "https://github.com/hakos", "followers_url": "https://api.github.com/users/hakos/followers", "following_url": "https://api.github.com/users/hakos/following{/other_user}", "gists_url": "https://api.github.com/users/hakos/gists{/gist_id}", "starred_url": "https://api.github.com/users/hakos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hakos/subscriptions", "organizations_url": "https://api.github.com/users/hakos/orgs", "repos_url": "https://api.github.com/users/hakos/repos", "events_url": "https://api.github.com/users/hakos/events{/privacy}", "received_events_url": "https://api.github.com/users/hakos/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 1133285679, "node_id": "MDU6TGFiZWwxMTMzMjg1Njc5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:xla", "name": "comp:xla", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-09-03T19:04:09Z", "updated_at": "2019-09-14T21:16:13Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Debian GNU/Linux 9.9 (stretch)\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): v1.14.0-0-g87989f6 1.14.0\r\n- Python version: Python 3.5.3\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: CUDA Version 10.0.130\r\n- GPU model and memory: 2 x Nvidia Tesla K80\r\n\r\n**Describe the current behavior**\r\nInvoking `xla.compile` in the function passed to `strategy.experimental_run_v2` as in the code below raises the following exception (full traceback below):\r\n```\r\nValueError: XLA compiled computations cannot be nested, (operator name: replica_1/input_0)\r\n```\r\n**Describe the expected behavior**\r\nThe expectation was to get one compiled XLA cluster for each replica.\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n```python\r\nimport tensorflow as tf\r\nfrom tensorflow.python.compiler.xla import xla\r\n\r\nstrategy = tf.distribute.experimental.CentralStorageStrategy(\r\n    compute_devices=[\"/device:GPU:0\", \"/device:GPU:1\"],\r\n    parameter_device=\"/device:CPU:0\"\r\n)\r\n\r\nwith strategy.scope():\r\n    def train_step(inputs):\r\n        def step_fn(x):\r\n            w = tf.get_variable(name=\"w\", initializer=1.0)\r\n            loss = w * x\r\n            optimizer = tf.train.GradientDescentOptimizer(0.1)\r\n            train_op = optimizer.minimize(loss)\r\n            with tf.control_dependencies([train_op]):\r\n                return tf.identity(loss)\r\n        \r\n        def compiled_step_fn(x):\r\n            [out] = xla.compile(step_fn, inputs=[x])\r\n            return out\r\n\r\n        per_replica_losses = strategy.experimental_run_v2(\r\n            compiled_step_fn, args=[inputs])\r\n        sum_loss = strategy.reduce(\r\n            tf.distribute.ReduceOp.SUM, per_replica_losses, axis=None)\r\n        return sum_loss\r\n    \r\n    loss = train_step(1.0)\r\n    with tf.Session() as sess:\r\n        sess.run(tf.global_variables_initializer())\r\n        for _ in range(10):\r\n            print(sess.run(loss))\r\n```\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n```\r\nTraceback (most recent call last):\r\n  File \"multi_gpu_strategy_xla.py\", line 29, in <module>\r\n    loss = train_step(1.0)\r\n  File \"multi_gpu_strategy_xla.py\", line 24, in train_step\r\n    compiled_step_fn, args=[inputs])\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/distribute/distribute_lib.py\", line 511, in experimental_run_v2\r\n    return self._extended.call_for_each_replica(fn, args=args, kwargs=kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/distribute/distribute_lib.py\", line 1555, in call_for_each_replica\r\n    return self._call_for_each_replica(fn, args, kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/distribute/parameter_server_strategy.py\", line 407, in _call_for_each_replica\r\n    self._container_strategy(), self._device_map, fn, args, kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/distribute/mirrored_strategy.py\", line 195, in _call_for_each_replica\r\n    coord.join(threads)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/coordinator.py\", line 389, in join\r\n    six.reraise(*self._exc_info_to_raise)\r\n  File \"/usr/local/lib/python3.5/dist-packages/six.py\", line 693, in reraise\r\n    raise value\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/training/coordinator.py\", line 297, in stop_on_exception\r\n    yield\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/distribute/mirrored_strategy.py\", line 911, in run\r\n    self.main_result = self.main_fn(*self.main_args, **self.main_kwargs)\r\n  File \"multi_gpu_strategy_xla.py\", line 20, in compiled_step_fn\r\n    [out] = xla.compile(step_fn, inputs=[x])\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/compiler/xla/xla.py\", line 110, in compile\r\n    return _compile_internal(computation, inputs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/compiler/xla/xla.py\", line 338, in _compile_internal\r\n    for i, x in enumerate(flat_inputs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/compiler/xla/xla.py\", line 338, in <listcomp>\r\n    for i, x in enumerate(flat_inputs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/util/dispatch.py\", line 180, in wrapper\r\n    return target(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/array_ops.py\", line 86, in identity\r\n    ret = gen_array_ops.identity(input, name=name)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/gen_array_ops.py\", line 4253, in identity\r\n    \"Identity\", input=input, name=name)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/op_def_library.py\", line 788, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/util/deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\", line 3616, in create_op\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\", line 2043, in __init__\r\n    self._control_flow_post_processing()\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/ops.py\", line 2054, in _control_flow_post_processing\r\n    self._control_flow_context.AddOp(self)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/compiler/xla/xla.py\", line 254, in AddOp\r\n    self._outer_context.AddInnerOp(op)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/compiler/xla/xla.py\", line 274, in AddInnerOp\r\n    self.AddOp(op)\r\n  File \"/usr/local/lib/python3.5/dist-packages/tensorflow/python/compiler/xla/xla.py\", line 202, in AddOp\r\n    'name: %s)' % op.name)\r\nValueError: XLA compiled computations cannot be nested, (operator name: replica_1/input_0)\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32180", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32180/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32180/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32180/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32180", "id": 488718570, "node_id": "MDU6SXNzdWU0ODg3MTg1NzA=", "number": 32180, "title": "Keras to tflite. Multiple outputs all given name Identity", "user": {"login": "marno1d", "id": 10799696, "node_id": "MDQ6VXNlcjEwNzk5Njk2", "avatar_url": "https://avatars0.githubusercontent.com/u/10799696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marno1d", "html_url": "https://github.com/marno1d", "followers_url": "https://api.github.com/users/marno1d/followers", "following_url": "https://api.github.com/users/marno1d/following{/other_user}", "gists_url": "https://api.github.com/users/marno1d/gists{/gist_id}", "starred_url": "https://api.github.com/users/marno1d/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marno1d/subscriptions", "organizations_url": "https://api.github.com/users/marno1d/orgs", "repos_url": "https://api.github.com/users/marno1d/repos", "events_url": "https://api.github.com/users/marno1d/events{/privacy}", "received_events_url": "https://api.github.com/users/marno1d/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gargn", "id": 1900612, "node_id": "MDQ6VXNlcjE5MDA2MTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1900612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gargn", "html_url": "https://github.com/gargn", "followers_url": "https://api.github.com/users/gargn/followers", "following_url": "https://api.github.com/users/gargn/following{/other_user}", "gists_url": "https://api.github.com/users/gargn/gists{/gist_id}", "starred_url": "https://api.github.com/users/gargn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gargn/subscriptions", "organizations_url": "https://api.github.com/users/gargn/orgs", "repos_url": "https://api.github.com/users/gargn/repos", "events_url": "https://api.github.com/users/gargn/events{/privacy}", "received_events_url": "https://api.github.com/users/gargn/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gargn", "id": 1900612, "node_id": "MDQ6VXNlcjE5MDA2MTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1900612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gargn", "html_url": "https://github.com/gargn", "followers_url": "https://api.github.com/users/gargn/followers", "following_url": "https://api.github.com/users/gargn/following{/other_user}", "gists_url": "https://api.github.com/users/gargn/gists{/gist_id}", "starred_url": "https://api.github.com/users/gargn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gargn/subscriptions", "organizations_url": "https://api.github.com/users/gargn/orgs", "repos_url": "https://api.github.com/users/gargn/repos", "events_url": "https://api.github.com/users/gargn/events{/privacy}", "received_events_url": "https://api.github.com/users/gargn/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-09-03T16:58:34Z", "updated_at": "2020-03-07T14:34:56Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below):2.0-rc0\r\n- Python version: 3.6\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: 10.0/7.6\r\n- GPU model and memory: RTX 2070\r\n\r\n**Describe the current behavior**\r\nWhen I convert a keras model to a tflite model all outputs are named Identity. When you have a bunch of outputs that all have the same output size it becomes impossible to tell which one is which.\r\n\r\n**Describe the expected behavior**\r\nI would expect the names to match the layer names that the output comes from. \r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n```\r\nimport tensorflow as tf\r\n\r\ninputs = []\r\noutputs = []\r\n\r\nx = tf.keras.layers.Input(shape=(10), batch_size=1, name='input1')\r\ninputs.append(x)\r\nx = tf.keras.layers.Dense(10, name='dense1')(x)\r\noutputs.append(x)\r\nx = tf.keras.layers.Dense(10, name='dense2')(x)\r\noutputs.append(x)\r\n\r\nmodel = tf.keras.Model(inputs=inputs, outputs=outputs)\r\n\r\nmodel.summary()\r\n```\r\n```\r\nModel: \"model_1\"\r\n_________________________________________________________________\r\nLayer (type)                 Output Shape              Param #   \r\n=================================================================\r\ninput1 (InputLayer)          [(1, 10)]                 0         \r\n_________________________________________________________________\r\ndense1 (Dense)               (1, 10)                   110       \r\n_________________________________________________________________\r\ndense2 (Dense)               (1, 10)                   110       \r\n=================================================================\r\nTotal params: 220\r\nTrainable params: 220\r\nNon-trainable params: 0\r\n```\r\n```\r\nmodel.outputs\r\n```\r\n```\r\n[<tf.Tensor 'dense1/Identity:0' shape=(1, 10) dtype=float32>,\r\n <tf.Tensor 'dense2/Identity:0' shape=(1, 10) dtype=float32>]\r\n```\r\n```\r\n# Convert and save the model.\r\nconverter = tf.lite.TFLiteConverter.from_keras_model(model)\r\ntflite_model = converter.convert()\r\nopen(\"./save/simple.tflite\", \"wb\").write(tflite_model)\r\n\r\n# Load TFLite model and allocate tensors.\r\ninterpreter = tf.lite.Interpreter(model_path=\"./save/simple.tflite\")\r\ninterpreter.allocate_tensors()\r\n\r\n# Get input and output tensors.\r\ninput_details = interpreter.get_input_details()\r\noutput_details = interpreter.get_output_details()\r\n\r\noutput_details\r\n```\r\n```\r\n[{'name': 'Identity',\r\n  'index': 0,\r\n  'shape': array([ 1, 10], dtype=int32),\r\n  'dtype': numpy.float32,\r\n  'quantization': (0.0, 0)},\r\n {'name': 'Identity_1',\r\n  'index': 1,\r\n  'shape': array([ 1, 10], dtype=int32),\r\n  'dtype': numpy.float32,\r\n  'quantization': (0.0, 0)}]\r\n```\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32176", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32176/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32176/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32176/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32176", "id": 488587635, "node_id": "MDU6SXNzdWU0ODg1ODc2MzU=", "number": 32176, "title": "Gradient Accumulation feature for Distribution Strategy", "user": {"login": "fanshiqing", "id": 3927162, "node_id": "MDQ6VXNlcjM5MjcxNjI=", "avatar_url": "https://avatars2.githubusercontent.com/u/3927162?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fanshiqing", "html_url": "https://github.com/fanshiqing", "followers_url": "https://api.github.com/users/fanshiqing/followers", "following_url": "https://api.github.com/users/fanshiqing/following{/other_user}", "gists_url": "https://api.github.com/users/fanshiqing/gists{/gist_id}", "starred_url": "https://api.github.com/users/fanshiqing/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fanshiqing/subscriptions", "organizations_url": "https://api.github.com/users/fanshiqing/orgs", "repos_url": "https://api.github.com/users/fanshiqing/repos", "events_url": "https://api.github.com/users/fanshiqing/events{/privacy}", "received_events_url": "https://api.github.com/users/fanshiqing/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1162044565, "node_id": "MDU6TGFiZWwxMTYyMDQ0NTY1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.12", "name": "TF 1.12", "color": "c2e0c6", "default": false, "description": "Issues related to TF 1.12"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-09-03T12:52:40Z", "updated_at": "2019-09-09T04:19:45Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- TensorFlow version (you are using): 1.12\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n**Describe the feature and the current behavior/state.**\r\nGradient Accumulation(GA) is a workaround to enable big batches on limited memory GPUs which has been supported in Caffe and PyTorch. Instead of back-propagating for every batch feed-forward; gradients across multiple batches are accumulated. After multiple feed forwards, the accumulated gradient is back-propagated through the network layer.  It boosts performance with a couple of percentages on our several workload (e.g., XLNet, Transformer) with Distribution Strategy. Unfortunately, I am not aware of any official documentation to use such feature in Tensorflow. `tf.contrib.opt.AGNOptimizer` has a similar GA implementation but is not common for general distribution job on DistributionStrategy. Besides it will introduces OOM for large embeddings(#31637).\r\n**Will this change the current api? How?**\r\nYes. Just need to add one new parameter `iter_size` to current strategy API, which  for example:\r\n```\r\n # For MirroredStrategy, gradient accumulation is supported using iter_size parameter.\r\n distribution = tf.distribute.MirroredStrategy(num_gpus=2, iter_size=4)\r\n\r\n # For MultiWorkerMirroredStrategy:\r\n tf.distribute.experimental.MultiWorkerMirroredStrategy(..., iter_size=4)\r\n```\r\n\r\n**Who will benefit with this feature?**\r\nAnyone who use distribution strategy and want to enable big batches on limited memory GPUs \r\n**Any Other info.**\r\nNone.\r\n\r\nWe already have a concise implementation of GA on DistributionStrategy and are willing to contribute. Thanks in advance for any feedback."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32172", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32172/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32172/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32172/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32172", "id": 488524599, "node_id": "MDU6SXNzdWU0ODg1MjQ1OTk=", "number": 32172, "title": "Mirror Strategy slow down by adding GPUs", "user": {"login": "sakh251", "id": 17527773, "node_id": "MDQ6VXNlcjE3NTI3Nzcz", "avatar_url": "https://avatars1.githubusercontent.com/u/17527773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sakh251", "html_url": "https://github.com/sakh251", "followers_url": "https://api.github.com/users/sakh251/followers", "following_url": "https://api.github.com/users/sakh251/following{/other_user}", "gists_url": "https://api.github.com/users/sakh251/gists{/gist_id}", "starred_url": "https://api.github.com/users/sakh251/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sakh251/subscriptions", "organizations_url": "https://api.github.com/users/sakh251/orgs", "repos_url": "https://api.github.com/users/sakh251/repos", "events_url": "https://api.github.com/users/sakh251/events{/privacy}", "received_events_url": "https://api.github.com/users/sakh251/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-09-03T10:32:45Z", "updated_at": "2020-01-09T12:35:42Z", "closed_at": null, "author_association": "NONE", "body": "I am using the custom estimator with TFrecord. I am training VGG16. By increasing the number of GPUs the training time increase. All GPUs are in a single machine. GPUs utilization is about 100%. So it seems the input function can feed the data to GPUs well. I am using tf.layers.conv2d, tf.contrib.layers.flatten, tf.layers.dense to create the VGG Model. However, I have a large number of groups_Deps nodes in the computation graph. since all GPUs are in a single machine I am wondering why increasing number of GPUs lead to decreasing the global_Steps/Sec and also increasing the training time. \r\n\r\n![image](https://user-images.githubusercontent.com/17527773/64166782-195cf380-ce48-11e9-91d8-15ceade1db54.png)\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32170", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32170/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32170/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32170/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32170", "id": 488507217, "node_id": "MDU6SXNzdWU0ODg1MDcyMTc=", "number": 32170, "title": "request of SparseApplyFtrlOp running on gpu", "user": {"login": "sjtusmartboy", "id": 12267324, "node_id": "MDQ6VXNlcjEyMjY3MzI0", "avatar_url": "https://avatars2.githubusercontent.com/u/12267324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sjtusmartboy", "html_url": "https://github.com/sjtusmartboy", "followers_url": "https://api.github.com/users/sjtusmartboy/followers", "following_url": "https://api.github.com/users/sjtusmartboy/following{/other_user}", "gists_url": "https://api.github.com/users/sjtusmartboy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sjtusmartboy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sjtusmartboy/subscriptions", "organizations_url": "https://api.github.com/users/sjtusmartboy/orgs", "repos_url": "https://api.github.com/users/sjtusmartboy/repos", "events_url": "https://api.github.com/users/sjtusmartboy/events{/privacy}", "received_events_url": "https://api.github.com/users/sjtusmartboy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-09-03T09:56:21Z", "updated_at": "2019-10-04T03:11:33Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (or github SHA if from source):  1.13.1\r\n\r\n\r\nCurrently, I notice that `SparseApplyFtrlOp` only supports running on cpu platform. Seeing from here:\r\nhttps://github.com/tensorflow/tensorflow/blob/d5c6687d9919c562bea2a01a6e1be1756bfaab33/tensorflow/core/kernels/training_ops.cc#L2448\r\n\r\nHowever, in some circumstances, there's great advantage of supporting this  `SparseApplyFtrlOp` in time performance. So is there any plan to support this op on gpu, and if not, what's the reason? Thanks"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32161", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32161/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32161/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32161/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32161", "id": 488325105, "node_id": "MDU6SXNzdWU0ODgzMjUxMDU=", "number": 32161, "title": "tfcompile with negative one shape", "user": {"login": "lotrus28", "id": 13820236, "node_id": "MDQ6VXNlcjEzODIwMjM2", "avatar_url": "https://avatars3.githubusercontent.com/u/13820236?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lotrus28", "html_url": "https://github.com/lotrus28", "followers_url": "https://api.github.com/users/lotrus28/followers", "following_url": "https://api.github.com/users/lotrus28/following{/other_user}", "gists_url": "https://api.github.com/users/lotrus28/gists{/gist_id}", "starred_url": "https://api.github.com/users/lotrus28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lotrus28/subscriptions", "organizations_url": "https://api.github.com/users/lotrus28/orgs", "repos_url": "https://api.github.com/users/lotrus28/repos", "events_url": "https://api.github.com/users/lotrus28/events{/privacy}", "received_events_url": "https://api.github.com/users/lotrus28/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 1133285679, "node_id": "MDU6TGFiZWwxMTMzMjg1Njc5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:xla", "name": "comp:xla", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-09-02T21:51:59Z", "updated_at": "2019-09-18T19:21:08Z", "closed_at": null, "author_association": "NONE", "body": "I am trying to compile a tensorflow model, using the following [tutorial](https://barkeywolf.consulting/posts/tf-aot-rust/#prepare-the-tensorflow-graph-for-compilation), which is based on [tf documentation](https://www.tensorflow.org/xla/tfcompile).\r\n<br>\r\nI am doing this in the latest `tensorflow/tensorflow` docker.\r\n<br>\r\nAll the tutorials I have seen deal with image processing, but my models receive one-dimensional vector. The config file looks like this:\r\n\r\n```\r\nfeed {\r\n  id {\r\n    node_name: \"dense_1_input\"\r\n  }\r\n  shape {\r\n    dim {\r\n      size: -1\r\n    }\r\n    dim {\r\n      size: 5\r\n    }\r\n  }\r\n}\r\nfetch {\r\n  id {\r\n    node_name: \"k2tfout_0\"\r\n  }\r\n}\r\n```\r\n\r\nIf I use it, the compilation fails. If I change `-1` for `1`, the model compiles, but whenever I try to use it, I get a core dump.\r\n<br>\r\nCould this be an issue with this negative one dimension? How do I compile such models?\r\n<br>\r\nI tried invoking my model using Python and flipping dimension numbers. (1,5) \u2013 (5,1) \u2013 (5,)...\r\n<br>E.g.:\r\n\r\n```\r\nimport numpy as np\r\nimport pandas as pd\r\n\r\nlibmodel = np.ctypeslib.load_library('libmodel', '/folder/org_tensorflow/')\r\n\r\nlibmodel.run.argtypes = [np.ctypeslib.ndpointer(np.float32, ndim=2, shape=(1,5), flags=('c', 'a')),\r\nnp.ctypeslib.ndpointer(np.float32, ndim=2, shape=(1,5), flags=('c', 'a', 'w')),\r\nnp.ctypeslib.ctypes.c_float,\r\nnp.ctypeslib.ctypes.c_float]\r\n\r\ndf = pd.read_csv('/folder/trial.csv', header = 0, index_col = None)\r\nfeats = pd.read_table('/folder/feature_list.txt', header=None, index_col = None)\r\nfeats = feats.iloc[:,0].tolist()\r\ndf = df.reindex(columns=feats, fill_value=0)\r\n\r\nx = np.require(df.iloc[0,:], np.float32, ('c', 'a'))\r\ny = np.require(np.zeros((1,1)), np.float32, ('c', 'a', 'w'))\r\n\r\nx = x.reshape((1,5))\r\nlibmodel.run(x, y, x.size, y.size)\r\n```\r\n\r\nIs it possible to compile such models with negative one dimension? If so, it should be in documentation."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32159", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32159/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32159/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32159/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32159", "id": 488283968, "node_id": "MDU6SXNzdWU0ODgyODM5Njg=", "number": 32159, "title": "TF 2.0 regression: cloudpickle cannot serialize tf.keras.Sequential.", "user": {"login": "robertnishihara", "id": 249517, "node_id": "MDQ6VXNlcjI0OTUxNw==", "avatar_url": "https://avatars3.githubusercontent.com/u/249517?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robertnishihara", "html_url": "https://github.com/robertnishihara", "followers_url": "https://api.github.com/users/robertnishihara/followers", "following_url": "https://api.github.com/users/robertnishihara/following{/other_user}", "gists_url": "https://api.github.com/users/robertnishihara/gists{/gist_id}", "starred_url": "https://api.github.com/users/robertnishihara/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robertnishihara/subscriptions", "organizations_url": "https://api.github.com/users/robertnishihara/orgs", "repos_url": "https://api.github.com/users/robertnishihara/repos", "events_url": "https://api.github.com/users/robertnishihara/events{/privacy}", "received_events_url": "https://api.github.com/users/robertnishihara/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, {"login": "yifeif", "id": 1192265, "node_id": "MDQ6VXNlcjExOTIyNjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/1192265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yifeif", "html_url": "https://github.com/yifeif", "followers_url": "https://api.github.com/users/yifeif/followers", "following_url": "https://api.github.com/users/yifeif/following{/other_user}", "gists_url": "https://api.github.com/users/yifeif/gists{/gist_id}", "starred_url": "https://api.github.com/users/yifeif/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yifeif/subscriptions", "organizations_url": "https://api.github.com/users/yifeif/orgs", "repos_url": "https://api.github.com/users/yifeif/repos", "events_url": "https://api.github.com/users/yifeif/events{/privacy}", "received_events_url": "https://api.github.com/users/yifeif/received_events", "type": "User", "site_admin": false}, {"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 21, "created_at": "2019-09-02T18:06:39Z", "updated_at": "2019-11-02T12:01:36Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes (code included below in the issue)\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): MacOS 10.14.3\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): pip \r\n- TensorFlow version (use command below): v2.0.0-beta1-5101-gc75bb66a99 2.0.0-rc0\r\n- Python version: Python 3.6.7 :: Anaconda, Inc.\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source): N/A\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: N/A\r\n\r\nUsing cloudpickle to serialize a Python function that uses `tf.keras.Sequential` fails with a recursion error.\r\n\r\n**Note** that this works with `tensorflow==1.14.0`.\r\n\r\nI imagine it also fails with other things, not just `tf.keras.Sequential`.\r\n\r\n```python\r\nimport cloudpickle  # cloudpickle.__version__ == '1.2.1'\r\nimport tensorflow as tf  # tf.__version__ == '2.0.0-rc0'\r\n\r\ndef f():\r\n    tf.keras.Sequential\r\n\r\ncloudpickle.loads(cloudpickle.dumps(f))  # This fails.\r\n```\r\n\r\nThe last line fails with\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nRecursionError                            Traceback (most recent call last)\r\n<ipython-input-23-25cc307e6227> in <module>\r\n----> 1 cloudpickle.loads(cloudpickle.dumps(f))\r\n\r\n~/anaconda3/lib/python3.6/site-packages/tensorflow/__init__.py in __getattr__(self, item)\r\n     48 \r\n     49   def __getattr__(self, item):\r\n---> 50     module = self._load()\r\n     51     return getattr(module, item)\r\n     52 \r\n\r\n~/anaconda3/lib/python3.6/site-packages/tensorflow/__init__.py in _load(self)\r\n     42   def _load(self):\r\n     43     \"\"\"Import the target module and insert it into the parent's namespace.\"\"\"\r\n---> 44     module = _importlib.import_module(self.__name__)\r\n     45     self._parent_module_globals[self._local_name] = module\r\n     46     self.__dict__.update(module.__dict__)\r\n\r\n... last 2 frames repeated, from the frame below ...\r\n\r\n~/anaconda3/lib/python3.6/site-packages/tensorflow/__init__.py in __getattr__(self, item)\r\n     48 \r\n     49   def __getattr__(self, item):\r\n---> 50     module = self._load()\r\n     51     return getattr(module, item)\r\n     52 \r\n\r\nRecursionError: maximum recursion depth exceeded while calling a Python object\r\n```\r\n\r\nSee https://stackoverflow.com/questions/57750920/ray-tensorflow-gpu-2-0-recursionerror/57761034#57761034"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32158", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32158/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32158/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32158/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32158", "id": 488283707, "node_id": "MDU6SXNzdWU0ODgyODM3MDc=", "number": 32158, "title": "tf.gather should support batch_dims == rank(indices)", "user": {"login": "mpdn", "id": 448023, "node_id": "MDQ6VXNlcjQ0ODAyMw==", "avatar_url": "https://avatars3.githubusercontent.com/u/448023?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpdn", "html_url": "https://github.com/mpdn", "followers_url": "https://api.github.com/users/mpdn/followers", "following_url": "https://api.github.com/users/mpdn/following{/other_user}", "gists_url": "https://api.github.com/users/mpdn/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpdn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpdn/subscriptions", "organizations_url": "https://api.github.com/users/mpdn/orgs", "repos_url": "https://api.github.com/users/mpdn/repos", "events_url": "https://api.github.com/users/mpdn/events{/privacy}", "received_events_url": "https://api.github.com/users/mpdn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-09-02T18:05:27Z", "updated_at": "2019-09-11T00:33:14Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using): 2.0\r\n- Are you willing to contribute it (Yes/No): Yes, if it's just overzealous checks.\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\nCurrently, `tf.gather` requires that `batch_dim` is less than `rank(indices)`, but it seems like `batch_dim == rank(indices)` should logically be supported as well. This would be equivalent to a scalar lookup in the last axis of `params`.\r\n\r\nSupporting this should come pretty natural and I think that, for the CPU code at least, it is already supported; the checks just need to be changed from `<` to `<=`.\r\n\r\n**Will this change the current api? How?**\r\n\r\nNo."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32145", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32145/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32145/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32145/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32145", "id": 487974807, "node_id": "MDU6SXNzdWU0ODc5NzQ4MDc=", "number": 32145, "title": "The function tf.graph_util.remove_training_nodes doesn't work as expected", "user": {"login": "haifenghan", "id": 4157827, "node_id": "MDQ6VXNlcjQxNTc4Mjc=", "avatar_url": "https://avatars1.githubusercontent.com/u/4157827?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haifenghan", "html_url": "https://github.com/haifenghan", "followers_url": "https://api.github.com/users/haifenghan/followers", "following_url": "https://api.github.com/users/haifenghan/following{/other_user}", "gists_url": "https://api.github.com/users/haifenghan/gists{/gist_id}", "starred_url": "https://api.github.com/users/haifenghan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haifenghan/subscriptions", "organizations_url": "https://api.github.com/users/haifenghan/orgs", "repos_url": "https://api.github.com/users/haifenghan/repos", "events_url": "https://api.github.com/users/haifenghan/events{/privacy}", "received_events_url": "https://api.github.com/users/haifenghan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-09-02T03:18:44Z", "updated_at": "2019-09-04T05:50:16Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: No\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 1.14.0\r\n- Python version: Python 3.6.8\r\n- Bazel version (if compiling from source): NO\r\n- GCC/Compiler version (if compiling from source): NO\r\n- CUDA/cuDNN version: NA\r\n- GPU model and memory: NA\r\n\r\n**Describe the current behavior**\r\nWhen I trying to remove training node with the function tf.graph_util.remove_training_nodes, a Identity node named \"FeatureExtractor/MobilenetV2/expanded_conv_13/expansion_output\r\n\" is not removed.\r\n\r\n![image](https://user-images.githubusercontent.com/4157827/64088048-358e6100-cd72-11e9-93c3-8dfbdab3fc14.png)\r\n\r\n**Describe the expected behavior**\r\nI tried this in Python2 and there is no such issue. Could you look into it?\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\nYou can get the model from http://download.tensorflow.org/models/object_detection/ssd_mobilenet_v2_coco_2018_03_29.tar.gz\r\nAfter untar, you'll see ssd_mobilenet_v2_coco_2018_03_29/frozen_inference_graph.pb.\r\n```\r\nimport tensorflow as tf\r\ninput_graph_def = tf.GraphDef()\r\nwith open(\"ssd_mobilenet_v2_coco_2018_03_29/frozen_inference_graph.pb\", \"rb\") as f:\r\n    input_graph_def.ParseFromString(f.read())\r\nout_graph_def = tf..graph_util.remove_training_nodes(input_graph_def)\r\ntf.io.write_graph(out_graph_def, \"./\", \"fused.pb\", as_text=False)\r\n```\r\n Then you can review it in https://lutzroeder.github.io/netron/\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\nNA"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32142", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32142/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32142/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32142/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32142", "id": 487925293, "node_id": "MDU6SXNzdWU0ODc5MjUyOTM=", "number": 32142, "title": "Custom loss with extra argument in TF 2.0", "user": {"login": "lminer", "id": 5126549, "node_id": "MDQ6VXNlcjUxMjY1NDk=", "avatar_url": "https://avatars2.githubusercontent.com/u/5126549?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lminer", "html_url": "https://github.com/lminer", "followers_url": "https://api.github.com/users/lminer/followers", "following_url": "https://api.github.com/users/lminer/following{/other_user}", "gists_url": "https://api.github.com/users/lminer/gists{/gist_id}", "starred_url": "https://api.github.com/users/lminer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lminer/subscriptions", "organizations_url": "https://api.github.com/users/lminer/orgs", "repos_url": "https://api.github.com/users/lminer/repos", "events_url": "https://api.github.com/users/lminer/events{/privacy}", "received_events_url": "https://api.github.com/users/lminer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 14, "created_at": "2019-09-01T20:04:25Z", "updated_at": "2019-12-21T08:39:05Z", "closed_at": null, "author_association": "NONE", "body": "The traditional method of creating a custom loss function with an additional input for tf.keras no longer functions in tensorflow 2.0. It seems like the only way to do it now is with a custom training loop, which means you lose a lot of the convenience of keras (callbacks etc).\r\n\r\nIn the following case, the extra argument is the input data into the model, which is contained in a `Dataset`. In 1.14 case, I'd run `.make_one_shot_iterator().get_next()` on the dataset and then pass the tensor I get into the loss function. This isn't possible with eager execution, so instead I've tried to just pass the dataset.\r\n\r\n```python\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\n\r\nclass WeightedSDRLoss(tf.keras.losses.Loss):\r\n\r\n    def __init__(self, noisy_signal, reduction=tf.keras.losses.Reduction.AUTO, name='WeightedSDRLoss'):\r\n        super().__init__(reduction=reduction, name=name)\r\n        self.noisy_signal = noisy_signal\r\n\r\n    def sdr_loss(self, sig_true, sig_pred):\r\n        return (-tf.reduce_mean(sig_true * sig_pred) /\r\n                (tf.norm(tensor=sig_pred) * tf.norm(tensor=sig_true)))\r\n\r\n    def call(self, y_true, y_pred):\r\n        noise_true = self.noisy_signal - y_true\r\n        noise_pred = self.noisy_signal - y_pred\r\n        alpha = (tf.reduce_mean(tf.square(y_true)) /\r\n                 tf.reduce_mean(tf.square(y_true) + tf.square(self.noisy_signal - y_pred)))\r\n        return alpha * self.sdr_loss(y_true, y_pred) + (1 - alpha) * self.sdr_loss(noise_true, noise_pre$\r\n\r\ndata_x = np.random.rand(5, 4, 1)\r\ndata_y = np.random.rand(5, 4, 1)\r\n\r\nx = tf.keras.layers.Input(shape=[4, 1])\r\ny = tf.keras.layers.Activation('tanh')(x)\r\nmodel = tf.keras.models.Model(inputs=x, outputs=y)\r\n\r\ntrain_dataset = tf.data.Dataset.from_tensor_slices((data_x, data_y)).batch(1)\r\n\r\nmodel.compile(loss=WeightedSDRLoss(x))\r\nmodel.fit(train_dataset)\r\n```\r\n\r\n I get the error:\r\n\r\n````python\r\nop_name = '__inference_distributed_function_169', num_outputs = 2\r\ninputs = [<tf.Tensor: id=82, shape=(), dtype=resource, numpy=<unprintable>>, <tf.Tensor: id=83, shape=(), dtype=variant, numpy=<unprintable>>, <tf.Tensor 'input_1:0' shape=(None, 4, 1) dtype=float32>]\r\nattrs = ('executor_type', '', 'config_proto', b'\\n\\x07\\n\\x03GPU\\x10\\x00\\n\\x07\\n\\x03CPU\\x10\\x012\\x02J\\x008\\x01')\r\nctx = <tensorflow.python.eager.context.Context object at 0x11785f4e0>\r\nname = None\r\n\r\n    def quick_execute(op_name, num_outputs, inputs, attrs, ctx, name=None):\r\n      \"\"\"Execute a TensorFlow operation.\r\n    \r\n      Args:\r\n        op_name: Name of the TensorFlow operation (see REGISTER_OP in C++ code) to\r\n          execute.\r\n        num_outputs: The number of outputs of the operation to fetch.\r\n                     (Explicitly provided instead of being inferred for performance\r\n                     reasons).\r\n        inputs: A list of inputs to the operation. Each entry should be a Tensor, or\r\n          a value which can be passed to the Tensor constructor to create one.\r\n        attrs: A tuple with alternating string attr names and attr values for this\r\n          operation.\r\n        ctx: The value of context.context().\r\n        name: Customized name for the operation.\r\n    \r\n      Returns:\r\n        List of output Tensor objects. The list is empty if there are no outputs\r\n    \r\n      Raises:\r\n        An exception on error.\r\n      \"\"\"\r\n      device_name = ctx.device_name\r\n      # pylint: disable=protected-access\r\n      try:\r\n        ctx.ensure_initialized()\r\n        tensors = pywrap_tensorflow.TFE_Py_Execute(ctx._handle, device_name,\r\n                                                   op_name, inputs, attrs,\r\n>                                                  num_outputs)\r\nE                                                  TypeError: An op outside of the function building code is being passed\r\nE                                                  a \"Graph\" tensor. It is possible to have Graph tensors\r\nE                                                  leak out of the function building context by including a\r\nE                                                  tf.init_scope in your function building code.\r\nE                                                  For example, the following function will fail:\r\nE                                                    @tf.function\r\nE                                                    def has_init_scope():\r\nE                                                      my_constant = tf.constant(1.)\r\nE                                                      with tf.init_scope():\r\nE                                                        added = my_constant * 2\r\nE                                                  The graph tensor has name: input_1:0\r\n\r\n../../../anaconda3/envs/separate2/lib/python3.6/site-packages/tensorflow_core/python/eager/execute.py:61: TypeError\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\n    def test_loss():\r\n    \r\n        data_x = np.random.rand(5, 4, 1)\r\n        data_y = np.random.rand(5, 4, 1)\r\n    \r\n        x = keras.layers.Input(shape=[4, 1])\r\n        y = keras.layers.Activation('tanh')(x)\r\n        model = keras.models.Model(inputs=x, outputs=y)\r\n    \r\n        train_dataset = tf.data.Dataset.from_tensor_slices((data_x, data_y)).batch(1)\r\n        print(train_dataset)\r\n    \r\n        model.compile(loss=WeightedSDRLoss(x))\r\n>       model.fit(train_dataset)\r\n\r\ntest_preprocess.py:162: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n../../../anaconda3/envs/separate2/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training.py:734: in fit\r\n    use_multiprocessing=use_multiprocessing)\r\n../../../anaconda3/envs/separate2/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2.py:324: in fit\r\n    total_epochs=epochs)\r\n../../../anaconda3/envs/separate2/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2.py:123: in run_one_epoch\r\n    batch_outs = execution_function(iterator)\r\n../../../anaconda3/envs/separate2/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py:86: in execution_function\r\n    distributed_function(input_fn))\r\n../../../anaconda3/envs/separate2/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py:445: in __call__\r\n    return self._concrete_stateful_fn._filtered_call(canon_args, canon_kwds)  # pylint: disable=protected-access\r\n../../../anaconda3/envs/separate2/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py:1141: in _filtered_call\r\n    self.captured_inputs)\r\n../../../anaconda3/envs/separate2/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py:1224: in _call_flat\r\n    ctx, args, cancellation_manager=cancellation_manager)\r\n../../../anaconda3/envs/separate2/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py:511: in call\r\n    ctx=ctx)\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nop_name = '__inference_distributed_function_169', num_outputs = 2\r\ninputs = [<tf.Tensor: id=82, shape=(), dtype=resource, numpy=<unprintable>>, <tf.Tensor: id=83, shape=(), dtype=variant, numpy=<unprintable>>, <tf.Tensor 'input_1:0' shape=(None, 4, 1) dtype=float32>]\r\nattrs = ('executor_type', '', 'config_proto', b'\\n\\x07\\n\\x03GPU\\x10\\x00\\n\\x07\\n\\x03CPU\\x10\\x012\\x02J\\x008\\x01')\r\nctx = <tensorflow.python.eager.context.Context object at 0x11785f4e0>\r\nname = None\r\n\r\n    def quick_execute(op_name, num_outputs, inputs, attrs, ctx, name=None):\r\n      \"\"\"Execute a TensorFlow operation.\r\n    \r\n      Args:\r\n        op_name: Name of the TensorFlow operation (see REGISTER_OP in C++ code) to\r\n          execute.\r\n        num_outputs: The number of outputs of the operation to fetch.\r\n                     (Explicitly provided instead of being inferred for performance\r\n                     reasons).\r\n        inputs: A list of inputs to the operation. Each entry should be a Tensor, or\r\n          a value which can be passed to the Tensor constructor to create one.\r\n        attrs: A tuple with alternating string attr names and attr values for this\r\n          operation.\r\n        ctx: The value of context.context().\r\n        name: Customized name for the operation.\r\n    \r\n      Returns:\r\n        List of output Tensor objects. The list is empty if there are no outputs\r\n    \r\n      Raises:\r\n        An exception on error.\r\n      \"\"\"\r\n      device_name = ctx.device_name\r\n      # pylint: disable=protected-access\r\n      try:\r\n        ctx.ensure_initialized()\r\n        tensors = pywrap_tensorflow.TFE_Py_Execute(ctx._handle, device_name,\r\n                                                   op_name, inputs, attrs,\r\n                                                   num_outputs)\r\n      except core._NotOkStatusException as e:\r\n        if name is not None:\r\n          message = e.message + \" name: \" + name\r\n        else:\r\n          message = e.message\r\n        six.raise_from(core._status_to_exception(e.code, message), None)\r\n      except TypeError as e:\r\n        keras_symbolic_tensors = [\r\n            x for x in inputs if ops._is_keras_symbolic_tensor(x)\r\n        ]\r\n        if keras_symbolic_tensors:\r\n          raise core._SymbolicException(\r\n              \"Inputs to eager execution function cannot be Keras symbolic \"\r\n>             \"tensors, but found {}\".format(keras_symbolic_tensors))\r\nE         tensorflow.python.eager.core._SymbolicException: Inputs to eager execution function cannot be Keras symbolic tensors, but found [<tf.Tensor 'input_1:0' shape=(None, 4, 1) dtype=float32>]\r\n````\r\n\r\nBasically seems like the previous way of passing extra arguments into a loss function in keras is broken.\r\n\r\nI'm running tensorflow 2.0-rc0 and this happens regardless of the platform.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32133", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32133/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32133/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32133/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32133", "id": 487773815, "node_id": "MDU6SXNzdWU0ODc3NzM4MTU=", "number": 32133, "title": "TF 2.0 - Gradient of 'tf.keras.layers.Dense with bias' produces non-deterministic result", "user": {"login": "movinghoon", "id": 49489804, "node_id": "MDQ6VXNlcjQ5NDg5ODA0", "avatar_url": "https://avatars0.githubusercontent.com/u/49489804?v=4", "gravatar_id": "", "url": "https://api.github.com/users/movinghoon", "html_url": "https://github.com/movinghoon", "followers_url": "https://api.github.com/users/movinghoon/followers", "following_url": "https://api.github.com/users/movinghoon/following{/other_user}", "gists_url": "https://api.github.com/users/movinghoon/gists{/gist_id}", "starred_url": "https://api.github.com/users/movinghoon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/movinghoon/subscriptions", "organizations_url": "https://api.github.com/users/movinghoon/orgs", "repos_url": "https://api.github.com/users/movinghoon/repos", "events_url": "https://api.github.com/users/movinghoon/events{/privacy}", "received_events_url": "https://api.github.com/users/movinghoon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-08-31T14:08:42Z", "updated_at": "2019-09-06T19:37:47Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): pip install tf-nightly-gpu-2.0-preview==2.0.0.dev20190826\r\n- TensorFlow version (use command below): v1.12.1-9705-g0fbc138 2.0.0-dev20190826\r\n- Python version: 3.6.9\r\n- CUDA/cuDNN version: 10.0.0/7.3.1\r\n- GPU model and memory: Titan Xp 11Gb\r\n\r\n**Describe the current behavior**\r\n (1) The following code produces the same 'numpy_data0.pkl', 'initial_params0.pkl', 'loss0.pkl' all the times (which means same data, same parameter, same loss), but 'grad0.pkl' changes. I checked it with 'diff' command between generated files. \r\n (2) It seems only with tensorflow 2.0 GPU version, this happens. I checked the code with tf-nightly-2.0-preview==2.0.0.dev20190830 (CPU version), it was ok. (= shows deterministic result)\r\n (3) Using custom dense layer + tf.keras.layers.ReLU() was ok also. (= shows deterministic result) Custom dense layer was\r\n```\r\nclass MyDenseLayer(tf.keras.layers.Layer):\r\n    def __init__(self, num_outputs):\r\n        super(MyDenseLayer, self).__init__()\r\n        self.num_outputs = num_outputs\r\n    def build(self, input_shape):\r\n        self.kernel = self.add_variable(\"kernel\", initializer=tf.keras.initializers.GlorotUniform(),\r\n                                        shape=[int(input_shape[-1]),\r\n                                               self.num_outputs])\r\n        self.bias = self.add_variable(\"bias\", initializer=tf.zeros_initializer,\r\n                                        shape=[self.num_outputs])\r\n    def call(self, input):\r\n        return tf.matmul(input, self.kernel) + self.bias\r\n```\r\nAnd net with\r\n```\r\nnet = tf.keras.Sequential()\r\nnet.add(MyDenseLayer(100))\r\nnet.add(tf.keras.layers.ReLU())\r\nnet.add(MyDenseLayer(100))\r\nnet.add(tf.keras.layers.ReLU())\r\nnet.add(MyDenseLayer(1))\r\nnet.build((None, input_dim))\r\n```\r\n (+) When 'use_bias=False' option applied on hidden layers, is was ok. (= shows deterministic result)\r\n\r\n\r\n**Describe the expected behavior**\r\nSince CUDNN force to behave determinisically (os.environ['TF_CUDNN_DETERMINISTIC'] = 'true'), and all the data/parameter/loss are the same, grad is expected to be same.\r\n\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport os\r\nimport pickle\r\nimport random\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\nos.environ['TF_CUDNN_DETERMINISTIC'] = 'true'\r\n\r\nseed = 1234\r\nnp.random.seed(seed)\r\ntf.random.set_seed(seed)\r\nrandom.seed(seed)\r\n\r\n# NN Model\r\ninput_dim = 5\r\nnet = tf.keras.Sequential()\r\nnet.add(tf.keras.layers.Dense(100, activation=tf.nn.relu, kernel_initializer=None))\r\nnet.add(tf.keras.layers.Dense(100, activation=tf.nn.relu, kernel_initializer=None))\r\nnet.add(tf.keras.layers.Dense(1, activation=None, kernel_initializer=None))\r\nnet.build((None, input_dim))\r\n\r\n# Initial v_params\r\ninitial_v_params = net.variables\r\n\r\n# Update NN Model one-step\r\nx = np.random.normal(loc=0, scale=1., size=[1000, input_dim])\r\ny = np.random.normal(loc=0, scale=1., size=[1000])\r\n\r\nwith tf.GradientTape() as tape:\r\n    loss = tf.reduce_mean(tf.square(y - net(x)))\r\ngrad = tape.gradient(loss, net.trainable_variables)\r\n\r\n# Tag for comparing files\r\ntag = 1\r\n\r\nwith open('./numpy_data{}.pkl'.format(tag), 'wb') as f:\r\n    pickle.dump([x, y], f)\r\n\r\nwith open('./initial_params{}.pkl'.format(tag), 'wb') as f:\r\n    pickle.dump(initial_v_params, f)\r\n\r\nwith open('./loss{}.pkl'.format(tag), 'wb') as f:\r\n    pickle.dump(loss, f)\r\n\r\nwith open('./grad{}.pkl'.format(tag), 'wb') as f:\r\n    pickle.dump(grad, f)\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32130", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32130/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32130/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32130/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32130", "id": 487762490, "node_id": "MDU6SXNzdWU0ODc3NjI0OTA=", "number": 32130, "title": "Can not store plugin name  in logs ( which is then used by  tensorboard to read data for relavant plugin)", "user": {"login": "sahilpasricja", "id": 20474934, "node_id": "MDQ6VXNlcjIwNDc0OTM0", "avatar_url": "https://avatars3.githubusercontent.com/u/20474934?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sahilpasricja", "html_url": "https://github.com/sahilpasricja", "followers_url": "https://api.github.com/users/sahilpasricja/followers", "following_url": "https://api.github.com/users/sahilpasricja/following{/other_user}", "gists_url": "https://api.github.com/users/sahilpasricja/gists{/gist_id}", "starred_url": "https://api.github.com/users/sahilpasricja/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sahilpasricja/subscriptions", "organizations_url": "https://api.github.com/users/sahilpasricja/orgs", "repos_url": "https://api.github.com/users/sahilpasricja/repos", "events_url": "https://api.github.com/users/sahilpasricja/events{/privacy}", "received_events_url": "https://api.github.com/users/sahilpasricja/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 284285184, "node_id": "MDU6TGFiZWwyODQyODUxODQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tensorboard", "name": "comp:tensorboard", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "nfelt", "id": 710113, "node_id": "MDQ6VXNlcjcxMDExMw==", "avatar_url": "https://avatars0.githubusercontent.com/u/710113?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nfelt", "html_url": "https://github.com/nfelt", "followers_url": "https://api.github.com/users/nfelt/followers", "following_url": "https://api.github.com/users/nfelt/following{/other_user}", "gists_url": "https://api.github.com/users/nfelt/gists{/gist_id}", "starred_url": "https://api.github.com/users/nfelt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nfelt/subscriptions", "organizations_url": "https://api.github.com/users/nfelt/orgs", "repos_url": "https://api.github.com/users/nfelt/repos", "events_url": "https://api.github.com/users/nfelt/events{/privacy}", "received_events_url": "https://api.github.com/users/nfelt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nfelt", "id": 710113, "node_id": "MDQ6VXNlcjcxMDExMw==", "avatar_url": "https://avatars0.githubusercontent.com/u/710113?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nfelt", "html_url": "https://github.com/nfelt", "followers_url": "https://api.github.com/users/nfelt/followers", "following_url": "https://api.github.com/users/nfelt/following{/other_user}", "gists_url": "https://api.github.com/users/nfelt/gists{/gist_id}", "starred_url": "https://api.github.com/users/nfelt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nfelt/subscriptions", "organizations_url": "https://api.github.com/users/nfelt/orgs", "repos_url": "https://api.github.com/users/nfelt/repos", "events_url": "https://api.github.com/users/nfelt/events{/privacy}", "received_events_url": "https://api.github.com/users/nfelt/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-08-31T11:54:20Z", "updated_at": "2019-09-16T19:25:23Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution -  Linux Ubuntu 18.04:\r\n- TensorFlow version (or github SHA if from source):1.14.0\r\n\r\nIn my existing model, i am using CNN model with tf.layers \r\n\r\n\r\ndef mnist_cnn(inputs):\r\n\r\n    \r\n\r\n\r\n`\r\ndef mnist_cnn(inputs):\r\n\r\n    input_layer = tf.reshape(inputs, [-1, 28, 28, 3])\r\n\r\n    # Convolutional Layer #1\r\n    conv1 = tf.layers.conv2d(\r\n          inputs=input_layer,\r\n          filters=32,\r\n          kernel_size=[5, 5],\r\n          padding=\"same\",\r\n          activation=tf.nn.relu,\r\n          name=\"conv1\",\r\n    )\r\n\t  \r\n\r\n\r\n    # Pooling Layer #1\r\n    pool1 = tf.layers.max_pooling2d(inputs=conv1, pool_size=[2, 2], strides=2)\r\n\r\n    # Convolutional Layer #2 and Pooling Layer #2\r\n    conv2 = tf.layers.conv2d(\r\n          inputs=pool1,\r\n          filters=64,\r\n          kernel_size=[5, 5],\r\n          padding=\"same\",\r\n          activation=tf.nn.relu)\r\n\r\n    # weights_1_array = np.zeros((786, 28, 28, 32))\r\n    # conv_kernel_1 = tf.nn.conv2d(conv1, weights_1_array, [1, 4, 4, 1], padding='SAME')\r\n\r\n\r\n    # kernel = tf.get_collection(tf.GraphKeys.VARIABLES, 'conv1/kernel')[0]\r\n\r\n\r\n\r\n    pool2 = tf.layers.max_pooling2d(inputs=conv2, pool_size=[2, 2], strides=2)\r\n\r\n    # Dense Layer\r\n    pool2_flat = tf.reshape(pool2, [-1, 7 * 7 * 64])\r\n    dense = tf.layers.dense(inputs=pool2_flat, units=1024, activation=tf.nn.relu)\r\n    dropout = tf.layers.dropout(inputs=dense, rate=0.4)\r\n\r\n\r\n    # Logits Layer\r\n    outputs = tf.layers.dense(inputs=dropout, units=10)\r\n`\r\nAnd i used to write logs using summary \r\n\r\n` tensor_summaries = list(map(lambda graph_node:\r\n                                tf.summary.tensor_summary(graph_node.name,\r\n                                                          graph.get_tensor_by_name(graph_node.name + \":0\"),\r\n                                                          summary_metadata=tf.SummaryMetadata(\r\n                                                              display_name=graph_node.name,\r\n                                                              summary_description=description,\r\n                                                              plugin_data=tf.SummaryMetadata.PluginData(\r\n                                                                  plugin_name=PLUGIN_NAME)),\r\n                                                          collections=collections),\r\n                                tensor_ops))`\r\n\r\nWithin this summary, there was a feature to write plugin name , this plugin name is then used by my custom tensor board to identify data from my plugin.\r\n\r\nWith tf keras , we have callbacks like save.model to store weight but that don't give an option to write plugin name this makes it impossible for tensorboard to identify  data for my plugin , \r\n\r\nIs there any way to write logs with plugin name using call back ?\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32128", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32128/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32128/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32128/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32128", "id": 487741391, "node_id": "MDU6SXNzdWU0ODc3NDEzOTE=", "number": 32128, "title": "Sessions that are closed and reset and all inputs and outputs are out of scope, do not release GPU memory.", "user": {"login": "samhodge", "id": 86946, "node_id": "MDQ6VXNlcjg2OTQ2", "avatar_url": "https://avatars0.githubusercontent.com/u/86946?v=4", "gravatar_id": "", "url": "https://api.github.com/users/samhodge", "html_url": "https://github.com/samhodge", "followers_url": "https://api.github.com/users/samhodge/followers", "following_url": "https://api.github.com/users/samhodge/following{/other_user}", "gists_url": "https://api.github.com/users/samhodge/gists{/gist_id}", "starred_url": "https://api.github.com/users/samhodge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/samhodge/subscriptions", "organizations_url": "https://api.github.com/users/samhodge/orgs", "repos_url": "https://api.github.com/users/samhodge/repos", "events_url": "https://api.github.com/users/samhodge/events{/privacy}", "received_events_url": "https://api.github.com/users/samhodge/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1162044565, "node_id": "MDU6TGFiZWwxMTYyMDQ0NTY1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.12", "name": "TF 1.12", "color": "c2e0c6", "default": false, "description": "Issues related to TF 1.12"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-08-31T07:29:12Z", "updated_at": "2019-12-18T17:57:44Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):MacOS 10.13\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary):source 1.12.0\r\n- TensorFlow version (use command below):\r\n- Python version:NA\r\n- Bazel version (if compiling from source):0.19.2\r\n- GCC/Compiler version (if compiling from source):Apple LLVM version 9.1.0 (clang-902.0.39.2)\r\n- CUDA/cuDNN version:10.0.130\r\n- GPU model and memory:GTX 1060\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nMemory from tensorflow sessions is not freed when a session is closed and no variables are in scope, memory is only freed on program exit\r\n**Describe the expected behavior**\r\nMemory should be freed from the GPU on calling close and reset in C++, or some other way to release GPU resources without forking a process.\r\n**Code to reproduce the issue**\r\n\r\n```\r\n#include <stdlib.h>     /* getenv */\r\n#include <iostream>\t\t\r\n#include <tensorflow/core/platform/init_main.h>\r\n#include <tensorflow/core/public/session.h>\r\n#include <tensorflow/core/framework/tensor_shape.h>\r\n#include <string>\r\n#include \"cuda_runtime_api.h\"\r\n#include <cuda.h>\r\n\r\n\r\nint freeCudaMem(){\r\n\t\tint gpuCount, i;\r\n\t\tCUresult res;\r\n\t\tCUdevice dev;\r\n\t\tCUcontext ctx;\r\n\t\tint result;\r\n\t\tcuInit(0);\r\n\t\tcuDeviceGetCount(&gpuCount);\r\n\t\tsize_t curClockRate = 0;\r\n\t\tsize_t curMaxMem = 0;\r\n\r\n\t\tfor (int i = 0; i < gpuCount; i++) {\r\n\t\t\tcudaSetDevice(i);\r\n\t\t\tcudaDeviceProp curDeviceProp;\r\n\t\t\tcudaError_t err = cudaGetDeviceProperties(&curDeviceProp, i);\r\n\t\t\tif (err != cudaSuccess) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tsize_t free_mem, total_mem;\r\n\t\t\tcuDeviceGet(&dev, i);\r\n\t\t\tcuCtxCreate(&ctx, 0, dev);\r\n\t\t\tres = cuMemGetInfo(&free_mem, &total_mem);\r\n\t\t\tresult= (int)free_mem;\r\n\t\t}\r\n\t\treturn result;\r\n}\r\n\r\n\r\nint main (int argc, char *argv[]) { \r\n\tsetenv(\"TF_CPP_MIN_VLOG_LEVEL\", \"3\", 1);\r\n\tsetenv(\"TF_CPP_MIN_LOG_LEVEL\", \"3\", 1);\r\n\r\n\t{\r\n\t\tstd::cout << \"Start of program:  \" << freeCudaMem() << std::endl;\r\n\t\ttensorflow::SessionOptions options;\r\n\t\ttensorflow::ConfigProto &config = options.config;\r\n\t\tconfig.mutable_gpu_options()->set_allow_growth(true);\r\n\t\tauto* device_count = options.config.mutable_device_count();\r\n\t\tdevice_count->insert({ \"GPU\", 1 });\r\n\t\tdevice_count->insert({ \"CPU\", 1 });\r\n\r\n\t\tstd::unique_ptr<tensorflow::Session> session = std::unique_ptr<tensorflow::Session>(tensorflow::NewSession(options));\t\r\n\r\n\t\ttensorflow::GraphDef graph_def;\r\n\t\tstd::string graphFile(\"/path/to/large/frozen_model.pb\");\r\n\t\ttensorflow::Status graphLoadedStatus = ReadBinaryProto(tensorflow::Env::Default(),graphFile.c_str(),&graph_def);\r\n\t\tauto inputTensor2 = tensorflow::Tensor(tensorflow::DT_UINT8, { 1, 2048, 2048, 3 });\r\n\t\tstd::vector<tensorflow::Tensor> outputs;\r\n\t\ttensorflow::Status session_create_status = session->Create(graph_def);                                                        \r\n\t\ttensorflow::Status run_status = session->Run({ { \"InputTensor\", inputTensor2 } }, { { \"OutputTensor\" } },{},&outputs);\r\n\t\toutputs.clear();\t\r\n\t\tint number3;\r\n\t\tstd::cout << \"After session:     \" << freeCudaMem() << std::endl;\r\n\t\ttensorflow::Status closeStatus3  = session\t->Close();\r\n\t\tstd::cout << \"Close Status: \" << closeStatus3 << std::endl;  \r\n\t\tstd::cout << \"After close:       \" << freeCudaMem() << std::endl;                                                                                                        \r\n\t\tsession.reset();\r\n\t\tstd::cout << \"After reset:       \" << freeCudaMem() << std::endl;\r\n\t}\r\n\t{\r\n\t\tstd::cout << \"Start of program2: \" << freeCudaMem() << std::endl;\r\n\t\ttensorflow::SessionOptions options2;\r\n\t\ttensorflow::ConfigProto &config2 = options2.config;\r\n\t\tconfig2.mutable_gpu_options()->set_allow_growth(true);\r\n\t\tauto* device_count2 = options2.config.mutable_device_count();\r\n\t\tdevice_count2->insert({ \"GPU\", 1 });\r\n\t\tdevice_count2->insert({ \"CPU\", 1 });\r\n\r\n\t\tstd::unique_ptr<tensorflow::Session> session2 = std::unique_ptr<tensorflow::Session>(tensorflow::NewSession(options2));\t\r\n\r\n\r\n\t\ttensorflow::GraphDef graph_def2;\r\n\t\tstd::string graphFile2(\"/path/to/large/frozen_model.pb\");\r\n\t\ttensorflow::Status graphLoadedStatus2 = ReadBinaryProto(tensorflow::Env::Default(),graphFile2.c_str(),&graph_def2);\r\n\t\tauto inputTensor22 = tensorflow::Tensor(tensorflow::DT_UINT8, { 1, 2048, 2048, 3 });\r\n\t\tstd::vector<tensorflow::Tensor> outputs2;\r\n\t\ttensorflow::Status session_create_status2 = session2->Create(graph_def2);                                                        \r\n\t\ttensorflow::Status run_status2 = session2->Run({ { \"InputTensor\", inputTensor22 } }, { { \"OutputTensor\" } },{},&outputs2);\r\n\t\toutputs2.clear();\t\r\n\t\r\n\t\tint number2;\r\n\t\tstd::cout << \"After session2:    \" << freeCudaMem() << std::endl;\r\n\t\ttensorflow::Status closeStatus2  = session2->Close();\r\n\t\tstd::cout << \"Close Status2: \" << closeStatus2 << std::endl;  \r\n\t\tstd::cout << \"After close2:      \" << freeCudaMem() << std::endl;                                                                                                        \r\n\t\tsession2.reset();\r\n\t\tstd::cout << \"After reset2:      \" << freeCudaMem() << std::endl;\r\n\t}\r\n\t{\r\n\t\tstd::cout << \"Start of program3: \" << freeCudaMem() << std::endl;\r\n\t\ttensorflow::SessionOptions options3;\r\n\t\ttensorflow::ConfigProto &config3 = options3.config;\r\n\t\tconfig3.mutable_gpu_options()->set_allow_growth(true);\r\n\t\tauto* device_count3 = options3.config.mutable_device_count();\r\n\t\tdevice_count3->insert({ \"GPU\", 1 });\r\n\t\tdevice_count3->insert({ \"CPU\", 1 });\r\n\t\tstd::unique_ptr<tensorflow::Session> session3 = std::unique_ptr<tensorflow::Session>(tensorflow::NewSession(options3));\t\r\n\t\ttensorflow::GraphDef graph_def3;\r\n\t\tstd::string graphFile3(\"/path/to/large/frozen_model.pb\");\r\n\t\ttensorflow::Status graphLoadedStatus3 = ReadBinaryProto(tensorflow::Env::Default(),graphFile3.c_str(),&graph_def3);\r\n\t\tauto inputTensor32 = tensorflow::Tensor(tensorflow::DT_UINT8, { 1, 2048, 2048, 3 });\r\n\t\tstd::vector<tensorflow::Tensor> outputs3;\r\n\t\ttensorflow::Status session_create_status3 = session3->Create(graph_def3);                                                        \r\n\t\ttensorflow::Status run_status3 = session3->Run({ { \"InputTensor\", inputTensor32 } }, { { \"OutputTensor\" } },{},&outputs3);\r\n\t\toutputs3.clear();\t\r\n\t\tint number3;\r\n\t\tstd::cout << \"After session3:    \" << freeCudaMem() << std::endl;\r\n\t\ttensorflow::Status closeStatus3  = session3->Close();\r\n\t\tstd::cout << \"Close Status3: \" << closeStatus3 << std::endl;  \r\n\t\tstd::cout << \"After close3:      \" << freeCudaMem() << std::endl;                                                                                                        \r\n\t\tsession3.reset();\r\n\t\tstd::cout << \"After reset3:      \" << freeCudaMem() << std::endl;\r\n\t}\r\n\r\n}\r\n```\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\nHere is the output from the program above:\r\n```\r\nStart of program:  1031380992\r\nAfter session:     700043264\r\nClose Status: OK\r\nAfter close:       635219968\r\nAfter reset:       570400768\r\nStart of program2: 505581568\r\nAfter session2:    440766464\r\nClose Status2: OK\r\nAfter close2:      375943168\r\nAfter reset2:      311111680\r\nStart of program3: 246292480\r\nAfter session3:    181473280\r\nClose Status3: OK\r\nAfter close3:      116654080\r\nAfter reset3:      1013313536\r\n```\r\n\r\nNote the GPU memory available keeps going down even though the session has been closed and reset and all variables are out of scope."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32122", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32122/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32122/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32122/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32122", "id": 487628525, "node_id": "MDU6SXNzdWU0ODc2Mjg1MjU=", "number": 32122, "title": "Cannot seek on write only tf.gfile.GFile", "user": {"login": "eirism", "id": 1268471, "node_id": "MDQ6VXNlcjEyNjg0NzE=", "avatar_url": "https://avatars2.githubusercontent.com/u/1268471?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eirism", "html_url": "https://github.com/eirism", "followers_url": "https://api.github.com/users/eirism/followers", "following_url": "https://api.github.com/users/eirism/following{/other_user}", "gists_url": "https://api.github.com/users/eirism/gists{/gist_id}", "starred_url": "https://api.github.com/users/eirism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eirism/subscriptions", "organizations_url": "https://api.github.com/users/eirism/orgs", "repos_url": "https://api.github.com/users/eirism/repos", "events_url": "https://api.github.com/users/eirism/events{/privacy}", "received_events_url": "https://api.github.com/users/eirism/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-08-30T19:01:28Z", "updated_at": "2019-08-31T04:30:32Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n\r\n-  Have I written custom code: Yes\r\n- OS Platform and Distribution: Linux Ubuntu 18.04\r\n- TensorFlow installed from: binary\r\n- TensorFlow version: v1.14.0-rc1-22-gaf24dc9 1.14.0\r\n- Python version: 3.6\r\n\r\n**Describe the current behavior**\r\nCalling `seek()` on a `tf.gfile.GFile` opened in write only mode raises `tensorflow.python.framework.errors_impl.PermissionDeniedError`.\r\n\r\n**Describe the expected behavior**\r\nGFile should support the Python IO semantics that supports seeking on a write only file.\r\n\r\nMore generally it would be preferable if GFile followed the API of Python's [`io.IOBase`](https://docs.python.org/3/library/io.html#io.IOBase).\r\n\r\n\r\n**Code to reproduce the issue**\r\n\r\n```\r\nimport tensorflow as tf\r\n\r\nwith tf.io.gfile.GFile('test.txt', 'w') as f:\r\n    f.seek(0)\r\n```\r\n\r\n**Other info / logs**\r\n```\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 2, in <module>\r\n  File \"/VENV/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/VENV/lib/python3.6/site-packages/tensorflow/python/lib/io/file_io.py\", line 146, in seek\r\n    self._preread_check()\r\n  File \"/VENV/lib/python3.6/site-packages/tensorflow/python/lib/io/file_io.py\", line 82, in _preread_check\r\n    \"File isn't open for reading\")\r\ntensorflow.python.framework.errors_impl.PermissionDeniedError: File isn't open for reading\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32105", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32105/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32105/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32105/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32105", "id": 487327760, "node_id": "MDU6SXNzdWU0ODczMjc3NjA=", "number": 32105, "title": "FATAL error when using TF_CUDNN_USE_AUTOTUNE=0", "user": {"login": "ppwwyyxx", "id": 1381301, "node_id": "MDQ6VXNlcjEzODEzMDE=", "avatar_url": "https://avatars3.githubusercontent.com/u/1381301?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ppwwyyxx", "html_url": "https://github.com/ppwwyyxx", "followers_url": "https://api.github.com/users/ppwwyyxx/followers", "following_url": "https://api.github.com/users/ppwwyyxx/following{/other_user}", "gists_url": "https://api.github.com/users/ppwwyyxx/gists{/gist_id}", "starred_url": "https://api.github.com/users/ppwwyyxx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ppwwyyxx/subscriptions", "organizations_url": "https://api.github.com/users/ppwwyyxx/orgs", "repos_url": "https://api.github.com/users/ppwwyyxx/repos", "events_url": "https://api.github.com/users/ppwwyyxx/events{/privacy}", "received_events_url": "https://api.github.com/users/ppwwyyxx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-08-30T07:16:10Z", "updated_at": "2019-12-09T06:27:27Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: n/a\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version (use command below): v1.12.1-10080-g6e0893c79c 1.14.0\r\n- Python version: 3.7\r\n- Bazel version (if compiling from source): 0.24.1\r\n- GCC/Compiler version (if compiling from source): 7.4\r\n- CUDA/cuDNN version: 10.0 / 7.6.2\r\n- GPU model and memory: V100 16G\r\n\r\n**Describe the current behavior**\r\nI have a model which runs fine. However, after I use\r\n```\r\nexport TF_CUDNN_USE_AUTOTUNE=0\r\n```\r\nin order to save some autotuning time, it starts to crash with this error in the first iteration:\r\n```\r\n019-08-30 00:05:05.705707: F tensorflow/stream_executor/cuda/cuda_dnn.cc:262] Unsupported Cudnn convolution backward algorithm for filter: 6\r\nzsh: abort (core dumped)  python3 xx.py\r\n```\r\n\r\n**Code to reproduce the issue**\r\nCan try to provide one but I think the information is probably already enough to pin down the problem.\r\n\r\n**Other info / logs**\r\nThe algorithm 6, mentioned in the error message, corresponds to `CUDNN_CONVOLUTION_BWD_FILTER_ALGO_FFT_TILING`, which is explictly disabled in tensorflow: \r\nhttps://github.com/tensorflow/tensorflow/blob/a4bfabe12869a00138173afe739733065b39f4a0/tensorflow/stream_executor/cuda/cuda_dnn.cc#L258-L265\r\n\r\nWhen I set AUTOTUNE=0, cudnn will choose the best algorithm with its own heuristics, and I suspect that TensorFlow crashes because cudnn chooses this algorithm that TF has disabled.\r\n\r\ncc @chsigg "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32104", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32104/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32104/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32104/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32104", "id": 487317050, "node_id": "MDU6SXNzdWU0ODczMTcwNTA=", "number": 32104, "title": "Training with GPU on TF 2.0 is much slower than on TF 1.14 if set a large number to `input_dim` of `tf.keras.layers.Embedding`", "user": {"login": "DeviLeo", "id": 4043644, "node_id": "MDQ6VXNlcjQwNDM2NDQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/4043644?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DeviLeo", "html_url": "https://github.com/DeviLeo", "followers_url": "https://api.github.com/users/DeviLeo/followers", "following_url": "https://api.github.com/users/DeviLeo/following{/other_user}", "gists_url": "https://api.github.com/users/DeviLeo/gists{/gist_id}", "starred_url": "https://api.github.com/users/DeviLeo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DeviLeo/subscriptions", "organizations_url": "https://api.github.com/users/DeviLeo/orgs", "repos_url": "https://api.github.com/users/DeviLeo/repos", "events_url": "https://api.github.com/users/DeviLeo/events{/privacy}", "received_events_url": "https://api.github.com/users/DeviLeo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 17, "created_at": "2019-08-30T06:46:27Z", "updated_at": "2020-03-10T15:55:59Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): `Linux`-3.10.0-957.21.3.el7.x86_64 `CentOS-7.3.1611`-Core\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: None\r\n- TensorFlow installed from (source or binary): binary, pip install tensorflow-gpu\r\n- TensorFlow version (use command below): `2.0.0-rc0`(v2.0.0-beta1-5101-gc75bb66), `1.14.0`(v1.14.0-rc1-22-gaf24dc91b5)\r\n- Python version: 3.6.8\r\n- Bazel version (if compiling from source): None\r\n- GCC/Compiler version (if compiling from source): None\r\n- CUDA/cuDNN version: CUDA 10.0.130, cuDNN 7.6.3.30\r\n- GPU model and memory: RTX 2070 Super, 8GB\r\n\r\n**Describe the current behavior**  \r\nI converted the `Keras` implementation of [`Neural Matrix Factorization (NeuMF)`](https://github.com/hexiangnan/neural_collaborative_filtering/blob/master/NeuMF.py) to `tf.keras` and it works well on TF 1.14.  \r\nBut when I run it on TF 2.0.0-rc0, the training is much slower than on TF 1.14.  \r\nI use the profiling tools to check the time, and I found `ReadVariableOp` takes too much time if I set a large number to the `input_dim` of `tf.keras.layers.Embedding`.  \r\n\r\n``` bash\r\nTensorflow version:  2.0.0-rc0\r\nEpoch 1/3\r\n10000/10000 [==============================] - 5s 532us/sample - loss: 0.6935\r\nEpoch 2/3\r\n10000/10000 [==============================] - 4s 436us/sample - loss: 0.6903\r\nEpoch 3/3\r\n10000/10000 [==============================] - 4s 431us/sample - loss: 0.6851\r\n```\r\n\r\n```bash\r\nTensorflow version:  1.14.0\r\nEpoch 1/3\r\n10000/10000 [==============================] - 2s 212us/sample - loss: 0.7035\r\nEpoch 2/3\r\n10000/10000 [==============================] - 0s 28us/sample - loss: 0.6981\r\nEpoch 3/3\r\n10000/10000 [==============================] - 0s 29us/sample - loss: 0.6909\r\n```\r\n\r\n**Describe the expected behavior**  \r\nThe speed of training on TF 2.0 with large `input_dim` of `Embedding` should be the same as TF 1.14 or faster.  \r\n\r\n**Code to reproduce the issue**  \r\nI have shared the codes on [Colab](https://drive.google.com/open?id=1wu3fhjtEYtFVWsby5OO4IQ7tRHf5xHWt)\r\nor check the codes below.  \r\n``` Python\r\n# -*- coding:utf-8 -*-\r\n\r\nimport numpy as np\r\nimport tensorflow as tf\r\nfrom tensorflow import keras\r\nfrom tensorflow.keras.regularizers import l1, l2\r\nfrom tensorflow.keras.layers import Embedding, Input, Dense, Lambda, Flatten\r\n\r\ndef get_model(num_users, num_items, mf_dim=10, layers=[10], reg_layers=[0], reg_mf=0, alpha=0.5):\r\n  assert len(layers) == len(reg_layers)\r\n  num_layer = len(layers) #Number of layers in the MLP\r\n  \r\n  # Input variables\r\n  user_input = Input(shape=(1,), dtype='int32', name = 'user_input')\r\n  item_input = Input(shape=(1,), dtype='int32', name = 'item_input')\r\n  \r\n  # Embedding layer\r\n  MF_Embedding_User = Embedding(input_dim = num_users, output_dim = mf_dim, name = 'mf_embedding_user', \r\n                                embeddings_initializer = keras.initializers.RandomNormal(mean=0.0, stddev=0.01, seed=None), embeddings_regularizer = l2(reg_mf), \r\n                                input_length=1)\r\n  MF_Embedding_Item = Embedding(input_dim = num_items, output_dim = mf_dim, name = 'mf_embedding_item', \r\n                                embeddings_initializer = keras.initializers.RandomNormal(mean=0.0, stddev=0.01, seed=None), embeddings_regularizer = l2(reg_mf), \r\n                                input_length=1)\r\n\r\n  MLP_Embedding_User = Embedding(input_dim = num_users, output_dim = int(layers[0]/2), name = \"mlp_embedding_user\", \r\n                                  embeddings_initializer = keras.initializers.RandomNormal(mean=0.0, stddev=0.01, seed=None), embeddings_regularizer = l2(reg_layers[0]), \r\n                                  input_length=1)\r\n  MLP_Embedding_Item = Embedding(input_dim = num_items, output_dim = int(layers[0]/2), name = 'mlp_embedding_item', \r\n                                  embeddings_initializer = keras.initializers.RandomNormal(mean=0.0, stddev=0.01, seed=None), embeddings_regularizer = l2(reg_layers[0]), \r\n                                  input_length=1)\r\n\r\n  # MF part\r\n  mf_user_latent = Flatten()(MF_Embedding_User(user_input))\r\n  mf_item_latent = Flatten()(MF_Embedding_Item(item_input))\r\n  mf_vector = keras.layers.Multiply()([mf_user_latent, mf_item_latent])\r\n\r\n  # MLP part\r\n  mlp_user_latent = Flatten()(MLP_Embedding_User(user_input))\r\n  mlp_item_latent = Flatten()(MLP_Embedding_Item(item_input))\r\n  mlp_vector = keras.layers.Concatenate(axis=-1)([mlp_user_latent, mlp_item_latent])\r\n\r\n  for idx in range(1, num_layer):\r\n    mlp_vector = Dense(layers[idx], \r\n                      activation='relu', \r\n                      kernel_regularizer = l2(reg_layers[idx]), \r\n                      bias_regularizer = l2(reg_layers[idx]), \r\n                      name=\"layer%d\" %idx)(mlp_vector)\r\n\r\n  # Concatenate MF and MLP parts\r\n  mf_vector = Lambda(lambda x: x * alpha)(mf_vector)\r\n  mlp_vector = Lambda(lambda x : x * (1 - alpha))(mlp_vector)\r\n  predict_vector = keras.layers.Concatenate(axis=-1)([mf_vector, mlp_vector])\r\n\r\n  # Final prediction layer\r\n  prediction = Dense(1, \r\n                    activation='sigmoid', \r\n                    kernel_initializer='lecun_uniform', \r\n                    bias_initializer ='lecun_uniform', \r\n                    name = \"prediction\")(predict_vector)\r\n\r\n  model = keras.Model(inputs=[user_input, item_input], outputs=[prediction])\r\n  return model\r\n\r\ndef generate_data(num_user, num_item, count=100):\r\n    user_input = []\r\n    item_input = []\r\n    labels = []\r\n    for _ in range(count):\r\n        user = np.random.randint(0,num_user)\r\n        item = np.random.randint(0,num_item)\r\n        label = np.random.randint(0,2)\r\n        user_input.append(user)\r\n        item_input.append(item)\r\n        labels.append(label)\r\n    return np.asarray(user_input), np.asarray(item_input), np.asarray(labels)\r\n\r\ndef test_model():\r\n    num_user = 1000000\r\n    num_item = 100000\r\n    count = 10000\r\n    user_input, item_input, labels = generate_data(num_user, num_item, count)\r\n\r\n    model = get_model(num_user, num_item)\r\n    model.compile(\r\n        optimizer=tf.keras.optimizers.Adam(),\r\n        loss=tf.keras.losses.BinaryCrossentropy()\r\n    )\r\n\r\n    # Callbacks\r\n    callbacks = [ tf.keras.callbacks.TensorBoard(log_dir='tb-logs') ]\r\n    model.fit([user_input, item_input], labels, batch_size=256, epochs=3, callbacks=callbacks)\r\n\r\nif __name__ == \"__main__\":\r\n    print(\"Tensorflow version: \", tf.__version__)\r\n    test_model()\r\n```\r\n\r\n**Other info / logs**  \r\nThe attachment '[tb-logs.zip](https://github.com/tensorflow/tensorflow/files/3558500/tb-logs.zip)' is the tensorboard logs.   \r\n\r\nThe profiling screenshot of the training on TF 2.0.0-rc0.  \r\n![tf2-profile](https://user-images.githubusercontent.com/4043644/63997461-2b315480-cb31-11e9-9983-43baaeb3b002.png)  \r\n\r\nThe profiling screenshot of the training on TF 1.14.  \r\n![tf114-profile](https://user-images.githubusercontent.com/4043644/63997474-33898f80-cb31-11e9-8f7d-e02cc6496e69.png)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32101", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32101/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32101/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32101/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32101", "id": 487264171, "node_id": "MDU6SXNzdWU0ODcyNjQxNzE=", "number": 32101, "title": "Unsupported Operation (MEAN) while trying to apply GpuDelegate to tflite", "user": {"login": "David-Xiang", "id": 28208214, "node_id": "MDQ6VXNlcjI4MjA4MjE0", "avatar_url": "https://avatars2.githubusercontent.com/u/28208214?v=4", "gravatar_id": "", "url": "https://api.github.com/users/David-Xiang", "html_url": "https://github.com/David-Xiang", "followers_url": "https://api.github.com/users/David-Xiang/followers", "following_url": "https://api.github.com/users/David-Xiang/following{/other_user}", "gists_url": "https://api.github.com/users/David-Xiang/gists{/gist_id}", "starred_url": "https://api.github.com/users/David-Xiang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/David-Xiang/subscriptions", "organizations_url": "https://api.github.com/users/David-Xiang/orgs", "repos_url": "https://api.github.com/users/David-Xiang/repos", "events_url": "https://api.github.com/users/David-Xiang/events{/privacy}", "received_events_url": "https://api.github.com/users/David-Xiang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 15, "created_at": "2019-08-30T03:13:52Z", "updated_at": "2020-02-26T09:47:33Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code: Nop, just some assembled statements\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): MacOS 10.14\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: Samsung S9\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): tf-nightly 1.15.0.dev20190812\r\n- Python version: 3.6.5\r\n\r\n**Describe the current behavior**\r\nI'm trying to convert the Keras's MobileNet model with float16 precision for Gpu Inference. But when running tasks, I encountered the following Error:\r\n\r\n\r\n Caused by: java.lang.IllegalArgumentException: Internal error: Failed to apply delegate: Next operations are not supported by GPU delegate:\r\n    MEAN: Operation is not supported.\r\n    First 88 operations will run on the GPU, and the remaining 5 on the CPU.tensorflow/lite/kernels/conv.cc:259 bias->type != input_type (10 != 1)Node number 90 (CONV_2D) failed to prepare.\r\n    tensorflow/lite/kernels/conv.cc:259 bias->type != input_type (10 != 1)Node number 3 (CONV_2D) failed to prepare.\r\n\r\n**Describe the expected behavior**\r\n\r\n**Code to reproduce the issue**\r\nthe Python script for conversion is here:\r\n```python\r\nimport tensorflow as tf\r\nimport tensorflow.keras as keras\r\n\r\nmodel = keras.applications.mobilenet.MobileNet(input_shape=None, alpha=1.0, depth_multiplier=1, dropout=1e-3, include_top=True, weights='imagenet', input_tensor=None, pooling=None, classes=1000)\r\nconverter = tf.lite.TFLiteConverter.from_keras_model_file(\"mobilenet.h5\")\r\nconverter.optimizations = [tf.lite.Optimize.DEFAULT]\r\nconverter.target_spec.supported_types = [tf.lite.constants.FLOAT16]\r\ntflite_model = converter.convert()\r\nopen(\"mobilenet.tflite\", \"wb\").write(tflite_model)\r\n```\r\n\r\nand in Android code, I called `tfliteOptions.setAllowFp16PrecisionForFp32(true);`\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32099", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32099/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32099/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32099/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32099", "id": 487257942, "node_id": "MDU6SXNzdWU0ODcyNTc5NDI=", "number": 32099, "title": "tf2.0.0-rc0: tensor shape check failed when using tf.function in tf.distribute.Strategy scope.", "user": {"login": "3fen", "id": 1267038, "node_id": "MDQ6VXNlcjEyNjcwMzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/1267038?v=4", "gravatar_id": "", "url": "https://api.github.com/users/3fen", "html_url": "https://github.com/3fen", "followers_url": "https://api.github.com/users/3fen/followers", "following_url": "https://api.github.com/users/3fen/following{/other_user}", "gists_url": "https://api.github.com/users/3fen/gists{/gist_id}", "starred_url": "https://api.github.com/users/3fen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/3fen/subscriptions", "organizations_url": "https://api.github.com/users/3fen/orgs", "repos_url": "https://api.github.com/users/3fen/repos", "events_url": "https://api.github.com/users/3fen/events{/privacy}", "received_events_url": "https://api.github.com/users/3fen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mdanatg", "id": 26628547, "node_id": "MDQ6VXNlcjI2NjI4NTQ3", "avatar_url": "https://avatars1.githubusercontent.com/u/26628547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mdanatg", "html_url": "https://github.com/mdanatg", "followers_url": "https://api.github.com/users/mdanatg/followers", "following_url": "https://api.github.com/users/mdanatg/following{/other_user}", "gists_url": "https://api.github.com/users/mdanatg/gists{/gist_id}", "starred_url": "https://api.github.com/users/mdanatg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mdanatg/subscriptions", "organizations_url": "https://api.github.com/users/mdanatg/orgs", "repos_url": "https://api.github.com/users/mdanatg/repos", "events_url": "https://api.github.com/users/mdanatg/events{/privacy}", "received_events_url": "https://api.github.com/users/mdanatg/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mdanatg", "id": 26628547, "node_id": "MDQ6VXNlcjI2NjI4NTQ3", "avatar_url": "https://avatars1.githubusercontent.com/u/26628547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mdanatg", "html_url": "https://github.com/mdanatg", "followers_url": "https://api.github.com/users/mdanatg/followers", "following_url": "https://api.github.com/users/mdanatg/following{/other_user}", "gists_url": "https://api.github.com/users/mdanatg/gists{/gist_id}", "starred_url": "https://api.github.com/users/mdanatg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mdanatg/subscriptions", "organizations_url": "https://api.github.com/users/mdanatg/orgs", "repos_url": "https://api.github.com/users/mdanatg/repos", "events_url": "https://api.github.com/users/mdanatg/events{/privacy}", "received_events_url": "https://api.github.com/users/mdanatg/received_events", "type": "User", "site_admin": false}, {"login": "anj-s", "id": 32556631, "node_id": "MDQ6VXNlcjMyNTU2NjMx", "avatar_url": "https://avatars1.githubusercontent.com/u/32556631?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anj-s", "html_url": "https://github.com/anj-s", "followers_url": "https://api.github.com/users/anj-s/followers", "following_url": "https://api.github.com/users/anj-s/following{/other_user}", "gists_url": "https://api.github.com/users/anj-s/gists{/gist_id}", "starred_url": "https://api.github.com/users/anj-s/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anj-s/subscriptions", "organizations_url": "https://api.github.com/users/anj-s/orgs", "repos_url": "https://api.github.com/users/anj-s/repos", "events_url": "https://api.github.com/users/anj-s/events{/privacy}", "received_events_url": "https://api.github.com/users/anj-s/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-08-30T02:43:36Z", "updated_at": "2019-09-16T07:49:58Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): no\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Centos 7\r\n- TensorFlow installed from (source or binary): binary(docker image: 2.0.0rc0-gpu-py3-jupyter)\r\n- TensorFlow version (use command below): 2.0.0-rc0\r\n- Python version:3.6.8\r\n- CUDA/cuDNN version: V10.0.130\r\n- GPU model and memory: P40\r\n\r\n**Describe the current behavior**\r\nI followed the document for writing custom training loop([ref](https://www.tensorflow.org/versions/r2.0/api_docs/python/tf/distribute/Strategy#in_short)), and caught an ValueError exception:\r\n> ValueError: Input tensor 'Const_1:0' enters the loop with shape (), but has shape (None, 110, 110, 1) after one iteration. To allow the shape to vary across iterations, use the `shape_invariants` argument of tf.while_loop to specify a less-specific shape.\r\n\r\nIf I removed 'tf.function' decorator, the code worked fine with a warning:\r\n> WARNING:tensorflow:Using MirroredStrategy eagerly has significant overhead currently. We will be working on improving this in the future, but for now please wrap `call_for_each_replica` or `experimental_run` or `experimental_run_v2` inside a tf.function to get the best performance.\r\n\r\n**Describe the expected behavior**\r\nIt should work, and run faster than eager mode.\r\n\r\n**Code to reproduce the issue**\r\n```python\r\nimport tensorflow as tf\r\nmirrored_strategy = tf.distribute.MirroredStrategy()\r\ndef get_net():\r\n    net = tf.keras.Sequential()\r\n    net.add(tf.keras.layers.Conv2D(filters=10,\r\n                                   kernel_size=(3, 3)))\r\n    net.add(tf.keras.layers.Dense(1))\r\n    return net\r\n\r\ndata = tf.random.normal(shape=(1280, 112, 112, 3))\r\nlabel = tf.random.normal(shape=(1280, ))\r\nmulti_db = tf.data.Dataset.from_tensor_slices((data, label)).batch(80)\r\ndist_dataset = mirrored_strategy.experimental_distribute_dataset(multi_db)\r\n\r\nwith mirrored_strategy.scope():\r\n    net = get_net()\r\n    @tf.function\r\n    def replica_fn(input):\r\n        d, l = input\r\n        return net(d)\r\n\r\n    @tf.function\r\n    def distribute_train_epoch(dataset):\r\n        total_result = 0\r\n        for x in dataset:\r\n            per_replica_result = mirrored_strategy.experimental_run_v2(replica_fn, args=(x,))\r\n            total_result = mirrored_strategy.reduce(tf.distribute.ReduceOp.SUM, per_replica_result, axis=None)\r\n        return total_result\r\n\r\n    for _ in range(100):\r\n        f = distribute_train_epoch(dist_dataset)\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32093", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32093/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32093/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32093/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32093", "id": 487158198, "node_id": "MDU6SXNzdWU0ODcxNTgxOTg=", "number": 32093, "title": "Feature request: linspace can accept tensors for start and stop", "user": {"login": "hristo-vrigazov", "id": 14914140, "node_id": "MDQ6VXNlcjE0OTE0MTQw", "avatar_url": "https://avatars0.githubusercontent.com/u/14914140?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hristo-vrigazov", "html_url": "https://github.com/hristo-vrigazov", "followers_url": "https://api.github.com/users/hristo-vrigazov/followers", "following_url": "https://api.github.com/users/hristo-vrigazov/following{/other_user}", "gists_url": "https://api.github.com/users/hristo-vrigazov/gists{/gist_id}", "starred_url": "https://api.github.com/users/hristo-vrigazov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hristo-vrigazov/subscriptions", "organizations_url": "https://api.github.com/users/hristo-vrigazov/orgs", "repos_url": "https://api.github.com/users/hristo-vrigazov/repos", "events_url": "https://api.github.com/users/hristo-vrigazov/events{/privacy}", "received_events_url": "https://api.github.com/users/hristo-vrigazov/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 16, "created_at": "2019-08-29T20:21:59Z", "updated_at": "2019-12-17T10:16:07Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using): 1.14.0\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\nCurrently, [`tf.linspace`](https://www.tensorflow.org/api_docs/python/tf/linspace) accepts only single numbers (0-D tensor) for start and stop. Numpy recently added support for ndarrays for the `start` and `stop` parameters (since 1.16, see [np.linspace](https://docs.scipy.org/doc/numpy/reference/generated/numpy.linspace.html) ). It would be very useful (especially when writing vectorized implementations) to have the possibility to call this function for multi dimensional tensors with behavior matching the one in Numpy.\r\n\r\n**Will this change the current api? How?** \r\n\r\nIt will be a backward-compatible change. Only the behaviour of the function will be changed (for certain sets of inputs) and the dimension checking at the start of the function.\r\n\r\n**Who will benefit with this feature?**\r\n\r\nMostly when vectorizing different algorithms. One possible application is when doing a body pose estimation postprocessing pairwise connections per limb, we have all possible combinations of points in a multi dimensional tensor and we want to be able to call `tf.linspace` for the Monte Carlo sampling directly on the tensors to avoid slow iterative solutions.\r\n\r\n**Any Other info.**\r\nI have already implemented a function locally, that behaves in the same way. I have not checked if there would be problems in integration though."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32090", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32090/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32090/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32090/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32090", "id": 487123136, "node_id": "MDU6SXNzdWU0ODcxMjMxMzY=", "number": 32090, "title": "Initial read on nonexistent tf.gfile.GFile in w+ mode crashes", "user": {"login": "eirism", "id": 1268471, "node_id": "MDQ6VXNlcjEyNjg0NzE=", "avatar_url": "https://avatars2.githubusercontent.com/u/1268471?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eirism", "html_url": "https://github.com/eirism", "followers_url": "https://api.github.com/users/eirism/followers", "following_url": "https://api.github.com/users/eirism/following{/other_user}", "gists_url": "https://api.github.com/users/eirism/gists{/gist_id}", "starred_url": "https://api.github.com/users/eirism/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eirism/subscriptions", "organizations_url": "https://api.github.com/users/eirism/orgs", "repos_url": "https://api.github.com/users/eirism/repos", "events_url": "https://api.github.com/users/eirism/events{/privacy}", "received_events_url": "https://api.github.com/users/eirism/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-08-29T18:56:58Z", "updated_at": "2019-09-04T10:57:27Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code: Yes\r\n- OS Platform and Distribution: Linux Ubuntu 18.04\r\n- TensorFlow installed from: binary\r\n- TensorFlow version: v1.14.0-rc1-22-gaf24dc9 1.14.0\r\n- Python version: 3.7\r\n\r\n**Describe the current behavior**\r\nPython raises `tensorflow.python.framework.errors_impl.NotFoundError` when doing a first read (no writes before it) on a nonexistent `tf.gfile.GFile` in `w+` mode.\r\n\r\n**Describe the expected behavior**\r\nRead on an empty `w+` file should return an empty string.\r\nOne problem with the current behaviour is that numpy.savez() crashes when writing to a GFile.\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport tensorflow as tf\r\n\r\nwith tf.io.gfile.GFile('test.txt', 'w+') as f:\r\n    f.read()\r\n```\r\n\r\n**Other info / logs**\r\n```\r\nTraceback (most recent call last):\r\n  File \"test_gfile.py\", line 5, in <module>\r\n    f.read()\r\n  File \"/VENV/lib/python3.7/site-packages/tensorflow/python/lib/io/file_io.py\", line 122, in read\r\n    self._preread_check()\r\n  File \"/VENV/lib/python3.7/site-packages/tensorflow/python/lib/io/file_io.py\", line 84, in _preread_check\r\n    compat.as_bytes(self.__name), 1024 * 512)\r\ntensorflow.python.framework.errors_impl.NotFoundError: test.txt; No such file or directory\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32086", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32086/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32086/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32086/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32086", "id": 487008557, "node_id": "MDU6SXNzdWU0ODcwMDg1NTc=", "number": 32086, "title": "Ragged tensor with start and end indices", "user": {"login": "FlorianUekermann", "id": 917690, "node_id": "MDQ6VXNlcjkxNzY5MA==", "avatar_url": "https://avatars1.githubusercontent.com/u/917690?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FlorianUekermann", "html_url": "https://github.com/FlorianUekermann", "followers_url": "https://api.github.com/users/FlorianUekermann/followers", "following_url": "https://api.github.com/users/FlorianUekermann/following{/other_user}", "gists_url": "https://api.github.com/users/FlorianUekermann/gists{/gist_id}", "starred_url": "https://api.github.com/users/FlorianUekermann/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FlorianUekermann/subscriptions", "organizations_url": "https://api.github.com/users/FlorianUekermann/orgs", "repos_url": "https://api.github.com/users/FlorianUekermann/repos", "events_url": "https://api.github.com/users/FlorianUekermann/events{/privacy}", "received_events_url": "https://api.github.com/users/FlorianUekermann/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-08-29T14:53:13Z", "updated_at": "2019-09-17T22:24:50Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using):\r\nnightly\r\n\r\n**Describe the feature and the current behavior/state.**\r\nRagged tensors are currently defined by specifying the boundaries between subtensors in the ragged dimension. If the elements at the end/beginning of consecutive subtensors in the ragged dimension are shared, defining both the start and end of each such subtensor could reduce the total size of the ragged tensor dramatically.\r\n\r\nTo make the implementation more straightforward, both starts and ends could be required to increase monotonically .\r\n\r\n**Will this change the current api? How?**\r\nNo. This would only require adding a construction function to the API.\r\n\r\n**Who will benefit with this feature?**\r\nThis feature could be used to compress overlapping tensors with overlapping sequences by a large margin. This is useful for training data containing words, tokens, transactions etc.\r\nFurthermore, this would allow slicing the underlying data tensor while using gaps, potentially reducing the number of necessary copies."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32085", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32085/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32085/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32085/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32085", "id": 486980113, "node_id": "MDU6SXNzdWU0ODY5ODAxMTM=", "number": 32085, "title": "Documentation for ./configure environment variables", "user": {"login": "sjdrc", "id": 6028151, "node_id": "MDQ6VXNlcjYwMjgxNTE=", "avatar_url": "https://avatars0.githubusercontent.com/u/6028151?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sjdrc", "html_url": "https://github.com/sjdrc", "followers_url": "https://api.github.com/users/sjdrc/followers", "following_url": "https://api.github.com/users/sjdrc/following{/other_user}", "gists_url": "https://api.github.com/users/sjdrc/gists{/gist_id}", "starred_url": "https://api.github.com/users/sjdrc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sjdrc/subscriptions", "organizations_url": "https://api.github.com/users/sjdrc/orgs", "repos_url": "https://api.github.com/users/sjdrc/repos", "events_url": "https://api.github.com/users/sjdrc/events{/privacy}", "received_events_url": "https://api.github.com/users/sjdrc/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-08-29T14:05:54Z", "updated_at": "2019-10-02T01:31:44Z", "closed_at": null, "author_association": "NONE", "body": "I'm looking for documentation with all of the `TF_*` environment variables that can be set to make `./configure` unattended. All I can find are various github issues or random articles using them, but is there a definitive official list somewhere?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32084", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32084/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32084/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32084/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/32084", "id": 486976032, "node_id": "MDExOlB1bGxSZXF1ZXN0MzEyMzMzMDUw", "number": 32084, "title": "Fix TestApp compile errors", "user": {"login": "ken0nek", "id": 5785300, "node_id": "MDQ6VXNlcjU3ODUzMDA=", "avatar_url": "https://avatars1.githubusercontent.com/u/5785300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ken0nek", "html_url": "https://github.com/ken0nek", "followers_url": "https://api.github.com/users/ken0nek/followers", "following_url": "https://api.github.com/users/ken0nek/following{/other_user}", "gists_url": "https://api.github.com/users/ken0nek/gists{/gist_id}", "starred_url": "https://api.github.com/users/ken0nek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ken0nek/subscriptions", "organizations_url": "https://api.github.com/users/ken0nek/orgs", "repos_url": "https://api.github.com/users/ken0nek/repos", "events_url": "https://api.github.com/users/ken0nek/events{/privacy}", "received_events_url": "https://api.github.com/users/ken0nek/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1169364259, "node_id": "MDU6TGFiZWwxMTY5MzY0MjU5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:XS", "name": "size:XS", "color": "adafea", "default": false, "description": "CL Change Size: Extra Small"}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-08-29T13:58:50Z", "updated_at": "2020-02-13T11:02:47Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/32084", "html_url": "https://github.com/tensorflow/tensorflow/pull/32084", "diff_url": "https://github.com/tensorflow/tensorflow/pull/32084.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/32084.patch"}, "body": "## Problem\r\nWe cannot build `TestApp` now because of compile errors.\r\n\r\n## Screenshots\r\n\r\n<img width=\"545\" alt=\"Screen Shot 2019-08-29 at 22 50 41\" src=\"https://user-images.githubusercontent.com/5785300/63946590-5162e000-cab0-11e9-9978-1efe95bea734.png\">\r\n\r\n<img width=\"545\" alt=\"Screen Shot 2019-08-29 at 22 50 55\" src=\"https://user-images.githubusercontent.com/5785300/63946592-5162e000-cab0-11e9-8c1d-fce12f8dee75.png\">"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32081", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32081/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32081/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32081/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32081", "id": 486855158, "node_id": "MDU6SXNzdWU0ODY4NTUxNTg=", "number": 32081, "title": "Distributed training not working properly: Waiting for model to be ready. Ready_for_local_init_op: Variables not initialized: global_step", "user": {"login": "Aashish-1008", "id": 23075168, "node_id": "MDQ6VXNlcjIzMDc1MTY4", "avatar_url": "https://avatars3.githubusercontent.com/u/23075168?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Aashish-1008", "html_url": "https://github.com/Aashish-1008", "followers_url": "https://api.github.com/users/Aashish-1008/followers", "following_url": "https://api.github.com/users/Aashish-1008/following{/other_user}", "gists_url": "https://api.github.com/users/Aashish-1008/gists{/gist_id}", "starred_url": "https://api.github.com/users/Aashish-1008/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Aashish-1008/subscriptions", "organizations_url": "https://api.github.com/users/Aashish-1008/orgs", "repos_url": "https://api.github.com/users/Aashish-1008/repos", "events_url": "https://api.github.com/users/Aashish-1008/events{/privacy}", "received_events_url": "https://api.github.com/users/Aashish-1008/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sshrdp", "id": 1256036, "node_id": "MDQ6VXNlcjEyNTYwMzY=", "avatar_url": "https://avatars0.githubusercontent.com/u/1256036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sshrdp", "html_url": "https://github.com/sshrdp", "followers_url": "https://api.github.com/users/sshrdp/followers", "following_url": "https://api.github.com/users/sshrdp/following{/other_user}", "gists_url": "https://api.github.com/users/sshrdp/gists{/gist_id}", "starred_url": "https://api.github.com/users/sshrdp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sshrdp/subscriptions", "organizations_url": "https://api.github.com/users/sshrdp/orgs", "repos_url": "https://api.github.com/users/sshrdp/repos", "events_url": "https://api.github.com/users/sshrdp/events{/privacy}", "received_events_url": "https://api.github.com/users/sshrdp/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sshrdp", "id": 1256036, "node_id": "MDQ6VXNlcjEyNTYwMzY=", "avatar_url": "https://avatars0.githubusercontent.com/u/1256036?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sshrdp", "html_url": "https://github.com/sshrdp", "followers_url": "https://api.github.com/users/sshrdp/followers", "following_url": "https://api.github.com/users/sshrdp/following{/other_user}", "gists_url": "https://api.github.com/users/sshrdp/gists{/gist_id}", "starred_url": "https://api.github.com/users/sshrdp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sshrdp/subscriptions", "organizations_url": "https://api.github.com/users/sshrdp/orgs", "repos_url": "https://api.github.com/users/sshrdp/repos", "events_url": "https://api.github.com/users/sshrdp/events{/privacy}", "received_events_url": "https://api.github.com/users/sshrdp/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-08-29T09:50:32Z", "updated_at": "2020-01-30T23:58:01Z", "closed_at": null, "author_association": "NONE", "body": "Hello,\r\nI am using tfhub elmo embedding for NER model training.\r\nTraining works fine for a single machine.\r\n\r\nWhen I am training to do training on GCP ML engine with 1 master node, 2 parameter server, 3 worker node.\r\n\r\nTraining started on master node,\r\nBut on all three worker node, I am getting this logs continuously for 1 hours,\r\nlooks like training is not getting started on worker node.\r\n\r\nI am using these versions which currently supported by Google cloud ML Engine:\r\nPython: 3.5\r\nTensorflow: 1.13.1\r\n\r\n**ML engine resource usage:**\r\n\r\n```\r\ntrainingInput:\r\n    scaleTier: CUSTOM\r\n    masterType: large_model\r\n    workerType: standard\r\n    parameterServerType: standard\r\n    workerCount: 3\r\n    parameterServerCount: 2\r\n```\r\n\r\n`Waiting for model to be ready. Ready_for_local_init_op: Variables not initialized: global_step, module/bilm/char_embed, module/bilm/CNN/W_cnn_0, module/bilm/CNN/b_cnn_0, module/bilm/CNN/W_cnn_1, module/bilm/CNN/b_cnn_1, module/bilm/CNN/W_cnn_2, module/bilm/CNN/b_cnn_2, module/bilm/CNN/W_cnn_3, module/bilm/CNN/b_cnn_3, module/bilm/CNN/W_cnn_4, module/bilm/CNN/b_cnn_4, module/bilm/CNN/W_cnn_5, module/bilm/CNN/b_cnn_5, module/bilm/CNN/W_cnn_6, module/bilm/CNN/b_cnn_6, module/bilm/CNN_high_0/W_carry, module/bilm/CNN_high_0/b_carry, module/bilm/CNN_high_0/W_transform, module/bilm/CNN_high_0/b_transform, module/bilm/CNN_high_1/W_carry, module/bilm/CNN_high_1/b_carry, module/bilm/CNN_high_1/W_transform, module/bilm/CNN_high_1/b_transform, module/bilm/CNN_proj/W_proj, module/bilm/CNN_proj/b_proj, module/bilm/RNN_0/RNN/MultiRNNCell/Cell0/rnn/lstm_cell/kernel, module/bilm/RNN_0/RNN/MultiRNNCell/Cell0/rnn/lstm_cell/bias, module/bilm/RNN_0/RNN/MultiRNNCell/Cell0/rnn/lstm_cell/projection/kernel, module/bilm/RNN_0/RNN/MultiRNNCell/Cell1/rnn/lstm_cell/kernel, module/bilm/RNN_0/RNN/MultiRNNCell/Cell1/rnn/lstm_cell/bias, module/bilm/RNN_0/RNN/MultiRNNCell/Cell1/rnn/lstm_cell/projection/kernel, module/bilm/RNN_1/RNN/MultiRNNCell/Cell0/rnn/lstm_cell/kernel, module/bilm/RNN_1/RNN/MultiRNNCell/Cell0/rnn/lstm_cell/bias, module/bilm/RNN_1/RNN/MultiRNNCell/Cell0/rnn/lstm_cell/projection/kernel, module/bilm/RNN_1/RNN/MultiRNNCell/Cell1/rnn/lstm_cell/kernel, module/bilm/RNN_1/RNN/MultiRNNCell/Cell1/rnn/lstm_cell/bias, module/bilm/RNN_1/RNN/MultiRNNCell/Cell1/rnn/lstm_cell/projection/kernel, module/aggregation/weights, module/aggregation/scaling, lstm_fused_cell/kernel, lstm_fused_cell/bias, lstm_fused_cell_1/kernel, lstm_fused_cell_1/bias, dense/kernel, dense/bias, crf, beta1_power, beta2_power, lstm_fused_cell/kernel/Adam, lstm_fused_cell/kernel/Adam_1, lstm_fused_cell/bias/Adam, lstm_fused_cell/bias/Adam_1, lstm_fused_cell_1/kernel/Adam, lstm_fused_cell_1/kernel/Adam_1, lstm_fused_cell_1/bias/Adam, lstm_fused_cell_1/bias/Adam_1, dense/kernel/Adam, dense/kernel/Adam_1, dense/bias/Adam, dense/bias/Adam_1, crf/Adam, crf/Adam_1, ready: None`"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32055", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32055/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32055/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32055/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32055", "id": 486496719, "node_id": "MDU6SXNzdWU0ODY0OTY3MTk=", "number": 32055, "title": "TFLite build for rpi armv6 broken", "user": {"login": "hmeyer", "id": 20396, "node_id": "MDQ6VXNlcjIwMzk2", "avatar_url": "https://avatars1.githubusercontent.com/u/20396?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hmeyer", "html_url": "https://github.com/hmeyer", "followers_url": "https://api.github.com/users/hmeyer/followers", "following_url": "https://api.github.com/users/hmeyer/following{/other_user}", "gists_url": "https://api.github.com/users/hmeyer/gists{/gist_id}", "starred_url": "https://api.github.com/users/hmeyer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hmeyer/subscriptions", "organizations_url": "https://api.github.com/users/hmeyer/orgs", "repos_url": "https://api.github.com/users/hmeyer/repos", "events_url": "https://api.github.com/users/hmeyer/events{/privacy}", "received_events_url": "https://api.github.com/users/hmeyer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-08-28T16:53:32Z", "updated_at": "2019-08-29T07:32:24Z", "closed_at": null, "author_association": "NONE", "body": "Cross compiling as per https://www.tensorflow.org/lite/guide/build_rpi#cross-compile_for_raspberry_pi\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Debain):\r\n- TensorFlow installed from (source or binary): github\r\n- TensorFlow version: v1.13.2\r\n- Installed using virtualenv? pip? conda?: docker tensorflow/tensorflow:nightly-devel\r\n- Bazel version (if compiling from source): 0.15.0\r\n- GCC/Compiler version (if compiling from source): 7.3.0\r\n\r\n```\r\n$ git clone https://github.com/tensorflow/tensorflow\r\n$ cd tensorflow/\r\n$ git checkout v1.13.2\r\n$ sed -i 's/armv7l/armv6/g' ./tensorflow/lite/tools/make/build_rpi_lib.sh\r\n$ ./tensorflow/lite/tools/make/download_dependencies.sh\r\n$ ./tensorflow/lite/tools/make/build_rpi_lib.sh\r\n+ set -e                                                                                                                                                                                                          \r\n+++ dirname ./tensorflow/lite/tools/make/build_rpi_lib.sh\r\n++ cd ./tensorflow/lite/tools/make\r\n++ pwd                                                                                                                                                                                                            \r\n+ SCRIPT_DIR=/root/tensorflow/tensorflow/lite/tools/make                                                                                                                                                          \r\n+ cd /root/tensorflow/tensorflow/lite/tools/make/../../../..                                                                                                                                                      \r\n+ CC_PREFIX=arm-linux-gnueabihf-                                                                                                                                                                                  \r\n+ make -j 3 -f tensorflow/lite/tools/make/Makefile TARGET=rpi TARGET_ARCH=armv6\r\n/bin/sh: 1: [[: not found\r\narm-linux-gnueabihf-g++ -O3 -DNDEBUG  --std=c++11 -march=armv6 -mfpu=vfp -funsafe-math-optimizations -ftree-vectorize -fPIC -I. -I/root/tensorflow/tensorflow/lite/tools/make/../../../../../ -I/root/tensorflow/te\r\nnsorflow/lite/tools/make/../../../../../../ -I/root/tensorflow/tensorflow/lite/tools/make/downloads/ -I/root/tensorflow/tensorflow/lite/tools/make/downloads/eigen -I/root/tensorflow/tensorflow/lite/tools/make/do\r\nwnloads/absl -I/root/tensorflow/tensorflow/lite/tools/make/downloads/gemmlowp -I/root/tensorflow/tensorflow/lite/tools/make/downloads/neon_2_sse -I/root/tensorflow/tensorflow/lite/tools/make/downloads/farmhash/s\r\nrc -I/root/tensorflow/tensorflow/lite/tools/make/downloads/flatbuffers/include -I -I/usr/local/include -c tensorflow/lite/allocation.cc -o /root/tensorflow/tensorflow/lite/tools/make/gen/rpi_armv6/obj/tensorflow\r\n/lite/allocation.o\r\narm-linux-gnueabihf-g++ -O3 -DNDEBUG  --std=c++11 -march=armv6 -mfpu=vfp -funsafe-math-optimizations -ftree-vectorize -fPIC -I. -I/root/tensorflow/tensorflow/lite/tools/make/../../../../../ -I/root/tensorflow/te\r\nnsorflow/lite/tools/make/../../../../../../ -I/root/tensorflow/tensorflow/lite/tools/make/downloads/ -I/root/tensorflow/tensorflow/lite/tools/make/downloads/eigen -I/root/tensorflow/tensorflow/lite/tools/make/do\r\nwnloads/absl -I/root/tensorflow/tensorflow/lite/tools/make/downloads/gemmlowp -I/root/tensorflow/tensorflow/lite/tools/make/downloads/neon_2_sse -I/root/tensorflow/tensorflow/lite/tools/make/downloads/farmhash/s\r\nrc -I/root/tensorflow/tensorflow/lite/tools/make/downloads/flatbuffers/include -I -I/usr/local/include -c tensorflow/lite/arena_planner.cc -o /root/tensorflow/tensorflow/lite/tools/make/gen/rpi_armv6/obj/tensorf\r\nlow/lite/arena_planner.o\r\narm-linux-gnueabihf-gcc -O3 -DNDEBUG  -march=armv6 -mfpu=vfp -funsafe-math-optimizations -ftree-vectorize -fPIC -I. -I/root/tensorflow/tensorflow/lite/tools/make/../../../../../ -I/root/tensorflow/tensorflow/lit\r\ne/tools/make/../../../../../../ -I/root/tensorflow/tensorflow/lite/tools/make/downloads/ -I/root/tensorflow/tensorflow/lite/tools/make/downloads/eigen -I/root/tensorflow/tensorflow/lite/tools/make/downloads/absl\r\n -I/root/tensorflow/tensorflow/lite/tools/make/downloads/gemmlowp -I/root/tensorflow/tensorflow/lite/tools/make/downloads/neon_2_sse -I/root/tensorflow/tensorflow/lite/tools/make/downloads/farmhash/src -I/root/t\r\nensorflow/tensorflow/lite/tools/make/downloads/flatbuffers/include -I -I/usr/local/include -c tensorflow/lite/c/c_api_internal.c -o /root/tensorflow/tensorflow/lite/tools/make/gen/rpi_armv6/obj/tensorflow/lite/c\r\n/c_api_internal.o\r\nIn file included from tensorflow/lite/c/c_api_internal.c:16:0:\r\n./tensorflow/lite/c/c_api_internal.h:60:34: warning: 'struct TfLiteContext' declared inside parameter list will not be visible outside of this definition or declaration\r\n   TfLiteStatus (*Refresh)(struct TfLiteContext* context);\r\n                                  ^~~~~~~~~~~~~\r\nIn file included from /usr/arm-linux-gnueabihf/include/stdio.h:859:0,\r\n                 from tensorflow/lite/c/c_api_internal.c:18:\r\n/usr/arm-linux-gnueabihf/include/bits/stdio.h: In function 'getchar':\r\n/usr/arm-linux-gnueabihf/include/bits/stdio.h:45:1: sorry, unimplemented: Thumb-1 hard-float VFP ABI\r\n {\r\n ^\r\ntensorflow/lite/tools/make/Makefile:179: recipe for target '/root/tensorflow/tensorflow/lite/tools/make/gen/rpi_armv6/obj/tensorflow/lite/c/c_api_internal.o' failed\r\nmake: *** [/root/tensorflow/tensorflow/lite/tools/make/gen/rpi_armv6/obj/tensorflow/lite/c/c_api_internal.o] Error 1\r\nmake: *** Waiting for unfinished jobs....\r\nIn file included from /usr/arm-linux-gnueabihf/include/stdio.h:859:0,\r\n                 from /usr/arm-linux-gnueabihf/include/c++/7/cstdio:42,\r\n                 from ./tensorflow/lite/allocation.h:20,\r\n                 from tensorflow/lite/allocation.cc:16:\r\n/usr/arm-linux-gnueabihf/include/bits/stdio.h: In function 'int getchar()':\r\n/usr/arm-linux-gnueabihf/include/bits/stdio.h:44:14: sorry, unimplemented: Thumb-1 hard-float VFP ABI\r\n getchar (void)\r\n              ^\r\nIn file included from /usr/arm-linux-gnueabihf/include/c++/7/bits/stl_algobase.h:62:0,\r\n                 from /usr/arm-linux-gnueabihf/include/c++/7/memory:62,\r\n                 from ./tensorflow/lite/arena_planner.h:18,\r\n                 from tensorflow/lite/arena_planner.cc:15:\r\n/usr/arm-linux-gnueabihf/include/c++/7/ext/type_traits.h: In function 'bool __gnu_cxx::__is_null_pointer(std::nullptr_t)':                                                                                        \r\n/usr/arm-linux-gnueabihf/include/c++/7/ext/type_traits.h:162:35: sorry, unimplemented: Thumb-1 hard-float VFP ABI                                                                                                 \r\n   __is_null_pointer(std::nullptr_t)\r\n                                   ^\r\ntensorflow/lite/tools/make/Makefile:175: recipe for target '/root/tensorflow/tensorflow/lite/tools/make/gen/rpi_armv6/obj/tensorflow/lite/allocation.o' failed                                                    \r\nmake: *** [/root/tensorflow/tensorflow/lite/tools/make/gen/rpi_armv6/obj/tensorflow/lite/allocation.o] Error 1                                                                                                    \r\ntensorflow/lite/tools/make/Makefile:175: recipe for target '/root/tensorflow/tensorflow/lite/tools/make/gen/rpi_armv6/obj/tensorflow/lite/arena_planner.o' failed                                                 \r\nmake: *** [/root/tensorflow/tensorflow/lite/tools/make/gen/rpi_armv6/obj/tensorflow/lite/arena_planner.o] Error 1        \r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32052", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32052/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32052/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32052/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32052", "id": 486451789, "node_id": "MDU6SXNzdWU0ODY0NTE3ODk=", "number": 32052, "title": "Linear RAM memory increase with Dataset and Estimator with epoch loops", "user": {"login": "Mageswaran1989", "id": 3304549, "node_id": "MDQ6VXNlcjMzMDQ1NDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/3304549?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mageswaran1989", "html_url": "https://github.com/Mageswaran1989", "followers_url": "https://api.github.com/users/Mageswaran1989/followers", "following_url": "https://api.github.com/users/Mageswaran1989/following{/other_user}", "gists_url": "https://api.github.com/users/Mageswaran1989/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mageswaran1989/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mageswaran1989/subscriptions", "organizations_url": "https://api.github.com/users/Mageswaran1989/orgs", "repos_url": "https://api.github.com/users/Mageswaran1989/repos", "events_url": "https://api.github.com/users/Mageswaran1989/events{/privacy}", "received_events_url": "https://api.github.com/users/Mageswaran1989/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "karmel", "id": 667809, "node_id": "MDQ6VXNlcjY2NzgwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karmel", "html_url": "https://github.com/karmel", "followers_url": "https://api.github.com/users/karmel/followers", "following_url": "https://api.github.com/users/karmel/following{/other_user}", "gists_url": "https://api.github.com/users/karmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/karmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karmel/subscriptions", "organizations_url": "https://api.github.com/users/karmel/orgs", "repos_url": "https://api.github.com/users/karmel/repos", "events_url": "https://api.github.com/users/karmel/events{/privacy}", "received_events_url": "https://api.github.com/users/karmel/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "karmel", "id": 667809, "node_id": "MDQ6VXNlcjY2NzgwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karmel", "html_url": "https://github.com/karmel", "followers_url": "https://api.github.com/users/karmel/followers", "following_url": "https://api.github.com/users/karmel/following{/other_user}", "gists_url": "https://api.github.com/users/karmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/karmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karmel/subscriptions", "organizations_url": "https://api.github.com/users/karmel/orgs", "repos_url": "https://api.github.com/users/karmel/repos", "events_url": "https://api.github.com/users/karmel/events{/privacy}", "received_events_url": "https://api.github.com/users/karmel/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 38, "created_at": "2019-08-28T15:24:34Z", "updated_at": "2020-02-19T09:23:23Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04.2 LTS\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): Binary\r\n- TensorFlow version (use command below):  tensorflow-gpu==2.0.0-rc0\r\n- Python version: 3.7.1\r\n- Bazel version (if compiling from source): NA\r\n- GCC/Compiler version (if compiling from source): NA\r\n- CUDA/cuDNN version: Cuda 10.1 / cuDNN 7.6\r\n- GPU model and memory: GeForce GTX 1060 Mobile 6GB\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nWhen using Dataset with Estimator, the memory foot print of RAM keeps raising when estimator's train and evaluate APIs are called in loop.\r\n\r\n**Describe the expected behavior**\r\nRAM usage should not increase with epochs.\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\nPlease find the source code @ https://gist.github.com/Mageswaran1989/facc3fc2a003807d029a914c721629db\r\n\r\n[Update] My latest test case @ https://github.com/dhiraa/tf_issue_32052\r\n\r\nStackOverflow Rereference :  https://stackoverflow.com/questions/55211315/memory-leak-with-tf-data\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\n[Updated the graph]\r\n![tf_memory_test](https://user-images.githubusercontent.com/3304549/63917881-30bb6b80-ca59-11e9-8598-ebdca798dff5.png)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32045", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32045/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32045/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32045/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32045", "id": 486382213, "node_id": "MDU6SXNzdWU0ODYzODIyMTM=", "number": 32045, "title": "static int64 GetDirectConvCost - Integer overflow", "user": {"login": "iurii-kvasniuk", "id": 54630351, "node_id": "MDQ6VXNlcjU0NjMwMzUx", "avatar_url": "https://avatars2.githubusercontent.com/u/54630351?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iurii-kvasniuk", "html_url": "https://github.com/iurii-kvasniuk", "followers_url": "https://api.github.com/users/iurii-kvasniuk/followers", "following_url": "https://api.github.com/users/iurii-kvasniuk/following{/other_user}", "gists_url": "https://api.github.com/users/iurii-kvasniuk/gists{/gist_id}", "starred_url": "https://api.github.com/users/iurii-kvasniuk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iurii-kvasniuk/subscriptions", "organizations_url": "https://api.github.com/users/iurii-kvasniuk/orgs", "repos_url": "https://api.github.com/users/iurii-kvasniuk/repos", "events_url": "https://api.github.com/users/iurii-kvasniuk/events{/privacy}", "received_events_url": "https://api.github.com/users/iurii-kvasniuk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2019-08-28T13:26:12Z", "updated_at": "2019-09-05T16:05:59Z", "closed_at": null, "author_association": "NONE", "body": "/tensorflow/core/kernels/deep_conv2d.cc: ln 74,\r\nstatic int64 GetDirectConvCost(int filter_rows, int filter_cols, int in_depth,\r\nint out_depth, int out_rows, int out_cols) {\r\nreturn filter_rows * filter_cols * in_depth * out_depth * out_rows * out_cols;\r\n}\r\n\r\nCan lead to integer overflow and weird results\r\nI think, it should be smth like that\r\nreturn (int64)filter_rows * (int64)filter_cols * (int64)in_depth * (int64)out_depth * (int64)out_rows * (int64)out_cols;"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32041", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32041/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32041/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32041/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32041", "id": 486306321, "node_id": "MDU6SXNzdWU0ODYzMDYzMjE=", "number": 32041, "title": "micro: riscv32_mcu build failed with undefined references", "user": {"login": "ehirdoy", "id": 24792970, "node_id": "MDQ6VXNlcjI0NzkyOTcw", "avatar_url": "https://avatars1.githubusercontent.com/u/24792970?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ehirdoy", "html_url": "https://github.com/ehirdoy", "followers_url": "https://api.github.com/users/ehirdoy/followers", "following_url": "https://api.github.com/users/ehirdoy/following{/other_user}", "gists_url": "https://api.github.com/users/ehirdoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/ehirdoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ehirdoy/subscriptions", "organizations_url": "https://api.github.com/users/ehirdoy/orgs", "repos_url": "https://api.github.com/users/ehirdoy/repos", "events_url": "https://api.github.com/users/ehirdoy/events{/privacy}", "received_events_url": "https://api.github.com/users/ehirdoy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2019-08-28T10:56:34Z", "updated_at": "2020-01-22T01:22:50Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution: Ubuntu 18.04\r\n- TensorFlow installed from: source\r\n- TensorFlow version: 298534b745db43b2ad18256ed781bd2f142e5bc7\r\n- Python version: 2.7.15+/3.6.8\r\n- Installed using virtualenv? pip? conda?: pip3\r\n\r\n**Describe the problem**\r\nTF Lite for micro, riscv32 build fails with undefined references.\r\n\r\nmake -f tensorflow/lite/experimental/micro/tools/make/Makefile TARGET=riscv32_mcu TARGET_ARCH=riscv32 hello_world_bin\r\n\r\n/home/ehirdoy/src/tensorflow/tensorflow/lite/experimental/micro/riscv32_mcu/debug_log.cc:18: undefined reference to `__wrap_puts'\r\nexit.c:(.text.exit+0x2e): undefined reference to `__wrap__exit'\r\nsbrkr.c:(.text._sbrk_r+0x12): undefined reference to `__wrap__sbrk'\r\nwriter.c:(.text._write_r+0x16): undefined reference to `__wrap__write'\r\ncloser.c:(.text._close_r+0x12): undefined reference to `__wrap__close'\r\nlseekr.c:(.text._lseek_r+0x16): undefined reference to `__wrap__lseek'\r\nreadr.c:(.text._read_r+0x16): undefined reference to `__wrap__read'\r\nfstatr.c:(.text._fstat_r+0x14): undefined reference to `__wrap__fstat'\r\nisattyr.c:(.text._isatty_r+0x12): undefined reference to `__wrap__isatty'\r\n\r\n\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n\r\nexport PATH=\"$PATH:./tensorflow/lite/experimental/micro/tools/make/downloads/riscv_toolchain/bin\"\r\nmake -f tensorflow/lite/experimental/micro/tools/make/Makefile clean\r\nmake -f tensorflow/lite/experimental/micro/tools/make/Makefile TARGET=riscv32_mcu TARGET_ARCH=riscv32 hello_world_bin\r\n\r\n\r\n**Any other info / logs**\r\n[make.log](https://github.com/tensorflow/tensorflow/files/3550454/make.log)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32024", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32024/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32024/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32024/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32024", "id": 485997715, "node_id": "MDU6SXNzdWU0ODU5OTc3MTU=", "number": 32024, "title": "TPU nightly", "user": {"login": "nsantavas", "id": 37878833, "node_id": "MDQ6VXNlcjM3ODc4ODMz", "avatar_url": "https://avatars2.githubusercontent.com/u/37878833?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nsantavas", "html_url": "https://github.com/nsantavas", "followers_url": "https://api.github.com/users/nsantavas/followers", "following_url": "https://api.github.com/users/nsantavas/following{/other_user}", "gists_url": "https://api.github.com/users/nsantavas/gists{/gist_id}", "starred_url": "https://api.github.com/users/nsantavas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nsantavas/subscriptions", "organizations_url": "https://api.github.com/users/nsantavas/orgs", "repos_url": "https://api.github.com/users/nsantavas/repos", "events_url": "https://api.github.com/users/nsantavas/events{/privacy}", "received_events_url": "https://api.github.com/users/nsantavas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1097541661, "node_id": "MDU6TGFiZWwxMDk3NTQxNjYx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tpus", "name": "comp:tpus", "color": "0052cc", "default": false, "description": "tpu, tpuestimator"}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "rxsang", "id": 6399870, "node_id": "MDQ6VXNlcjYzOTk4NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6399870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rxsang", "html_url": "https://github.com/rxsang", "followers_url": "https://api.github.com/users/rxsang/followers", "following_url": "https://api.github.com/users/rxsang/following{/other_user}", "gists_url": "https://api.github.com/users/rxsang/gists{/gist_id}", "starred_url": "https://api.github.com/users/rxsang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rxsang/subscriptions", "organizations_url": "https://api.github.com/users/rxsang/orgs", "repos_url": "https://api.github.com/users/rxsang/repos", "events_url": "https://api.github.com/users/rxsang/events{/privacy}", "received_events_url": "https://api.github.com/users/rxsang/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rxsang", "id": 6399870, "node_id": "MDQ6VXNlcjYzOTk4NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6399870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rxsang", "html_url": "https://github.com/rxsang", "followers_url": "https://api.github.com/users/rxsang/followers", "following_url": "https://api.github.com/users/rxsang/following{/other_user}", "gists_url": "https://api.github.com/users/rxsang/gists{/gist_id}", "starred_url": "https://api.github.com/users/rxsang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rxsang/subscriptions", "organizations_url": "https://api.github.com/users/rxsang/orgs", "repos_url": "https://api.github.com/users/rxsang/repos", "events_url": "https://api.github.com/users/rxsang/events{/privacy}", "received_events_url": "https://api.github.com/users/rxsang/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2019-08-27T19:42:11Z", "updated_at": "2020-03-10T13:23:39Z", "closed_at": null, "author_association": "NONE", "body": "I'm training a custom resnet on a single TPU device using tf.keras, and saving the model using ModelCheckpoint callback on the VM. The time takes to save the model during training is very much. The model is about 200mb and it takes ~1 hour to save it to the VM"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32014", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32014/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32014/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32014/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32014", "id": 485895703, "node_id": "MDU6SXNzdWU0ODU4OTU3MDM=", "number": 32014, "title": "TF 1.14 : assgin Variable in loss function can't update value ? ", "user": {"login": "zhen8838", "id": 26156999, "node_id": "MDQ6VXNlcjI2MTU2OTk5", "avatar_url": "https://avatars0.githubusercontent.com/u/26156999?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zhen8838", "html_url": "https://github.com/zhen8838", "followers_url": "https://api.github.com/users/zhen8838/followers", "following_url": "https://api.github.com/users/zhen8838/following{/other_user}", "gists_url": "https://api.github.com/users/zhen8838/gists{/gist_id}", "starred_url": "https://api.github.com/users/zhen8838/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zhen8838/subscriptions", "organizations_url": "https://api.github.com/users/zhen8838/orgs", "repos_url": "https://api.github.com/users/zhen8838/repos", "events_url": "https://api.github.com/users/zhen8838/events{/privacy}", "received_events_url": "https://api.github.com/users/zhen8838/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-08-27T15:55:55Z", "updated_at": "2019-08-29T21:53:05Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution: Linux Ubuntu 18.04\r\n- TensorFlow installed from : binary\r\n- TensorFlow version :  tensorflow-gpu 1.14.0\r\n- Python version: python 3.7.1\r\n- CUDA/cuDNN version: CUDA 10.1 cuDNN 7.5\r\n- GPU model and memory: GTX 2060 6G\r\n\r\n**Question**\r\n\r\nI customize the loss function in tf. keras and use a variable to output part of the loss to metric. What puzzles me is that in normal custom metrics, direct assgin variables give the correct output, but in loss functions, I have to call the assgin operator to get the normal output.\r\n\r\n**Describe the current behavior**\r\nnow code :\r\n```python\r\nimport tensorflow as tf\r\nimport tensorflow.keras as k\r\nimport tensorflow.keras.layers as kl\r\nimport tensorflow.keras.metrics as km\r\nfrom tensorflow.keras.datasets import fashion_mnist\r\n\r\ntfcfg = tf.ConfigProto()\r\ntfcfg.gpu_options.allow_growth = True\r\nsess = tf.Session(config=tfcfg)\r\nk.backend.set_session(sess)\r\n\r\n(x_train, y_train), (x_test, y_test) = fashion_mnist.load_data()\r\nx_train = x_train.reshape((-1, 28, 28, 1))\r\nx_test = x_test.reshape((-1, 28, 28, 1))\r\ny_train = k.utils.to_categorical(y_train, 10)\r\ny_test = k.utils.to_categorical(y_test, 10)\r\n\r\n\r\nmodel = k.Sequential([\r\n    kl.Conv2D(32, 3, 1, input_shape=[28, 28, 1]),\r\n    kl.BatchNormalization(),\r\n    kl.LeakyReLU(),\r\n    kl.Conv2D(64, 3, 1),\r\n    kl.BatchNormalization(),\r\n    kl.LeakyReLU(),\r\n    kl.Conv2D(128, 3, 1),\r\n    kl.BatchNormalization(),\r\n    kl.LeakyReLU(),\r\n    kl.LeakyReLU(),\r\n    kl.Flatten(),\r\n    kl.Dense(512),\r\n    kl.BatchNormalization(),\r\n    kl.LeakyReLU(),\r\n    kl.Dense(10)\r\n])\r\n\r\n\r\nclass Metric_HIGH_COST(km.Metric):\r\n    def __init__(self, name=None, dtype=None, **kwargs):\r\n        super().__init__(name=name, dtype=dtype, **kwargs)\r\n        self.ce = self.add_weight('ce', initializer=tf.zeros_initializer)\r\n\r\n    def update_state(self, y_true, y_pred, sample_weight=None):\r\n        self.ce.assign(tf.reduce_sum(tf.nn.sigmoid_cross_entropy_with_logits(labels=y_true, logits=y_pred)))\r\n\r\n    def result(self):\r\n        return self.ce\r\n\r\n\r\nclass Metric_LOW_COST(km.Metric):\r\n    def __init__(self, cross_entropy: tf.Variable, name='CE', dtype=None):\r\n        \"\"\" yolo landmark error metric\r\n\r\n        Parameters\r\n        ----------\r\n        MeanMetricWrapper : [type]\r\n\r\n        landmark_error : ResourceVariable\r\n            a variable from yoloalign loss\r\n        name : str, optional\r\n            by default 'LE'\r\n        dtype : [type], optional\r\n            by default None\r\n        \"\"\"\r\n        super().__init__(name=name)\r\n        self.ce = cross_entropy\r\n\r\n    def update_state(self, y_true, y_pred, sample_weight=None):\r\n        self.ce\r\n\r\n    def result(self):\r\n        return self.ce.read_value()\r\n\r\n\r\nclass Myloss(k.losses.Loss):\r\n    def __init__(self, name=None):\r\n        super().__init__(name=name)\r\n        self.ce = tf.get_variable('ce', (), tf.float32, tf.zeros_initializer)  # type:tf.RefVariable\r\n\r\n    def call(self, y_true, y_pred):\r\n        ce_loss = tf.reduce_sum(tf.nn.sigmoid_cross_entropy_with_logits(labels=y_true, logits=y_pred))\r\n\r\n        # ! method 1 got zero output :\r\n        self.ce.assign(ce_loss)\r\n        return ce_loss\r\n\r\n        # ! method 2 get correct output :\r\n        # return ce_loss + 0 * self.ce.assign(ce_loss)\r\n\r\n\r\nmyloss = Myloss()\r\nhigh_cost_metric = Metric_HIGH_COST('high_cost_ce')\r\nlow_cost_metric = Metric_LOW_COST(myloss.ce, 'low_cost_ce')\r\n\r\nsess.run([tf.global_variables_initializer(), tf.local_variables_initializer()])\r\n\r\nmodel.compile(k.optimizers.Adam(), [myloss], [high_cost_metric, low_cost_metric])\r\n\r\nmodel.fit(x_train, y_train, 100, 10)\r\n\r\n```\r\n\r\n**output `low_cost_ce`  always `0`**: \r\n\r\n```sh\r\n11700/60000 [====>.........................] - ETA: 24s - loss: 175.2779 - high_cost_ce: 67.9055 - low_cost_ce: 0.0000e+00\r\n```\r\n\r\n**Describe the expected behavior**\r\n\r\nnew code:\r\n```python\r\nimport tensorflow as tf\r\nimport tensorflow.keras as k\r\nimport tensorflow.keras.layers as kl\r\nimport tensorflow.keras.metrics as km\r\nfrom tensorflow.keras.datasets import fashion_mnist\r\n\r\ntfcfg = tf.ConfigProto()\r\ntfcfg.gpu_options.allow_growth = True\r\nsess = tf.Session(config=tfcfg)\r\nk.backend.set_session(sess)\r\n\r\n(x_train, y_train), (x_test, y_test) = fashion_mnist.load_data()\r\nx_train = x_train.reshape((-1, 28, 28, 1))\r\nx_test = x_test.reshape((-1, 28, 28, 1))\r\ny_train = k.utils.to_categorical(y_train, 10)\r\ny_test = k.utils.to_categorical(y_test, 10)\r\n\r\n\r\nmodel = k.Sequential([\r\n    kl.Conv2D(32, 3, 1, input_shape=[28, 28, 1]),\r\n    kl.BatchNormalization(),\r\n    kl.LeakyReLU(),\r\n    kl.Conv2D(64, 3, 1),\r\n    kl.BatchNormalization(),\r\n    kl.LeakyReLU(),\r\n    kl.Conv2D(128, 3, 1),\r\n    kl.BatchNormalization(),\r\n    kl.LeakyReLU(),\r\n    kl.LeakyReLU(),\r\n    kl.Flatten(),\r\n    kl.Dense(512),\r\n    kl.BatchNormalization(),\r\n    kl.LeakyReLU(),\r\n    kl.Dense(10)\r\n])\r\n\r\n\r\nclass Metric_HIGH_COST(km.Metric):\r\n    def __init__(self, name=None, dtype=None, **kwargs):\r\n        super().__init__(name=name, dtype=dtype, **kwargs)\r\n        self.ce = self.add_weight('ce', initializer=tf.zeros_initializer)\r\n\r\n    def update_state(self, y_true, y_pred, sample_weight=None):\r\n        self.ce.assign(tf.reduce_sum(tf.nn.sigmoid_cross_entropy_with_logits(labels=y_true, logits=y_pred)))\r\n\r\n    def result(self):\r\n        return self.ce\r\n\r\n\r\nclass Metric_LOW_COST(km.Metric):\r\n    def __init__(self, cross_entropy: tf.Variable, name='CE', dtype=None):\r\n        \"\"\" yolo landmark error metric\r\n\r\n        Parameters\r\n        ----------\r\n        MeanMetricWrapper : [type]\r\n\r\n        landmark_error : ResourceVariable\r\n            a variable from yoloalign loss\r\n        name : str, optional\r\n            by default 'LE'\r\n        dtype : [type], optional\r\n            by default None\r\n        \"\"\"\r\n        super().__init__(name=name)\r\n        self.ce = cross_entropy\r\n\r\n    def update_state(self, y_true, y_pred, sample_weight=None):\r\n        self.ce\r\n\r\n    def result(self):\r\n        return self.ce.read_value()\r\n\r\n\r\nclass Myloss(k.losses.Loss):\r\n    def __init__(self, name=None):\r\n        super().__init__(name=name)\r\n        self.ce = tf.get_variable('ce', (), tf.float32, tf.zeros_initializer)  # type:tf.RefVariable\r\n\r\n    def call(self, y_true, y_pred):\r\n        ce_loss = tf.reduce_sum(tf.nn.sigmoid_cross_entropy_with_logits(labels=y_true, logits=y_pred))\r\n\r\n        # ! method 1 got zero output :\r\n        # self.ce.assign(ce_loss)\r\n        # return ce_loss\r\n\r\n        # ! method 2 get correct output :\r\n        return ce_loss + 0 * self.ce.assign(ce_loss)\r\n\r\n\r\nmyloss = Myloss()\r\nhigh_cost_metric = Metric_HIGH_COST('high_cost_ce')\r\nlow_cost_metric = Metric_LOW_COST(myloss.ce, 'low_cost_ce')\r\n\r\nsess.run([tf.global_variables_initializer(), tf.local_variables_initializer()])\r\n\r\nmodel.compile(k.optimizers.Adam(), [myloss], [high_cost_metric, low_cost_metric])\r\n\r\nmodel.fit(x_train, y_train, 100, 10)\r\n```\r\n\r\n```sh\r\n11500/60000 [====>.........................] - ETA: 24s - loss: 172.6385 - high_cost_ce: 85.5574 - low_cost_ce: 171.8945     \r\n```\r\n\r\n#### Why do you have to call the assgin operator in the loss function to update variables?Is this a bug? \r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32013", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32013/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32013/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32013/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32013", "id": 485890917, "node_id": "MDU6SXNzdWU0ODU4OTA5MTc=", "number": 32013, "title": "CustomOp segfaults using work sharder on MacOS with TF1.13.1", "user": {"login": "jeandut", "id": 11030901, "node_id": "MDQ6VXNlcjExMDMwOTAx", "avatar_url": "https://avatars1.githubusercontent.com/u/11030901?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jeandut", "html_url": "https://github.com/jeandut", "followers_url": "https://api.github.com/users/jeandut/followers", "following_url": "https://api.github.com/users/jeandut/following{/other_user}", "gists_url": "https://api.github.com/users/jeandut/gists{/gist_id}", "starred_url": "https://api.github.com/users/jeandut/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jeandut/subscriptions", "organizations_url": "https://api.github.com/users/jeandut/orgs", "repos_url": "https://api.github.com/users/jeandut/repos", "events_url": "https://api.github.com/users/jeandut/events{/privacy}", "received_events_url": "https://api.github.com/users/jeandut/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-08-27T15:47:08Z", "updated_at": "2019-12-28T14:27:43Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): MacOS Mojave 10.14.3\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: No\r\n- TensorFlow installed from (source or binary): from pip\r\n- TensorFlow version (use command below): 1.13.1\r\n- Python version: 3.6.8\r\n- Bazel version (if compiling from source): NA\r\n- GCC/Compiler version (if compiling from source): NA\r\n- CUDA/cuDNN version: NA\r\n- GPU model and memory: NA\r\n\r\n**Describe the current behavior**\r\nWhen running a simple custom-op on CPU adapted from the tutorial with multiple threads using work sharder it can find only 1 thread and segfaults.\r\n\r\n**Describe the expected behavior**\r\nShould find 12 threads and runs.\r\n\r\n**Code to reproduce the issue**\r\nminimal.cc\r\n```c++\r\n #include <stdio.h>\r\n#include <cfloat>\r\n\r\n#include \"third_party/eigen3/unsupported/Eigen/CXX11/Tensor\"\r\n#include \"tensorflow/core/framework/op.h\"\r\n#include \"tensorflow/core/framework/op_kernel.h\"\r\n#include \"tensorflow/core/framework/tensor_shape.h\"\r\n\r\n#include \"./work_sharder.h\"\r\n\r\nusing namespace tensorflow;\r\ntypedef Eigen::ThreadPoolDevice CPUDevice;\r\n\r\nREGISTER_OP(\"Minimal\")\r\n    .Input(\"input: float\")\r\n    .Output(\"shared_arr: float\")\r\n;\r\n\r\nclass MinimalOp : public OpKernel {\r\n public:\r\n  explicit MinimalOp(OpKernelConstruction* context) : OpKernel(context) {}\r\n\r\n  void Compute(OpKernelContext* context) override {\r\n\r\n    const Tensor& input= context->input(0);\r\n    auto input_flat = input.flat<float>();\r\n    const int N = input_flat.size();\r\n\r\n    // Create an output tensor of the right shape\r\n    Tensor* shared_arr = NULL;\r\n    OP_REQUIRES_OK(context, context->allocate_output(0, input.shape(),\r\n                                                     &shared_arr));\r\n    // This tensor is going to be shared among threads\r\n    auto shared_arr_flat = shared_arr->flat<float>();\r\n\r\n    // Shard function on ranges\r\n    auto shard = [&input_flat, &shared_arr_flat]\r\n                  (int64 start, int64 limit) {\r\n        for (int i = 0; start < limit; i++) {\r\n            if ((input_flat(i))<0.){\r\n                shared_arr_flat(i) = 0.;\r\n            }}};\r\n\r\n    std::cout<<\"Shard definition was okay\\n\";\r\n    const DeviceBase::CpuWorkerThreads& worker_threads = *(context->device()->tensorflow_cpu_worker_threads());\r\n    std::cout<<\"Number of workers = \"<<worker_threads.num_threads<<\"\\n\";\r\n    const int64 shard_cost = N;\r\n    Shard(worker_threads.num_threads, worker_threads.workers,\r\n            N, shard_cost, shard);\r\n\r\n  }};\r\n\r\nREGISTER_KERNEL_BUILDER(Name(\"Minimal\").Device(DEVICE_CPU), MinimalOp);\r\n```\r\ncompiling commands:\r\n```\r\nTF_CFLAGS=( $(python3 -c 'import tensorflow as tf; print(\" \".join(tf.sysconfig.get_compile_flags()))') )\r\nTF_LFLAGS=( $(python3 -c 'import tensorflow as tf; print(\" \".join(tf.sysconfig.get_link_flags()))') )\r\ng++ -std=c++11 -shared -undefined dynamic_lookup minimal.cc -o minimal.so -fPIC ${TF_CFLAGS[@]} ${TF_LFLAGS[@]} -O2\r\n```\r\nPython script:\r\n```python\r\nimport tensorflow as tf\r\nimport numpy as np\r\nimport time\r\n\r\n\r\nminimal_module = tf.load_op_library(\"./minimal.so\")\r\ntf_minimal = minimal_module.minimal\r\n\r\ninput_tensor = tf.constant(np.random.normal(size=(100, 100)).astype(\"float32\"))\r\nreturned_tensor = tf_minimal(input_tensor)\r\nsess = tf.Session()\r\nsess.run(returned_tensor)\r\n```\r\n**Other info / logs**\r\nhttps://stackoverflow.com/questions/57427277/tensorflow-customop-multiprocessing-not-working-for-cpu\r\nMaybe related issue: \r\nhttps://github.com/tensorflow/tensorflow/issues/13308\r\ngcc is clang: \r\ng++ --version\r\n```\r\nConfigured with: --prefix=/Library/Developer/CommandLineTools/usr --with-gxx-include-dir=/usr/include/c++/4.2.1\r\nApple LLVM version 10.0.1 (clang-1001.0.46.3)\r\nTarget: x86_64-apple-darwin18.2.0\r\nThread model: posix\r\nInstalledDir: /Library/Developer/CommandLineTools/usr/bin\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32004", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32004/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32004/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32004/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32004", "id": 485701932, "node_id": "MDU6SXNzdWU0ODU3MDE5MzI=", "number": 32004, "title": "Python/C++ API interpreter example for hybrid models", "user": {"login": "DocDriven", "id": 30296124, "node_id": "MDQ6VXNlcjMwMjk2MTI0", "avatar_url": "https://avatars2.githubusercontent.com/u/30296124?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DocDriven", "html_url": "https://github.com/DocDriven", "followers_url": "https://api.github.com/users/DocDriven/followers", "following_url": "https://api.github.com/users/DocDriven/following{/other_user}", "gists_url": "https://api.github.com/users/DocDriven/gists{/gist_id}", "starred_url": "https://api.github.com/users/DocDriven/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DocDriven/subscriptions", "organizations_url": "https://api.github.com/users/DocDriven/orgs", "repos_url": "https://api.github.com/users/DocDriven/repos", "events_url": "https://api.github.com/users/DocDriven/events{/privacy}", "received_events_url": "https://api.github.com/users/DocDriven/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-08-27T09:42:33Z", "updated_at": "2019-11-29T11:28:00Z", "closed_at": null, "author_association": "NONE", "body": "I have a hybrid tflite model, e.g. was converted with the option\r\n\r\n`converter.target_ops = [tf.lite.OpsSet.TFLITE_BUILTINS, tf.lite.OpsSet.SELECT_TF_OPS]`\r\n\r\nSo it contains both tflite ops and normal ops. I test a lot, so this is quicker than implementing the missing parts myself. When trying to load the model with an interpreter, either with the Python or the C++ API, I get errors:\r\n\r\nPython\r\n```\r\nRuntimeError: Regular TensorFlow ops are not supported by this interpreter. Make sure you invoke the Flex delegate before inference.Node number 4 (Flex) failed to prepare.\r\n```\r\nC++\r\n```\r\nINFO: Initialized TensorFlow Lite runtime.\r\nERROR: Regular TensorFlow ops are not supported by this interpreter. Make sure you invoke the Flex delegate before inference.\r\nERROR: Node number 4 (FlexSoftplus) failed to prepare.\r\n```\r\n\r\nIt doesn't seem there are docs that cover how to treat this error and load such hybrid models correctly. If I have missed any docs by any chance, please share the link!"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32001", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32001/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32001/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/32001/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/32001", "id": 485682818, "node_id": "MDU6SXNzdWU0ODU2ODI4MTg=", "number": 32001, "title": "The title is the shared_embeddings module\uff0cbut the document introduces shared_embedding_columns module", "user": {"login": "YeChaopeng", "id": 32784059, "node_id": "MDQ6VXNlcjMyNzg0MDU5", "avatar_url": "https://avatars0.githubusercontent.com/u/32784059?v=4", "gravatar_id": "", "url": "https://api.github.com/users/YeChaopeng", "html_url": "https://github.com/YeChaopeng", "followers_url": "https://api.github.com/users/YeChaopeng/followers", "following_url": "https://api.github.com/users/YeChaopeng/following{/other_user}", "gists_url": "https://api.github.com/users/YeChaopeng/gists{/gist_id}", "starred_url": "https://api.github.com/users/YeChaopeng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/YeChaopeng/subscriptions", "organizations_url": "https://api.github.com/users/YeChaopeng/orgs", "repos_url": "https://api.github.com/users/YeChaopeng/repos", "events_url": "https://api.github.com/users/YeChaopeng/events{/privacy}", "received_events_url": "https://api.github.com/users/YeChaopeng/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-08-27T09:06:45Z", "updated_at": "2019-08-29T21:50:38Z", "closed_at": null, "author_association": "NONE", "body": "Thank you for submitting a TensorFlow documentation issue. Per our GitHub\r\npolicy, we only address code/doc bugs, performance issues, feature requests, and\r\nbuild/installation issues on GitHub.\r\n\r\nThe TensorFlow docs are open source! To get involved, read the documentation\r\ncontributor guide: https://www.tensorflow.org/community/contribute/docs\r\n\r\n## URL(s) with the issue:\r\n\r\nPlease provide a link to the documentation entry, for example:\r\nhttps://tensorflow.google.cn/versions/r2.0/api_docs/python/tf/feature_column/shared_embeddings\r\n\r\n\r\n## Description of issue (what needs changing):\r\n\r\nThe description in the document is a way to use the shared_embedding_columns module, but the title is the shared_embeddings module, and the shared_embedding_columns module has been removed in tensorflow2.0.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31998", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31998/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31998/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31998/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31998", "id": 485639801, "node_id": "MDU6SXNzdWU0ODU2Mzk4MDE=", "number": 31998, "title": "[TF 2.0] GRU layer doesn't work when called from tf.function", "user": {"login": "David-Mao", "id": 12476624, "node_id": "MDQ6VXNlcjEyNDc2NjI0", "avatar_url": "https://avatars3.githubusercontent.com/u/12476624?v=4", "gravatar_id": "", "url": "https://api.github.com/users/David-Mao", "html_url": "https://github.com/David-Mao", "followers_url": "https://api.github.com/users/David-Mao/followers", "following_url": "https://api.github.com/users/David-Mao/following{/other_user}", "gists_url": "https://api.github.com/users/David-Mao/gists{/gist_id}", "starred_url": "https://api.github.com/users/David-Mao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/David-Mao/subscriptions", "organizations_url": "https://api.github.com/users/David-Mao/orgs", "repos_url": "https://api.github.com/users/David-Mao/repos", "events_url": "https://api.github.com/users/David-Mao/events{/privacy}", "received_events_url": "https://api.github.com/users/David-Mao/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1478826728, "node_id": "MDU6TGFiZWwxNDc4ODI2NzI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:core", "name": "comp:core", "color": "024391", "default": false, "description": ""}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "kkimdev", "id": 503414, "node_id": "MDQ6VXNlcjUwMzQxNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/503414?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kkimdev", "html_url": "https://github.com/kkimdev", "followers_url": "https://api.github.com/users/kkimdev/followers", "following_url": "https://api.github.com/users/kkimdev/following{/other_user}", "gists_url": "https://api.github.com/users/kkimdev/gists{/gist_id}", "starred_url": "https://api.github.com/users/kkimdev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kkimdev/subscriptions", "organizations_url": "https://api.github.com/users/kkimdev/orgs", "repos_url": "https://api.github.com/users/kkimdev/repos", "events_url": "https://api.github.com/users/kkimdev/events{/privacy}", "received_events_url": "https://api.github.com/users/kkimdev/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "kkimdev", "id": 503414, "node_id": "MDQ6VXNlcjUwMzQxNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/503414?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kkimdev", "html_url": "https://github.com/kkimdev", "followers_url": "https://api.github.com/users/kkimdev/followers", "following_url": "https://api.github.com/users/kkimdev/following{/other_user}", "gists_url": "https://api.github.com/users/kkimdev/gists{/gist_id}", "starred_url": "https://api.github.com/users/kkimdev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kkimdev/subscriptions", "organizations_url": "https://api.github.com/users/kkimdev/orgs", "repos_url": "https://api.github.com/users/kkimdev/repos", "events_url": "https://api.github.com/users/kkimdev/events{/privacy}", "received_events_url": "https://api.github.com/users/kkimdev/received_events", "type": "User", "site_admin": false}, {"login": "allenlavoie", "id": 3731025, "node_id": "MDQ6VXNlcjM3MzEwMjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3731025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allenlavoie", "html_url": "https://github.com/allenlavoie", "followers_url": "https://api.github.com/users/allenlavoie/followers", "following_url": "https://api.github.com/users/allenlavoie/following{/other_user}", "gists_url": "https://api.github.com/users/allenlavoie/gists{/gist_id}", "starred_url": "https://api.github.com/users/allenlavoie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allenlavoie/subscriptions", "organizations_url": "https://api.github.com/users/allenlavoie/orgs", "repos_url": "https://api.github.com/users/allenlavoie/repos", "events_url": "https://api.github.com/users/allenlavoie/events{/privacy}", "received_events_url": "https://api.github.com/users/allenlavoie/received_events", "type": "User", "site_admin": false}, {"login": "saxenasaurabh", "id": 3967488, "node_id": "MDQ6VXNlcjM5Njc0ODg=", "avatar_url": "https://avatars0.githubusercontent.com/u/3967488?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saxenasaurabh", "html_url": "https://github.com/saxenasaurabh", "followers_url": "https://api.github.com/users/saxenasaurabh/followers", "following_url": "https://api.github.com/users/saxenasaurabh/following{/other_user}", "gists_url": "https://api.github.com/users/saxenasaurabh/gists{/gist_id}", "starred_url": "https://api.github.com/users/saxenasaurabh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saxenasaurabh/subscriptions", "organizations_url": "https://api.github.com/users/saxenasaurabh/orgs", "repos_url": "https://api.github.com/users/saxenasaurabh/repos", "events_url": "https://api.github.com/users/saxenasaurabh/events{/privacy}", "received_events_url": "https://api.github.com/users/saxenasaurabh/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-08-27T07:39:01Z", "updated_at": "2019-09-26T17:17:14Z", "closed_at": null, "author_association": "NONE", "body": "\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\nYes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\nDarwin Kernel Version 18.6.0\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\nN/A\r\n- TensorFlow installed from (source or binary):\r\nbinary\r\n- TensorFlow version (use command below):\r\n2.0.0-dev20190826\r\n- Python version:\r\nPython 3.6.8 :: Anaconda, Inc.\r\n- Bazel version (if compiling from source):\r\nN/A\r\n- GCC/Compiler version (if compiling from source):\r\nN/A\r\n- CUDA/cuDNN version:\r\nN/A\r\n- GPU model and memory:\r\nN/A\r\n\r\n\r\n**Describe the current behavior**\r\n\r\nThe code below raises error:\r\n\r\n> Tried to convert 'tensor' to a tensor and failed. Error: None values not supported.\r\n\r\nAs noted in comments, the bug disappears if we don't use `tf.function`, or set `persistent=False` in gradient tape.\r\n\r\n**Code to reproduce the issue**\r\n\r\n```\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\nx = tf.cast(np.random.randn(1, 100), tf.float32)\r\ny = tf.cast(np.random.randn(1, 100, 100), tf.float32)\r\nz = tf.cast(np.random.randn(1, 100), tf.float32)\r\n\r\nclass Model(tf.keras.Model):\r\n    def __init__(self):\r\n        super(Model, self).__init__()\r\n        self.layer = tf.keras.layers.GRU(100)\r\n\r\n    @tf.function # remove this and it works fine\r\n    def call(self, x, y):\r\n        z = self.layer(y, initial_state=x)\r\n        return z\r\n\r\nmodel = Model()\r\n\r\nwith tf.GradientTape(persistent=True) as tape: # if persistent=False it works fine\r\n    loss = tf.norm(model(x, y) - z)\r\ngrads = tape.gradient(loss, model.trainable_variables)\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31994", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31994/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31994/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31994/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31994", "id": 485562237, "node_id": "MDU6SXNzdWU0ODU1NjIyMzc=", "number": 31994, "title": "Autotune seems not improve performance", "user": {"login": "chengmengli06", "id": 31561586, "node_id": "MDQ6VXNlcjMxNTYxNTg2", "avatar_url": "https://avatars2.githubusercontent.com/u/31561586?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chengmengli06", "html_url": "https://github.com/chengmengli06", "followers_url": "https://api.github.com/users/chengmengli06/followers", "following_url": "https://api.github.com/users/chengmengli06/following{/other_user}", "gists_url": "https://api.github.com/users/chengmengli06/gists{/gist_id}", "starred_url": "https://api.github.com/users/chengmengli06/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chengmengli06/subscriptions", "organizations_url": "https://api.github.com/users/chengmengli06/orgs", "repos_url": "https://api.github.com/users/chengmengli06/repos", "events_url": "https://api.github.com/users/chengmengli06/events{/privacy}", "received_events_url": "https://api.github.com/users/chengmengli06/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1162044565, "node_id": "MDU6TGFiZWwxMTYyMDQ0NTY1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.12", "name": "TF 1.12", "color": "c2e0c6", "default": false, "description": "Issues related to TF 1.12"}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-08-27T03:29:07Z", "updated_at": "2019-09-04T17:18:28Z", "closed_at": null, "author_association": "NONE", "body": "How autotune is implemented? it seems not improve performance, the dataset is still the bottleneck."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31976", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31976/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31976/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31976/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31976", "id": 485193870, "node_id": "MDU6SXNzdWU0ODUxOTM4NzA=", "number": 31976, "title": "[TF2.0] (rc0) Mocking tf.summary.image", "user": {"login": "RaphaelMeudec", "id": 12402673, "node_id": "MDQ6VXNlcjEyNDAyNjcz", "avatar_url": "https://avatars3.githubusercontent.com/u/12402673?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RaphaelMeudec", "html_url": "https://github.com/RaphaelMeudec", "followers_url": "https://api.github.com/users/RaphaelMeudec/followers", "following_url": "https://api.github.com/users/RaphaelMeudec/following{/other_user}", "gists_url": "https://api.github.com/users/RaphaelMeudec/gists{/gist_id}", "starred_url": "https://api.github.com/users/RaphaelMeudec/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RaphaelMeudec/subscriptions", "organizations_url": "https://api.github.com/users/RaphaelMeudec/orgs", "repos_url": "https://api.github.com/users/RaphaelMeudec/repos", "events_url": "https://api.github.com/users/RaphaelMeudec/events{/privacy}", "received_events_url": "https://api.github.com/users/RaphaelMeudec/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 1478826728, "node_id": "MDU6TGFiZWwxNDc4ODI2NzI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:core", "name": "comp:core", "color": "024391", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, {"login": "nfelt", "id": 710113, "node_id": "MDQ6VXNlcjcxMDExMw==", "avatar_url": "https://avatars0.githubusercontent.com/u/710113?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nfelt", "html_url": "https://github.com/nfelt", "followers_url": "https://api.github.com/users/nfelt/followers", "following_url": "https://api.github.com/users/nfelt/following{/other_user}", "gists_url": "https://api.github.com/users/nfelt/gists{/gist_id}", "starred_url": "https://api.github.com/users/nfelt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nfelt/subscriptions", "organizations_url": "https://api.github.com/users/nfelt/orgs", "repos_url": "https://api.github.com/users/nfelt/repos", "events_url": "https://api.github.com/users/nfelt/events{/privacy}", "received_events_url": "https://api.github.com/users/nfelt/received_events", "type": "User", "site_admin": false}, {"login": "Saduf2019", "id": 59822926, "node_id": "MDQ6VXNlcjU5ODIyOTI2", "avatar_url": "https://avatars2.githubusercontent.com/u/59822926?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Saduf2019", "html_url": "https://github.com/Saduf2019", "followers_url": "https://api.github.com/users/Saduf2019/followers", "following_url": "https://api.github.com/users/Saduf2019/following{/other_user}", "gists_url": "https://api.github.com/users/Saduf2019/gists{/gist_id}", "starred_url": "https://api.github.com/users/Saduf2019/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Saduf2019/subscriptions", "organizations_url": "https://api.github.com/users/Saduf2019/orgs", "repos_url": "https://api.github.com/users/Saduf2019/repos", "events_url": "https://api.github.com/users/Saduf2019/events{/privacy}", "received_events_url": "https://api.github.com/users/Saduf2019/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-08-26T11:46:20Z", "updated_at": "2020-03-19T16:47:04Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): `pip install tensorflow==2.0.0rc0` \r\n- TensorFlow version (use command below):\r\n- Python version: 3.6.8\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: CPU version\r\n- GPU model and memory: CPU version\r\n\r\n**Problem**\r\n\r\nI have been using successfully `unittest.mock.patch` on `tf.summary.image` with version `2.0.0-beta1`. When upgrading to `2.0.0rc0`, the mock doesn't appear anymore and the full function is used. I couldn't find the change that breaks this. Any idea how to perform the mock?\r\n\r\n**Sample code**\r\n\r\nThe following code is a sample of `tf.summary.image` call inside a callback, and running a simple `.fit`. It runs perfectly on `2.0.0-beta1`, but fails on `2.0.0rc0`.\r\n\r\nTo reproduce, have those 2 snippets (`tf_write_summary.py` and `test_tf_write_summary.py`) in a folder and run `python -m pytest test_tf_write_summary.py`.\r\n\r\n**`tf_write_summary.py`**\r\n```python\r\nfrom datetime import datetime\r\nfrom pathlib import Path\r\n\r\nimport tensorflow as tf\r\nfrom tensorflow.keras.callbacks import Callback\r\n\r\nclass TestCallback(Callback):\r\n    def __init__(\r\n        self,\r\n        images,\r\n        output_dir=Path(\"./logs/activations_visualizations\"),\r\n    ):\r\n        super(TestCallback, self).__init__()\r\n        self.images = images\r\n        self.output_dir = Path(output_dir) / datetime.now().strftime(\"%Y%m%d-%H%M%S.%f\")\r\n        Path.mkdir(Path(self.output_dir), parents=True, exist_ok=True)\r\n\r\n        self.file_writer = tf.summary.create_file_writer(str(self.output_dir))\r\n\r\n    def on_epoch_end(self, epoch, logs=None):\r\n        with self.file_writer.as_default():\r\n            # tf.summary.image should be a MagicMock object\r\n            tf.summary.image(\r\n                \"Test Callback\",\r\n                self.images,\r\n                step=epoch,\r\n            )\r\n```\r\n\r\n**`test_tf_write_summary.py`**\r\n```python\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\nimport tf_write_summary\r\n\r\n\r\ndef test_callback(mocker):\r\n    mock_image_summary = mocker.patch('tf_write_summary.tf.summary.image')\r\n    fake_image_values = [0]\r\n    callback = tf_write_summary.TestCallback(fake_image_values)\r\n\r\n    model = tf.keras.Sequential(\r\n        [\r\n            tf.keras.layers.Conv2D(\r\n                16,\r\n                (3, 3),\r\n                activation=None,\r\n                name=\"conv_1\",\r\n                input_shape=(28, 28, 3),\r\n            ),\r\n            tf.keras.layers.ReLU(name=\"activation_1\"),\r\n            tf.keras.layers.Flatten(),\r\n            tf.keras.layers.Dense(2, activation=\"softmax\"),\r\n        ]\r\n    )\r\n\r\n    model.compile(optimizer=\"adam\", loss=\"categorical_crossentropy\")\r\n\r\n    y = np.array([1, 0] * 4).reshape((4, 2))\r\n    model.fit(np.random.random((4, 28, 28, 3)), y, epochs=1, batch_size=2, callbacks=[callback])\r\n\r\n    mock_image_summary.assert_called_once_with(\"Test Callback\", [0], step=0)\r\n```\r\n\r\n\r\nThanks for your time!"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31967", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31967/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31967/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31967/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31967", "id": 485025313, "node_id": "MDU6SXNzdWU0ODUwMjUzMTM=", "number": 31967, "title": "Select compiler for building", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars3.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-08-26T03:32:24Z", "updated_at": "2019-09-13T18:31:18Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using):\r\n1.14\r\n\r\n- Are you willing to contribute it (Yes/No):\r\n\r\nYes\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nSelect the compiler to use for building in configure.py\r\n\r\n**Will this change the current api? How?**\r\n\r\nI don't think so.\r\n\r\n**Who will benefit with this feature?**\r\n\r\nEveryone who needs it\r\n\r\n**Any Other info.**\r\n\r\n\r\nIs it possible in the python configure script to choose the compiler when building on a non-linux? On windows, I have several compilers, but the script always selects the wrong compiler. On linux, it asks for the compiler to use, but doesn't on other systems. I will try to see how the script works so it can detect the compilers and let the user select it so it won't choose the wrong compiler or version."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31948", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31948/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31948/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31948/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31948", "id": 484857798, "node_id": "MDU6SXNzdWU0ODQ4NTc3OTg=", "number": 31948, "title": "[TensorFlow Lite] GPU delegates on Android with GPU nightly fail to run on GPU (it seems to run on CPU)", "user": {"login": "val9299", "id": 53229616, "node_id": "MDQ6VXNlcjUzMjI5NjE2", "avatar_url": "https://avatars2.githubusercontent.com/u/53229616?v=4", "gravatar_id": "", "url": "https://api.github.com/users/val9299", "html_url": "https://github.com/val9299", "followers_url": "https://api.github.com/users/val9299/followers", "following_url": "https://api.github.com/users/val9299/following{/other_user}", "gists_url": "https://api.github.com/users/val9299/gists{/gist_id}", "starred_url": "https://api.github.com/users/val9299/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/val9299/subscriptions", "organizations_url": "https://api.github.com/users/val9299/orgs", "repos_url": "https://api.github.com/users/val9299/repos", "events_url": "https://api.github.com/users/val9299/events{/privacy}", "received_events_url": "https://api.github.com/users/val9299/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-08-24T20:10:40Z", "updated_at": "2019-11-05T20:55:29Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): \r\nno (for the demo APP & classification APP); \r\nyes (for the object detection APP), but only added GPU delegate and used a self-converted SSD float model\r\n- Mobile device: Google Pixel 2 XL (Android 8.0.0 and Android 9)\r\n- TensorFlow Lite version: nightly 0.0.0 + GPU nightly 0.0.0\r\n- OS Platform and Distribution: Windows 10 64 bit\r\n- TensorFlow installed from: binary\r\n- TensorFlow version: 1.13.1\r\n- Python version: 3.6.8\r\n- CUDA/cuDNN version: 10.0 / 7.6.0\r\n- GPU model and memory: GeForce GTX 970, AMD64\r\n\r\n**Describe the current behavior**\r\nI cannot get any APP to run on GPU using GPU nightly. All the APPs seem to run on CPU even though the GPU delegates are used by the interpreter and no error occurs.\r\n\r\n**Describe the expected behavior**\r\nThe APPs should run on GPU. The models running on GPU should be faster than the models running on CPU.\r\n\r\n**Code to reproduce the issue**\r\nI tried the demo APP and the classification APP without changes to the code. For the object detection APP I added the GPU delegate, changed isQuantized to false, and I use a self-converted SSD mobilenet model. I wrote the delegate as described in https://www.tensorflow.org/lite/performance/gpu_advanced#android_java and I converted the model this way: https://github.com/tensorflow/tensorflow/issues/31015#issuecomment-517165233.\r\n\r\n- Demo APP: https://github.com/tensorflow/tensorflow/tree/master/tensorflow/lite/java/demo\r\n- Classification APP: https://github.com/tensorflow/examples/tree/master/lite/examples/image_classification/android\r\n- Object Detection APP: https://github.com/tensorflow/examples/tree/master/lite/examples/object_detection/android\r\n\r\n**Other info / logs**\r\nPerformance results testing the APPs on Google Pixel 2 XL (with Android 8.0.0 and Android 9):\r\n\r\n_GPU nightly:_\r\nCurrent demo APP\r\n- Quantized Model + CPU -> 75ms\r\n- Float Model + CPU -> 135ms\r\n- Float Model + GPU -> **135ms**\r\n\r\nObject Detection APP \r\n- (self-converted) Float Model + GPU -> **100 ms**\r\n\r\n_CPU only_:\r\nObjekt Detection APP (I only changed targedSdkVersion to 28 to get the original code working):\r\n- Quantized Model + CPU -> 45-50ms\r\n\r\nThanks in advance!"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31932", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31932/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31932/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31932/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31932", "id": 484672254, "node_id": "MDU6SXNzdWU0ODQ2NzIyNTQ=", "number": 31932, "title": "How to create Python extension module that uses TensorFlow C API?", "user": {"login": "peastman", "id": 4379786, "node_id": "MDQ6VXNlcjQzNzk3ODY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4379786?v=4", "gravatar_id": "", "url": "https://api.github.com/users/peastman", "html_url": "https://github.com/peastman", "followers_url": "https://api.github.com/users/peastman/followers", "following_url": "https://api.github.com/users/peastman/following{/other_user}", "gists_url": "https://api.github.com/users/peastman/gists{/gist_id}", "starred_url": "https://api.github.com/users/peastman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/peastman/subscriptions", "organizations_url": "https://api.github.com/users/peastman/orgs", "repos_url": "https://api.github.com/users/peastman/repos", "events_url": "https://api.github.com/users/peastman/events{/privacy}", "received_events_url": "https://api.github.com/users/peastman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}], "state": "open", "locked": false, "assignee": {"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-08-23T19:09:40Z", "updated_at": "2019-11-20T03:07:52Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): macOS 10.13.6\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version: 1.14.0\r\n- Python version: 3.7.3\r\n- Installed using virtualenv? pip? conda?: conda\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: n/a\r\n- GPU model and memory: n/a\r\n\r\n\r\n\r\n**Describe the problem**\r\n\r\n\r\n\r\nI've written a Python extension module that uses TensorFlow through the C API. I installed the API as described in https://www.tensorflow.org/install/lang_c. On its own, my module works correctly. But if I import my extension module and then also `import tensorflow`, Python crashes with this error.\r\n\r\n```\r\n[libprotobuf ERROR external/protobuf_archive/src/google/protobuf/descriptor_database.cc:58] File already exists in database: tensorflow/core/protobuf/master.proto\r\n[libprotobuf FATAL external/protobuf_archive/src/google/protobuf/descriptor.cc:1370] CHECK failed: GeneratedDatabase()->Add(encoded_file_descriptor, size): \r\nlibc++abi.dylib: terminating with uncaught exception of type google::protobuf::FatalException: CHECK failed: GeneratedDatabase()->Add(encoded_file_descriptor, size): \r\nAbort trap: 6\r\n```\r\n\r\nI believe this happens because the C API includes its own complete copy of TensorFlow, so now I get two different copies loaded into the same process at the same time.\r\n\r\nWhat is the solution to this? How can I have Python code that uses TensorFlow, and also invokes C code that uses TensorFlow?\r\n\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31928", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31928/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31928/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31928/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31928", "id": 484582212, "node_id": "MDU6SXNzdWU0ODQ1ODIyMTI=", "number": 31928, "title": "[tf.estimator] Training with tf.estimator + tf.keras and tf.keras only yields inconsistent results", "user": {"login": "sdll", "id": 17913919, "node_id": "MDQ6VXNlcjE3OTEzOTE5", "avatar_url": "https://avatars1.githubusercontent.com/u/17913919?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sdll", "html_url": "https://github.com/sdll", "followers_url": "https://api.github.com/users/sdll/followers", "following_url": "https://api.github.com/users/sdll/following{/other_user}", "gists_url": "https://api.github.com/users/sdll/gists{/gist_id}", "starred_url": "https://api.github.com/users/sdll/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sdll/subscriptions", "organizations_url": "https://api.github.com/users/sdll/orgs", "repos_url": "https://api.github.com/users/sdll/repos", "events_url": "https://api.github.com/users/sdll/events{/privacy}", "received_events_url": "https://api.github.com/users/sdll/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-08-23T15:14:07Z", "updated_at": "2019-10-31T02:49:33Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): **yes**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): `macOS 10.14.6 (18G87)`\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: **n/a**\r\n- TensorFlow installed from (source or binary): **binary**\r\n- TensorFlow version (use command below): `v1.14.0-rc1-22-gaf24dc91b5 1.14.0`\r\n- Python version: `3.7.3`\r\n- Bazel version (if compiling from source): **n/a**\r\n- GCC/Compiler version (if compiling from source): **n/a**\r\n- CUDA/cuDNN version: **n/a**\r\n- GPU model and memory: **none**\r\n\r\n**Describe the current behavior**\r\n\r\nFollowing the official guides ([[1]](https://www.tensorflow.org/guide/estimators#creating_estimators_from_keras_models), [[2]](https://www.tensorflow.org/beta/guide/migration_guide#using_a_custom_model_fn)), I was training [PSENet](https://github.com/sdll/psenet/tree/master/psenet) for text detection. Even though train metrics did improve to almost perfect levels and the loss remained stable and low after a while, the inference I got was gibberish.\r\n\r\nPSENet works as follows: running the image through the feature pyramid network to obtain segmentation maps, it then applies a custom algorithm to extract bboxes. The images below show the segmentation maps, with yellow regions corresponding to the predicted text, and purple to everything else.\r\n\r\nAfter 186 attempts to make it work on the AI Platform and $400 of GSoC credits, I realized that the problem was deeper than the implementation details, and decided to overfit on a single sample, using the `tf.keras` implementation of FPN from [`segmentation_models`](https://github.com/qubvel/segmentation_models) by @qubvel. I have tweaked his implementation for PSENet and ran into the same problems with `tf.estimator`, so it seems that `tf.estimator` is indeed the culprit.\r\n\r\nFor this sample image\r\n\r\n![sample image](https://raw.githubusercontent.com/sdll/tf.estimator-failing-example/master/docs/input.png)\r\n \r\nand one of the labels\r\n\r\n![sample label](https://raw.githubusercontent.com/sdll/tf.estimator-failing-example/master/docs/label.png)\r\n\r\nafter 300 epochs, the same loss and optimizer, the predicted labels\r\n\r\n- with a pure `tf.keras` implementation:\r\n\r\n![](https://raw.githubusercontent.com/sdll/tf.estimator-failing-example/master/docs/training-with-pure-keras.png)\r\n\r\n- with the `tf.keras` model converted using `tf.keras.estimator.model_to_estimator`:\r\n\r\n![](https://raw.githubusercontent.com/sdll/tf.estimator-failing-example/master/docs/training-with-estimator-and-conversion.png)\r\n\r\n- with the `tf.keras` model used in the `tf.estimator` model function:\r\n\r\n![](https://raw.githubusercontent.com/sdll/tf.estimator-failing-example/master/docs/training-with-estimator-and-no-conversion.png)\r\n\r\nI have tried the `tf.keras`-in-`model_fn` setup on 10 000 images for 30-50 epochs, and the results are much worse than this, which is itself not perfect.\r\n\r\n**Describe the expected behavior**\r\n\r\n1. TensorFlow documentation should state clearly the preferred way to use `tf.keras` models inside `tf.estimator`, given the knowledge that `tf.estimator` is built on `tf.keras.layers` and thus the expectation that interops is seamless.\r\n\r\n2. The discrepancy between training with `tf.keras` and `tf.estimator` + `tf.keras` should be minimal or non-existent\r\n\r\n**Code to reproduce the issue**\r\n\r\nThe minimal failing example with the code and data is [here](https://github.com/sdll/tf.estimator-failing-example).\r\n\r\n**Other info / logs**\r\n\r\nhttps://github.com/tensorflow/tensorflow/issues/25670 is a related issue. Similar findings are documented [here](https://stackoverflow.com/questions/54910215/tensorflow-estimator-fails-to-converge-on-model-converted-from-keras-when-using).\r\n\r\nI can also confirm that training with `tf.estimator` took longer than with pure `tf.keras`, in alignment with [other reports](https://stackoverflow.com/questions/56930892/tf-estimator-vs-tf-keras-speed-disparity) of this behavior.  \r\n\r\n\r\nThe model itself is sensible, and the following example shows that it does generalize well. For this input (not in the original data):\r\n\r\n![IMAGE 2019-08-23 17:13:30](https://user-images.githubusercontent.com/17913919/63598985-549a2f80-c5c9-11e9-9cfe-2db8e72694f9.jpg)\r\n\r\n- the output from [another implementation](https://github.com/liuheng92/tensorflow_PSENet) written in tf.slim is as follows:\r\n\r\n![IMAGE 2019-08-23 17:14:20](https://user-images.githubusercontent.com/17913919/63599060-72679480-c5c9-11e9-84e1-0b95a9f12edf.jpg)\r\n\r\n- the output from the [Pytorch implementation](https://github.com/whai362/PSENet) by the original authors is this:\r\n\r\n![IMAGE 2019-08-23 17:16:54](https://user-images.githubusercontent.com/17913919/63599211-cecab400-c5c9-11e9-95e7-e8b48a5cc2e3.jpg)"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31925", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31925/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31925/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31925/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31925", "id": 484478248, "node_id": "MDU6SXNzdWU0ODQ0NzgyNDg=", "number": 31925, "title": "[TF1.x][TPU] How to perform preprocessing steps for text classification for training on TPU?", "user": {"login": "rishabhsahrawat", "id": 15910460, "node_id": "MDQ6VXNlcjE1OTEwNDYw", "avatar_url": "https://avatars2.githubusercontent.com/u/15910460?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rishabhsahrawat", "html_url": "https://github.com/rishabhsahrawat", "followers_url": "https://api.github.com/users/rishabhsahrawat/followers", "following_url": "https://api.github.com/users/rishabhsahrawat/following{/other_user}", "gists_url": "https://api.github.com/users/rishabhsahrawat/gists{/gist_id}", "starred_url": "https://api.github.com/users/rishabhsahrawat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rishabhsahrawat/subscriptions", "organizations_url": "https://api.github.com/users/rishabhsahrawat/orgs", "repos_url": "https://api.github.com/users/rishabhsahrawat/repos", "events_url": "https://api.github.com/users/rishabhsahrawat/events{/privacy}", "received_events_url": "https://api.github.com/users/rishabhsahrawat/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097541661, "node_id": "MDU6TGFiZWwxMDk3NTQxNjYx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tpus", "name": "comp:tpus", "color": "0052cc", "default": false, "description": "tpu, tpuestimator"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "saeta", "id": 1284535, "node_id": "MDQ6VXNlcjEyODQ1MzU=", "avatar_url": "https://avatars1.githubusercontent.com/u/1284535?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saeta", "html_url": "https://github.com/saeta", "followers_url": "https://api.github.com/users/saeta/followers", "following_url": "https://api.github.com/users/saeta/following{/other_user}", "gists_url": "https://api.github.com/users/saeta/gists{/gist_id}", "starred_url": "https://api.github.com/users/saeta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saeta/subscriptions", "organizations_url": "https://api.github.com/users/saeta/orgs", "repos_url": "https://api.github.com/users/saeta/repos", "events_url": "https://api.github.com/users/saeta/events{/privacy}", "received_events_url": "https://api.github.com/users/saeta/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "saeta", "id": 1284535, "node_id": "MDQ6VXNlcjEyODQ1MzU=", "avatar_url": "https://avatars1.githubusercontent.com/u/1284535?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saeta", "html_url": "https://github.com/saeta", "followers_url": "https://api.github.com/users/saeta/followers", "following_url": "https://api.github.com/users/saeta/following{/other_user}", "gists_url": "https://api.github.com/users/saeta/gists{/gist_id}", "starred_url": "https://api.github.com/users/saeta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saeta/subscriptions", "organizations_url": "https://api.github.com/users/saeta/orgs", "repos_url": "https://api.github.com/users/saeta/repos", "events_url": "https://api.github.com/users/saeta/events{/privacy}", "received_events_url": "https://api.github.com/users/saeta/received_events", "type": "User", "site_admin": false}, {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-08-23T11:21:20Z", "updated_at": "2019-09-03T17:20:43Z", "closed_at": null, "author_association": "NONE", "body": "I have been trying since 5 days to train a simple text classification model on TPUs. But because of lack of documentation it is very difficult. I just can not perform tokenization, encoding, padding without `tf.py_func`. Please add some examples for doing these steps for TPU devices so that dumb people like me can understand TF. Will be greatly thankful to everyone at Google.\r\nI am following this [tutorial](https://www.tensorflow.org/beta/tutorials/load_data/text#split_the_dataset_into_text_and_train_batches)."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31912", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31912/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31912/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31912/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31912", "id": 484277749, "node_id": "MDU6SXNzdWU0ODQyNzc3NDk=", "number": 31912, "title": "Not able to build GPU custom op example ", "user": {"login": "alexminnaar", "id": 3454453, "node_id": "MDQ6VXNlcjM0NTQ0NTM=", "avatar_url": "https://avatars1.githubusercontent.com/u/3454453?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexminnaar", "html_url": "https://github.com/alexminnaar", "followers_url": "https://api.github.com/users/alexminnaar/followers", "following_url": "https://api.github.com/users/alexminnaar/following{/other_user}", "gists_url": "https://api.github.com/users/alexminnaar/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexminnaar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexminnaar/subscriptions", "organizations_url": "https://api.github.com/users/alexminnaar/orgs", "repos_url": "https://api.github.com/users/alexminnaar/repos", "events_url": "https://api.github.com/users/alexminnaar/events{/privacy}", "received_events_url": "https://api.github.com/users/alexminnaar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-08-23T00:45:46Z", "updated_at": "2020-01-03T06:28:50Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 1.14.0\r\n- Python version: 3.5\r\n- CUDA/cuDNN version: 10.0\r\n- GPU model and memory: GeForce GTX 980M\r\n\r\n**Describe the current behavior**\r\nFollowing the [instructions here](https://www.tensorflow.org/guide/extend/op#gpu_support) I navigate to ```tensorflow/tensorflow/examples/adding_an_op``` and run\r\n```\r\nnvcc -std=c++11 -c -o cuda_op_kernel.cu.o cuda_op_kernel.cu.cc  ${TF_CFLAGS[@]} -D GOOGLE_CUDA=1 -x cu -Xcompiler -fPIC\r\n```\r\n\r\nand I get the error\r\n\r\n```\r\nIn file included from cuda_op_kernel.cu.cc:19:0:\r\n/home/alex/.local/lib/python3.5/site-packages/tensorflow/include/tensorflow/core/util/gpu_kernel_helper.h:22:53: fatal error: third_party/gpus/cuda/include/cuda_fp16.h: No such file or directory\r\ncompilation terminated.\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31907", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31907/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31907/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31907/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31907", "id": 484233030, "node_id": "MDU6SXNzdWU0ODQyMzMwMzA=", "number": 31907, "title": "please add tensor factorization", "user": {"login": "bionicles", "id": 24532336, "node_id": "MDQ6VXNlcjI0NTMyMzM2", "avatar_url": "https://avatars2.githubusercontent.com/u/24532336?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bionicles", "html_url": "https://github.com/bionicles", "followers_url": "https://api.github.com/users/bionicles/followers", "following_url": "https://api.github.com/users/bionicles/following{/other_user}", "gists_url": "https://api.github.com/users/bionicles/gists{/gist_id}", "starred_url": "https://api.github.com/users/bionicles/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bionicles/subscriptions", "organizations_url": "https://api.github.com/users/bionicles/orgs", "repos_url": "https://api.github.com/users/bionicles/repos", "events_url": "https://api.github.com/users/bionicles/events{/privacy}", "received_events_url": "https://api.github.com/users/bionicles/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rmlarsen", "id": 16907534, "node_id": "MDQ6VXNlcjE2OTA3NTM0", "avatar_url": "https://avatars2.githubusercontent.com/u/16907534?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmlarsen", "html_url": "https://github.com/rmlarsen", "followers_url": "https://api.github.com/users/rmlarsen/followers", "following_url": "https://api.github.com/users/rmlarsen/following{/other_user}", "gists_url": "https://api.github.com/users/rmlarsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmlarsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmlarsen/subscriptions", "organizations_url": "https://api.github.com/users/rmlarsen/orgs", "repos_url": "https://api.github.com/users/rmlarsen/repos", "events_url": "https://api.github.com/users/rmlarsen/events{/privacy}", "received_events_url": "https://api.github.com/users/rmlarsen/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-08-22T21:48:31Z", "updated_at": "2019-09-11T23:06:09Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using): 2b1\r\n- Are you willing to contribute it (Yes/No): I want to but I don't think I'm qualified\r\n\r\n**Describe the feature and the current behavior/state.**\r\ntensorflow is about tensors but there's no built-in tensor factorization. \r\ni do believe this should be a core feature of the framework...what do you think?\r\n\r\n**Will this change the current api? How?**\r\ntf.linalg (i guess) would have something like Tucker Decomposition, higher order SVD\r\nwould this be a good 2.0 feature?\r\n\r\n**Who will benefit with this feature?**\r\npeople who need to compress / factorize big tensors\r\n\r\n**Any Other info.**\r\nhttp://tensorly.org/stable/user_guide/quickstart.html#tensor-decomposition\r\nhttps://github.com/hottbox/hottbox"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31900", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31900/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31900/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31900/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31900", "id": 484103205, "node_id": "MDU6SXNzdWU0ODQxMDMyMDU=", "number": 31900, "title": "'is_final' is not a member of 'std'", "user": {"login": "plopresti", "id": 8864861, "node_id": "MDQ6VXNlcjg4NjQ4NjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/8864861?v=4", "gravatar_id": "", "url": "https://api.github.com/users/plopresti", "html_url": "https://github.com/plopresti", "followers_url": "https://api.github.com/users/plopresti/followers", "following_url": "https://api.github.com/users/plopresti/following{/other_user}", "gists_url": "https://api.github.com/users/plopresti/gists{/gist_id}", "starred_url": "https://api.github.com/users/plopresti/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/plopresti/subscriptions", "organizations_url": "https://api.github.com/users/plopresti/orgs", "repos_url": "https://api.github.com/users/plopresti/repos", "events_url": "https://api.github.com/users/plopresti/events{/privacy}", "received_events_url": "https://api.github.com/users/plopresti/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-08-22T16:45:16Z", "updated_at": "2019-09-02T22:19:57Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux RedHat 7.6\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version: master branch\r\n- Python version: N/A\r\n- Installed using virtualenv? pip? conda?: N/A\r\n- Bazel version (if compiling from source): 0.25.2\r\n- GCC/Compiler version (if compiling from source): cc version 8.2.1 20180905 (Red Hat 8.2.1-3)\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: N/A\r\n\r\n\r\n\r\n**Describe the problem**\r\n\r\nCompilation of LLVM is failing because '-std=c++0x' is being passed, but current LLVM uses C++14 features.\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n\r\nbazel build --verbose_failures --config opt --config mkl //tensorflow/tools/pip_package:build_pip_package\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\nNote \"-std=c++0x\" option. I could probably fix this myself if I could figure out where it is coming from...\r\n```\r\n  /opt/rh/devtoolset-8/root/usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections -fdata-sections '-std=c++0x' -MD -MF bazel-out/host/bin/tensorflow/compiler/mlir/lite/quantization/_objs/op_quant_spec_getters_gen/op_quant_spec_getters_gen.d '-frandom-seed=bazel-out/host/bin/tensorflow/compiler/mlir/lite/quantization/_objs/op_quant_spec_getters_gen/op_quant_spec_getters_gen.o' -DLLVM_ENABLE_STATS -D__STDC_LIMIT_MACROS -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -DLLVM_BUILD_GLOBAL_ISEL -iquote . -iquote bazel-out/host/bin -iquote external/llvm -iquote bazel-out/host/bin/external/llvm -iquote external/zlib_archive -iquote bazel-out/host/bin/external/zlib_archive -iquote external/local_config_mlir -iquote bazel-out/host/bin/external/local_config_mlir -iquote external/bazel_tools -iquote bazel-out/host/bin/external/bazel_tools -isystem external/llvm/include -isystem bazel-out/host/bin/external/llvm/include -isystem external/zlib_archive -isystem bazel-out/host/bin/external/zlib_archive -isystem external/local_config_mlir/include -isystem bazel-out/host/bin/external/local_config_mlir/include -g0 '-march=native' -g0 -DEIGEN_AVOID_STL_ARRAY -Iexternal/gemmlowp -Wno-sign-compare '-ftemplate-depth=900' -fno-exceptions '-DINTEL_MKL=1' -DEIGEN_USE_VML -DENABLE_MKL -fopenmp -msse3 -pthread -fno-canonical-system-headers -Wno-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -c tensorflow/compiler/mlir/lite/quantization/tools/op_quant_spec_getters_gen.cc -o bazel-out/host/bin/tensorflow/compiler/mlir/lite/quantization/_objs/op_quant_spec_getters_gen/op_quant_spec_getters_gen.o)\r\nExecution platform: @bazel_tools//platforms:host_platform\r\nIn file included from external/llvm/include/llvm/TableGen/Record.h:27,\r\n                 from tensorflow/compiler/mlir/lite/quantization/tools/op_quant_spec_getters_gen.cc:21:\r\nexternal/llvm/include/llvm/Support/TrailingObjects.h: In static member function 'static void llvm::TrailingObjects<BaseTy, TrailingTys>::verifyTrailingObjectsAssertions()':\r\nexternal/llvm/include/llvm/Support/TrailingObjects.h:252:24: error: 'is_final' is not a member of 'std'\r\n     static_assert(std::is_final<BaseTy>(), \"BaseTy must be final.\");\r\n                        ^~~~~~~~\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31896", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31896/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31896/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31896/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31896", "id": 484052701, "node_id": "MDU6SXNzdWU0ODQwNTI3MDE=", "number": 31896, "title": "tf-2.0.0rc0-gpu tf.dataset bug", "user": {"login": "LaCandela", "id": 33752571, "node_id": "MDQ6VXNlcjMzNzUyNTcx", "avatar_url": "https://avatars1.githubusercontent.com/u/33752571?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LaCandela", "html_url": "https://github.com/LaCandela", "followers_url": "https://api.github.com/users/LaCandela/followers", "following_url": "https://api.github.com/users/LaCandela/following{/other_user}", "gists_url": "https://api.github.com/users/LaCandela/gists{/gist_id}", "starred_url": "https://api.github.com/users/LaCandela/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LaCandela/subscriptions", "organizations_url": "https://api.github.com/users/LaCandela/orgs", "repos_url": "https://api.github.com/users/LaCandela/repos", "events_url": "https://api.github.com/users/LaCandela/events{/privacy}", "received_events_url": "https://api.github.com/users/LaCandela/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2019-08-22T15:10:02Z", "updated_at": "2020-02-08T01:09:55Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code: yes \r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04 LTS\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): docker image\r\n- TensorFlow version (use command below): tensorflow/tensorflow:2.0.0rc0-gpu-py3\r\n- Python version: 3.6\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: CUDA 10\r\n- GPU model and memory:\r\n\r\n**Describe the current behavior**\r\nI am using tf.keras for training with the dataset api and TFrecords. At the beginning of the training the dataset api tries to load and shuffle the whole training dataset so the memory fills up and the process dies.  I cannot train my model at all. I am not using any .shuffle() calls in my dataset pipeline.\r\n\r\n**Describe the expected behavior**\r\nThe dataset should not load and shuffle the records unless the .shuffle() call is issued.\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport numpy as np\r\nimport tensorflow as tf\r\nimport os\r\nimport cv2\r\nimport tensorflow.keras.layers as K\r\n\r\ndef extract_fn(data_record):\r\n    features = {\r\n        'data': tf.io.FixedLenFeature([], tf.string)\r\n    }\r\n    sample = tf.io.parse_single_example(data_record, features)\r\n    data = tf.image.decode_image(sample['data'])\r\n\r\n    return data, 1.\r\n\r\n\r\nclass DataGenerator(tf.keras.utils.Sequence):\r\n\r\n    def __init__(self, dataset_iterator, len):\r\n        self.dataset_iterator = dataset_iterator\r\n        self.len = len\r\n\r\n    def __len__(self):\r\n        # number of batches per epoch\r\n        return self.len\r\n\r\n    def __getitem__(self, index):\r\n        # Generate one batch of data\r\n\r\n        next_element = next(self.dataset_iterator)\r\n        x = next_element[0]\r\n        y = next_element[1]\r\n\r\n        return x, y\r\n\r\n\r\nwith tf.io.TFRecordWriter(\"dummy_dataset.tfrecords\") as writer:\r\n    data = np.float32(np.random.random(size=(1000, 1000, 3)) * 255)\r\n    data = cv2.imencode(\".png\", data)[1].tostring()\r\n    example = tf.train.Example(features=tf.train.Features(\r\n        feature={'data': tf.train.Feature(bytes_list=tf.train.BytesList(value=[data]))}))\r\n    for i in range(10000):\r\n        writer.write(example.SerializeToString())\r\n\r\ndataset = tf.data.TFRecordDataset([\"dummy_dataset.tfrecords\"])\r\ndataset = dataset.map(extract_fn)\r\nn_batch = 3\r\ndataset = dataset.batch(batch_size=n_batch, drop_remainder=True)\r\n\r\ndataset = dataset.repeat(5)\r\ndataset_iterator = iter(dataset)\r\nnext_element = next(dataset_iterator)\r\n\r\ndata_generator = DataGenerator(dataset_iterator, int(10000/n_batch))\r\n\r\ninput = K.Input(shape=(1000, 1000, 3), name='input')\r\nnet = K.Conv2D(1, 3, activation='sigmoid')(input)\r\noutput = K.GlobalAveragePooling2D()(net)\r\nmodel = tf.keras.models.Model(inputs=input, outputs=output)\r\n\r\nmodel.compile(loss='mse', optimizer='sgd')\r\n\r\nmodel.fit(x=data_generator, epochs=10)\r\n```\r\n**Other info / logs**\r\nnote that code generates about 28GB dummy data in a tfrecord file since I am having this issue when I am trying to use the dataset api with tf.keras.utils.Sequence on a tfrecord file.\r\n\r\nEDIT(robieta): code formatting."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31894", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31894/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31894/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31894/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31894", "id": 484031664, "node_id": "MDU6SXNzdWU0ODQwMzE2NjQ=", "number": 31894, "title": "tf.keras.layers.BatchNormalization() throws TypeError: Incompatible types: <dtype: 'resource'> vs. int64. Value is 0 ", "user": {"login": "notabee", "id": 42443321, "node_id": "MDQ6VXNlcjQyNDQzMzIx", "avatar_url": "https://avatars1.githubusercontent.com/u/42443321?v=4", "gravatar_id": "", "url": "https://api.github.com/users/notabee", "html_url": "https://github.com/notabee", "followers_url": "https://api.github.com/users/notabee/followers", "following_url": "https://api.github.com/users/notabee/following{/other_user}", "gists_url": "https://api.github.com/users/notabee/gists{/gist_id}", "starred_url": "https://api.github.com/users/notabee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/notabee/subscriptions", "organizations_url": "https://api.github.com/users/notabee/orgs", "repos_url": "https://api.github.com/users/notabee/repos", "events_url": "https://api.github.com/users/notabee/events{/privacy}", "received_events_url": "https://api.github.com/users/notabee/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-08-22T14:33:19Z", "updated_at": "2020-03-04T13:08:50Z", "closed_at": null, "author_association": "NONE", "body": "```\r\nimport tensorflow as tf\r\nbatch_size = 20\r\ninp = tf.placeholder(tf.float32, [batch_size, 19, 64, 64, 3])\r\nout = tf.placeholder(tf.float32, [batch_size, 19, 60, 60, 16])\r\ndef model(inp):\r\n\r\n  enc = tf.keras.layers.TimeDistributed(tf.keras.layers.Conv2D(128, activation='relu', kernel_size=3,kernel_initializer='glorot_uniform'))(inp)\r\n  enc = tf.keras.layers.TimeDistributed(tf.keras.layers.BatchNormalization())(enc)\r\n  enc = tf.keras.layers.TimeDistributed(tf.keras.layers.Conv2D(16, activation='relu',kernel_size=3,kernel_initializer='glorot_uniform'))(enc)\r\n  return enc\r\n\r\npred = model(inp)\r\n\r\nloss = tf.reduce_mean(tf.keras.backend.binary_crossentropy(out, pred))\r\nlr = 0.0001\r\ntrain_op = tf.train.AdamOptimizer(lr).minimize(loss)\r\n```\r\n\r\nThrows error::\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nTypeError                                 Traceback (most recent call last)\r\n<ipython-input-43-c9408a385d78> in <module>()\r\n      1 lr = 0.0001\r\n----> 2 train_op = tf.train.AdamOptimizer(lr).minimize(reconstuction_loss)\r\n\r\n7 frames\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/training/optimizer.py in minimize(self, loss, global_step, var_list, gate_gradients, aggregation_method, colocate_gradients_with_ops, name, grad_loss)\r\n    401         aggregation_method=aggregation_method,\r\n    402         colocate_gradients_with_ops=colocate_gradients_with_ops,\r\n--> 403         grad_loss=grad_loss)\r\n    404 \r\n    405     vars_with_grad = [v for g, v in grads_and_vars if g is not None]\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/training/optimizer.py in compute_gradients(self, loss, var_list, gate_gradients, aggregation_method, colocate_gradients_with_ops, grad_loss)\r\n    510         gate_gradients=(gate_gradients == Optimizer.GATE_OP),\r\n    511         aggregation_method=aggregation_method,\r\n--> 512         colocate_gradients_with_ops=colocate_gradients_with_ops)\r\n    513     if gate_gradients == Optimizer.GATE_GRAPH:\r\n    514       grads = control_flow_ops.tuple(grads)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/gradients_impl.py in gradients(ys, xs, grad_ys, name, colocate_gradients_with_ops, gate_gradients, aggregation_method, stop_gradients, unconnected_gradients)\r\n    156         ys, xs, grad_ys, name, colocate_gradients_with_ops,\r\n    157         gate_gradients, aggregation_method, stop_gradients,\r\n--> 158         unconnected_gradients)\r\n    159   # pylint: enable=protected-access\r\n    160 \r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/gradients_util.py in _GradientsHelper(ys, xs, grad_ys, name, colocate_gradients_with_ops, gate_gradients, aggregation_method, stop_gradients, unconnected_gradients, src_graph)\r\n    718               # issue here because of zeros.\r\n    719               if loop_state:\r\n--> 720                 out_grads[i] = loop_state.ZerosLike(op, i)\r\n    721               else:\r\n    722                 out_grads[i] = control_flow_ops.ZerosLikeOutsideLoop(op, i)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/control_flow_ops.py in ZerosLike(self, op, index)\r\n   1229       # If the shape is known statically, just create a zero tensor with\r\n   1230       # the right shape in the grad loop context.\r\n-> 1231       result = constant_op.constant(0, shape=shape.dims, dtype=val.dtype)\r\n   1232       if dead_branch:\r\n   1233         # op is a cond switch. Guard the zero tensor with a switch.\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/constant_op.py in constant(value, dtype, shape, name)\r\n    244   \"\"\"\r\n    245   return _constant_impl(value, dtype, shape, name, verify_shape=False,\r\n--> 246                         allow_broadcast=True)\r\n    247 \r\n    248 \r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/constant_op.py in _constant_impl(value, dtype, shape, name, verify_shape, allow_broadcast)\r\n    282       tensor_util.make_tensor_proto(\r\n    283           value, dtype=dtype, shape=shape, verify_shape=verify_shape,\r\n--> 284           allow_broadcast=allow_broadcast))\r\n    285   dtype_value = attr_value_pb2.AttrValue(type=tensor_value.tensor.dtype)\r\n    286   const_tensor = g.create_op(\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/tensor_util.py in make_tensor_proto(values, dtype, shape, verify_shape, allow_broadcast)\r\n    499                             dtype.base_dtype != numpy_dtype.base_dtype):\r\n    500     raise TypeError(\"Incompatible types: %s vs. %s. Value is %s\" %\r\n--> 501                     (dtype, nparray.dtype, values))\r\n    502 \r\n    503   # If shape is not given, get the shape from the numpy array.\r\n\r\nTypeError: Incompatible types: <dtype: 'resource'> vs. int64. Value is 0\r\n```\r\nUPDATE:: \r\nthis works but if you set the trainable boolean to True, it throws the same error\r\n```\r\n  enc = tf.keras.layers.TimeDistributed(tf.layers.BatchNormalization(trainable = False))(enc)\r\n```\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31885", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31885/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31885/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31885/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31885", "id": 483839483, "node_id": "MDU6SXNzdWU0ODM4Mzk0ODM=", "number": 31885, "title": "Enabling model training on Android ", "user": {"login": "kukzile", "id": 54351499, "node_id": "MDQ6VXNlcjU0MzUxNDk5", "avatar_url": "https://avatars2.githubusercontent.com/u/54351499?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kukzile", "html_url": "https://github.com/kukzile", "followers_url": "https://api.github.com/users/kukzile/followers", "following_url": "https://api.github.com/users/kukzile/following{/other_user}", "gists_url": "https://api.github.com/users/kukzile/gists{/gist_id}", "starred_url": "https://api.github.com/users/kukzile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kukzile/subscriptions", "organizations_url": "https://api.github.com/users/kukzile/orgs", "repos_url": "https://api.github.com/users/kukzile/repos", "events_url": "https://api.github.com/users/kukzile/events{/privacy}", "received_events_url": "https://api.github.com/users/kukzile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-08-22T08:17:24Z", "updated_at": "2019-08-23T20:56:27Z", "closed_at": null, "author_association": "NONE", "body": "The current support of tensorflow for Android does not include the binaries required for training. Is there a way by which we can include the required function's files ( for training basic image recognition model) in the libtensorflow-core.a?\r\nOr any other method by which we can enable training?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31883", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31883/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31883/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31883/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31883", "id": 483826677, "node_id": "MDU6SXNzdWU0ODM4MjY2Nzc=", "number": 31883, "title": "Can TF add a C++ kernel for PRelu? ", "user": {"login": "Zantares", "id": 38638514, "node_id": "MDQ6VXNlcjM4NjM4NTE0", "avatar_url": "https://avatars0.githubusercontent.com/u/38638514?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Zantares", "html_url": "https://github.com/Zantares", "followers_url": "https://api.github.com/users/Zantares/followers", "following_url": "https://api.github.com/users/Zantares/following{/other_user}", "gists_url": "https://api.github.com/users/Zantares/gists{/gist_id}", "starred_url": "https://api.github.com/users/Zantares/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Zantares/subscriptions", "organizations_url": "https://api.github.com/users/Zantares/orgs", "repos_url": "https://api.github.com/users/Zantares/repos", "events_url": "https://api.github.com/users/Zantares/events{/privacy}", "received_events_url": "https://api.github.com/users/Zantares/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1478826728, "node_id": "MDU6TGFiZWwxNDc4ODI2NzI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:core", "name": "comp:core", "color": "024391", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-08-22T07:48:36Z", "updated_at": "2019-09-26T22:52:43Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): no\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Red Hat 4.8.5-16\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: NA\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version (use command below): 1.4, master branch, commit id is c188ffcc9e8769e5c6f767b7fb1977e54cad4040\r\n- Python version: 2.7\r\n- Bazel version (if compiling from source): 0.24.1\r\n- GCC/Compiler version (if compiling from source): gcc 6.3\r\n- CUDA/cuDNN version: NA\r\n- GPU model and memory: NA\r\n\r\n**Describe the current behavior**\r\nSome models(MTCC) uses PRelu as an activation layer, and it will be split to small ops including Relu, Sub(https://github.com/tensorflow/tensorflow/blob/r1.14/tensorflow/python/keras/layers/advanced_activations.py#L141). It's hard to fuse and will impact the performance .\r\n\r\n**Describe the expected behavior**\r\nHope to have a TF C++ kernel for this op,  then it could call the kernel directly to get good cache locality on CPU or reduce memory access on GPU.\r\n\r\n**Code to reproduce the issue**\r\nNA\r\n\r\n\r\n\r\n**Other info / logs**\r\nNA\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31877", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31877/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31877/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31877/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31877", "id": 483745452, "node_id": "MDU6SXNzdWU0ODM3NDU0NTI=", "number": 31877, "title": "graph_transforms/transform_graph failed with shared backbone and multiple input node", "user": {"login": "hwenjun18", "id": 34371073, "node_id": "MDQ6VXNlcjM0MzcxMDcz", "avatar_url": "https://avatars2.githubusercontent.com/u/34371073?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hwenjun18", "html_url": "https://github.com/hwenjun18", "followers_url": "https://api.github.com/users/hwenjun18/followers", "following_url": "https://api.github.com/users/hwenjun18/following{/other_user}", "gists_url": "https://api.github.com/users/hwenjun18/gists{/gist_id}", "starred_url": "https://api.github.com/users/hwenjun18/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hwenjun18/subscriptions", "organizations_url": "https://api.github.com/users/hwenjun18/orgs", "repos_url": "https://api.github.com/users/hwenjun18/repos", "events_url": "https://api.github.com/users/hwenjun18/events{/privacy}", "received_events_url": "https://api.github.com/users/hwenjun18/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-08-22T03:08:39Z", "updated_at": "2019-09-03T20:03:34Z", "closed_at": null, "author_association": "NONE", "body": "**I try to optimize my model with tf transform_graph tool, and failed**\r\n\r\nbazel-bin/tensorflow/tools/graph_transforms/transform_graph \\\r\n--in_graph=inference.pb \\\r\n--out_graph=inference_opt.pb \\\r\n--inputs='input_image_1:0,input_image2:0,input_image_3:0\u2019 \\\r\n--outputs='output_node_1:0,output_node_2:0\u2019 \\\r\n--transforms='\r\n  remove_nodes(op=Identity, op=CheckNumerics)\r\n  fold_batch_norms\r\n  fold_old_batch_norms\r\n  sort_by_execution_order'\r\n\r\n**Then long log print occur and never stop, something like this:**\r\n\r\n2019-08-22 10:56:11.108570: W tensorflow/tools/graph_transforms/transform_utils.cc:441] Expected part_cnn/feature_extract/MobilenetV2/expanded_conv_16/expand/BatchNorm/beta/read/_135__cf__135 to be preserved.\r\n2019-08-22 10:56:11.108594: W tensorflow/tools/graph_transforms/transform_utils.cc:441] Expected part_cnn/feature_extract/MobilenetV2/expanded_conv_16/expand/BatchNorm/gamma/read/_136__cf__136 to be preserved.\r\n2019-08-22 10:56:11.108604: W tensorflow/tools/graph_transforms/transform_utils.cc:441] Expected part_cnn/feature_extract/MobilenetV2/expanded_conv_16/expand/BatchNorm/moving_mean/read/_137__cf__137 to be preserved.\r\n2019-08-22 10:56:11.108614: W tensorflow/tools/graph_transforms/transform_utils.cc:441] Expected part_cnn/feature_extract/MobilenetV2/expanded_conv_16/expand/BatchNorm/moving_variance/read/_138__cf__138 to be preserved.\r\n2019-08-22 10:56:11.108623: W tensorflow/tools/graph_transforms/transform_utils.cc:448] Generator function didn't preserve needed nodes, copying old replacements back in instead.\r\n2019-08-22 10:56:11.120159: W tensorflow/tools/graph_transforms/transform_utils.cc:441] Expected part_cnn/feature_extract/MobilenetV2/expanded_conv_16/project/BatchNorm/beta/read/_140__cf__140 to be preserved.\r\n2019-08-22 10:56:11.120181: W tensorflow/tools/graph_transforms/transform_utils.cc:441] Expected part_cnn/feature_extract/MobilenetV2/expanded_conv_16/project/BatchNorm/gamma/read/_141__cf__141 to be preserved.\r\n2019-08-22 10:56:11.120192: W tensorflow/tools/graph_transforms/transform_utils.cc:441] Expected part_cnn/feature_extract/MobilenetV2/expanded_conv_16/project/BatchNorm/moving_mean/read/_142__cf__142 to be preserved.\r\n2019-08-22 10:56:11.120201: W tensorflow/tools/graph_transforms/transform_utils.cc:441] Expected part_cnn/feature_extract/MobilenetV2/expanded_conv_16/project/BatchNorm/moving_variance/read/_143__cf__143 to be preserved.\r\n2019-08-22 10:56:11.120211: W tensorflow/tools/graph_transforms/transform_utils.cc:448] Generator function didn't preserve needed nodes, copying old replacements back in instead.\r\n2019-08-22 10:56:11.138263: W tensorflow/tools/graph_transforms/transform_utils.cc:441] Expected part_cnn/feature_extract/MobilenetV2/Conv_1/BatchNorm/beta/read/_10__cf__10 to be preserved.\r\n2019-08-22 10:56:11.138286: W tensorflow/tools/graph_transforms/transform_utils.cc:441] Expected part_cnn/feature_extract/MobilenetV2/Conv_1/BatchNorm/gamma/read/_11__cf__11 to be preserved.\r\n2019-08-22 10:56:11.138294: W tensorflow/tools/graph_transforms/transform_utils.cc:441] Expected part_cnn/feature_extract/MobilenetV2/Conv_1/BatchNorm/moving_mean/\r\n\r\n\r\n\r\n**And after I remove  transform option  **remove_nodes(op=Identity, op=CheckNumerics)**,\r\nIt seems succeed, but when I open optimized pb fie, bn node is still there, which not be fold.**\r\nI test other classification model,  transform_graph just woks well. But in my model, it just can not work. **By the way, my model has multiple input and shares backbone mobilenet_v2**.\r\n\r\nbazel-bin/tensorflow/tools/graph_transforms/transform_graph \\\r\n--in_graph=inference.pb \\\r\n--out_graph=inference_opt.pb \\\r\n--inputs='input_image_1:0,input_image2:0,input_image_3:0\u2019 \\\r\n--outputs='output_node_1:0,output_node_2:0\u2019 \\\r\n--transforms='\r\n  fold_batch_norms\r\n  fold_old_batch_norms\r\n  sort_by_execution_order'"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31872", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31872/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31872/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31872/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31872", "id": 483712716, "node_id": "MDU6SXNzdWU0ODM3MTI3MTY=", "number": 31872, "title": "Compiling from source, error with finding cuda ", "user": {"login": "manuprasad07", "id": 29106504, "node_id": "MDQ6VXNlcjI5MTA2NTA0", "avatar_url": "https://avatars0.githubusercontent.com/u/29106504?v=4", "gravatar_id": "", "url": "https://api.github.com/users/manuprasad07", "html_url": "https://github.com/manuprasad07", "followers_url": "https://api.github.com/users/manuprasad07/followers", "following_url": "https://api.github.com/users/manuprasad07/following{/other_user}", "gists_url": "https://api.github.com/users/manuprasad07/gists{/gist_id}", "starred_url": "https://api.github.com/users/manuprasad07/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/manuprasad07/subscriptions", "organizations_url": "https://api.github.com/users/manuprasad07/orgs", "repos_url": "https://api.github.com/users/manuprasad07/repos", "events_url": "https://api.github.com/users/manuprasad07/events{/privacy}", "received_events_url": "https://api.github.com/users/manuprasad07/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1205657510, "node_id": "MDU6TGFiZWwxMjA1NjU3NTEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:centos", "name": "subtype:centos", "color": "b619ea", "default": false, "description": "Centos Build/Installation issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "chsigg", "id": 7523982, "node_id": "MDQ6VXNlcjc1MjM5ODI=", "avatar_url": "https://avatars3.githubusercontent.com/u/7523982?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chsigg", "html_url": "https://github.com/chsigg", "followers_url": "https://api.github.com/users/chsigg/followers", "following_url": "https://api.github.com/users/chsigg/following{/other_user}", "gists_url": "https://api.github.com/users/chsigg/gists{/gist_id}", "starred_url": "https://api.github.com/users/chsigg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chsigg/subscriptions", "organizations_url": "https://api.github.com/users/chsigg/orgs", "repos_url": "https://api.github.com/users/chsigg/repos", "events_url": "https://api.github.com/users/chsigg/events{/privacy}", "received_events_url": "https://api.github.com/users/chsigg/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "chsigg", "id": 7523982, "node_id": "MDQ6VXNlcjc1MjM5ODI=", "avatar_url": "https://avatars3.githubusercontent.com/u/7523982?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chsigg", "html_url": "https://github.com/chsigg", "followers_url": "https://api.github.com/users/chsigg/followers", "following_url": "https://api.github.com/users/chsigg/following{/other_user}", "gists_url": "https://api.github.com/users/chsigg/gists{/gist_id}", "starred_url": "https://api.github.com/users/chsigg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chsigg/subscriptions", "organizations_url": "https://api.github.com/users/chsigg/orgs", "repos_url": "https://api.github.com/users/chsigg/repos", "events_url": "https://api.github.com/users/chsigg/events{/privacy}", "received_events_url": "https://api.github.com/users/chsigg/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-08-22T00:38:23Z", "updated_at": "2019-09-11T18:37:20Z", "closed_at": null, "author_association": "NONE", "body": "\r\n- OS Platform and Distribution: Centos 7\r\n- TensorFlow installed from: source\r\n- TensorFlow version: 1.15\r\n- Python version: 2.7.5\r\n- Installed using virtualenv: virtualenv\r\n- Bazel version: 0.26.0\r\n- GCC/Compiler version: 7.3.0\r\n- CUDA version: CUDA 10.1\r\n-cuDNN version: 7.6.2\r\n- TensorRT: 5.1.5\r\n- GPU: Tesla T4\r\n\r\nI'm trying to install tensorflow from source and tried v1.14 and v1.15. When running ./configure, I select yes for CUDA and TensorRT support. I initially get an error saying no cuda.h is found, so I point the path to /usr/include/linux. The installation fails with the following error:\r\n\r\n`Traceback (most recent call last):\r\n  File \"third_party/gpus/find_cuda_config.py\", line 500, in <module>\r\n    main()\r\n  File \"third_party/gpus/find_cuda_config.py\", line 492, in main\r\n    for key, value in sorted(find_cuda_config().items()):\r\n  File \"third_party/gpus/find_cuda_config.py\", line 457, in find_cuda_config\r\n    result.update(_find_cuda_config(cuda_paths, cuda_version))\r\n  File \"third_party/gpus/find_cuda_config.py\", line 251, in _find_cuda_config\r\n    get_header_version)\r\n  File \"third_party/gpus/find_cuda_config.py\", line 238, in _find_header\r\n    required_version, get_version)\r\n  File \"third_party/gpus/find_cuda_config.py\", line 227, in _find_versioned_file\r\n    actual_version = get_version(file)\r\n  File \"third_party/gpus/find_cuda_config.py\", line 244, in get_header_version\r\n    version = int(_get_header_version(path, \"CUDA_VERSION\"))\r\nValueError: invalid literal for int() with base 10: ''\r\nAsking for detailed CUDA configuration...\r\n`\r\n\r\nFull log:\r\n\r\nWARNING: Running Bazel server needs to be killed, because the startup options are different.\r\nWARNING: --batch mode is deprecated. Please instead explicitly shut down your Bazel server using the command \"bazel shutdown\".\r\nYou have bazel 0.26.0 installed.\r\nPlease specify the location of python. [Default is /home/mltlocal/envs/Resnet50GPU/bin/python]:\r\n\r\n\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\nAttributeError: 'module' object has no attribute 'getsitepackages'\r\nFound possible Python library paths:\r\n  /home/mltlocal/envs/Resnet50GPU/lib/python2.7/site-packages\r\nPlease input the desired Python library path to use.  Default is [/home/mltlocal/envs/Resnet50GPU/lib/python2.7/site-packages]\r\n\r\nDo you wish to build TensorFlow with XLA JIT support? [Y/n]: n\r\nNo XLA JIT support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with OpenCL SYCL support? [y/N]: n\r\nNo OpenCL SYCL support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with ROCm support? [y/N]: n\r\nNo ROCm support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with CUDA support? [y/N]: y\r\nCUDA support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with TensorRT support? [y/N]: y\r\nTensorRT support will be enabled for TensorFlow.\r\n\r\nCould not find any cuda.h matching version '' in any subdirectory:\r\n        ''\r\n        'include'\r\n        'include/cuda'\r\n        'include/*-linux-gnu'\r\n        'extras/CUPTI/include'\r\n        'include/cuda/CUPTI'\r\nof:\r\n        '/lib64'\r\n        '/opt/rh/devtoolset-4/root/usr/lib64/dyninst'\r\n        '/usr'\r\n        '/usr/lib64/atlas'\r\n        '/usr/lib64/dyninst'\r\n        '/usr/lib64/mysql'\r\n        '/usr/local/cuda-10.1/targets/x86_64-linux/lib'\r\nAsking for detailed CUDA configuration...\r\n\r\nPlease specify the CUDA SDK version you want to use. [Leave empty to default to CUDA 10]: 10.1\r\n\r\n\r\nPlease specify the cuDNN version you want to use. [Leave empty to default to cuDNN 7]: 7.6.2\r\n\r\n\r\nPlease specify the TensorRT version you want to use. [Leave empty to  default to TensorRT 5]:\r\n\r\n\r\nPlease specify the locally installed NCCL version you want to use. [Leave empty to use http://github.com/nvidia/nccl]:\r\n\r\n\r\nPlease specify the comma-separated list of base paths to look for CUDA libraries and headers. [Leave empty to use the default]: /usr/include/linux\r\n\r\n\r\nTraceback (most recent call last):\r\n  File \"third_party/gpus/find_cuda_config.py\", line 500, in <module>\r\n    main()\r\n  File \"third_party/gpus/find_cuda_config.py\", line 492, in main\r\n    for key, value in sorted(find_cuda_config().items()):\r\n  File \"third_party/gpus/find_cuda_config.py\", line 457, in find_cuda_config\r\n    result.update(_find_cuda_config(cuda_paths, cuda_version))\r\n  File \"third_party/gpus/find_cuda_config.py\", line 251, in _find_cuda_config\r\n    get_header_version)\r\n  File \"third_party/gpus/find_cuda_config.py\", line 238, in _find_header\r\n    required_version, get_version)\r\n  File \"third_party/gpus/find_cuda_config.py\", line 227, in _find_versioned_file\r\n    actual_version = get_version(file)\r\n  File \"third_party/gpus/find_cuda_config.py\", line 244, in get_header_version\r\n    version = int(_get_header_version(path, \"CUDA_VERSION\"))\r\nValueError: invalid literal for int() with base 10: ''\r\nAsking for detailed CUDA configuration...\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31870", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31870/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31870/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31870/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31870", "id": 483690367, "node_id": "MDU6SXNzdWU0ODM2OTAzNjc=", "number": 31870, "title": "TF_CPP_MIN_LOG_LEVEL does not work with TF2.0 dev20190820", "user": {"login": "KichangKim", "id": 2926674, "node_id": "MDQ6VXNlcjI5MjY2NzQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/2926674?v=4", "gravatar_id": "", "url": "https://api.github.com/users/KichangKim", "html_url": "https://github.com/KichangKim", "followers_url": "https://api.github.com/users/KichangKim/followers", "following_url": "https://api.github.com/users/KichangKim/following{/other_user}", "gists_url": "https://api.github.com/users/KichangKim/gists{/gist_id}", "starred_url": "https://api.github.com/users/KichangKim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/KichangKim/subscriptions", "organizations_url": "https://api.github.com/users/KichangKim/orgs", "repos_url": "https://api.github.com/users/KichangKim/repos", "events_url": "https://api.github.com/users/KichangKim/events{/privacy}", "received_events_url": "https://api.github.com/users/KichangKim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 28, "created_at": "2019-08-21T23:01:20Z", "updated_at": "2019-11-13T11:46:02Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10 x64 1903\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): pip\r\n- TensorFlow version (use command below): 2.0.0-dev20190820\r\n- Python version: 3.6.7\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: CUDA 10, cuDNN 7.6.2.24\r\n- GPU model and memory: Geforce RTX 2080 ti 11GB\r\n\r\n**Describe the current behavior**\r\nSetting TF_CPP_MIN_LOG_LEVEL does not work lateset TF 2.0. If I set TF_CPP_MIN_LOG_LEVEL to 2, sill TF shows information and warning logs (including libpng warnings)\r\n\r\nWith dev20190504, this issue does not occurred.\r\n\r\n**Describe the expected behavior**\r\nSet TF_CPP_MIN_LOG_LEVEL=2 should prevent showing information/warning logs including libpng warnings.\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport os\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\nos.environ[\"TF_CPP_MIN_LOG_LEVEL\"] = \"2\"\r\n\r\na = tf.Variable(np.array([0, 1, 2]))\r\n\r\nprint(a)\r\n```\r\nYou can see many [I] log using dev20190820. But with dev20190504, no logs."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31859", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31859/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31859/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31859/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31859", "id": 483631678, "node_id": "MDU6SXNzdWU0ODM2MzE2Nzg=", "number": 31859, "title": "Tensorflow lite: micro_vision missing model data", "user": {"login": "nealjack", "id": 5566471, "node_id": "MDQ6VXNlcjU1NjY0NzE=", "avatar_url": "https://avatars3.githubusercontent.com/u/5566471?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nealjack", "html_url": "https://github.com/nealjack", "followers_url": "https://api.github.com/users/nealjack/followers", "following_url": "https://api.github.com/users/nealjack/following{/other_user}", "gists_url": "https://api.github.com/users/nealjack/gists{/gist_id}", "starred_url": "https://api.github.com/users/nealjack/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nealjack/subscriptions", "organizations_url": "https://api.github.com/users/nealjack/orgs", "repos_url": "https://api.github.com/users/nealjack/repos", "events_url": "https://api.github.com/users/nealjack/events{/privacy}", "received_events_url": "https://api.github.com/users/nealjack/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-08-21T20:19:48Z", "updated_at": "2019-08-22T06:12:45Z", "closed_at": null, "author_association": "NONE", "body": "On the latest commit (eb7b5e6) on master branch, the mico_vision example is still missing `person_detect.tflite` as well as `person_detect_model_data.cc`. This problem is mentioned in issues #29792 and #29524. The only resolution mentioned in these closed issues are mentions that it \"should be fixed now\" without mention to a commit that fixes it or a pointer to the files existing in a branch.\r\n\r\nIf these files do exist in some history and branch, where can I find them?\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31852", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31852/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31852/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31852/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31852", "id": 483578497, "node_id": "MDU6SXNzdWU0ODM1Nzg0OTc=", "number": 31852, "title": "Tensorflow2.0 distributed training gives error :- A non-DistributedValues value 8 cannot be reduced with the given reduce op ReduceOp.SUM.", "user": {"login": "akanyaani", "id": 11317416, "node_id": "MDQ6VXNlcjExMzE3NDE2", "avatar_url": "https://avatars0.githubusercontent.com/u/11317416?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akanyaani", "html_url": "https://github.com/akanyaani", "followers_url": "https://api.github.com/users/akanyaani/followers", "following_url": "https://api.github.com/users/akanyaani/following{/other_user}", "gists_url": "https://api.github.com/users/akanyaani/gists{/gist_id}", "starred_url": "https://api.github.com/users/akanyaani/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akanyaani/subscriptions", "organizations_url": "https://api.github.com/users/akanyaani/orgs", "repos_url": "https://api.github.com/users/akanyaani/repos", "events_url": "https://api.github.com/users/akanyaani/events{/privacy}", "received_events_url": "https://api.github.com/users/akanyaani/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 17, "created_at": "2019-08-21T18:23:04Z", "updated_at": "2020-03-11T03:15:37Z", "closed_at": null, "author_association": "NONE", "body": "<em> **Getting the error when i am running distributed training**  as described in this tutorial (https://colab.research.google.com/github/tensorflow/docs/blob/r2.0rc/site/en/r2/guide/distribute_strategy.ipynb#scrollTo=IlYVC0goepdk)</em>\r\n\r\n**System information**\r\n- OS Platform: - Linux Ubuntu 16.04):\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version: 2.0-beta\r\n- Python version: 3.7\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: 10.01\r\n- GPU model and memory: p100, 16GB\r\n\r\n```\r\n@tf.function\r\ndef train_step(dist_inputs):\r\n    def step_fn(inputs):\r\n        features, labels = inputs\r\n\r\n        with tf.GradientTape() as tape:\r\n            logits = model(features)\r\n            #print(logits)\r\n            cross_entropy = tf.nn.softmax_cross_entropy_with_logits(\r\n                        logits=logits, labels=labels)\r\n            loss = tf.reduce_sum(cross_entropy) * (1.0 / global_batch_size)\r\n        grads = tape.gradient(loss, model.trainable_variables)\r\n        optimizer.apply_gradients(list(zip(grads, model.trainable_variables)))\r\n        return cross_entropy\r\n\r\n    per_example_losses = mirrored_strategy.experimental_run_v2(\r\n            step_fn, args=(dist_inputs,))\r\n    mean_loss = mirrored_strategy.reduce(\r\n            tf.compat.v2.distribute.ReduceOp.MEAN, per_example_losses, axis=0)\r\n    return mean_loss\r\n```\r\nI am getting this error while running abobe distributed code.\r\n`ValueError: A non-DistributedValues value 8 cannot be reduced with the given reduce op ReduceOp.SUM.\r\n\r\n**But it works when I use tf.distribute.ReduceOp.SUM instead of tf.distribute.ReduceOp.MEAN** \r\n`"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31842", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31842/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31842/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31842/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31842", "id": 483445272, "node_id": "MDU6SXNzdWU0ODM0NDUyNzI=", "number": 31842, "title": "Tensorflow2.0 Training OOM when tf.function retraces excessively", "user": {"login": "akanyaani", "id": 11317416, "node_id": "MDQ6VXNlcjExMzE3NDE2", "avatar_url": "https://avatars0.githubusercontent.com/u/11317416?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akanyaani", "html_url": "https://github.com/akanyaani", "followers_url": "https://api.github.com/users/akanyaani/followers", "following_url": "https://api.github.com/users/akanyaani/following{/other_user}", "gists_url": "https://api.github.com/users/akanyaani/gists{/gist_id}", "starred_url": "https://api.github.com/users/akanyaani/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akanyaani/subscriptions", "organizations_url": "https://api.github.com/users/akanyaani/orgs", "repos_url": "https://api.github.com/users/akanyaani/repos", "events_url": "https://api.github.com/users/akanyaani/events{/privacy}", "received_events_url": "https://api.github.com/users/akanyaani/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1501014628, "node_id": "MDU6TGFiZWwxNTAxMDE0NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0-rc0", "name": "TF 2.0-rc0", "color": "12ce7d", "default": false, "description": "Issues related to TF 2.0-rc0"}, {"id": 1478826728, "node_id": "MDU6TGFiZWwxNDc4ODI2NzI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:core", "name": "comp:core", "color": "024391", "default": false, "description": ""}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "kkimdev", "id": 503414, "node_id": "MDQ6VXNlcjUwMzQxNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/503414?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kkimdev", "html_url": "https://github.com/kkimdev", "followers_url": "https://api.github.com/users/kkimdev/followers", "following_url": "https://api.github.com/users/kkimdev/following{/other_user}", "gists_url": "https://api.github.com/users/kkimdev/gists{/gist_id}", "starred_url": "https://api.github.com/users/kkimdev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kkimdev/subscriptions", "organizations_url": "https://api.github.com/users/kkimdev/orgs", "repos_url": "https://api.github.com/users/kkimdev/repos", "events_url": "https://api.github.com/users/kkimdev/events{/privacy}", "received_events_url": "https://api.github.com/users/kkimdev/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "kkimdev", "id": 503414, "node_id": "MDQ6VXNlcjUwMzQxNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/503414?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kkimdev", "html_url": "https://github.com/kkimdev", "followers_url": "https://api.github.com/users/kkimdev/followers", "following_url": "https://api.github.com/users/kkimdev/following{/other_user}", "gists_url": "https://api.github.com/users/kkimdev/gists{/gist_id}", "starred_url": "https://api.github.com/users/kkimdev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kkimdev/subscriptions", "organizations_url": "https://api.github.com/users/kkimdev/orgs", "repos_url": "https://api.github.com/users/kkimdev/repos", "events_url": "https://api.github.com/users/kkimdev/events{/privacy}", "received_events_url": "https://api.github.com/users/kkimdev/received_events", "type": "User", "site_admin": false}, {"login": "Saduf2019", "id": 59822926, "node_id": "MDQ6VXNlcjU5ODIyOTI2", "avatar_url": "https://avatars2.githubusercontent.com/u/59822926?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Saduf2019", "html_url": "https://github.com/Saduf2019", "followers_url": "https://api.github.com/users/Saduf2019/followers", "following_url": "https://api.github.com/users/Saduf2019/following{/other_user}", "gists_url": "https://api.github.com/users/Saduf2019/gists{/gist_id}", "starred_url": "https://api.github.com/users/Saduf2019/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Saduf2019/subscriptions", "organizations_url": "https://api.github.com/users/Saduf2019/orgs", "repos_url": "https://api.github.com/users/Saduf2019/repos", "events_url": "https://api.github.com/users/Saduf2019/events{/privacy}", "received_events_url": "https://api.github.com/users/Saduf2019/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 19, "created_at": "2019-08-21T14:09:39Z", "updated_at": "2020-03-19T14:14:19Z", "closed_at": null, "author_association": "NONE", "body": "<em>When I am training my model using **tf.function** CPU memory is leaking and after some steps of training it is getting killed.</em>\r\n\r\n**System information**\r\n- OS Platform: - Linux Ubuntu 16.04):\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version: 2.0-beta\r\n- Python version: 3.7\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: 10.01\r\n- GPU model and memory: p100, 16GB\r\n\r\n```\r\n@tf.function\r\ndef train_step(self, x, step, grad_clip=True, clip_value=1.0):\r\n    with tf.name_scope(\"input_data\"):\r\n        inputs = x[:, :-1]\r\n        targets = x[:, 1:]\r\n\r\n     with tf.GradientTape() as tape:\r\n          predictions, _ = model(inputs, training=True)\r\n          loss = self.get_loss(targets, predictions)\r\n\r\n      with tf.name_scope(\"gradients\"):\r\n          gradients = tape.gradient(loss, self.trainable_variables)\r\n          if grad_clip:\r\n              gradients = [(tf.clip_by_value(grad, -clip_value, clip_value))\r\n                             for grad in gradients]\r\n          self.optimizer.apply_gradients(zip(gradients, self.trainable_variables))\r\n\r\n        accuracy = self.get_padded_accuracy(targets, predictions)\r\n        assert self.train_writer is not None\r\n        with tf.name_scope(\"summary_writer\"):\r\n            with self.train_writer.as_default():\r\n                tf.summary.scalar(\"loss\", loss, step=step)\r\n                tf.summary.scalar(\"accuracy\", accuracy, step=step)\r\n       return loss, accuracy\r\n\r\n**Stats of CPU memory\r\nAfter 100 steps - 5.08 GB\r\nAfter 500 steps -  14.8 GB\r\nAfter 1000 steps - 27 GB**\r\n```\r\n        \r\n\r\n\r\n**When is graph mode of training using tf.function CPU memory gets leaked and after some steps, it gets killed but when I train my model using eager mode it works fine, I am using above code for graph mode training as recommended by TensorFlow 2.0 community.**\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31838", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31838/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31838/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31838/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31838", "id": 483410758, "node_id": "MDU6SXNzdWU0ODM0MTA3NTg=", "number": 31838, "title": "Simple Audio Recognition sample couldn't be run in iOS swift - TFLite", "user": {"login": "KauthamMurugan", "id": 41481829, "node_id": "MDQ6VXNlcjQxNDgxODI5", "avatar_url": "https://avatars2.githubusercontent.com/u/41481829?v=4", "gravatar_id": "", "url": "https://api.github.com/users/KauthamMurugan", "html_url": "https://github.com/KauthamMurugan", "followers_url": "https://api.github.com/users/KauthamMurugan/followers", "following_url": "https://api.github.com/users/KauthamMurugan/following{/other_user}", "gists_url": "https://api.github.com/users/KauthamMurugan/gists{/gist_id}", "starred_url": "https://api.github.com/users/KauthamMurugan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/KauthamMurugan/subscriptions", "organizations_url": "https://api.github.com/users/KauthamMurugan/orgs", "repos_url": "https://api.github.com/users/KauthamMurugan/repos", "events_url": "https://api.github.com/users/KauthamMurugan/events{/privacy}", "received_events_url": "https://api.github.com/users/KauthamMurugan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-08-21T13:08:31Z", "updated_at": "2019-09-12T05:48:27Z", "closed_at": null, "author_association": "NONE", "body": "I have successfully run the simple audio recognition sample from the examples folder and successfully generated the tensorflow model output_graph.pb. Then i successfully converted the model to TFLite using the following code.\r\n```\r\nimport tensorflow as tf\r\n\r\nfrozen_graph = '/tmp/graph.pb'\r\n\r\ninput_arrays = [\"decoded_sample_data\"]\r\noutput_arrays = [\"labels_softmax\"]\r\nsupported_ops = [tf.lite.OpsSet.TFLITE_BUILTINS,\r\n                                       tf.lite.OpsSet.SELECT_TF_OPS]\r\n\r\nconvertor = tf.lite.TFLiteConverter\r\nconvertor = convertor.from_frozen_graph(graph_def_file=frozen_graph,input_arrays=input_arrays,output_arrays=output_arrays)\r\nconvertor.target_ops = supported_ops\r\n\r\ntflite_model = convertor.convert()\r\nopen(\"converted.tflite\", \"wb\").write(tflite_model)\r\n```\r\n\r\nI have a sample iOS app and i am using the Firebase ML kit's MLModelInterpreter to run the model. I successfully complied and ran the project but at run time during the run i am get the error that \"Unsupported ops\". If the Decode_wave, Audiospectrogram and MFCC ops are not supported then how can the conversion be successfully? How can i run the tflite model in the iOS swift project successfully.\r\n\r\nFor iOS implementation refer- https://firebase.google.com/docs/ml-kit/ios/use-custom-models\r\nOS - OSX - Mojave - 10.14.5\r\nTensorflow version - 1.14.0 stable \r\nEnvironment - Conda\r\nSwift version - 4.2 and 5\r\nXcode - 10.2\r\n\r\n[PB and Lite graphs.zip](https://github.com/tensorflow/tensorflow/files/3525438/PB.and.Lite.graphs.zip)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31832", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31832/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31832/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31832/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31832", "id": 483291162, "node_id": "MDU6SXNzdWU0ODMyOTExNjI=", "number": 31832, "title": "[TF 1.14] [TPU] Errors while training LSTM model on Colab TPU", "user": {"login": "rishabhsahrawat", "id": 15910460, "node_id": "MDQ6VXNlcjE1OTEwNDYw", "avatar_url": "https://avatars2.githubusercontent.com/u/15910460?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rishabhsahrawat", "html_url": "https://github.com/rishabhsahrawat", "followers_url": "https://api.github.com/users/rishabhsahrawat/followers", "following_url": "https://api.github.com/users/rishabhsahrawat/following{/other_user}", "gists_url": "https://api.github.com/users/rishabhsahrawat/gists{/gist_id}", "starred_url": "https://api.github.com/users/rishabhsahrawat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rishabhsahrawat/subscriptions", "organizations_url": "https://api.github.com/users/rishabhsahrawat/orgs", "repos_url": "https://api.github.com/users/rishabhsahrawat/repos", "events_url": "https://api.github.com/users/rishabhsahrawat/events{/privacy}", "received_events_url": "https://api.github.com/users/rishabhsahrawat/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1097541661, "node_id": "MDU6TGFiZWwxMDk3NTQxNjYx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tpus", "name": "comp:tpus", "color": "0052cc", "default": false, "description": "tpu, tpuestimator"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "saeta", "id": 1284535, "node_id": "MDQ6VXNlcjEyODQ1MzU=", "avatar_url": "https://avatars1.githubusercontent.com/u/1284535?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saeta", "html_url": "https://github.com/saeta", "followers_url": "https://api.github.com/users/saeta/followers", "following_url": "https://api.github.com/users/saeta/following{/other_user}", "gists_url": "https://api.github.com/users/saeta/gists{/gist_id}", "starred_url": "https://api.github.com/users/saeta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saeta/subscriptions", "organizations_url": "https://api.github.com/users/saeta/orgs", "repos_url": "https://api.github.com/users/saeta/repos", "events_url": "https://api.github.com/users/saeta/events{/privacy}", "received_events_url": "https://api.github.com/users/saeta/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "saeta", "id": 1284535, "node_id": "MDQ6VXNlcjEyODQ1MzU=", "avatar_url": "https://avatars1.githubusercontent.com/u/1284535?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saeta", "html_url": "https://github.com/saeta", "followers_url": "https://api.github.com/users/saeta/followers", "following_url": "https://api.github.com/users/saeta/following{/other_user}", "gists_url": "https://api.github.com/users/saeta/gists{/gist_id}", "starred_url": "https://api.github.com/users/saeta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saeta/subscriptions", "organizations_url": "https://api.github.com/users/saeta/orgs", "repos_url": "https://api.github.com/users/saeta/repos", "events_url": "https://api.github.com/users/saeta/events{/privacy}", "received_events_url": "https://api.github.com/users/saeta/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-08-21T09:01:02Z", "updated_at": "2019-08-22T23:36:04Z", "closed_at": null, "author_association": "NONE", "body": "I worked a bit with TF2.0 but new to TF1.x working. I want o use Google TPUs and for that I am making a LSTM model in TF1.14 without eager execution. I am reusing code from one of the Tensorflow [tutorials](https://www.tensorflow.org/beta/tutorials/load_data/text#split_the_dataset_into_text_and_train_batches). Below is the code I am executing in Colab while setting the runtime environment to **Python 2** and **TPU**.\r\nOn running it in colab, I am getting error `KeyError: u'flat_filenames'`\r\nand if I run it again (without restarting runtime) it throws following error `InvalidArgumentError: Graph is invalid, contains a cycle with 1 nodes, including: bidirectional/while/Merge, bidirectional/while/Merge_1, bidirectional/while/Merge_2`\r\nTHANK YOU!\r\n\r\n````\r\nimport tensorflow as tf\r\nimport tensorflow_datasets as tfds\r\nimport os\r\nimport pprint\r\nimport tensorflow as tf\r\nimport time\r\nimport numpy as np\r\nfrom tensorflow import keras\r\n\r\nTPU_WORKER = 'grpc://' + os.environ['COLAB_TPU_ADDR']\r\n\r\nDIRECTORY_URL = 'https://storage.googleapis.com/download.tensorflow.org/data/illiad/'\r\nFILE_NAMES = ['cowper.txt', 'derby.txt', 'butler.txt']\r\n\r\nfor name in FILE_NAMES:\r\n  text_dir = tf.keras.utils.get_file(name, origin=DIRECTORY_URL+name)\r\n  \r\nparent_dir = os.path.dirname(text_dir)\r\n\r\nprint (parent_dir)\r\ndef labeler(example, index):\r\n  return example, tf.cast(index, tf.int32)  \r\n\r\nlabeled_data_sets = []\r\n\r\nfor i, file_name in enumerate(FILE_NAMES):\r\n  lines_dataset = tf.data.TextLineDataset(os.path.join(parent_dir, file_name))\r\n  labeled_dataset = lines_dataset.map(lambda ex: labeler(ex, i))\r\n  labeled_data_sets.append(labeled_dataset)\r\n\r\nBUFFER_SIZE = 50000\r\nBATCH_SIZE = 64\r\nTAKE_SIZE = 5000\r\nall_labeled_data = labeled_data_sets[0]\r\nfor labeled_dataset in labeled_data_sets[1:]:\r\n  all_labeled_data = all_labeled_data.concatenate(labeled_dataset)\r\n  \r\nall_labeled_data = all_labeled_data.shuffle(\r\n    BUFFER_SIZE, reshuffle_each_iteration=False)\r\nprint type(all_labeled_data)\r\ntokenizer = tfds.features.text.Tokenizer()\r\n\r\nvocabulary_set = set()\r\nmy_iterator = all_labeled_data.make_initializable_iterator()\r\ntext_tensor, _ = my_iterator.get_next()\r\nwith tf.Session() as sess1: \r\n  sess1.run(my_iterator.initializer)\r\n  try:\r\n    while True:\r\n      text_string = sess1.run(text_tensor)\r\n      #print text_string\r\n      some_tokens = tokenizer.tokenize(text_string)\r\n      vocabulary_set.update(some_tokens)\r\n  except tf.errors.OutOfRangeError:\r\n    pass\r\nvocab_size = len(vocabulary_set)\r\nprint 'Length of Vocab',len(vocabulary_set)\r\nprint 'Done Tokenizing!'\r\n\r\nencoder = tfds.features.text.TokenTextEncoder(vocabulary_set)\r\nwith tf.Session() as sess2:\r\n  sess2.run(my_iterator.initializer)\r\n  try:\r\n    while True:\r\n      text_string = sess2.run(text_tensor)\r\n      encoded_example = encoder.encode(text_string)\r\n      #print encoded_example\r\n  except tf.errors.OutOfRangeError:\r\n    pass\r\n\r\ndef encoder_fn(text_tensor, label):\r\n  #print type(text_tensor)\r\n  #print text_tensor\r\n  encoded_text = encoder.encode(text_tensor)\r\n  padded_text = encoded_text[:4]# limiting the length to 4\r\n  padded_text = np.asarray(padded_text, dtype=np.int32)# chnaging type for tensor type compatibility with TF\r\n  return padded_text, label\r\n\r\ndef encode_map_fn(text, label):\r\n  return tf.py_func(encoder_fn, inp = [text, tf.reshape(label, [])], Tout = [tf.int32, tf.int32])\r\n\r\nall_encoded_data= all_labeled_data.map(encode_map_fn)\r\ntrain_data = all_encoded_data.padded_batch(BATCH_SIZE, padded_shapes=([-1],[]), drop_remainder= True)\r\nmy_iterator1 = train_data.make_initializable_iterator()\r\ntext_tensor, lab = my_iterator1.get_next()\r\nwith tf.Session() as sess2:\r\n  sess2.run(my_iterator1.initializer)\r\n  text_string = sess2.run(text_tensor)\r\n  lab = sess2.run(lab)\r\n  print text_string\r\n  print lab\r\nprint 'Printing an example data done!.'\r\n\r\nall_encoded_data = all_encoded_data.repeat()\r\ntrain_data = all_encoded_data.skip(TAKE_SIZE).shuffle(BUFFER_SIZE)\r\ntrain_data = train_data.padded_batch(BATCH_SIZE, padded_shapes=([-1],[]), drop_remainder= True)\r\n#train_data= train_data.batch(64)\r\ntrain_data = train_data.prefetch(BATCH_SIZE)\r\ntest_data = all_encoded_data.take(TAKE_SIZE)\r\ntest_data = test_data.padded_batch(BATCH_SIZE, padded_shapes=([-1],[]), drop_remainder = True)\r\ntest_data = test_data.prefetch(BATCH_SIZE)\r\n\r\n\r\n\r\nvocab_size += 1\r\n\r\ntf.keras.backend.clear_session()\r\nresolver = tf.contrib.cluster_resolver.TPUClusterResolver(TPU_WORKER)\r\ntf.contrib.distribute.initialize_tpu_system(resolver)\r\nstrategy = tf.contrib.distribute.TPUStrategy(resolver)\r\n\r\nwith strategy.scope():\r\n  model = tf.keras.Sequential()\r\n  model.add(tf.keras.layers.Embedding(vocab_size, 64))\r\n  model.add(tf.keras.layers.Bidirectional(tf.keras.layers.LSTM(64, activation= 'tanh', recurrent_activation= 'sigmoid', recurrent_dropout = 0, unroll = False, use_bias= True)))\r\n  # One or more dense layers.\r\n  # Edit the list in the `for` line to experiment with layer sizes.\r\n  for units in [64, 64]:\r\n    model.add(tf.keras.layers.Dense(units, activation='relu'))\r\n\r\n  # Output layer. The first argument is the number of labels.\r\n  model.add(tf.keras.layers.Dense(3, activation='softmax'))\r\n  model.compile(optimizer='adam',\r\n                loss='sparse_categorical_crossentropy',\r\n                metrics=['accuracy'])\r\n###Strategy  end###\r\nsteps = 50000/64\r\nprint model.summary()\r\nprint (steps)\r\n\r\nmodel.fit(train_data, steps_per_epoch = steps,epochs=10)\r\n````\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31830", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31830/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31830/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31830/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31830", "id": 483277434, "node_id": "MDU6SXNzdWU0ODMyNzc0MzQ=", "number": 31830, "title": "fit_generator: number of calls to the validation generator does not match validation_steps", "user": {"login": "dsmic", "id": 10296409, "node_id": "MDQ6VXNlcjEwMjk2NDA5", "avatar_url": "https://avatars0.githubusercontent.com/u/10296409?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dsmic", "html_url": "https://github.com/dsmic", "followers_url": "https://api.github.com/users/dsmic/followers", "following_url": "https://api.github.com/users/dsmic/following{/other_user}", "gists_url": "https://api.github.com/users/dsmic/gists{/gist_id}", "starred_url": "https://api.github.com/users/dsmic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dsmic/subscriptions", "organizations_url": "https://api.github.com/users/dsmic/orgs", "repos_url": "https://api.github.com/users/dsmic/repos", "events_url": "https://api.github.com/users/dsmic/events{/privacy}", "received_events_url": "https://api.github.com/users/dsmic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-08-21T08:34:57Z", "updated_at": "2019-08-26T19:02:28Z", "closed_at": null, "author_association": "NONE", "body": "Installed: pip install tf-nightly-2.0-preview \r\nin a clean environment. Same bug was in tf 1.14 and 2.0-beta1\r\n\r\nThe validation generator is called more often than validation_steps in tensorflow.keras.Model.fit_generator(). If one adds workers=0 as a call parameter everything is correct.\r\nI tracked down the issue to starting the threads (parameter max_queue_size changes the number of calls before the calls seem to be used for validation).\r\n\r\nReproduce the bug:\r\n```\r\nfrom tensorflow.keras.layers import Dense, Input\r\nfrom tensorflow.keras.models import Model\r\nimport numpy as np\r\n\r\ntrain_epoch_size = 10\r\ntest_epoch_size = 20\r\n\r\nclass KerasBatchGenerator(object):\r\n    def generate(self, phase='train'):\r\n        while True:\r\n            if phase == 'train':\r\n                for i in range(train_epoch_size):\r\n                    yield [np.array([0])],[np.array([0])]\r\n            else:\r\n                for i in range(test_epoch_size):\r\n                    print('   i',i)\r\n                    yield [np.array([0])],[np.array([0])]\r\n\r\nkeras_gen_train = KerasBatchGenerator()\r\n\r\ninputs = Input(shape=(1,))\r\nx = Dense(1)(inputs)\r\n\r\nmodel = Model(inputs=inputs, outputs=x)\r\n\r\nmodel.compile(loss='mean_squared_error', optimizer='SGD')\r\nprint(model.summary())\r\n\r\nmodel.fit_generator(keras_gen_train.generate(), train_epoch_size, 2,\r\n                           validation_data=keras_gen_train.generate('test'), validation_steps=test_epoch_size)#, workers = 0)\r\n```\r\n\r\nthe output is\r\n ```\r\n1/10 [==>...........................] - ETA: 1s - loss: 0.0000e+00   i 0\r\n   i 1\r\n   i 2\r\n   i 3\r\n   i 4\r\n   i 5\r\n   i 6\r\n   i 7\r\n   i 8\r\n   i 9\r\n   i 10\r\n   i 11\r\n   i 12\r\n   i 13\r\n   i 14\r\n   i 15\r\n   i 16\r\n   i 17\r\n   i 18\r\n   i 19\r\n   i 0\r\n   i 1\r\n   i 2\r\n   i 3\r\n   i 4\r\n   i 5\r\n   i 6\r\n   i 7\r\n   i 8\r\n   i 9\r\n   i 10\r\n10/10 [==============================] - 0s 19ms/step - loss: 0.0000e+00 - val_loss: 0.0000e+00\r\n```\r\n\r\nThere are 31 calls to the validation generator (validation_steps + max_queue_size + 1). This might usually be no problem, but it is, if you have to control which validation data match which training data. I use it for transfer learning.\r\n\r\nif you uncomment: ,workers=0) you get the expected result:\r\n ```\r\n1/10 [==>...........................] - ETA: 1s - loss: 0.0000e+00   i 0\r\n   i 1\r\n   i 2\r\n   i 3\r\n   i 4\r\n   i 5\r\n   i 6\r\n   i 7\r\n   i 8\r\n   i 9\r\n   i 10\r\n   i 11\r\n   i 12\r\n   i 13\r\n   i 14\r\n   i 15\r\n   i 16\r\n   i 17\r\n   i 18\r\n   i 19\r\n10/10 [==============================] - 0s 16ms/step - loss: 0.0000e+00 - val_loss: 0.0000e+00\r\n```\r\n\r\nI tracked down the issue to starting the threads in training_generator.py: enqueuer.start\r\n```\r\ndef _make_enqueued_generator(generator,\r\n                             workers=1,\r\n                             use_multiprocessing=False,\r\n                             max_queue_size=10,\r\n                             shuffle=False):\r\n  \"\"\"Create a buffered queue of next elements of the generator.\"\"\"\r\n  is_sequence = isinstance(generator, data_utils.Sequence)\r\n  enqueuer = None\r\n  if workers > 0:\r\n    if is_sequence:\r\n      enqueuer = data_utils.OrderedEnqueuer(\r\n          generator, use_multiprocessing=use_multiprocessing, shuffle=shuffle)\r\n    else:\r\n      enqueuer = data_utils.GeneratorEnqueuer(\r\n          generator, use_multiprocessing=use_multiprocessing)\r\n    enqueuer.start(workers=workers, max_queue_size=max_queue_size) #here the additional calls happen!\r\n    output_generator = enqueuer.get()\r\n  else:\r\n    if is_sequence:\r\n      output_generator = data_utils.iter_sequence_infinite(generator)\r\n    else:\r\n      output_generator = generator\r\n  return output_generator, enqueuer\r\n\r\n```\r\nbut I am too unfamiliar with python threading to supply a patch, sorry. \r\n\r\nAt the moment the workaround is workers=0! "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31829", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31829/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31829/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31829/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31829", "id": 483266160, "node_id": "MDU6SXNzdWU0ODMyNjYxNjA=", "number": 31829, "title": "Using libtensorflow-core.a to enable training on Android ", "user": {"login": "kukzile", "id": 54351499, "node_id": "MDQ6VXNlcjU0MzUxNDk5", "avatar_url": "https://avatars2.githubusercontent.com/u/54351499?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kukzile", "html_url": "https://github.com/kukzile", "followers_url": "https://api.github.com/users/kukzile/followers", "following_url": "https://api.github.com/users/kukzile/following{/other_user}", "gists_url": "https://api.github.com/users/kukzile/gists{/gist_id}", "starred_url": "https://api.github.com/users/kukzile/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kukzile/subscriptions", "organizations_url": "https://api.github.com/users/kukzile/orgs", "repos_url": "https://api.github.com/users/kukzile/repos", "events_url": "https://api.github.com/users/kukzile/events{/privacy}", "received_events_url": "https://api.github.com/users/kukzile/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-08-21T08:13:06Z", "updated_at": "2019-09-28T04:27:07Z", "closed_at": null, "author_association": "NONE", "body": "I followed : https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/makefile/README.md\r\n\r\nto build the tensorflow library for Android. Does the lib file contain all the functionalities to enable training on Android by using c++ to call the library. \r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31826", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31826/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31826/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31826/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31826", "id": 483220721, "node_id": "MDU6SXNzdWU0ODMyMjA3MjE=", "number": 31826, "title": " TensorFlow Lite GPU on Android slower than CPU", "user": {"login": "EarlHsy", "id": 29883378, "node_id": "MDQ6VXNlcjI5ODgzMzc4", "avatar_url": "https://avatars1.githubusercontent.com/u/29883378?v=4", "gravatar_id": "", "url": "https://api.github.com/users/EarlHsy", "html_url": "https://github.com/EarlHsy", "followers_url": "https://api.github.com/users/EarlHsy/followers", "following_url": "https://api.github.com/users/EarlHsy/following{/other_user}", "gists_url": "https://api.github.com/users/EarlHsy/gists{/gist_id}", "starred_url": "https://api.github.com/users/EarlHsy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/EarlHsy/subscriptions", "organizations_url": "https://api.github.com/users/EarlHsy/orgs", "repos_url": "https://api.github.com/users/EarlHsy/repos", "events_url": "https://api.github.com/users/EarlHsy/events{/privacy}", "received_events_url": "https://api.github.com/users/EarlHsy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-08-21T06:16:56Z", "updated_at": "2020-01-15T05:31:28Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\nAndroid 9.0, XiaoMi9, snapdragon855\r\n- TensorFlow installed from (source or binary):\r\nhttps://github.com/tensorflow/tensorflow/tree/master/tensorflow/lite/java/demo\r\n- TensorFlow version (or github SHA if from source):\r\ndependencies {\r\n    ...\r\n    implementation 'org.tensorflow:tensorflow-lite:0.0.0-nightly'\r\n    implementation 'org.tensorflow:tensorflow-lite-gpu:0.0.0-nightly'\r\n}\r\n\r\nI run a app from https://github.com/tensorflow/tensorflow/tree/master/tensorflow/lite/java/demo, and it worked well, the run time of  default model(mobilenet) on GPU is half of CPU, which is normal I think. And I replace the model with a special model which structure like YOLOv2-Tiny, trained by keras and convert to tflite(Implemented by traditional conv2D and pooling), I found the speed on GPU is slower than CPU float(CPU is less than 500ms but GPU is more than 600ms),  is it normal?\r\nis there anyone help me?\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31818", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31818/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31818/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31818/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/31818", "id": 483148373, "node_id": "MDExOlB1bGxSZXF1ZXN0MzA5Mjg0MDEw", "number": 31818, "title": "[WIP] Migrating F1 Score", "user": {"login": "SSaishruthi", "id": 22990801, "node_id": "MDQ6VXNlcjIyOTkwODAx", "avatar_url": "https://avatars0.githubusercontent.com/u/22990801?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SSaishruthi", "html_url": "https://github.com/SSaishruthi", "followers_url": "https://api.github.com/users/SSaishruthi/followers", "following_url": "https://api.github.com/users/SSaishruthi/following{/other_user}", "gists_url": "https://api.github.com/users/SSaishruthi/gists{/gist_id}", "starred_url": "https://api.github.com/users/SSaishruthi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SSaishruthi/subscriptions", "organizations_url": "https://api.github.com/users/SSaishruthi/orgs", "repos_url": "https://api.github.com/users/SSaishruthi/repos", "events_url": "https://api.github.com/users/SSaishruthi/events{/privacy}", "received_events_url": "https://api.github.com/users/SSaishruthi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1169365682, "node_id": "MDU6TGFiZWwxMTY5MzY1Njgy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:L", "name": "size:L", "color": "adafea", "default": false, "description": "CL Change Size: Large"}, {"id": 474725938, "node_id": "MDU6TGFiZWw0NzQ3MjU5Mzg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stalled", "name": "stalled", "color": "d4c5f9", "default": false, "description": null}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 20, "created_at": "2019-08-21T01:00:38Z", "updated_at": "2020-03-19T13:20:17Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/31818", "html_url": "https://github.com/tensorflow/tensorflow/pull/31818", "diff_url": "https://github.com/tensorflow/tensorflow/pull/31818.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/31818.patch"}, "body": "This PR is for migrating F1 score from addons to the core.\r\n\r\n@pavithrasv will be reviewing the PR\r\n@seanpmorgan @karmel  for your reference"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31806", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31806/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31806/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31806/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/31806", "id": 482970594, "node_id": "MDExOlB1bGxSZXF1ZXN0MzA5MTQwMjE2", "number": 31806, "title": "Added MNIST classifier example to Lite micro project", "user": {"login": "PeteBlackerThe3rd", "id": 2656747, "node_id": "MDQ6VXNlcjI2NTY3NDc=", "avatar_url": "https://avatars1.githubusercontent.com/u/2656747?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PeteBlackerThe3rd", "html_url": "https://github.com/PeteBlackerThe3rd", "followers_url": "https://api.github.com/users/PeteBlackerThe3rd/followers", "following_url": "https://api.github.com/users/PeteBlackerThe3rd/following{/other_user}", "gists_url": "https://api.github.com/users/PeteBlackerThe3rd/gists{/gist_id}", "starred_url": "https://api.github.com/users/PeteBlackerThe3rd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PeteBlackerThe3rd/subscriptions", "organizations_url": "https://api.github.com/users/PeteBlackerThe3rd/orgs", "repos_url": "https://api.github.com/users/PeteBlackerThe3rd/repos", "events_url": "https://api.github.com/users/PeteBlackerThe3rd/events{/privacy}", "received_events_url": "https://api.github.com/users/PeteBlackerThe3rd/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 1173072136, "node_id": "MDU6TGFiZWwxMTczMDcyMTM2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:XL", "name": "size:XL", "color": "adafea", "default": false, "description": "CL Change Size:Extra Large"}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-08-20T16:46:18Z", "updated_at": "2020-02-21T18:51:28Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/31806", "html_url": "https://github.com/tensorflow/tensorflow/pull/31806", "diff_url": "https://github.com/tensorflow/tensorflow/pull/31806.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/31806.patch"}, "body": "As we discussed in the Tensorflow lite micro SIG last week, I've tidied up my MNIST example project. I put this together originally to help me work out how to use TFL micro, so I tried to keep everything a simple as possible.\r\n\r\nUnlike the other example I've not been able to test this with any hardware apart from my disembodied LEON 3 emulator. I don't have access to any of the other hardware boards used, it would be great if we could add live camera input into this project at some point.\r\n\r\nThis demo includes a pull Tensorflow python project which generates and exports the model used. This includes a module called `flatbuffer_2_tfl_micro` which writes a flatbuffer directly to a pair of `.cc` and `.h` files avoiding the need to use the `xxd` utility and a bit of manual correction as described in [this tutorial](https://www.tensorflow.org/lite/microcontrollers/build_convert). If there isn't anything like this in the works then this would be good to move into the official process.\r\n\r\nFinally, I couldn't get the build to automatically run the tests from the Makefile. If anyone can let me know what I missed then I'll update this PR to include the fix."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31803", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31803/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31803/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31803/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/31803", "id": 482956463, "node_id": "MDExOlB1bGxSZXF1ZXN0MzA5MTI4Njg5", "number": 31803, "title": "Change all 'hashlib.md5' to 'hashlib.sha1'", "user": {"login": "g19fanatic", "id": 527571, "node_id": "MDQ6VXNlcjUyNzU3MQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/527571?v=4", "gravatar_id": "", "url": "https://api.github.com/users/g19fanatic", "html_url": "https://github.com/g19fanatic", "followers_url": "https://api.github.com/users/g19fanatic/followers", "following_url": "https://api.github.com/users/g19fanatic/following{/other_user}", "gists_url": "https://api.github.com/users/g19fanatic/gists{/gist_id}", "starred_url": "https://api.github.com/users/g19fanatic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/g19fanatic/subscriptions", "organizations_url": "https://api.github.com/users/g19fanatic/orgs", "repos_url": "https://api.github.com/users/g19fanatic/repos", "events_url": "https://api.github.com/users/g19fanatic/events{/privacy}", "received_events_url": "https://api.github.com/users/g19fanatic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 14, "created_at": "2019-08-20T16:15:35Z", "updated_at": "2019-11-26T10:52:01Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/31803", "html_url": "https://github.com/tensorflow/tensorflow/pull/31803", "diff_url": "https://github.com/tensorflow/tensorflow/pull/31803.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/31803.patch"}, "body": "Tied to issue #31800 "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31802", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31802/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31802/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31802/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31802", "id": 482949296, "node_id": "MDU6SXNzdWU0ODI5NDkyOTY=", "number": 31802, "title": "RuntimeError: Quantization not yet supported for op: FAKE_QUANT", "user": {"login": "DocDriven", "id": 30296124, "node_id": "MDQ6VXNlcjMwMjk2MTI0", "avatar_url": "https://avatars2.githubusercontent.com/u/30296124?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DocDriven", "html_url": "https://github.com/DocDriven", "followers_url": "https://api.github.com/users/DocDriven/followers", "following_url": "https://api.github.com/users/DocDriven/following{/other_user}", "gists_url": "https://api.github.com/users/DocDriven/gists{/gist_id}", "starred_url": "https://api.github.com/users/DocDriven/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DocDriven/subscriptions", "organizations_url": "https://api.github.com/users/DocDriven/orgs", "repos_url": "https://api.github.com/users/DocDriven/repos", "events_url": "https://api.github.com/users/DocDriven/events{/privacy}", "received_events_url": "https://api.github.com/users/DocDriven/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-08-20T16:01:01Z", "updated_at": "2019-11-16T12:25:28Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- TensorFlow installed from (source or binary): Docker image latest-gpu-py3\r\n- TensorFlow version (use command below): 1.14\r\n- Python version: 3.6\r\n- GPU model and memory: RTX 2080 Ti\r\n\r\n**Describe the current behavior**\r\n\r\nI have trained an autoencoder and want to convert it to a tflite model. I successfully froze the graph and was able to convert the non-quantized 32-bit-float version. When trying to convert the very same frozen graph file with the uint8 option, I get an error:\r\n\r\nRuntimeError: Quantization not yet supported for op: FAKE_QUANT\r\n\r\n**Describe the expected behavior**\r\n\r\nThe frozen model does not seem to be corrupted because I was able to deploy the other version successfully. FAKE_QUANT should inherently be supported.\r\n\r\n**Code to reproduce the issue**\r\n\r\nConversion was attempted with:\r\n\r\n```\r\nconverter = tf.lite.TFLiteConverter.from_frozen_graph(graph_def_file, inputs, outputs)\r\nconverter.representative_dataset = representative_dataset_gen\r\nconverter.target_ops = [tf.lite.OpsSet.TFLITE_BUILTINS_INT8]\r\nconverter.inference_input_type = tf.uint8\r\nconverter.inference_output_type = tf.uint8\r\nconverter.optimizations = [tf.lite.Optimize.DEFAULT]\r\n\r\ntflite_model = converter.convert()\r\n```\r\n\r\n**Other info / logs**\r\n\r\nThe error traceback:\r\n```\r\n\r\nINFO: Initialized TensorFlow Lite runtime.\r\nTraceback (most recent call last):\r\n  File \"train_and_save.py\", line 289, in <module>\r\n    vae.create_tflite_model()\r\n  File \"train_and_save.py\", line 249, in create_tflite_model\r\n    tflite_model = converter.convert()\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/lite/python/lite.py\", line 908, in convert\r\n    inference_output_type)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/lite/python/lite.py\", line 200, in _calibrate_quantize_model\r\n    inference_output_type, allow_float)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/lite/python/optimize/calibrator.py\", line 78, in calibrate_and_quantize\r\n    np.dtype(output_type.as_numpy_dtype()).num, allow_float)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/lite/python/optimize/tensorflow_lite_wrap_calibration_wrapper.py\", line 115, in QuantizeModel\r\n    return _tensorflow_lite_wrap_calibration_wrapper.CalibrationWrapper_QuantizeModel(self, input_py_type, output_py_type, allow_float)\r\nRuntimeError: Quantization not yet supported for op: FAKE_QUANT\r\n```\r\n\r\nIf it helped, I could provide the frozen graph file."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31800", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31800/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31800/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31800/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31800", "id": 482934073, "node_id": "MDU6SXNzdWU0ODI5MzQwNzM=", "number": 31800, "title": "FIPS enable computers fail due to md5 use", "user": {"login": "g19fanatic", "id": 527571, "node_id": "MDQ6VXNlcjUyNzU3MQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/527571?v=4", "gravatar_id": "", "url": "https://api.github.com/users/g19fanatic", "html_url": "https://github.com/g19fanatic", "followers_url": "https://api.github.com/users/g19fanatic/followers", "following_url": "https://api.github.com/users/g19fanatic/following{/other_user}", "gists_url": "https://api.github.com/users/g19fanatic/gists{/gist_id}", "starred_url": "https://api.github.com/users/g19fanatic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/g19fanatic/subscriptions", "organizations_url": "https://api.github.com/users/g19fanatic/orgs", "repos_url": "https://api.github.com/users/g19fanatic/repos", "events_url": "https://api.github.com/users/g19fanatic/events{/privacy}", "received_events_url": "https://api.github.com/users/g19fanatic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-08-20T15:32:30Z", "updated_at": "2020-01-28T22:31:34Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Red Hat Enterprise Linux Workstation release 7.7\r\n```\r\nPython 2.7.5 (default, Jun 11 2019, 14:33:56)\r\n[GCC 4.8.5 20150623 (Red Hat 4.8.5-39)] on linux2\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import tensorflow as tf\r\n>>> tf.version.GIT_VERSION\r\n'v1.14.0-rc1-22-gaf24dc91b5'\r\n```\r\n- Installed using virtualenv? pip? conda?: pipenv install tensorflow\r\n\r\n\r\ntflearn fails to import due to tensorflows use of md5 on an fips enabled machine\r\n```\r\nPython 2.7.5 (default, Jun 11 2019, 14:33:56)\r\n[GCC 4.8.5 20150623 (Red Hat 4.8.5-39)] on linux2\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> import tflearn\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \".../lib/python2.7/site-packages/tflearn/__init__.py\", line 4, in <module>\r\n    from . import config\r\n  File \".../lib/python2.7/site-packages/tflearn/config.py\", line 5, in <module>\r\n    from .variables import variable\r\n  File \".../lib/python2.7/site-packages/tflearn/variables.py\", line 7, in <module>\r\n    from tensorflow.contrib.framework.python.ops import add_arg_scope as contrib_add_arg_scope\r\n  File \".../lib/python2.7/site-packages/tensorflow/contrib/__init__.py\", line 31, in <module>\r\n    from tensorflow.contrib import cloud\r\n  File \".../lib/python2.7/site-packages/tensorflow/contrib/cloud/__init__.py\", line 28, in <module>\r\n    from tensorflow.contrib.bigtable.python.ops.bigtable_api import BigtableClient\r\n  File \".../lib/python2.7/site-packages/tensorflow/contrib/bigtable/__init__.py\", line 29, in <module>\r\n    from tensorflow.contrib.bigtable.python.ops.bigtable_api import BigtableClient\r\n  File \".../lib/python2.7/site-packages/tensorflow/contrib/bigtable/python/ops/bigtable_api.py\", line 44, in <module>\r\n    resource_loader.get_path_to_datafile(\"_bigtable.so\"))\r\n  File \".../lib/python2.7/site-packages/tensorflow/contrib/util/loader.py\", line 56, in load_op_library\r\n    ret = load_library.load_op_library(path)\r\n  File \".../lib/python2.7/site-packages/tensorflow/python/framework/load_library.py\", line 73, in load_op_library\r\n    module_name = hashlib.md5(wrappers).hexdigest()\r\nValueError: error:060800A3:digital envelope routines:EVP_DigestInit_ex:disabled for fips\r\n```\r\nreplacing all md5 calls with sha1 calls should work?\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31790", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31790/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31790/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31790/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31790", "id": 482773995, "node_id": "MDU6SXNzdWU0ODI3NzM5OTU=", "number": 31790, "title": "Can not use Tokenizer() to tokenize the input words in text classification in TF1.14 without eager execution for TPU..", "user": {"login": "rishabhsahrawat", "id": 15910460, "node_id": "MDQ6VXNlcjE1OTEwNDYw", "avatar_url": "https://avatars2.githubusercontent.com/u/15910460?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rishabhsahrawat", "html_url": "https://github.com/rishabhsahrawat", "followers_url": "https://api.github.com/users/rishabhsahrawat/followers", "following_url": "https://api.github.com/users/rishabhsahrawat/following{/other_user}", "gists_url": "https://api.github.com/users/rishabhsahrawat/gists{/gist_id}", "starred_url": "https://api.github.com/users/rishabhsahrawat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rishabhsahrawat/subscriptions", "organizations_url": "https://api.github.com/users/rishabhsahrawat/orgs", "repos_url": "https://api.github.com/users/rishabhsahrawat/repos", "events_url": "https://api.github.com/users/rishabhsahrawat/events{/privacy}", "received_events_url": "https://api.github.com/users/rishabhsahrawat/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 1097541661, "node_id": "MDU6TGFiZWwxMDk3NTQxNjYx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tpus", "name": "comp:tpus", "color": "0052cc", "default": false, "description": "tpu, tpuestimator"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jhseu", "id": 170179, "node_id": "MDQ6VXNlcjE3MDE3OQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/170179?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jhseu", "html_url": "https://github.com/jhseu", "followers_url": "https://api.github.com/users/jhseu/followers", "following_url": "https://api.github.com/users/jhseu/following{/other_user}", "gists_url": "https://api.github.com/users/jhseu/gists{/gist_id}", "starred_url": "https://api.github.com/users/jhseu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jhseu/subscriptions", "organizations_url": "https://api.github.com/users/jhseu/orgs", "repos_url": "https://api.github.com/users/jhseu/repos", "events_url": "https://api.github.com/users/jhseu/events{/privacy}", "received_events_url": "https://api.github.com/users/jhseu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jhseu", "id": 170179, "node_id": "MDQ6VXNlcjE3MDE3OQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/170179?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jhseu", "html_url": "https://github.com/jhseu", "followers_url": "https://api.github.com/users/jhseu/followers", "following_url": "https://api.github.com/users/jhseu/following{/other_user}", "gists_url": "https://api.github.com/users/jhseu/gists{/gist_id}", "starred_url": "https://api.github.com/users/jhseu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jhseu/subscriptions", "organizations_url": "https://api.github.com/users/jhseu/orgs", "repos_url": "https://api.github.com/users/jhseu/repos", "events_url": "https://api.github.com/users/jhseu/events{/privacy}", "received_events_url": "https://api.github.com/users/jhseu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-08-20T10:20:52Z", "updated_at": "2019-08-26T16:13:52Z", "closed_at": null, "author_association": "NONE", "body": "I am trying to write my code for using TPUs. However, I can not simply just tokenize the texts. I have tried many things to make it work but it just can not. There is NO documentation on Tensorflow on how to do it without enabling eager execution in TF1.14. \r\n````\r\ntokenizer = tfds.features.text.Tokenizer()\r\nvocabulary_set = set()\r\nfor text_tensor, _ in all_labeled_data:\r\n  some_tokens = tokenizer.tokenize(text_tensor)\r\n  vocabulary_set.update(some_tokens)\r\n````\r\nI am receiving following error\r\n`TypeError: Expected binary or unicode string, got <tf.Tensor 'IteratorGetNext_5:0' shape=() dtype=string>`\r\nI can not get the valiue of this iterator even by using `session.run`. THere is literally no help from Tensorflow on how to tokenize inputs for simple text classification without eager mode."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31786", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31786/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31786/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31786/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31786", "id": 482731567, "node_id": "MDU6SXNzdWU0ODI3MzE1Njc=", "number": 31786, "title": "cann't covert my model to tflite", "user": {"login": "banbishan", "id": 13417277, "node_id": "MDQ6VXNlcjEzNDE3Mjc3", "avatar_url": "https://avatars3.githubusercontent.com/u/13417277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/banbishan", "html_url": "https://github.com/banbishan", "followers_url": "https://api.github.com/users/banbishan/followers", "following_url": "https://api.github.com/users/banbishan/following{/other_user}", "gists_url": "https://api.github.com/users/banbishan/gists{/gist_id}", "starred_url": "https://api.github.com/users/banbishan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/banbishan/subscriptions", "organizations_url": "https://api.github.com/users/banbishan/orgs", "repos_url": "https://api.github.com/users/banbishan/repos", "events_url": "https://api.github.com/users/banbishan/events{/privacy}", "received_events_url": "https://api.github.com/users/banbishan/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-08-20T08:56:10Z", "updated_at": "2020-01-16T03:32:07Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Ubuntu 16.04\r\n- TensorFlow installed from anaconda:\r\n- TensorFlow version 1.14.0:\r\n\r\nwhen I covert my model to tflile, I get a error.  \r\n\r\nmy covert code :\r\n```\r\nimport os\r\nos.environ[\"TF_ENABLE_CONTROL_FLOW_V2\"] = \"1\"\r\nimport tensorflow as tf\r\n\r\n\r\ngraph_def_file = \"./pretrained/saved_model.pb\"\r\ninput_arrays = [\"images_pre\",\"image_widths_pre\"]\r\noutput_arrays = [\"output\"]\r\n\r\nconverter = tf.lite.TFLiteConverter.from_frozen_graph(graph_def_file, input_arrays, output_arrays)\r\ntflite_model = converter.convert()\r\nopen(\"converted_model.tflite\", \"wb\").write(tflite_model)\r\n```\r\n\r\nthe error log shows below:\r\n\r\n```\r\n0820 16:35:04.585085 139937177536256 deprecation.py:323] From /root/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow/lite/python/util.py:202: convert_variables_to_constants (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse `tf.compat.v1.graph_util.convert_variables_to_constants`\r\nW0820 16:35:04.589805 139937177536256 deprecation.py:323] From /root/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow/python/framework/graph_util_impl.py:270: extract_sub_graph (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse `tf.compat.v1.graph_util.extract_sub_graph`\r\nI0820 16:35:04.844114 139937177536256 graph_util_impl.py:311] Froze 185 variables.\r\nI0820 16:35:04.878954 139937177536256 graph_util_impl.py:364] Converted 185 variables to const ops.\r\nW0820 16:35:05.132165 139937177536256 deprecation.py:323] From /root/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow/lite/python/util.py:204: remove_training_nodes (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse `tf.compat.v1.graph_util.remove_training_nodes`\r\nTraceback (most recent call last):\r\n  File \"train.py\", line 35, in <module>\r\n    tf.app.run()\r\n  File \"/root/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/root/anaconda3/envs/tf/lib/python3.6/site-packages/absl/app.py\", line 300, in run\r\n    _run_main(main, args)\r\n  File \"/root/anaconda3/envs/tf/lib/python3.6/site-packages/absl/app.py\", line 251, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"train.py\", line 31, in main\r\n    models_path=crnn_config.models_path)\r\n  File \"/mnt/e/ocr/crnnt/crnn/modules.py\", line 295, in train\r\n    tflite_model = converter.convert()\r\n  File \"/root/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow/lite/python/lite.py\", line 898, in convert\r\n    **converter_kwargs)\r\n  File \"/root/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow/lite/python/convert.py\", line 404, in toco_convert_impl\r\n    input_data.SerializeToString())\r\n  File \"/root/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow/lite/python/convert.py\", line 172, in toco_convert_protos\r\n    \"TOCO failed. See console for info.\\n%s\\n%s\\n\" % (stdout, stderr))\r\ntensorflow.lite.python.convert.ConverterError: TOCO failed. See console for info.\r\n2019-08-20 16:35:08.179718: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 2\r\n2019-08-20 16:35:08.179786: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 2\r\n2019-08-20 16:35:08.179825: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: TensorListReserve\r\n2019-08-20 16:35:08.189538: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.189687: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: TensorListReserve\r\n2019-08-20 16:35:08.189707: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198165: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198192: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198208: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198222: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198239: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198254: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198271: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198285: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198301: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198315: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198331: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198345: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198361: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198374: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198390: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198403: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198417: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198430: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198446: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198460: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198476: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198490: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198504: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198517: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198531: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198546: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198561: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198576: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198592: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198604: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198618: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198632: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198647: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198662: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198676: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198691: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198705: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198718: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198732: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198745: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198760: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198773: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198789: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198802: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198817: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198830: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198846: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198861: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198877: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198891: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198908: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198921: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198936: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198950: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198965: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.198979: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.198994: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199006: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199020: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199034: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199052: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199065: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199080: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199094: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199108: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199122: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199138: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199150: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199169: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199183: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199198: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199210: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199224: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199239: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199254: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199268: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199282: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199295: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199309: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199323: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199338: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199351: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199365: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199379: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199395: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199410: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199425: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199439: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199455: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199469: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199485: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199499: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199515: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199530: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199547: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199561: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199577: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199591: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199606: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199620: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199636: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199650: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199666: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199681: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199697: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199712: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199728: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199742: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199758: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199773: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199788: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199802: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199818: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199833: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199849: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199863: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199879: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199894: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199911: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199925: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199942: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199956: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.199971: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.199985: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.200001: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.200016: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.200033: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.200047: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.200063: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.200076: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.200090: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.200102: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.200119: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.200133: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.200149: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: EmptyTensorList\r\n2019-08-20 16:35:08.200163: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 21\r\n2019-08-20 16:35:08.200178: I tensorflow/lite/toco/import_tensorflow.cc:193] Unsupported data type in placeholder op: 2\r\n2019-08-20 16:35:08.200192: I tensorflow/lite/toco/import_tensorflow.cc:1336] Converting unsupported operation: CTCGreedyDecoder\r\n2019-08-20 16:35:08.202251: F tensorflow/lite/toco/tooling_util.cc:1041] Check failed: array->has_shape()\r\nFatal Python error: Aborted\r\n\r\nCurrent thread 0x00007ff732710700 (most recent call first):\r\n  File \"/root/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow/lite/toco/python/toco_from_protos.py\", line 33 in execute\r\n  File \"/root/anaconda3/envs/tf/lib/python3.6/site-packages/absl/app.py\", line 251 in _run_main\r\n  File \"/root/anaconda3/envs/tf/lib/python3.6/site-packages/absl/app.py\", line 300 in run\r\n  File \"/root/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow/python/platform/app.py\", line 40 in run\r\n  File \"/root/anaconda3/envs/tf/lib/python3.6/site-packages/tensorflow/lite/toco/python/toco_from_protos.py\", line 59 in main\r\n  File \"/root/anaconda3/envs/tf/bin/toco_from_protos\", line 11 in <module>\r\nAborted (core dumped)\r\n```\r\nmy model pb file shows below:\r\nAlso, please include a link to a GraphDef or the model if possible.\r\n[model.zip](https://github.com/tensorflow/tensorflow/files/3519545/model.zip)\r\n\u2026]()\r\n\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31784", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31784/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31784/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31784/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31784", "id": 482667685, "node_id": "MDU6SXNzdWU0ODI2Njc2ODU=", "number": 31784, "title": "how to convert tflite model to float 16?", "user": {"login": "allenling", "id": 2723570, "node_id": "MDQ6VXNlcjI3MjM1NzA=", "avatar_url": "https://avatars1.githubusercontent.com/u/2723570?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allenling", "html_url": "https://github.com/allenling", "followers_url": "https://api.github.com/users/allenling/followers", "following_url": "https://api.github.com/users/allenling/following{/other_user}", "gists_url": "https://api.github.com/users/allenling/gists{/gist_id}", "starred_url": "https://api.github.com/users/allenling/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allenling/subscriptions", "organizations_url": "https://api.github.com/users/allenling/orgs", "repos_url": "https://api.github.com/users/allenling/repos", "events_url": "https://api.github.com/users/allenling/events{/privacy}", "received_events_url": "https://api.github.com/users/allenling/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "talumbau", "id": 1891418, "node_id": "MDQ6VXNlcjE4OTE0MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/1891418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/talumbau", "html_url": "https://github.com/talumbau", "followers_url": "https://api.github.com/users/talumbau/followers", "following_url": "https://api.github.com/users/talumbau/following{/other_user}", "gists_url": "https://api.github.com/users/talumbau/gists{/gist_id}", "starred_url": "https://api.github.com/users/talumbau/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/talumbau/subscriptions", "organizations_url": "https://api.github.com/users/talumbau/orgs", "repos_url": "https://api.github.com/users/talumbau/repos", "events_url": "https://api.github.com/users/talumbau/events{/privacy}", "received_events_url": "https://api.github.com/users/talumbau/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "talumbau", "id": 1891418, "node_id": "MDQ6VXNlcjE4OTE0MTg=", "avatar_url": "https://avatars1.githubusercontent.com/u/1891418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/talumbau", "html_url": "https://github.com/talumbau", "followers_url": "https://api.github.com/users/talumbau/followers", "following_url": "https://api.github.com/users/talumbau/following{/other_user}", "gists_url": "https://api.github.com/users/talumbau/gists{/gist_id}", "starred_url": "https://api.github.com/users/talumbau/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/talumbau/subscriptions", "organizations_url": "https://api.github.com/users/talumbau/orgs", "repos_url": "https://api.github.com/users/talumbau/repos", "events_url": "https://api.github.com/users/talumbau/events{/privacy}", "received_events_url": "https://api.github.com/users/talumbau/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 13, "created_at": "2019-08-20T06:25:47Z", "updated_at": "2019-12-24T12:36:31Z", "closed_at": null, "author_association": "NONE", "body": "i run tf v1.14\r\n\r\nwell, i can hardly find some easy, usable codes to convert my tflite model to fp16(int8 is easy)\r\n\r\ni read tf official post training quantization [docs](https://www.tensorflow.org/lite/performance/post_training_quantization), but i can not run this\r\n\r\n```\r\nimport tensorflow as tf\r\nconverter = tf.lite.TFLiteConverter.from_saved_model(saved_model_dir)\r\nconverter.optimizations = [tf.lite.Optimize.DEFAULT]\r\nconverter.target_spec.supported_types = [tf.lite.constants.FLOAT16]\r\ntflite_quant_model = converter.convert()\r\n```\r\nthere no FLOAT16 in tensorflow._api.v1.lite.constants, just \r\n```\r\nFLOAT = dtypes.float32\r\nINT32 = dtypes.int32\r\nINT64 = dtypes.int64\r\nSTRING = dtypes.string\r\nQUANTIZED_UINT8 = dtypes.uint8\r\nINT8 = dtypes.int8\r\n```\r\n\r\nand i found this [article,](https://medium.com/@fanzongshaoxing/post-training-quantization-of-tensorflow-model-to-fp16-8d66b9dfa77f) which might be help, but too complicated.\r\n\r\nif i miss something, remind me please.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31778", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31778/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31778/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31778/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/31778", "id": 482581635, "node_id": "MDExOlB1bGxSZXF1ZXN0MzA4ODI2ODY1", "number": 31778, "title": "Add tests of LMDBDataset", "user": {"login": "frreiss", "id": 12436991, "node_id": "MDQ6VXNlcjEyNDM2OTkx", "avatar_url": "https://avatars1.githubusercontent.com/u/12436991?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frreiss", "html_url": "https://github.com/frreiss", "followers_url": "https://api.github.com/users/frreiss/followers", "following_url": "https://api.github.com/users/frreiss/following{/other_user}", "gists_url": "https://api.github.com/users/frreiss/gists{/gist_id}", "starred_url": "https://api.github.com/users/frreiss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frreiss/subscriptions", "organizations_url": "https://api.github.com/users/frreiss/orgs", "repos_url": "https://api.github.com/users/frreiss/repos", "events_url": "https://api.github.com/users/frreiss/events{/privacy}", "received_events_url": "https://api.github.com/users/frreiss/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 987666414, "node_id": "MDU6TGFiZWw5ODc2NjY0MTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/ready%20to%20pull", "name": "ready to pull", "color": "2cd643", "default": false, "description": ""}, {"id": 1169365682, "node_id": "MDU6TGFiZWwxMTY5MzY1Njgy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:L", "name": "size:L", "color": "adafea", "default": false, "description": "CL Change Size: Large"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 19, "created_at": "2019-08-20T00:00:37Z", "updated_at": "2020-01-22T09:55:43Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/31778", "html_url": "https://github.com/tensorflow/tensorflow/pull/31778", "diff_url": "https://github.com/tensorflow/tensorflow/pull/31778.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/31778.patch"}, "body": "This pull requests adds regression tests for the `LMDBDatasetOp` class. I used the most recent version of the `DatasetOpsTestBaseV2` test harness class as of this morning, including the new macros like `ITERATOR_GET_NEXT_TEST_P`.\r\n\r\nI also refactored the contents of `lmdb_dataset_op.cc` into `.cc` and `.h` files so that the test cases could create instances of `LMDBDatasetOp`."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31750", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31750/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31750/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31750/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/31750", "id": 482088275, "node_id": "MDExOlB1bGxSZXF1ZXN0MzA4NDMwNzQy", "number": 31750, "title": "random crop edge case", "user": {"login": "autoih", "id": 41447049, "node_id": "MDQ6VXNlcjQxNDQ3MDQ5", "avatar_url": "https://avatars3.githubusercontent.com/u/41447049?v=4", "gravatar_id": "", "url": "https://api.github.com/users/autoih", "html_url": "https://github.com/autoih", "followers_url": "https://api.github.com/users/autoih/followers", "following_url": "https://api.github.com/users/autoih/following{/other_user}", "gists_url": "https://api.github.com/users/autoih/gists{/gist_id}", "starred_url": "https://api.github.com/users/autoih/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/autoih/subscriptions", "organizations_url": "https://api.github.com/users/autoih/orgs", "repos_url": "https://api.github.com/users/autoih/repos", "events_url": "https://api.github.com/users/autoih/events{/privacy}", "received_events_url": "https://api.github.com/users/autoih/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 1169365494, "node_id": "MDU6TGFiZWwxMTY5MzY1NDk0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:M", "name": "size:M", "color": "adafea", "default": false, "description": "CL Change Size: Medium"}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-08-19T03:33:25Z", "updated_at": "2020-03-19T02:02:08Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/31750", "html_url": "https://github.com/tensorflow/tensorflow/pull/31750", "diff_url": "https://github.com/tensorflow/tensorflow/pull/31750.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/31750.patch"}, "body": "This PR is about random crop edge case to guarantee output size dimensions."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31739", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31739/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31739/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31739/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31739", "id": 481998360, "node_id": "MDU6SXNzdWU0ODE5OTgzNjA=", "number": 31739, "title": "Guide is needed for transform of models suitable for tensorflow lite with gpu delegate", "user": {"login": "kingofthebongo2008", "id": 1145201, "node_id": "MDQ6VXNlcjExNDUyMDE=", "avatar_url": "https://avatars0.githubusercontent.com/u/1145201?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kingofthebongo2008", "html_url": "https://github.com/kingofthebongo2008", "followers_url": "https://api.github.com/users/kingofthebongo2008/followers", "following_url": "https://api.github.com/users/kingofthebongo2008/following{/other_user}", "gists_url": "https://api.github.com/users/kingofthebongo2008/gists{/gist_id}", "starred_url": "https://api.github.com/users/kingofthebongo2008/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kingofthebongo2008/subscriptions", "organizations_url": "https://api.github.com/users/kingofthebongo2008/orgs", "repos_url": "https://api.github.com/users/kingofthebongo2008/repos", "events_url": "https://api.github.com/users/kingofthebongo2008/events{/privacy}", "received_events_url": "https://api.github.com/users/kingofthebongo2008/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-08-18T14:11:15Z", "updated_at": "2019-08-20T06:34:01Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "Hello,\r\nWhere one can find how to transform models to be suitable for working with tensorflow lite for gpu?\r\nWhat should i do to transfer images from 3 components to 4 components.\r\nI am trying to work with mtcnn. I have converted it successfully to tflite, works fine on the cpu,\r\n\r\nERROR: Next operations are not supported by GPU delegate:\r\nNEG: Operation is not supported.\r\nFirst 2 operations will run on the GPU, and the remaining 40 on the CPU.\r\nWARN: compileToBinary(256):\r\nC:\\fakepath(86,169-182): warning X3556: integer divides may be much slower, try using uints if possible.\r\nC:\\fakepath(86,246-259): warning X3556: integer modulus may be much slower, try using uints if possible.\r\n\r\nERROR: TfLiteGpuDelegate Invoke: ConvertToPHWC4: Input data size does not match expected size: 12288000 != 6912\r\nERROR: Node number 27 (TfLiteGpuDelegate) failed to invoke."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31738", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31738/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31738/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31738/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31738", "id": 481986576, "node_id": "MDU6SXNzdWU0ODE5ODY1NzY=", "number": 31738, "title": "delete and append to Tfrecords: Tensorflow", "user": {"login": "samra-irshad", "id": 34835517, "node_id": "MDQ6VXNlcjM0ODM1NTE3", "avatar_url": "https://avatars1.githubusercontent.com/u/34835517?v=4", "gravatar_id": "", "url": "https://api.github.com/users/samra-irshad", "html_url": "https://github.com/samra-irshad", "followers_url": "https://api.github.com/users/samra-irshad/followers", "following_url": "https://api.github.com/users/samra-irshad/following{/other_user}", "gists_url": "https://api.github.com/users/samra-irshad/gists{/gist_id}", "starred_url": "https://api.github.com/users/samra-irshad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/samra-irshad/subscriptions", "organizations_url": "https://api.github.com/users/samra-irshad/orgs", "repos_url": "https://api.github.com/users/samra-irshad/repos", "events_url": "https://api.github.com/users/samra-irshad/events{/privacy}", "received_events_url": "https://api.github.com/users/samra-irshad/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-08-18T12:12:19Z", "updated_at": "2019-08-26T20:52:35Z", "closed_at": null, "author_association": "NONE", "body": "\r\nI am currently working on a research in which I have to append my training set after some epochs and delete some samples from test set after evaluation. Currently there is no way with which I can access the records (placed at specific indexes) in tfrecord file. Since tfrecords offer very fast training so I avoid using generators. Any chance of adding such feature?\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31729", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31729/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31729/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31729/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31729", "id": 481930009, "node_id": "MDU6SXNzdWU0ODE5MzAwMDk=", "number": 31729, "title": "Make ConcreteFunction Compatible with Pickle", "user": {"login": "devstein", "id": 7771049, "node_id": "MDQ6VXNlcjc3NzEwNDk=", "avatar_url": "https://avatars1.githubusercontent.com/u/7771049?v=4", "gravatar_id": "", "url": "https://api.github.com/users/devstein", "html_url": "https://github.com/devstein", "followers_url": "https://api.github.com/users/devstein/followers", "following_url": "https://api.github.com/users/devstein/following{/other_user}", "gists_url": "https://api.github.com/users/devstein/gists{/gist_id}", "starred_url": "https://api.github.com/users/devstein/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/devstein/subscriptions", "organizations_url": "https://api.github.com/users/devstein/orgs", "repos_url": "https://api.github.com/users/devstein/repos", "events_url": "https://api.github.com/users/devstein/events{/privacy}", "received_events_url": "https://api.github.com/users/devstein/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-08-17T22:00:34Z", "updated_at": "2019-08-19T22:13:10Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using): `2.0.0-beta1`\r\n- Are you willing to contribute it (Yes/No): No \r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nSee [issue 31421](https://github.com/tensorflow/tensorflow/issues/31421#issue-478107883) for more details. \r\n\r\nA `ConcreteFunction`, specifically, a `SavedModel`'s default serving `ConcreteFunction` that is used for `SavedModel` predictions. \r\n\r\n```python\r\nsaved_model = tf.saved_model.load(export_dir, tags=['serve'])\r\n\r\n# infer is not serializable (it cannot be pickled)\r\ninfer = saved_model.signatures[tf.saved_model.DEFAULT_SERVING_SIGNATURE_DEF_KEY]\r\n```\r\n\r\nThe serialization error is \r\n```sh\r\n_pickle.PickleError: can't pickle repeated message fields, convert to list first\r\n```\r\n\r\n**Will this change the current api? How?**\r\nNot to my knowledge \r\n\r\n**Who will benefit with this feature?**\r\nAnyone who wants to deploy a TF 2.0 `SavedModel` or use a `ConcreteFunction` in (Py)Spark or any other distributed system that relies on pickling user-defined functions \r\n\r\n**Any Other info.**\r\n\r\nhttps://github.com/tensorflow/tensorflow/issues/31421#issuecomment-522273057"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31722", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31722/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31722/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31722/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31722", "id": 481886713, "node_id": "MDU6SXNzdWU0ODE4ODY3MTM=", "number": 31722, "title": "Get prediction values from tensorflow lite android", "user": {"login": "abdou31", "id": 19480228, "node_id": "MDQ6VXNlcjE5NDgwMjI4", "avatar_url": "https://avatars3.githubusercontent.com/u/19480228?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abdou31", "html_url": "https://github.com/abdou31", "followers_url": "https://api.github.com/users/abdou31/followers", "following_url": "https://api.github.com/users/abdou31/following{/other_user}", "gists_url": "https://api.github.com/users/abdou31/gists{/gist_id}", "starred_url": "https://api.github.com/users/abdou31/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abdou31/subscriptions", "organizations_url": "https://api.github.com/users/abdou31/orgs", "repos_url": "https://api.github.com/users/abdou31/repos", "events_url": "https://api.github.com/users/abdou31/events{/privacy}", "received_events_url": "https://api.github.com/users/abdou31/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-08-17T13:34:19Z", "updated_at": "2019-08-20T21:46:34Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10 x64\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on a mobile device: Samsung A3 2016\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below):1.13.1\r\n- Python version:3.6.8\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:9.0/7.4\r\n- GPU model and memory: Nvidia Geforce 840m 3 Go\r\n\r\n\r\n\r\n**Describe the current behavior**\r\nI want to get values from output tensor with input an image to predict the eye region landmarks.\r\nI have predicted image from frozen graph model and Tensorflow lite using python script and it works fine.\r\nThe problem is with the Android platform, I got false and different values compared to values from python script\r\n\r\n**Describe the expected behavior**\r\n\r\n**Code to reproduce the issue**\r\nPython script\r\n\r\n```python\r\ndata = np.asarray( img, dtype=\"float32\" ) \r\n\r\n# Inference on input data normalized to [0, 1]\r\ninputImg = np.expand_dims(data,0).astype(np.float32)\r\ninput_details = interpreter.get_input_details()\r\ninterpreter.set_tensor(input_details[0]['index'], inputImg)\r\n\r\ninterpreter.invoke()\r\n\r\noutput_details = interpreter.get_output_details()\r\noutput_data = interpreter.get_tensor(output_details[0]['index'])\r\nprint(output_data)\r\n\r\n```\r\n\r\nJava code ( Android Environment )\r\n```java\r\nprivate float[][][][] bitmapToInputArray() {\r\n        // [START mlkit_bitmap_input]\r\n        Bitmap bitmap= getYourInputImage();\r\n        bitmap = Bitmap.createScaledBitmap(bitmap, 112, 112, true);\r\n\r\n        int batchNum = 0;\r\n        float[][][][] input = new float[1][112][112][3];\r\n        for (int x = 0; x < 112; x++) {\r\n            for (int y = 0; y < 112; y++) {\r\n                int pixel = bitmap.getPixel(x, y);\r\n                // Normalize channel values to [-1.0, 1.0]. This requirement varies by\r\n                // model. For example, some models might require values to be normalized\r\n                // to the range [0.0, 1.0] instead.\r\n                input[batchNum][x][y][0] = (Color.red(pixel) - 127) / 128.0f;\r\n                input[batchNum][x][y][1] = (Color.green(pixel) - 127) / 128.0f;\r\n                input[batchNum][x][y][2] = (Color.blue(pixel) - 127) / 128.0f;\r\n                Log.i(\"Input\",\"input\"+input[batchNum][x][y]);\r\n\r\n            }\r\n        }\r\n        // [END mlkit_bitmap_input]\r\n\r\n      return input;\r\n    }\r\n\r\n private void useInferenceResult(float[] probabilities) throws IOException {\r\n        String[] result=new String[80];\r\n        String x=\"\";\r\n        String y=\"\";\r\n        ArrayList<Point> listpoint= new ArrayList<Point>();\r\n\r\n        double viewWidth = canvas.getWidth();\r\n        double viewHeight = canvas.getHeight();\r\n        double imageWidth = mutableBitmap.getWidth();\r\n        double imageHeight = mutableBitmap.getHeight();\r\n        Log.i(\"viewWidth\",\"viewwidth \"+viewWidth);\r\n        Log.i(\"viewHeight\",\"viewheight \"+viewHeight);\r\n        Log.i(\"imagewidth\",\"imagewidth \"+imageWidth);\r\n        Log.i(\"imaageHeigh\",\"imageheigh \"+imageHeight);\r\n        double scale = Math.min(viewWidth / imageWidth, viewHeight / imageHeight);\r\n        Log.i(\"Scale\",\"Scale\"+scale);\r\n        try {\r\n            for (int i = 0; i < probabilities.length; i++) {\r\n\r\n                Log.i(\"MLKit\", String.format(\"%1.8f\", probabilities[i]));\r\n                float i1 = probabilities[i];\r\n                Log.i(\"floaaat\", \"\" + i1);\r\n            }\r\n        }\r\n```\r\n\r\n\r\n\r\n**Other info / logs**\r\n+ That what I should get : ( this is from python script using Tensorflow lite model ):\r\n\r\n>[[0.3323875  0.19654518 0.3430611  0.17367488 0.3671013  0.16478491\r\n  0.39022946 0.17491257 0.399131   0.19814822 0.3900888  0.22294888\r\n  0.36448467 0.23006389 0.34123936 0.21979642 0.30286688 0.20466375\r\n  0.31792122 0.19202346 0.33909258 0.18460245 0.3652809  0.18118384\r\n  0.39127237 0.18584773 0.40995973 0.19605562 0.42233318 0.21089557\r\n  0.40651116 0.2182863  0.38454503 0.22073016 0.3601514  0.22152397\r\n  0.3375371  0.21898884 0.31742495 0.2137229  0.628366   0.21445222\r\n  0.63888156 0.19114998 0.6626687  0.18333182 0.6856534  0.1955274\r\n  0.69444335 0.22068903 0.6838143  0.2438955  0.66011566 0.2518409\r\n  0.63507193 0.2414121  0.60496974 0.22573914 0.6209617  0.21241865\r\n  0.6422507  0.20397455 0.6683734  0.20254172 0.6917013  0.2092008\r\n  0.7084733  0.21974358 0.7189961  0.23459744 0.70730895 0.24100597\r\n  0.69019526 0.24282111 0.6691431  0.24188581 0.6451422  0.23857626\r\n  0.6218671  0.2344214 ]]\r\n\r\n+ Those values are from Android Studio ( java using Log.i) :\r\n\r\n\r\n>2019-08-17 14:47:50.617 21349-21349/com.example.irisdetection I/MLKit: 0,23961355\r\n2019-08-17 14:47:50.620 21349-21349/com.example.irisdetection I/MLKit: 0,25104424\r\n2019-08-17 14:47:50.621 21349-21349/com.example.irisdetection I/MLKit: 0,28179651\r\n2019-08-17 14:47:50.622 21349-21349/com.example.irisdetection I/MLKit: 0,31467810\r\n2019-08-17 14:47:50.623 21349-21349/com.example.irisdetection I/MLKit: 0,33257431\r\n2019-08-17 14:47:50.624 21349-21349/com.example.irisdetection I/MLKit: 0,32645294\r\n2019-08-17 14:47:50.625 21349-21349/com.example.irisdetection I/MLKit: 0,29138848\r\n2019-08-17 14:47:50.626 21349-21349/com.example.irisdetection I/MLKit: 0,25581932\r\n2019-08-17 14:47:50.627 21349-21349/com.example.irisdetection I/MLKit: 0,19593856\r\n2019-08-17 14:47:50.628 21349-21349/com.example.irisdetection I/MLKit: 0,21698779\r\n2019-08-17 14:47:50.631 21349-21349/com.example.irisdetection I/MLKit: 0,24266151\r\n2019-08-17 14:47:50.632 21349-21349/com.example.irisdetection I/MLKit: 0,27562365\r\n2019-08-17 14:47:50.633 21349-21349/com.example.irisdetection I/MLKit: 0,30823168\r\n2019-08-17 14:47:50.635 21349-21349/com.example.irisdetection I/MLKit: 0,33465266\r\n2019-08-17 14:47:50.636 21349-21349/com.example.irisdetection I/MLKit: 0,35355449\r\n2019-08-17 14:47:50.637 21349-21349/com.example.irisdetection I/MLKit: 0,34009647\r\n2019-08-17 14:47:50.638 21349-21349/com.example.irisdetection I/MLKit: 0,31358159\r\n2019-08-17 14:47:50.640 21349-21349/com.example.irisdetection I/MLKit: 0,28156102\r\n2019-08-17 14:47:50.642 21349-21349/com.example.irisdetection I/MLKit: 0,25063315\r\n2019-08-17 14:47:50.643 21349-21349/com.example.irisdetection I/MLKit: 0,21878451\r\n2019-08-17 14:47:50.644 21349-21349/com.example.irisdetection I/MLKit: 0,69623101\r\n2019-08-17 14:47:50.646 21349-21349/com.example.irisdetection I/MLKit: 0,70167470\r\n2019-08-17 14:47:50.646 21349-21349/com.example.irisdetection I/MLKit: 0,73317540\r\n2019-08-17 14:47:50.648 21349-21349/com.example.irisdetection I/MLKit: 0,76974392\r\n2019-08-17 14:47:50.649 21349-21349/com.example.irisdetection I/MLKit: 0,79195201\r\n2019-08-17 14:47:50.651 21349-21349/com.example.irisdetection I/MLKit: 0,78359401\r\n2019-08-17 14:47:50.652 21349-21349/com.example.irisdetection I/MLKit: 0,75674009\r\n2019-08-17 14:47:50.653 21349-21349/com.example.irisdetection I/MLKit: 0,71786618\r\n2019-08-17 14:47:50.654 21349-21349/com.example.irisdetection I/MLKit: 0,66782737\r\n2019-08-17 14:47:50.655 21349-21349/com.example.irisdetection I/MLKit: 0,68930006\r\n2019-08-17 14:47:50.656 21349-21349/com.example.irisdetection I/MLKit: 0,71668541\r\n2019-08-17 14:47:50.657 21349-21349/com.example.irisdetection I/MLKit: 0,75279719\r\n2019-08-17 14:47:50.658 21349-21349/com.example.irisdetection I/MLKit: 0,78872705\r\n2019-08-17 14:47:50.659 21349-21349/com.example.irisdetection I/MLKit: 0,81867975\r\n2019-08-17 14:47:50.661 21349-21349/com.example.irisdetection I/MLKit: 0,83806717\r\n2019-08-17 14:47:50.662 21349-21349/com.example.irisdetection I/MLKit: 0,82371044\r\n2019-08-17 14:47:50.664 21349-21349/com.example.irisdetection I/MLKit: 0,79749656\r\n2019-08-17 14:47:50.665 21349-21349/com.example.irisdetection I/MLKit: 0,76317006\r\n2019-08-17 14:47:50.666 21349-21349/com.example.irisdetection I/MLKit: 0,72700304\r\n2019-08-17 14:47:50.667 21349-21349/com.example.irisdetection I/MLKit: 0,69159627\r\n\r\nHow can I solve this problem??\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31721", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31721/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31721/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31721/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31721", "id": 481882509, "node_id": "MDU6SXNzdWU0ODE4ODI1MDk=", "number": 31721, "title": "[lite] failed on  define=with_select_tf_ops=true", "user": {"login": "laohur", "id": 5047256, "node_id": "MDQ6VXNlcjUwNDcyNTY=", "avatar_url": "https://avatars2.githubusercontent.com/u/5047256?v=4", "gravatar_id": "", "url": "https://api.github.com/users/laohur", "html_url": "https://github.com/laohur", "followers_url": "https://api.github.com/users/laohur/followers", "following_url": "https://api.github.com/users/laohur/following{/other_user}", "gists_url": "https://api.github.com/users/laohur/gists{/gist_id}", "starred_url": "https://api.github.com/users/laohur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/laohur/subscriptions", "organizations_url": "https://api.github.com/users/laohur/orgs", "repos_url": "https://api.github.com/users/laohur/repos", "events_url": "https://api.github.com/users/laohur/events{/privacy}", "received_events_url": "https://api.github.com/users/laohur/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-08-17T12:48:56Z", "updated_at": "2019-08-23T08:59:36Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code \r\n\u2019 \r\ncc_binary(\r\n    name = \"Prophet.so\",\r\n    srcs = [\"minimal.h\", \"Prophet.cc\",   ],\r\n    linkopts = tflite_linkopts() + select({\r\n        \"//tensorflow:android\": [\r\n            \"-pie\",  # Android 5.0 and later supports only PIE\r\n            \"-lm\",  # some builtin ops, e.g., tanh, need -lm\r\n        ],\r\n        \"//conditions:default\": [],\r\n    }),\r\n    deps = [\r\n        \"//tensorflow/lite:framework\",\r\n        \"//tensorflow/lite/delegates/flex:delegate\", [ on | off]\r\n        \"//tensorflow/lite/c:c_api_internal\",\r\n        \"//tensorflow/lite/kernels:builtin_ops\",\r\n        \"//tensorflow/lite:builtin_op_data\",\r\n        \"//tensorflow/lite/schema:schema_fbs\",\r\n    ],\r\n    linkshared = True,\r\n)\r\n- OS Platform and Distribution (vmware Linux Ubuntu 18.04 x4 on window10x64):\r\n- TensorFlow installed from (source  ):github 20190817\r\n- TensorFlow version (): 1.14.0\r\n- Python version:3.7.4\r\n- Bazel version (if compiling from source):0.26\r\n- GCC/Compiler version (if compiling from source): 7.4 binary\r\n- CUDA/cuDNN version: cpu\r\n- GPU model and memory: cpu\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\r\n**Describe the current behavior**\r\nTarget //tensorflow/lite/examples/l17:Prophet.so failed to build\r\n**Describe the expected behavior**\r\nbuild successed\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n bazel build --config monolithic --cxxopt=-std=c++11 -c opt  \\\r\n  --crosstool_top=//external:android/crosstool \\\r\n  --host_crosstool_top=@bazel_tools//tools/cpp:toolchain \\\r\n--define=with_select_tf_ops=true   --cpu=armeabi-v7a  --verbose_failures\\\r\n  //tensorflow/lite/examples/l17:Prophet.so\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\nbazel cmd log\r\n`\r\nERROR: /root/tensorflow-master/tensorflow/core/kernels/BUILD:6576:1: C++ compilation of rule '//tensorflow/core/kernels:android_tensorflow_kernels' failed (Exit 254): clang failed: error executing command\r\n  (cd /root/.cache/bazel/_bazel_root/510cb3499e6983b92a09020af9102ff3/execroot/org_tensorflow && \\\r\n  exec env - \\\r\n    ANDROID_BUILD_TOOLS_VERSION=29.0.2 \\\r\n    ANDROID_NDK_API_LEVEL=18 \\\r\n    ANDROID_NDK_HOME=/root/vender/android-ndk-r17c \\\r\n    ANDROID_SDK_API_LEVEL=18 \\\r\n    ANDROID_SDK_HOME=/root/vender/android-sdk \\\r\n    PATH='~/anaconda3/bin:/root/anaconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin' \\\r\n    PWD=/proc/self/cwd \\\r\n    PYTHON_BIN_PATH=/root/anaconda3/bin/python \\\r\n    PYTHON_LIB_PATH=/root/anaconda3/lib/python3.7/site-packages \\\r\n    TF_CONFIGURE_IOS=0 \\\r\n  external/androidndk/ndk/toolchains/llvm/prebuilt/linux-x86_64/bin/clang '-D__ANDROID_API__=18' -isystemexternal/androidndk/ndk/sysroot/usr/include/arm-linux-androideabi -target armv7-none-linux-androideabi '-march=armv7-a' '-mfloat-abi=softfp' '-mfpu=vfpv3-d16' -gcc-toolchain external/androidndk/ndk/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64 -fpic -ffunction-sections -funwind-tables -fstack-protector-strong -Wno-invalid-command-line-argument -Wno-unused-command-line-argument -no-canonical-prefixes -mthumb -Os -g -DNDEBUG -MD -MF bazel-out/armeabi-v7a-opt/bin/tensorflow/core/kernels/_objs/android_tensorflow_kernels/cwise_op_not_equal_to_2.pic.d '-frandom-seed=bazel-out/armeabi-v7a-opt/bin/tensorflow/core/kernels/_objs/android_tensorflow_kernels/cwise_op_not_equal_to_2.pic.o' -fPIC -D__CLANG_SUPPORT_DYN_ANNOTATION__ -DEIGEN_MPL2_ONLY '-DEIGEN_MAX_ALIGN_BYTES=64' '-DEIGEN_HAS_TYPE_TRAITS=0' -iquote . -iquote bazel-out/armeabi-v7a-opt/bin -iquote external/com_google_absl -iquote bazel-out/armeabi-v7a-opt/bin/external/com_google_absl -iquote external/nsync -iquote bazel-out/armeabi-v7a-opt/bin/external/nsync -iquote external/com_google_protobuf -iquote bazel-out/armeabi-v7a-opt/bin/external/com_google_protobuf -iquote external/zlib_archive -iquote bazel-out/armeabi-v7a-opt/bin/external/zlib_archive -iquote external/eigen_archive -iquote bazel-out/armeabi-v7a-opt/bin/external/eigen_archive -iquote external/local_config_sycl -iquote bazel-out/armeabi-v7a-opt/bin/external/local_config_sycl -iquote external/double_conversion -iquote bazel-out/armeabi-v7a-opt/bin/external/double_conversion -iquote external/farmhash_archive -iquote bazel-out/armeabi-v7a-opt/bin/external/farmhash_archive -iquote external/fft2d -iquote bazel-out/armeabi-v7a-opt/bin/external/fft2d -iquote external/gemmlowp -iquote bazel-out/armeabi-v7a-opt/bin/external/gemmlowp -isystem external/nsync/public -isystem bazel-out/armeabi-v7a-opt/bin/external/nsync/public -isystem external/com_google_protobuf/src -isystem bazel-out/armeabi-v7a-opt/bin/external/com_google_protobuf/src -isystem external/zlib_archive -isystem bazel-out/armeabi-v7a-opt/bin/external/zlib_archive -isystem external/eigen_archive -isystem bazel-out/armeabi-v7a-opt/bin/external/eigen_archive -isystem external/double_conversion -isystem bazel-out/armeabi-v7a-opt/bin/external/double_conversion -isystem external/farmhash_archive/src -isystem bazel-out/armeabi-v7a-opt/bin/external/farmhash_archive/src '-std=c++11' -DEIGEN_AVOID_STL_ARRAY -Iexternal/gemmlowp -Wno-sign-compare -fno-exceptions '-ftemplate-depth=900' '-mfpu=neon' -DTENSORFLOW_MONOLITHIC_BUILD -DTF_LEAN_BINARY -Wno-narrowing -fomit-frame-pointer -O2 '--sysroot=external/androidndk/ndk/platforms/android-18/arch-arm' -isystem external/androidndk/ndk/sources/cxx-stl/llvm-libc++/include -isystem external/androidndk/ndk/sources/cxx-stl/llvm-libc++abi/include -isystem external/androidndk/ndk/sources/android/support/include -isystemexternal/androidndk/ndk/sysroot/usr/include -c tensorflow/core/kernels/cwise_op_not_equal_to_2.cc -o bazel-out/armeabi-v7a-opt/bin/tensorflow/core/kernels/_objs/android_tensorflow_kernels/cwise_op_not_equal_to_2.pic.o)\r\nExecution platform: @bazel_tools//platforms:host_platform\r\nclang: error: unable to execute command: Killed\r\nclang: error: clang frontend command failed due to signal (use -v to see invocation)\r\nAndroid (4691093 based on r316199) clang version 6.0.2 (https://android.googlesource.com/toolchain/clang 183abd29fc496f55536e7d904e0abae47888fc7f) (https://android.googlesource.com/toolchain/llvm 34361f192e41ed6e4e8f9aca80a4ea7e9856f327) (based on LLVM 6.0.2svn)\r\nTarget: armv7-none-linux-android\r\nThread model: posix\r\nInstalledDir: external/androidndk/ndk/toolchains/llvm/prebuilt/linux-x86_64/bin\r\nclang: note: diagnostic msg: PLEASE submit a bug report to http://llvm.org/bugs/ and include the crash backtrace, preprocessed source, and associated run script.\r\nclang: note: diagnostic msg:\r\n********************\r\n\r\nPLEASE ATTACH THE FOLLOWING FILES TO THE BUG REPORT:\r\nPreprocessed source(s) and associated run script(s) are located at:\r\nclang: note: diagnostic msg: /tmp/cwise_op_not_equal_to_2-9cbb9b.cpp\r\nclang: note: diagnostic msg: /tmp/cwise_op_not_equal_to_2-9cbb9b.sh\r\nclang: note: diagnostic msg:\r\n\r\n********************\r\nTarget //tensorflow/lite/examples/l17:Prophet.so failed to build\r\n\r\n`\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31720", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31720/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31720/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31720/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31720", "id": 481870926, "node_id": "MDU6SXNzdWU0ODE4NzA5MjY=", "number": 31720, "title": "Only the first 30 ops will run on the GPU, and the remaining 1 on the CPU", "user": {"login": "LukeChow", "id": 8969860, "node_id": "MDQ6VXNlcjg5Njk4NjA=", "avatar_url": "https://avatars3.githubusercontent.com/u/8969860?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LukeChow", "html_url": "https://github.com/LukeChow", "followers_url": "https://api.github.com/users/LukeChow/followers", "following_url": "https://api.github.com/users/LukeChow/following{/other_user}", "gists_url": "https://api.github.com/users/LukeChow/gists{/gist_id}", "starred_url": "https://api.github.com/users/LukeChow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LukeChow/subscriptions", "organizations_url": "https://api.github.com/users/LukeChow/orgs", "repos_url": "https://api.github.com/users/LukeChow/repos", "events_url": "https://api.github.com/users/LukeChow/events{/privacy}", "received_events_url": "https://api.github.com/users/LukeChow/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-08-17T10:09:02Z", "updated_at": "2019-12-17T17:53:41Z", "closed_at": null, "author_association": "NONE", "body": "I am building my codes with tensorflow_lite_gpu.framework on iPhone 7. The codes is just like Google recommends:\r\n\r\n```\r\n_model = FlatBufferModel::BuildFromFile(modelPathCString);\r\n        ops::builtin::BuiltinOpResolver resolver;\r\n        InterpreterBuilder(*_model, resolver)(&_interpreter);\r\n        _delegate = NewGpuDelegate(nullptr);  // default config\r\n        _interpreter->ModifyGraphWithDelegate(_delegate);\r\n...//Other codes\r\n```\r\nWhen I use the model mobilenet_v1_1.0_224.tflite which Google provides, I get warning: `WARNING: 25 cannot be handled by this delegate.  Only the first 30 ops will run on the GPU, and the remaining 1 on the CPU` from console after excuting `_interpreter->ModifyGraphWithDelegate(_delegate)`. But the model deeplabv3_257_mv_gpu.tflite is good which Google provides too. As for my own model, the result is like mobilenet_v1_1.0_224.tflite does. Someone please help me.\r\n\r\nPS: Here is my podfile: \r\n```\r\nplatform :ios, '10.0'\r\ntarget \"SpeechExample\" do\r\npod 'TensorFlowLiteGpuExperimental'\r\nend\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31709", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31709/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31709/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31709/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31709", "id": 481796146, "node_id": "MDU6SXNzdWU0ODE3OTYxNDY=", "number": 31709, "title": "Tensorflow 2.0 is much slower than pytorch for large matrix assignment", "user": {"login": "yzhang93", "id": 13024729, "node_id": "MDQ6VXNlcjEzMDI0NzI5", "avatar_url": "https://avatars2.githubusercontent.com/u/13024729?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yzhang93", "html_url": "https://github.com/yzhang93", "followers_url": "https://api.github.com/users/yzhang93/followers", "following_url": "https://api.github.com/users/yzhang93/following{/other_user}", "gists_url": "https://api.github.com/users/yzhang93/gists{/gist_id}", "starred_url": "https://api.github.com/users/yzhang93/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yzhang93/subscriptions", "organizations_url": "https://api.github.com/users/yzhang93/orgs", "repos_url": "https://api.github.com/users/yzhang93/repos", "events_url": "https://api.github.com/users/yzhang93/events{/privacy}", "received_events_url": "https://api.github.com/users/yzhang93/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2019-08-16T21:40:03Z", "updated_at": "2020-02-25T21:11:08Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): tensorflow 2.0 beta\r\n- Python version: 3.6\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: CUDA 10.0/cuDNN 7\r\n- GPU model and memory: GeForce RTX 2080 Ti\r\n\r\n**Describe the current behavior**\r\nIn one of my research, I need to assign values to large sparse matrices. Since tensorflow does not support value assignment/update to large matrices , I have to use a lot of tf.stack()/tf.concat() functions. \r\n\r\nI compared the same function implemented in tensorflow 2.0 and pytorch 1.1.0, and the execution time for tensorflow was much slower than pytorch. The execution times are listed below:\r\npytorch: 0.0036 secs\r\ntf 2.0    : 0.1734 secs\r\n\r\n**Describe the expected behavior**\r\nIs there a way to optimize the tensorflow codes to have comparable performance?\r\n\r\n**Code to reproduce the issue**\r\n```\r\n## Tensorflow 2.0\r\nimport tensorflow as tf\r\nimport time\r\nimport numpy as np\r\n\r\ndef skew(x):\r\n    x = tf.reshape(x, [-1, 1])\r\n    z1 = tf.stack([tf.zeros(1), -x[2], x[1]], 1)\r\n    z2 = tf.stack([x[2], tf.zeros(1), -x[0]], 1)\r\n    z3 = tf.stack([-x[1], x[0], tf.zeros(1)], 1)\r\n    X = tf.concat([z1, z2, z3], 0)\r\n    return X\r\n\r\ndef propagate(Rot, v, p, g):\r\n    v_skew_rot = tf.matmul(skew(v), Rot)\r\n    p_skew_rot = tf.matmul(skew(p), Rot)\r\n\r\n    F0 = tf.zeros([3, 3])\r\n    F1 = tf.concat([F0, skew(g), F0], 0)\r\n    F2 = tf.concat([F0, F0, tf.eye(3)], 0)\r\n    F3 = tf.zeros([9, 3])\r\n    F4 = tf.concat([-Rot, -v_skew_rot, -p_skew_rot], 0)\r\n    F5 = tf.concat([F0, -Rot, F0], 0)\r\n    F6 = tf.zeros([9, 6])\r\n    F7 = tf.concat([F1, F2, F3, F4, F5, F6], 1)\r\n    F = tf.concat([F7, tf.zeros([12, 21])], 0)\r\n\r\n    G0 = tf.zeros([3, 12])\r\n    G1 = tf.concat([Rot, v_skew_rot, p_skew_rot, tf.zeros([12, 3])], 0)\r\n    G2 = tf.concat([F0, Rot, F0, tf.zeros([12, 3])], 0)\r\n    G3 = tf.concat([G0, G0, G0, tf.eye(12)], 0)\r\n    G = tf.concat([G1, G2, G3], 1)\r\n    return F, G\r\n\r\nif __name__ == '__main__':\r\n    Rot = tf.eye(3)\r\n    v = np.array([0.5, 0, 0], dtype=np.float32)\r\n    p = np.array([1.5, 0, 0], dtype=np.float32)\r\n    g = np.array([0, 0, -9.80655], dtype=np.float32)\r\n    start = time.time()\r\n    P = propagate(Rot, v, p, g)\r\n    print(\"Propagate function takes {} secs\".format(time.time() - start))\r\n```\r\n\r\n```\r\n## pytorch 1.1.0\r\nimport torch\r\nimport time\r\nimport numpy as np\r\n\r\n\r\ndef skew(x):\r\n    X = torch.Tensor([[0, -x[2], x[1]],\r\n                      [x[2], 0, -x[0]],\r\n                      [-x[1], x[0], 0]])\r\n    return X\r\n\r\ndef propagate(Rot_prev, v_prev, p_prev, g):\r\n    F = torch.zeros(21, 21)\r\n    G = torch.zeros(21, 18)\r\n    v_skew_rot = skew(v_prev).mm(Rot_prev)\r\n    p_skew_rot = skew(p_prev).mm(Rot_prev)\r\n\r\n    F[:3, 9:12] = -Rot_prev\r\n    F[3:6, :3] = skew(g)\r\n    F[6:9, 3:6] = torch.eye(3)\r\n    F[3:6, 12:15] = -Rot_prev\r\n    F[3:6, 9:12] = -v_skew_rot\r\n    F[6:9, 9:12] = -p_skew_rot\r\n\r\n    G[:3, :3] = Rot_prev\r\n    G[3:6, 3:6] = Rot_prev\r\n    G[3:6, :3] = v_skew_rot\r\n    G[6:9, :3] = p_skew_rot\r\n    G[9:12, 6:9] = torch.eye(3)\r\n    G[12:15, 9:12] = torch.eye(3)\r\n    G[15:18, 12:15] = torch.eye(3)\r\n    G[18:21, 15:18] = torch.eye(3)\r\n    return F, G\r\n\r\nif __name__ == '__main__':\r\n    Rot = torch.eye(3)\r\n    v = np.array([0.5, 0, 0], dtype=np.float32)\r\n    p = np.array([1.5, 0, 0], dtype=np.float32)\r\n    g = np.array([0, 0, -9.80655], dtype=np.float32)\r\n    start = time.time()\r\n    P = propagate(Rot, v, p, g)\r\n    print(\"Propagate function takes {} secs\".format(time.time() - start))\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31683", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31683/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31683/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31683/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31683", "id": 481558386, "node_id": "MDU6SXNzdWU0ODE1NTgzODY=", "number": 31683, "title": "TFRT Built From Source does not Improve Inference Speed", "user": {"login": "PetreanuAndi", "id": 19908335, "node_id": "MDQ6VXNlcjE5OTA4MzM1", "avatar_url": "https://avatars2.githubusercontent.com/u/19908335?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PetreanuAndi", "html_url": "https://github.com/PetreanuAndi", "followers_url": "https://api.github.com/users/PetreanuAndi/followers", "following_url": "https://api.github.com/users/PetreanuAndi/following{/other_user}", "gists_url": "https://api.github.com/users/PetreanuAndi/gists{/gist_id}", "starred_url": "https://api.github.com/users/PetreanuAndi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PetreanuAndi/subscriptions", "organizations_url": "https://api.github.com/users/PetreanuAndi/orgs", "repos_url": "https://api.github.com/users/PetreanuAndi/repos", "events_url": "https://api.github.com/users/PetreanuAndi/events{/privacy}", "received_events_url": "https://api.github.com/users/PetreanuAndi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 1754777628, "node_id": "MDU6TGFiZWwxNzU0Nzc3NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu:tensorrt", "name": "comp:gpu:tensorrt", "color": "ea98ba", "default": false, "description": "Issues specific to TensorRT"}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-08-16T11:02:18Z", "updated_at": "2019-12-26T18:34:18Z", "closed_at": null, "author_association": "NONE", "body": "[convertTFRT_frozenGraph.zip](https://github.com/tensorflow/tensorflow/files/3509287/convertTFRT_frozenGraph.zip)\r\n\r\n<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: - \r\n- TensorFlow installed from (source or binary): built from source \r\n- TensorFlow version: **1.14**\r\n- Python version: **2.7**\r\n- Installed using virtualenv? pip? conda?: conda\r\n- Bazel version (if compiling from source): 0.25.2\r\n- GCC/Compiler version (if compiling from source): 5.4.0\r\n- CUDA/cuDNN version: **10.0.0 / 7.4.2**\r\n- GPU model and memory: 1080Ti\r\n\r\n\r\n\r\n**Describe the problem**\r\nI have built TensorFlow from Sources, and checked the \"yes\" option when asked about compiling with TensorRT. Graph builds, trt_only nodes exist, inference speed on SSD + FPN model is not optimised (actually slightly worse than the original, pre-optimization frozen_graph.pb\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\nBuild from source tensorFlow 1.14\r\nCreate optimised graph from original frozen_graph.pb\r\nInfer over optimised graph ====> **no speedup whatsoever**\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\nUploaded conversion script.\r\nNotice I try to get outputs from all FPN levels (not just final feature map), in order to use those in another LSTM-type network classifier.\r\n\r\n----------------------------------------------------------------------\r\nPrints from optimization script : \r\n2019-08-16 12:25:39.310289: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:716] Optimization results for grappler item: tf_graph\r\n2019-08-16 12:25:39.310333: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:718]   constant folding: Graph size after: 2836 nodes (-1660), 4183 edges (-1854), time = 728.073ms.\r\n2019-08-16 12:25:39.310337: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:718]   layout: Graph size after: 2880 nodes (44), 4255 edges (72), time = 143.931ms.\r\n2019-08-16 12:25:39.310341: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:718]   constant folding: Graph size after: 2880 nodes (0), 4255 edges (0), time = 167.55ms.\r\n2019-08-16 12:25:39.310345: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:718]   TensorRTOptimizer: Graph size after: 1907 nodes (-973), 3218 edges (-1037), time = 7242.89307ms.\r\ngraph_size(MB)(native_tf): 123.3\r\ngraph_size(MB)(trt): 336.9\r\nnum_nodes(native_tf): 4496\r\nnum_nodes(tftrt_total): 1907\r\n**num_nodes(trt_only): 94**\r\ntime(s) (trt_conversion): 10.6979\r\n**number of TRT ops in the converted graph :  94**\r\n\r\n\r\n-----------------------------------------------------------------------------------------------------------------\r\nJust tried using tf-nightly-gpu 1.15.0.dev20190816 , with Cuda 10.1 and cudnn 7.6, and the inference time is even worse! (with mode trt_only nodes as shows the print : )\r\n\r\ngraph_size(MB)(native_tf): 123.3\r\ngraph_size(MB)(trt): 159.7\r\nnum_nodes(native_tf): 4496\r\nnum_nodes(tftrt_total): 1894\r\nnum_nodes(trt_only): 102\r\ntime(s) (trt_conversion): 8.1412\r\nnumber of TRT ops in the converted graph :  102\r\n\r\n-----------------------------------------------------------------------------------------------------------------\r\n\r\nAverage [1:100] random images Inference Speeds : \r\noriginal .pb inference speed : **0.028s**\r\ntf1.14+trt5 compiled from source inference speed : **0.029**\r\ntf1.15+trt installed with pip : **0.032**\r\n\r\n**None** of these had errors when building or optimizing the graph :)\r\n\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31681", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31681/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31681/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/31681/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/31681", "id": 481537944, "node_id": "MDU6SXNzdWU0ODE1Mzc5NDQ=", "number": 31681, "title": "Debugging tf.Keras Models with TFDBG get TypeError: Fetch argument None has invalid type <class 'NoneType'>", "user": {"login": "zhen8838", "id": 26156999, "node_id": "MDQ6VXNlcjI2MTU2OTk5", "avatar_url": "https://avatars0.githubusercontent.com/u/26156999?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zhen8838", "html_url": "https://github.com/zhen8838", "followers_url": "https://api.github.com/users/zhen8838/followers", "following_url": "https://api.github.com/users/zhen8838/following{/other_user}", "gists_url": "https://api.github.com/users/zhen8838/gists{/gist_id}", "starred_url": "https://api.github.com/users/zhen8838/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zhen8838/subscriptions", "organizations_url": "https://api.github.com/users/zhen8838/orgs", "repos_url": "https://api.github.com/users/zhen8838/repos", "events_url": "https://api.github.com/users/zhen8838/events{/privacy}", "received_events_url": "https://api.github.com/users/zhen8838/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097548274, "node_id": "MDU6TGFiZWwxMDk3NTQ4Mjc0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tfdbg", "name": "comp:tfdbg", "color": "0052cc", "default": false, "description": "tf debugger"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "caisq", "id": 16824702, "node_id": "MDQ6VXNlcjE2ODI0NzAy", "avatar_url": "https://avatars2.githubusercontent.com/u/16824702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/caisq", "html_url": "https://github.com/caisq", "followers_url": "https://api.github.com/users/caisq/followers", "following_url": "https://api.github.com/users/caisq/following{/other_user}", "gists_url": "https://api.github.com/users/caisq/gists{/gist_id}", "starred_url": "https://api.github.com/users/caisq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/caisq/subscriptions", "organizations_url": "https://api.github.com/users/caisq/orgs", "repos_url": "https://api.github.com/users/caisq/repos", "events_url": "https://api.github.com/users/caisq/events{/privacy}", "received_events_url": "https://api.github.com/users/caisq/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "caisq", "id": 16824702, "node_id": "MDQ6VXNlcjE2ODI0NzAy", "avatar_url": "https://avatars2.githubusercontent.com/u/16824702?v=4", "gravatar_id": "", "url": "https://api.github.com/users/caisq", "html_url": "https://github.com/caisq", "followers_url": "https://api.github.com/users/caisq/followers", "following_url": "https://api.github.com/users/caisq/following{/other_user}", "gists_url": "https://api.github.com/users/caisq/gists{/gist_id}", "starred_url": "https://api.github.com/users/caisq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/caisq/subscriptions", "organizations_url": "https://api.github.com/users/caisq/orgs", "repos_url": "https://api.github.com/users/caisq/repos", "events_url": "https://api.github.com/users/caisq/events{/privacy}", "received_events_url": "https://api.github.com/users/caisq/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-08-16T10:04:22Z", "updated_at": "2019-10-05T03:03:52Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution ( Linux Ubuntu 18.04):\r\n- TensorFlow installed from (source or binary):  binary\r\n- TensorFlow version (use command below): tensorflow-gpu  1.14.0     \r\n- Python version: python 3.7.1\r\n- CUDA/cuDNN version: CUDA 10.1  cuDNN 7.5\r\n- GPU model and memory: GTX 2060 \r\n\r\n**Describe the current behavior**\r\n\r\nI want to use debugging tf.keras model, but got an error message like:\r\n```sh\r\nTraceback (most recent call last):\r\n  File \"./debug_keras.py\", line 82, in <module>\r\n    vae.add_loss(loss_fn(x_in, x_out, \u03bc, \u03c3))\r\n  File \"/home/zqh/miniconda3/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py\", line 917, in add_loss\r\n    new_layers = base_layer_utils.create_keras_history(symbolic_loss)\r\n  File \"/home/zqh/miniconda3/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer_utils.py\", line 200, in create_keras_history\r\n    _, created_layers = _create_keras_history_helper(tensors, set(), [])\r\n  File \"/home/zqh/miniconda3/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer_utils.py\", line 244, in _create_keras_history_helper\r\n    constants[i] = backend.function([], op_input)([])\r\n  File \"/home/zqh/miniconda3/lib/python3.7/site-packages/tensorflow/python/keras/backend.py\", line 3292, in __call__\r\n    run_metadata=self.run_metadata)\r\n  File \"/home/zqh/miniconda3/lib/python3.7/site-packages/tensorflow/python/debug/wrappers/framework.py\", line 628, in wrapped_runner\r\n    callable_runner_args=feed_values)\r\n  File \"/home/zqh/miniconda3/lib/python3.7/site-packages/tensorflow/python/debug/wrappers/framework.py\", line 569, in run\r\n    run_metadata=run_metadata)\r\n  File \"/home/zqh/miniconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 950, in run\r\n    run_metadata_ptr)\r\n  File \"/home/zqh/miniconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 1158, in _run\r\n    self._graph, fetches, feed_dict_tensor, feed_handles=feed_handles)\r\n  File \"/home/zqh/miniconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 474, in __init__\r\n    self._fetch_mapper = _FetchMapper.for_fetch(fetches)\r\n  File \"/home/zqh/miniconda3/lib/python3.7/site-packages/tensorflow/python/client/session.py\", line 261, in for_fetch\r\n    type(fetch)))\r\nTypeError: Fetch argument None has invalid type <class 'NoneType'>\r\n\r\n```\r\n\r\n**Describe the expected behavior**\r\n\r\nIt should be work...\r\n\r\n**Code to reproduce the issue**\r\n\r\nrun this python script, then type in:` run -t 10` will get an error message...\r\n```python\r\nimport tensorflow.python as tf\r\nfrom tensorflow.python import keras as k\r\nfrom tensorflow.python.keras import layers as kl\r\nfrom tensorflow.python.keras import activations as ka\r\nimport matplotlib.pyplot as plt\r\nimport numpy as np\r\nfrom scipy.stats import norm\r\nfrom scipy.special import expit\r\nfrom tensorflow.python import debug as tfdebug\r\n\r\nconfig = tf.ConfigProto()\r\nconfig.gpu_options.allow_growth = True\r\n\r\nk.backend.set_session(tfdebug.LocalCLIDebugWrapperSession(tf.Session(config=config)))\r\n# k.backend.set_session(tf.Session(config=config))\r\n\r\n(x_train, y_train), (x_test, y_test) = k.datasets.fashion_mnist.load_data()\r\nx_train = np.expand_dims(x_train, -1) / 255.\r\nx_test = np.expand_dims(x_test, -1) / 255.\r\n\r\nimage_size = 28\r\ninput_shape = (image_size, image_size, 1)\r\nbatch_size = 100\r\nkernel_size = 3\r\nfilters = 16\r\nlatent_dim = 2  # \u9690\u53d8\u91cf\u53d62\u7ef4\u53ea\u662f\u4e3a\u4e86\u65b9\u4fbf\u540e\u9762\u753b\u56fe\r\nepochs = 30\r\ntf.set_random_seed(9102)\r\n\r\n\r\ndef encoder_fn(inputs, filters):\r\n    x = inputs\r\n    for i in range(2):\r\n        filters *= 2\r\n        x = kl.Conv2D(filters=filters, kernel_size=kernel_size, activation='relu', strides=2, padding='same')(x)\r\n    x = kl.Flatten()(x)\r\n    x = kl.Dense(32, activation='relu')(x)\r\n    \u03bc = kl.Dense(latent_dim)(x)\r\n    \u03c3 = kl.Dense(latent_dim)(x)\r\n    return \u03bc, \u03c3\r\n\r\n\r\ndef sampling(args):\r\n    \"\"\" \u91cd\u53c2\u6570\u6280\u5de7 \"\"\"\r\n    \u03bc, \u03c3 = args\r\n    \u03b5 = tf.random_normal(shape=tf.shape(\u03bc))\r\n    return \u03bc + tf.exp(\u03c3 / 2) * \u03b5\r\n\r\n\r\ndef decoder_fn(z, filters):\r\n    x = kl.Dense(7 * 7 * 32, activation='relu')(z)\r\n    x = kl.Reshape((7, 7, 32))(x)\r\n    for i in range(2):\r\n        x = kl.Conv2DTranspose(filters=filters, kernel_size=kernel_size, activation='relu', strides=2, padding='same')(x)\r\n        filters //= 2\r\n    x = kl.Conv2DTranspose(1, kernel_size, activation=None, padding='same')(x)\r\n    return x\r\n\r\n\r\ndef loss_fn(inputs, outputs, \u03bc, \u03c3):\r\n    # \u8fd9\u91cc\u6c42\u548c\u7684\u65f6\u5019\u5148\u6309\u6bcf\u4e2a\u6837\u672c\u6c42\u548c\uff0c\u518d\u6309\u6837\u672c\u6c42\u5e73\u5747\r\n    xent_loss = tf.reduce_sum(tf.nn.sigmoid_cross_entropy_with_logits(labels=x_in, logits=x_out), axis=[1, 2, 3])\r\n    # xent_loss = tf.reduce_sum(k.backend.binary_crossentropy(x_in, x_out), axis=[1, 2, 3])\r\n    kl_loss = - 0.5 * tf.reduce_sum(1 + \u03c3 - tf.square(\u03bc) - tf.exp(\u03c3), axis=-1)\r\n    vae_loss = tf.reduce_mean(xent_loss + kl_loss)\r\n    return vae_loss\r\n\r\n\r\nx_in = k.Input(shape=(image_size, image_size, 1))\r\n\u03bc, \u03c3 = encoder_fn(x_in, filters)\r\nz = kl.Lambda(sampling, output_shape=(latent_dim,))([\u03bc, \u03c3])\r\n\r\nlatent_inputs = k.Input(shape=(latent_dim,), dtype=tf.float32)\r\noutputs = decoder_fn(latent_inputs, filters)\r\ndecoder = k.Model(latent_inputs, outputs)\r\nx_out = decoder(z)\r\n\r\n\r\nencoder = k.Model(x_in, \u03bc)\r\n\r\nvae = k.Model(x_in, x_out)\r\nvae.add_loss(loss_fn(x_in, x_out, \u03bc, \u03c3))\r\nvae.compile(k.optimizers.Nadam(0.001))\r\nvae.fit(x=x_train, batch_size=batch_size, epochs=epochs, shuffle=True, validation_data=(x_test, None))\r\n```\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}]