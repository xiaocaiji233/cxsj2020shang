[{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33862", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33862/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33862/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33862/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33862", "id": 515128580, "node_id": "MDU6SXNzdWU1MTUxMjg1ODA=", "number": 33862, "title": "Segfault on multiple writes to dynamically-sized TensorArray inside tf.function", "user": {"login": "cooijmanstim", "id": 206920, "node_id": "MDQ6VXNlcjIwNjkyMA==", "avatar_url": "https://avatars1.githubusercontent.com/u/206920?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cooijmanstim", "html_url": "https://github.com/cooijmanstim", "followers_url": "https://api.github.com/users/cooijmanstim/followers", "following_url": "https://api.github.com/users/cooijmanstim/following{/other_user}", "gists_url": "https://api.github.com/users/cooijmanstim/gists{/gist_id}", "starred_url": "https://api.github.com/users/cooijmanstim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cooijmanstim/subscriptions", "organizations_url": "https://api.github.com/users/cooijmanstim/orgs", "repos_url": "https://api.github.com/users/cooijmanstim/repos", "events_url": "https://api.github.com/users/cooijmanstim/events{/privacy}", "received_events_url": "https://api.github.com/users/cooijmanstim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-10-31T03:13:18Z", "updated_at": "2019-11-02T14:39:44Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Colab\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary):\r\n- TensorFlow version (use command below): 1.15\r\n- Python version:\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\nThis code reliably produces a segmentation fault:\r\n\r\n```python\r\n%tensorflow_version 1.x\r\nimport faulthandler\r\nfaulthandler.enable()\r\nimport tensorflow as tf\r\ntf.enable_control_flow_v2()\r\nfrom tensorflow.python.ops.tensor_array_ops import build_ta_with_new_flow as ta_like\r\n\r\nnum_iterations = 5\r\n\r\nif True:\r\n  # dynamic sizing; this is the broken case.\r\n  initial_xs = tf.TensorArray(tf.float32, size=0,\r\n                              dynamic_size=True, clear_after_read=False)\r\nelse:\r\n  initial_xs = tf.TensorArray(tf.float32, size=chunk_size * num_iterations,\r\n                              dynamic_size=False, clear_after_read=False)\r\n\r\nz = tf.constant(0.)\r\n\r\n@tf.function(autograph=False)\r\ndef body_fn(i, flow):\r\n  xs = ta_like(initial_xs, flow)\r\n\r\n  # write to the TensorArray multiple times in consecutive locations.\r\n  # chunk_size > 1 is the broken case.\r\n  chunk_size = 2\r\n  for j in range(chunk_size):\r\n    xs = xs.write(i * chunk_size + j, z)\r\n\r\n  return i + 1, xs.flow\r\n\r\ni, xs = tf.constant(0), initial_xs\r\nfor _ in range(num_iterations):\r\n  i, flow = body_fn(i, xs.flow)\r\n  xs = ta_like(initial_xs, flow)\r\n\r\n# the second call to `tf.gradients` causes a segfault\r\ntf.gradients(tf.reduce_mean(xs.stack()), z)\r\ntf.gradients(tf.reduce_mean(xs.stack()), z)\r\n```\r\n\r\nThe loop code is pretty hairy but in plain python, it would read like this:\r\n\r\n```python\r\nxs = []\r\nfor i in range(num_iterations):\r\n  for j in range(chunk_size):\r\n    xs.append(0)\r\n```\r\n\r\nThe issue seems to be the combination of dynamic sizing of the `TensorArray` and multiple appends per iteration. Using `faulthandler` as above gives the following traceback at the point of the segfault:\r\n\r\n```\r\n File \"/home/tim/miniconda3/envs/py3/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py\", line 1607 in _create_c_op\r\n  File \"/home/tim/miniconda3/envs/py3/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py\", line 1770 in __init__\r\n  File \"/home/tim/miniconda3/envs/py3/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py\", line 3426 in _create_op_internal\r\n  File \"/home/tim/miniconda3/envs/py3/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py\", line 3357 in create_op\r\n  File \"/home/tim/miniconda3/envs/py3/lib/python3.6/site-packages/tensorflow_core/python/util/deprecation.py\", line 507 in new_func\r\n  File \"/home/tim/miniconda3/envs/py3/lib/python3.6/site-packages/tensorflow_core/python/framework/op_def_library.py\", line 794 in _apply_op_helper\r\n  File \"/home/tim/miniconda3/envs/py3/lib/python3.6/site-packages/tensorflow_core/python/ops/gen_functional_ops.py\", line 672 in stateful_partitioned_call\r\n  File \"/home/tim/miniconda3/envs/py3/lib/python3.6/site-packages/tensorflow_core/python/ops/functional_ops.py\", line 859 in partitioned_call\r\n  File \"/home/tim/miniconda3/envs/py3/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 540 in call\r\n  File \"/home/tim/miniconda3/envs/py3/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 1230 in _call_flat\r\n  File \"/home/tim/miniconda3/envs/py3/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 697 in _rewrite_forward_and_call_backward\r\n  File \"/home/tim/miniconda3/envs/py3/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 715 in _registered_grad_fn\r\n  File \"/home/tim/miniconda3/envs/py3/lib/python3.6/site-packages/tensorflow_core/python/ops/gradients_util.py\", line 679 in <lambda>\r\n  File \"/home/tim/miniconda3/envs/py3/lib/python3.6/site-packages/tensorflow_core/python/ops/gradients_util.py\", line 350 in _MaybeCompile\r\n  File \"/home/tim/miniconda3/envs/py3/lib/python3.6/site-packages/tensorflow_core/python/ops/gradients_util.py\", line 679 in _GradientsHelper\r\n  File \"/home/tim/miniconda3/envs/py3/lib/python3.6/site-packages/tensorflow_core/python/ops/gradients_impl.py\", line 158 in gradients\r\n  File \"/home/tim/memoryhole/segfault.py\", line 39 in <module>\r\n[...]\r\nSegmentation fault (core dumped)\r\n```\r\n\r\nP.S., my use case is I'm trying to convert an existing `while_loop` into an unrolled sequence of `tf.function` calls in order to reduce graph size without giving up on second-order derivatives. It looks promising so far, but do let me know if this is wrong-headed."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33857", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33857/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33857/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33857/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33857", "id": 514950599, "node_id": "MDU6SXNzdWU1MTQ5NTA1OTk=", "number": 33857, "title": "Fail to invoke tflite_runtime.interpreter", "user": {"login": "lelopez-io", "id": 35977981, "node_id": "MDQ6VXNlcjM1OTc3OTgx", "avatar_url": "https://avatars2.githubusercontent.com/u/35977981?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lelopez-io", "html_url": "https://github.com/lelopez-io", "followers_url": "https://api.github.com/users/lelopez-io/followers", "following_url": "https://api.github.com/users/lelopez-io/following{/other_user}", "gists_url": "https://api.github.com/users/lelopez-io/gists{/gist_id}", "starred_url": "https://api.github.com/users/lelopez-io/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lelopez-io/subscriptions", "organizations_url": "https://api.github.com/users/lelopez-io/orgs", "repos_url": "https://api.github.com/users/lelopez-io/repos", "events_url": "https://api.github.com/users/lelopez-io/events{/privacy}", "received_events_url": "https://api.github.com/users/lelopez-io/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-10-30T20:09:05Z", "updated_at": "2019-12-31T12:04:21Z", "closed_at": null, "author_association": "NONE", "body": "I'm trying to run the `tflite_runtime.interpreter` on an armv7 board. It doesn't support AVX instruction so this is the reason for using tflite rather than the tensorflow binary available for raspberry pi's.\r\n\r\nAs far as I can tell I'm setting the tensor input correctly. I've tested this by using the 'tensorflow.compat.v2.audio.decode_wav' function to compare against.\r\n\r\nHowever when I go to run the interpreter I get the following error:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/debian/xo/keyword-demo/test/test__litewave.py\", line 62, in test_detect_keywords\r\n    results = lite_wave.detect_keywords()\r\n  File \"./handlers/__litewave.py\", line 66, in detect_keywords\r\n    self.__interpreter.invoke()\r\n  File \"/home/debian/xo/keyword-demo/venv/lib/python3.7/site-packages/tflite_runtime/interpreter.py\", line 453, in invoke\r\n    self._interpreter.Invoke()\r\n  File \"/home/debian/xo/keyword-demo/venv/lib/python3.7/site-packages/tensorflow_core/lite/python/interpreter_wrapper/tensorflow_wrap_interpreter_wrapper.py\", line 109, in Invoke\r\n    return _tensorflow_wrap_interpreter_wrapper.InterpreterWrapper_Invoke(self)\r\nRuntimeError: tensorflow/lite/kernels/mfcc.cc:131 params->dct_coefficient_count != mfcc_output.size() (40 != 0)Node number 1 (Mfcc) failed to invoke.\r\n```\r\n\r\nI couldn't find a python example for the keyword spotting demo using Tensorflow Lite so I'm adapting the following two examples:\r\nhttps://github.com/tensorflow/examples/blob/master/lite/examples/object_detection/raspberry_pi/detect_picamera.py\r\nhttps://github.com/tensorflow/examples/blob/master/lite/examples/image_classification/raspberry_pi/classify_picamera.py\r\n\r\nI'm using the following code to test:\r\n```\r\nimport sys\r\nimport unittest\r\n\r\nsys.path.append('./handlers')\r\n\r\nfrom __litewave import LiteWaveHandle\r\n\r\nimport numpy as np\r\nfrom tensorflow.compat.v2.audio import decode_wav\r\nfrom tensorflow.compat.v2.io import read_file\r\n\r\n\r\nclass TestLiteWaveHandle(unittest.TestCase):\r\n\r\n    def test_load_labels(self):\r\n        lite_wave = LiteWaveHandle()\r\n\r\n        labels = {0: '_silence_', 1: '_unknown_', 2: 'yes', 3: 'no', 4: 'up', 5: 'down', 6: 'left', 7: 'right', 8: 'on', 9: 'off', 10: 'stop', 11: 'go'}\r\n        self.assertEqual(lite_wave.load_labels(\"./models/speech_commands_lite/conv_actions_labels.txt\"), labels)\r\n\r\n    def test_decode_wav(self):\r\n        lite_wave_tf = LiteWaveHandle()\r\n        lite_wave_np = LiteWaveHandle()\r\n\r\n\r\n        # set the input tensor using tf wave decoder\r\n        audio, sample_rate = decode_wav(\r\n            read_file(\"./test/vectors/go/0a2b400e_nohash_0.wav\"),\r\n            desired_channels=1,\r\n            desired_samples=16000,\r\n        )\r\n        lite_wave_tf.set_input_tensor_tf(audio)\r\n        input_tensor_tf = lite_wave_tf.get_input_tensor()\r\n\r\n\r\n        # set the input tensor using custom wave decoder\r\n        audio = lite_wave_np.decode_wav('./test/vectors/go/0a2b400e_nohash_0.wav')\r\n        lite_wave_np.set_input_tensor(audio)\r\n        input_tensor_np = lite_wave_np.get_input_tensor() \r\n\r\n        self.assertTrue(np.array_equal(input_tensor_tf, input_tensor_np))\r\n\r\n    def test_set_input_tensor(self):\r\n        lite_wave = LiteWaveHandle()\r\n\r\n        audio = lite_wave.decode_wav('./test/vectors/go/0a2b400e_nohash_0.wav')\r\n        lite_wave.set_input_tensor(audio)\r\n        self.assertTrue(np.array_equal(audio, lite_wave.get_input_tensor()))\r\n\r\n    def test_get_output_tensor(self):\r\n        lite_wave = LiteWaveHandle()\r\n\r\n        output_details, output = lite_wave.get_output_tensor(0)\r\n        self.assertEqual(output_details[\"name\"], 'labels_softmax')\r\n\r\n    def test_detect_keywords(self):\r\n        lite_wave = LiteWaveHandle()\r\n\r\n        audio = lite_wave.decode_wav('./test/vectors/go/0a2b400e_nohash_0.wav')\r\n        lite_wave.set_input_tensor(audio)\r\n\r\n        label_id, prob = lite_wave.detect_keywords()[0]\r\n        self.assertEqual(lite_wave.labels[label_id], 'go')\r\n```\r\n\r\nAnd this is the actual code for the LiteWaveHandle I'm trying to create\r\n```\r\nimport os\r\n\r\nimport re\r\nimport wave\r\nimport struct\r\n\r\nfrom tflite_runtime.interpreter import Interpreter\r\nimport numpy as np\r\n\r\nclass LiteWaveHandle:\r\n    \"\"\"A class to handle lite inferences on wave data\"\"\"\r\n\r\n    def __init__(self):\r\n        self.labels = self.load_labels(\"./models/speech_commands_lite/conv_actions_labels.txt\")\r\n\r\n        self.__interpreter = Interpreter(model_path=\"./models/speech_commands_lite/conv_actions_frozen.tflite\")\r\n        self.__interpreter.allocate_tensors()\r\n\r\n    def load_labels(self, file_path):\r\n        with open(file_path, 'r', encoding='utf-8') as f:\r\n            lines = f.readlines()\r\n            labels = {}\r\n            for row_number, content in enumerate(lines):\r\n                pair = re.split(r'[:\\s]+', content.strip(), maxsplit=1)\r\n                if len(pair) == 2 and pair[0].strip().isdigit():\r\n                    labels[int(pair[0])] = pair[1].strip()\r\n                else:\r\n                    labels[row_number] = pair[0].strip()\r\n        return labels\r\n\r\n    def decode_wav(self, file_path):\r\n        \"\"\"wave file to a numpy array of floats limited size to 16000\"\"\"\r\n        with wave.open(file_path) as wf:\r\n            astr = wf.readframes(wf.getnframes())\r\n            # convert binary chunks to short \r\n            audio = struct.unpack(\"%ih\" % (wf.getnframes()* wf.getnchannels()), astr)\r\n            audio = [float(val) / pow(2, 15) for val in audio]\r\n            audio = np.asarray(audio)\r\n            return np.reshape(audio, (16000, 1))\r\n\r\n    def set_input_tensor(self, audio):\r\n        \"\"\"Sets the input tensor.\"\"\"\r\n        tensor_index = self.__interpreter.get_input_details()[0]['index']\r\n        input_tensor = self.__interpreter.tensor(tensor_index)()\r\n        input_tensor[:] = audio\r\n\r\n    def set_input_tensor_tf(self, audio):\r\n        tensor_index = self.__interpreter.get_input_details()[0]['index']\r\n        input_tensor = self.__interpreter.tensor(tensor_index)()[0]\r\n        self.__interpreter.set_tensor(tensor_index, audio)\r\n\r\n    def get_input_tensor(self):\r\n        tensor_index = self.__interpreter.get_input_details()[0]['index']\r\n        return self.__interpreter.get_tensor(tensor_index)\r\n\r\n    def get_output_tensor(self, index):\r\n        \"\"\"Returns the output tensor at the given index.\"\"\"\r\n        output_details = self.__interpreter.get_output_details()[index]\r\n        output = np.squeeze(self.__interpreter.get_tensor(output_details['index']))\r\n        return output_details, output\r\n\r\n    def detect_keywords(self, top_k=1):\r\n        \"\"\"Returns a list of detection results, each a dictionary of object info.\"\"\"\r\n        self.__interpreter.invoke()\r\n\r\n        output_details, output = self.get_output_tensor(0)\r\n\r\n        ordered = np.argpartition(-output, top_k)\r\n        return [(i, output[i]) for i in ordered[:top_k]]\r\n```\r\n\r\nThis is running on an armv7 with python3.7.3 built from source. tflite-runtime is 2.0.0. The tflite models used are these: https://storage.googleapis.com/download.tensorflow.org/models/tflite/conv_actions_tflite.zip\r\n\r\nIf there is anything else I can add to help debug let me know. \r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33849", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33849/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33849/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33849/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33849", "id": 514612722, "node_id": "MDU6SXNzdWU1MTQ2MTI3MjI=", "number": 33849, "title": "C API: Session Options for prediction on GPU", "user": {"login": "quintakFR", "id": 57094938, "node_id": "MDQ6VXNlcjU3MDk0OTM4", "avatar_url": "https://avatars2.githubusercontent.com/u/57094938?v=4", "gravatar_id": "", "url": "https://api.github.com/users/quintakFR", "html_url": "https://github.com/quintakFR", "followers_url": "https://api.github.com/users/quintakFR/followers", "following_url": "https://api.github.com/users/quintakFR/following{/other_user}", "gists_url": "https://api.github.com/users/quintakFR/gists{/gist_id}", "starred_url": "https://api.github.com/users/quintakFR/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/quintakFR/subscriptions", "organizations_url": "https://api.github.com/users/quintakFR/orgs", "repos_url": "https://api.github.com/users/quintakFR/repos", "events_url": "https://api.github.com/users/quintakFR/events{/privacy}", "received_events_url": "https://api.github.com/users/quintakFR/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "alextp", "id": 5061, "node_id": "MDQ6VXNlcjUwNjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/5061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alextp", "html_url": "https://github.com/alextp", "followers_url": "https://api.github.com/users/alextp/followers", "following_url": "https://api.github.com/users/alextp/following{/other_user}", "gists_url": "https://api.github.com/users/alextp/gists{/gist_id}", "starred_url": "https://api.github.com/users/alextp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alextp/subscriptions", "organizations_url": "https://api.github.com/users/alextp/orgs", "repos_url": "https://api.github.com/users/alextp/repos", "events_url": "https://api.github.com/users/alextp/events{/privacy}", "received_events_url": "https://api.github.com/users/alextp/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alextp", "id": 5061, "node_id": "MDQ6VXNlcjUwNjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/5061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alextp", "html_url": "https://github.com/alextp", "followers_url": "https://api.github.com/users/alextp/followers", "following_url": "https://api.github.com/users/alextp/following{/other_user}", "gists_url": "https://api.github.com/users/alextp/gists{/gist_id}", "starred_url": "https://api.github.com/users/alextp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alextp/subscriptions", "organizations_url": "https://api.github.com/users/alextp/orgs", "repos_url": "https://api.github.com/users/alextp/repos", "events_url": "https://api.github.com/users/alextp/events{/privacy}", "received_events_url": "https://api.github.com/users/alextp/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2019-10-30T12:01:37Z", "updated_at": "2019-11-25T12:43:12Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): **yes for training and prediction**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): **Windows 10**\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: **no**\r\n- TensorFlow installed from (source or binary): **compile from sources**\r\n- TensorFlow version (use command below): **2.0**\r\n- Python version: **3.6.8**\r\n- Bazel version (if compiling from source): **0.24.1**\r\n- GCC/Compiler version (if compiling from source): **Visual Studio 2017 with MSVC 14.16.27023**\r\n- CUDA/cuDNN version: **CUDA 10.1.243 / cuDNN 7.6.4.38**\r\n- GPU model and memory: **NVIDIA GeForce RTX 2060 6Go**\r\n\r\n**Situation**\r\nI create a C++ program to train a model with the aim to perform image segmentation. This part works perfectly on the GPU and I export the pb file. The final application have to be in C# so this pb file is imported and the prediction is performed with TensorFlow.NET.\r\nThe prediction works as expected on CPU but not on the GPU. This issue is probably not caused by TensorFlow.NET (https://github.com/SciSharp/TensorFlow.NET/issues/434) so I think it is caused by C API. I don't understand why the training can be performed on the GPU and the prediction on the same GPU give me an out of memory error when I run the session.\r\n\r\n**Describe the current behavior**\r\nI set the number of GPU to one to be sure and I set the configuration GpuOptions.\r\nTo not allocate all the GPU memory I set allow_growth option to true but the issue is still present.\r\nTo limit the usage of memory I set the parameter per_process_gpu_memory_fraction 0.2, 0.5 or 0.9 but nothing changes.\r\nFor the training I only use allow_growth option and there is not out of memory error. For information I use ClientSession for this part.\r\n\r\n**Describe the expected behavior**\r\nUsing the C API or the original source code, the configuration of GPU must be the one defined with the code. I presume the issue is with the C API because the training in C++ works on GPU.\r\n\r\n**Code to reproduce the issue**\r\nTraining in C++:\r\n```\r\ntensorflow::ConfigProto& config = _sessionOptions.config;\r\nconfig.set_allow_soft_placement(true);\r\nconfig.set_log_device_placement(true);\r\nconfig.mutable_gpu_options()->set_allow_growth(true);\r\n```\r\nPrediction in C#:\r\n```\r\nConfigProto config = new ConfigProto();\r\nconfig.LogDevicePlacement = true;\r\nconfig.AllowSoftPlacement = true;\r\nGPUOptions gpuOptions = new GPUOptions();\r\ngpuOptions.AllowGrowth = true;\r\ngpuOptions.PerProcessGpuMemoryFraction = 0.5;\r\nconfig.DeviceCount.Add(\"GPU\", 1);\r\nconfig.GpuOptions = gpuOptions;\r\n```\r\n\r\n**Other info / logs**\r\nWith the log placement option, I noticed the GPU memory is allocated twice when I call the run method. The first allocation take almost all the available GPU memory then the second one grows \"step by step\". So I presume allow_growth option is operational for the second memory allocation but not the first one.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33842", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33842/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33842/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33842/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33842", "id": 514466100, "node_id": "MDU6SXNzdWU1MTQ0NjYxMDA=", "number": 33842, "title": "Optimizer state gets automatically restored when loading weights from checkpoint and doesnt change when you compile the model", "user": {"login": "Shubham3101", "id": 18517236, "node_id": "MDQ6VXNlcjE4NTE3MjM2", "avatar_url": "https://avatars3.githubusercontent.com/u/18517236?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Shubham3101", "html_url": "https://github.com/Shubham3101", "followers_url": "https://api.github.com/users/Shubham3101/followers", "following_url": "https://api.github.com/users/Shubham3101/following{/other_user}", "gists_url": "https://api.github.com/users/Shubham3101/gists{/gist_id}", "starred_url": "https://api.github.com/users/Shubham3101/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Shubham3101/subscriptions", "organizations_url": "https://api.github.com/users/Shubham3101/orgs", "repos_url": "https://api.github.com/users/Shubham3101/repos", "events_url": "https://api.github.com/users/Shubham3101/events{/privacy}", "received_events_url": "https://api.github.com/users/Shubham3101/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-10-30T07:58:58Z", "updated_at": "2019-11-26T22:07:56Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: None\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): TF 2.0.0(stable)\r\n- Python version: 3.6\r\n- Bazel version (if compiling from source):None\r\n- GCC/Compiler version (if compiling from source): None\r\n\r\n\r\n**Describe the current behavior**\r\nOptimizer state is getting restored while loading weights from model checkpoint(tf.keras.callbacks.ModelCheckpoint). Later when you compile model with different learning rate(different from the restored optimizer state), it doesn't gets updated.  \r\n\r\n**Describe the expected behavior**\r\nCompiling the model should update the optimizer state\r\n\r\n**Code to reproduce the issue**\r\n\r\n```python\r\nimport tensorflow as tf\r\nfrom tensorflow.python.keras import backend as K\r\nimport numpy as np\r\n\r\ndef get_data():\r\n    images = np.zeros((64,224))\r\n    labels = np.zeros((64,5))\r\n    return images,labels\r\n\r\ndef create_model():\r\n    input_layer = tf.keras.layers.Input(name='Image_input', shape=(224), dtype='float32')\r\n    model = tf.keras.layers.Dense(5)(input_layer)\r\n    model = tf.keras.layers.Activation('softmax', name = \"output-softmax\")(model)\r\n    model = tf.keras.models.Model(inputs=input_layer, outputs=[model])\r\n    return model\r\n\r\nos.makedirs(\"checkpoints/\")\r\ncheckpoint = tf.keras.callbacks.ModelCheckpoint(\"checkpoints/\", monitor='loss',\r\n                                                save_weights_only=True, save_freq='epoch')\r\nreduce_lr = tf.keras.callbacks.ReduceLROnPlateau(monitor='loss', factor=0.1, patience=1, verbose=1)\r\nearly_stopping = tf.keras.callbacks.EarlyStopping(monitor='loss', min_delta=0, patience=5, verbose=1)\r\n\r\nmodel = create_model()\r\ndata = get_data()\r\n\u200b\r\noptimizer = tf.keras.optimizers.Adadelta(learning_rate=1.0)\r\nmodel.compile(loss='categorical_crossentropy', optimizer=optimizer, metrics=['accuracy'])\r\n\u200b\r\nprint (\"learning_rate\",float(K.get_value(model.optimizer.lr)))\r\n                                                       \r\nmodel.fit(data[0], data[1], batch_size=16, epochs=10,callbacks=[checkpoint,reduce_lr,early_stopping])\r\n\r\nprint (\"**learning_rate_1**\",float(K.get_value(model.optimizer.lr)))`\r\n\r\nmodel = create_model()\r\n\r\nmodel.load_weights('checkpoints/')\r\n\r\noptimizer = tf.keras.optimizers.Adadelta(learning_rate=0.1)\r\nmodel.compile(loss='categorical_crossentropy', optimizer=optimizer, metrics=['accuracy'])\r\n\r\nprint (\"learning_rate\",float(K.get_value(model.optimizer.lr)))`\r\n```\r\n\r\nfinal learning rate should be **0.1** but it is equal to **learning_rate_1** ."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33840", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33840/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33840/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33840/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33840", "id": 514424131, "node_id": "MDU6SXNzdWU1MTQ0MjQxMzE=", "number": 33840, "title": "tf.image.ssim_multiscale does not work in tf-2.0.0", "user": {"login": "AravindGanesh", "id": 24208434, "node_id": "MDQ6VXNlcjI0MjA4NDM0", "avatar_url": "https://avatars0.githubusercontent.com/u/24208434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AravindGanesh", "html_url": "https://github.com/AravindGanesh", "followers_url": "https://api.github.com/users/AravindGanesh/followers", "following_url": "https://api.github.com/users/AravindGanesh/following{/other_user}", "gists_url": "https://api.github.com/users/AravindGanesh/gists{/gist_id}", "starred_url": "https://api.github.com/users/AravindGanesh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AravindGanesh/subscriptions", "organizations_url": "https://api.github.com/users/AravindGanesh/orgs", "repos_url": "https://api.github.com/users/AravindGanesh/repos", "events_url": "https://api.github.com/users/AravindGanesh/events{/privacy}", "received_events_url": "https://api.github.com/users/AravindGanesh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-10-30T06:13:49Z", "updated_at": "2020-03-19T01:15:22Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution: Linux Ubuntu 16.04\r\n- TensorFlow installed from: binary (pip)\r\n- TensorFlow version: `2.0.0`\r\n- Python version: `3.5.2`\r\n- CUDA version: `10.1`\r\n- GPU model and memory: GTX 1060, 6GB\r\n\r\n``` python\r\n# example image batches\r\nvideo1 = tf.random.uniform(shape=[8, 64, 64, 1], minval=0, maxval=1)\r\nvideo2 = tf.random.uniform(shape=[8, 64, 64, 1], minval=0, maxval=1)\r\n```\r\nssim works fine but when I use the multiscale ssim, I am getting the following error message. What am I doing wrong? How do I fix this? \r\n\r\n**SSIM**\r\n``` python\r\nssim_score = tf.image.ssim(img1=video1, img2=video1, max_val=1.0)\r\nprint(ssim_score) # tf.Tensor([1. 1. 1. 1. 1. 1. 1. 1.], shape=(8,), dtype=float32)\r\n```\r\n\r\n**MS-SSIM**\r\n``` python\r\nms_ssim_score = tf.image.ssim_multiscale(img1=video1, img2=video2, max_val=1.0)\r\n```\r\n``` python\r\n---------------------------------------------------------------------------\r\nInvalidArgumentError                      Traceback (most recent call last)\r\n<ipython-input-9-cc68ceec0921> in <module>\r\n----> 1 ms_ssim_score = tf.image.ssim_multiscale(img1=video1, img2=video2, max_val=1.0)\r\n\r\n~/.local/lib/python3.5/site-packages/tensorflow_core/python/ops/image_ops_impl.py in ssim_multiscale(img1, img2, max_val, power_factors, filter_size, filter_sigma, k1, k2)\r\n   3405             filter_sigma=filter_sigma,\r\n   3406             k1=k1,\r\n-> 3407             k2=k2)\r\n   3408         mcs.append(nn_ops.relu(cs))\r\n   3409 \r\n\r\n~/.local/lib/python3.5/site-packages/tensorflow_core/python/ops/image_ops_impl.py in _ssim_per_channel(img1, img2, max_val, filter_size, filter_sigma, k1, k2)\r\n   3174               math_ops.greater_equal(shape1[-3:-1], filter_size)),\r\n   3175           [shape1, filter_size],\r\n-> 3176           summarize=8),\r\n   3177       control_flow_ops.Assert(\r\n   3178           math_ops.reduce_all(\r\n\r\n~/.local/lib/python3.5/site-packages/tensorflow_core/python/util/tf_should_use.py in wrapped(*args, **kwargs)\r\n    196   \"\"\"\r\n    197   def wrapped(*args, **kwargs):\r\n--> 198     return _add_should_use_warning(fn(*args, **kwargs))\r\n    199   return tf_decorator.make_decorator(\r\n    200       fn, wrapped, 'should_use_result',\r\n\r\n~/.local/lib/python3.5/site-packages/tensorflow_core/python/ops/control_flow_ops.py in Assert(condition, data, summarize, name)\r\n    154           op=None,\r\n    155           message=\"Expected '%s' to be true. Summarized data: %s\" %\r\n--> 156           (condition, \"\\n\".join(data_str)))\r\n    157     return\r\n    158 \r\n\r\nInvalidArgumentError: Expected 'tf.Tensor(False, shape=(), dtype=bool)' to be true. Summarized data: 8, 8, 8, 1\r\n11\r\n\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33838", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33838/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33838/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33838/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33838", "id": 514386294, "node_id": "MDU6SXNzdWU1MTQzODYyOTQ=", "number": 33838, "title": "pip missing all versions beyond 1.13.1", "user": {"login": "Directory", "id": 26686708, "node_id": "MDQ6VXNlcjI2Njg2NzA4", "avatar_url": "https://avatars3.githubusercontent.com/u/26686708?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Directory", "html_url": "https://github.com/Directory", "followers_url": "https://api.github.com/users/Directory/followers", "following_url": "https://api.github.com/users/Directory/following{/other_user}", "gists_url": "https://api.github.com/users/Directory/gists{/gist_id}", "starred_url": "https://api.github.com/users/Directory/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Directory/subscriptions", "organizations_url": "https://api.github.com/users/Directory/orgs", "repos_url": "https://api.github.com/users/Directory/repos", "events_url": "https://api.github.com/users/Directory/events{/privacy}", "received_events_url": "https://api.github.com/users/Directory/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1194756584, "node_id": "MDU6TGFiZWwxMTk0NzU2NTg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20raspberry%20pi", "name": "subtype: raspberry pi", "color": "b619ea", "default": false, "description": "Raspberry Pi Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 17, "created_at": "2019-10-30T04:08:47Z", "updated_at": "2019-12-17T12:40:51Z", "closed_at": null, "author_association": "NONE", "body": "- Rasbian 9 buster\r\n- TensorFlow installed from binary\r\n- TensorFlow version: 1.14.1\r\n- Python version: 3.7\r\n- Installed using pip\r\n\r\nI need tensorflow version 1.14.0 specifically. Windows has the version I'm looking for. But when i run it on my pi pip says that 1.14.0 is missing and it only lists possible version numbers of 1.11.0, 1.12.0, and 1.13.1.\r\n\r\n**sudo python3.7 -m pip install tensorflow==1.14.0**\r\n\r\n\r\n**Looking in indexes: https://pypi.org/simple, https://www.piwheels.org/simple\r\nERROR: Could not find a version that satisfies the requirement tensorflow==1.14.0 (from versions: 0.11.0, 1.12.0, 1.13.1)\r\nERROR: No matching distribution found for tensorflow==1.14.0**"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33837", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33837/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33837/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33837/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33837", "id": 514383496, "node_id": "MDU6SXNzdWU1MTQzODM0OTY=", "number": 33837, "title": "Using intermediate layer outputs in custom loss function causes CUDA_ERROR_OUT_OF_MEMORY", "user": {"login": "alexbooth", "id": 16694980, "node_id": "MDQ6VXNlcjE2Njk0OTgw", "avatar_url": "https://avatars0.githubusercontent.com/u/16694980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexbooth", "html_url": "https://github.com/alexbooth", "followers_url": "https://api.github.com/users/alexbooth/followers", "following_url": "https://api.github.com/users/alexbooth/following{/other_user}", "gists_url": "https://api.github.com/users/alexbooth/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexbooth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexbooth/subscriptions", "organizations_url": "https://api.github.com/users/alexbooth/orgs", "repos_url": "https://api.github.com/users/alexbooth/repos", "events_url": "https://api.github.com/users/alexbooth/events{/privacy}", "received_events_url": "https://api.github.com/users/alexbooth/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-10-30T04:01:17Z", "updated_at": "2019-12-17T00:03:52Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n**Yes**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\n**Ubuntu 19.10**\r\n- TensorFlow installed from (source or binary):\r\n**Binary*\r\n- TensorFlow version (use command below):\r\n**2.1.0-dev20191027 (same results in 2.0)**\r\n- Python version:\r\n**3.7.5rc1**\r\n- CUDA/cuDNN version:\r\n**10.1**\r\n- GPU model and memory:\r\n**2080 TI 12gb + driver 430.50**\r\n\r\n**Describe the current behavior**\r\nI'm trying to add a kl divergence regularizer which relies on 2 intermediate layers of the encoder model. This custom loss in Keras model returns a tensor instead of a scalar when using outputs of intermediate layers. This appears to be adding operators to the graph at each iteration until I get a CUDA out of memory error.  \r\n\r\n```\r\n__________________________________________________________________________________________________\r\nLayer (type)                    Output Shape         Param #     Connected to                     \r\n==================================================================================================\r\ninput_1 (InputLayer)            [(None, 64, 64, 3)]  0                                            \r\n__________________________________________________________________________________________________\r\nconv2d (Conv2D)                 (None, 32, 32, 32)   1568        input_1[0][0]                    \r\n__________________________________________________________________________________________________\r\nconv2d_1 (Conv2D)               (None, 16, 16, 32)   16416       conv2d[0][0]                     \r\n__________________________________________________________________________________________________\r\nconv2d_2 (Conv2D)               (None, 8, 8, 32)     16416       conv2d_1[0][0]                   \r\n__________________________________________________________________________________________________\r\nconv2d_3 (Conv2D)               (None, 4, 4, 32)     16416       conv2d_2[0][0]                   \r\n__________________________________________________________________________________________________\r\nflatten (Flatten)               (None, 512)          0           conv2d_3[0][0]                   \r\n__________________________________________________________________________________________________\r\ndense (Dense)                   (None, 256)          131328      flatten[0][0]                    \r\n__________________________________________________________________________________________________\r\ndense_1 (Dense)                 (None, 256)          65792       dense[0][0]                      \r\n__________________________________________________________________________________________________\r\ndense_2 (Dense)                 (None, 32)           8224        dense_1[0][0]                    \r\n__________________________________________________________________________________________________\r\ndense_3 (Dense)                 (None, 32)           8224        dense_1[0][0]                    \r\n__________________________________________________________________________________________________\r\nreparameterize (Reparameterize) (None, 32)           0           dense_2[0][0]                    \r\n                                                                 dense_3[0][0]                    \r\n__________________________________________________________________________________________________\r\nmodel_1 (Model)                 (None, 64, 64, 3)    256611      reparameterize[0][0]             \r\n==================================================================================================\r\nTotal params: 520,995\r\nTrainable params: 520,995\r\nNon-trainable params: 0\r\n__________________________________________________________________________________________________\r\n2019-10-29 20:54:07.009002: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7\r\n2019-10-29 20:54:07.911330: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0\r\n |----------------------------------------| 0.0%  recon: 163.58 kl: 0.0 capacity (nats): 0.0 Epoch: 1/10 Loss: Tensor(\"add_2:0\", shape=(), dtype=float32) SAMPLING FRAME 1\r\n |----------------------------------------| 0.1%  recon: 183.64 kl: 0.0 capacity (nats): 0.0 Epoch: 1/10 Loss: Tensor(\"add_6:0\", shape=(), dtype=float32) SAMPLING FRAME 2\r\n |----------------------------------------| 0.3%  recon: 171.7 kl: 0.0 capacity (nats): 0.01 Epoch: 1/10 Loss: Tensor(\"add_18:0\", shape=(), dtype=float32) SAMPLING FRAME 3\r\n |----------------------------------------| 0.6%  recon: 180.35 kl: 0.0 capacity (nats): 0.02 Epoch: 1/10 Loss: Tensor(\"add_38:0\", shape=(), dtype=float32) SAMPLING FRAME 4\r\n |----------------------------------------| 1.1%  recon: 179.76 kl: 0.0 capacity (nats): 0.03 Epoch: 1/10 Loss: Tensor(\"add_66:0\", shape=(), dtype=float32) SAMPLING FRAME 5\r\n |\u2588---------------------------------------| 1.7%  recon: 182.14 kl: 0.0 capacity (nats): 0.04 Epoch: 1/10 Loss: Tensor(\"add_102:0\", shape=(), dtype=float32) SAMPLING FRAME 6\r\n |\u2588---------------------------------------| 2.4%  recon: 175.29 kl: 0.0 capacity (nats): 0.05 Epoch: 1/10 Loss: Tensor(\"add_142:0\", shape=(), dtype=float32)2019-10-29 20:54:13.957278: I tensorflow/stream_executor/cuda/cuda_driver.cc:801] failed to allocate 1.18G (1263714304 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory\r\n |\u2588---------------------------------------| 2.5%  recon: 182.22 kl: 0.0 capacity (nats): 0.05 Epoch: 1/10 Loss: Tensor(\"add_146:0\", shape=(), dtype=float32) SAMPLING FRAME 7\r\n |\u2588---------------------------------------| 2.7%  recon: 168.09 kl: 0.0 capacity (nats): 0.06 Epoch: 1/10 Loss: Tensor(\"add_158:0\", shape=(), dtype=float32)2019-10-29 20:54:14.610518: I tensorflow/stream_executor/cuda/cuda_driver.cc:801] failed to allocate 120.52M (126371328 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory\r\n2019-10-29 20:54:14.610906: I tensorflow/stream_executor/cuda/cuda_driver.cc:801] failed to allocate 120.52M (126371328 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory\r\n```\r\nNotice that \"loss: \" prints something like Tensor(\"add_146:0\", shape=(), dtype=float32) when I call train_on_batch. Previously this was just a scalar. \r\n\r\n**Describe the expected behavior**\r\nI expect kl_divergence(X, X_pred) in my code to return a scalar, and no out of memory errors.\r\n\r\n**Code to reproduce the issue**\r\n``` bash\r\ngit clone https://github.com/alexbooth/Beta-VAE-Tensorflow-2.0.git  \r\ncd Beta-VAE-Tensorflow-2.0  \r\npython3 train.py --batch_size=512\r\n```\r\nModel + Loss\r\n``` python\r\nfrom __future__ import absolute_import\r\nfrom __future__ import division\r\nfrom __future__ import print_function\r\n\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\nfrom tensorflow.keras import Model\r\nfrom tensorflow.keras.layers import Conv2D, Conv2DTranspose, Dense\r\nfrom tensorflow.keras.layers import Flatten, Reshape, Input\r\nfrom tensorflow.keras.optimizers import Adam\r\n\r\n\r\ndef Conv(n_filters, filter_width, strides=2, activation=\"relu\", name=None):\r\n    return Conv2D(n_filters, filter_width, \r\n                  strides=strides, padding=\"same\", activation=activation, name=name)\r\n\r\n\r\ndef Deconv(n_filters, filter_width, strides=2, activation=\"relu\", name=None):\r\n    return Conv2DTranspose(n_filters, filter_width, \r\n                  strides=strides, padding=\"same\", activation=activation, name=name)\r\n\r\n\r\nclass Reparameterize(tf.keras.layers.Layer):\r\n    \"\"\"\r\n    Custom layer.\r\n     \r\n    Reparameterization trick, sample random latent vectors Z from \r\n    the latent Gaussian distribution which has the following parameters \r\n\r\n    mean = Z_mu\r\n    std = exp(0.5 * Z_logvar)\r\n    \"\"\"\r\n    def call(self, inputs):\r\n        Z_mu, Z_logvar = inputs\r\n        epsilon = tf.random.normal(tf.shape(Z_mu))\r\n        sigma = tf.math.exp(0.5 * Z_logvar)\r\n        return Z_mu + sigma * epsilon\r\n\r\n\r\nclass BetaVAE:\r\n    def __init__(self, input_shape, latent_dim=32, loss_type=\"mse\", learning_rate=0.0005):\r\n        self.latent_dim = latent_dim\r\n        self.C = 0\r\n        self.gamma = 100\r\n\r\n        channels = input_shape[2]\r\n\r\n        # create encoder\r\n        encoder_input = Input(shape=input_shape)\r\n        X = Conv(32, 4)(encoder_input)\r\n        X = Conv(32, 4)(X)\r\n        X = Conv(32, 4)(X)\r\n        X = Conv(32, 4)(X)\r\n        X = Flatten()(X)\r\n        X = Dense(256, activation=\"relu\")(X)\r\n        X = Dense(256,  activation=\"relu\")(X)\r\n        Z_mu = Dense(self.latent_dim)(X)\r\n        Z_logvar = Dense(self.latent_dim, activation=\"relu\")(X)\r\n        Z = Reparameterize()([Z_mu, Z_logvar])\r\n\r\n        # create decoder\r\n        output_activation = \"sigmoid\" if channels == 1 else None\r\n        decoder_input = Input(shape=(self.latent_dim,))\r\n        X = Dense(256,  activation=\"relu\")(decoder_input)\r\n        X = Dense(256,  activation=\"relu\")(X)\r\n        X = Dense(512,  activation=\"relu\")(X)\r\n        X = Reshape((4, 4, 32))(X)\r\n        X = Deconv(32, 4)(X)\r\n        X = Deconv(32, 4)(X)\r\n        X = Deconv(32, 4)(X)\r\n        decoder_output = Deconv(channels, 4, activation=output_activation)(X)\r\n\r\n        # define vae losses\r\n        def reconstruction_loss(X, X_pred):\r\n            if loss_type == \"bce\":\r\n                bce = tf.losses.BinaryCrossentropy() \r\n                return bce(X, X_pred) * np.prod(input_shape)\r\n            elif loss_type == \"mse\":\r\n                mse = tf.losses.MeanSquaredError()\r\n                return mse(X, X_pred) * np.prod(input_shape)\r\n            else:\r\n                raise ValueError(\"Unknown reconstruction loss type. Try 'bce' or 'mse'\")\r\n\r\n        def kl_divergence(X, X_pred):\r\n            self.C += (1/1440) # TODO use correct scalar\r\n            self.C = min(self.C, 35) # TODO make variable\r\n            kl = -0.5 * tf.reduce_mean(1 + Z_logvar - Z_mu**2 - tf.math.exp(Z_logvar))\r\n            return self.gamma * tf.math.abs(kl - self.C)\r\n\r\n        def loss(X, X_pred):\r\n            return reconstruction_loss(X, X_pred) + kl_divergence(X, X_pred)\r\n\r\n        # create models\r\n        self.encoder = Model(encoder_input, [Z_mu, Z_logvar, Z])\r\n        self.decoder = Model(decoder_input, decoder_output)\r\n        self.vae = Model(encoder_input, self.decoder(Z))\r\n        self.vae.compile(optimizer='adam', loss=loss, metrics=[reconstruction_loss, kl_divergence])\r\n\r\n    def predict(self, inputs, mode=None):\r\n        if mode == \"encode\":\r\n            _, _, self.Z = self.encoder.predict(inputs)\r\n            return self.Z\r\n        if mode == \"decode\":\r\n            return self.decoder.predict(inputs)\r\n        if mode == None:\r\n            return self.vae.predict(inputs) \r\n        raise ValueError(\"Unsupported mode during call to model.\") \r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33834", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33834/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33834/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33834/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33834", "id": 514315654, "node_id": "MDU6SXNzdWU1MTQzMTU2NTQ=", "number": 33834, "title": "Embedding Layer's mask operation with LSTM Layer Gives Wrong Results When Using a GPU", "user": {"login": "gtg162y", "id": 23042512, "node_id": "MDQ6VXNlcjIzMDQyNTEy", "avatar_url": "https://avatars1.githubusercontent.com/u/23042512?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gtg162y", "html_url": "https://github.com/gtg162y", "followers_url": "https://api.github.com/users/gtg162y/followers", "following_url": "https://api.github.com/users/gtg162y/following{/other_user}", "gists_url": "https://api.github.com/users/gtg162y/gists{/gist_id}", "starred_url": "https://api.github.com/users/gtg162y/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gtg162y/subscriptions", "organizations_url": "https://api.github.com/users/gtg162y/orgs", "repos_url": "https://api.github.com/users/gtg162y/repos", "events_url": "https://api.github.com/users/gtg162y/events{/privacy}", "received_events_url": "https://api.github.com/users/gtg162y/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "qlzh727", "id": 5118881, "node_id": "MDQ6VXNlcjUxMTg4ODE=", "avatar_url": "https://avatars3.githubusercontent.com/u/5118881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qlzh727", "html_url": "https://github.com/qlzh727", "followers_url": "https://api.github.com/users/qlzh727/followers", "following_url": "https://api.github.com/users/qlzh727/following{/other_user}", "gists_url": "https://api.github.com/users/qlzh727/gists{/gist_id}", "starred_url": "https://api.github.com/users/qlzh727/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qlzh727/subscriptions", "organizations_url": "https://api.github.com/users/qlzh727/orgs", "repos_url": "https://api.github.com/users/qlzh727/repos", "events_url": "https://api.github.com/users/qlzh727/events{/privacy}", "received_events_url": "https://api.github.com/users/qlzh727/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "qlzh727", "id": 5118881, "node_id": "MDQ6VXNlcjUxMTg4ODE=", "avatar_url": "https://avatars3.githubusercontent.com/u/5118881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qlzh727", "html_url": "https://github.com/qlzh727", "followers_url": "https://api.github.com/users/qlzh727/followers", "following_url": "https://api.github.com/users/qlzh727/following{/other_user}", "gists_url": "https://api.github.com/users/qlzh727/gists{/gist_id}", "starred_url": "https://api.github.com/users/qlzh727/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qlzh727/subscriptions", "organizations_url": "https://api.github.com/users/qlzh727/orgs", "repos_url": "https://api.github.com/users/qlzh727/repos", "events_url": "https://api.github.com/users/qlzh727/events{/privacy}", "received_events_url": "https://api.github.com/users/qlzh727/received_events", "type": "User", "site_admin": false}, {"login": "gadagashwini", "id": 48476109, "node_id": "MDQ6VXNlcjQ4NDc2MTA5", "avatar_url": "https://avatars3.githubusercontent.com/u/48476109?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gadagashwini", "html_url": "https://github.com/gadagashwini", "followers_url": "https://api.github.com/users/gadagashwini/followers", "following_url": "https://api.github.com/users/gadagashwini/following{/other_user}", "gists_url": "https://api.github.com/users/gadagashwini/gists{/gist_id}", "starred_url": "https://api.github.com/users/gadagashwini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gadagashwini/subscriptions", "organizations_url": "https://api.github.com/users/gadagashwini/orgs", "repos_url": "https://api.github.com/users/gadagashwini/repos", "events_url": "https://api.github.com/users/gadagashwini/events{/privacy}", "received_events_url": "https://api.github.com/users/gadagashwini/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-10-30T00:28:10Z", "updated_at": "2020-03-17T05:34:06Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04.3\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: No\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version (use command below): 2.0 GPU version\r\n- Python version: 3.x\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nWhen using a GPU, the mask operation of the embedding layer (with LSTM layer) gives wrong result. With mask_zero = True, anytime there is an input of 0 in one of the time steps, the output should be same as the previous time step's output. Which is what it does with a CPU. However, using a GPU, it just gives a zero output (which is not the expected behavior).\r\n\r\n**Describe the expected behavior**\r\nWith mask_zero = True, anytime there is an input of 0 in one of the time steps, the output should be same as the previous time step's output. \r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n########################################\r\nimport tensorflow as tf\r\ntf.random.set_seed(0)\r\n\r\ninputs = tf.keras.layers.Input(shape=(None,), dtype='int32')\r\nx = tf.keras.layers.Embedding(input_dim=10, output_dim=3, mask_zero=True)(inputs)\r\noutputs = tf.keras.layers.LSTM(2, return_sequences=True)(x)\r\n\r\nmodel = tf.keras.Model(inputs, outputs)\r\npadded_inputs = tf.constant([[1,3,0,0]])\r\nprint(model(padded_inputs))\r\n\r\nIt prints the following:\r\ntf.Tensor(\r\n[[[0.00727878 0.00290126]\r\n  [0.00217528 0.00565582]\r\n  [0.         0.        ]\r\n  [0.         0.        ]]] \r\n\r\ninstead of \r\n\r\ntf.Tensor(\r\n[[[0.00727878 0.00290126]\r\n  [0.00217528 0.00565582]\r\n  [0.00217528 0.00565582]\r\n  [0.00217528 0.00565582]]] (which is what it is supposed to print). \r\nNote that when only using a CPU, it gives the correct result.\r\n########################################\r\n\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33826", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33826/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33826/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33826/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33826", "id": 513963991, "node_id": "MDU6SXNzdWU1MTM5NjM5OTE=", "number": 33826, "title": "Calling train in SavedModelEstimator gives ValueError: At least two variables have the same name", "user": {"login": "EduardoDixo", "id": 33178988, "node_id": "MDQ6VXNlcjMzMTc4OTg4", "avatar_url": "https://avatars0.githubusercontent.com/u/33178988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/EduardoDixo", "html_url": "https://github.com/EduardoDixo", "followers_url": "https://api.github.com/users/EduardoDixo/followers", "following_url": "https://api.github.com/users/EduardoDixo/following{/other_user}", "gists_url": "https://api.github.com/users/EduardoDixo/gists{/gist_id}", "starred_url": "https://api.github.com/users/EduardoDixo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/EduardoDixo/subscriptions", "organizations_url": "https://api.github.com/users/EduardoDixo/orgs", "repos_url": "https://api.github.com/users/EduardoDixo/repos", "events_url": "https://api.github.com/users/EduardoDixo/events{/privacy}", "received_events_url": "https://api.github.com/users/EduardoDixo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1162044565, "node_id": "MDU6TGFiZWwxMTYyMDQ0NTY1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.12", "name": "TF 1.12", "color": "c2e0c6", "default": false, "description": "Issues related to TF 1.12"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-10-29T14:34:06Z", "updated_at": "2020-01-03T22:47:23Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (use command below): 1.12.0-rc2-3-ga6d8ffae09 1.12.0\r\n- Python version: Python 3.6.9\r\n\r\n**Describe the current behavior**\r\n\r\n- Defining a model using tensorflow.keras\r\n- Converting the compiled model to estimator\r\n- Training estimator using train_and_evaluate\r\n- Export all saved models for  \"TRAIN\", \"EVAL\" and \"PREDICT\"\r\n\r\nWhen I create a SavedModelEstimator from the previous exported data, I am able to call evaluate and predict successfully. However, if I call the method train I get an error \"ValueError: At least two variables have the same name: dense_1/bias/Adam)\".\r\n\r\n**I can warm-start sucessfully if I change the line in _get_grouped_variables to:** https://github.com/tensorflow/tensorflow/blob/9c52e7ce02532c22a79ae7139f37c663add4c90f/tensorflow/python/training/warm_starting_util.py#L349\r\n\r\n`ops.GraphKeys.TRAINABLE_VARIABLES, scope=v)`\r\n\r\n**Code to reproduce the issue**\r\n\r\n```python\r\nimport tensorflow as tf\r\nfrom tensorflow.keras.layers import Input, Dense, Dropout\r\nfrom tensorflow.keras.models import Model\r\nfrom tensorflow.keras.estimator import model_to_estimator\r\nimport keras.backend as K\r\nimport numpy as np\r\nimport os\r\n\r\n\r\ndef model_fn():\r\n    # 10 features\r\n    input_layer = Input(shape=(10,), name=\"inputs\", dtype=tf.float32)\r\n    dense_1 = Dense(units=10, activation=\"relu\", name=\"dense_1\")(input_layer)\r\n    dense_2 = Dense(units=1, activation=\"linear\", name=\"outputs\",\r\n                    dtype=tf.float32)(dense_1)\r\n    model = Model(inputs=input_layer, outputs=dense_2)\r\n    model.compile(optimizer=tf.train.AdamOptimizer(),\r\n                  loss=\"mse\")\r\n    return model\r\n\r\n\r\ndef synthetic_input_fn(num_examples, num_features):\r\n    # dummy data\r\n    return tf.data.Dataset.from_tensor_slices(({\"inputs\": np.random.random((num_examples, num_features))}, np.random.randint(10, size=num_examples))) \\\r\n        .shuffle(512) \\\r\n        .batch(32) \\\r\n        .repeat(10)\r\n\r\n\r\nif __name__ == \"__main__\":\r\n\r\n    MODEL_DIR = \"./model\"\r\n    SAVED_MODEL_DIR = os.path.join(MODEL_DIR, \"saved\")\r\n\r\n    def cust_train_input_fn():\r\n        return synthetic_input_fn(1000, 10)\r\n\r\n    def cust_eval_input_fn():\r\n        return synthetic_input_fn(100, 10)\r\n\r\n    tf.logging.set_verbosity(tf.logging.INFO)\r\n\r\n    # define model and convert to estimator\r\n    model = model_fn()\r\n    estimator = model_to_estimator(\r\n        keras_model=model,\r\n        model_dir=MODEL_DIR\r\n    )\r\n\r\n    train_spec = tf.estimator.TrainSpec(input_fn=cust_train_input_fn)\r\n    eval_spec = tf.estimator.EvalSpec(input_fn=cust_eval_input_fn)\r\n\r\n    # train and evaluate dummy model\r\n    tf.estimator.train_and_evaluate(\r\n        estimator=estimator,\r\n        train_spec=train_spec,\r\n        eval_spec=eval_spec\r\n    )\r\n\r\n    # export all modes\r\n    feature_spec = {\"inputs\": tf.placeholder(tf.float64, (None, 10))}\r\n\r\n    label_spec = tf.placeholder(dtype=tf.int64)\r\n\r\n    serving_fn = tf.estimator.export.build_raw_serving_input_receiver_fn(feature_spec)\r\n    training_fn = tf.contrib.estimator.build_raw_supervised_input_receiver_fn(feature_spec, label_spec)\r\n\r\n    rcrv_fn_map = {\r\n        tf.estimator.ModeKeys.TRAIN: training_fn,\r\n        tf.estimator.ModeKeys.EVAL: training_fn,\r\n        tf.estimator.ModeKeys.PREDICT: serving_fn\r\n    }\r\n\r\n    tf.contrib.estimator.export_all_saved_models(\r\n        estimator,\r\n        export_dir_base=SAVED_MODEL_DIR,\r\n        input_receiver_fn_map=rcrv_fn_map\r\n    )\r\n\r\n    tf.keras.backend.clear_session()\r\n\r\n    saved_estimator = tf.contrib.estimator.SavedModelEstimator(os.path.join(SAVED_MODEL_DIR, os.listdir(SAVED_MODEL_DIR)[0]))\r\n    saved_estimator.train(cust_train_input_fn)\r\n```\r\n\r\n\r\n**Other info / logs**\r\nUsing TensorFlow backend.\r\nINFO:tensorflow:Using default config.\r\nINFO:tensorflow:Using the Keras model provided.\r\n2019-10-29 14:26:59.280066: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\nINFO:tensorflow:Using config: {'_model_dir': './model', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': None, '_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true\r\ngraph_options {\r\n  rewrite_options {\r\n    meta_optimizer_iterations: ONE\r\n  }\r\n}\r\n, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x62b766be0>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}\r\nINFO:tensorflow:Not using Distribute Coordinator.\r\nINFO:tensorflow:Running training and evaluation locally (non-distributed).\r\nINFO:tensorflow:Start train and evaluate loop. The evaluate will happen after every checkpoint. Checkpoint frequency is determined based on RunConfig arguments: save_checkpoints_steps None or save_checkpoints_secs 600.\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Warm-starting with WarmStartSettings: WarmStartSettings(ckpt_to_initialize_from='./model/keras/keras_model.ckpt', vars_to_warm_start='.*', var_name_to_vocab_info={}, var_name_to_prev_var_name={})\r\nINFO:tensorflow:Warm-starting from: ('./model/keras/keras_model.ckpt',)\r\nINFO:tensorflow:Warm-starting variable: dense_1/kernel; prev_var_name: Unchanged\r\nINFO:tensorflow:Warm-starting variable: dense_1/bias; prev_var_name: Unchanged\r\nINFO:tensorflow:Warm-starting variable: outputs/kernel; prev_var_name: Unchanged\r\nINFO:tensorflow:Warm-starting variable: outputs/bias; prev_var_name: Unchanged\r\nINFO:tensorflow:Create CheckpointSaverHook.\r\nINFO:tensorflow:Graph was finalized.\r\nINFO:tensorflow:Running local_init_op.\r\nINFO:tensorflow:Done running local_init_op.\r\nINFO:tensorflow:Saving checkpoints for 0 into ./model/model.ckpt.\r\nINFO:tensorflow:loss = 32.57418, step = 1\r\nINFO:tensorflow:global_step/sec: 1201.8\r\nINFO:tensorflow:loss = 24.11268, step = 101 (0.083 sec)\r\nINFO:tensorflow:global_step/sec: 1799.1\r\nINFO:tensorflow:loss = 12.514932, step = 201 (0.056 sec)\r\nINFO:tensorflow:global_step/sec: 1810.48\r\nINFO:tensorflow:loss = 9.915621, step = 301 (0.055 sec)\r\nINFO:tensorflow:Saving checkpoints for 320 into ./model/model.ckpt.\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Starting evaluation at 2019-10-29-14:27:00\r\nINFO:tensorflow:Graph was finalized.\r\nINFO:tensorflow:Restoring parameters from ./model/model.ckpt-320\r\nINFO:tensorflow:Running local_init_op.\r\nINFO:tensorflow:Done running local_init_op.\r\nINFO:tensorflow:Evaluation [10/100]\r\nINFO:tensorflow:Evaluation [20/100]\r\nINFO:tensorflow:Evaluation [30/100]\r\nINFO:tensorflow:Evaluation [40/100]\r\nINFO:tensorflow:Finished evaluation at 2019-10-29-14:27:00\r\nINFO:tensorflow:Saving dict for global step 320: global_step = 320, loss = 8.093195\r\nINFO:tensorflow:Saving 'checkpoint_path' summary for global step 320: ./model/model.ckpt-320\r\nINFO:tensorflow:Loss for final step: 10.114872.\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Signatures INCLUDED in export for Classify: None\r\nINFO:tensorflow:Signatures INCLUDED in export for Regress: None\r\nINFO:tensorflow:Signatures INCLUDED in export for Predict: None\r\nINFO:tensorflow:Signatures INCLUDED in export for Train: ['train']\r\nINFO:tensorflow:Signatures INCLUDED in export for Eval: None\r\nWARNING:tensorflow:Export includes no default signature!\r\nINFO:tensorflow:Restoring parameters from ./model/model.ckpt-320\r\nWARNING:tensorflow:From /anaconda3/envs/tf-abalone/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py:1044: calling SavedModelBuilder.add_meta_graph_and_variables (from tensorflow.python.saved_model.builder_impl) with legacy_init_op is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nPass your op to the equivalent parameter main_op instead.\r\nINFO:tensorflow:Assets added to graph.\r\nINFO:tensorflow:No assets to write.\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Signatures INCLUDED in export for Classify: None\r\nINFO:tensorflow:Signatures INCLUDED in export for Regress: None\r\nINFO:tensorflow:Signatures INCLUDED in export for Predict: None\r\nINFO:tensorflow:Signatures INCLUDED in export for Train: None\r\nINFO:tensorflow:Signatures INCLUDED in export for Eval: ['eval']\r\nWARNING:tensorflow:Export includes no default signature!\r\nINFO:tensorflow:Restoring parameters from ./model/model.ckpt-320\r\nWARNING:tensorflow:From /anaconda3/envs/tf-abalone/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py:1046: calling SavedModelBuilder.add_meta_graph (from tensorflow.python.saved_model.builder_impl) with legacy_init_op is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nPass your op to the equivalent parameter main_op instead.\r\nINFO:tensorflow:Assets added to graph.\r\nINFO:tensorflow:No assets to write.\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Signatures INCLUDED in export for Classify: None\r\nINFO:tensorflow:Signatures INCLUDED in export for Regress: None\r\nINFO:tensorflow:Signatures INCLUDED in export for Predict: ['serving_default']\r\nINFO:tensorflow:Signatures INCLUDED in export for Train: None\r\nINFO:tensorflow:Signatures INCLUDED in export for Eval: None\r\nINFO:tensorflow:Restoring parameters from ./model/model.ckpt-320\r\nINFO:tensorflow:Assets added to graph.\r\nINFO:tensorflow:No assets to write.\r\nINFO:tensorflow:SavedModel written to: ./model/saved/temp-b'1572359223'/saved_model.pb\r\nINFO:tensorflow:Using default config.\r\nWARNING:tensorflow:Using temporary folder as model directory: /var/folders/8s/tjdwdq296s5fdljp3p6jd9z40000gn/T/tmp7c0vhh49\r\nINFO:tensorflow:Using config: {'_model_dir': '/var/folders/8s/tjdwdq296s5fdljp3p6jd9z40000gn/T/tmp7c0vhh49', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': None, '_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true\r\ngraph_options {\r\n  rewrite_options {\r\n    meta_optimizer_iterations: ONE\r\n  }\r\n}\r\n, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x1c316e6208>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}\r\nINFO:tensorflow:Checking available modes for SavedModelEstimator.\r\nINFO:tensorflow:Available modes for Estimator: ['train', 'eval', 'infer']\r\nINFO:tensorflow:Calling model_fn.\r\nINFO:tensorflow:Done calling model_fn.\r\nINFO:tensorflow:Warm-starting with WarmStartSettings: WarmStartSettings(ckpt_to_initialize_from='./model/saved/1572359223/variables/variables', vars_to_warm_start=['dense_1/bias', 'dense_1/bias/Adam', 'dense_1/bias/Adam_1', 'dense_1/kernel', 'dense_1/kernel/Adam', 'dense_1/kernel/Adam_1', 'global_step', 'outputs/bias', 'outputs/bias/Adam', 'outputs/bias/Adam_1', 'outputs/kernel', 'outputs/kernel/Adam', 'outputs/kernel/Adam_1', 'training/TFOptimizer/beta1_power', 'training/TFOptimizer/beta2_power'], var_name_to_vocab_info={}, var_name_to_prev_var_name={})\r\nINFO:tensorflow:Warm-starting from: ('./model/saved/1572359223/variables/variables',)\r\nINFO:tensorflow:Warm-starting variable: dense_1/bias; prev_var_name: Unchanged\r\nINFO:tensorflow:Warm-starting variable: dense_1/bias/Adam; prev_var_name: Unchanged\r\nTraceback (most recent call last):\r\n  File \"main.py\", line 83, in <module>\r\n    saved_estimator.train(cust_train_input_fn)\r\n  File \"/anaconda3/envs/tf-abalone/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 354, in train\r\n    loss = self._train_model(input_fn, hooks, saving_listeners)\r\n  File \"/anaconda3/envs/tf-abalone/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 1207, in _train_model\r\n    return self._train_model_default(input_fn, hooks, saving_listeners)\r\n  File \"/anaconda3/envs/tf-abalone/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 1241, in _train_model_default\r\n    saving_listeners)\r\n  File \"/anaconda3/envs/tf-abalone/lib/python3.6/site-packages/tensorflow/python/estimator/estimator.py\", line 1360, in _train_with_estimator_spec\r\n    warm_starting_util.warm_start(*self._warm_start_settings)\r\n  File \"/anaconda3/envs/tf-abalone/lib/python3.6/site-packages/tensorflow/python/training/warm_starting_util.py\", line 463, in warm_start\r\n    _warm_start_var(variable, ckpt_to_initialize_from, prev_var_name)\r\n  File \"/anaconda3/envs/tf-abalone/lib/python3.6/site-packages/tensorflow/python/training/warm_starting_util.py\", line 170, in _warm_start_var\r\n    current_var_name = _infer_var_name(var)\r\n  File \"/anaconda3/envs/tf-abalone/lib/python3.6/site-packages/tensorflow/python/training/warm_starting_util.py\", line 142, in _infer_var_name\r\n    name_to_var_dict = saver.BaseSaverBuilder.OpListToDict(var)\r\n  File \"/anaconda3/envs/tf-abalone/lib/python3.6/site-packages/tensorflow/python/training/saver.py\", line 572, in OpListToDict\r\n    name)\r\nValueError: At least two variables have the same name: dense_1/bias/Adam"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33824", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33824/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33824/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33824/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33824", "id": 513958958, "node_id": "MDU6SXNzdWU1MTM5NTg5NTg=", "number": 33824, "title": "code and tutorial description mismatch on CNN", "user": {"login": "jramirezpr", "id": 25598546, "node_id": "MDQ6VXNlcjI1NTk4NTQ2", "avatar_url": "https://avatars2.githubusercontent.com/u/25598546?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jramirezpr", "html_url": "https://github.com/jramirezpr", "followers_url": "https://api.github.com/users/jramirezpr/followers", "following_url": "https://api.github.com/users/jramirezpr/following{/other_user}", "gists_url": "https://api.github.com/users/jramirezpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/jramirezpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jramirezpr/subscriptions", "organizations_url": "https://api.github.com/users/jramirezpr/orgs", "repos_url": "https://api.github.com/users/jramirezpr/repos", "events_url": "https://api.github.com/users/jramirezpr/events{/privacy}", "received_events_url": "https://api.github.com/users/jramirezpr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "lamberta", "id": 43051, "node_id": "MDQ6VXNlcjQzMDUx", "avatar_url": "https://avatars2.githubusercontent.com/u/43051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lamberta", "html_url": "https://github.com/lamberta", "followers_url": "https://api.github.com/users/lamberta/followers", "following_url": "https://api.github.com/users/lamberta/following{/other_user}", "gists_url": "https://api.github.com/users/lamberta/gists{/gist_id}", "starred_url": "https://api.github.com/users/lamberta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lamberta/subscriptions", "organizations_url": "https://api.github.com/users/lamberta/orgs", "repos_url": "https://api.github.com/users/lamberta/repos", "events_url": "https://api.github.com/users/lamberta/events{/privacy}", "received_events_url": "https://api.github.com/users/lamberta/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "lamberta", "id": 43051, "node_id": "MDQ6VXNlcjQzMDUx", "avatar_url": "https://avatars2.githubusercontent.com/u/43051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lamberta", "html_url": "https://github.com/lamberta", "followers_url": "https://api.github.com/users/lamberta/followers", "following_url": "https://api.github.com/users/lamberta/following{/other_user}", "gists_url": "https://api.github.com/users/lamberta/gists{/gist_id}", "starred_url": "https://api.github.com/users/lamberta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lamberta/subscriptions", "organizations_url": "https://api.github.com/users/lamberta/orgs", "repos_url": "https://api.github.com/users/lamberta/repos", "events_url": "https://api.github.com/users/lamberta/events{/privacy}", "received_events_url": "https://api.github.com/users/lamberta/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-10-29T14:27:20Z", "updated_at": "2019-11-27T09:03:59Z", "closed_at": null, "author_association": "NONE", "body": "## URL(s) with the issue:\r\nhttps://www.tensorflow.org/tutorials/images/cnn\r\n## Description of issue (what needs changing):\r\nTwo mismatchs between output shape on model summary and tutorial:\r\n1\"To complete our model, you will feed the last output tensor from the convolutional base (of shape (3, 3, 64))\"\r\nshould be changed to\r\nTo complete our model, you will feed the last output tensor from the convolutional base (of shape (4, 4, 64))\r\n  \r\n2.\"As you can see, our (3, 3, 64) outputs were flattened into vectors of shape (576) before going through two Dense layers.\"\r\nThis should be changed to \r\n\"As you can see, our (4, 4, 64) outputs were flattened into vectors of shape (1024) before going through two Dense layers.\r\n\r\n\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33823", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33823/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33823/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33823/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33823", "id": 513935859, "node_id": "MDU6SXNzdWU1MTM5MzU4NTk=", "number": 33823, "title": "Missing TF 2.0 low-level API guide", "user": {"login": "chrism0dwk", "id": 625462, "node_id": "MDQ6VXNlcjYyNTQ2Mg==", "avatar_url": "https://avatars0.githubusercontent.com/u/625462?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chrism0dwk", "html_url": "https://github.com/chrism0dwk", "followers_url": "https://api.github.com/users/chrism0dwk/followers", "following_url": "https://api.github.com/users/chrism0dwk/following{/other_user}", "gists_url": "https://api.github.com/users/chrism0dwk/gists{/gist_id}", "starred_url": "https://api.github.com/users/chrism0dwk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chrism0dwk/subscriptions", "organizations_url": "https://api.github.com/users/chrism0dwk/orgs", "repos_url": "https://api.github.com/users/chrism0dwk/repos", "events_url": "https://api.github.com/users/chrism0dwk/events{/privacy}", "received_events_url": "https://api.github.com/users/chrism0dwk/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "dynamicwebpaige", "id": 3712347, "node_id": "MDQ6VXNlcjM3MTIzNDc=", "avatar_url": "https://avatars2.githubusercontent.com/u/3712347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dynamicwebpaige", "html_url": "https://github.com/dynamicwebpaige", "followers_url": "https://api.github.com/users/dynamicwebpaige/followers", "following_url": "https://api.github.com/users/dynamicwebpaige/following{/other_user}", "gists_url": "https://api.github.com/users/dynamicwebpaige/gists{/gist_id}", "starred_url": "https://api.github.com/users/dynamicwebpaige/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dynamicwebpaige/subscriptions", "organizations_url": "https://api.github.com/users/dynamicwebpaige/orgs", "repos_url": "https://api.github.com/users/dynamicwebpaige/repos", "events_url": "https://api.github.com/users/dynamicwebpaige/events{/privacy}", "received_events_url": "https://api.github.com/users/dynamicwebpaige/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "dynamicwebpaige", "id": 3712347, "node_id": "MDQ6VXNlcjM3MTIzNDc=", "avatar_url": "https://avatars2.githubusercontent.com/u/3712347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dynamicwebpaige", "html_url": "https://github.com/dynamicwebpaige", "followers_url": "https://api.github.com/users/dynamicwebpaige/followers", "following_url": "https://api.github.com/users/dynamicwebpaige/following{/other_user}", "gists_url": "https://api.github.com/users/dynamicwebpaige/gists{/gist_id}", "starred_url": "https://api.github.com/users/dynamicwebpaige/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dynamicwebpaige/subscriptions", "organizations_url": "https://api.github.com/users/dynamicwebpaige/orgs", "repos_url": "https://api.github.com/users/dynamicwebpaige/repos", "events_url": "https://api.github.com/users/dynamicwebpaige/events{/privacy}", "received_events_url": "https://api.github.com/users/dynamicwebpaige/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-10-29T13:56:06Z", "updated_at": "2020-01-29T01:21:22Z", "closed_at": null, "author_association": "NONE", "body": "## URL(s) with the issue:\r\n\r\nhttps://www.tensorflow.org/guide\r\n\r\n## Description of issue (what needs changing):\r\n\r\nIn the TF1.* docs, a very helpful low-level API guide was provided which helped those of us interested in using TensorFlow for applications other than NN style models.  This appears to be entirely missing from the TF 2.0 documentation.  Is this omission on purpose, and if so how do we teach people how to use the low-level API?\r\n\r\nThanks,\r\n\r\nChris\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33812", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33812/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33812/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33812/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/33812", "id": 513750012, "node_id": "MDExOlB1bGxSZXF1ZXN0MzMzNDc5NjAw", "number": 33812, "title": "Add unit tests for keras network get_layer.", "user": {"login": "vcarpani", "id": 38493091, "node_id": "MDQ6VXNlcjM4NDkzMDkx", "avatar_url": "https://avatars3.githubusercontent.com/u/38493091?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vcarpani", "html_url": "https://github.com/vcarpani", "followers_url": "https://api.github.com/users/vcarpani/followers", "following_url": "https://api.github.com/users/vcarpani/following{/other_user}", "gists_url": "https://api.github.com/users/vcarpani/gists{/gist_id}", "starred_url": "https://api.github.com/users/vcarpani/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vcarpani/subscriptions", "organizations_url": "https://api.github.com/users/vcarpani/orgs", "repos_url": "https://api.github.com/users/vcarpani/repos", "events_url": "https://api.github.com/users/vcarpani/events{/privacy}", "received_events_url": "https://api.github.com/users/vcarpani/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 987666414, "node_id": "MDU6TGFiZWw5ODc2NjY0MTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/ready%20to%20pull", "name": "ready to pull", "color": "2cd643", "default": false, "description": ""}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-10-29T07:58:35Z", "updated_at": "2020-03-19T06:59:37Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/33812", "html_url": "https://github.com/tensorflow/tensorflow/pull/33812", "diff_url": "https://github.com/tensorflow/tensorflow/pull/33812.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/33812.patch"}, "body": "This PR adds unit tests for the method `get_layer` of a Keras `Network`. "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33810", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33810/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33810/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33810/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33810", "id": 513735624, "node_id": "MDU6SXNzdWU1MTM3MzU2MjQ=", "number": 33810, "title": "Please add the \"reuse\" parameter to tf.keras.layers.Conv2D()", "user": {"login": "Leonscrt", "id": 42233288, "node_id": "MDQ6VXNlcjQyMjMzMjg4", "avatar_url": "https://avatars0.githubusercontent.com/u/42233288?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Leonscrt", "html_url": "https://github.com/Leonscrt", "followers_url": "https://api.github.com/users/Leonscrt/followers", "following_url": "https://api.github.com/users/Leonscrt/following{/other_user}", "gists_url": "https://api.github.com/users/Leonscrt/gists{/gist_id}", "starred_url": "https://api.github.com/users/Leonscrt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Leonscrt/subscriptions", "organizations_url": "https://api.github.com/users/Leonscrt/orgs", "repos_url": "https://api.github.com/users/Leonscrt/repos", "events_url": "https://api.github.com/users/Leonscrt/events{/privacy}", "received_events_url": "https://api.github.com/users/Leonscrt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-10-29T07:18:45Z", "updated_at": "2019-10-29T20:10:03Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using):\r\n- Are you willing to contribute it (Yes/No):\r\n\r\nNo\r\n\r\n**Describe the feature and the current behavior/state.**\r\nUnable to implement complex weight sharing\r\n**Will this change the current api? How?**\r\nwill do\uff01Add the \"reuse\" parameter to tf.keras.layers.Conv2D()\r\n**Who will benefit with this feature?**\r\nEvery user\r\n**Any Other info.**\r\nWhy remove the \u2018reuse\u2019 parameter from tf.keras.layers.Conv2D(), or do you provide other ways to share weights? The algorithm implemented in 1.x is now not implemented in 2.0. If there is no better way to share weights, please let the \u2018reuse\u2019 parameter come back.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33808", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33808/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33808/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33808/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/33808", "id": 513720437, "node_id": "MDExOlB1bGxSZXF1ZXN0MzMzNDU1NjY4", "number": 33808, "title": "An implementation of eigendecomposition gradients", "user": {"login": "Randl", "id": 3028543, "node_id": "MDQ6VXNlcjMwMjg1NDM=", "avatar_url": "https://avatars0.githubusercontent.com/u/3028543?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Randl", "html_url": "https://github.com/Randl", "followers_url": "https://api.github.com/users/Randl/followers", "following_url": "https://api.github.com/users/Randl/following{/other_user}", "gists_url": "https://api.github.com/users/Randl/gists{/gist_id}", "starred_url": "https://api.github.com/users/Randl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Randl/subscriptions", "organizations_url": "https://api.github.com/users/Randl/orgs", "repos_url": "https://api.github.com/users/Randl/repos", "events_url": "https://api.github.com/users/Randl/events{/privacy}", "received_events_url": "https://api.github.com/users/Randl/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1169365494, "node_id": "MDU6TGFiZWwxMTY5MzY1NDk0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:M", "name": "size:M", "color": "adafea", "default": false, "description": "CL Change Size: Medium"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 26, "created_at": "2019-10-29T06:33:20Z", "updated_at": "2020-03-13T17:17:45Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/33808", "html_url": "https://github.com/tensorflow/tensorflow/pull/33808", "diff_url": "https://github.com/tensorflow/tensorflow/pull/33808.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/33808.patch"}, "body": "As for now, some tests yet failing, but I thought may be someone can help me by pointing out what my mistake is."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33802", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33802/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33802/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33802/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33802", "id": 513601844, "node_id": "MDU6SXNzdWU1MTM2MDE4NDQ=", "number": 33802, "title": "Pull Requests: Map needed for request workflow", "user": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "chanshah", "id": 47231178, "node_id": "MDQ6VXNlcjQ3MjMxMTc4", "avatar_url": "https://avatars3.githubusercontent.com/u/47231178?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chanshah", "html_url": "https://github.com/chanshah", "followers_url": "https://api.github.com/users/chanshah/followers", "following_url": "https://api.github.com/users/chanshah/following{/other_user}", "gists_url": "https://api.github.com/users/chanshah/gists{/gist_id}", "starred_url": "https://api.github.com/users/chanshah/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chanshah/subscriptions", "organizations_url": "https://api.github.com/users/chanshah/orgs", "repos_url": "https://api.github.com/users/chanshah/repos", "events_url": "https://api.github.com/users/chanshah/events{/privacy}", "received_events_url": "https://api.github.com/users/chanshah/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "chanshah", "id": 47231178, "node_id": "MDQ6VXNlcjQ3MjMxMTc4", "avatar_url": "https://avatars3.githubusercontent.com/u/47231178?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chanshah", "html_url": "https://github.com/chanshah", "followers_url": "https://api.github.com/users/chanshah/followers", "following_url": "https://api.github.com/users/chanshah/following{/other_user}", "gists_url": "https://api.github.com/users/chanshah/gists{/gist_id}", "starred_url": "https://api.github.com/users/chanshah/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chanshah/subscriptions", "organizations_url": "https://api.github.com/users/chanshah/orgs", "repos_url": "https://api.github.com/users/chanshah/repos", "events_url": "https://api.github.com/users/chanshah/events{/privacy}", "received_events_url": "https://api.github.com/users/chanshah/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-10-28T22:58:46Z", "updated_at": "2019-11-20T10:05:08Z", "closed_at": null, "author_association": "MEMBER", "body": "At the moment external contributors don't have any way of knowing what the lifecycle of a pull request is. We have [documentation on contributing code](https://www.tensorflow.org/community/contribute/code), but it's silent on the details of what happens to a request once it's been submitted. Chandni presented a fantastic flowchart at the contributor's summit today that would be a great foundation for documentation explaining the stages that a PR goes through.\r\n\r\nThis would help external contributors understand what they need to do to successfully submit code to the project, and combined with https://github.com/tensorflow/tensorflow/issues/33801 will give them the visibility they need to be effective TensorFlow developers.\r\n\r\n/cc @freddan80 @jenselofsson "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33801", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33801/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33801/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33801/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33801", "id": 513599444, "node_id": "MDU6SXNzdWU1MTM1OTk0NDQ=", "number": 33801, "title": "Pull Requests: Status information should be available", "user": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "chanshah", "id": 47231178, "node_id": "MDQ6VXNlcjQ3MjMxMTc4", "avatar_url": "https://avatars3.githubusercontent.com/u/47231178?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chanshah", "html_url": "https://github.com/chanshah", "followers_url": "https://api.github.com/users/chanshah/followers", "following_url": "https://api.github.com/users/chanshah/following{/other_user}", "gists_url": "https://api.github.com/users/chanshah/gists{/gist_id}", "starred_url": "https://api.github.com/users/chanshah/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chanshah/subscriptions", "organizations_url": "https://api.github.com/users/chanshah/orgs", "repos_url": "https://api.github.com/users/chanshah/repos", "events_url": "https://api.github.com/users/chanshah/events{/privacy}", "received_events_url": "https://api.github.com/users/chanshah/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "chanshah", "id": 47231178, "node_id": "MDQ6VXNlcjQ3MjMxMTc4", "avatar_url": "https://avatars3.githubusercontent.com/u/47231178?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chanshah", "html_url": "https://github.com/chanshah", "followers_url": "https://api.github.com/users/chanshah/followers", "following_url": "https://api.github.com/users/chanshah/following{/other_user}", "gists_url": "https://api.github.com/users/chanshah/gists{/gist_id}", "starred_url": "https://api.github.com/users/chanshah/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chanshah/subscriptions", "organizations_url": "https://api.github.com/users/chanshah/orgs", "repos_url": "https://api.github.com/users/chanshah/repos", "events_url": "https://api.github.com/users/chanshah/events{/privacy}", "received_events_url": "https://api.github.com/users/chanshah/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-10-28T22:51:05Z", "updated_at": "2019-11-07T21:20:35Z", "closed_at": null, "author_association": "MEMBER", "body": "There is currently no way to tell who needs to take the next action on a pull request, or what state a PR is in. This delays external contributions and frustrates developers. Here is the sort of information that is needed to enable efficient contributions:\r\n\r\n - Who needs to take action? Is it the contributor, a member of the gtech team, or a Google TensorFlow engineer? This should be clearly and publicly visible on the request, so that stakeholders can communicate with the responsible individual.\r\n\r\n - Where is the request in the approval workflow? We'll need a map of the stages involved, and a way to map the current state to each node in the graph.\r\n\r\nThere are other pieces of information that would be nice to have, but these are essential to shepherding contributions through our process.\r\n\r\n/cc @jenselofsson @freddan80"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33800", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33800/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33800/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33800/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33800", "id": 513596120, "node_id": "MDU6SXNzdWU1MTM1OTYxMjA=", "number": 33800, "title": "Pull Requests: Trusted committers should be able to approve", "user": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "chanshah", "id": 47231178, "node_id": "MDQ6VXNlcjQ3MjMxMTc4", "avatar_url": "https://avatars3.githubusercontent.com/u/47231178?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chanshah", "html_url": "https://github.com/chanshah", "followers_url": "https://api.github.com/users/chanshah/followers", "following_url": "https://api.github.com/users/chanshah/following{/other_user}", "gists_url": "https://api.github.com/users/chanshah/gists{/gist_id}", "starred_url": "https://api.github.com/users/chanshah/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chanshah/subscriptions", "organizations_url": "https://api.github.com/users/chanshah/orgs", "repos_url": "https://api.github.com/users/chanshah/repos", "events_url": "https://api.github.com/users/chanshah/events{/privacy}", "received_events_url": "https://api.github.com/users/chanshah/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "chanshah", "id": 47231178, "node_id": "MDQ6VXNlcjQ3MjMxMTc4", "avatar_url": "https://avatars3.githubusercontent.com/u/47231178?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chanshah", "html_url": "https://github.com/chanshah", "followers_url": "https://api.github.com/users/chanshah/followers", "following_url": "https://api.github.com/users/chanshah/following{/other_user}", "gists_url": "https://api.github.com/users/chanshah/gists{/gist_id}", "starred_url": "https://api.github.com/users/chanshah/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chanshah/subscriptions", "organizations_url": "https://api.github.com/users/chanshah/orgs", "repos_url": "https://api.github.com/users/chanshah/repos", "events_url": "https://api.github.com/users/chanshah/events{/privacy}", "received_events_url": "https://api.github.com/users/chanshah/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-10-28T22:41:00Z", "updated_at": "2019-11-07T21:21:21Z", "closed_at": null, "author_association": "MEMBER", "body": "@jenselofsson is a trusted external committer from Arm, but at least some of the PRs that he has approved have required an additional Google review on GitHub. I would expect that he would be able to review and approve pull requests. For an example, see PR https://github.com/tensorflow/tensorflow/pull/33420"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33794", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33794/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33794/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33794/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33794", "id": 513497835, "node_id": "MDU6SXNzdWU1MTM0OTc4MzU=", "number": 33794, "title": "[TF 2.0 API Docs] tf.keras.layers.simpleRNN", "user": {"login": "brorro", "id": 11650176, "node_id": "MDQ6VXNlcjExNjUwMTc2", "avatar_url": "https://avatars3.githubusercontent.com/u/11650176?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brorro", "html_url": "https://github.com/brorro", "followers_url": "https://api.github.com/users/brorro/followers", "following_url": "https://api.github.com/users/brorro/following{/other_user}", "gists_url": "https://api.github.com/users/brorro/gists{/gist_id}", "starred_url": "https://api.github.com/users/brorro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brorro/subscriptions", "organizations_url": "https://api.github.com/users/brorro/orgs", "repos_url": "https://api.github.com/users/brorro/repos", "events_url": "https://api.github.com/users/brorro/events{/privacy}", "received_events_url": "https://api.github.com/users/brorro/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "dynamicwebpaige", "id": 3712347, "node_id": "MDQ6VXNlcjM3MTIzNDc=", "avatar_url": "https://avatars2.githubusercontent.com/u/3712347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dynamicwebpaige", "html_url": "https://github.com/dynamicwebpaige", "followers_url": "https://api.github.com/users/dynamicwebpaige/followers", "following_url": "https://api.github.com/users/dynamicwebpaige/following{/other_user}", "gists_url": "https://api.github.com/users/dynamicwebpaige/gists{/gist_id}", "starred_url": "https://api.github.com/users/dynamicwebpaige/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dynamicwebpaige/subscriptions", "organizations_url": "https://api.github.com/users/dynamicwebpaige/orgs", "repos_url": "https://api.github.com/users/dynamicwebpaige/repos", "events_url": "https://api.github.com/users/dynamicwebpaige/events{/privacy}", "received_events_url": "https://api.github.com/users/dynamicwebpaige/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "dynamicwebpaige", "id": 3712347, "node_id": "MDQ6VXNlcjM3MTIzNDc=", "avatar_url": "https://avatars2.githubusercontent.com/u/3712347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dynamicwebpaige", "html_url": "https://github.com/dynamicwebpaige", "followers_url": "https://api.github.com/users/dynamicwebpaige/followers", "following_url": "https://api.github.com/users/dynamicwebpaige/following{/other_user}", "gists_url": "https://api.github.com/users/dynamicwebpaige/gists{/gist_id}", "starred_url": "https://api.github.com/users/dynamicwebpaige/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dynamicwebpaige/subscriptions", "organizations_url": "https://api.github.com/users/dynamicwebpaige/orgs", "repos_url": "https://api.github.com/users/dynamicwebpaige/repos", "events_url": "https://api.github.com/users/dynamicwebpaige/events{/privacy}", "received_events_url": "https://api.github.com/users/dynamicwebpaige/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-10-28T19:02:25Z", "updated_at": "2019-12-20T01:58:18Z", "closed_at": null, "author_association": "NONE", "body": "## URL(s) with the issue:\r\nhttps://www.tensorflow.org/versions/r2.0/api_docs/python/tf/keras/layers/SimpleRNN\r\n\r\n## Description of issue (what needs changing):\r\n\r\n### Clear description\r\n\r\nThe document mentions nothing about call argument `inputs` when it takes \r\n`[[batch, timesteps, feature], [batch, state]]`. In case of `inputs` is a list, the elements of `inputs[1:]` work as initial_state in each batch.\r\n\r\nExample)\r\n```\r\nimport tensorflow as tf\r\nfrom tensorflow.keras.layers import *\r\n\r\n\r\nclass foo(tf.keras.Model):\r\n    def __init__(self, rnn_units, dense_units, **kwargs):\r\n        super().__init__(**kwargs)\r\n        self.r1 = SimpleRNN(rnn_units)\r\n        self.r2 = SimpleRNN(rnn_units)\r\n        self.flat = tf.keras.layers.Flatten()\r\n        self.d1 = Dense(rnn_units)\r\n        self.d2 = Dense(dense_units)\r\n\r\n    def call(self, inputs, **kwargs):\r\n\r\n        x = self.r1(inputs)\r\n        state = self.d1(self.flat(x))\r\n        x = self.r2([inputs, state])\r\n        x = self.d2(x)\r\n\r\n        return x\r\n\r\n\r\ntrain_input = tf.random.normal(shape=(6, 5, 10))\r\ntrain_target = tf.random.normal(shape=(6, 8))\r\n\r\na = foo(10, 8)\r\na.compile(tf.keras.optimizers.SGD(0.01), loss=tf.keras.losses.MeanSquaredError())\r\na.fit(train_input, train_target)\r\n\r\n\r\nb = SimpleRNN(10)(train_input)\r\nstate = Dense(10)(tf.reshape(b, (tf.shape(b)[0], -1)))\r\nb = SimpleRNN(10)([train_input, state])\r\n```\r\n\r\nIt also should be noted that `initial_state` argument should be `None` when `inputs` has states.\r\nOther recurrent layers have same issue.\r\n\r\n### Submit a pull request?\r\nIf this issue was not intended or a bug,\r\nI'm planning to submit a pull request to fix the doc issue in a week. May i?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33793", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33793/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33793/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33793/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33793", "id": 513491727, "node_id": "MDU6SXNzdWU1MTM0OTE3Mjc=", "number": 33793, "title": "DenseFeatures always returns float32", "user": {"login": "piyueh", "id": 7220966, "node_id": "MDQ6VXNlcjcyMjA5NjY=", "avatar_url": "https://avatars1.githubusercontent.com/u/7220966?v=4", "gravatar_id": "", "url": "https://api.github.com/users/piyueh", "html_url": "https://github.com/piyueh", "followers_url": "https://api.github.com/users/piyueh/followers", "following_url": "https://api.github.com/users/piyueh/following{/other_user}", "gists_url": "https://api.github.com/users/piyueh/gists{/gist_id}", "starred_url": "https://api.github.com/users/piyueh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/piyueh/subscriptions", "organizations_url": "https://api.github.com/users/piyueh/orgs", "repos_url": "https://api.github.com/users/piyueh/repos", "events_url": "https://api.github.com/users/piyueh/events{/privacy}", "received_events_url": "https://api.github.com/users/piyueh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-10-28T18:50:07Z", "updated_at": "2019-11-28T06:23:58Z", "closed_at": null, "author_association": "NONE", "body": "(https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): 2.0.0\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\nCurrently, a call to `tf.keras.layers.DenseFeatures` returns `float32` no matter what.\r\nIt doesn't respect its own `dtype` (e.g., `DenseFeatures(..., dtype=tf.float64)`\r\nis not working). Using `tf.keras.backend.set_floatx('float64')` does not change\r\nthe behavior, either. It will be nice if a user can choose to return `float64`.\r\nOr at least respect the setting of `tf.keras.backend.set_floatx(...)`.\r\n\r\nThis behavior is not mentioned in the API documentation:\r\nhttps://www.tensorflow.org/api_docs/python/tf/keras/layers/DenseFeatures\r\n\r\nBut it is mentioned in the docstring of `DenseFeatures.call`:\r\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/feature_column/dense_features.py#L119-L122\r\n\r\nHere's a simple sample code:\r\n```\r\nimport numpy\r\nimport tensorflow as tf\r\n\r\nnumpy.set_printoptions(15)\r\n\r\ncolumns = [\r\n    tf.feature_column.numeric_column(\"a\", dtype=tf.float64),\r\n    tf.feature_column.numeric_column(\"b\", dtype=tf.float64)\r\n]\r\n\r\nlayer = tf.keras.layers.DenseFeatures(columns, dtype=tf.float64)\r\n\r\ndata = {\r\n    \"a\": tf.constant([1./3.], dtype=tf.float64),\r\n    \"b\": tf.constant([numpy.pi], dtype=tf.float64)\r\n}\r\n\r\nprint(\"\\n\"+\"-\"*80)\r\nprint(\"data[\\\"a\\\"]:\", data[\"a\"])\r\nprint(\"data[\\\"b\\\"]:\", data[\"b\"])\r\nprint(\"layer(data):\", layer(data))\r\nprint(\"-\"*80)\r\n```\r\n\r\nAnd the output:\r\n```\r\n--------------------------------------------------------------------------------\r\ndata[\"a\"]: tf.Tensor([0.333333333333333], shape=(1,), dtype=float64)\r\ndata[\"b\"]: tf.Tensor([3.141592653589793], shape=(1,), dtype=float64)\r\nlayer(data): tf.Tensor([[0.33333334 3.1415927 ]], shape=(1, 2), dtype=float32)\r\n--------------------------------------------------------------------------------\r\n```\r\n\r\n**Will this change the current api? How?**\r\n\r\nNo.\r\n\r\n**Who will benefit with this feature?**\r\n\r\nNot sure. But who ever uses `tf.keras.backend.set_floatx('float64')` will\r\nprobably be happy.\r\n\r\n**Any Other info.**\r\n\r\nN/A"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33791", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33791/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33791/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33791/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33791", "id": 513436116, "node_id": "MDU6SXNzdWU1MTM0MzYxMTY=", "number": 33791, "title": "tflite operators support dependent on tf.shape", "user": {"login": "DocDriven", "id": 30296124, "node_id": "MDQ6VXNlcjMwMjk2MTI0", "avatar_url": "https://avatars2.githubusercontent.com/u/30296124?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DocDriven", "html_url": "https://github.com/DocDriven", "followers_url": "https://api.github.com/users/DocDriven/followers", "following_url": "https://api.github.com/users/DocDriven/following{/other_user}", "gists_url": "https://api.github.com/users/DocDriven/gists{/gist_id}", "starred_url": "https://api.github.com/users/DocDriven/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DocDriven/subscriptions", "organizations_url": "https://api.github.com/users/DocDriven/orgs", "repos_url": "https://api.github.com/users/DocDriven/repos", "events_url": "https://api.github.com/users/DocDriven/events{/privacy}", "received_events_url": "https://api.github.com/users/DocDriven/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-10-28T17:04:55Z", "updated_at": "2019-10-29T10:18:23Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): docker images\r\n- TensorFlow version (use command below): 1.15.0-rc2 / 2.10.-dev20191027\r\n- Python version: 3.6\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\n**Describe the current behavior**\r\nI am trying to convert an variational autoencoder into a tflite model. During the process, I stumbled across a weird bug. When explicitly specifying the shape of the sampling layer like this: `tf.random.normal(shape=(10,))`, the model is convertible without any errors.\r\n\r\nBut in case of not hard-coding the shape into my model, e.g. by inferencing it from the input vector(s) like so:\r\n\r\n```\r\ndimension = tf.shape(z_mu)[1] #index 0 is batch size\r\neps = tf.random.normal(shape=(dim,))\r\n```\r\nI get the error that tf.random.normal is not supported by the TF Lite runtime:\r\n\r\n> Some of the operators in the model are not supported by the standard TensorFlow Lite runtime. If those are native TensorFlow operators, you might be able to use the extended runtime by passing --enable_select_tf_ops, or by setting target_ops=TFLITE_BUILTINS,SELECT_TF_OPS when calling tf.lite.TFLiteConverter(). Otherwise, if you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: ADD, EXP, FULLY_CONNECTED, LEAKY_RELU, LOG, MUL. Here is a list of operators for which you will need custom implementations: RandomStandardNormal.\r\n\r\n**Describe the expected behavior**\r\n\r\nIt doesn't make sense to me that the possibly buggy inference of a shape influences whether an OP is supported or not. Also, I am not sure if the hard-coded model can be trusted or not.\r\n\r\n**Code to reproduce the issue**\r\nJust set the EXPLICIT flag to False to get the error.\r\n```\r\nimport tensorflow as tf\r\nimport pandas as pd\r\nimport numpy as np\r\nfrom tensorflow import keras\r\n\r\nprint(tf.__version__)\r\n\r\nEXPLICIT = True\r\n\r\n### DATA\r\ntraining_data = np.random.rand(1000, 90)\r\ntrain_dataset = tf.data.Dataset.from_tensor_slices((training_data, training_data))\r\ntrain_dataset = train_dataset.shuffle(1000).batch(100)\r\n\r\n### MODEL\r\nx = keras.layers.Input(shape=(90,))\r\nh = keras.layers.Dense(40, activation=tf.nn.relu)(x)\r\nz_mu = keras.layers.Dense(10)(h)\r\nz_sigma = keras.layers.Dense(10, activation=tf.nn.sigmoid)(h)\r\n\r\n#########################################################################################\r\nif EXPLICIT:\r\n    eps = tf.random.normal(shape=(10,)) # this works\r\n\r\nelse:\r\n    batch_size = tf.shape(z_mu)[0]\r\n    dimension = tf.shape(z_mu)[1]\r\n    eps = tf.random.normal(shape=(batch_size, dimension)) # this does NOT work, also tried using shape=(dimension,)\r\n\r\n#########################################################################################\r\nz = z_mu + eps * z_sigma\r\n\r\nh_decoded = keras.layers.Dense(40, activation=tf.nn.relu)(z)\r\nx_decoded = keras.layers.Dense(90)(h_decoded)\r\n\r\nmodel = keras.models.Model(x, x_decoded)\r\n\r\n### LOSS\r\nrecon_err = tf.reduce_sum(tf.abs(x - x_decoded), axis=1)\r\nkl_div = -.5 * tf.reduce_sum(1 + 2 * tf.math.log(z_sigma) - tf.square(z_mu) - tf.square(z_sigma), axis=1)\r\ntotal_loss = tf.reduce_mean(recon_err + kl_div)\r\nmodel.add_loss(total_loss)\r\n\r\n### TRAINING\r\nmodel.compile(optimizer='adam')\r\nprint(model.summary())\r\nmodel.fit(train_dataset, epochs=5)\r\n\r\n### SAVE\r\nkeras_file = 'vae_test.h5'\r\nkeras.models.save_model(model, keras_file)\r\n\r\n### CONVERSION\r\ntest_dataset = np.random.rand(100, 90).astype(np.float32)\r\n\r\ndef representative_dataset_gen():\r\n    for i in range(100):\r\n        yield [test_dataset[i:i+1]]\r\n\r\nconverter = tf.compat.v1.lite.TFLiteConverter.from_keras_model_file(keras_file)\r\nconverter.representative_dataset = representative_dataset_gen\r\nconverter.target_spec.supported_ops = [tf.lite.OpsSet.TFLITE_BUILTINS_INT8]\r\nconverter.inference_input_type = tf.uint8\r\nconverter.inference_output_type = tf.uint8\r\nconverter.optimizations = [tf.lite.Optimize.DEFAULT]\r\n\r\ntflite_file_name = 'vae.tflite'\r\ntflite_model = converter.convert()\r\nopen(tflite_file_name, 'wb').write(tflite_model)\r\n\r\n```\r\nCan you confirm the strange behavior and whether tf.random.normal is implemented or not?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33790", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33790/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33790/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33790/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33790", "id": 513398964, "node_id": "MDU6SXNzdWU1MTMzOTg5NjQ=", "number": 33790, "title": "\"Beginner Hello World\" Warning: WARNING:tensorflow:Entity <function Function._initialize_uninitialized_variables.<locals>.initialize_variables at 0x000000002D8DAF28> could not be transformed and will be executed as-is. ", "user": {"login": "jramirezpr", "id": 25598546, "node_id": "MDQ6VXNlcjI1NTk4NTQ2", "avatar_url": "https://avatars2.githubusercontent.com/u/25598546?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jramirezpr", "html_url": "https://github.com/jramirezpr", "followers_url": "https://api.github.com/users/jramirezpr/followers", "following_url": "https://api.github.com/users/jramirezpr/following{/other_user}", "gists_url": "https://api.github.com/users/jramirezpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/jramirezpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jramirezpr/subscriptions", "organizations_url": "https://api.github.com/users/jramirezpr/orgs", "repos_url": "https://api.github.com/users/jramirezpr/repos", "events_url": "https://api.github.com/users/jramirezpr/events{/privacy}", "received_events_url": "https://api.github.com/users/jramirezpr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-10-28T16:00:39Z", "updated_at": "2019-10-30T09:55:32Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- Windows 7:\r\n- TensorFlow installed from: pip\r\n- TensorFlow version: 2.0.0 v2.0.0-rc2-26-g64c3d382ca'\r\n- Python version: 3.6.9\r\n- Installed using virtualenv? pip? conda?: pip\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\n\r\n\r\n**Describe the problem**\r\n\r\nGetting a warning after executing the \"Hello World\" example for beginners from https://www.tensorflow.org/overview/?hl=es. Code:\r\n```\r\nimport tensorflow as tf\r\ntf.autograph.set_verbosity(10)\r\n\r\nmnist = tf.keras.datasets.mnist\r\n\r\n(x_train, y_train),(x_test, y_test) = mnist.load_data()\r\nx_train, x_test = x_train / 255.0, x_test / 255.0\r\n\r\nmodel = tf.keras.models.Sequential([\r\n  tf.keras.layers.Flatten(input_shape=(28, 28)),\r\n  tf.keras.layers.Dense(128, activation='relu'),\r\n  tf.keras.layers.Dropout(0.2),\r\n  tf.keras.layers.Dense(10, activation='softmax')\r\n])\r\n\r\nmodel.compile(optimizer='adam',\r\n              loss='sparse_categorical_crossentropy',\r\n              metrics=['accuracy'])\r\n\r\nmodel.fit(x_train, y_train, epochs=5)\r\nmodel.evaluate(x_test, y_test)\r\n```\r\n\r\nThe initial message (without verbosity set to 10):\r\nINFO:tensorflow:Converted call: <function TensorLikeDataAdapter.__init__.<locals>.permutation at 0x000000002D042158>\r\n    args: (<tf.Tensor 'args_0:0' shape=() dtype=int64>,)\r\n    kwargs: {}\r\n\r\nINFO:tensorflow:Whitelisted: <function TensorLikeDataAdapter.__init__.<locals>.permutation at 0x000000002D042158>: DoNotConvert rule for tensorflow\r\nINFO:tensorflow:Converted call: <function TensorLikeDataAdapter.__init__.<locals>.slice_batch_indices at 0x0000000005166F28>\r\n    args: (<tf.Tensor 'args_0:0' shape=(60000,) dtype=int64>,)\r\n    kwargs: {}\r\n\r\nINFO:tensorflow:Whitelisted: <function TensorLikeDataAdapter.__init__.<locals>.slice_batch_indices at 0x0000000005166F28>: DoNotConvert rule for tensorflow\r\nINFO:tensorflow:Converted call: <function TensorLikeDataAdapter.__init__.<locals>.grab_batch at 0x000000002CD55730>\r\n    args: (<tf.Tensor 'args_0:0' shape=(32,) dtype=int64>, (<tf.Tensor 'args_1:0' shape=(60000, 28, 28) dtype=float64>, <tf.Tensor 'args_2:0' shape=(60000, 1) dtype=uint8>))\r\n    kwargs: {}\r\n\r\nINFO:tensorflow:Whitelisted: <function TensorLikeDataAdapter.__init__.<locals>.grab_batch at 0x000000002CD55730>: DoNotConvert rule for tensorflow\r\nTrain on 60000 samples\r\nINFO:tensorflow:Converted call: <function Function._initialize_uninitialized_variables.<locals>.initialize_variables at 0x000000002D8DAF28>\r\n    args: ()\r\n    kwargs: {}\r\n\r\nINFO:tensorflow:Cache hit for entity <function Function._initialize_uninitialized_variables.<locals>.initialize_variables at 0x000000002D8DAF28> key <code object initialize_variables at 0x00000000096CE6F0, file \"C:\\Users\\cenic\\Anaconda3\\envs\\tensorflow2env\\lib\\site-packages\\tensorflow_core\\python\\eager\\def_function.py\", line 603> subkey (<tensorflow.python.autograph.core.converter.ConversionOptions object at 0x000000002D4C2978>, frozenset({'initializer_map'})): _ConvertedEntityFactoryInfo(tf__initialize_variables in tmpupjy58ms)\r\nINFO:tensorflow:Error transforming entity <function Function._initialize_uninitialized_variables.<locals>.initialize_variables at 0x000000002D8DAF28>\r\nTraceback (most recent call last):\r\n  File \"C:\\Users\\cenic\\Anaconda3\\envs\\tensorflow2env\\lib\\site-packages\\tensorflow_core\\python\\autograph\\impl\\api.py\", line 506, in converted_call\r\n    converted_f = conversion.convert(target_entity, program_ctx)\r\n  File \"C:\\Users\\cenic\\Anaconda3\\envs\\tensorflow2env\\lib\\site-packages\\tensorflow_core\\python\\autograph\\impl\\conversion.py\", line 324, in convert\r\n    return _instantiate(entity, converted_entity_info, free_nonglobal_var_names)\r\n  File \"C:\\Users\\cenic\\Anaconda3\\envs\\tensorflow2env\\lib\\site-packages\\tensorflow_core\\python\\autograph\\impl\\conversion.py\", line 266, in _instantiate\r\n    factory = converted_entity_info.get_factory()\r\n  File \"C:\\Users\\cenic\\Anaconda3\\envs\\tensorflow2env\\lib\\site-packages\\tensorflow_core\\python\\autograph\\impl\\conversion.py\", line 92, in get_factory\r\n    assert self.module_name in sys.modules\r\nAssertionError\r\nWARNING:tensorflow:Entity <function Function._initialize_uninitialized_variables.<locals>.initialize_variables at 0x000000002D8DAF28> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: \r\n60000/60000 [==============================] - 3s 52us/sample - loss: 0.2937 - accuracy: 0.9152\r\n<tensorflow.python.keras.callbacks.History object at 0x000000002C5A0A20>\r\n\r\n\r\nThe console output with verbosity set to 10 looks as follows:\r\nINFO:tensorflow:Converted call: <function TensorLikeDataAdapter.__init__.<locals>.permutation at 0x000000002CD55510>\r\n    args: (<tf.Tensor 'args_0:0' shape=() dtype=int64>,)\r\n    kwargs: {}\r\n\r\nINFO:tensorflow:Whitelisted: <function TensorLikeDataAdapter.__init__.<locals>.permutation at 0x000000002CD55510>: DoNotConvert rule for tensorflow\r\nINFO:tensorflow:Converted call: <function TensorLikeDataAdapter.__init__.<locals>.slice_batch_indices at 0x000000002CD55950>\r\n    args: (<tf.Tensor 'args_0:0' shape=(60000,) dtype=int64>,)\r\n    kwargs: {}\r\n\r\nINFO:tensorflow:Whitelisted: <function TensorLikeDataAdapter.__init__.<locals>.slice_batch_indices at 0x000000002CD55950>: DoNotConvert rule for tensorflow\r\nINFO:tensorflow:Converted call: <function TensorLikeDataAdapter.__init__.<locals>.grab_batch at 0x000000002CD55B70>\r\n    args: (<tf.Tensor 'args_0:0' shape=(32,) dtype=int64>, (<tf.Tensor 'args_1:0' shape=(60000, 28, 28) dtype=float64>, <tf.Tensor 'args_2:0' shape=(60000, 1) dtype=uint8>))\r\n    kwargs: {}\r\n\r\nINFO:tensorflow:Whitelisted: <function TensorLikeDataAdapter.__init__.<locals>.grab_batch at 0x000000002CD55B70>: DoNotConvert rule for tensorflow\r\nTrain on 60000 samples\r\nINFO:tensorflow:Converted call: <function Function._initialize_uninitialized_variables.<locals>.initialize_variables at 0x000000002D0428C8>\r\n    args: ()\r\n    kwargs: {}\r\n\r\nINFO:tensorflow:Entity <function Function._initialize_uninitialized_variables.<locals>.initialize_variables at 0x000000002D0428C8> is not cached for key <code object initialize_variables at 0x00000000096CE6F0, file \"C:\\Users\\cenic\\Anaconda3\\envs\\tensorflow2env\\lib\\site-packages\\tensorflow_core\\python\\eager\\def_function.py\", line 603> subkey (<tensorflow.python.autograph.core.converter.ConversionOptions object at 0x000000002D866FD0>, frozenset({'initializer_map'}))\r\nINFO:tensorflow:Converting <function Function._initialize_uninitialized_variables.<locals>.initialize_variables at 0x000000002D0428C8>\r\nINFO:tensorflow:Source code of <function Function._initialize_uninitialized_variables.<locals>.initialize_variables at 0x000000002D0428C8>:\r\n\r\nfrom __future__ import absolute_import\r\nfrom __future__ import division\r\nfrom __future__ import print_function\r\n@function_lib.defun\r\ndef initialize_variables():\r\n  op_map = object_identity.ObjectIdentityDictionary()\r\n  for v, init in initializer_map.items():\r\n    with ops.init_scope():\r\n      if resource_variable_ops.var_is_initialized_op(v.handle):\r\n        # Ignore variables which are already initialized at trace time.\r\n        continue\r\n    op_map = lift_to_graph.lift_to_graph(\r\n        [init], ops.get_default_graph(), op_map=op_map)\r\n    v.assign(op_map[init])\r\n\r\n\r\nINFO:tensorflow:Compiled output of <function Function._initialize_uninitialized_variables.<locals>.initialize_variables at 0x000000002D0428C8>:\r\n\r\n# coding=utf-8\r\ndef tf__initialize_variables():\r\n  with ag__.FunctionScope('initialize_variables', 'initialize_variables_scope', ag__.ConversionOptions(recursive=True, user_requested=True, optional_features=(), internal_convert_user_code=True)) as initialize_variables_scope:\r\n    op_map = ag__.converted_call(object_identity.ObjectIdentityDictionary, initialize_variables_scope.callopts, (), None, initialize_variables_scope)\r\n\r\n    def get_state_2():\r\n      return ()\r\n\r\n    def set_state_2(_):\r\n      pass\r\n\r\n    def loop_body(iterates, op_map):\r\n      v, init = iterates\r\n      continue_ = False\r\n      with ops.init_scope():\r\n\r\n        def get_state():\r\n          return ()\r\n\r\n        def set_state(_):\r\n          pass\r\n\r\n        def if_true():\r\n          continue_ = True\r\n          return continue_\r\n\r\n        def if_false():\r\n          return continue_\r\n        cond = ag__.converted_call(resource_variable_ops.var_is_initialized_op, initialize_variables_scope.callopts, (v.handle,), None, initialize_variables_scope)\r\n        continue_ = ag__.if_stmt(cond, if_true, if_false, get_state, set_state, ('continue_',), ())\r\n\r\n      def get_state_1():\r\n        return ()\r\n\r\n      def set_state_1(_):\r\n        pass\r\n\r\n      def if_true_1():\r\n        op_map_1, = op_map,\r\n        op_map_1 = ag__.converted_call(lift_to_graph.lift_to_graph, initialize_variables_scope.callopts, ([init], ag__.converted_call(ops.get_default_graph, initialize_variables_scope.callopts, (), None, initialize_variables_scope)), {'op_map': op_map_1}, initialize_variables_scope)\r\n        ag__.converted_call(v.assign, initialize_variables_scope.callopts, (op_map_1[init],), None, initialize_variables_scope)\r\n        return op_map_1\r\n\r\n      def if_false_1():\r\n        return op_map\r\n      cond_1 = ag__.not_(continue_)\r\n      op_map = ag__.if_stmt(cond_1, if_true_1, if_false_1, get_state_1, set_state_1, ('op_map',), ())\r\n      return op_map,\r\n    op_map, = ag__.for_stmt(ag__.converted_call(initializer_map.items, initialize_variables_scope.callopts, (), None, initialize_variables_scope), None, loop_body, get_state_2, set_state_2, (op_map,), ('op_map',), ())\r\n\r\n\r\nINFO:tensorflow:Compiled AST of <function Function._initialize_uninitialized_variables.<locals>.initialize_variables at 0x000000002D0428C8>:\r\n\r\nFunctionDef:\r\n| name=u\"tf__initialize_variables\"\r\n| args=arguments:\r\n| | args=[]\r\n| | vararg=None\r\n| | kwonlyargs=[]\r\n| | kw_defaults=[]\r\n| | kwarg=None\r\n| | defaults=[]\r\n| | ___pyct_anno={SCOPE: Scope{r=(), w=()}}\r\n| body=[\r\n| | With:\r\n| | | items=[\r\n| | | | withitem:\r\n| | | | | context_expr=Call:\r\n| | | | | | func=Attribute:\r\n| | | | | | | value=Name:\r\n| | | | | | | | id=u\"ag__\"\r\n| | | | | | | | ctx=Load()\r\n| | | | | | | | annotation=None\r\n| | | | | | | | ___pyct_anno={QN: ag__, DEFINITIONS: (), 'static_value': <module 'tensorflow.python.autograph.operators' from 'C:\\\\Users\\\\cenic\\\\Anaconda3\\\\envs\\\\tensorflow2env\\\\lib\\\\site-packages\\\\tensorflow_core\\\\python\\\\autograph\\\\operators\\\\__init__.py'>}\r\n| | | | | | | attr=u\"FunctionScope\"\r\n| | | | | | | ctx=Load()\r\n| | | | | | | ___pyct_anno={QN: ag__.FunctionScope, 'static_value': <class 'tensorflow.python.autograph.core.function_wrappers.FunctionScope'>}\r\n| | | | | | args=[\r\n| | | | | | | Str:\r\n| | | | | | | | s=u\"initialize_variables\"\r\n| | | | | | | Str:\r\n| | | | | | | | s=u\"initialize_variables_scope\"\r\n| | | | | | | Call:\r\n| | | | | | | | func=Attribute:\r\n| | | | | | | | | value=Name:\r\n| | | | | | | | | | id=u\"ag__\"\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | annotation=None\r\n| | | | | | | | | | ___pyct_anno={QN: ag__, DEFINITIONS: (), 'static_value': <module 'tensorflow.python.autograph.operators' from 'C:\\\\Users\\\\cenic\\\\Anaconda3\\\\envs\\\\tensorflow2env\\\\lib\\\\site-packages\\\\tensorflow_core\\\\python\\\\autograph\\\\operators\\\\__init__.py'>}\r\n| | | | | | | | | attr=u\"ConversionOptions\"\r\n| | | | | | | | | ctx=Load()\r\n| | | | | | | | | ___pyct_anno={QN: ag__.ConversionOptions, 'static_value': <class 'tensorflow.python.autograph.core.converter.ConversionOptions'>}\r\n| | | | | | | | args=[]\r\n| | | | | | | | keywords=[\r\n| | | | | | | | | keyword:\r\n| | | | | | | | | | arg=u\"recursive\"\r\n| | | | | | | | | | value=NameConstant:\r\n| | | | | | | | | | | value=True\r\n| | | | | | | | | keyword:\r\n| | | | | | | | | | arg=u\"user_requested\"\r\n| | | | | | | | | | value=NameConstant:\r\n| | | | | | | | | | | value=True\r\n| | | | | | | | | keyword:\r\n| | | | | | | | | | arg=u\"optional_features\"\r\n| | | | | | | | | | value=Tuple:\r\n| | | | | | | | | | | elts=[]\r\n| | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | keyword:\r\n| | | | | | | | | | arg=u\"internal_convert_user_code\"\r\n| | | | | | | | | | value=NameConstant:\r\n| | | | | | | | | | | value=True\r\n| | | | | | | | ]\r\n| | | | | | | | ___pyct_anno={ARGS_SCOPE: Scope{r=(), w=()}}\r\n| | | | | | ]\r\n| | | | | | keywords=[]\r\n| | | | | | ___pyct_anno={ARGS_SCOPE: Scope{r=(ag__, ag__.ConversionOptions), w=()}}\r\n| | | | | optional_vars=Name:\r\n| | | | | | id=u\"initialize_variables_scope\"\r\n| | | | | | ctx=Store()\r\n| | | | | | annotation=None\r\n| | | | | | ___pyct_anno={QN: initialize_variables_scope, DEFINITIONS: (AnnotatedDef[766997784],)}\r\n| | | | | ___pyct_anno={SCOPE: Scope{r=(ag__, ag__.FunctionScope, ag__.ConversionOptions), w=(initialize_variables_scope,)}}\r\n| | | ]\r\n| | | body=[\r\n| | | | Assign:\r\n| | | | | targets=[\r\n| | | | | | Name:\r\n| | | | | | | id=u\"op_map\"\r\n| | | | | | | ctx=Store()\r\n| | | | | | | annotation=None\r\n| | | | | | | ___pyct_anno={ORIG_DEFINITIONS: (AnnotatedDef[764323152],), ORIGIN: def_function.py:605:6, QN: op_map, DEFINITIONS: (AnnotatedDef[766997112],)}\r\n| | | | | ]\r\n| | | | | value=Call:\r\n| | | | | | func=Attribute:\r\n| | | | | | | value=Name:\r\n| | | | | | | | id=u\"ag__\"\r\n| | | | | | | | ctx=Load()\r\n| | | | | | | | annotation=None\r\n| | | | | | | | ___pyct_anno={QN: ag__, DEFINITIONS: ()}\r\n| | | | | | | attr=u\"converted_call\"\r\n| | | | | | | ctx=Load()\r\n| | | | | | | ___pyct_anno={QN: ag__.converted_call}\r\n| | | | | | args=[\r\n| | | | | | | Attribute:\r\n| | | | | | | | value=Name:\r\n| | | | | | | | | id=u\"object_identity\"\r\n| | | | | | | | | ctx=Load()\r\n| | | | | | | | | annotation=None\r\n| | | | | | | | | ___pyct_anno={ORIG_DEFINITIONS: (), ORIGIN: def_function.py:605:15, QN: object_identity, DEFINITIONS: ()}\r\n| | | | | | | | attr=u\"ObjectIdentityDictionary\"\r\n| | | | | | | | ctx=Load()\r\n| | | | | | | | ___pyct_anno={ORIGIN: def_function.py:605:15, QN: object_identity.ObjectIdentityDictionary}\r\n| | | | | | | Attribute:\r\n| | | | | | | | value=Name:\r\n| | | | | | | | | id=u\"initialize_variables_scope\"\r\n| | | | | | | | | ctx=Load()\r\n| | | | | | | | | annotation=None\r\n| | | | | | | | | ___pyct_anno={QN: initialize_variables_scope, DEFINITIONS: (AnnotatedDef[766997784],)}\r\n| | | | | | | | attr=u\"callopts\"\r\n| | | | | | | | ctx=Load()\r\n| | | | | | | | ___pyct_anno={QN: initialize_variables_scope.callopts}\r\n| | | | | | | Tuple:\r\n| | | | | | | | elts=[]\r\n| | | | | | | | ctx=Load()\r\n| | | | | | | NameConstant:\r\n| | | | | | | | value=None\r\n| | | | | | | Name:\r\n| | | | | | | | id=u\"initialize_variables_scope\"\r\n| | | | | | | | ctx=Load()\r\n| | | | | | | | annotation=None\r\n| | | | | | | | ___pyct_anno={QN: initialize_variables_scope, DEFINITIONS: (AnnotatedDef[766997784],)}\r\n| | | | | | ]\r\n| | | | | | keywords=[]\r\n| | | | | | ___pyct_anno={ORIGIN: def_function.py:605:15, ARGS_SCOPE: Scope{r=(initialize_variables_scope.callopts, object_identity, object_identity.ObjectIdentityDictionary, initialize_variables_scope), w=()}}\r\n| | | | | ___pyct_anno={ORIGIN: def_function.py:605:6, SCOPE: Scope{r=(object_identity.ObjectIdentityDictionary, ag__, object_identity, initialize_variables_scope, ag__.converted_call, initialize_variables_scope.callopts), w=(op_map,)}, LIVE_VARS_IN: frozenset({ops, object_identity.ObjectIdentityDictionary, object_identity, ops.init_scope, ag__.for_stmt, initializer_map, resource_variable_ops.var_is_initialized_op, initializer_map.items, initialize_variables_scope.callopts, op_map_1[init], ops.get_default_graph, ag__.not_, lift_to_graph.lift_to_graph, ag__, lift_to_graph, resource_variable_ops, ag__.if_stmt, initialize_variables_scope, ag__.converted_call, v.handle, v.assign})}\r\n| | | | FunctionDef:\r\n| | | | | name=u\"get_state_2\"\r\n| | | | | args=arguments:\r\n| | | | | | args=[]\r\n| | | | | | vararg=None\r\n| | | | | | kwonlyargs=[]\r\n| | | | | | kw_defaults=[]\r\n| | | | | | kwarg=None\r\n| | | | | | defaults=[]\r\n| | | | | | ___pyct_anno={SCOPE: Scope{r=(), w=()}}\r\n| | | | | body=[\r\n| | | | | | Return:\r\n| | | | | | | value=Tuple:\r\n| | | | | | | | elts=[]\r\n| | | | | | | | ctx=Load()\r\n| | | | | | | ___pyct_anno={SCOPE: Scope{r=(), w=()}, LIVE_VARS_IN: frozenset()}\r\n| | | | | ]\r\n| | | | | decorator_list=[]\r\n| | | | | returns=None\r\n| | | | | ___pyct_anno={ORIGIN: def_function.py:606:6, SCOPE: Scope{r=(), w=(get_state_2,)}, BODY_SCOPE: Scope{r=(), w=()}, LIVE_VARS_IN: frozenset({ops, ops.init_scope, ag__.for_stmt, initializer_map, resource_variable_ops.var_is_initialized_op, initializer_map.items, initialize_variables_scope.callopts, op_map_1[init], ops.get_default_graph, ag__.not_, lift_to_graph.lift_to_graph, ag__, lift_to_graph, resource_variable_ops, ag__.if_stmt, initialize_variables_scope, op_map, ag__.converted_call, v.handle, v.assign})}\r\n| | | | FunctionDef:\r\n| | | | | name=u\"set_state_2\"\r\n| | | | | args=arguments:\r\n| | | | | | args=[\r\n| | | | | | | Name:\r\n| | | | | | | | id=u\"_\"\r\n| | | | | | | | ctx=Param()\r\n| | | | | | | | annotation=None\r\n| | | | | | | | ___pyct_anno={QN: _, DEFINITIONS: (AnnotatedDef[767224408],)}\r\n| | | | | | ]\r\n| | | | | | vararg=None\r\n| | | | | | kwonlyargs=[]\r\n| | | | | | kw_defaults=[]\r\n| | | | | | kwarg=None\r\n| | | | | | defaults=[]\r\n| | | | | | ___pyct_anno={SCOPE: Scope{r=(), w=(_,)}}\r\n| | | | | body=[\r\n| | | | | | Pass:\r\n| | | | | | | ___pyct_anno={LIVE_VARS_IN: frozenset()}\r\n| | | | | ]\r\n| | | | | decorator_list=[]\r\n| | | | | returns=None\r\n| | | | | ___pyct_anno={ORIGIN: def_function.py:606:6, SCOPE: Scope{r=(), w=(set_state_2,)}, BODY_SCOPE: Scope{r=(), w=()}, LIVE_VARS_IN: frozenset({ops, ag__.converted_call, ops.init_scope, ag__.for_stmt, initializer_map, resource_variable_ops.var_is_initialized_op, initializer_map.items, initialize_variables_scope.callopts, op_map_1[init], ops.get_default_graph, ag__.not_, lift_to_graph.lift_to_graph, get_state_2, ag__, resource_variable_ops, ag__.if_stmt, initialize_variables_scope, op_map, lift_to_graph, v.handle, v.assign})}\r\n| | | | FunctionDef:\r\n| | | | | name=u\"loop_body\"\r\n| | | | | args=arguments:\r\n| | | | | | args=[\r\n| | | | | | | Name:\r\n| | | | | | | | id=u\"iterates\"\r\n| | | | | | | | ctx=Param()\r\n| | | | | | | | annotation=None\r\n| | | | | | | | ___pyct_anno={QN: iterates, DEFINITIONS: (AnnotatedDef[764742904],)}\r\n| | | | | | | Name:\r\n| | | | | | | | id=u\"op_map\"\r\n| | | | | | | | ctx=Param()\r\n| | | | | | | | annotation=None\r\n| | | | | | | | ___pyct_anno={QN: op_map, DEFINITIONS: (AnnotatedDef[764739824],)}\r\n| | | | | | ]\r\n| | | | | | vararg=None\r\n| | | | | | kwonlyargs=[]\r\n| | | | | | kw_defaults=[]\r\n| | | | | | kwarg=None\r\n| | | | | | defaults=[]\r\n| | | | | | ___pyct_anno={SCOPE: Scope{r=(), w=(op_map, iterates)}}\r\n| | | | | body=[\r\n| | | | | | Assign:\r\n| | | | | | | targets=[\r\n| | | | | | | | Tuple:\r\n| | | | | | | | | elts=[\r\n| | | | | | | | | | Name:\r\n| | | | | | | | | | | id=u\"v\"\r\n| | | | | | | | | | | ctx=Store()\r\n| | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | ___pyct_anno={ORIG_DEFINITIONS: (AnnotatedDef[764329320],), ORIGIN: def_function.py:606:10, QN: v, DEFINITIONS: (AnnotatedDef[764562792],)}\r\n| | | | | | | | | | Name:\r\n| | | | | | | | | | | id=u\"init\"\r\n| | | | | | | | | | | ctx=Store()\r\n| | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | ___pyct_anno={ORIG_DEFINITIONS: (AnnotatedDef[764323320],), ORIGIN: def_function.py:606:13, QN: init, DEFINITIONS: (AnnotatedDef[767225528],)}\r\n| | | | | | | | | ]\r\n| | | | | | | | | ctx=Store()\r\n| | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:606:10}\r\n| | | | | | | ]\r\n| | | | | | | value=Name:\r\n| | | | | | | | id=u\"iterates\"\r\n| | | | | | | | ctx=Load()\r\n| | | | | | | | annotation=None\r\n| | | | | | | | ___pyct_anno={QN: iterates, DEFINITIONS: (AnnotatedDef[764742904],)}\r\n| | | | | | | ___pyct_anno={SCOPE: Scope{r=(iterates,), w=(init, v)}, LIVE_VARS_IN: frozenset({ops, ag__.converted_call, ops.init_scope, resource_variable_ops.var_is_initialized_op, initialize_variables_scope.callopts, op_map_1[init], ops.get_default_graph, ag__.not_, lift_to_graph.lift_to_graph, ag__, resource_variable_ops, ag__.if_stmt, initialize_variables_scope, op_map, lift_to_graph, v.handle, v.assign, iterates})}\r\n| | | | | | Assign:\r\n| | | | | | | targets=[\r\n| | | | | | | | Name:\r\n| | | | | | | | | id=u\"continue_\"\r\n| | | | | | | | | ctx=Store()\r\n| | | | | | | | | annotation=None\r\n| | | | | | | | | ___pyct_anno={QN: continue_, DEFINITIONS: (AnnotatedDef[767225360],)}\r\n| | | | | | | ]\r\n| | | | | | | value=NameConstant:\r\n| | | | | | | | value=False\r\n| | | | | | | ___pyct_anno={SCOPE: Scope{r=(), w=(continue_,)}, LIVE_VARS_IN: frozenset({ops, ops.init_scope, resource_variable_ops.var_is_initialized_op, init, initialize_variables_scope.callopts, op_map_1[init], ops.get_default_graph, ag__.not_, lift_to_graph.lift_to_graph, ag__, lift_to_graph, resource_variable_ops, ag__.if_stmt, v, initialize_variables_scope, op_map, ag__.converted_call, v.handle, v.assign})}\r\n| | | | | | With:\r\n| | | | | | | items=[\r\n| | | | | | | | withitem:\r\n| | | | | | | | | context_expr=Call:\r\n| | | | | | | | | | func=Attribute:\r\n| | | | | | | | | | | value=Name:\r\n| | | | | | | | | | | | id=u\"ops\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | ___pyct_anno={ORIG_DEFINITIONS: (), ORIGIN: def_function.py:607:13, QN: ops, DEFINITIONS: ()}\r\n| | | | | | | | | | | attr=u\"init_scope\"\r\n| | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:607:13, QN: ops.init_scope}\r\n| | | | | | | | | | args=[]\r\n| | | | | | | | | | keywords=[]\r\n| | | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:607:13, ARGS_SCOPE: Scope{r=(), w=()}}\r\n| | | | | | | | | optional_vars=None\r\n| | | | | | | | | ___pyct_anno={SCOPE: Scope{r=(ops, ops.init_scope), w=()}}\r\n| | | | | | | ]\r\n| | | | | | | body=[\r\n| | | | | | | | FunctionDef:\r\n| | | | | | | | | name=u\"get_state\"\r\n| | | | | | | | | args=arguments:\r\n| | | | | | | | | | args=[]\r\n| | | | | | | | | | vararg=None\r\n| | | | | | | | | | kwonlyargs=[]\r\n| | | | | | | | | | kw_defaults=[]\r\n| | | | | | | | | | kwarg=None\r\n| | | | | | | | | | defaults=[]\r\n| | | | | | | | | | ___pyct_anno={SCOPE: Scope{r=(), w=()}}\r\n| | | | | | | | | body=[\r\n| | | | | | | | | | Return:\r\n| | | | | | | | | | | value=Tuple:\r\n| | | | | | | | | | | | elts=[]\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | ___pyct_anno={SCOPE: Scope{r=(), w=()}, LIVE_VARS_IN: frozenset()}\r\n| | | | | | | | | ]\r\n| | | | | | | | | decorator_list=[]\r\n| | | | | | | | | returns=None\r\n| | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:608:10, SCOPE: Scope{r=(), w=(get_state,)}, BODY_SCOPE: Scope{r=(), w=()}, LIVE_VARS_IN: frozenset({ops, resource_variable_ops.var_is_initialized_op, init, initialize_variables_scope.callopts, op_map_1[init], ops.get_default_graph, ag__.not_, lift_to_graph.lift_to_graph, ag__, lift_to_graph, resource_variable_ops, ag__.if_stmt, v, initialize_variables_scope, op_map, ag__.converted_call, continue_, v.handle, v.assign})}\r\n| | | | | | | | FunctionDef:\r\n| | | | | | | | | name=u\"set_state\"\r\n| | | | | | | | | args=arguments:\r\n| | | | | | | | | | args=[\r\n| | | | | | | | | | | Name:\r\n| | | | | | | | | | | | id=u\"_\"\r\n| | | | | | | | | | | | ctx=Param()\r\n| | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | ___pyct_anno={QN: _, DEFINITIONS: (AnnotatedDef[764743464],)}\r\n| | | | | | | | | | ]\r\n| | | | | | | | | | vararg=None\r\n| | | | | | | | | | kwonlyargs=[]\r\n| | | | | | | | | | kw_defaults=[]\r\n| | | | | | | | | | kwarg=None\r\n| | | | | | | | | | defaults=[]\r\n| | | | | | | | | | ___pyct_anno={SCOPE: Scope{r=(), w=(_,)}}\r\n| | | | | | | | | body=[\r\n| | | | | | | | | | Pass:\r\n| | | | | | | | | | | ___pyct_anno={LIVE_VARS_IN: frozenset()}\r\n| | | | | | | | | ]\r\n| | | | | | | | | decorator_list=[]\r\n| | | | | | | | | returns=None\r\n| | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:608:10, SCOPE: Scope{r=(), w=(set_state,)}, BODY_SCOPE: Scope{r=(), w=()}, LIVE_VARS_IN: frozenset({ops, ag__.converted_call, resource_variable_ops.var_is_initialized_op, init, initialize_variables_scope.callopts, op_map_1[init], ops.get_default_graph, ag__.not_, lift_to_graph.lift_to_graph, ag__, resource_variable_ops, ag__.if_stmt, v, initialize_variables_scope, op_map, lift_to_graph, continue_, get_state, v.handle, v.assign})}\r\n| | | | | | | | FunctionDef:\r\n| | | | | | | | | name=u\"if_true\"\r\n| | | | | | | | | args=arguments:\r\n| | | | | | | | | | args=[]\r\n| | | | | | | | | | vararg=None\r\n| | | | | | | | | | kwonlyargs=[]\r\n| | | | | | | | | | kw_defaults=[]\r\n| | | | | | | | | | kwarg=None\r\n| | | | | | | | | | defaults=[]\r\n| | | | | | | | | | ___pyct_anno={SCOPE: Scope{r=(), w=()}}\r\n| | | | | | | | | body=[\r\n| | | | | | | | | | Assign:\r\n| | | | | | | | | | | targets=[\r\n| | | | | | | | | | | | Name:\r\n| | | | | | | | | | | | | id=u\"continue_\"\r\n| | | | | | | | | | | | | ctx=Store()\r\n| | | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | | ___pyct_anno={QN: continue_, DEFINITIONS: (AnnotatedDef[764740216],)}\r\n| | | | | | | | | | | ]\r\n| | | | | | | | | | | value=NameConstant:\r\n| | | | | | | | | | | | value=True\r\n| | | | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:610:12, SCOPE: Scope{r=(), w=(continue_,)}, LIVE_VARS_IN: frozenset()}\r\n| | | | | | | | | | Return:\r\n| | | | | | | | | | | value=Name:\r\n| | | | | | | | | | | | id=u\"continue_\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | ___pyct_anno={QN: continue_, DEFINITIONS: (AnnotatedDef[764740216],)}\r\n| | | | | | | | | | | ___pyct_anno={SCOPE: Scope{r=(continue_,), w=()}, LIVE_VARS_IN: frozenset({continue_})}\r\n| | | | | | | | | ]\r\n| | | | | | | | | decorator_list=[]\r\n| | | | | | | | | returns=None\r\n| | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:608:10, SCOPE: Scope{r=(), w=(if_true,)}, BODY_SCOPE: Scope{r=(continue_,), w=(continue_,)}, LIVE_VARS_IN: frozenset({ops, resource_variable_ops.var_is_initialized_op, init, initialize_variables_scope.callopts, op_map_1[init], ops.get_default_graph, ag__.not_, lift_to_graph.lift_to_graph, ag__, lift_to_graph, resource_variable_ops, ag__.if_stmt, v, initialize_variables_scope, op_map, ag__.converted_call, continue_, set_state, v.handle, v.assign, get_state})}\r\n| | | | | | | | FunctionDef:\r\n| | | | | | | | | name=u\"if_false\"\r\n| | | | | | | | | args=arguments:\r\n| | | | | | | | | | args=[]\r\n| | | | | | | | | | vararg=None\r\n| | | | | | | | | | kwonlyargs=[]\r\n| | | | | | | | | | kw_defaults=[]\r\n| | | | | | | | | | kwarg=None\r\n| | | | | | | | | | defaults=[]\r\n| | | | | | | | | | ___pyct_anno={SCOPE: Scope{r=(), w=()}}\r\n| | | | | | | | | body=[\r\n| | | | | | | | | | Return:\r\n| | | | | | | | | | | value=Name:\r\n| | | | | | | | | | | | id=u\"continue_\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | ___pyct_anno={QN: continue_, DEFINITIONS: (AnnotatedDef[767225360],)}\r\n| | | | | | | | | | | ___pyct_anno={SCOPE: Scope{r=(continue_,), w=()}, LIVE_VARS_IN: frozenset({continue_})}\r\n| | | | | | | | | ]\r\n| | | | | | | | | decorator_list=[]\r\n| | | | | | | | | returns=None\r\n| | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:608:10, SCOPE: Scope{r=(), w=(if_false,)}, BODY_SCOPE: Scope{r=(continue_,), w=()}, LIVE_VARS_IN: frozenset({ops, ag__.converted_call, resource_variable_ops.var_is_initialized_op, init, initialize_variables_scope.callopts, op_map_1[init], ops.get_default_graph, if_true, ag__.not_, lift_to_graph.lift_to_graph, ag__, resource_variable_ops, ag__.if_stmt, v, initialize_variables_scope, op_map, lift_to_graph, continue_, set_state, v.handle, v.assign, get_state})}\r\n| | | | | | | | Assign:\r\n| | | | | | | | | targets=[\r\n| | | | | | | | | | Name:\r\n| | | | | | | | | | | id=u\"cond\"\r\n| | | | | | | | | | | ctx=Store()\r\n| | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | ___pyct_anno={QN: cond, DEFINITIONS: (AnnotatedDef[767225416],)}\r\n| | | | | | | | | ]\r\n| | | | | | | | | value=Call:\r\n| | | | | | | | | | func=Attribute:\r\n| | | | | | | | | | | value=Name:\r\n| | | | | | | | | | | | id=u\"ag__\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | ___pyct_anno={QN: ag__, DEFINITIONS: ()}\r\n| | | | | | | | | | | attr=u\"converted_call\"\r\n| | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | ___pyct_anno={QN: ag__.converted_call}\r\n| | | | | | | | | | args=[\r\n| | | | | | | | | | | Attribute:\r\n| | | | | | | | | | | | value=Name:\r\n| | | | | | | | | | | | | id=u\"resource_variable_ops\"\r\n| | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | | ___pyct_anno={ORIG_DEFINITIONS: (), ORIGIN: def_function.py:608:13, QN: resource_variable_ops, DEFINITIONS: ()}\r\n| | | | | | | | | | | | attr=u\"var_is_initialized_op\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:608:13, QN: resource_variable_ops.var_is_initialized_op}\r\n| | | | | | | | | | | Attribute:\r\n| | | | | | | | | | | | value=Name:\r\n| | | | | | | | | | | | | id=u\"initialize_variables_scope\"\r\n| | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | | ___pyct_anno={QN: initialize_variables_scope, DEFINITIONS: (AnnotatedDef[766997784],)}\r\n| | | | | | | | | | | | attr=u\"callopts\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | ___pyct_anno={QN: initialize_variables_scope.callopts}\r\n| | | | | | | | | | | Tuple:\r\n| | | | | | | | | | | | elts=[\r\n| | | | | | | | | | | | | Attribute:\r\n| | | | | | | | | | | | | | value=Name:\r\n| | | | | | | | | | | | | | | id=u\"v\"\r\n| | | | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | | | | ___pyct_anno={ORIG_DEFINITIONS: (AnnotatedDef[764329320],), ORIGIN: def_function.py:608:57, QN: v, DEFINITIONS: (AnnotatedDef[764562792],)}\r\n| | | | | | | | | | | | | | attr=u\"handle\"\r\n| | | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:608:57, QN: v.handle}\r\n| | | | | | | | | | | | ]\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | NameConstant:\r\n| | | | | | | | | | | | value=None\r\n| | | | | | | | | | | Name:\r\n| | | | | | | | | | | | id=u\"initialize_variables_scope\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | ___pyct_anno={QN: initialize_variables_scope, DEFINITIONS: (AnnotatedDef[766997784],)}\r\n| | | | | | | | | | ]\r\n| | | | | | | | | | keywords=[]\r\n| | | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:608:13, ARGS_SCOPE: Scope{r=(resource_variable_ops, v, initialize_variables_scope, resource_variable_ops.var_is_initialized_op, v.handle, initialize_variables_scope.callopts), w=()}}\r\n| | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:608:10, SCOPE: Scope{r=(ag__.converted_call, ag__, resource_variable_ops, v, initialize_variables_scope, resource_variable_ops.var_is_initialized_op, v.handle, initialize_variables_scope.callopts), w=(cond,)}, LIVE_VARS_IN: frozenset({ops, resource_variable_ops.var_is_initialized_op, init, initialize_variables_scope.callopts, if_false, op_map_1[init], ops.get_default_graph, if_true, ag__.not_, lift_to_graph.lift_to_graph, ag__, lift_to_graph, resource_variable_ops, ag__.if_stmt, v, initialize_variables_scope, op_map, ag__.converted_call, set_state, v.handle, v.assign, get_state})}\r\n| | | | | | | | Assign:\r\n| | | | | | | | | targets=[\r\n| | | | | | | | | | Name:\r\n| | | | | | | | | | | id=u\"continue_\"\r\n| | | | | | | | | | | ctx=Store()\r\n| | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | ___pyct_anno={QN: continue_, DEFINITIONS: (AnnotatedDef[764785776],)}\r\n| | | | | | | | | ]\r\n| | | | | | | | | value=Call:\r\n| | | | | | | | | | func=Attribute:\r\n| | | | | | | | | | | value=Name:\r\n| | | | | | | | | | | | id=u\"ag__\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | ___pyct_anno={QN: ag__, DEFINITIONS: ()}\r\n| | | | | | | | | | | attr=u\"if_stmt\"\r\n| | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | ___pyct_anno={QN: ag__.if_stmt}\r\n| | | | | | | | | | args=[\r\n| | | | | | | | | | | Name:\r\n| | | | | | | | | | | | id=u\"cond\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | ___pyct_anno={QN: cond, DEFINITIONS: (AnnotatedDef[767225416],)}\r\n| | | | | | | | | | | Name:\r\n| | | | | | | | | | | | id=u\"if_true\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | ___pyct_anno={QN: if_true, DEFINITIONS: (AnnotatedDef[767223904],)}\r\n| | | | | | | | | | | Name:\r\n| | | | | | | | | | | | id=u\"if_false\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | ___pyct_anno={QN: if_false, DEFINITIONS: (AnnotatedDef[767223176],)}\r\n| | | | | | | | | | | Name:\r\n| | | | | | | | | | | | id=u\"get_state\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | ___pyct_anno={QN: get_state, DEFINITIONS: (AnnotatedDef[764560608],)}\r\n| | | | | | | | | | | Name:\r\n| | | | | | | | | | | | id=u\"set_state\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | ___pyct_anno={QN: set_state, DEFINITIONS: (AnnotatedDef[767225472],)}\r\n| | | | | | | | | | | Tuple:\r\n| | | | | | | | | | | | elts=[\r\n| | | | | | | | | | | | | Str:\r\n| | | | | | | | | | | | | | s=u\"continue_\"\r\n| | | | | | | | | | | | ]\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | Tuple:\r\n| | | | | | | | | | | | elts=[]\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | ]\r\n| | | | | | | | | | keywords=[]\r\n| | | | | | | | | | ___pyct_anno={ARGS_SCOPE: Scope{r=(if_true, cond, set_state, get_state, if_false), w=()}}\r\n| | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:608:10, SCOPE: Scope{r=(if_true, cond, ag__, set_state, ag__.if_stmt, get_state, if_false), w=(continue_,)}, LIVE_VARS_IN: frozenset({ops, cond, init, initialize_variables_scope.callopts, if_false, op_map_1[init], ops.get_default_graph, if_true, ag__.not_, lift_to_graph.lift_to_graph, ag__, lift_to_graph, ag__.if_stmt, initialize_variables_scope, v, op_map, ag__.converted_call, set_state, v.assign, get_state})}\r\n| | | | | | | ]\r\n| | | | | | | ___pyct_anno={ORIGIN: def_function.py:607:8, BODY_SCOPE: Scope{r=(if_true, ops, ag__.converted_call, ag__, cond, resource_variable_ops, set_state, ag__.if_stmt, ops.init_scope, initialize_variables_scope, v, resource_variable_ops.var_is_initialized_op, continue_, get_state, v.handle, initialize_variables_scope.callopts, if_false), w=(if_true, cond, set_state, continue_, get_state, if_false)}, LIVE_VARS_IN: frozenset({ops, ag__.converted_call, ops.init_scope, resource_variable_ops.var_is_initialized_op, init, initialize_variables_scope.callopts, op_map_1[init], ops.get_default_graph, ag__.not_, lift_to_graph.lift_to_graph, ag__, resource_variable_ops, ag__.if_stmt, v, initialize_variables_scope, op_map, lift_to_graph, continue_, v.handle, v.assign})}\r\n| | | | | | FunctionDef:\r\n| | | | | | | name=u\"get_state_1\"\r\n| | | | | | | args=arguments:\r\n| | | | | | | | args=[]\r\n| | | | | | | | vararg=None\r\n| | | | | | | | kwonlyargs=[]\r\n| | | | | | | | kw_defaults=[]\r\n| | | | | | | | kwarg=None\r\n| | | | | | | | defaults=[]\r\n| | | | | | | | ___pyct_anno={SCOPE: Scope{r=(), w=()}}\r\n| | | | | | | body=[\r\n| | | | | | | | Return:\r\n| | | | | | | | | value=Tuple:\r\n| | | | | | | | | | elts=[]\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | ___pyct_anno={SCOPE: Scope{r=(), w=()}, LIVE_VARS_IN: frozenset()}\r\n| | | | | | | ]\r\n| | | | | | | decorator_list=[]\r\n| | | | | | | returns=None\r\n| | | | | | | ___pyct_anno={ORIGIN: def_function.py:606:6, SCOPE: Scope{r=(), w=(get_state_1,)}, BODY_SCOPE: Scope{r=(), w=()}, LIVE_VARS_IN: frozenset({ops, ag__.converted_call, init, initialize_variables_scope.callopts, op_map_1[init], ops.get_default_graph, ag__.not_, lift_to_graph.lift_to_graph, ag__, ag__.if_stmt, initialize_variables_scope, v, op_map, lift_to_graph, continue_, v.assign})}\r\n| | | | | | FunctionDef:\r\n| | | | | | | name=u\"set_state_1\"\r\n| | | | | | | args=arguments:\r\n| | | | | | | | args=[\r\n| | | | | | | | | Name:\r\n| | | | | | | | | | id=u\"_\"\r\n| | | | | | | | | | ctx=Param()\r\n| | | | | | | | | | annotation=None\r\n| | | | | | | | | | ___pyct_anno={QN: _, DEFINITIONS: (AnnotatedDef[767302736],)}\r\n| | | | | | | | ]\r\n| | | | | | | | vararg=None\r\n| | | | | | | | kwonlyargs=[]\r\n| | | | | | | | kw_defaults=[]\r\n| | | | | | | | kwarg=None\r\n| | | | | | | | defaults=[]\r\n| | | | | | | | ___pyct_anno={SCOPE: Scope{r=(), w=(_,)}}\r\n| | | | | | | body=[\r\n| | | | | | | | Pass:\r\n| | | | | | | | | ___pyct_anno={LIVE_VARS_IN: frozenset()}\r\n| | | | | | | ]\r\n| | | | | | | decorator_list=[]\r\n| | | | | | | returns=None\r\n| | | | | | | ___pyct_anno={ORIGIN: def_function.py:606:6, SCOPE: Scope{r=(), w=(set_state_1,)}, BODY_SCOPE: Scope{r=(), w=()}, LIVE_VARS_IN: frozenset({ops, init, initialize_variables_scope.callopts, op_map_1[init], ops.get_default_graph, ag__.not_, lift_to_graph.lift_to_graph, ag__, lift_to_graph, ag__.if_stmt, initialize_variables_scope, v, op_map, get_state_1, ag__.converted_call, continue_, v.assign})}\r\n| | | | | | FunctionDef:\r\n| | | | | | | name=u\"if_true_1\"\r\n| | | | | | | args=arguments:\r\n| | | | | | | | args=[]\r\n| | | | | | | | vararg=None\r\n| | | | | | | | kwonlyargs=[]\r\n| | | | | | | | kw_defaults=[]\r\n| | | | | | | | kwarg=None\r\n| | | | | | | | defaults=[]\r\n| | | | | | | | ___pyct_anno={SCOPE: Scope{r=(), w=()}}\r\n| | | | | | | body=[\r\n| | | | | | | | Assign:\r\n| | | | | | | | | targets=[\r\n| | | | | | | | | | Tuple:\r\n| | | | | | | | | | | elts=[\r\n| | | | | | | | | | | | Name:\r\n| | | | | | | | | | | | | id=u\"op_map_1\"\r\n| | | | | | | | | | | | | ctx=Store()\r\n| | | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | | ___pyct_anno={QN: op_map_1, DEFINITIONS: (AnnotatedDef[764640168],)}\r\n| | | | | | | | | | | ]\r\n| | | | | | | | | | | ctx=Store()\r\n| | | | | | | | | ]\r\n| | | | | | | | | value=Tuple:\r\n| | | | | | | | | | elts=[\r\n| | | | | | | | | | | Name:\r\n| | | | | | | | | | | | id=u\"op_map\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | ___pyct_anno={QN: op_map, DEFINITIONS: (AnnotatedDef[764739824],)}\r\n| | | | | | | | | | ]\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | ___pyct_anno={SCOPE: Scope{r=(op_map,), w=(op_map_1,)}, LIVE_VARS_IN: frozenset({lift_to_graph.lift_to_graph, ops, ag__, lift_to_graph, initialize_variables_scope, v, op_map, initialize_variables_scope.callopts, ag__.converted_call, init, op_map_1[init], v.assign, ops.get_default_graph})}\r\n| | | | | | | | Assign:\r\n| | | | | | | | | targets=[\r\n| | | | | | | | | | Name:\r\n| | | | | | | | | | | id=u\"op_map_1\"\r\n| | | | | | | | | | | ctx=Store()\r\n| | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | ___pyct_anno={ORIG_DEFINITIONS: (AnnotatedDef[764329152],), ORIGIN: def_function.py:611:8, QN: op_map_1, DEFINITIONS: (AnnotatedDef[764641120],)}\r\n| | | | | | | | | ]\r\n| | | | | | | | | value=Call:\r\n| | | | | | | | | | func=Attribute:\r\n| | | | | | | | | | | value=Name:\r\n| | | | | | | | | | | | id=u\"ag__\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | ___pyct_anno={QN: ag__, DEFINITIONS: ()}\r\n| | | | | | | | | | | attr=u\"converted_call\"\r\n| | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | ___pyct_anno={QN: ag__.converted_call}\r\n| | | | | | | | | | args=[\r\n| | | | | | | | | | | Attribute:\r\n| | | | | | | | | | | | value=Name:\r\n| | | | | | | | | | | | | id=u\"lift_to_graph\"\r\n| | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | | ___pyct_anno={ORIG_DEFINITIONS: (), ORIGIN: def_function.py:611:17, QN: lift_to_graph, DEFINITIONS: ()}\r\n| | | | | | | | | | | | attr=u\"lift_to_graph\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:611:17, QN: lift_to_graph.lift_to_graph}\r\n| | | | | | | | | | | Attribute:\r\n| | | | | | | | | | | | value=Name:\r\n| | | | | | | | | | | | | id=u\"initialize_variables_scope\"\r\n| | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | | ___pyct_anno={QN: initialize_variables_scope, DEFINITIONS: (AnnotatedDef[766997784],)}\r\n| | | | | | | | | | | | attr=u\"callopts\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | ___pyct_anno={QN: initialize_variables_scope.callopts}\r\n| | | | | | | | | | | Tuple:\r\n| | | | | | | | | | | | elts=[\r\n| | | | | | | | | | | | | List:\r\n| | | | | | | | | | | | | | elts=[\r\n| | | | | | | | | | | | | | | Name:\r\n| | | | | | | | | | | | | | | | id=u\"init\"\r\n| | | | | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | | | | | ___pyct_anno={ORIG_DEFINITIONS: (AnnotatedDef[764323320],), ORIGIN: def_function.py:612:13, QN: init, DEFINITIONS: (AnnotatedDef[767225528],)}\r\n| | | | | | | | | | | | | | ]\r\n| | | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:612:12}\r\n| | | | | | | | | | | | | Call:\r\n| | | | | | | | | | | | | | func=Attribute:\r\n| | | | | | | | | | | | | | | value=Name:\r\n| | | | | | | | | | | | | | | | id=u\"ag__\"\r\n| | | | | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | | | | | ___pyct_anno={QN: ag__, DEFINITIONS: ()}\r\n| | | | | | | | | | | | | | | attr=u\"converted_call\"\r\n| | | | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | | | ___pyct_anno={QN: ag__.converted_call}\r\n| | | | | | | | | | | | | | args=[\r\n| | | | | | | | | | | | | | | Attribute:\r\n| | | | | | | | | | | | | | | | value=Name:\r\n| | | | | | | | | | | | | | | | | id=u\"ops\"\r\n| | | | | | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | | | | | | ___pyct_anno={ORIG_DEFINITIONS: (), ORIGIN: def_function.py:612:20, QN: ops, DEFINITIONS: ()}\r\n| | | | | | | | | | | | | | | | attr=u\"get_default_graph\"\r\n| | | | | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:612:20, QN: ops.get_default_graph}\r\n| | | | | | | | | | | | | | | Attribute:\r\n| | | | | | | | | | | | | | | | value=Name:\r\n| | | | | | | | | | | | | | | | | id=u\"initialize_variables_scope\"\r\n| | | | | | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | | | | | | ___pyct_anno={QN: initialize_variables_scope, DEFINITIONS: (AnnotatedDef[766997784],)}\r\n| | | | | | | | | | | | | | | | attr=u\"callopts\"\r\n| | | | | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | | | | ___pyct_anno={QN: initialize_variables_scope.callopts}\r\n| | | | | | | | | | | | | | | Tuple:\r\n| | | | | | | | | | | | | | | | elts=[]\r\n| | | | | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | | | NameConstant:\r\n| | | | | | | | | | | | | | | | value=None\r\n| | | | | | | | | | | | | | | Name:\r\n| | | | | | | | | | | | | | | | id=u\"initialize_variables_scope\"\r\n| | | | | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | | | | | ___pyct_anno={QN: initialize_variables_scope, DEFINITIONS: (AnnotatedDef[766997784],)}\r\n| | | | | | | | | | | | | | ]\r\n| | | | | | | | | | | | | | keywords=[]\r\n| | | | | | | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:612:20, ARGS_SCOPE: Scope{r=(ops, initialize_variables_scope.callopts, ops.get_default_graph, initialize_variables_scope), w=()}}\r\n| | | | | | | | | | | | ]\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | Dict:\r\n| | | | | | | | | | | | keys=[\r\n| | | | | | | | | | | | | Str:\r\n| | | | | | | | | | | | | | s=u\"op_map\"\r\n| | | | | | | | | | | | ]\r\n| | | | | | | | | | | | values=[\r\n| | | | | | | | | | | | | Name:\r\n| | | | | | | | | | | | | | id=u\"op_map_1\"\r\n| | | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | | | ___pyct_anno={ORIG_DEFINITIONS: (AnnotatedDef[764329152], AnnotatedDef[764323152]), ORIGIN: def_function.py:612:52, QN: op_map_1, DEFINITIONS: (AnnotatedDef[764640168],)}\r\n| | | | | | | | | | | | ]\r\n| | | | | | | | | | | Name:\r\n| | | | | | | | | | | | id=u\"initialize_variables_scope\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | ___pyct_anno={QN: initialize_variables_scope, DEFINITIONS: (AnnotatedDef[766997784],)}\r\n| | | | | | | | | | ]\r\n| | | | | | | | | | keywords=[]\r\n| | | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:611:17, ARGS_SCOPE: Scope{r=(lift_to_graph.lift_to_graph, ops, ag__.converted_call, ag__, op_map_1, initialize_variables_scope, lift_to_graph, init, initialize_variables_scope.callopts, ops.get_default_graph), w=()}}\r\n| | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:611:8, SCOPE: Scope{r=(lift_to_graph.lift_to_graph, ops, ag__.converted_call, ag__, op_map_1, initialize_variables_scope, lift_to_graph, init, initialize_variables_scope.callopts, ops.get_default_graph), w=(op_map_1,)}, LIVE_VARS_IN: frozenset({lift_to_graph.lift_to_graph, ops, ag__.converted_call, ag__, op_map_1[init], v.assign, op_map_1, initialize_variables_scope, v, lift_to_graph, init, initialize_variables_scope.callopts, ops.get_default_graph})}\r\n| | | | | | | | Expr:\r\n| | | | | | | | | value=Call:\r\n| | | | | | | | | | func=Attribute:\r\n| | | | | | | | | | | value=Name:\r\n| | | | | | | | | | | | id=u\"ag__\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | ___pyct_anno={QN: ag__, DEFINITIONS: ()}\r\n| | | | | | | | | | | attr=u\"converted_call\"\r\n| | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | ___pyct_anno={QN: ag__.converted_call}\r\n| | | | | | | | | | args=[\r\n| | | | | | | | | | | Attribute:\r\n| | | | | | | | | | | | value=Name:\r\n| | | | | | | | | | | | | id=u\"v\"\r\n| | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | | ___pyct_anno={ORIG_DEFINITIONS: (AnnotatedDef[764329320],), ORIGIN: def_function.py:613:8, QN: v, DEFINITIONS: (AnnotatedDef[764562792],)}\r\n| | | | | | | | | | | | attr=u\"assign\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:613:8, QN: v.assign}\r\n| | | | | | | | | | | Attribute:\r\n| | | | | | | | | | | | value=Name:\r\n| | | | | | | | | | | | | id=u\"initialize_variables_scope\"\r\n| | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | | ___pyct_anno={QN: initialize_variables_scope, DEFINITIONS: (AnnotatedDef[766997784],)}\r\n| | | | | | | | | | | | attr=u\"callopts\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | ___pyct_anno={QN: initialize_variables_scope.callopts}\r\n| | | | | | | | | | | Tuple:\r\n| | | | | | | | | | | | elts=[\r\n| | | | | | | | | | | | | Subscript:\r\n| | | | | | | | | | | | | | value=Name:\r\n| | | | | | | | | | | | | | | id=u\"op_map_1\"\r\n| | | | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | | | | ___pyct_anno={ORIG_DEFINITIONS: (AnnotatedDef[764329152],), ORIGIN: def_function.py:613:17, QN: op_map_1, DEFINITIONS: (AnnotatedDef[764641120],)}\r\n| | | | | | | | | | | | | | slice=Index:\r\n| | | | | | | | | | | | | | | value=Name:\r\n| | | | | | | | | | | | | | | | id=u\"init\"\r\n| | | | | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | | | | | ___pyct_anno={ORIG_DEFINITIONS: (AnnotatedDef[764323320],), ORIGIN: def_function.py:613:24, QN: init, DEFINITIONS: (AnnotatedDef[767225528],)}\r\n| | | | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:613:17, QN: op_map_1[init]}\r\n| | | | | | | | | | | | ]\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | NameConstant:\r\n| | | | | | | | | | | | value=None\r\n| | | | | | | | | | | Name:\r\n| | | | | | | | | | | | id=u\"initialize_variables_scope\"\r\n| | | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | | ___pyct_anno={QN: initialize_variables_scope, DEFINITIONS: (AnnotatedDef[766997784],)}\r\n| | | | | | | | | | ]\r\n| | | | | | | | | | keywords=[]\r\n| | | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:613:8, ARGS_SCOPE: Scope{r=(op_map_1[init], op_map_1, initialize_variables_scope, v, init, initialize_variables_scope.callopts, v.assign), w=()}}\r\n| | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:613:8, SCOPE: Scope{r=(ag__, op_map_1[init], op_map_1, initialize_variables_scope, v, ag__.converted_call, init, initialize_variables_scope.callopts, v.assign), w=()}, LIVE_VARS_OUT: frozenset({op_map_1}), LIVE_VARS_IN: frozenset({ag__, op_map_1[init], op_map_1, initialize_variables_scope, v, ag__.converted_call, init, initialize_variables_scope.callopts, v.assign})}\r\n| | | | | | | | Return:\r\n| | | | | | | | | value=Name:\r\n| | | | | | | | | | id=u\"op_map_1\"\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | annotation=None\r\n| | | | | | | | | | ___pyct_anno={QN: op_map_1, DEFINITIONS: (AnnotatedDef[764641120],)}\r\n| | | | | | | | | ___pyct_anno={SCOPE: Scope{r=(op_map_1,), w=()}, LIVE_VARS_IN: frozenset({op_map_1})}\r\n| | | | | | | ]\r\n| | | | | | | decorator_list=[]\r\n| | | | | | | returns=None\r\n| | | | | | | ___pyct_anno={ORIGIN: def_function.py:606:6, SCOPE: Scope{r=(), w=(if_true_1,)}, BODY_SCOPE: Scope{r=(lift_to_graph.lift_to_graph, ops, ag__.converted_call, ag__, v.assign, op_map_1[init], op_map_1, initialize_variables_scope, v, op_map, lift_to_graph, init, initialize_variables_scope.callopts, ops.get_default_graph), w=(op_map_1,)}, LIVE_VARS_IN: frozenset({ops, ag__.converted_call, set_state_1, init, initialize_variables_scope.callopts, op_map_1[init], ops.get_default_graph, ag__.not_, lift_to_graph.lift_to_graph, ag__, ag__.if_stmt, initialize_variables_scope, v, op_map, get_state_1, lift_to_graph, continue_, v.assign})}\r\n| | | | | | FunctionDef:\r\n| | | | | | | name=u\"if_false_1\"\r\n| | | | | | | args=arguments:\r\n| | | | | | | | args=[]\r\n| | | | | | | | vararg=None\r\n| | | | | | | | kwonlyargs=[]\r\n| | | | | | | | kw_defaults=[]\r\n| | | | | | | | kwarg=None\r\n| | | | | | | | defaults=[]\r\n| | | | | | | | ___pyct_anno={SCOPE: Scope{r=(), w=()}}\r\n| | | | | | | body=[\r\n| | | | | | | | Return:\r\n| | | | | | | | | value=Name:\r\n| | | | | | | | | | id=u\"op_map\"\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | annotation=None\r\n| | | | | | | | | | ___pyct_anno={QN: op_map, DEFINITIONS: (AnnotatedDef[764739824],)}\r\n| | | | | | | | | ___pyct_anno={SCOPE: Scope{r=(op_map,), w=()}, LIVE_VARS_IN: frozenset({op_map})}\r\n| | | | | | | ]\r\n| | | | | | | decorator_list=[]\r\n| | | | | | | returns=None\r\n| | | | | | | ___pyct_anno={ORIGIN: def_function.py:606:6, SCOPE: Scope{r=(), w=(if_false_1,)}, BODY_SCOPE: Scope{r=(op_map,), w=()}, LIVE_VARS_IN: frozenset({ag__.not_, if_true_1, ag__, set_state_1, ag__.if_stmt, get_state_1, op_map, continue_})}\r\n| | | | | | Assign:\r\n| | | | | | | targets=[\r\n| | | | | | | | Name:\r\n| | | | | | | | | id=u\"cond_1\"\r\n| | | | | | | | | ctx=Store()\r\n| | | | | | | | | annotation=None\r\n| | | | | | | | | ___pyct_anno={QN: cond_1, DEFINITIONS: (AnnotatedDef[764788296],)}\r\n| | | | | | | ]\r\n| | | | | | | value=Call:\r\n| | | | | | | | func=Attribute:\r\n| | | | | | | | | value=Name:\r\n| | | | | | | | | | id=u\"ag__\"\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | annotation=None\r\n| | | | | | | | | | ___pyct_anno={QN: ag__, DEFINITIONS: ()}\r\n| | | | | | | | | attr=u\"not_\"\r\n| | | | | | | | | ctx=Load()\r\n| | | | | | | | | ___pyct_anno={QN: ag__.not_}\r\n| | | | | | | | args=[\r\n| | | | | | | | | Name:\r\n| | | | | | | | | | id=u\"continue_\"\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | annotation=None\r\n| | | | | | | | | | ___pyct_anno={QN: continue_, DEFINITIONS: (AnnotatedDef[764785776],)}\r\n| | | | | | | | ]\r\n| | | | | | | | keywords=[]\r\n| | | | | | | | ___pyct_anno={ARGS_SCOPE: Scope{r=(continue_,), w=()}}\r\n| | | | | | | ___pyct_anno={ORIGIN: def_function.py:606:6, SCOPE: Scope{r=(ag__, continue_, ag__.not_), w=(cond_1,)}, LIVE_VARS_IN: frozenset({ag__.not_, if_true_1, ag__, set_state_1, ag__.if_stmt, get_state_1, if_false_1, continue_})}\r\n| | | | | | Assign:\r\n| | | | | | | targets=[\r\n| | | | | | | | Name:\r\n| | | | | | | | | id=u\"op_map\"\r\n| | | | | | | | | ctx=Store()\r\n| | | | | | | | | annotation=None\r\n| | | | | | | | | ___pyct_anno={QN: op_map, DEFINITIONS: (AnnotatedDef[764562848],)}\r\n| | | | | | | ]\r\n| | | | | | | value=Call:\r\n| | | | | | | | func=Attribute:\r\n| | | | | | | | | value=Name:\r\n| | | | | | | | | | id=u\"ag__\"\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | annotation=None\r\n| | | | | | | | | | ___pyct_anno={QN: ag__, DEFINITIONS: ()}\r\n| | | | | | | | | attr=u\"if_stmt\"\r\n| | | | | | | | | ctx=Load()\r\n| | | | | | | | | ___pyct_anno={QN: ag__.if_stmt}\r\n| | | | | | | | args=[\r\n| | | | | | | | | Name:\r\n| | | | | | | | | | id=u\"cond_1\"\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | annotation=None\r\n| | | | | | | | | | ___pyct_anno={QN: cond_1, DEFINITIONS: (AnnotatedDef[764788296],)}\r\n| | | | | | | | | Name:\r\n| | | | | | | | | | id=u\"if_true_1\"\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | annotation=None\r\n| | | | | | | | | | ___pyct_anno={QN: if_true_1, DEFINITIONS: (AnnotatedDef[764786224],)}\r\n| | | | | | | | | Name:\r\n| | | | | | | | | | id=u\"if_false_1\"\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | annotation=None\r\n| | | | | | | | | | ___pyct_anno={QN: if_false_1, DEFINITIONS: (AnnotatedDef[764788576],)}\r\n| | | | | | | | | Name:\r\n| | | | | | | | | | id=u\"get_state_1\"\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | annotation=None\r\n| | | | | | | | | | ___pyct_anno={QN: get_state_1, DEFINITIONS: (AnnotatedDef[764787344],)}\r\n| | | | | | | | | Name:\r\n| | | | | | | | | | id=u\"set_state_1\"\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | annotation=None\r\n| | | | | | | | | | ___pyct_anno={QN: set_state_1, DEFINITIONS: (AnnotatedDef[764787960],)}\r\n| | | | | | | | | Tuple:\r\n| | | | | | | | | | elts=[\r\n| | | | | | | | | | | Str:\r\n| | | | | | | | | | | | s=u\"op_map\"\r\n| | | | | | | | | | ]\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | Tuple:\r\n| | | | | | | | | | elts=[]\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | ]\r\n| | | | | | | | keywords=[]\r\n| | | | | | | | ___pyct_anno={ARGS_SCOPE: Scope{r=(if_true_1, set_state_1, get_state_1, if_false_1, cond_1), w=()}}\r\n| | | | | | | ___pyct_anno={ORIGIN: def_function.py:606:6, SCOPE: Scope{r=(if_true_1, set_state_1, ag__, ag__.if_stmt, get_state_1, if_false_1, cond_1), w=(op_map,)}, LIVE_VARS_IN: frozenset({cond_1, if_true_1, if_false_1, set_state_1, ag__, ag__.if_stmt, get_state_1})}\r\n| | | | | | Return:\r\n| | | | | | | value=Tuple:\r\n| | | | | | | | elts=[\r\n| | | | | | | | | Name:\r\n| | | | | | | | | | id=u\"op_map\"\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | annotation=None\r\n| | | | | | | | | | ___pyct_anno={QN: op_map, DEFINITIONS: (AnnotatedDef[764562848],)}\r\n| | | | | | | | ]\r\n| | | | | | | | ctx=Load()\r\n| | | | | | | ___pyct_anno={SCOPE: Scope{r=(op_map,), w=()}, LIVE_VARS_IN: frozenset({op_map})}\r\n| | | | | ]\r\n| | | | | decorator_list=[]\r\n| | | | | returns=None\r\n| | | | | ___pyct_anno={ORIGIN: def_function.py:606:6, SCOPE: Scope{r=(), w=(loop_body,)}, BODY_SCOPE: Scope{r=(ops, if_true_1, cond, op_map_1, ops.init_scope, init, initialize_variables_scope.callopts, if_false, if_true, ag__, ag__.if_stmt, initialize_variables_scope, v, op_map, get_state_1, lift_to_graph, if_false_1, set_state, v.assign, iterates, set_state_1, resource_variable_ops.var_is_initialized_op, cond_1, op_map_1[init], ops.get_default_graph, ag__.not_, lift_to_graph.lift_to_graph, resource_variable_ops, ag__.converted_call, continue_, get_state, v.handle), w=(if_true, continue_, if_true_1, cond, set_state_1, set_state, v, get_state_1, op_map, if_false_1, cond_1, init, get_state, if_false)}, LIVE_VARS_IN: frozenset({ops, ops.init_scope, set_state_2, ag__.for_stmt, initializer_map, resource_variable_ops.var_is_initialized_op, initializer_map.items, initialize_variables_scope.callopts, op_map_1[init], ops.get_default_graph, ag__.not_, lift_to_graph.lift_to_graph, get_state_2, ag__, lift_to_graph, resource_variable_ops, ag__.if_stmt, initialize_variables_scope, op_map, ag__.converted_call, v.handle, v.assign})}\r\n| | | | Assign:\r\n| | | | | targets=[\r\n| | | | | | Tuple:\r\n| | | | | | | elts=[\r\n| | | | | | | | Name:\r\n| | | | | | | | | id=u\"op_map\"\r\n| | | | | | | | | ctx=Store()\r\n| | | | | | | | | annotation=None\r\n| | | | | | | | | ___pyct_anno={QN: op_map, DEFINITIONS: (AnnotatedDef[767039808],)}\r\n| | | | | | | ]\r\n| | | | | | | ctx=Store()\r\n| | | | | ]\r\n| | | | | value=Call:\r\n| | | | | | func=Attribute:\r\n| | | | | | | value=Name:\r\n| | | | | | | | id=u\"ag__\"\r\n| | | | | | | | ctx=Load()\r\n| | | | | | | | annotation=None\r\n| | | | | | | | ___pyct_anno={QN: ag__, DEFINITIONS: ()}\r\n| | | | | | | attr=u\"for_stmt\"\r\n| | | | | | | ctx=Load()\r\n| | | | | | | ___pyct_anno={QN: ag__.for_stmt}\r\n| | | | | | args=[\r\n| | | | | | | Call:\r\n| | | | | | | | func=Attribute:\r\n| | | | | | | | | value=Name:\r\n| | | | | | | | | | id=u\"ag__\"\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | annotation=None\r\n| | | | | | | | | | ___pyct_anno={QN: ag__, DEFINITIONS: ()}\r\n| | | | | | | | | attr=u\"converted_call\"\r\n| | | | | | | | | ctx=Load()\r\n| | | | | | | | | ___pyct_anno={QN: ag__.converted_call}\r\n| | | | | | | | args=[\r\n| | | | | | | | | Attribute:\r\n| | | | | | | | | | value=Name:\r\n| | | | | | | | | | | id=u\"initializer_map\"\r\n| | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | ___pyct_anno={ORIG_DEFINITIONS: (), ORIGIN: def_function.py:606:21, QN: initializer_map, DEFINITIONS: ()}\r\n| | | | | | | | | | attr=u\"items\"\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | ___pyct_anno={ORIGIN: def_function.py:606:21, QN: initializer_map.items}\r\n| | | | | | | | | Attribute:\r\n| | | | | | | | | | value=Name:\r\n| | | | | | | | | | | id=u\"initialize_variables_scope\"\r\n| | | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | | annotation=None\r\n| | | | | | | | | | | ___pyct_anno={QN: initialize_variables_scope, DEFINITIONS: (AnnotatedDef[766997784],)}\r\n| | | | | | | | | | attr=u\"callopts\"\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | ___pyct_anno={QN: initialize_variables_scope.callopts}\r\n| | | | | | | | | Tuple:\r\n| | | | | | | | | | elts=[]\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | NameConstant:\r\n| | | | | | | | | | value=None\r\n| | | | | | | | | Name:\r\n| | | | | | | | | | id=u\"initialize_variables_scope\"\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | annotation=None\r\n| | | | | | | | | | ___pyct_anno={QN: initialize_variables_scope, DEFINITIONS: (AnnotatedDef[766997784],)}\r\n| | | | | | | | ]\r\n| | | | | | | | keywords=[]\r\n| | | | | | | | ___pyct_anno={ORIGIN: def_function.py:606:21, ARGS_SCOPE: Scope{r=(initializer_map.items, initialize_variables_scope.callopts, initializer_map, initialize_variables_scope), w=()}}\r\n| | | | | | | NameConstant:\r\n| | | | | | | | value=None\r\n| | | | | | | Name:\r\n| | | | | | | | id=u\"loop_body\"\r\n| | | | | | | | ctx=Load()\r\n| | | | | | | | annotation=None\r\n| | | | | | | | ___pyct_anno={QN: loop_body, DEFINITIONS: (AnnotatedDef[766998064],)}\r\n| | | | | | | Name:\r\n| | | | | | | | id=u\"get_state_2\"\r\n| | | | | | | | ctx=Load()\r\n| | | | | | | | annotation=None\r\n| | | | | | | | ___pyct_anno={QN: get_state_2, DEFINITIONS: (AnnotatedDef[766999576],)}\r\n| | | | | | | Name:\r\n| | | | | | | | id=u\"set_state_2\"\r\n| | | | | | | | ctx=Load()\r\n| | | | | | | | annotation=None\r\n| | | | | | | | ___pyct_anno={QN: set_state_2, DEFINITIONS: (AnnotatedDef[767000416],)}\r\n| | | | | | | Tuple:\r\n| | | | | | | | elts=[\r\n| | | | | | | | | Name:\r\n| | | | | | | | | | id=u\"op_map\"\r\n| | | | | | | | | | ctx=Load()\r\n| | | | | | | | | | annotation=None\r\n| | | | | | | | | | ___pyct_anno={QN: op_map, DEFINITIONS: (AnnotatedDef[766997112],)}\r\n| | | | | | | | ]\r\n| | | | | | | | ctx=Load()\r\n| | | | | | | Tuple:\r\n| | | | | | | | elts=[\r\n| | | | | | | | | Str:\r\n| | | | | | | | | | s=u\"op_map\"\r\n| | | | | | | | ]\r\n| | | | | | | | ctx=Load()\r\n| | | | | | | Tuple:\r\n| | | | | | | | elts=[]\r\n| | | | | | | | ctx=Load()\r\n| | | | | | ]\r\n| | | | | | keywords=[]\r\n| | | | | | ___pyct_anno={ARGS_SCOPE: Scope{r=(get_state_2, ag__, initialize_variables_scope, loop_body, set_state_2, op_map, initializer_map, ag__.converted_call, initializer_map.items, initialize_variables_scope.callopts), w=()}}\r\n| | | | | ___pyct_anno={ORIGIN: def_function.py:606:6, SCOPE: Scope{r=(get_state_2, ag__, initialize_variables_scope, loop_body, set_state_2, op_map, ag__.for_stmt, initializer_map, ag__.converted_call, initializer_map.items, initialize_variables_scope.callopts), w=(op_map,)}, LIVE_VARS_IN: frozenset({get_state_2, ag__, initialize_variables_scope, loop_body, set_state_2, op_map, ag__.for_stmt, initializer_map, ag__.converted_call, initializer_map.items, initialize_variables_scope.callopts})}\r\n| | | ]\r\n| | | ___pyct_anno={BODY_SCOPE: Scope{r=(ops, object_identity.ObjectIdentityDictionary, if_true_1, cond, op_map_1, ops.init_scope, set_state_2, initializer_map, init, initializer_map.items, initialize_variables_scope.callopts, if_false, if_true, ag__, ag__.if_stmt, initialize_variables_scope, v, op_map, get_state_1, lift_to_graph, if_false_1, set_state, v.assign, iterates, set_state_1, object_identity, loop_body, ag__.for_stmt, resource_variable_ops.var_is_initialized_op, cond_1, op_map_1[init], ops.get_default_graph, ag__.not_, lift_to_graph.lift_to_graph, get_state_2, resource_variable_ops, ag__.ConversionOptions, ag__.converted_call, continue_, ag__.FunctionScope, get_state, v.handle), w=(get_state_2, set_state_2, loop_body, op_map, initialize_variables_scope)}, LIVE_VARS_IN: frozenset({ops, object_identity.ObjectIdentityDictionary, ag__.converted_call, object_identity, ops.init_scope, ag__.for_stmt, initializer_map, resource_variable_ops.var_is_initialized_op, initializer_map.items, initialize_variables_scope.callopts, op_map_1[init], ops.get_default_graph, ag__.not_, lift_to_graph.lift_to_graph, ag__, resource_variable_ops, ag__.if_stmt, ag__.ConversionOptions, lift_to_graph, ag__.FunctionScope, v.handle, v.assign})}\r\n| ]\r\n| decorator_list=[]\r\n| returns=None\r\n| ___pyct_anno={'lineno': 4, ORIGIN: def_function.py:603:4, SCOPE: Scope{r=(), w=(initialize_variables,)}, BODY_SCOPE: Scope{r=(ops, object_identity.ObjectIdentityDictionary, if_true_1, cond, op_map_1, ops.init_scope, set_state_2, initializer_map, init, initializer_map.items, initialize_variables_scope.callopts, if_false, if_true, ag__, ag__.if_stmt, initialize_variables_scope, v, op_map, get_state_1, lift_to_graph, if_false_1, set_state, v.assign, iterates, set_state_1, object_identity, loop_body, ag__.for_stmt, resource_variable_ops.var_is_initialized_op, cond_1, op_map_1[init], ops.get_default_graph, ag__.not_, lift_to_graph.lift_to_graph, get_state_2, resource_variable_ops, ag__.ConversionOptions, ag__.converted_call, continue_, ag__.FunctionScope, get_state, v.handle), w=(get_state_2, set_state_2, loop_body, op_map, initialize_variables_scope)}, 'function_context_name': 'initialize_variables_scope'}\r\n\r\n\r\n\r\nINFO:tensorflow:Defaults of <function create_converted_entity_factory.<locals>.create_converted_entity.<locals>.tf__initialize_variables at 0x000000002D8DAE18> : None\r\nINFO:tensorflow:KW defaults of <function create_converted_entity_factory.<locals>.create_converted_entity.<locals>.tf__initialize_variables at 0x000000002D8DAE18> : None\r\nINFO:tensorflow:Calling <function create_converted_entity_factory.<locals>.create_converted_entity.<locals>.tf__initialize_variables at 0x000000002D8DAE18> with\r\n\r\n\r\nINFO:tensorflow:Converted call: <class 'tensorflow.python.util.object_identity.ObjectIdentityDictionary'>\r\n    args: ()\r\n    kwargs: None\r\n\r\nINFO:tensorflow:Permanently whitelisted: <class 'tensorflow.python.util.object_identity.ObjectIdentityDictionary'>: constructor\r\nINFO:tensorflow:Converted call: <bound method Mapping.items of ObjectIdentityDictionary({})>\r\n    args: ()\r\n    kwargs: None\r\n\r\nINFO:tensorflow:Whitelisted: <bound method Mapping.items of ObjectIdentityDictionary({})>: DoNotConvert rule for collections\r\n60000/60000 [==============================] - 4s 59us/sample - loss: 0.2964 - accuracy: 0.9143\r\n<tensorflow.python.keras.callbacks.History object at 0x000000002D05D1D0>\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33785", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33785/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33785/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33785/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33785", "id": 513345994, "node_id": "MDU6SXNzdWU1MTMzNDU5OTQ=", "number": 33785, "title": "The inheriting keras.layers.Layer does not call a compute_output_shape after switching to tf.keras from keras", "user": {"login": "kiflowb777", "id": 55391259, "node_id": "MDQ6VXNlcjU1MzkxMjU5", "avatar_url": "https://avatars3.githubusercontent.com/u/55391259?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kiflowb777", "html_url": "https://github.com/kiflowb777", "followers_url": "https://api.github.com/users/kiflowb777/followers", "following_url": "https://api.github.com/users/kiflowb777/following{/other_user}", "gists_url": "https://api.github.com/users/kiflowb777/gists{/gist_id}", "starred_url": "https://api.github.com/users/kiflowb777/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kiflowb777/subscriptions", "organizations_url": "https://api.github.com/users/kiflowb777/orgs", "repos_url": "https://api.github.com/users/kiflowb777/repos", "events_url": "https://api.github.com/users/kiflowb777/events{/privacy}", "received_events_url": "https://api.github.com/users/kiflowb777/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "qlzh727", "id": 5118881, "node_id": "MDQ6VXNlcjUxMTg4ODE=", "avatar_url": "https://avatars3.githubusercontent.com/u/5118881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qlzh727", "html_url": "https://github.com/qlzh727", "followers_url": "https://api.github.com/users/qlzh727/followers", "following_url": "https://api.github.com/users/qlzh727/following{/other_user}", "gists_url": "https://api.github.com/users/qlzh727/gists{/gist_id}", "starred_url": "https://api.github.com/users/qlzh727/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qlzh727/subscriptions", "organizations_url": "https://api.github.com/users/qlzh727/orgs", "repos_url": "https://api.github.com/users/qlzh727/repos", "events_url": "https://api.github.com/users/qlzh727/events{/privacy}", "received_events_url": "https://api.github.com/users/qlzh727/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "qlzh727", "id": 5118881, "node_id": "MDQ6VXNlcjUxMTg4ODE=", "avatar_url": "https://avatars3.githubusercontent.com/u/5118881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qlzh727", "html_url": "https://github.com/qlzh727", "followers_url": "https://api.github.com/users/qlzh727/followers", "following_url": "https://api.github.com/users/qlzh727/following{/other_user}", "gists_url": "https://api.github.com/users/qlzh727/gists{/gist_id}", "starred_url": "https://api.github.com/users/qlzh727/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qlzh727/subscriptions", "organizations_url": "https://api.github.com/users/qlzh727/orgs", "repos_url": "https://api.github.com/users/qlzh727/repos", "events_url": "https://api.github.com/users/qlzh727/events{/privacy}", "received_events_url": "https://api.github.com/users/qlzh727/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2019-10-28T14:37:59Z", "updated_at": "2020-02-27T00:49:19Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): pip\r\n- TensorFlow version (use command below): 1.14, 1.15 and 2.0 (gpu)\r\n- Keras version: 2.2.4 and 2.2.4-tf\r\n- Python version: 3.6.1\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: 10/6.7.4\r\n- GPU model and memory: RTX 2060 6GB\r\n\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` unknown 1.14.0\r\n\r\nAfter switching to tf.keras from keras my project witch use Mask_RCNN does not work.\r\nI noticed that TimeDistributed returns a different tensor shape in keras (1.) and tf.keras (2.):\r\n1.` Tensor(\"mrcnn_class_bn1/Reshape_1:0\", shape=(?, 1000, 1, 1, 256), dtype=float32)`\r\n2. `Tensor(\"mrcnn_class_bn1/Reshape_1:0\", shape=(?, ?, 1, 1, 256), dtype=float32)`\r\n\r\n```\r\nx = PyramidROIAlign([pool_size, pool_size], feature_levels,\r\n                        name=\"roi_align_classifier\")([rois, image_meta] + feature_maps)\r\nx = KL.TimeDistributed(KL.Conv2D(fc_layers_size, (pool_size, pool_size), padding=\"valid\"),\r\n                           name=\"mrcnn_class_conv1\")(x)\r\n```\r\n\r\nwhere rois is generated by ProposalLayer from Mask_RCNN module (https://github.com/matterport/Mask_RCNN)\r\n\r\nProposalLayer inherits from the class keras.layers.Layer.\r\nIn Keras the overwritten function compute_output_shape is called, but not in the tf.keras.\r\n\r\nAdditionally, the rois created in the tf.keras does not have the parameter _keras_shape that is most likely needed in the function TimeDistributed to create a proper shape.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33784", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33784/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33784/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33784/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33784", "id": 513317020, "node_id": "MDU6SXNzdWU1MTMzMTcwMjA=", "number": 33784, "title": "tfp.sts.AutoregressiveStateSpaceModel noise mean should be settable", "user": {"login": "jrm346", "id": 19378610, "node_id": "MDQ6VXNlcjE5Mzc4NjEw", "avatar_url": "https://avatars2.githubusercontent.com/u/19378610?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jrm346", "html_url": "https://github.com/jrm346", "followers_url": "https://api.github.com/users/jrm346/followers", "following_url": "https://api.github.com/users/jrm346/following{/other_user}", "gists_url": "https://api.github.com/users/jrm346/gists{/gist_id}", "starred_url": "https://api.github.com/users/jrm346/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jrm346/subscriptions", "organizations_url": "https://api.github.com/users/jrm346/orgs", "repos_url": "https://api.github.com/users/jrm346/repos", "events_url": "https://api.github.com/users/jrm346/events{/privacy}", "received_events_url": "https://api.github.com/users/jrm346/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvdillon", "id": 1137078, "node_id": "MDQ6VXNlcjExMzcwNzg=", "avatar_url": "https://avatars0.githubusercontent.com/u/1137078?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvdillon", "html_url": "https://github.com/jvdillon", "followers_url": "https://api.github.com/users/jvdillon/followers", "following_url": "https://api.github.com/users/jvdillon/following{/other_user}", "gists_url": "https://api.github.com/users/jvdillon/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvdillon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvdillon/subscriptions", "organizations_url": "https://api.github.com/users/jvdillon/orgs", "repos_url": "https://api.github.com/users/jvdillon/repos", "events_url": "https://api.github.com/users/jvdillon/events{/privacy}", "received_events_url": "https://api.github.com/users/jvdillon/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvdillon", "id": 1137078, "node_id": "MDQ6VXNlcjExMzcwNzg=", "avatar_url": "https://avatars0.githubusercontent.com/u/1137078?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvdillon", "html_url": "https://github.com/jvdillon", "followers_url": "https://api.github.com/users/jvdillon/followers", "following_url": "https://api.github.com/users/jvdillon/following{/other_user}", "gists_url": "https://api.github.com/users/jvdillon/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvdillon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvdillon/subscriptions", "organizations_url": "https://api.github.com/users/jvdillon/orgs", "repos_url": "https://api.github.com/users/jvdillon/repos", "events_url": "https://api.github.com/users/jvdillon/events{/privacy}", "received_events_url": "https://api.github.com/users/jvdillon/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-10-28T13:51:11Z", "updated_at": "2019-11-01T21:51:25Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using): 2.0\r\n- Are you willing to contribute it (Yes/No): No\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\nin tfp.sts.AutoregressiveStateSpaceModel you cant currently set the mean of the normally distributed noise. this would be nice to add as some auto-regressive models may add a constant term at each time step. the math would then be :\r\n\r\n```python\r\nlevel[t+1] = (sum(coefficients * levels[t:t-order:-1]) +\r\n              Normal(level_mean, level_scale))\r\n```\r\n\r\n**Will this change the current api? How?**\r\nthis would require an additional parameter\r\n\r\n**Who will benefit with this feature?**\r\npeople who want to do auto-regressive models with a constant term\r\n\r\n**Any Other info.**\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33779", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33779/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33779/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33779/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33779", "id": 513237488, "node_id": "MDU6SXNzdWU1MTMyMzc0ODg=", "number": 33779, "title": "tf 1.15.0  retrained ssdlite_mobilenet_v2_coco+focal loss to quantization", "user": {"login": "zychen2016", "id": 23021461, "node_id": "MDQ6VXNlcjIzMDIxNDYx", "avatar_url": "https://avatars0.githubusercontent.com/u/23021461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zychen2016", "html_url": "https://github.com/zychen2016", "followers_url": "https://api.github.com/users/zychen2016/followers", "following_url": "https://api.github.com/users/zychen2016/following{/other_user}", "gists_url": "https://api.github.com/users/zychen2016/gists{/gist_id}", "starred_url": "https://api.github.com/users/zychen2016/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zychen2016/subscriptions", "organizations_url": "https://api.github.com/users/zychen2016/orgs", "repos_url": "https://api.github.com/users/zychen2016/repos", "events_url": "https://api.github.com/users/zychen2016/events{/privacy}", "received_events_url": "https://api.github.com/users/zychen2016/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "suharshs", "id": 1450614, "node_id": "MDQ6VXNlcjE0NTA2MTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/1450614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suharshs", "html_url": "https://github.com/suharshs", "followers_url": "https://api.github.com/users/suharshs/followers", "following_url": "https://api.github.com/users/suharshs/following{/other_user}", "gists_url": "https://api.github.com/users/suharshs/gists{/gist_id}", "starred_url": "https://api.github.com/users/suharshs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suharshs/subscriptions", "organizations_url": "https://api.github.com/users/suharshs/orgs", "repos_url": "https://api.github.com/users/suharshs/repos", "events_url": "https://api.github.com/users/suharshs/events{/privacy}", "received_events_url": "https://api.github.com/users/suharshs/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "suharshs", "id": 1450614, "node_id": "MDQ6VXNlcjE0NTA2MTQ=", "avatar_url": "https://avatars1.githubusercontent.com/u/1450614?v=4", "gravatar_id": "", "url": "https://api.github.com/users/suharshs", "html_url": "https://github.com/suharshs", "followers_url": "https://api.github.com/users/suharshs/followers", "following_url": "https://api.github.com/users/suharshs/following{/other_user}", "gists_url": "https://api.github.com/users/suharshs/gists{/gist_id}", "starred_url": "https://api.github.com/users/suharshs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/suharshs/subscriptions", "organizations_url": "https://api.github.com/users/suharshs/orgs", "repos_url": "https://api.github.com/users/suharshs/repos", "events_url": "https://api.github.com/users/suharshs/events{/privacy}", "received_events_url": "https://api.github.com/users/suharshs/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-10-28T11:07:00Z", "updated_at": "2019-10-29T04:19:55Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):  Ubuntu18.04\r\n- TensorFlow installed from (source or binary):  source\r\n- TensorFlow version (or github SHA if from source): 1.15.0\r\n\r\n\r\nStep1:retrain ssdlite_mobilenet_v2_coco model using focal loss,get model.ckpt\r\nStep2:using export_inference_graph.py to get frozen_inference_graph.pb and saved_model\r\nStep3:using tflite \r\n\r\n```\r\nimport tensorflow as tf\r\nconverter = tf.lite.TFLiteConverter.from_saved_model(path/to/saved_model_dir)\r\nconverter.optimizations = [tf.lite.Optimize.OPTIMIZE_FOR_SIZE]\r\ntflite_quant_model = converter.convert()\r\n```\r\n\r\n```\r\n//error\r\narray.data_type==array.final_data_type Array \"image_tensor\" has mis-matching .....(data_type=uint8,final_data_type=float)\r\n```\r\n\r\nThen, using `saved_model_cli show --dir=./saved_model --all` \r\n\r\nouput is\r\n\r\n```\r\nsignature_def['serving_default']:\r\n  The given SavedModel SignatureDef contains the following input(s):\r\n    inputs['inputs'] tensor_info:\r\n        dtype: DT_UINT8\r\n        shape: (-1, -1, -1, 3)\r\n        name: image_tensor:0\r\n  The given SavedModel SignatureDef contains the following output(s):\r\n    outputs['detection_boxes'] tensor_info:\r\n        dtype: DT_FLOAT\r\n        shape: (-1, 100, 4)\r\n        name: detection_boxes:0\r\n    outputs['detection_classes'] tensor_info:\r\n        dtype: DT_FLOAT\r\n        shape: (-1, 100)\r\n        name: detection_classes:0\r\n    outputs['detection_scores'] tensor_info:\r\n        dtype: DT_FLOAT\r\n        shape: (-1, 100)\r\n        name: detection_scores:0\r\n    outputs['num_detections'] tensor_info:\r\n        dtype: DT_FLOAT\r\n        shape: (-1)\r\n        name: num_detections:0\r\n  Method name is: tensorflow/serving/predict\r\n```\r\n\r\n1.Just means , my saved_model input is unit8 and output is float32, could not using tf-lite to quantization?\r\n2. Could get ssd_mobilenet_v2 quantized model without config parameter,it means train again!!\r\n`graph_rewriter {quantization {....}}`\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33778", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33778/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33778/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33778/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33778", "id": 513229311, "node_id": "MDU6SXNzdWU1MTMyMjkzMTE=", "number": 33778, "title": "Example of \"audio recognition\" trained in tf-1.15.0 isn't able to recognize sound \"Yes\" on SparkFun Edge development board.", "user": {"login": "huaxiaozhong1", "id": 20430028, "node_id": "MDQ6VXNlcjIwNDMwMDI4", "avatar_url": "https://avatars2.githubusercontent.com/u/20430028?v=4", "gravatar_id": "", "url": "https://api.github.com/users/huaxiaozhong1", "html_url": "https://github.com/huaxiaozhong1", "followers_url": "https://api.github.com/users/huaxiaozhong1/followers", "following_url": "https://api.github.com/users/huaxiaozhong1/following{/other_user}", "gists_url": "https://api.github.com/users/huaxiaozhong1/gists{/gist_id}", "starred_url": "https://api.github.com/users/huaxiaozhong1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/huaxiaozhong1/subscriptions", "organizations_url": "https://api.github.com/users/huaxiaozhong1/orgs", "repos_url": "https://api.github.com/users/huaxiaozhong1/repos", "events_url": "https://api.github.com/users/huaxiaozhong1/events{/privacy}", "received_events_url": "https://api.github.com/users/huaxiaozhong1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rockyrhodes", "id": 7253968, "node_id": "MDQ6VXNlcjcyNTM5Njg=", "avatar_url": "https://avatars2.githubusercontent.com/u/7253968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rockyrhodes", "html_url": "https://github.com/rockyrhodes", "followers_url": "https://api.github.com/users/rockyrhodes/followers", "following_url": "https://api.github.com/users/rockyrhodes/following{/other_user}", "gists_url": "https://api.github.com/users/rockyrhodes/gists{/gist_id}", "starred_url": "https://api.github.com/users/rockyrhodes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rockyrhodes/subscriptions", "organizations_url": "https://api.github.com/users/rockyrhodes/orgs", "repos_url": "https://api.github.com/users/rockyrhodes/repos", "events_url": "https://api.github.com/users/rockyrhodes/events{/privacy}", "received_events_url": "https://api.github.com/users/rockyrhodes/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rockyrhodes", "id": 7253968, "node_id": "MDQ6VXNlcjcyNTM5Njg=", "avatar_url": "https://avatars2.githubusercontent.com/u/7253968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rockyrhodes", "html_url": "https://github.com/rockyrhodes", "followers_url": "https://api.github.com/users/rockyrhodes/followers", "following_url": "https://api.github.com/users/rockyrhodes/following{/other_user}", "gists_url": "https://api.github.com/users/rockyrhodes/gists{/gist_id}", "starred_url": "https://api.github.com/users/rockyrhodes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rockyrhodes/subscriptions", "organizations_url": "https://api.github.com/users/rockyrhodes/orgs", "repos_url": "https://api.github.com/users/rockyrhodes/repos", "events_url": "https://api.github.com/users/rockyrhodes/events{/privacy}", "received_events_url": "https://api.github.com/users/rockyrhodes/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-10-28T10:49:23Z", "updated_at": "2020-01-22T01:23:16Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): no.\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04.\r\n- TensorFlow installed from (source or binary):\r\nCreated a docker container from docker image: tensorflow/tensorflow:1.15.0-gpu-py3-jupyter.\r\nInside the container, got tensorflow source tree through the following steps:\r\n```\r\nmkdir tensorflow\r\ncd tensorflow\r\ngit init\r\ngit remote add origin https://github.com/tensorflow/tensorflow.git\r\ngit ls-remote --tags origin | grep 1.15.0\r\n38ea9bbfea423eb968fcc70bc454471277c9537c\trefs/tags/v1.15.0\r\ngit pull origin refs/tags/v1.15.0\r\n```\r\n- TensorFlow version (use command below): v1.15.0.\r\n- Python version: 3.6.8.\r\n- Bazel version (if compiling from source): neither installed nor used. \r\n- GCC/Compiler version (if compiling from source): gcc version 7.4.0 (Ubuntu 7.4.0-1ubuntu1~18.04.1). \r\n- CUDA/cuDNN version:  compute capability: 5.2. \r\n- GPU model and memory: GeForce GTX 960. \r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\nv1.15.0-rc3-22-g590d6ee 1.15.0\r\n\r\n**Describe the current behavior**\r\nGoing through the following steps (for all the steps in details, please see **Code to reproduce the issue** ), SparkFun Edge board was be flashed successfully. But it wasn't able to recognize the sound \u201cYes\u201d :-(\r\n\r\n**Describe the expected behavior**\r\nIf flashing the board with [the binary tf model](tensorflow/tensorflow/lite/experimental/micro/examples/micro_speech/simple_features/tiny_conv_simple_features_model_data.cc) that tf source tree brings, the sound \u201cYes\u201d was recognized perfectly.\r\nCould you let us know the exact environment and procedure that your tiny_conv_simple_features_model_data.cc was generated in? \r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n### 1, Training model (refer to [Training model on your local machine](https://github.com/tensorflow/tensorflow/tree/master/tensorflow/lite/experimental/micro/examples/micro_speech#use-your-local-machine)). \r\n#### 1.1, In the same container that we got in \u201c**System information**\u201d.\r\n#### 1.2, \r\n```\r\npython tensorflow/tensorflow/examples/speech_commands/train.py \\\r\n--model_architecture=tiny_conv --window_stride=20 --preprocess=micro \\\r\n--wanted_words=\"yes,no\" --silence_percentage=25 --unknown_percentage=25 \\\r\n--quantize=1 --verbosity=INFO --how_many_training_steps=\"15000,3000\" \\\r\n--learning_rate=\"0.001,0.0001\" --summaries_dir=/tmp/retrain_logs \\\r\n--data_dir=/tmp/speech_dataset \u2013train_dir=/tmp/speech_commands_train\r\n```\r\nThe training reached ~90%  accuracy, see [191028.log](https://github.com/tensorflow/tensorflow/files/3778241/191028.log.tar.gz) as attached.\r\n\r\n#### 1.3, \r\n```\r\npython tensorflow/tensorflow/examples/speech_commands/freeze.py \\\r\n--model_architecture=tiny_conv --window_stride=20 --preprocess=micro \\\r\n--wanted_words=\"yes,no\" --quantize=1 --output_file=/tmp/tiny_conv.pb \\\r\n--start_checkpoint=/tmp/speech_commands_train/tiny_conv.ckpt-18000\r\n```\r\n#### 1.4, \r\n```\r\ntoco \\\r\n--graph_def_file=/tmp/tiny_conv.pb --output_file=/tmp/tiny_conv.tflite \\\r\n--input_shapes=1,49,40,1 --input_arrays=Reshape_2 --output_arrays='labels_softmax' \\\r\n--inference_type=QUANTIZED_UINT8 --mean_values=0 --std_dev_values=9.8077\r\n```\r\n#### 1.5,   \r\n```\r\nxxd -i /tmp/tiny_conv.tflite > /tmp/tiny_conv_micro_features_model_data.cc\r\n```\r\n#### 1.6,\r\nModified the binary model file to [tiny_conv_micro_features_model_data.new.cc](https://github.com/tensorflow/tensorflow/files/3778266/tiny_conv_micro_features_model_data.new.cc.gz) as attached, put it into tensorflow/lite/experimental/micro/examples/micro_speech/micro_features\r\n### 2, Flashed the model, (refer to [Deploy to SparkFun Edge](https://github.com/tensorflow/tensorflow/tree/master/tensorflow/lite/experimental/micro/examples/micro_speech#deploy-to-sparkfun-edge)).\r\n#### 2.1, \r\n```\r\nmake -f tensorflow/lite/experimental/micro/tools/make/Makefile TARGET=sparkfun_edge TAGS=\"CMSIS\" micro_speech_bin\r\n```\r\n#### 2.2, \r\n```\r\ncp tensorflow/lite/experimental/micro/tools/make/downloads/AmbiqSuite-Rel2.0.0/tools/apollo3_scripts/keys_info0.py \\\r\ntensorflow/lite/experimental/micro/tools/make/downloads/AmbiqSuite-Rel2.0.0/tools/apollo3_scripts/keys_info.py\r\n```\r\n#### 2.3,\r\n```\r\npython3 tensorflow/lite/experimental/micro/tools/make/downloads/AmbiqSuite-Rel2.0.0/tools/apollo3_scripts/create_cust_image_blob.py \\\r\n--bin tensorflow/lite/experimental/micro/tools/make/gen/sparkfun_edge_cortex-m4/bin/micro_speech.bin \\\r\n--load-address 0xC000 \\\r\n--magic-num 0xCB \\\r\n-o main_nonsecure_ota \\\r\n--version 0x0\r\n```\r\n#### 2.4, \r\n```\r\npython3 tensorflow/lite/experimental/micro/tools/make/downloads/AmbiqSuite-Rel2.0.0/tools/apollo3_scripts/create_cust_wireupdate_blob.py \\\r\n--load-address 0x20000 \\\r\n--bin main_nonsecure_ota.bin \\\r\n-i 6 \\\r\n-o main_nonsecure_wire \\\r\n--options 0x1\r\n```\r\n#### 2.5,\r\nWalked through [AI on a microcontroller with TensorFlow Lite and SparkFun Edge](https://codelabs.developers.google.com/codelabs/sparkfun-tensorflow/#0), flashed our program and bootloader into the board. \r\nTest it then. \r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33777", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33777/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33777/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33777/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33777", "id": 513212565, "node_id": "MDU6SXNzdWU1MTMyMTI1NjU=", "number": 33777, "title": "Tensorflow Probability distributions HiddenMarkovModel not working with tf.function", "user": {"login": "jrm346", "id": 19378610, "node_id": "MDQ6VXNlcjE5Mzc4NjEw", "avatar_url": "https://avatars2.githubusercontent.com/u/19378610?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jrm346", "html_url": "https://github.com/jrm346", "followers_url": "https://api.github.com/users/jrm346/followers", "following_url": "https://api.github.com/users/jrm346/following{/other_user}", "gists_url": "https://api.github.com/users/jrm346/gists{/gist_id}", "starred_url": "https://api.github.com/users/jrm346/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jrm346/subscriptions", "organizations_url": "https://api.github.com/users/jrm346/orgs", "repos_url": "https://api.github.com/users/jrm346/repos", "events_url": "https://api.github.com/users/jrm346/events{/privacy}", "received_events_url": "https://api.github.com/users/jrm346/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1190546177, "node_id": "MDU6TGFiZWwxMTkwNTQ2MTc3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:autograph", "name": "comp:autograph", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "brianwa84", "id": 22173987, "node_id": "MDQ6VXNlcjIyMTczOTg3", "avatar_url": "https://avatars0.githubusercontent.com/u/22173987?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brianwa84", "html_url": "https://github.com/brianwa84", "followers_url": "https://api.github.com/users/brianwa84/followers", "following_url": "https://api.github.com/users/brianwa84/following{/other_user}", "gists_url": "https://api.github.com/users/brianwa84/gists{/gist_id}", "starred_url": "https://api.github.com/users/brianwa84/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brianwa84/subscriptions", "organizations_url": "https://api.github.com/users/brianwa84/orgs", "repos_url": "https://api.github.com/users/brianwa84/repos", "events_url": "https://api.github.com/users/brianwa84/events{/privacy}", "received_events_url": "https://api.github.com/users/brianwa84/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "brianwa84", "id": 22173987, "node_id": "MDQ6VXNlcjIyMTczOTg3", "avatar_url": "https://avatars0.githubusercontent.com/u/22173987?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brianwa84", "html_url": "https://github.com/brianwa84", "followers_url": "https://api.github.com/users/brianwa84/followers", "following_url": "https://api.github.com/users/brianwa84/following{/other_user}", "gists_url": "https://api.github.com/users/brianwa84/gists{/gist_id}", "starred_url": "https://api.github.com/users/brianwa84/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brianwa84/subscriptions", "organizations_url": "https://api.github.com/users/brianwa84/orgs", "repos_url": "https://api.github.com/users/brianwa84/repos", "events_url": "https://api.github.com/users/brianwa84/events{/privacy}", "received_events_url": "https://api.github.com/users/brianwa84/received_events", "type": "User", "site_admin": false}, {"login": "mdanatg", "id": 26628547, "node_id": "MDQ6VXNlcjI2NjI4NTQ3", "avatar_url": "https://avatars1.githubusercontent.com/u/26628547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mdanatg", "html_url": "https://github.com/mdanatg", "followers_url": "https://api.github.com/users/mdanatg/followers", "following_url": "https://api.github.com/users/mdanatg/following{/other_user}", "gists_url": "https://api.github.com/users/mdanatg/gists{/gist_id}", "starred_url": "https://api.github.com/users/mdanatg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mdanatg/subscriptions", "organizations_url": "https://api.github.com/users/mdanatg/orgs", "repos_url": "https://api.github.com/users/mdanatg/repos", "events_url": "https://api.github.com/users/mdanatg/events{/privacy}", "received_events_url": "https://api.github.com/users/mdanatg/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-10-28T10:16:42Z", "updated_at": "2019-11-05T09:13:56Z", "closed_at": null, "author_association": "NONE", "body": "using tensorflow 2.0 on cpu\r\n\r\nthe following function works with no errors when executing in eager mode, but if it is decorated with `@tf.function` i get the error at the bottom.\r\n\r\n```python\r\ndef generate_data(size, p_0, p_0_0, p_1_1, mu0, s0, mu1, s1):\r\n    states = tfd.Categorical(probs=[p_0, 1-p_0])\r\n\r\n    transition = tfd.Categorical(probs=[[p_0_0, 1 - p_0_0],\r\n                                        [1 - p_1_1, p_1_1]])\r\n\r\n    emission = tfd.Normal(loc=[mu0, mu1], scale=[s0, s1])\r\n\r\n    model = tfd.HiddenMarkovModel(states, transition, emission, size)\r\n\r\n    return model.sample()\r\n\r\ndata = generate_data(50, 0.01, 0.3, 0.7, -10, 2, 10, 3)\r\n\r\nprint(data)\r\n```\r\nand the error\r\n```\r\ntraceback (most recent call last):\r\n  File \"/home/abaka/Abaka.FIN.Apis/test.py\", line 21, in <module>\r\n    data = generate_data(50, 0.01, 0.3, 0.7, -10, 2, 10, 3)\r\n  File \"/home/abaka/venv/Abaka.FIN.Apis/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py\", line 457, in __call__\r\n    result = self._call(*args, **kwds)\r\n  File \"/home/abaka/venv/Abaka.FIN.Apis/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py\", line 503, in _call\r\n    self._initialize(args, kwds, add_initializers_to=initializer_map)\r\n  File \"/home/abaka/venv/Abaka.FIN.Apis/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py\", line 408, in _initialize\r\n    *args, **kwds))\r\n  File \"/home/abaka/venv/Abaka.FIN.Apis/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 1848, in _get_concrete_function_internal_garbage_collected\r\n    graph_function, _, _ = self._maybe_define_function(args, kwargs)\r\n  File \"/home/abaka/venv/Abaka.FIN.Apis/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 2150, in _maybe_define_function\r\n    graph_function = self._create_graph_function(args, kwargs)\r\n  File \"/home/abaka/venv/Abaka.FIN.Apis/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 2041, in _create_graph_function\r\n    capture_by_value=self._capture_by_value),\r\n  File \"/home/abaka/venv/Abaka.FIN.Apis/lib/python3.6/site-packages/tensorflow_core/python/framework/func_graph.py\", line 915, in func_graph_from_py_func\r\n    func_outputs = python_func(*func_args, **func_kwargs)\r\n  File \"/home/abaka/venv/Abaka.FIN.Apis/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py\", line 358, in wrapped_fn\r\n    return weak_wrapped_fn().__wrapped__(*args, **kwds)\r\n  File \"/home/abaka/venv/Abaka.FIN.Apis/lib/python3.6/site-packages/tensorflow_core/python/framework/func_graph.py\", line 905, in wrapper\r\n    raise e.ag_error_metadata.to_exception(e)\r\nValueError: in converted code:\r\n    relative to /home/abaka:\r\n\r\n    Abaka.FIN.Apis/test.py:19 generate_data  *\r\n        return model.sample()\r\n    venv/Abaka.FIN.Apis/lib/python3.6/site-packages/tensorflow_probability/python/distributions/distribution.py:848 sample\r\n        return self._call_sample_n(sample_shape, seed, name, **kwargs)\r\n    venv/Abaka.FIN.Apis/lib/python3.6/site-packages/tensorflow_probability/python/distributions/distribution.py:826 _call_sample_n\r\n        samples = self._sample_n(n, seed, **kwargs)\r\n    venv/Abaka.FIN.Apis/lib/python3.6/site-packages/tensorflow_probability/python/distributions/hidden_markov_model.py:406 _sample_n\r\n        lambda: init_state[tf.newaxis, ...])\r\n    venv/Abaka.FIN.Apis/lib/python3.6/site-packages/tensorflow_probability/python/internal/prefer_static.py:176 cond\r\n        return true_fn()\r\n    venv/Abaka.FIN.Apis/lib/python3.6/site-packages/tensorflow_probability/python/distributions/hidden_markov_model.py:397 _scan_multiple_steps\r\n        initializer=init_state)\r\n    venv/Abaka.FIN.Apis/lib/python3.6/site-packages/tensorflow_core/python/ops/functional_ops.py:508 scan\r\n        maximum_iterations=n)\r\n    venv/Abaka.FIN.Apis/lib/python3.6/site-packages/tensorflow_core/python/ops/control_flow_ops.py:2675 while_loop\r\n        back_prop=back_prop)\r\n    venv/Abaka.FIN.Apis/lib/python3.6/site-packages/tensorflow_core/python/ops/while_v2.py:234 while_loop\r\n        len_orig_loop_vars], expand_composites=True))\r\n    venv/Abaka.FIN.Apis/lib/python3.6/site-packages/tensorflow_core/python/ops/while_v2.py:1068 _check_shapes_compat\r\n        \"specify a less-specific shape.\" % (input_t.name, shape, t.shape))\r\n\r\n    ValueError: Input tensor 'HiddenMarkovModel_1/sample/Reshape:0' enters the loop with shape (1, 1), but has shape (1, None) after one iteration. To allow the shape to vary across iterations, use the `shape_invariants` argument of tf.while_loop to specify a less-specific shape.\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33775", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33775/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33775/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33775/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33775", "id": 513178210, "node_id": "MDU6SXNzdWU1MTMxNzgyMTA=", "number": 33775, "title": "For tf2.0, why both tf.keras and tf.nn exist in the new version of Tensorflow? ", "user": {"login": "Zhengtq", "id": 12445765, "node_id": "MDQ6VXNlcjEyNDQ1NzY1", "avatar_url": "https://avatars3.githubusercontent.com/u/12445765?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Zhengtq", "html_url": "https://github.com/Zhengtq", "followers_url": "https://api.github.com/users/Zhengtq/followers", "following_url": "https://api.github.com/users/Zhengtq/following{/other_user}", "gists_url": "https://api.github.com/users/Zhengtq/gists{/gist_id}", "starred_url": "https://api.github.com/users/Zhengtq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Zhengtq/subscriptions", "organizations_url": "https://api.github.com/users/Zhengtq/orgs", "repos_url": "https://api.github.com/users/Zhengtq/repos", "events_url": "https://api.github.com/users/Zhengtq/events{/privacy}", "received_events_url": "https://api.github.com/users/Zhengtq/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-10-28T09:05:32Z", "updated_at": "2020-02-13T15:55:05Z", "closed_at": null, "author_association": "NONE", "body": "I found that tf.keras and tf.nn could do the same thing, so why keep both tf.keras and tf.nn existed in the new version of tf2.0?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33769", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33769/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33769/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33769/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33769", "id": 513065998, "node_id": "MDU6SXNzdWU1MTMwNjU5OTg=", "number": 33769, "title": "For tensorflow1.15: undefined symbol: ncclBroadcast", "user": {"login": "ivankxt", "id": 42996988, "node_id": "MDQ6VXNlcjQyOTk2OTg4", "avatar_url": "https://avatars3.githubusercontent.com/u/42996988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ivankxt", "html_url": "https://github.com/ivankxt", "followers_url": "https://api.github.com/users/ivankxt/followers", "following_url": "https://api.github.com/users/ivankxt/following{/other_user}", "gists_url": "https://api.github.com/users/ivankxt/gists{/gist_id}", "starred_url": "https://api.github.com/users/ivankxt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ivankxt/subscriptions", "organizations_url": "https://api.github.com/users/ivankxt/orgs", "repos_url": "https://api.github.com/users/ivankxt/repos", "events_url": "https://api.github.com/users/ivankxt/events{/privacy}", "received_events_url": "https://api.github.com/users/ivankxt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-10-28T02:32:42Z", "updated_at": "2019-10-30T04:46:04Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version: 1.15.0\r\n- Python version: 3.7\r\n- Installed using virtualenv? pip? conda?: pip3.7\r\n- Bazel version (if compiling from source): 0.26.0\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: cuda10.0/cuDNN7.5.1\r\n- GPU model and memory:\r\n\r\n\r\n\r\n**Describe the problem**\r\nThis has happened after install  Tensorflow1.15.0 from the source\r\n1. bazel build:\r\nbazel build --config=opt --config=cuda //tensorflow/tools/pip_package:build_pip_package\r\nand then:\r\nbazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow-1.15\r\nwe got:\r\n/tmp/tensorflow-1.15/tensorflow-1.15.0-cp37-cp37m-linux_x86_64.whl\r\n\r\n2. install tensorflow:\r\npip install /tmp/tensorflow-1.15/tensorflow-1.15.0-cp37-cp37m-linux_x86_64.whl\r\n\r\n3. Check if the installation is successful:\r\n#python -c \"import tensorflow as tf; print(tf.__version__)\"\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.7/site-packages/tensorflow_core/python/pywrap_tensorflow.py\", line 58, in <module>\r\n    from tensorflow.python.pywrap_tensorflow_internal import *\r\n  File \"/usr/local/lib/python3.7/site-packages/tensorflow_core/python/pywrap_tensorflow_internal.py\", line 28, in <module>\r\n    _pywrap_tensorflow_internal = swig_import_helper()\r\n  File \"/usr/local/lib/python3.7/site-packages/tensorflow_core/python/pywrap_tensorflow_internal.py\", line 24, in swig_import_helper\r\n    _mod = imp.load_module('_pywrap_tensorflow_internal', fp, pathname, description)\r\n  File \"/usr/local/lib/python3.7/imp.py\", line 242, in load_module\r\n    return load_dynamic(name, filename, file)\r\n  File \"/usr/local/lib/python3.7/imp.py\", line 342, in load_dynamic\r\n    return _load(spec)\r\nImportError: /usr/local/lib/python3.7/site-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so: undefined symbol: ncclBroadcast\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"<string>\", line 1, in <module>\r\n  File \"/usr/local/lib/python3.7/site-packages/tensorflow/__init__.py\", line 99, in <module>\r\n    from tensorflow_core import *\r\n  File \"/usr/local/lib/python3.7/site-packages/tensorflow_core/__init__.py\", line 28, in <module>\r\n    from tensorflow.python import pywrap_tensorflow  # pylint: disable=unused-import\r\n  File \"/usr/local/lib/python3.7/site-packages/tensorflow/__init__.py\", line 50, in __getattr__\r\n    module = self._load()\r\n  File \"/usr/local/lib/python3.7/site-packages/tensorflow/__init__.py\", line 44, in _load\r\n    module = _importlib.import_module(self.__name__)\r\n  File \"/usr/local/lib/python3.7/importlib/__init__.py\", line 127, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\n  File \"/usr/local/lib/python3.7/site-packages/tensorflow_core/python/__init__.py\", line 49, in <module>\r\n    from tensorflow.python import pywrap_tensorflow\r\n  File \"/usr/local/lib/python3.7/site-packages/tensorflow_core/python/pywrap_tensorflow.py\", line 74, in <module>\r\n    raise ImportError(msg)\r\nImportError: Traceback (most recent call last):\r\n  File \"/usr/local/lib/python3.7/site-packages/tensorflow_core/python/pywrap_tensorflow.py\", line 58, in <module>\r\n    from tensorflow.python.pywrap_tensorflow_internal import *\r\n  File \"/usr/local/lib/python3.7/site-packages/tensorflow_core/python/pywrap_tensorflow_internal.py\", line 28, in <module>\r\n    _pywrap_tensorflow_internal = swig_import_helper()\r\n  File \"/usr/local/lib/python3.7/site-packages/tensorflow_core/python/pywrap_tensorflow_internal.py\", line 24, in swig_import_helper\r\n    _mod = imp.load_module('_pywrap_tensorflow_internal', fp, pathname, description)\r\n  File \"/usr/local/lib/python3.7/imp.py\", line 242, in load_module\r\n    return load_dynamic(name, filename, file)\r\n  File \"/usr/local/lib/python3.7/imp.py\", line 342, in load_dynamic\r\n    return _load(spec)\r\nImportError: /usr/local/lib/python3.7/site-packages/tensorflow_core/python/_pywrap_tensorflow_internal.so: undefined symbol: ncclBroadcast\r\n\r\n\r\nFailed to load the native TensorFlow runtime.\r\n\r\nSee https://www.tensorflow.org/install/errors\r\n\r\nfor some common reasons and solutions.  Include the entire stack trace\r\nabove this error message when asking for help.\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33762", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33762/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33762/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33762/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33762", "id": 512993671, "node_id": "MDU6SXNzdWU1MTI5OTM2NzE=", "number": 33762, "title": "Cannot Get Older Versions to Build", "user": {"login": "l0ophole", "id": 19521547, "node_id": "MDQ6VXNlcjE5NTIxNTQ3", "avatar_url": "https://avatars3.githubusercontent.com/u/19521547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/l0ophole", "html_url": "https://github.com/l0ophole", "followers_url": "https://api.github.com/users/l0ophole/followers", "following_url": "https://api.github.com/users/l0ophole/following{/other_user}", "gists_url": "https://api.github.com/users/l0ophole/gists{/gist_id}", "starred_url": "https://api.github.com/users/l0ophole/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/l0ophole/subscriptions", "organizations_url": "https://api.github.com/users/l0ophole/orgs", "repos_url": "https://api.github.com/users/l0ophole/repos", "events_url": "https://api.github.com/users/l0ophole/events{/privacy}", "received_events_url": "https://api.github.com/users/l0ophole/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-10-27T17:06:06Z", "updated_at": "2019-11-12T09:12:25Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Arch Linux\r\n- TensorFlow installed from source\r\n- TensorFlow version: 1.13.0\r\n- Python version: 3.7\r\n- Not Installed using virtualenv, pip or conda\r\n- Bazel version: 0.25.3\r\n- GCC/Compiler version: 9.2.0\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: RS880M (Mobility Radeon HD 4225/4250) (256MB)\r\n\r\nI've been trying to build version 1.13.0 of tensorflow for the past two days. I need a build that was compiled with \"-mno-avx\" because my CPU does not support the AVX instruction set and tensorflow crashes when I run it. I need tensorflow for a project I'm trying to install.\r\n\r\nI read that new versions of glibc conflict with the source code and that the source code must be patched to build with as newer version of glibc. I am getting errors about \"gettid()\" being ambiguous. I found reference to someone patching the source code and changing gettid() to sys_gettid(), but I cannot find the patch that was used.\r\n\r\nI also tried changing the function calls manually in the ~/.cache/bazel directory but Bazel will not compile with the cached source code. It seems to redownload the source code before every build. \r\n\r\nThe command that I used to start the build:\r\n```\r\nbazel build --config=opt //tensorflow/tools/pip_package:build_pip_package\r\n```\r\n\r\nError:\r\n```\r\nERROR: /home/***/.cache/bazel/_bazel_***/06b70ca2a990d8a0456251480c3991dd/external/grpc/BUILD:507:1: C++ compilation of rule '@grpc//:gpr_base' failed (Exit 1)\r\n                 external/grpc/src/core/lib/gpr/log_linux.cc:43:13: error: ambiguating new declaration of 'long int gettid()'\r\n43 | static long gettid(void) { return syscall(__NR_gettid); }        |             ^~~~~~                                         \r\nIn file included from /usr/include/unistd.h:1170,                                   from external/grpc/src/core/lib/gpr/log_linux.cc:41:                                                                 \r\n/usr/include/bits/unistd_ext.h:34:16: note: old declaration '__pid_t gettid()'                                                           \r\n34 | extern __pid_t gettid (void) __THROW;                            |                ^~~~~~                                      \r\nexternal/grpc/src/core/lib/gpr/log_linux.cc:43:13: warning: 'long int gettid()' defined but not used [-Wunused-function]                 \r\n43 | static long gettid(void) { return syscall(__NR_gettid); }        |             ^~~~~~                                         \r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build                                                               \r\nUse --verbose_failures to see the command lines of failed build steps.                                                                INFO: Elapsed time: 14263.127s, Critical Path: 457.22s\r\nINFO: 4301 processes: 4301 local.\r\nFAILED: Build did NOT complete successfully\r\n```\r\n\r\n![Screenshot_20191027-114439](https://user-images.githubusercontent.com/19521547/67638409-11eb2100-f8b2-11e9-8767-aed639721262.png)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33759", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33759/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33759/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33759/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33759", "id": 512958946, "node_id": "MDU6SXNzdWU1MTI5NTg5NDY=", "number": 33759, "title": "What is the right way to use coverage.py with Tensorflow?", "user": {"login": "nedbat", "id": 23789, "node_id": "MDQ6VXNlcjIzNzg5", "avatar_url": "https://avatars1.githubusercontent.com/u/23789?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nedbat", "html_url": "https://github.com/nedbat", "followers_url": "https://api.github.com/users/nedbat/followers", "following_url": "https://api.github.com/users/nedbat/following{/other_user}", "gists_url": "https://api.github.com/users/nedbat/gists{/gist_id}", "starred_url": "https://api.github.com/users/nedbat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nedbat/subscriptions", "organizations_url": "https://api.github.com/users/nedbat/orgs", "repos_url": "https://api.github.com/users/nedbat/repos", "events_url": "https://api.github.com/users/nedbat/events{/privacy}", "received_events_url": "https://api.github.com/users/nedbat/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-10-27T12:22:06Z", "updated_at": "2020-02-03T16:13:13Z", "closed_at": null, "author_association": "NONE", "body": "I apologize if this is the wrong way to ask this question. I'm the maintainer of coverage.py, for measuring code coverage in Python projects.  A user wrote an issue for me: https://github.com/nedbat/coveragepy/issues/856\r\n\r\nAfter digging into it, I see that his tf.keras.Model.call() function is not executed directly, but is transformed into a temporary file, and executed there.  So coverage.py reports that his code is unexecuted, even though he can see the effects of its execution.\r\n\r\nI also see that the transformed code has an `ag_source_map__` parameter which can be used to map back from the transformed code to the original code.  A coverage.py plugin could use that information to report coverage usefully.\r\n\r\nMy questions are:\r\n1. Is there a reason people haven't reported this to coverage.py before? Is there a existing known way to get coverage reports on this kind of code?\r\n2. What is a stable public API for getting the transformation mapping?\r\n3. Would TensorFlow be interested in maintaining a coverage.py plugin to make this work properly?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33757", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33757/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33757/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33757/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33757", "id": 512942175, "node_id": "MDU6SXNzdWU1MTI5NDIxNzU=", "number": 33757, "title": "Inclusion of a model re-training example", "user": {"login": "sayakpaul", "id": 22957388, "node_id": "MDQ6VXNlcjIyOTU3Mzg4", "avatar_url": "https://avatars3.githubusercontent.com/u/22957388?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sayakpaul", "html_url": "https://github.com/sayakpaul", "followers_url": "https://api.github.com/users/sayakpaul/followers", "following_url": "https://api.github.com/users/sayakpaul/following{/other_user}", "gists_url": "https://api.github.com/users/sayakpaul/gists{/gist_id}", "starred_url": "https://api.github.com/users/sayakpaul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sayakpaul/subscriptions", "organizations_url": "https://api.github.com/users/sayakpaul/orgs", "repos_url": "https://api.github.com/users/sayakpaul/repos", "events_url": "https://api.github.com/users/sayakpaul/events{/privacy}", "received_events_url": "https://api.github.com/users/sayakpaul/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-10-27T09:29:50Z", "updated_at": "2019-10-28T21:05:26Z", "closed_at": null, "author_association": "NONE", "body": "## URL(s) with the issue: [https://www.tensorflow.org/tutorials/keras/save_and_load](https://www.tensorflow.org/tutorials/keras/save_and_load)\r\n\r\nPlease provide a link to the documentation entry, for example:\r\nhttps://www.tensorflow.org/tutorials/keras/save_and_load\r\n\r\n## Description of issue (what needs changing):\r\n\r\nSince model re-training is quite vital in both applied and research-based environments, I think it would be great to include an example on the same in this tutorial. \r\n\r\n### Clear description\r\n\r\nThe tutorial shows how to save and load models using various options. It does mention that using the model checkpoints it is possible to train the model from the point it was left off. However, currently, there is no section in the tutorial that shows how to do that in the correct way. \r\n\r\nFor example, why should someone use this method? How is it useful?\r\n\r\nThere are several instances where a model may have to be retrained:\r\n- There is new data and the model needs to re-trained on that\r\n- If we are on local machines and if there is a power failure or bottlenecks that cause the training process to stop, we can always load up the latest checkpoints and re-train the models from there. "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33755", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33755/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33755/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33755/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33755", "id": 512936747, "node_id": "MDU6SXNzdWU1MTI5MzY3NDc=", "number": 33755, "title": "Dense variable constraints are not allowed with sparse gradients", "user": {"login": "skearnes", "id": 952729, "node_id": "MDQ6VXNlcjk1MjcyOQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/952729?v=4", "gravatar_id": "", "url": "https://api.github.com/users/skearnes", "html_url": "https://github.com/skearnes", "followers_url": "https://api.github.com/users/skearnes/followers", "following_url": "https://api.github.com/users/skearnes/following{/other_user}", "gists_url": "https://api.github.com/users/skearnes/gists{/gist_id}", "starred_url": "https://api.github.com/users/skearnes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/skearnes/subscriptions", "organizations_url": "https://api.github.com/users/skearnes/orgs", "repos_url": "https://api.github.com/users/skearnes/repos", "events_url": "https://api.github.com/users/skearnes/events{/privacy}", "received_events_url": "https://api.github.com/users/skearnes/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-10-27T08:31:07Z", "updated_at": "2020-03-13T03:25:02Z", "closed_at": null, "author_association": "NONE", "body": "I'm training a simple document embedding model with the Keras API in TF 2.0. When I try to add `embeddings_constraint=tf.keras.constraints.UnitNorm(axis=1)` to an `Embedding` layer, I get the following error (truncated):\r\n\r\n```\r\nFile \"C:\\Users\\Steven\\Miniconda3\\lib\\site-packages\\tensorflow_core\\python\\keras\\optimizer_v2\\optimizer_v2.py\", line 459, in apply_grad_to_update_var\r\n    \"Cannot use a constraint function on a sparse variable.\")\r\n```\r\n\r\nI have verified that the variable is not sparse; the `Embedding` layer creates a dense matrix to hold the embeddings. However, reading [the code](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/training/optimizer.py#L126) shows that this error is raised when the *gradients* are sparse, which seems normal for embedding layers and should not (AFAIK) affect the application of constraints to the dense variable after the gradient update.\r\n\r\n**In summary, variable constraints should be allowed in this context, and it is a bug that they are not.**"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33751", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33751/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33751/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33751/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33751", "id": 512908482, "node_id": "MDU6SXNzdWU1MTI5MDg0ODI=", "number": 33751, "title": "Resize layers in model producing LookupError when computing gradients", "user": {"login": "sxsheng", "id": 37102188, "node_id": "MDQ6VXNlcjM3MTAyMTg4", "avatar_url": "https://avatars0.githubusercontent.com/u/37102188?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sxsheng", "html_url": "https://github.com/sxsheng", "followers_url": "https://api.github.com/users/sxsheng/followers", "following_url": "https://api.github.com/users/sxsheng/following{/other_user}", "gists_url": "https://api.github.com/users/sxsheng/gists{/gist_id}", "starred_url": "https://api.github.com/users/sxsheng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sxsheng/subscriptions", "organizations_url": "https://api.github.com/users/sxsheng/orgs", "repos_url": "https://api.github.com/users/sxsheng/repos", "events_url": "https://api.github.com/users/sxsheng/events{/privacy}", "received_events_url": "https://api.github.com/users/sxsheng/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-10-27T01:59:22Z", "updated_at": "2020-03-16T16:55:40Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):18.04\r\n- TensorFlow version (use command below):2.0\r\n- Python version:3.6.8\r\n- CUDA/cuDNN version:10.0/6.7.0\r\n- GPU model and memory:GTX 1080ti\r\n\r\n**Describe the current behavior**\r\nCurrently, I'm getting `LookupError: gradient registry has no entry for ResizeBilinearGrad` when its computing tape.gradient(d_loss, D.trainable_variables) in the code below.\r\n\r\n**Describe the expected behavior**\r\nThe code should just run and update the parameters per usual.\r\n\r\n**Code to reproduce the issue**\r\n~~~~\r\nfrom tensorflow.keras.layers import Input, Dense, Flatten, Conv2D, ReLU, Lambda, MaxPool2D, BatchNormalization\r\nfrom tensorflow.keras import Model, Sequential\r\nimport tensorflow as tf\r\nimport matplotlib.pyplot as plt\r\nimport numpy as np\r\nimport argparse\r\nimport os\r\nimport glob\r\nimport sys\r\nimport time\r\nsys.path.append('..')\r\n\r\n########################\r\n## MAKE YOUR NET HERE ##\r\n########################\r\ndef conv_mean_pool(inputs, filters, kernel_size):\r\n    INPUT = Input(shape=inputs.shape[1:])\r\n    x = Conv2D(filters, kernel_size, padding='same')(INPUT)\r\n    OUTPUT= (x[::2, ::2, :] + x[::2, 1::2, :] + x[1::2, ::2, :] + x[1::2, 1::2, :])/4\r\n    return Model(inputs = INPUT, outputs = OUTPUT)\r\n\r\ndef upsample_conv(inputs, filters, kernel_size, input_shape):\r\n    INPUT=Input(shape = inputs.shape[1:])\r\n    x=tf.concat([INPUT, INPUT, INPUT, INPUT], axis = -1)\r\n    x=tf.nn.depth_to_space(x, 2)\r\n    OUTPUT=Conv2D(filters, kernel_size, padding = 'same')(x)\r\n    return Model(inputs = INPUT, outputs = OUTPUT)\r\n\r\n\r\ndef residual_block(name, inputs, filters, kernel_size, strides, input_shape, output_shape, upsample = False):\r\n    INPUT=Input(shape = inputs.shape[1:])\r\n    x=BatchNormalization()(INPUT)\r\n    x=ReLU()(x)\r\n\r\n    if upsample == True:\r\n        x=upsample_conv(x, filters, kernel_size, input_shape)(x)\r\n        x=Lambda(lambda z: tf.image.resize(z, size=output_shape, method='nearest'))(x)\r\n        original_scaled= x\r\n        x= BatchNormalization()(x)\r\n        x= ReLU()(x)\r\n        OUTPUT= Conv2D(filters, 3, padding='same')(x) + original_scaled\r\n        return Model(inputs=INPUT, outputs=OUTPUT, name=name)\r\n    else:\r\n        x= Conv2D(filters, 3)(x)\r\n        x=Lambda(lambda z: tf.image.resize(z, size=output_shape))(x)\r\n        original_scaled= x\r\n        x= BatchNormalization()(x)\r\n        x= ReLU()(x)\r\n        OUTPUT= conv_mean_pool(x, filters, kernel_size)(x)\r\n        OUTPUT= Conv2D(filters, 3, padding='same')(x) + original_scaled\r\n        return Model(inputs=INPUT, outputs=OUTPUT, name=name)\r\n\r\n\r\ndef create_discriminator(z_dim, name='Discriminator'):\r\n    INPUT= Input(shape=[100, 100, 3])\r\n    x=Lambda(lambda z: tf.image.resize(z, size=[128, 128]))(INPUT)\r\n    x=Conv2D(3, 3, padding='same')(x)\r\n    x=residual_block('res1', x, 32, 3, 1, [128, 128], [64, 64])(x)\r\n    x=residual_block('res2', x, 32, 3, 1, [64, 64], [32, 32])(x)\r\n    x=residual_block('res3', x, 32, 3, 1, [32, 32], [16, 16])(x)\r\n    x=residual_block('res4', x, 32, 3, 1, [16, 16], [8, 8])(x)\r\n    x=residual_block('res5', x, 32, 3, 1, [8, 8], [8, 8])(x)\r\n    x=Flatten()(x)\r\n    OUTPUT=Dense(1)(x)\r\n    return Model(inputs=INPUT, outputs=OUTPUT)\r\n\r\n\r\ndef create_generator(z_dim, name='Generator'):\r\n    INPUT=Input((z_dim,))\r\n    x=Dense(z_dim*4*4)(INPUT)\r\n    x=tf.reshape(x, (-1, 8, 8, 1))\r\n    x=residual_block('res1', x, 64, 3, 1, [8, 8], [8, 8], upsample = True)(x)\r\n    x=residual_block('res2', x, 32, 3, 1, [8, 8], [16, 16], upsample = True)(x)\r\n    x=residual_block('res3', x, 16, 3, 1, [16, 16], [32, 32], upsample = True)(x)\r\n    x=residual_block('res4', x, 8, 3, 1, [32, 32], [64, 64], upsample = True)(x)\r\n    x=residual_block('res5', x, 4, 3, 1, [64, 64], [128, 128], upsample = True)(x)\r\n    x=BatchNormalization()(x)\r\n    x=ReLU()(x)\r\n    x=Conv2D(3, 3, padding = 'same', activation = 'sigmoid')(x)\r\n    OUTPUT=Lambda(lambda z: tf.image.resize(z, size=[100, 100]))(x)\r\n    return Model(inputs=INPUT, outputs=OUTPUT, name=name)\r\n\r\nif __name__ == '__main__':\r\n    parser= argparse.ArgumentParser(description = 'Inputs')\r\n    parser.add_argument('--epochs', type = int, default =100)\r\n    parser.add_argument('--batch_size', type = int, default =64)\r\n    parser.add_argument('--z_dim', type = int, default =128)\r\n    parser.add_argument('--n_critic', type = int, default=5)\r\n    parser.add_argument('--LAMBDA', type=float, default=10)\r\n    parser.add_argument('--shuffle', type = bool, default =True)\r\n    parser.add_argument('--num_parallel_calls', type = int, default =4)\r\n    parser.add_argument('--buffer_size', type = int, default =1000)\r\n    parser.add_argument('--prefetch', type = int, default =1000)\r\n    parser.add_argument('--learning_rate', type = float, default =0.001)\r\n    parser.add_argument('--beta_1', type = float, default =0.0)\r\n    parser.add_argument('--beta_2', type = float, default =0.999)\r\n    args=parser.parse_args('')\r\n\r\n    ##########################################################\r\n    ## MAKING DATALOADERS FOR TRAINING, VALIDATION, TESTING ##\r\n    ##########################################################\r\n    train_data = tf.random.normal(shape=(1, 100, 100, 3))\r\n    train_dataloader = tf.data.Dataset.from_tensor_slices(train_data).batch(1)\r\n\r\n    #######################################\r\n    ## INITIALIZE MODEL, LOSSES, METRICS ##\r\n    #######################################\r\n    G=create_generator(args.z_dim, 'Generator')\r\n    D=create_discriminator(args.z_dim, 'Discriminator')\r\n    fixed_noise=tf.random.normal(shape=(16, args.z_dim))\r\n\r\n    loss_object=tf.keras.losses.BinaryCrossentropy()\r\n    train_loss= tf.keras.metrics.Mean(name = 'train_loss')\r\n    test_accuracy= tf.keras.metrics.Accuracy(name = 'test_accuracy')\r\n    optimizerG=tf.keras.optimizers.Adam(\r\n        learning_rate=args.learning_rate,\r\n        beta_1=args.beta_1,\r\n        beta_2=args.beta_2,\r\n    )\r\n    optimizerD = tf.keras.optimizers.Adam(\r\n        learning_rate=args.learning_rate,\r\n        beta_1=args.beta_1,\r\n        beta_2=args.beta_2,\r\n    )\r\n\r\n    G.summary(print_fn=logging.info)\r\n    D.summary(print_fn=logging.info)\r\n\r\n    ##############################################\r\n    ## Loss computations and training functions ##\r\n    ##############################################\r\n    @tf.function\r\n    def discriminator_step(fake_image, real_image):\r\n        with tf.GradientTape() as tape:\r\n            epsilon = tf.random.uniform(\r\n                shape=[fake_image.shape[0], 1, 1, 1], minval=0, maxval=1)\r\n            interpolated_image = epsilon*fake_image + (1-epsilon)*real_image\r\n            d_interpolated = D(interpolated_image)\r\n            d_fake = D(fake_image)\r\n            d_real = D(real_image)\r\n\r\n            grad_d = tf.gradients(d_interpolated, [interpolated_image])[0]\r\n            slopes = tf.sqrt(\r\n                1e-8 + tf.reduce_sum(tf.square(grad_d), axis=[1, 2, 3]))\r\n            gradient_penalty = tf.reduce_mean((slopes-1.) ** 2)\r\n\r\n            d_loss = tf.reduce_mean(\r\n                d_fake) - tf.reduce_mean(d_real) + args.LAMBDA * gradient_penalty\r\n\r\n            gradients = tape.gradient(d_loss, D.trainable_variables)\r\n            optimizerD.apply_gradients(\r\n                zip(gradients, D.trainable_variables))\r\n\r\n            return d_loss\r\n\r\n    @tf.function\r\n    def generator_step(fake_image):\r\n        with tf.GradientTape() as tape:\r\n            d_fake = -D(fake_image)\r\n            g_loss = tf.reduce_mean(d_fake)\r\n\r\n            gradients = tape.gradient(g_loss, G.trainable_variables)\r\n            optimizerG.apply_gradients(\r\n                zip(gradients, G.trainable_variables))\r\n\r\n            return g_loss\r\n\r\n    ###################\r\n    ## TRAINING LOOP ##\r\n    ###################\r\n    iter = 0\r\n    d_loss = 0\r\n    g_loss = 0\r\n    for epoch in range(args.epochs):\r\n        start = time.time()\r\n        for real_image in train_dataloader:\r\n            z = tf.random.normal(shape=(real_image.shape[0], args.z_dim))\r\n            fake_image = G(z)\r\n            d_loss = discriminator_step(fake_image, real_image)\r\n\r\n            if iter % args.n_critic == 0:\r\n                z = tf.random.normal()\r\n                fake_image = G(z)\r\n                g_loss = generator_step(fake_image)\r\n~~~~\r\n\r\n**Other info / logs**\r\n~~~~\r\nTraceback (most recent call last):\r\n  File \"code/WGAN-GP_issues.py\", line 191, in <module>\r\n    d_loss = discriminator_step(fake_image, real_image)\r\n  File \"/home/xiavatar/tf-2.0/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py\", line 457, in __call__\r\n    result = self._call(*args, **kwds)\r\n  File \"/home/xiavatar/tf-2.0/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py\", line 503, in _call\r\n    self._initialize(args, kwds, add_initializers_to=initializer_map)\r\n  File \"/home/xiavatar/tf-2.0/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py\", line 408, in _initialize\r\n    *args, **kwds))\r\n  File \"/home/xiavatar/tf-2.0/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 1848, in _get_concrete_function_internal_garbage_collected\r\n    graph_function, _, _ = self._maybe_define_function(args, kwargs)\r\n  File \"/home/xiavatar/tf-2.0/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 2150, in _maybe_define_function\r\n    graph_function = self._create_graph_function(args, kwargs)\r\n  File \"/home/xiavatar/tf-2.0/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 2041, in _create_graph_function\r\n    capture_by_value=self._capture_by_value),\r\n  File \"/home/xiavatar/tf-2.0/lib/python3.6/site-packages/tensorflow_core/python/framework/func_graph.py\", line 915, in func_graph_from_py_func\r\n    func_outputs = python_func(*func_args, **func_kwargs)\r\n  File \"/home/xiavatar/tf-2.0/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py\", line 358, in wrapped_fn\r\n    return weak_wrapped_fn().__wrapped__(*args, **kwds)\r\n  File \"/home/xiavatar/tf-2.0/lib/python3.6/site-packages/tensorflow_core/python/framework/func_graph.py\", line 905, in wrapper\r\n    raise e.ag_error_metadata.to_exception(e)\r\ntensorflow.python.autograph.impl.api.StagingError: in converted code:\r\n\r\n    code/WGAN-GP_issues.py:162 discriminator_step  *\r\n        gradients = tape.gradient(d_loss, D.trainable_variables)\r\n    /home/xiavatar/tf-2.0/lib/python3.6/site-packages/tensorflow_core/python/eager/backprop.py:1014 gradient\r\n        unconnected_gradients=unconnected_gradients)\r\n    /home/xiavatar/tf-2.0/lib/python3.6/site-packages/tensorflow_core/python/eager/imperative_grad.py:76 imperative_grad\r\n        compat.as_str(unconnected_gradients.value))\r\n    /home/xiavatar/tf-2.0/lib/python3.6/site-packages/tensorflow_core/python/eager/backprop.py:134 _gradient_function\r\n        grad_fn = ops._gradient_registry.lookup(op_name)  # pylint: disable=protected-access\r\n    /home/xiavatar/tf-2.0/lib/python3.6/site-packages/tensorflow_core/python/framework/registry.py:97 lookup\r\n        \"%s registry has no entry for: %s\" % (self._name, name))\r\n\r\n    LookupError: gradient registry has no entry for: ResizeBilinearGrad\r\n~~~~"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33749", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33749/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33749/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33749/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33749", "id": 512885929, "node_id": "MDU6SXNzdWU1MTI4ODU5Mjk=", "number": 33749, "title": "Pretrained Inception V4 to Keras Application Folder", "user": {"login": "Alpheron", "id": 25261413, "node_id": "MDQ6VXNlcjI1MjYxNDEz", "avatar_url": "https://avatars2.githubusercontent.com/u/25261413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Alpheron", "html_url": "https://github.com/Alpheron", "followers_url": "https://api.github.com/users/Alpheron/followers", "following_url": "https://api.github.com/users/Alpheron/following{/other_user}", "gists_url": "https://api.github.com/users/Alpheron/gists{/gist_id}", "starred_url": "https://api.github.com/users/Alpheron/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Alpheron/subscriptions", "organizations_url": "https://api.github.com/users/Alpheron/orgs", "repos_url": "https://api.github.com/users/Alpheron/repos", "events_url": "https://api.github.com/users/Alpheron/events{/privacy}", "received_events_url": "https://api.github.com/users/Alpheron/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1105108936, "node_id": "MDU6TGFiZWwxMTA1MTA4OTM2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:model", "name": "comp:model", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-10-26T21:09:04Z", "updated_at": "2020-02-21T18:43:21Z", "closed_at": null, "author_association": "NONE", "body": "Would it be possible to add Inception V4 to the Keras Applications folder?\r\n\r\nSystem/User Specifics: Tensorflow 2.0 with `tf.keras` module\r\n\r\nDue to recent discoveries made in neural networks and also according to many benchmarking standards, Inception V4 is one of the best networks available with very high accuracies in both Top 5 and Top 1. \r\n\r\nInception V4 should be included because it has been consistently proven to be one of the most accurate networks for Image Recognition. It will benefit many users who want a network with very high accuracy and also have the resources to run it. "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33744", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33744/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33744/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33744/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33744", "id": 512823202, "node_id": "MDU6SXNzdWU1MTI4MjMyMDI=", "number": 33744, "title": "Tensor zero_padding2d_1_input:0, specified in either feed_devices or fetch_devices was not found in the Graph", "user": {"login": "loretoparisi", "id": 163333, "node_id": "MDQ6VXNlcjE2MzMzMw==", "avatar_url": "https://avatars3.githubusercontent.com/u/163333?v=4", "gravatar_id": "", "url": "https://api.github.com/users/loretoparisi", "html_url": "https://github.com/loretoparisi", "followers_url": "https://api.github.com/users/loretoparisi/followers", "following_url": "https://api.github.com/users/loretoparisi/following{/other_user}", "gists_url": "https://api.github.com/users/loretoparisi/gists{/gist_id}", "starred_url": "https://api.github.com/users/loretoparisi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/loretoparisi/subscriptions", "organizations_url": "https://api.github.com/users/loretoparisi/orgs", "repos_url": "https://api.github.com/users/loretoparisi/repos", "events_url": "https://api.github.com/users/loretoparisi/events{/privacy}", "received_events_url": "https://api.github.com/users/loretoparisi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-10-26T11:12:24Z", "updated_at": "2020-01-17T06:31:33Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n_custom_\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\n```\r\nPRETTY_NAME=\"Debian GNU/Linux 10 (buster)\"\r\nNAME=\"Debian GNU/Linux\"\r\nVERSION_ID=\"10\"\r\nVERSION=\"10 (buster)\"\r\nVERSION_CODENAME=buster\r\nID=debian\r\n```\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\nnone\r\n- TensorFlow installed from (source or binary):\r\n_binary_\r\n- TensorFlow version (use command below):\r\n`v1.14.0-rc1-22-gaf24dc9 1.14.0`\r\n- Python version:\r\nPython 3.7.4\r\n- Bazel version (if compiling from source):\r\n_none_\r\n- GCC/Compiler version (if compiling from source):\r\n_none_\r\n- CUDA/cuDNN version:\r\n_none_\r\n- GPU model and memory:\r\nCPU model\r\n\r\n**Describe the current behavior**\r\nThis issue happens when running the Tensorflow model inference in a Tornado server started as a Thread.\r\n```python\r\nclass WebServer(threading.Thread):\r\n    def run(self):\r\n        application.listen(8888)\r\n        #asyncio.set_event_loop(asyncio.new_event_loop())\r\n        asyncio.set_event_loop(AnyThreadEventLoopPolicy())\r\n        tornado.ioloop.IOLoop.instance().start()\r\nWebServer.start()\r\n```\r\n\r\n\r\n\r\n**Describe the expected behavior**\r\n\r\n**Code to reproduce the issue**\r\nInference running without any issue. The issue does not occur when it starts running on the main thread instead:\r\n\r\n```python\r\napplication.listen(8888)\r\napplication.listen(8888)\r\ntornado.ioloop.IOLoop.instance().start()\r\n```\r\n\r\n\r\n**Other info / logs**\r\nThis error happens on both Tensorflow models I run, so I assume it's a threading problem when running the Graph in a thread that it is not the main thread.\r\n\r\nThe only error logging I get is\r\n` Tensor zero_padding2d_1_input:0, specified in either feed_devices or fetch_devices was not found in the Graph`"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33739", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33739/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33739/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33739/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33739", "id": 512802317, "node_id": "MDU6SXNzdWU1MTI4MDIzMTc=", "number": 33739, "title": "add a new class for realizing Early Stopping", "user": {"login": "wubowen416", "id": 41247773, "node_id": "MDQ6VXNlcjQxMjQ3Nzcz", "avatar_url": "https://avatars1.githubusercontent.com/u/41247773?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wubowen416", "html_url": "https://github.com/wubowen416", "followers_url": "https://api.github.com/users/wubowen416/followers", "following_url": "https://api.github.com/users/wubowen416/following{/other_user}", "gists_url": "https://api.github.com/users/wubowen416/gists{/gist_id}", "starred_url": "https://api.github.com/users/wubowen416/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wubowen416/subscriptions", "organizations_url": "https://api.github.com/users/wubowen416/orgs", "repos_url": "https://api.github.com/users/wubowen416/repos", "events_url": "https://api.github.com/users/wubowen416/events{/privacy}", "received_events_url": "https://api.github.com/users/wubowen416/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-10-26T07:21:25Z", "updated_at": "2019-10-29T19:10:46Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): 2.0 but this is for keras.\r\n- Are you willing to contribute it (Yes/No): yes. I have already realized it and now I am using it.\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\nI want to add a new class for realizing Early Stopping. \r\n\r\nThey are based on 3 metrics from paper \"Early Stopping - but when? Lutz Prechelt, University Karlsrhe\". \r\n\r\n1. **Generalization Loss**(GL). GL can be described as a metric that can measure how much current validation loss exceeds the lowest validation loss. Training will stop as soon as GL exceeds a certain threshold. \r\n\r\n2. **Progress Quotient**(PQ).  It considers training strip of length `k`. Progress means how much was the average training error during the strip larger than the minimum training error during the strip. Quotient means use the quotient of GL and Progress. Thus, training will stop as soon as the PQ exceeds a certain threshold. \r\n\r\n3. **UP**. This is simple. Training will stop when the generalization error increased in `s` successive strips.\r\n\r\nCombining these metrics, there are 5 modes for doing early stopping. 1, 2, 3, 1+3, 2+3.\r\n\r\nNow the EarlyStopping class of Keras can only stop training based on patience and delta, whereas there are advanced and useful early stopping methods.\r\n\r\n**Will this change the current api? How?**\r\n\r\nNo. Only a new class will be added.\r\n\r\n**Who will benefit with this feature?**\r\n\r\nBasically all workers using Keras.\r\n\r\n**Any Other info.**\r\n\r\nThis idea comes from others paper, I just realized it. For further info, please refer to the paper.\r\n[early stopping - but when.pdf](https://github.com/tensorflow/tensorflow/files/3774558/early.stopping.-.but.when.pdf)\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33729", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33729/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33729/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33729/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33729", "id": 512657777, "node_id": "MDU6SXNzdWU1MTI2NTc3Nzc=", "number": 33729, "title": "TypeError: An op outside of the function building code is being passed a Graph tensor", "user": {"login": "nbro", "id": 9349000, "node_id": "MDQ6VXNlcjkzNDkwMDA=", "avatar_url": "https://avatars2.githubusercontent.com/u/9349000?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nbro", "html_url": "https://github.com/nbro", "followers_url": "https://api.github.com/users/nbro/followers", "following_url": "https://api.github.com/users/nbro/following{/other_user}", "gists_url": "https://api.github.com/users/nbro/gists{/gist_id}", "starred_url": "https://api.github.com/users/nbro/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nbro/subscriptions", "organizations_url": "https://api.github.com/users/nbro/orgs", "repos_url": "https://api.github.com/users/nbro/repos", "events_url": "https://api.github.com/users/nbro/events{/privacy}", "received_events_url": "https://api.github.com/users/nbro/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-10-25T18:32:34Z", "updated_at": "2020-01-14T14:40:59Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code: Yes.\r\n- OS Platform and Distribution: Mac OS Catalina: 10.15 (19A602)\r\n- TensorFlow installed from: binary\r\n- TensorFlow version: 2.0.0\r\n- Python version: 3.7.4\r\n- GPU model and memory: Intel Iris Pro 1536 MB\r\n\r\n**Describe the current behavior**\r\n\r\nI am getting the error\r\n\r\n> tensorflow.python.eager.core._SymbolicException: Inputs to eager execution function cannot be Keras symbolic tensors, but found [<tf.Tensor 'conv2d_flipout/divergence_kernel:0' shape=() dtype=float32>]\r\n\r\nAfter having gotten the exception\r\n\r\n> TypeError: An op outside of the function building code is being passed a Graph tensor\r\n\r\nSee the detailed traceback below.\r\n\r\n**Describe the expected behavior**\r\n\r\nNo error.\r\n\r\n**Code to reproduce the issue**\r\n\r\n```\r\nfrom __future__ import print_function\r\n\r\nimport tensorflow as tf\r\nimport tensorflow_probability as tfp\r\n\r\n# tf.compat.v1.disable_eager_execution()\r\n\r\ndef get_bayesian_model(input_shape=None, num_classes=10):\r\n    model = tf.keras.Sequential()\r\n    model.add(tf.keras.layers.Input(shape=input_shape))\r\n    model.add(tfp.layers.Convolution2DFlipout(6, kernel_size=5, padding=\"SAME\", activation=tf.nn.relu))\r\n    model.add(tf.keras.layers.Flatten())\r\n    model.add(tfp.layers.DenseFlipout(84, activation=tf.nn.relu))\r\n    model.add(tfp.layers.DenseFlipout(num_classes))\r\n    return model\r\n\r\ndef get_mnist_data(normalize=True):\r\n    img_rows, img_cols = 28, 28\r\n    (x_train, y_train), (x_test, y_test) = tf.keras.datasets.mnist.load_data()\r\n\r\n    if tf.keras.backend.image_data_format() == 'channels_first':\r\n        x_train = x_train.reshape(x_train.shape[0], 1, img_rows, img_cols)\r\n        x_test = x_test.reshape(x_test.shape[0], 1, img_rows, img_cols)\r\n        input_shape = (1, img_rows, img_cols)\r\n    else:\r\n        x_train = x_train.reshape(x_train.shape[0], img_rows, img_cols, 1)\r\n        x_test = x_test.reshape(x_test.shape[0], img_rows, img_cols, 1)\r\n        input_shape = (img_rows, img_cols, 1)\r\n\r\n    x_train = x_train.astype('float32')\r\n    x_test = x_test.astype('float32')\r\n\r\n    if normalize:\r\n        x_train /= 255\r\n        x_test /= 255\r\n\r\n    return x_train, y_train, x_test, y_test, input_shape\r\n\r\n\r\ndef train():\r\n    # Hyper-parameters.\r\n    batch_size = 128\r\n    num_classes = 10\r\n    epochs = 1\r\n\r\n    # Get the training data.\r\n    x_train, y_train, x_test, y_test, input_shape = get_mnist_data()\r\n\r\n    # Get the model.\r\n    model = get_bayesian_model(input_shape=input_shape, num_classes=num_classes)\r\n\r\n    # Prepare the model for training.\r\n    model.compile(optimizer=tf.keras.optimizers.Adam(), loss=\"sparse_categorical_crossentropy\",\r\n                  metrics=['accuracy'])\r\n\r\n    # Train the model.\r\n    model.fit(x_train, y_train, batch_size=batch_size, epochs=epochs, verbose=1)\r\n    model.evaluate(x_test, y_test, verbose=0)\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    train()\r\n```\r\n\r\n**Other info / logs**\r\n\r\n```\r\nWARNING:tensorflow:From /Users/nbro/Desktop/my_project/venv/lib/python3.7/site-packages/tensorflow_probability/python/layers/util.py:104: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nPlease use `layer.add_weight` method instead.\r\n2019-10-25 20:38:32.504579: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2019-10-25 20:38:32.517426: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fe25e59f290 executing computations on platform Host. Devices:\r\n2019-10-25 20:38:32.517438: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version\r\nTrain on 60000 samples\r\nTraceback (most recent call last):\r\n  128/60000 [..............................] - ETA: 7:32  File \"/Users/nbro/Desktop/my_project/venv/lib/python3.7/site-packages/tensorflow_core/python/eager/execute.py\", line 61, in quick_execute\r\n    num_outputs)\r\nTypeError: An op outside of the function building code is being passed\r\na \"Graph\" tensor. It is possible to have Graph tensors\r\nleak out of the function building context by including a\r\ntf.init_scope in your function building code.\r\nFor example, the following function will fail:\r\n  @tf.function\r\n  def has_init_scope():\r\n    my_constant = tf.constant(1.)\r\n    with tf.init_scope():\r\n      added = my_constant * 2\r\nThe graph tensor has name: conv2d_flipout/divergence_kernel:0\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/nbro/Desktop/my_project/my_module.py\", line 63, in <module>\r\n    train()\r\n  File \"/Users/nbro/Desktop/my_project/my_module.py\", line 58, in train\r\n    model.fit(x_train, y_train, batch_size=batch_size, epochs=epochs, verbose=1)\r\n  File \"/Users/nbro/Desktop/my_project/venv/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py\", line 728, in fit\r\n    use_multiprocessing=use_multiprocessing)\r\n  File \"/Users/nbro/Desktop/my_project/venv/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 324, in fit\r\n    total_epochs=epochs)\r\n  File \"/Users/nbro/Desktop/my_project/venv/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 123, in run_one_epoch\r\n    batch_outs = execution_function(iterator)\r\n  File \"/Users/nbro/Desktop/my_project/venv/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py\", line 86, in execution_function\r\n    distributed_function(input_fn))\r\n  File \"/Users/nbro/Desktop/my_project/venv/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py\", line 457, in __call__\r\n    result = self._call(*args, **kwds)\r\n  File \"/Users/nbro/Desktop/my_project/venv/lib/python3.7/site-packages/tensorflow_core/python/eager/def_function.py\", line 520, in _call\r\n    return self._stateless_fn(*args, **kwds)\r\n  File \"/Users/nbro/Desktop/my_project/venv/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 1823, in __call__\r\n    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access\r\n  File \"/Users/nbro/Desktop/my_project/venv/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 1141, in _filtered_call\r\n    self.captured_inputs)\r\n  File \"/Users/nbro/Desktop/my_project/venv/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 1224, in _call_flat\r\n    ctx, args, cancellation_manager=cancellation_manager)\r\n  File \"/Users/nbro/Desktop/my_project/venv/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py\", line 511, in call\r\n    ctx=ctx)\r\n  File \"/Users/nbro/Desktop/my_project/venv/lib/python3.7/site-packages/tensorflow_core/python/eager/execute.py\", line 75, in quick_execute\r\n    \"tensors, but found {}\".format(keras_symbolic_tensors))\r\ntensorflow.python.eager.core._SymbolicException: Inputs to eager execution function cannot be Keras symbolic tensors, but found [<tf.Tensor 'conv2d_flipout/divergence_kernel:0' shape=() dtype=float32>]\r\n```\r\n\r\nThe problem is apparently related to the layer `tfp.layers.Convolution2DFlipout`. I know that if I use `tf.compat.v1.disable_eager_execution()` after having imported TensorFlow, I do not get the mentioned error anymore, but I would like to use TensorFlow's eager execution, avoid sessions or placeholders.\r\n\r\nI opened the same issue here: https://github.com/tensorflow/probability/issues/620."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33727", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33727/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33727/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33727/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33727", "id": 512628324, "node_id": "MDU6SXNzdWU1MTI2MjgzMjQ=", "number": 33727, "title": "Disabling eager execution while training ~90 layers of BatchNormalization exhausts RAM", "user": {"login": "ThinerDAS", "id": 16000330, "node_id": "MDQ6VXNlcjE2MDAwMzMw", "avatar_url": "https://avatars3.githubusercontent.com/u/16000330?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ThinerDAS", "html_url": "https://github.com/ThinerDAS", "followers_url": "https://api.github.com/users/ThinerDAS/followers", "following_url": "https://api.github.com/users/ThinerDAS/following{/other_user}", "gists_url": "https://api.github.com/users/ThinerDAS/gists{/gist_id}", "starred_url": "https://api.github.com/users/ThinerDAS/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ThinerDAS/subscriptions", "organizations_url": "https://api.github.com/users/ThinerDAS/orgs", "repos_url": "https://api.github.com/users/ThinerDAS/repos", "events_url": "https://api.github.com/users/ThinerDAS/events{/privacy}", "received_events_url": "https://api.github.com/users/ThinerDAS/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 736653459, "node_id": "MDU6TGFiZWw3MzY2NTM0NTk=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:eager", "name": "comp:eager", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-10-25T17:19:13Z", "updated_at": "2019-10-29T08:35:58Z", "closed_at": null, "author_association": "NONE", "body": "Disabling eager execution while training a network with a number of BatchNormalization will take unreasonable amount of RAM before training happens. It might be related that BatchNormalization lacks an `_XlaCompiler` attribute.\r\nI find that I am in an awkward state: my script is a long-running script, and if I enable eager execution, GPU RAM will be used up due to some unknown memory leakage + my script will run ULTRA SLOWLY due to unbatched nature of queries of model.predict (GPU usage 30% in disabling eager execution mode v.s. 9% in enabling eager execution mode); if I disable eager execution, then this bug takes up my CPU RAM. \r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04.3 LTS\r\n- TensorFlow installed from (source or binary): docker: tensorflow/tensorflow latest-gpu-py3       f7932d1761bd\r\n- TensorFlow version (use command below): v2.0.0-rc2-26-g64c3d38 2.0.0\r\n- Python version: 3.6.8\r\n\r\n**Describe the current behavior**\r\nWriting ~90 layers of BatchNormalization takes around 8G RAM before training when disabling eager mode, even with matrix dimension small. Like 100M per BatchNormalization in python3.6.8, regardless of dimensions.\r\nEDIT: I did some experiment and found that the memory usage is approximately linear to the number of `BatchNormalization`s.\r\n\r\n**Describe the expected behavior**\r\nWriting ~90 layers of BatchNormalization should take smaller amount of RAM.\r\n\r\n**Code to reproduce the issue**\r\n```\r\nfrom tensorflow.python.framework.ops import disable_eager_execution\r\nimport numpy as np\r\nDISABLE_EAGER = 1\r\nresnet_depth = 96\r\n\r\nif DISABLE_EAGER:\r\n    disable_eager_execution()\r\nif True:\r\n    from tensorflow.keras.optimizers import *\r\n    from tensorflow.keras.layers import *\r\n    from tensorflow.keras.models import *\r\n\r\n\r\ndef init():\r\n    # game params\r\n    board_x, board_y = 3, 3\r\n    action_size = 10\r\n    depth_dim = 2\r\n\r\n    input_boards = Input(\r\n        shape=(board_x, board_y, depth_dim))\r\n    num_chan = 4\r\n    h_conv1 = Activation('relu')(BatchNormalization(axis=3)(\r\n        Conv2D(num_chan, 1, padding='same', use_bias=False)(input_boards)))\r\n    for i in range(resnet_depth):\r\n        h_conv1 = Activation('relu')(BatchNormalization(axis=3)(\r\n            Conv2D(num_chan, 1, padding='same', use_bias=False)(h_conv1)))\r\n    hf = Flatten()(h_conv1)\r\n    s_fc1 = Dropout(0.3)(Activation('relu')(BatchNormalization(axis=1)(\r\n        Dense(16, use_bias=False)(hf))))\r\n    pi = Dense(action_size, activation='softmax', name='pi')(\r\n        s_fc1)\r\n\r\n    model = Model(inputs=input_boards, outputs=pi)\r\n    model.compile(\r\n        loss=['categorical_crossentropy'], optimizer=Adam(0.001))\r\n    return model\r\n\r\n\r\nm = init()\r\nprint('inited model')\r\nm.fit(x=np.zeros((1, 3, 3, 2)), y=np.zeros((1, 10)))\r\n\r\n```\r\n\r\n**Other info / logs**\r\nNone\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33720", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33720/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33720/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33720/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33720", "id": 512501194, "node_id": "MDU6SXNzdWU1MTI1MDExOTQ=", "number": 33720, "title": "Generating Arduino Libraries error", "user": {"login": "DaveCalaway", "id": 10884164, "node_id": "MDQ6VXNlcjEwODg0MTY0", "avatar_url": "https://avatars0.githubusercontent.com/u/10884164?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DaveCalaway", "html_url": "https://github.com/DaveCalaway", "followers_url": "https://api.github.com/users/DaveCalaway/followers", "following_url": "https://api.github.com/users/DaveCalaway/following{/other_user}", "gists_url": "https://api.github.com/users/DaveCalaway/gists{/gist_id}", "starred_url": "https://api.github.com/users/DaveCalaway/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DaveCalaway/subscriptions", "organizations_url": "https://api.github.com/users/DaveCalaway/orgs", "repos_url": "https://api.github.com/users/DaveCalaway/repos", "events_url": "https://api.github.com/users/DaveCalaway/events{/privacy}", "received_events_url": "https://api.github.com/users/DaveCalaway/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-10-25T12:56:19Z", "updated_at": "2019-10-29T00:12:57Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution : macOS 10.14.6\r\n- TensorFlow version: 1.15.0\r\n- Python version: 2.7.10 and 3.7.4 \r\n\r\n**Describe the problem**\r\nWhen i run the command \"sh test_arduino.sh\" it gaves me that error:\r\n```\r\n...\r\nFinished patching kissfft\r\nTraceback (most recent call last):\r\n  File \"tensorflow/lite/experimental/micro/tools/make/generate_keil_project.py\", line 121, in <module>\r\n    parse_args()\r\n  File \"tensorflow/lite/experimental/micro/tools/make/generate_keil_project.py\", line 117, in parse_args\r\n    main(unparsed, flags)\r\n  File \"tensorflow/lite/experimental/micro/tools/make/generate_keil_project.py\", line 39, in main\r\n    six.ensure_str(flags.executable),\r\nAttributeError: 'module' object has no attribute 'ensure_str'\r\nmake: *** [tensorflow/lite/experimental/micro/examples/person_detection/Makefile.inc:56: tensorflow/lite/experimental/micro/tools/make/gen/arduino_x86_64/prj/person_detection_test/keil/keil_project.uvprojx] Error 1\r\n```\r\nI tried to use python3, changing the line 304 in \"/tensorflow/tensorflow/lite/experimental/micro/tools/make/Makefile\", but nothing change.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33718", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33718/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33718/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33718/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33718", "id": 512473044, "node_id": "MDU6SXNzdWU1MTI0NzMwNDQ=", "number": 33718, "title": "[TFLite, Converter] BERT conversion error in later version", "user": {"login": "Vooblin", "id": 39566915, "node_id": "MDQ6VXNlcjM5NTY2OTE1", "avatar_url": "https://avatars2.githubusercontent.com/u/39566915?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Vooblin", "html_url": "https://github.com/Vooblin", "followers_url": "https://api.github.com/users/Vooblin/followers", "following_url": "https://api.github.com/users/Vooblin/following{/other_user}", "gists_url": "https://api.github.com/users/Vooblin/gists{/gist_id}", "starred_url": "https://api.github.com/users/Vooblin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Vooblin/subscriptions", "organizations_url": "https://api.github.com/users/Vooblin/orgs", "repos_url": "https://api.github.com/users/Vooblin/repos", "events_url": "https://api.github.com/users/Vooblin/events{/privacy}", "received_events_url": "https://api.github.com/users/Vooblin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-10-25T11:52:11Z", "updated_at": "2020-02-01T00:10:54Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: No\r\n- TensorFlow installed from (source or binary): Yes\r\n- TensorFlow version (use command below): firsrt git version: 9edecf8, second git verison: f9c7eb4\r\n- Python version: 3.6.8\r\n- Bazel version (if compiling from source): 0.26.1\r\n- GCC/Compiler version (if compiling from source): GCC 8.3.0\r\n- CUDA/cuDNN version: No\r\n- GPU model and memory: No\r\n\r\n**Describe the current behavior**\r\nWhen I convert BERT from tensorflow/models to tflite format by tensorflow that was built at commit with hash 9edecf8, it works. But when I do the same by tensorflow that was built at later commit with hash f9c7eb4, it doesn't work. The error in logs (Unsupported operation: Einsum).\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport tensorflow as tf\r\n\r\nimport json\r\nimport os\r\n\r\nfrom absl import app\r\nfrom absl import flags\r\n\r\nfrom official.nlp.bert_models import classifier_model\r\nfrom official.nlp.bert_modeling import BertConfig\r\n\r\nflags.DEFINE_string('output_dir', default=None, help='Directory for tflite models')\r\nflags.DEFINE_string('config_path', default=None, help='Path to config file')\r\n\r\nFLAGS = flags.FLAGS\r\ndef convert_bert(model, output_dir):\r\n  if not os.path.exists(output_dir):\r\n    os.mkdir(output_dir)\r\n  converter = tf.lite.TFLiteConverter.from_keras_model(model)\r\n  tflite_model = converter.convert()\r\n  output_path = os.path.join(output_dir, 'bert.tflite')\r\n  with open(output_path, \"wb\") as f:\r\n    f.write(tflite_model)\r\n\r\ndef main(_):\r\n  output_dir = FLAGS.output_dir\r\n  config_path = FLAGS.config_path\r\n  with open(config_path, 'r') as f:\r\n    config = json.load(f)\r\n  model = classifier_model(BertConfig.from_dict(config), tf.float32, 2, 128)[0]\r\n  convert_bert(model, output_dir)\r\n\r\nif _name_ == '_main_':\r\n  app.run(main)\r\n```\r\n\r\n**Other info / logs**\r\n```\r\n2019-10-25 11:49:08.546343: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3100000000 Hz\r\n2019-10-25 11:49:08.548499: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x434ae80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n2019-10-25 11:49:08.548520: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\n2019-10-25 11:49:11.490358: I tensorflow/core/grappler/devices.cc:60] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0 (Note: TensorFlow was not compiled with CUDA support)\r\n2019-10-25 11:49:11.490631: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2019-10-25 11:49:11.503750: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:812] Optimization results for grappler item: graph_to_optimize\r\n2019-10-25 11:49:11.503785: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814]   function_optimizer: function_optimizer did nothing. time = 0.005ms.\r\n2019-10-25 11:49:11.503790: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2019-10-25 11:49:17.635192: I tensorflow/core/grappler/devices.cc:60] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0 (Note: TensorFlow was not compiled with CUDA support)\r\n2019-10-25 11:49:17.635327: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2019-10-25 11:49:20.802742: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:812] Optimization results for grappler item: graph_to_optimize\r\n2019-10-25 11:49:20.802785: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814]   constant_folding: Graph size after: 1225 nodes (-299), 1515 edges (-396), time = 1677.46204ms.\r\n2019-10-25 11:49:20.802790: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814]   constant_folding: Graph size after: 1225 nodes (0), 1515 edges (0), time = 496.749ms.\r\nTraceback (most recent call last):\r\n  File \"convert_bert.py\", line 39, in <module>\r\n    app.run(main)\r\n  File \"/workspace/.local/lib/python3.6/site-packages/absl/app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"/workspace/.local/lib/python3.6/site-packages/absl/app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"convert_bert.py\", line 36, in main\r\n    convert_bert(model, output_dir)\r\n  File \"convert_bert.py\", line 22, in convert_bert\r\n    tflite_model = converter.convert()\r\n  File \"/workspace/.local/lib/python3.6/site-packages/tensorflow_core/lite/python/lite.py\", line 464, in convert\r\n    **converter_kwargs)\r\n  File \"/workspace/.local/lib/python3.6/site-packages/tensorflow_core/lite/python/convert.py\", line 452, in toco_convert_impl\r\n    enable_mlir_converter=enable_mlir_converter)\r\n  File \"/workspace/.local/lib/python3.6/site-packages/tensorflow_core/lite/python/convert.py\", line 203, in toco_convert_protos\r\n    raise ConverterError(\"See console for info.\\n%s\\n%s\\n\" % (stdout, stderr))\r\ntensorflow.lite.python.convert.ConverterError: See console for info.\r\n2019-10-25 11:49:24.764527: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764589: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764613: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764622: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764632: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764641: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764659: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764673: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764690: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764698: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764705: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764713: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764734: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764741: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764756: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764768: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764784: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764791: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764798: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764806: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764815: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764821: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764837: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764849: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764864: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764871: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764877: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764885: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764895: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764901: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.764918: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: Einsum\r\n2019-10-25 11:49:24.790537: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 716 operators, 1029 arrays (0 quantized)\r\n2019-10-25 11:49:24.802635: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 716 operators, 1029 arrays (0 quantized)\r\n2019-10-25 11:49:24.816756: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 1: 564 operators, 862 arrays (0 quantized)\r\n2019-10-25 11:49:24.829191: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 2: 564 operators, 862 arrays (0 quantized)\r\n2019-10-25 11:49:24.841886: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 3: 563 operators, 860 arrays (0 quantized)\r\n2019-10-25 11:49:24.854403: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 4: 563 operators, 860 arrays (0 quantized)\r\n2019-10-25 11:49:24.866851: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 5: 563 operators, 860 arrays (0 quantized)\r\n2019-10-25 11:49:24.879295: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 6: 563 operators, 860 arrays (0 quantized)\r\n2019-10-25 11:49:24.891707: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before Group bidirectional sequence lstm/rnn: 563 operators, 860 arrays (0 quantized)\r\n2019-10-25 11:49:24.900833: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before dequantization graph transformations: 563 operators, 860 arrays (0 quantized)\r\n2019-10-25 11:49:24.915554: I tensorflow/lite/toco/allocate_transient_arrays.cc:345] Total transient array allocated size: 2032640 bytes, theoretical optimal value: 1179648 bytes.\r\n2019-10-25 11:49:24.917162: I tensorflow/lite/toco/toco_tooling.cc:454] Number of parameters: 107896686\r\n2019-10-25 11:49:24.930715: E tensorflow/lite/toco/toco_tooling.cc:481] We are continually in the process of adding support to TensorFlow Lite for more ops. It would be helpful if you could inform us of how this conversion went by opening a github issue at https://github.com/tensorflow/tensorflow/issues/new?template=40-tflite-op-request.md\r\n and pasting the following:\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime. If those are native TensorFlow operators, you might be able to use the extended runtime by passing --enable_select_tf_ops, or by setting target_ops=TFLITE_BUILTINS,SELECT_TF_OPS when calling tf.lite.TFLiteConverter(). Otherwise, if you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: ADD, CAST, FULLY_CONNECTED, GATHER, MEAN, MUL, NEG, POW, RESHAPE, RSQRT, SOFTMAX, SQUARED_DIFFERENCE, SQUEEZE, STRIDED_SLICE, SUB, TANH. Here is a list of operators for which you will need custom implementations: Einsum.\r\nTraceback (most recent call last):\r\n  File \"/workspace/.local/bin//toco_from_protos\", line 8, in <module>\r\n    sys.exit(main())\r\n  File \"/workspace/.local/lib/python3.6/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 93, in main\r\n    app.run(main=execute, argv=[sys.argv[0]] + unparsed)\r\n  File \"/workspace/.local/lib/python3.6/site-packages/tensorflow_core/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/workspace/.local/lib/python3.6/site-packages/absl/app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"/workspace/.local/lib/python3.6/site-packages/absl/app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/workspace/.local/lib/python3.6/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 56, in execute\r\n    enable_mlir_converter)\r\nException: We are continually in the process of adding support to TensorFlow Lite for more ops. It would be helpful if you could inform us of how this conversion went by opening a github issue at https://github.com/tensorflow/tensorflow/issues/new?template=40-tflite-op-request.md\r\n and pasting the following:\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime. If those are native TensorFlow operators, you might be able to use the extended runtime by passing --enable_select_tf_ops, or by setting target_ops=TFLITE_BUILTINS,SELECT_TF_OPS when calling tf.lite.TFLiteConverter(). Otherwise, if you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: ADD, CAST, FULLY_CONNECTED, GATHER, MEAN, MUL, NEG, POW, RESHAPE, RSQRT, SOFTMAX, SQUARED_DIFFERENCE, SQUEEZE, STRIDED_SLICE, SUB, TANH. Here is a list of operators for which you will need custom implementations: Einsum\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33711", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33711/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33711/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33711/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33711", "id": 512363037, "node_id": "MDU6SXNzdWU1MTIzNjMwMzc=", "number": 33711, "title": "TFLITE MODEL INPUT DYNAMIC INPUT SIZE", "user": {"login": "tulasiram58827", "id": 27290902, "node_id": "MDQ6VXNlcjI3MjkwOTAy", "avatar_url": "https://avatars1.githubusercontent.com/u/27290902?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tulasiram58827", "html_url": "https://github.com/tulasiram58827", "followers_url": "https://api.github.com/users/tulasiram58827/followers", "following_url": "https://api.github.com/users/tulasiram58827/following{/other_user}", "gists_url": "https://api.github.com/users/tulasiram58827/gists{/gist_id}", "starred_url": "https://api.github.com/users/tulasiram58827/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tulasiram58827/subscriptions", "organizations_url": "https://api.github.com/users/tulasiram58827/orgs", "repos_url": "https://api.github.com/users/tulasiram58827/repos", "events_url": "https://api.github.com/users/tulasiram58827/events{/privacy}", "received_events_url": "https://api.github.com/users/tulasiram58827/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gargn", "id": 1900612, "node_id": "MDQ6VXNlcjE5MDA2MTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1900612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gargn", "html_url": "https://github.com/gargn", "followers_url": "https://api.github.com/users/gargn/followers", "following_url": "https://api.github.com/users/gargn/following{/other_user}", "gists_url": "https://api.github.com/users/gargn/gists{/gist_id}", "starred_url": "https://api.github.com/users/gargn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gargn/subscriptions", "organizations_url": "https://api.github.com/users/gargn/orgs", "repos_url": "https://api.github.com/users/gargn/repos", "events_url": "https://api.github.com/users/gargn/events{/privacy}", "received_events_url": "https://api.github.com/users/gargn/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gargn", "id": 1900612, "node_id": "MDQ6VXNlcjE5MDA2MTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1900612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gargn", "html_url": "https://github.com/gargn", "followers_url": "https://api.github.com/users/gargn/followers", "following_url": "https://api.github.com/users/gargn/following{/other_user}", "gists_url": "https://api.github.com/users/gargn/gists{/gist_id}", "starred_url": "https://api.github.com/users/gargn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gargn/subscriptions", "organizations_url": "https://api.github.com/users/gargn/orgs", "repos_url": "https://api.github.com/users/gargn/repos", "events_url": "https://api.github.com/users/gargn/events{/privacy}", "received_events_url": "https://api.github.com/users/gargn/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2019-10-25T07:57:31Z", "updated_at": "2020-02-18T15:56:54Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**:binary\r\n- **TensorFlow version (use command below)**: 1.14\r\n- **Python version**:\r\n- **Bazel version (if compiling from source)**:\r\n- **GCC/Compiler version (if compiling from source)**:\r\n- **CUDA/cuDNN version**:\r\n- **GPU model and memory**:\r\n- **Exact command to reproduce**:\r\n\r\nYou can collect some of this information using our environment capture script:\r\n\r\nhttps://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh\r\n\r\nYou can obtain the TensorFlow version with:\r\n\r\n```bash\r\npython -c \"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"\r\n```\r\n\r\n### Describe the problem\r\nWhen I am resizing input tensor in tflite model and allocating the tensors I am getting error )Node number 0 (RESHAPE) failed to prepare.\r\n\r\n\r\n### Source code / logs\r\n File \"tflite_inference.py\", line 176, in <module>\r\n    inference_from_tflite(path_to_tflite,path_to_input)\t\r\n  File \"tflite_inference.py\", line 118, in inference_from_tflite\r\n    interpreter.allocate_tensors()\r\n  File \"/home/asus/miniconda/espnet/tools/venv/lib/python3.7/site-packages/tensorflow/lite/python/interpreter.py\", line 95, in allocate_tensors\r\n    return self._interpreter.AllocateTensors()\r\n  File \"/home/asus/miniconda/espnet/tools/venv/lib/python3.7/site-packages/tensorflow/lite/python/interpreter_wrapper/tensorflow_wrap_interpreter_wrapper.py\", line 106, in AllocateTensors\r\n    return _tensorflow_wrap_interpreter_wrapper.InterpreterWrapper_AllocateTensors(self)\r\nRuntimeError: tensorflow/lite/kernels/reshape.cc:58 num_input_elements != num_output_elements (44000 != 4000)Node number 0 (RESHAPE) failed to prepare.\r\n\r\n\r\nSource Code:\r\n        interpreter = tf.lite.Interpreter(model_path=tflite_model)\r\n        #Getting the input data\r\n        input_data = np.load(input_mel)\r\n        print(input_data.shape)\r\n        input_details = interpreter.get_input_details()\r\n        output_details = interpreter.get_output_details()\r\n        input_data_resized = np.reshape(input_data,(1,input_data.shape[0],80))\r\n        interpreter.resize_tensor_input(input_details[0]['index'], (1, input_data.shape[0], 80))\r\n        interpreter.allocate_tensors()\r\n        interpreter.set_tensor(input_details[0]['index'],input_data_resized)\r\n        interpreter.invoke()\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33708", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33708/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33708/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33708/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33708", "id": 512332748, "node_id": "MDU6SXNzdWU1MTIzMzI3NDg=", "number": 33708, "title": "non_max_suppression GPU version is 3x slower than CPU version in  TF 1.15", "user": {"login": "sgambient", "id": 42156923, "node_id": "MDQ6VXNlcjQyMTU2OTIz", "avatar_url": "https://avatars0.githubusercontent.com/u/42156923?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sgambient", "html_url": "https://github.com/sgambient", "followers_url": "https://api.github.com/users/sgambient/followers", "following_url": "https://api.github.com/users/sgambient/following{/other_user}", "gists_url": "https://api.github.com/users/sgambient/gists{/gist_id}", "starred_url": "https://api.github.com/users/sgambient/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sgambient/subscriptions", "organizations_url": "https://api.github.com/users/sgambient/orgs", "repos_url": "https://api.github.com/users/sgambient/repos", "events_url": "https://api.github.com/users/sgambient/events{/privacy}", "received_events_url": "https://api.github.com/users/sgambient/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-10-25T06:40:13Z", "updated_at": "2020-01-13T17:43:42Z", "closed_at": null, "author_association": "NONE", "body": "<em>\r\n</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary):binary\r\n- TensorFlow version (use command below):1.15\r\n- Python version:3.0\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:10\r\n- GPU model and memory:K80\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nnon_max_suppression GPU version is 3x slower than CPU version.\r\n**Describe the expected behavior**\r\nGPU version is expected to be faster ( or at the least same ) than CPU version.\r\n\r\n**Code to reproduce the issue\r\n```\r\nfrom __future__ import absolute_import                                                                                                                                  \r\nfrom __future__ import division                                                                                                                                         \r\nfrom __future__ import print_function                                                                                                                                   \r\n                                                                                                                                                                        \r\nimport tensorflow as tf                                                                                                                                                 \r\nfrom tensorflow.python.framework import load_library                                                                                                                    \r\nfrom tensorflow.python.platform import resource_loader                                                                                                                  \r\n                                                                                                                                                                        \r\nimport numpy as np                                                                                                                                                      \r\nimport os                                                                                                                                                               \r\nimport argparse                                                                                                                                                         \r\n                                                                                                                                                                        \r\nfrom tensorflow.python.platform import test                                                                                                                             \r\nimport time                                                                                                                                                             \r\nfrom tensorflow.python.ops import gen_image_ops                                                                                                                         \r\n                                                                                                                                                                                                                                                                \r\n                                                                                                                                                                        \r\ndef yolo_non_max_suppression(boxes, scores, classes, sess, max_boxes = 10, iou_threshold = 0.5, rundevice=\"cpu:0\"):                                                                              \r\n    \"\"\"                                                                                                                                                                                          \r\n    Applies Non-max suppression (NMS) to set of boxes                                                                                                                                            \r\n                                                                                                                                                                                                 \r\n    Arguments:                                                                                                                                                                                   \r\n    scores -- tensor of shape (None,), output of yolo_filter_boxes()                                                                                                                             \r\n    boxes -- tensor of shape (None, 4), output of yolo_filter_boxes() that have been scaled to the image size (see later)                                                                        \r\n    classes -- tensor of shape (None,), output of yolo_filter_boxes()                                                                                                                            \r\n    max_boxes -- integer, maximum number of predicted boxes you'd like                                                                                                                           \r\n    iou_threshold -- real value, \"intersection over union\" threshold used for NMS filtering                                                                                                      \r\n                                                                                                                                                                                                 \r\n    Returns:                                                                                                                                                                                     \r\n    scores -- tensor of shape (, None), predicted score for each box                                                                                                                             \r\n    boxes -- tensor of shape (4, None), predicted box coordinates                                                                                                                                \r\n    classes -- tensor of shape (, None), predicted class for each box                                                                                                                            \r\n                                                                                                                                                                                                 \r\n    Note: The \"None\" dimension of the output tensors has obviously to be less than max_boxes. Note also that this                                                                                \r\n    function will transpose the shapes of scores, boxes, classes. This is made for convenience.                                                                                                  \r\n    \"\"\"                                                                                                                                                                                          \r\n                                                                                                                                                                                                 \r\n    init_val_np = np.array ( [max_boxes], dtype=np.int32)                                                                                                                                        \r\n    max_boxes_tensor = tf.Variable(max_boxes,  dtype='int32')     # tensor to be used in tf.image.non_max_suppression()                                                                          \r\n    sess.run(tf.variables_initializer([max_boxes_tensor])) # initialize variable max_boxes_tensor                                                                                                \r\n                                                                                                                                                                                                 \r\n    # Use tf.image.non_max_suppression() to get the list of indices corresponding to boxes you keep                                                                                              \r\n    ### START CODE HERE ### (~ 1 line)                                                                                                                                                           \r\n    with tf.device(rundevice):                                                                                                                                                                   \r\n        score_threshold = 0.1                                                                                                                                                                    \r\n        soft_nms_sigma=0.0                                                                                                                                                                       \r\n        pad_to_max_output_size=False                                                                                                                                                             \r\n        if True:                                                                                                                                                                                 \r\n            nms_indices = tf.image.non_max_suppression(boxes, scores, max_boxes_tensor, )                                                                                                        \r\n            #nms_indices = tf.image.non_max_suppression(boxes, scores, max_boxes_tensor, iou_threshold=iou_threshold)                                                                            \r\n            #nms_indices = nms(boxes_np, 0.5)                                                                                                                                                    \r\n            #nms_indices = gen_image_ops.non_max_suppression_v2(boxes, scores, max_boxes_tensor, iou_threshold, )                                                                                \r\n            #nms_indices = tf.image.non_max_suppression_v2(boxes, scores, max_boxes_tensor, iou_threshold, )                                                                                     \r\n            #nms_indices = gen_image_ops.non_max_suppression_v3(boxes, scores, max_boxes_tensor, iou_threshold, score_threshold)                                                                 \r\n            #nms_indices,_ = gen_image_ops.non_max_suppression_v4(boxes, scores, max_boxes_tensor, iou_threshold, score_threshold, pad_to_max_output_size)                                       \r\n            #nms_indices = gen_image_ops.non_max_suppression_v5(boxes, scores, max_boxes_tensor, iou_threshold, score_threshold, soft_nms_sigma)                                                 \r\n            #nms_indices,_,_ = non_max_suppression_ops.non_max_suppression_v5(boxes, scores, max_boxes_tensor, iou_threshold, score_threshold, soft_nms_sigma)                                   \r\n            #nms_indices,_,_ = tf.image.non_max_suppression_with_scores(boxes, scores, max_boxes_tensor, iou_threshold, score_threshold, soft_nms_sigma)                                         \r\n        ### END CODE HERE ###                                                                                                                                                                    \r\n                                                                                                                                                                                                 \r\n        ### START CODE HERE ### (~ 3 lines)                                                                                                                                                      \r\n        scoreso = tf.gather(scores, nms_indices)                                                                                                                                                 \r\n        boxeso = tf.gather(boxes, nms_indices)                                                                                                                                                   \r\n        classeso = tf.gather(classes, nms_indices)                                                                                                                                               \r\n        summary_writer = tf.summary.FileWriter(os.getenv('TENSORBOARD_DIR'), sess.graph)                                                                                                         \r\n        ### END CODE HERE ###                                                                                                                                                                    \r\n                                                                                                                                                                                                 \r\n    return scoreso, boxeso, classeso\r\n\r\ndef test_yolo_non_max_suppression(rundevice=\"cpu:0\", roinum=300):                                                                                                                                \r\n    with tf.device(\"cpu:0\"):                                                                                                                                                                     \r\n        with tf.Session() as test_b:                                                                                                                                                             \r\n            roinum = 300                                                                                                                                                                         \r\n            scoresi = tf.random_normal([roinum,], mean=1, stddev=4, seed = 1)                                                                                                                    \r\n            boxesi = tf.random_normal([roinum, 4], mean=1, dtype = tf.float32, stddev=4, seed = 1)                                                                                               \r\n            classesi = tf.random_normal([roinum,], mean=1, dtype = tf.float32, stddev=4, seed = 1)                                                                                               \r\n            scorest, boxest, classest = yolo_non_max_suppression(boxesi, scoresi, classesi, test_b, rundevice=rundevice, )                                                                       \r\n            time0 = time.time()                                                                                                                                                                  \r\n            for i in range(1,10001):                                                                                                                                                             \r\n                scores, boxes, classes = test_b.run([scorest, boxest, classest])                                                                                                                 \r\n                if i%2000 == 0:                                                                                                                                                                  \r\n                    print (i, (time.time() - time0)/i )                                                                                                                                          \r\n            time_taken = (time.time() - time0)/i                                                                                                                                                 \r\n            print (i, time_taken)                                                                                                                                                                \r\n            print(\"scores[2] = \" + str(scores[2]))                                                                                                                                               \r\n            print(\"boxes[2] = \" + str(boxes[2]))                                                                                                                                                 \r\n            print(\"classes[2] = \" + str(classes[2]))                                                                                                                                             \r\n            print(\"scores.shape = \" + str(scores.shape))                                                                                                                                         \r\n            print(\"boxes.shape = \" + str(boxes.shape))                                                                                                                                           \r\n            print(\"classes.shape = \" + str(classes.shape))                                                                                                                                       \r\n                                                                                                                                                                                                 \r\n            return time_taken\r\n\r\nif __name__ == '__main__':                                                                                                                                                                       \r\n    print (tf.__version__)                                                                                                                                                                       \r\n    from tensorflow.python.client import device_lib                                                                                                                                              \r\n    print (\"devices: \", device_lib.list_local_devices())                                                                                                                                         \r\n    cpu_time_taken = test_yolo_non_max_suppression(rundevice=\"cpu:0\", roinum=300)                                                                                                                \r\n    gpu_time_taken = test_yolo_non_max_suppression(rundevice=\"gpu:0\", roinum=300)                                                                                                                \r\n    print(\"========  cpu vs gpu time per batch =================\")                                                                                                                               \r\n    print ( \"cpu: \", cpu_time_taken, \" gpu: \", gpu_time_taken, \" cpu/gpu :\", cpu_time_taken/gpu_time_taken,)\r\n\r\n1.15.0\r\ndevices:  [name: \"/device:CPU:0\"\r\ndevice_type: \"CPU\"\r\nmemory_limit: 268435456\r\nlocality {\r\n}\r\nincarnation: 7555561621581721093\r\n, name: \"/device:XLA_CPU:0\"\r\ndevice_type: \"XLA_CPU\"\r\nmemory_limit: 17179869184\r\nlocality {\r\n}\r\nincarnation: 8901332661850439463\r\nphysical_device_desc: \"device: XLA_CPU device\"\r\n, name: \"/device:XLA_GPU:0\"\r\ndevice_type: \"XLA_GPU\"\r\nmemory_limit: 17179869184\r\nlocality {\r\n}\r\nincarnation: 740119289257596209\r\nphysical_device_desc: \"device: XLA_GPU device\"\r\n, name: \"/device:GPU:0\"\r\ndevice_type: \"GPU\"\r\nmemory_limit: 11330115994\r\nlocality {\r\n  bus_id: 1\r\n  links {\r\n  }\r\n}\r\nincarnation: 8545750488051512624\r\nphysical_device_desc: \"device: 0, name: Tesla K80, pci bus id: 0000:00:04.0, compute capability: 3.7\"\r\n]\r\n2000 0.000534496068954\r\n4000 0.000523755788803\r\n6000 0.000520971179008\r\n8000 0.000516991376877\r\n10000 0.000515855407715\r\n10000 0.000515921497345\r\nscores[2] = 10.583145\r\nboxes[2] = [ 9.513624   -1.2187521   2.245485    0.23083931]\r\nclasses[2] = 10.583145\r\nscores.shape = (10,)\r\nboxes.shape = (10, 4)\r\nclasses.shape = (10,)\r\n2000 0.00289141702652\r\n4000 0.00219018751383\r\n6000 0.0019565414985\r\n8000 0.00184808599949\r\n10000 0.00177410800457\r\n10000 0.00177413899899\r\nscores[2] = 10.583145\r\nboxes[2] = [ 9.513624   -1.2187521   2.245485    0.23083931]\r\nclasses[2] = 10.583145\r\nscores.shape = (10,)\r\nboxes.shape = (10, 4)\r\nclasses.shape = (10,)\r\n========  cpu vs gpu time per batch =================\r\ncpu:  0.000515921497345  gpu:  0.00177413899899  cpu/gpu : 0.290801057662\r\n```\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33688", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33688/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33688/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33688/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33688", "id": 511995206, "node_id": "MDU6SXNzdWU1MTE5OTUyMDY=", "number": 33688, "title": "GradientTape: Allow to execute backward functions on same device as forward functions", "user": {"login": "olesalscheider", "id": 1006058, "node_id": "MDQ6VXNlcjEwMDYwNTg=", "avatar_url": "https://avatars2.githubusercontent.com/u/1006058?v=4", "gravatar_id": "", "url": "https://api.github.com/users/olesalscheider", "html_url": "https://github.com/olesalscheider", "followers_url": "https://api.github.com/users/olesalscheider/followers", "following_url": "https://api.github.com/users/olesalscheider/following{/other_user}", "gists_url": "https://api.github.com/users/olesalscheider/gists{/gist_id}", "starred_url": "https://api.github.com/users/olesalscheider/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/olesalscheider/subscriptions", "organizations_url": "https://api.github.com/users/olesalscheider/orgs", "repos_url": "https://api.github.com/users/olesalscheider/repos", "events_url": "https://api.github.com/users/olesalscheider/events{/privacy}", "received_events_url": "https://api.github.com/users/olesalscheider/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 14, "created_at": "2019-10-24T14:48:14Z", "updated_at": "2019-11-26T15:07:18Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- TensorFlow version (you are using): 2.0\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nCurrently GradientTape.gradient() is executed on the device of the scope it is called in. Have a look at the following code:\r\n\r\n```\r\nwith tf.GradientTape() as tape:\r\n    with tf.device('/gpu:1'):\r\n        x = f1(input)\r\n    with tf.device('/gpu:2'):\r\n        x = f2(x)\r\n    with tf.device('/gpu:0'):\r\n        g = tape.gradient(x, f_vars)\r\n```\r\n\r\nHere all gradient calculations will be carried out by GPU:0 and all variables needed for the gradient calculation will also be allocated on GPU:0. This is a problem if these temporary variables are too large to fit into the VRAM of GPU:0.\r\n\r\nPlease provide a way to execute the backward functions on the device of the corresponding forward function and allocate temporary variables for gradient calculation there. This allows to split a large model and distribute it among as many GPUs as necessary.\r\n\r\n**Will this change the current api? How?**\r\nIt will add a parameter to tf.GradientTape that controls if the user wants the current or the suggested behavior.\r\n\r\n**Who will benefit with this feature?**\r\nAnyone who wants to train large models that do not fit into the VRAM of a single GPU."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33687", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33687/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33687/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33687/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33687", "id": 511976071, "node_id": "MDU6SXNzdWU1MTE5NzYwNzE=", "number": 33687, "title": "Unsure as to compile options for Intel i7 930, Bloomfield CPU for when rebuilding Tensorflow from source", "user": {"login": "Belgrath1900", "id": 56894782, "node_id": "MDQ6VXNlcjU2ODk0Nzgy", "avatar_url": "https://avatars1.githubusercontent.com/u/56894782?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Belgrath1900", "html_url": "https://github.com/Belgrath1900", "followers_url": "https://api.github.com/users/Belgrath1900/followers", "following_url": "https://api.github.com/users/Belgrath1900/following{/other_user}", "gists_url": "https://api.github.com/users/Belgrath1900/gists{/gist_id}", "starred_url": "https://api.github.com/users/Belgrath1900/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Belgrath1900/subscriptions", "organizations_url": "https://api.github.com/users/Belgrath1900/orgs", "repos_url": "https://api.github.com/users/Belgrath1900/repos", "events_url": "https://api.github.com/users/Belgrath1900/events{/privacy}", "received_events_url": "https://api.github.com/users/Belgrath1900/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1188421838, "node_id": "MDU6TGFiZWwxMTg4NDIxODM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:windows", "name": "subtype:windows", "color": "b619ea", "default": false, "description": "Windows Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-10-24T14:17:56Z", "updated_at": "2019-10-26T01:04:10Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\nWindows 7\r\n\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\nPC\r\n\r\n- TensorFlow installed from (source or binary):\r\nTrying to recompile TensorFlow 2.0 for my older machine without AVX support\r\n\r\n- TensorFlow version: 2\r\n- Python version:  3.7\r\n- Installed using virtualenv? pip? conda?: pip\r\n- Bazel version (if compiling from source): 0.28.1\r\n- GCC/Compiler version (if compiling from source): latest\r\n- CUDA/cuDNN version:  n/a I have an older GTS-250 card that does not support\r\n- GPU model and memory:\r\nCPU is an Intel i7 930 which I believe is a Bloomfield model\r\n\r\n**Describe the problem**\r\nI'm at the step during the rebuild that is asking me for optimization flags.  I want to make sure that I am picking the correct ones with my CPU and GPU.\r\n\r\nsome of the previous options were:\r\n\r\nFound possible Python library paths:\r\n  C:\\Users\\Bill\\AppData\\Local\\Programs\\Python\\Python37\\lib\\site-packages\r\nPlease input the desired Python library path to use.  Default is [C:\\Users\\Bill\\AppData\\Local\\Programs\\Python\\Python37\\lib\\site-packages]\r\n\r\nDo you wish to build TensorFlow with XLA JIT support? [y/N]: y\r\nXLA JIT support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with ROCm support? [y/N]: N\r\nNo ROCm support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with CUDA support? [y/N]: N\r\nNo CUDA support will be enabled for TensorFlow.\r\n\r\nPlease specify optimization flags to use during compilation when bazel option \"--config=opt\" is specified [Default is /arch:AVX]:\r\n\r\nSo I'm at this point and I'm not sure if I should use --config-opt or something like -march core2 I checked to see if there was a -march bloomfield but no option exists... \r\n\r\nWould someone be able to spell out the exact options that I should be using.  Many thanks ahead of time!\r\n\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\nlisted above\r\n\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33681", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33681/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33681/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33681/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33681", "id": 511887215, "node_id": "MDU6SXNzdWU1MTE4ODcyMTU=", "number": 33681, "title": "_num_elements(grad) difference between Tensor and IndexedSlices behavior", "user": {"login": "alexeyr", "id": 24733, "node_id": "MDQ6VXNlcjI0NzMz", "avatar_url": "https://avatars2.githubusercontent.com/u/24733?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alexeyr", "html_url": "https://github.com/alexeyr", "followers_url": "https://api.github.com/users/alexeyr/followers", "following_url": "https://api.github.com/users/alexeyr/following{/other_user}", "gists_url": "https://api.github.com/users/alexeyr/gists{/gist_id}", "starred_url": "https://api.github.com/users/alexeyr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alexeyr/subscriptions", "organizations_url": "https://api.github.com/users/alexeyr/orgs", "repos_url": "https://api.github.com/users/alexeyr/repos", "events_url": "https://api.github.com/users/alexeyr/events{/privacy}", "received_events_url": "https://api.github.com/users/alexeyr/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 736653459, "node_id": "MDU6TGFiZWw3MzY2NTM0NTk=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:eager", "name": "comp:eager", "color": "0052cc", "default": false, "description": ""}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "allenlavoie", "id": 3731025, "node_id": "MDQ6VXNlcjM3MzEwMjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3731025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allenlavoie", "html_url": "https://github.com/allenlavoie", "followers_url": "https://api.github.com/users/allenlavoie/followers", "following_url": "https://api.github.com/users/allenlavoie/following{/other_user}", "gists_url": "https://api.github.com/users/allenlavoie/gists{/gist_id}", "starred_url": "https://api.github.com/users/allenlavoie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allenlavoie/subscriptions", "organizations_url": "https://api.github.com/users/allenlavoie/orgs", "repos_url": "https://api.github.com/users/allenlavoie/repos", "events_url": "https://api.github.com/users/allenlavoie/events{/privacy}", "received_events_url": "https://api.github.com/users/allenlavoie/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "allenlavoie", "id": 3731025, "node_id": "MDQ6VXNlcjM3MzEwMjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3731025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allenlavoie", "html_url": "https://github.com/allenlavoie", "followers_url": "https://api.github.com/users/allenlavoie/followers", "following_url": "https://api.github.com/users/allenlavoie/following{/other_user}", "gists_url": "https://api.github.com/users/allenlavoie/gists{/gist_id}", "starred_url": "https://api.github.com/users/allenlavoie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allenlavoie/subscriptions", "organizations_url": "https://api.github.com/users/allenlavoie/orgs", "repos_url": "https://api.github.com/users/allenlavoie/repos", "events_url": "https://api.github.com/users/allenlavoie/events{/privacy}", "received_events_url": "https://api.github.com/users/allenlavoie/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-10-24T11:36:48Z", "updated_at": "2019-12-01T07:08:01Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux-4.4.0-87-generic-x86_64-with-Ubuntu-16.04-xenial\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 2.0\r\n- Python version: 3.7\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source): N/A\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: N/A\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nWhen training a model (which I can't make public at the moment), I've got an error: `<built-in function len> returned a result with an error set`. Debugging showed the reason was in\r\nhttps://github.com/tensorflow/tensorflow/blob/0d76b0f988d3d7b06f16da950b3ed95e4ec59e82/tensorflow/python/eager/backprop.py#L615-L624\r\nNamely, my code ended up with `grad` being an instance of `IndexedSlices`, but `grad.values._shape_tuple()` was `(None, 16)`. \r\n\r\nChanging code to\r\n```\r\n    shape_tuple = grad.values._shape_tuple()  # pylint: disable=protected-access\r\n    if shape_tuple is None or None in shape_tuple:\r\n      return 0\r\n    return functools.reduce(operator.mul, shape_tuple, 1)\r\n```\r\nby analogy with the `Tensor` case appears to work and let my model train, but I am not certain whether that's correct.\r\n\r\n**Describe the expected behavior**\r\nEither handle the case where `grad.values._shape_tuple()` is/contains `None`, or explicitly throw `ValueError` if it shouldn't be allowed.\r\n\r\n**Code to reproduce the issue**\r\n(Will try to do this later)\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33679", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33679/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33679/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33679/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33679", "id": 511860588, "node_id": "MDU6SXNzdWU1MTE4NjA1ODg=", "number": 33679, "title": "TensorFlow Lite Support for LSTM Models", "user": {"login": "deansk90", "id": 24352160, "node_id": "MDQ6VXNlcjI0MzUyMTYw", "avatar_url": "https://avatars1.githubusercontent.com/u/24352160?v=4", "gravatar_id": "", "url": "https://api.github.com/users/deansk90", "html_url": "https://github.com/deansk90", "followers_url": "https://api.github.com/users/deansk90/followers", "following_url": "https://api.github.com/users/deansk90/following{/other_user}", "gists_url": "https://api.github.com/users/deansk90/gists{/gist_id}", "starred_url": "https://api.github.com/users/deansk90/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/deansk90/subscriptions", "organizations_url": "https://api.github.com/users/deansk90/orgs", "repos_url": "https://api.github.com/users/deansk90/repos", "events_url": "https://api.github.com/users/deansk90/events{/privacy}", "received_events_url": "https://api.github.com/users/deansk90/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jianlijianli", "id": 43797323, "node_id": "MDQ6VXNlcjQzNzk3MzIz", "avatar_url": "https://avatars3.githubusercontent.com/u/43797323?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jianlijianli", "html_url": "https://github.com/jianlijianli", "followers_url": "https://api.github.com/users/jianlijianli/followers", "following_url": "https://api.github.com/users/jianlijianli/following{/other_user}", "gists_url": "https://api.github.com/users/jianlijianli/gists{/gist_id}", "starred_url": "https://api.github.com/users/jianlijianli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jianlijianli/subscriptions", "organizations_url": "https://api.github.com/users/jianlijianli/orgs", "repos_url": "https://api.github.com/users/jianlijianli/repos", "events_url": "https://api.github.com/users/jianlijianli/events{/privacy}", "received_events_url": "https://api.github.com/users/jianlijianli/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jianlijianli", "id": 43797323, "node_id": "MDQ6VXNlcjQzNzk3MzIz", "avatar_url": "https://avatars3.githubusercontent.com/u/43797323?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jianlijianli", "html_url": "https://github.com/jianlijianli", "followers_url": "https://api.github.com/users/jianlijianli/followers", "following_url": "https://api.github.com/users/jianlijianli/following{/other_user}", "gists_url": "https://api.github.com/users/jianlijianli/gists{/gist_id}", "starred_url": "https://api.github.com/users/jianlijianli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jianlijianli/subscriptions", "organizations_url": "https://api.github.com/users/jianlijianli/orgs", "repos_url": "https://api.github.com/users/jianlijianli/repos", "events_url": "https://api.github.com/users/jianlijianli/events{/privacy}", "received_events_url": "https://api.github.com/users/jianlijianli/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-10-24T10:41:19Z", "updated_at": "2019-10-25T06:38:17Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using): 2.0.0\r\n- Are you willing to contribute it (Yes/No): No\r\n\r\n**Describe the feature and the current behavior/state.**\r\nAs mentioned in the TensorFlow Lite 2019 roadmap, a full support for LSTM and RNN models is expected. When this support is expected to be released? will it also support LSTM layers from Keras? \r\n\r\n**Will this change the current api? How?**\r\nNot sure \r\n\r\n**Who will benefit with this feature?**\r\nEveryone which would like to convert TensorFlow LSTM models to the TensorFlow lite format \r\n\r\n**Any Other info.**\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33677", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33677/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33677/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33677/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33677", "id": 511857840, "node_id": "MDU6SXNzdWU1MTE4NTc4NDA=", "number": 33677, "title": "tflite:experimental:micro:riscv: the default build target is wrong.", "user": {"login": "zhoupeng", "id": 1014132, "node_id": "MDQ6VXNlcjEwMTQxMzI=", "avatar_url": "https://avatars0.githubusercontent.com/u/1014132?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zhoupeng", "html_url": "https://github.com/zhoupeng", "followers_url": "https://api.github.com/users/zhoupeng/followers", "following_url": "https://api.github.com/users/zhoupeng/following{/other_user}", "gists_url": "https://api.github.com/users/zhoupeng/gists{/gist_id}", "starred_url": "https://api.github.com/users/zhoupeng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zhoupeng/subscriptions", "organizations_url": "https://api.github.com/users/zhoupeng/orgs", "repos_url": "https://api.github.com/users/zhoupeng/repos", "events_url": "https://api.github.com/users/zhoupeng/events{/privacy}", "received_events_url": "https://api.github.com/users/zhoupeng/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "njeffrie", "id": 6947391, "node_id": "MDQ6VXNlcjY5NDczOTE=", "avatar_url": "https://avatars2.githubusercontent.com/u/6947391?v=4", "gravatar_id": "", "url": "https://api.github.com/users/njeffrie", "html_url": "https://github.com/njeffrie", "followers_url": "https://api.github.com/users/njeffrie/followers", "following_url": "https://api.github.com/users/njeffrie/following{/other_user}", "gists_url": "https://api.github.com/users/njeffrie/gists{/gist_id}", "starred_url": "https://api.github.com/users/njeffrie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/njeffrie/subscriptions", "organizations_url": "https://api.github.com/users/njeffrie/orgs", "repos_url": "https://api.github.com/users/njeffrie/repos", "events_url": "https://api.github.com/users/njeffrie/events{/privacy}", "received_events_url": "https://api.github.com/users/njeffrie/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "njeffrie", "id": 6947391, "node_id": "MDQ6VXNlcjY5NDczOTE=", "avatar_url": "https://avatars2.githubusercontent.com/u/6947391?v=4", "gravatar_id": "", "url": "https://api.github.com/users/njeffrie", "html_url": "https://github.com/njeffrie", "followers_url": "https://api.github.com/users/njeffrie/followers", "following_url": "https://api.github.com/users/njeffrie/following{/other_user}", "gists_url": "https://api.github.com/users/njeffrie/gists{/gist_id}", "starred_url": "https://api.github.com/users/njeffrie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/njeffrie/subscriptions", "organizations_url": "https://api.github.com/users/njeffrie/orgs", "repos_url": "https://api.github.com/users/njeffrie/repos", "events_url": "https://api.github.com/users/njeffrie/events{/privacy}", "received_events_url": "https://api.github.com/users/njeffrie/received_events", "type": "User", "site_admin": false}, {"login": "rockyrhodes", "id": 7253968, "node_id": "MDQ6VXNlcjcyNTM5Njg=", "avatar_url": "https://avatars2.githubusercontent.com/u/7253968?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rockyrhodes", "html_url": "https://github.com/rockyrhodes", "followers_url": "https://api.github.com/users/rockyrhodes/followers", "following_url": "https://api.github.com/users/rockyrhodes/following{/other_user}", "gists_url": "https://api.github.com/users/rockyrhodes/gists{/gist_id}", "starred_url": "https://api.github.com/users/rockyrhodes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rockyrhodes/subscriptions", "organizations_url": "https://api.github.com/users/rockyrhodes/orgs", "repos_url": "https://api.github.com/users/rockyrhodes/repos", "events_url": "https://api.github.com/users/rockyrhodes/events{/privacy}", "received_events_url": "https://api.github.com/users/rockyrhodes/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-10-24T10:35:51Z", "updated_at": "2019-11-11T16:58:14Z", "closed_at": null, "author_association": "NONE", "body": "The intended target ( `make -f tensorflow/lite/experimental/micro/tools/make/Makefile TARGET=riscv32_mcu`) should be `all` , as in the README.md\r\nhttps://github.com/tensorflow/tensorflow/blob/master/tensorflow/lite/experimental/micro/README.md.\r\nBut in fact it's not `all' by default."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33675", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33675/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33675/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33675/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33675", "id": 511814854, "node_id": "MDU6SXNzdWU1MTE4MTQ4NTQ=", "number": 33675, "title": "tf.keras.callbacks.ReduceLROnPlateau -  min_delta parameter should be percentage, not absolute  ", "user": {"login": "danieltomer", "id": 39792779, "node_id": "MDQ6VXNlcjM5NzkyNzc5", "avatar_url": "https://avatars1.githubusercontent.com/u/39792779?v=4", "gravatar_id": "", "url": "https://api.github.com/users/danieltomer", "html_url": "https://github.com/danieltomer", "followers_url": "https://api.github.com/users/danieltomer/followers", "following_url": "https://api.github.com/users/danieltomer/following{/other_user}", "gists_url": "https://api.github.com/users/danieltomer/gists{/gist_id}", "starred_url": "https://api.github.com/users/danieltomer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/danieltomer/subscriptions", "organizations_url": "https://api.github.com/users/danieltomer/orgs", "repos_url": "https://api.github.com/users/danieltomer/repos", "events_url": "https://api.github.com/users/danieltomer/events{/privacy}", "received_events_url": "https://api.github.com/users/danieltomer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-10-24T09:15:56Z", "updated_at": "2019-11-05T18:29:05Z", "closed_at": null, "author_association": "NONE", "body": "\r\n**System information**\r\n- TensorFlow version 2.0:\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nRegarding tf.keras.callbacks.ReduceLROnPlateau: The min_delta parameter is currently an absolute number which indicates when a meaningful reduction in the monitored loss has accrued. It makes no sense to use an absolute number for two reasons - \r\n1. Every loss has a different dynamic range and hence a different definition for a meaningful reduction\r\n2. A \"meaningful reduction\" decreases as the training progresses. The higher the epoch the smaller of a change in loss is expected.  \r\n\r\nFor these two reasons I think that a percentage of change in the monitored loss is much more useful. \r\n\r\n**Will this change the current api? How?**\r\nMaybe, if the implantation is by adding a new parameter to the callback named \"min_delta_percent\".\r\n**Who will benefit with this feature?**\r\nEveryone using this callback.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33671", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33671/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33671/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33671/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33671", "id": 511751881, "node_id": "MDU6SXNzdWU1MTE3NTE4ODE=", "number": 33671, "title": "TFLite Raspberry Pi object detection example code does not work with tensorflow.lite.python.interpreter, only works with tflite_runtime.interpreter", "user": {"login": "EdjeElectronics", "id": 26154245, "node_id": "MDQ6VXNlcjI2MTU0MjQ1", "avatar_url": "https://avatars0.githubusercontent.com/u/26154245?v=4", "gravatar_id": "", "url": "https://api.github.com/users/EdjeElectronics", "html_url": "https://github.com/EdjeElectronics", "followers_url": "https://api.github.com/users/EdjeElectronics/followers", "following_url": "https://api.github.com/users/EdjeElectronics/following{/other_user}", "gists_url": "https://api.github.com/users/EdjeElectronics/gists{/gist_id}", "starred_url": "https://api.github.com/users/EdjeElectronics/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/EdjeElectronics/subscriptions", "organizations_url": "https://api.github.com/users/EdjeElectronics/orgs", "repos_url": "https://api.github.com/users/EdjeElectronics/repos", "events_url": "https://api.github.com/users/EdjeElectronics/events{/privacy}", "received_events_url": "https://api.github.com/users/EdjeElectronics/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-10-24T07:09:51Z", "updated_at": "2019-11-17T23:07:04Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Raspbian Buster\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: Raspberry Pi 4 4GB\r\n- TensorFlow installed from (source or binary): Binary (pip3 install tensorflow)\r\n- TensorFlow version (use command below): v1.12.1-3892-g127aae0 1.13.1\r\n- Python version: 3.7.3\r\n- Bazel version (if compiling from source): n/a\r\n- GCC/Compiler version (if compiling from source): n/a\r\n- CUDA/cuDNN version: n/a\r\n- GPU model and memory: n/a\r\n\r\n**Describe the behavior**\r\nI am following the TFLite object detection on Raspberry Pi guide (https://github.com/tensorflow/examples/tree/master/lite/examples/object_detection/raspberry_pi) using a Raspberry Pi 4 4GB model. The guide says to download and install the tflite_runtime from the [Python quickstart page](https://www.tensorflow.org/lite/guide/python). However, I tried using it with my existing installation of TensorFlow since I already have it installed on my Pi 4, and the script exits with the error shown below.\r\n\r\nIt also doesn't work if I have regular TensorFlow and the tflite_runtime package installed at the same time. It does work if I uninstall TensorFlow using `pip3 uninstall tensorflow` and then install the tflite_runtime package. \r\n\r\n**Describe the expected behavior**\r\nIt would be nice if the object detection example code worked without having to remove my existing TensorFlow install.\r\n\r\n**Code to reproduce the issue**\r\nI used the example code given [here](https://github.com/tensorflow/examples/blob/master/lite/examples/object_detection/raspberry_pi/detect_picamera.py). When trying to use regular TensorFlow (rather than just the tflite_runtime package), I changed line 33 from `from tflite_runtime.interpreter import Interpreter` to `from tensorflow.lite.python.interpreter import Interpreter`.\r\n\r\nI called the script using:\r\n```\r\npython3 detect_picamera.py \\\r\n  --model /tmp/detect.tflite \\\r\n  --labels /tmp/coco_labels.txt\r\n```\r\n\r\n**Other info / logs**\r\nTraceback for the error I am getting:\r\n\r\nTraceback (most recent call last):\r\n  File \"TFLite_detection_picamera.py\", line 113, in <module>\r\n    interpreter = Interpreter(model_path=PATH_TO_CKPT)\r\n  File \"/home/pi/.local/lib/python3.7/site-packages/tflite_runtime/interpreter.py\", line 205, in __init__\r\n    _interpreter_wrapper.InterpreterWrapper_CreateWrapperCPPFromFile(\r\n  File \"/home/pi/.local/lib/python3.7/site-packages/tensorflow_core/python/util/lazy_loader.py\", line 62, in __getattr__\r\n    module = self._load()\r\n  File \"/home/pi/.local/lib/python3.7/site-packages/tensorflow_core/python/util/lazy_loader.py\", line 45, in _load\r\n    module = importlib.import_module(self.__name__)\r\n  File \"/usr/lib/python3.7/importlib/__init__.py\", line 127, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\n  File \"<frozen importlib._bootstrap>\", line 1006, in _gcd_import\r\n  File \"<frozen importlib._bootstrap>\", line 983, in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 967, in _find_and_load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 677, in _load_unlocked\r\n  File \"<frozen importlib._bootstrap_external>\", line 728, in exec_module\r\n  File \"<frozen importlib._bootstrap>\", line 219, in _call_with_frames_removed\r\n  File \"/home/pi/.local/lib/python3.7/site-packages/tensorflow_core/lite/python/interpreter_wrapper/tensorflow_wrap_interpreter_wrapper.py\", line 28, in <module>\r\n    _tensorflow_wrap_interpreter_wrapper = swig_import_helper()\r\n  File \"/home/pi/.local/lib/python3.7/site-packages/tensorflow_core/lite/python/interpreter_wrapper/tensorflow_wrap_interpreter_wrapper.py\", line 24, in swig_import_helper\r\n    _mod = imp.load_module('_tensorflow_wrap_interpreter_wrapper', fp, pathname, description)\r\n  File \"/usr/lib/python3.7/imp.py\", line 242, in load_module\r\n    return load_dynamic(name, filename, file)\r\n  File \"/usr/lib/python3.7/imp.py\", line 342, in load_dynamic\r\n    return _load(spec)\r\n  File \"<frozen importlib._bootstrap>\", line 696, in _load\r\n  File \"<frozen importlib._bootstrap>\", line 670, in _load_unlocked\r\n  File \"<frozen importlib._bootstrap>\", line 583, in module_from_spec\r\n  File \"<frozen importlib._bootstrap_external>\", line 1043, in create_module\r\n  File \"<frozen importlib._bootstrap>\", line 219, in _call_with_frames_removed\r\nImportError: /home/pi/.local/lib/python3.7/site-packages/tensorflow_core/lite/python/interpreter_wrapper/_tensorflow_wrap_interpreter_wrapper.so: undefined symbol: _ZN6tflite12tensor_utils24NeonVectorScalarMultiplyEPKaifPf\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33668", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33668/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33668/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33668/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33668", "id": 511728044, "node_id": "MDU6SXNzdWU1MTE3MjgwNDQ=", "number": 33668, "title": "[Simple Bug] 'name' should be a variable", "user": {"login": "walty19950301", "id": 34183784, "node_id": "MDQ6VXNlcjM0MTgzNzg0", "avatar_url": "https://avatars0.githubusercontent.com/u/34183784?v=4", "gravatar_id": "", "url": "https://api.github.com/users/walty19950301", "html_url": "https://github.com/walty19950301", "followers_url": "https://api.github.com/users/walty19950301/followers", "following_url": "https://api.github.com/users/walty19950301/following{/other_user}", "gists_url": "https://api.github.com/users/walty19950301/gists{/gist_id}", "starred_url": "https://api.github.com/users/walty19950301/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/walty19950301/subscriptions", "organizations_url": "https://api.github.com/users/walty19950301/orgs", "repos_url": "https://api.github.com/users/walty19950301/repos", "events_url": "https://api.github.com/users/walty19950301/events{/privacy}", "received_events_url": "https://api.github.com/users/walty19950301/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 1166103538, "node_id": "MDU6TGFiZWwxMTY2MTAzNTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/contrib", "name": "contrib", "color": "5319e7", "default": false, "description": "Anything that comes under contrib directory"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ebrevdo", "id": 1794715, "node_id": "MDQ6VXNlcjE3OTQ3MTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1794715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebrevdo", "html_url": "https://github.com/ebrevdo", "followers_url": "https://api.github.com/users/ebrevdo/followers", "following_url": "https://api.github.com/users/ebrevdo/following{/other_user}", "gists_url": "https://api.github.com/users/ebrevdo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebrevdo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebrevdo/subscriptions", "organizations_url": "https://api.github.com/users/ebrevdo/orgs", "repos_url": "https://api.github.com/users/ebrevdo/repos", "events_url": "https://api.github.com/users/ebrevdo/events{/privacy}", "received_events_url": "https://api.github.com/users/ebrevdo/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ebrevdo", "id": 1794715, "node_id": "MDQ6VXNlcjE3OTQ3MTU=", "avatar_url": "https://avatars0.githubusercontent.com/u/1794715?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebrevdo", "html_url": "https://github.com/ebrevdo", "followers_url": "https://api.github.com/users/ebrevdo/followers", "following_url": "https://api.github.com/users/ebrevdo/following{/other_user}", "gists_url": "https://api.github.com/users/ebrevdo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebrevdo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebrevdo/subscriptions", "organizations_url": "https://api.github.com/users/ebrevdo/orgs", "repos_url": "https://api.github.com/users/ebrevdo/repos", "events_url": "https://api.github.com/users/ebrevdo/events{/privacy}", "received_events_url": "https://api.github.com/users/ebrevdo/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-10-24T06:10:41Z", "updated_at": "2019-11-26T22:47:01Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- TensorFlow version 1.13\r\n- Python version: 3.6.8\r\n\r\n**Describe the current behavior**\r\nI want build two convLSTMCell and use them. like follow [Code to reproduce the issue]\r\ntensorflow talk to me: `ValueError: Variable kernel already exists, disallowed. Did you mean to set reuse=True or reuse=tf.AUTO_REUSE in VarScope? Originally defined at xxxx.`\r\n\r\n\r\n**Describe the expected behavior**\r\nthe code can run without error.\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport tensorflow as tf\r\nimport tensorflow.contrib.rnn as rnn\r\nimport numpy as np\r\n\r\nnpa = np.array([[[[1,2,3],[4,5,6],[4,5,6]],[[7,8,9],[10,11,12],[10,11,12]],[[13,14,15],[16,17,18],[16,17,18]]]])\r\nprint(npa.shape)\r\nx = tf.constant(npa, dtype=tf.float32)\r\nprint(x)\r\n# first cell\r\ncell_encoder = rnn.Conv2DLSTMCell(input_shape=[x.shape[1], x.shape[2], x.shape[3]], output_channels=4,kernel_shape=[3, 3], name='encoder')\r\ninitial1 = cell_encoder.zero_state(batch_size=x.shape[0],dtype=tf.float32)\r\nx1, fs1 = cell_encoder.call(inputs=x, state=initial1)\r\n# second cell\r\ncell_decoder = rnn.Conv2DLSTMCell(input_shape=[x.shape[1], x.shape[2], x.shape[3]], output_channels=4, kernel_shape=[3, 3], name='decoder')\r\ninitial2 = cell_decoder.zero_state(batch_size=x.shape[0], dtype=tf.float32)\r\nx2, fs2 = cell_decoder.call(inputs=x, state=initial2)\r\n\r\nwith tf.Session() as sess:\r\n    sess.run(tf.global_variables_initializer())\r\n    x = sess.run(x2)\r\n    print(x)\r\n```\r\n[minimal standalone code ]\r\n\r\n**Other info / logs**\r\nWhen system execution `[cell_decoder.call]`,  tensorflow talk to me: `ValueError: Variable kernel already exists, disallowed. Did you mean to set reuse=True or reuse=tf.AUTO_REUSE in VarScope? Originally defined at xxxx`.\r\nthen ,i tack the code find `tensorflow/contrib/rnn/python/ops/rnn_cell.py line: 2215 & 2228, vs.get_variable function `name of the function should be a variable, not a constant.\r\nthe issue is simple. If the name  is a constant, the second cell, cell_decoder, will use the same one variable.\r\n\r\nThanks to tensorflow for providing AI open source framework.  O(\u2229_\u2229)O\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33662", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33662/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33662/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33662/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33662", "id": 511673315, "node_id": "MDU6SXNzdWU1MTE2NzMzMTU=", "number": 33662, "title": "How to write a dataset of serialized examples directly to a tfrecords file?", "user": {"login": "KristianHolsheimer", "id": 8200332, "node_id": "MDQ6VXNlcjgyMDAzMzI=", "avatar_url": "https://avatars0.githubusercontent.com/u/8200332?v=4", "gravatar_id": "", "url": "https://api.github.com/users/KristianHolsheimer", "html_url": "https://github.com/KristianHolsheimer", "followers_url": "https://api.github.com/users/KristianHolsheimer/followers", "following_url": "https://api.github.com/users/KristianHolsheimer/following{/other_user}", "gists_url": "https://api.github.com/users/KristianHolsheimer/gists{/gist_id}", "starred_url": "https://api.github.com/users/KristianHolsheimer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/KristianHolsheimer/subscriptions", "organizations_url": "https://api.github.com/users/KristianHolsheimer/orgs", "repos_url": "https://api.github.com/users/KristianHolsheimer/repos", "events_url": "https://api.github.com/users/KristianHolsheimer/events{/privacy}", "received_events_url": "https://api.github.com/users/KristianHolsheimer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-10-24T02:57:29Z", "updated_at": "2019-10-30T00:34:07Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "I tried asking the broader community for this, but nothing came back, so I'm asking it here.\r\n\r\nI have a `tf.data.Dataset` that contains serialized tfrecord/protobuf examples:\r\n\r\n```python\r\n>>> example = ds.make_one_shot_iterator().get_next()\r\n>>> example\r\n<tf.Tensor: id=42, shape=(), dtype=string, numpy=b'\\n\\xdd:\\n\\r\\n\\x01y\\x12\\x08\\x12\\x06\\n\\x...'>\r\n```\r\nSo each example in the dataset `ds` is just a flat byte string.\r\n\r\nWhat I'd like to do is to write these byte strings to disk (tfrecords file). The way I know to do this is to go through python land. For instance, using a tf1 session, this would look like:\r\n```python\r\nexample = ds.make_one_shot_iterator().get_next()\r\n\r\nwith tf.io.TFRecordWriter(\"/path/to/output/data.tfrecords\") as w:\r\n    with tf.Session() as sess:\r\n        w.write(sess.run(example))\r\n```\r\nThis doesn't feel very efficient to me. So my question is:\r\n\r\n- Is there a way that I can write this to a file without having to go through the python layer?\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33660", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33660/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33660/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33660/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33660", "id": 511657267, "node_id": "MDU6SXNzdWU1MTE2NTcyNjc=", "number": 33660, "title": "tf.test.compute_gradient (v2) expects wrong empty gradient shape", "user": {"login": "duncanriach", "id": 33532941, "node_id": "MDQ6VXNlcjMzNTMyOTQx", "avatar_url": "https://avatars0.githubusercontent.com/u/33532941?v=4", "gravatar_id": "", "url": "https://api.github.com/users/duncanriach", "html_url": "https://github.com/duncanriach", "followers_url": "https://api.github.com/users/duncanriach/followers", "following_url": "https://api.github.com/users/duncanriach/following{/other_user}", "gists_url": "https://api.github.com/users/duncanriach/gists{/gist_id}", "starred_url": "https://api.github.com/users/duncanriach/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/duncanriach/subscriptions", "organizations_url": "https://api.github.com/users/duncanriach/orgs", "repos_url": "https://api.github.com/users/duncanriach/repos", "events_url": "https://api.github.com/users/duncanriach/events{/privacy}", "received_events_url": "https://api.github.com/users/duncanriach/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-10-24T01:53:08Z", "updated_at": "2020-03-13T11:41:12Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System Information**\r\n\r\n- Have I written custom code: YES (see below)\r\n- OS Platform and Distribution: Ubuntu 18.04.3 LTS (inside `tensorflow/tensorflow:2.0.0-gpu`)\r\n- Mobile device: N/A\r\n- TensorFlow installed from: binary (inside `tensorflow/tensorflow:2.0.0-gpu`)\r\n- TensorFlow version: 2.0.0\r\n- Python version: 2.7.15+\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source): N/A\r\n- CUDA/cuDNN version: 10.0\r\n- GPU model and memory: TITANV 12GB\r\n\r\n**Current Behavior**\r\nWhen the gradient tensors are totally empty (i.e. all their dimensions are zero), and more than one input is considered at the same time,  the shape of an expected gradient tensor does not match the actual shape produced by the op's gradient function. This case is not currently tested in `tensorflow/python/ops/gradient_checker_v2_test.py` (see `testEmptyMatMul`).\r\n\r\n*UPDATE*: I also tried the configuration in `testEmptyMatMul` (see additional code below) and found that this also tickles the apparent bug. Surprisingly, `//tensorflow/python:gradient_checker_v2_test` passes when running on tag v2.0.0; I don't currently understand why.\r\n\r\nI have tested\r\n  * with two different ops, each with two inputs (both fail).\r\n  * cases where not all of the gradient tensors are empty (as in `testEmptyMatMul`).\r\n  * `tf.compat.v1.test.compute_gradient` with more than one empty input does **not** exhibit this behavior, so it was probably not present in `tensorflow/python/ops/gradient_checker.py` but was introduced in `tensorflow/python/ops/gradient_checker_v2.py`. See code at the end, in the \"TensorFlow Version 1 API\" section, that demonstrates this.\r\n\r\nI have **not** tested\r\n  * using ops with more than two inputs\r\n\r\n**Expected Behavior**\r\nThese exceptions should not be produced when using built-in ops. Either the ops' gradient functions are producing the wrong shaped tensors (which would be a bug), or, more likely, the code in `gradient_checker_v2.py` is expecting the wrong shape.\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\ndef empty(rank):\r\n  shape = (0,) * rank\r\n  return np.array([]).reshape(shape)\r\n\r\n# comment-out the first to run the second\r\ntf.test.compute_gradient(tf.nn.bias_add, [empty(3), empty(1)])\r\ntf.test.compute_gradient(tf.linalg.matmul, [empty(2), empty(3)])\r\n```\r\n\r\nThe following is essentially the same as the code in `testEmptyMatMul` in `tensorflow/python/ops/gradient_checker_v2_test.py`: \r\n```\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\ndef random_tensor(shape):\r\n  return tf.constant(np.random.random_sample(shape))\r\n\r\ndef f(x, y):\r\n  return tf.linalg.matmul(x, y)\r\n\r\nx = random_tensor((0, 3))\r\ny = random_tensor((3, 4))\r\n\r\njacobians = tf.test.compute_gradient(f, [x, y])\r\n```\r\n\r\n**Other info / logs**\r\n\r\nOutput from the above code:\r\n```\r\nTraceback (most recent call last):\r\n  File \"repro_eager_issue.py\", line 24, in <module>\r\n    tf.test.compute_gradient(tf.nn.bias_add, [empty(3), empty(1)])\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow_core/python/ops/gradient_checker_v2.py\", line 332, in compute_gradient\r\n    return _compute_gradient_list(f, x, delta)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow_core/python/ops/gradient_checker_v2.py\", line 293, in _compute_gradient_list\r\n    xs, i, delta) for i in range(len(xs))])\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow_core/python/ops/gradient_checker_v2.py\", line 278, in _compute_gradient\r\n    xs, param)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow_core/python/ops/gradient_checker_v2.py\", line 187, in _compute_theoretical_jacobian\r\n    (x.shape, grad.shape))\r\nValueError: Empty gradient has wrong shape: expected (0,), got (0, 0, 0)\r\n\r\nTraceback (most recent call last):\r\n  File \"repro_eager_issue.py\", line 25, in <module>\r\n    tf.test.compute_gradient(tf.linalg.matmul, [empty(2), empty(3)])\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow_core/python/ops/gradient_checker_v2.py\", line 332, in compute_gradient\r\n    return _compute_gradient_list(f, x, delta)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow_core/python/ops/gradient_checker_v2.py\", line 293, in _compute_gradient_list\r\n    xs, i, delta) for i in range(len(xs))])\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow_core/python/ops/gradient_checker_v2.py\", line 278, in _compute_gradient\r\n    xs, param)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow_core/python/ops/gradient_checker_v2.py\", line 187, in _compute_theoretical_jacobian\r\n    (x.shape, grad.shape))\r\nValueError: Empty gradient has wrong shape: expected (0, 0, 0), got (0, 0)\r\n\r\nTraceback (most recent call last):\r\n  File \"tf_issue_33660.py\", line 77, in <module>\r\n    existing_test_repro()\r\n  File \"tf_issue_33660.py\", line 71, in existing_test_repro\r\n    jacobians = tf.test.compute_gradient(f, [x, y])\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow_core/python/ops/gradient_checker_v2.py\", line 332, in compute_gradient\r\n    return _compute_gradient_list(f, x, delta)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow_core/python/ops/gradient_checker_v2.py\", line 293, in _compute_gradient_list\r\n    xs, i, delta) for i in range(len(xs))])\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow_core/python/ops/gradient_checker_v2.py\", line 278, in _compute_gradient\r\n    xs, param)\r\n  File \"/usr/local/lib/python2.7/dist-packages/tensorflow_core/python/ops/gradient_checker_v2.py\", line 187, in _compute_theoretical_jacobian\r\n    (x.shape, grad.shape))\r\nValueError: Empty gradient has wrong shape: expected (3, 4), got (0, 3)\r\n```\r\n\r\n**Work-Around**\r\n\r\n`compute_gradient` can be called multiple times, once for each input, to get the analytical and numerical jacobians for each input separately. As, follows:\r\n\r\n```\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\ndef empty(rank):\r\n  shape = (0,) * rank\r\n  return np.array([]).reshape(shape)\r\n\r\ninput_val = empty(3)\r\nbias_val = empty(1)\r\n\r\ndef bias_add_1(input_val):\r\n  return tf.nn.bias_add(input_val, bias_val)\r\n\r\ndef bias_add_2(bias_val):\r\n  return tf.nn.bias_add(input_val, bias_val)\r\n\r\ninput_jacobians = tf.test.compute_gradient(bias_add_1, [input_val])\r\nbias_jacobians = tf.test.compute_gradient(bias_add_2, [bias_val])\r\n```\r\n\r\n**TensorFlow Version 1 API**\r\n\r\nThe following code **does not** throw an exception, demonstrating that this problem does not exist with `tf.compat.v1.test.compute_gradient`.\r\n\r\n```\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\ndef empty_tensor(shape):\r\n  return tf.constant([], shape=shape)\r\n\r\ntf.compat.v1.disable_eager_execution()\r\ninput_shape = output_shape = (0, 0, 0)\r\nbias_shape = (0,)\r\ninput_tensor = empty_tensor(input_shape)\r\nbias_tensor = empty_tensor(bias_shape)\r\noutput_tensor = tf.nn.bias_add(input_tensor, bias_tensor)\r\nwith tf.compat.v1.Session() as sess:\r\n  jacobians = tf.compat.v1.test.compute_gradient(\r\n      [input_tensor, bias_tensor], [input_shape, bias_shape], output_tensor,\r\n      output_shape)\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33658", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33658/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33658/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33658/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33658", "id": 511649978, "node_id": "MDU6SXNzdWU1MTE2NDk5Nzg=", "number": 33658, "title": "Allow Keras ModelCheckpoint to save the best N checkpoints", "user": {"login": "iteal", "id": 28520418, "node_id": "MDQ6VXNlcjI4NTIwNDE4", "avatar_url": "https://avatars3.githubusercontent.com/u/28520418?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iteal", "html_url": "https://github.com/iteal", "followers_url": "https://api.github.com/users/iteal/followers", "following_url": "https://api.github.com/users/iteal/following{/other_user}", "gists_url": "https://api.github.com/users/iteal/gists{/gist_id}", "starred_url": "https://api.github.com/users/iteal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iteal/subscriptions", "organizations_url": "https://api.github.com/users/iteal/orgs", "repos_url": "https://api.github.com/users/iteal/repos", "events_url": "https://api.github.com/users/iteal/events{/privacy}", "received_events_url": "https://api.github.com/users/iteal/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-10-24T01:20:23Z", "updated_at": "2019-11-18T20:03:56Z", "closed_at": null, "author_association": "NONE", "body": "The callback tf.keras.callbacks.ModelCheckpoint allows to save the best checkpoint using save_best_only=True. In the Estimator API we can use tf.estimator.BestExporter that saves the top N checkpoints (parameter exports_to_keep). \r\n\r\nIt seems using the Estimator API is becoming discouraged, for example I need to use compat v1 symbols to use the BestExporter.\r\n\r\nIs it possible to update the Keras ModelCheckpoint class to allow to save the top N models instead of just the best?\r\n\r\n**System information**\r\n- TensorFlow version (you are using): 2.0\r\n- Are you willing to contribute it (Yes/No): No\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\n**Will this change the current api? How?**\r\nYes, the constructor of tf.keras.callbacks.ModelCheckpoint needs a new parameter which is the equivalent of tf.estimator.BestExporter exports_to_keep. We can keep save_best_only but the two parameters can't be used as the same time.\r\n\r\n**Who will benefit with this feature?**\r\nEverybody that wants to save several models. For example for model averaging.\r\n\r\n**Any Other info.**\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33657", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33657/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33657/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33657/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33657", "id": 511632583, "node_id": "MDU6SXNzdWU1MTE2MzI1ODM=", "number": 33657, "title": "TPUStrategy breaks on subclassed keras models", "user": {"login": "kazimuth", "id": 555667, "node_id": "MDQ6VXNlcjU1NTY2Nw==", "avatar_url": "https://avatars3.githubusercontent.com/u/555667?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kazimuth", "html_url": "https://github.com/kazimuth", "followers_url": "https://api.github.com/users/kazimuth/followers", "following_url": "https://api.github.com/users/kazimuth/following{/other_user}", "gists_url": "https://api.github.com/users/kazimuth/gists{/gist_id}", "starred_url": "https://api.github.com/users/kazimuth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kazimuth/subscriptions", "organizations_url": "https://api.github.com/users/kazimuth/orgs", "repos_url": "https://api.github.com/users/kazimuth/repos", "events_url": "https://api.github.com/users/kazimuth/events{/privacy}", "received_events_url": "https://api.github.com/users/kazimuth/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 1097541661, "node_id": "MDU6TGFiZWwxMDk3NTQxNjYx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tpus", "name": "comp:tpus", "color": "0052cc", "default": false, "description": "tpu, tpuestimator"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rxsang", "id": 6399870, "node_id": "MDQ6VXNlcjYzOTk4NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6399870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rxsang", "html_url": "https://github.com/rxsang", "followers_url": "https://api.github.com/users/rxsang/followers", "following_url": "https://api.github.com/users/rxsang/following{/other_user}", "gists_url": "https://api.github.com/users/rxsang/gists{/gist_id}", "starred_url": "https://api.github.com/users/rxsang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rxsang/subscriptions", "organizations_url": "https://api.github.com/users/rxsang/orgs", "repos_url": "https://api.github.com/users/rxsang/repos", "events_url": "https://api.github.com/users/rxsang/events{/privacy}", "received_events_url": "https://api.github.com/users/rxsang/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rxsang", "id": 6399870, "node_id": "MDQ6VXNlcjYzOTk4NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6399870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rxsang", "html_url": "https://github.com/rxsang", "followers_url": "https://api.github.com/users/rxsang/followers", "following_url": "https://api.github.com/users/rxsang/following{/other_user}", "gists_url": "https://api.github.com/users/rxsang/gists{/gist_id}", "starred_url": "https://api.github.com/users/rxsang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rxsang/subscriptions", "organizations_url": "https://api.github.com/users/rxsang/orgs", "repos_url": "https://api.github.com/users/rxsang/repos", "events_url": "https://api.github.com/users/rxsang/events{/privacy}", "received_events_url": "https://api.github.com/users/rxsang/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-10-24T00:06:09Z", "updated_at": "2019-10-28T16:35:44Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Google Colab TPU\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): v2.0.0-rc2-26-g64c3d38 2.0.0\r\n- Python version: 3.7\r\n\r\n**Code to reproduce the issue**\r\n\r\n```python\r\n%tensorflow_version 2.x\r\n\r\n# setup\r\n\r\nimport tensorflow as tf\r\nimport os\r\n\r\ntpu_address = 'grpc://' + os.environ['COLAB_TPU_ADDR']\r\ncluster_resolver = tf.distribute.cluster_resolver.TPUClusterResolver(tpu=tpu_address)\r\ntf.config.experimental_connect_to_cluster(cluster_resolver)\r\ntf.tpu.experimental.initialize_tpu_system(cluster_resolver)\r\nSTRATEGY = tf.compat.v1.distribute.experimental.TPUStrategy(cluster_resolver)\r\n\r\n# define a subclassed keras model\r\nclass Simple(tf.keras.Model):\r\n    def __init__(self, **kwargs):\r\n        super().__init__(**kwargs)\r\n        self.dense = tf.keras.layers.Dense(10)\r\n\r\n    def call(self, x, training=None):\r\n        return self.dense(x, training=training)\r\n\r\n# a fake dataset\r\ndata = tf.data.Dataset.from_tensor_slices((\r\n    tf.random.uniform((10, 10)),\r\n    tf.random.uniform((10, 10))\r\n)).batch(10).repeat()\r\n\r\n# outside the TPUStrategy scope, the model works fine...\r\nmodel = Simple()\r\nmodel.compile(loss='categorical_crossentropy')\r\nmodel.evaluate(data, steps=1)\r\n# ==> 1/1 [==============================] - 0s 62ms/step - loss: 40.6148\r\n\r\n# but if we try and use the model in the scope...\r\nwith STRATEGY.scope():\r\n    model = Simple()\r\n    model.compile(loss='categorical_crossentropy')\r\n\r\nmodel.evaluate(data, steps=1)\r\n\r\n# we get an error:\r\n# \r\n# ValueError                                Traceback (most recent call last)\r\n# \r\n# <ipython-input-17-56ee0b4381e4> in <module>()\r\n#      29     model = Nested(model)\r\n#      30     model.compile(loss='categorical_crossentropy')\r\n# ---> 31 model.evaluate(data, steps=1)\r\n# \r\n# ... 12 frames ...\r\n# \r\n# /tensorflow-2.0.0/python3.6/tensorflow_core/python/framework/func_graph.py in wrapper(*args, **kwargs)\r\n#     903           except Exception as e:  # pylint:disable=broad-except\r\n#     904             if hasattr(e, \"ag_error_metadata\"):\r\n# --> 905               raise e.ag_error_metadata.to_exception(e)\r\n#     906             else:\r\n#     907               raise\r\n# \r\n# ValueError: in converted code:\r\n#     relative to /tensorflow-2.0.0/python3.6/tensorflow_core/python/keras:\r\n# \r\n#     distribute/distributed_training_utils.py:862 distributed_function  *\r\n#         x, y, sample_weights = input_fn()\r\n#     engine/training_arrays.py:516 get_distributed_inputs\r\n#         model, inputs, targets, sample_weights, mode)\r\n#     distribute/distributed_training_utils.py:638 _prepare_feed_values\r\n#         inputs, targets, sample_weights = _get_input_from_iterator(inputs, model)\r\n#     distribute/distributed_training_utils.py:616 _get_input_from_iterator\r\n#         x, y, sample_weights = next_element\r\n# \r\n#     ValueError: not enough values to unpack (expected 3, got 2)\r\n```\r\n\r\n**Expected behavior**\r\n\r\nThis should not throw any error.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33656", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33656/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33656/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33656/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33656", "id": 511629596, "node_id": "MDU6SXNzdWU1MTE2Mjk1OTY=", "number": 33656, "title": "Error: No OpKernel was registered to support Op 'NcclAllReduce'", "user": {"login": "PepeLotudo", "id": 56588515, "node_id": "MDQ6VXNlcjU2NTg4NTE1", "avatar_url": "https://avatars0.githubusercontent.com/u/56588515?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PepeLotudo", "html_url": "https://github.com/PepeLotudo", "followers_url": "https://api.github.com/users/PepeLotudo/followers", "following_url": "https://api.github.com/users/PepeLotudo/following{/other_user}", "gists_url": "https://api.github.com/users/PepeLotudo/gists{/gist_id}", "starred_url": "https://api.github.com/users/PepeLotudo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PepeLotudo/subscriptions", "organizations_url": "https://api.github.com/users/PepeLotudo/orgs", "repos_url": "https://api.github.com/users/PepeLotudo/repos", "events_url": "https://api.github.com/users/PepeLotudo/events{/privacy}", "received_events_url": "https://api.github.com/users/PepeLotudo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-10-23T23:54:20Z", "updated_at": "2019-12-26T18:24:15Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Custom code/ but copy from the stock example (nothing out of the ordinary)\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Win10 1903\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:\r\n- **TensorFlow installed from (source or binary)**: binary\r\n- **TensorFlow version (use command below)**: 2.0.0\r\n- **Python version**: 3.7\r\n- **Bazel version (if compiling from source)**: N/A\r\n- **GCC/Compiler version (if compiling from source)**: N/A\r\n- **CUDA/cuDNN version**: 10.0/7.6\r\n- **GPU model and memory**: 4x GTX780ti 3GB each\r\n- **Exact command to reproduce**: model_distributed.fit(X_train, y_train, epochs=4, batch_size=25)\r\n\r\n### Describe the problem\r\nDescribe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request. 4x GPUs are recognised. but failed to train. The train on the CPU works well, but then when moving to do it with the distributed strategy shows the error below. I've uninstalled and re-installed \"pip install tensorflow-gpu\" twice. Updated drivers. nothing seems to help. Code below. Any help will be highly appreciated. Thanks.\r\n\r\nimport time\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\nprint(tf.__version__)\r\n\r\n(X_train, y_train), (X_test, y_test) = tf.keras.datasets.mnist.load_data()\r\n\r\nX_train = X_train / 255.\r\nX_test = X_test / 255.\r\n\r\nX_train = X_train.reshape(-1, 28*28)\r\nX_test = X_test.reshape(-1, 28*28)\r\n\r\nmodel_normal = tf.keras.models.Sequential()\r\nmodel_normal.add(tf.keras.layers.Dense(units=128, activation='relu', input_shape=(784,)))\r\nmodel_normal.add(tf.keras.layers.Dropout(rate=0.2))\r\nmodel_normal.add(tf.keras.layers.Dense(units=10, activation='softmax'))\r\nmodel_normal.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['sparse_categorical_accuracy'])\r\n\r\nstrategy = tf.distribute.MirroredStrategy()\r\nprint('Number of devices: {}'.format(strategy.num_replicas_in_sync))\r\n\r\n\r\nwith strategy.scope():\r\n  model_distributed = tf.keras.Sequential([\r\n      tf.keras.layers.Dense(units=128, activation='relu', input_shape=(784,)),\r\n      tf.keras.layers.Dropout(rate=0.2),\r\n      tf.keras.layers.Dense(units=10, activation='softmax'),\r\n      ])\r\n  model_distributed.compile(loss='sparse_categorical_crossentropy',\r\n                optimizer=tf.keras.optimizers.Adam(),\r\n                metrics=['accuracy'])\r\n\r\nstart_time = time.time()\r\nmodel_normal.fit(X_train, y_train, epochs=4, batch_size=25)\r\nprint(\"Normal training took: {}\".format(time.time() - start_time))\r\n\r\nstart_time = time.time()\r\nmodel_distributed.fit(X_train, y_train, epochs=4, batch_size=25)\r\nprint(\"Distributed training took: {}\".format(time.time() - start_time))\r\n\r\n\r\n### Source code / logs\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n2019-10-24 07:50:25.464075: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll\r\n2.0.0\r\n2019-10-24 07:50:29.987980: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library nvcuda.dll\r\n2019-10-24 07:50:30.090327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties:\r\nname: GeForce GTX 780 Ti major: 3 minor: 5 memoryClockRate(GHz): 1.15\r\npciBusID: 0000:01:00.0\r\n2019-10-24 07:50:30.097223: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 1 with properties:\r\nname: GeForce GTX 780 Ti major: 3 minor: 5 memoryClockRate(GHz): 1.0455\r\npciBusID: 0000:02:00.0\r\n2019-10-24 07:50:30.104573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 2 with properties:\r\nname: GeForce GTX 780 Ti major: 3 minor: 5 memoryClockRate(GHz): 1.0845\r\npciBusID: 0000:03:00.0\r\n2019-10-24 07:50:30.111754: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 3 with properties:\r\nname: GeForce GTX 780 Ti major: 3 minor: 5 memoryClockRate(GHz): 1.15\r\npciBusID: 0000:04:00.0\r\n2019-10-24 07:50:30.118501: I tensorflow/stream_executor/platform/default/dlopen_checker_stub.cc:25] GPU libraries are statically linked, skip dlopen check.\r\n2019-10-24 07:50:30.126709: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0, 1, 2, 3\r\n2019-10-24 07:50:30.131151: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2\r\n2019-10-24 07:50:30.809583: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties:\r\nname: GeForce GTX 780 Ti major: 3 minor: 5 memoryClockRate(GHz): 1.15\r\npciBusID: 0000:01:00.0\r\n2019-10-24 07:50:30.816475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 1 with properties:\r\nname: GeForce GTX 780 Ti major: 3 minor: 5 memoryClockRate(GHz): 1.0455\r\npciBusID: 0000:02:00.0\r\n2019-10-24 07:50:30.823594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 2 with properties:\r\nname: GeForce GTX 780 Ti major: 3 minor: 5 memoryClockRate(GHz): 1.0845\r\npciBusID: 0000:03:00.0\r\n2019-10-24 07:50:30.831552: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 3 with properties:\r\nname: GeForce GTX 780 Ti major: 3 minor: 5 memoryClockRate(GHz): 1.15\r\npciBusID: 0000:04:00.0\r\n2019-10-24 07:50:30.839507: I tensorflow/stream_executor/platform/default/dlopen_checker_stub.cc:25] GPU libraries are statically linked, skip dlopen check.\r\n2019-10-24 07:50:30.848211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0, 1, 2, 3\r\n2019-10-24 07:50:32.420376: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2019-10-24 07:50:32.465449: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 1 2 3\r\n2019-10-24 07:50:32.491610: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N N N N\r\n2019-10-24 07:50:32.494431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 1:   N N N N\r\n2019-10-24 07:50:32.506160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 2:   N N N N\r\n2019-10-24 07:50:32.544545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 3:   N N N N\r\n2019-10-24 07:50:32.572199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2154 MB memory) -> physical GPU (device: 0, name: GeForce GTX 780 Ti, pci bus id: 0000:01:00.0, compute capability: 3.5)\r\n2019-10-24 07:50:32.614321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 2154 MB memory) -> physical GPU (device: 1, name: GeForce GTX 780 Ti, pci bus id: 0000:02:00.0, compute capability: 3.5)\r\n2019-10-24 07:50:32.670375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 2154 MB memory) -> physical GPU (device: 2, name: GeForce GTX 780 Ti, pci bus id: 0000:03:00.0, compute capability: 3.5)\r\n2019-10-24 07:50:32.725417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 2154 MB memory) -> physical GPU (device: 3, name: GeForce GTX 780 Ti, pci bus id: 0000:04:00.0, compute capability: 3.5)\r\n2019-10-24 07:50:33.211267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties:\r\nname: GeForce GTX 780 Ti major: 3 minor: 5 memoryClockRate(GHz): 1.15\r\npciBusID: 0000:01:00.0\r\n2019-10-24 07:50:33.310413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 1 with properties:\r\nname: GeForce GTX 780 Ti major: 3 minor: 5 memoryClockRate(GHz): 1.0455\r\npciBusID: 0000:02:00.0\r\n2019-10-24 07:50:33.383430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 2 with properties:\r\nname: GeForce GTX 780 Ti major: 3 minor: 5 memoryClockRate(GHz): 1.0845\r\npciBusID: 0000:03:00.0\r\n2019-10-24 07:50:33.423598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 3 with properties:\r\nname: GeForce GTX 780 Ti major: 3 minor: 5 memoryClockRate(GHz): 1.15\r\npciBusID: 0000:04:00.0\r\n2019-10-24 07:50:33.446267: I tensorflow/stream_executor/platform/default/dlopen_checker_stub.cc:25] GPU libraries are statically linked, skip dlopen check.\r\n2019-10-24 07:50:33.463455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0, 1, 2, 3\r\n2019-10-24 07:50:33.467760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2019-10-24 07:50:33.472212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 1 2 3\r\n2019-10-24 07:50:33.475053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N N N N\r\n2019-10-24 07:50:33.478236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 1:   N N N N\r\n2019-10-24 07:50:33.481176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 2:   N N N N\r\n2019-10-24 07:50:33.486383: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 3:   N N N N\r\n2019-10-24 07:50:33.492208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/device:GPU:0 with 2154 MB memory) -> physical GPU (device: 0, name: GeForce GTX 780 Ti, pci bus id: 0000:01:00.0, compute capability: 3.5)\r\n2019-10-24 07:50:33.501615: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/device:GPU:1 with 2154 MB memory) -> physical GPU (device: 1, name: GeForce GTX 780 Ti, pci bus id: 0000:02:00.0, compute capability: 3.5)\r\n2019-10-24 07:50:33.510891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/device:GPU:2 with 2154 MB memory) -> physical GPU (device: 2, name: GeForce GTX 780 Ti, pci bus id: 0000:03:00.0, compute capability: 3.5)\r\n2019-10-24 07:50:33.520186: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/device:GPU:3 with 2154 MB memory) -> physical GPU (device: 3, name: GeForce GTX 780 Ti, pci bus id: 0000:04:00.0, compute capability: 3.5)\r\nNumber of devices: 4\r\nTrain on 60000 samples\r\nEpoch 1/4\r\n2019-10-24 07:50:35.783397: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cublas64_100.dll\r\n2019-10-24 07:50:35.958561: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n2019-10-24 07:50:35.963318: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n2019-10-24 07:50:35.967782: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n2019-10-24 07:50:35.974357: E tensorflow/stream_executor/cuda/cuda_blas.cc:238] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED\r\n60000/60000 [==============================] - 10s 165us/sample - loss: 0.2815 - sparse_categorical_accuracy: 0.9183\r\nEpoch 2/4\r\n60000/60000 [==============================] - 8s 132us/sample - loss: 0.1353 - sparse_categorical_accuracy: 0.9603\r\nEpoch 3/4\r\n60000/60000 [==============================] - 8s 133us/sample - loss: 0.1052 - sparse_categorical_accuracy: 0.9674\r\nEpoch 4/4\r\n60000/60000 [==============================] - 8s 131us/sample - loss: 0.0841 - sparse_categorical_accuracy: 0.9741\r\nNormal training took: 33.73987317085266\r\nTrain on 60000 samples\r\nEpoch 1/4\r\n   25/60000 [..............................] - ETA: 3:18:14Traceback (most recent call last):\r\n  File \"c:\\program files (x86)\\microsoft visual studio\\2019\\community\\common7\\ide\\extensions\\microsoft\\python\\core\\ptvsd_launcher.py\", line 119, in <module>\r\n    vspd.debug(filename, port_num, debug_id, debug_options, run_as)\r\n  File \"c:\\program files (x86)\\microsoft visual studio\\2019\\community\\common7\\ide\\extensions\\microsoft\\python\\core\\Packages\\ptvsd\\debugger.py\", line 39, in debug\r\n    run()\r\n  File \"c:\\program files (x86)\\microsoft visual studio\\2019\\community\\common7\\ide\\extensions\\microsoft\\python\\core\\Packages\\ptvsd\\__main__.py\", line 316, in run_file\r\n    runpy.run_path(target, run_name='__main__')\r\n  File \"C:\\Program Files (x86)\\Microsoft Visual Studio\\Shared\\Python37_64\\lib\\runpy.py\", line 263, in run_path\r\n    pkg_name=pkg_name, script_name=fname)\r\n  File \"C:\\Program Files (x86)\\Microsoft Visual Studio\\Shared\\Python37_64\\lib\\runpy.py\", line 96, in _run_module_code\r\n    mod_name, mod_spec, pkg_name, script_name)\r\n  File \"C:\\Program Files (x86)\\Microsoft Visual Studio\\Shared\\Python37_64\\lib\\runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"C:\\Users\\Javier\\Desktop\\Personal files\\VS\\TensorFlow 2.0 Complete guide\\distributed training.py\", line 53, in <module>\r\n    model_distributed.fit(X_train, y_train, epochs=4, batch_size=25)\r\n  File \"C:\\Program Files (x86)\\Microsoft Visual Studio\\Shared\\Python37_64\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\training.py\", line 728, in fit\r\n    use_multiprocessing=use_multiprocessing)\r\n  File \"C:\\Program Files (x86)\\Microsoft Visual Studio\\Shared\\Python37_64\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\training_v2.py\", line 324, in fit\r\n    total_epochs=epochs)\r\n  File \"C:\\Program Files (x86)\\Microsoft Visual Studio\\Shared\\Python37_64\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\training_v2.py\", line 123, in run_one_epoch\r\n    batch_outs = execution_function(iterator)\r\n  File \"C:\\Program Files (x86)\\Microsoft Visual Studio\\Shared\\Python37_64\\lib\\site-packages\\tensorflow_core\\python\\keras\\engine\\training_v2_utils.py\", line 86, in execution_function\r\n    distributed_function(input_fn))\r\n  File \"C:\\Program Files (x86)\\Microsoft Visual Studio\\Shared\\Python37_64\\lib\\site-packages\\tensorflow_core\\python\\eager\\def_function.py\", line 457, in __call__\r\n    result = self._call(*args, **kwds)\r\n  File \"C:\\Program Files (x86)\\Microsoft Visual Studio\\Shared\\Python37_64\\lib\\site-packages\\tensorflow_core\\python\\eager\\def_function.py\", line 520, in _call\r\n    return self._stateless_fn(*args, **kwds)\r\n  File \"C:\\Program Files (x86)\\Microsoft Visual Studio\\Shared\\Python37_64\\lib\\site-packages\\tensorflow_core\\python\\eager\\function.py\", line 1823, in __call__\r\n    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access\r\n  File \"C:\\Program Files (x86)\\Microsoft Visual Studio\\Shared\\Python37_64\\lib\\site-packages\\tensorflow_core\\python\\eager\\function.py\", line 1141, in _filtered_call\r\n    self.captured_inputs)\r\n  File \"C:\\Program Files (x86)\\Microsoft Visual Studio\\Shared\\Python37_64\\lib\\site-packages\\tensorflow_core\\python\\eager\\function.py\", line 1224, in _call_flat\r\n    ctx, args, cancellation_manager=cancellation_manager)\r\n  File \"C:\\Program Files (x86)\\Microsoft Visual Studio\\Shared\\Python37_64\\lib\\site-packages\\tensorflow_core\\python\\eager\\function.py\", line 511, in call\r\n    ctx=ctx)\r\n  File \"C:\\Program Files (x86)\\Microsoft Visual Studio\\Shared\\Python37_64\\lib\\site-packages\\tensorflow_core\\python\\eager\\execute.py\", line 67, in quick_execute\r\n    six.raise_from(core._status_to_exception(e.code, message), None)\r\n  File \"<string>\", line 3, in raise_from\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: No OpKernel was registered to support Op 'NcclAllReduce' used by {{node Adam/NcclAllReduce}}with these attrs: [reduction=\"sum\", shared_name=\"c1\", T=DT_FLOAT, num_devices=4]\r\nRegistered devices: [CPU, GPU]\r\nRegistered kernels:\r\n  <no registered kernels>\r\n\r\n         [[Adam/NcclAllReduce]] [Op:__inference_distributed_function_33245]\r\nPress any key to continue . . .\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33649", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33649/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33649/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33649/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33649", "id": 511565594, "node_id": "MDU6SXNzdWU1MTE1NjU1OTQ=", "number": 33649, "title": "Simple custom metric caused tf.function retracing when training on multiple GPUs", "user": {"login": "netw0rkf10w", "id": 8569515, "node_id": "MDQ6VXNlcjg1Njk1MTU=", "avatar_url": "https://avatars1.githubusercontent.com/u/8569515?v=4", "gravatar_id": "", "url": "https://api.github.com/users/netw0rkf10w", "html_url": "https://github.com/netw0rkf10w", "followers_url": "https://api.github.com/users/netw0rkf10w/followers", "following_url": "https://api.github.com/users/netw0rkf10w/following{/other_user}", "gists_url": "https://api.github.com/users/netw0rkf10w/gists{/gist_id}", "starred_url": "https://api.github.com/users/netw0rkf10w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/netw0rkf10w/subscriptions", "organizations_url": "https://api.github.com/users/netw0rkf10w/orgs", "repos_url": "https://api.github.com/users/netw0rkf10w/repos", "events_url": "https://api.github.com/users/netw0rkf10w/events{/privacy}", "received_events_url": "https://api.github.com/users/netw0rkf10w/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-10-23T20:53:13Z", "updated_at": "2020-03-09T06:43:29Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): `v2.0.0-rc2-26-g64c3d38 2.0.0`\r\n- Python version: `3.5.2`\r\n- CUDA/cuDNN version: `9.2`\r\n- GPU model and memory: GTX 1080 Ti\r\n\r\n**Describe the current behavior**\r\n\r\nUsing the following custom metric (event without the commented part):\r\n\r\n```\r\nimport tensorflow as tf\r\n\r\nclass MeanIoUIgnoreLabel(tf.keras.metrics.MeanIoU):\r\n    \"\"\"Mean Intersection-over-Union with an ignored label\r\n    \"\"\"\r\n    def __init__(self, num_classes, ignore_label=None, name='mIoU_ignore_label', **kwargs):\r\n      super(MeanIoUIgnoreLabel, self).__init__(num_classes, name=name, **kwargs)\r\n      self.ignore_label = ignore_label\r\n\r\n    def update_state(self, y_true, y_pred, sample_weight=None):\r\n        y_pred = tf.argmax(y_pred, axis=-1)\r\n        # if self.ignore_label is not None:\r\n        #     if sample_weight is not None:\r\n        #         # sample_weight = tf.where(y_true == self.ignore_label, 0, sample_weight)\r\n        #         sample_weight = tf.where(tf.math.equal(y_true, self.ignore_label), 0, sample_weight)\r\n        #     else:\r\n        #         # sample_weight = y_true != self.ignore_label\r\n        #         sample_weight = tf.math.not_equal(y_true, self.ignore_label)\r\n        return super(MeanIoUIgnoreLabel, self).update_state(y_true, y_pred, sample_weight)   \r\n```\r\n\r\nI obtained the following warning:\r\n\r\n> 2019-10-23 22:27:58.600906: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7\r\n> WARNING:tensorflow:5 out of the last 9 calls to <bound method MeanIoUIgnoreLabel.update_state of <metrics.MeanIoUIgnoreLabel object at 0x7fc0ac1f86a0>> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings is likely due to passing python objects instead of tensors. Also, tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. Please refer to https://www.tensorflow.org/beta/tutorials/eager/tf_function#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for more details.\r\n\r\nI am using `tf.distribute.MirroredStrategy()` to train on multiple GPUs.\r\n\r\nI guess this is a bug?\r\n\r\nThanks.\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33645", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33645/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33645/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33645/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33645", "id": 511442136, "node_id": "MDU6SXNzdWU1MTE0NDIxMzY=", "number": 33645, "title": "Allow device groups / CPU in MirroredStrategy", "user": {"login": "olesalscheider", "id": 1006058, "node_id": "MDQ6VXNlcjEwMDYwNTg=", "avatar_url": "https://avatars2.githubusercontent.com/u/1006058?v=4", "gravatar_id": "", "url": "https://api.github.com/users/olesalscheider", "html_url": "https://github.com/olesalscheider", "followers_url": "https://api.github.com/users/olesalscheider/followers", "following_url": "https://api.github.com/users/olesalscheider/following{/other_user}", "gists_url": "https://api.github.com/users/olesalscheider/gists{/gist_id}", "starred_url": "https://api.github.com/users/olesalscheider/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/olesalscheider/subscriptions", "organizations_url": "https://api.github.com/users/olesalscheider/orgs", "repos_url": "https://api.github.com/users/olesalscheider/repos", "events_url": "https://api.github.com/users/olesalscheider/events{/privacy}", "received_events_url": "https://api.github.com/users/olesalscheider/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-10-23T16:34:37Z", "updated_at": "2019-11-21T00:13:56Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- TensorFlow version (you are using): 2.0\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\nMy neural network is too large to be trained on a single GPU. In this specific case I have one layer that needs a lot of memory but does not perform expensive computations.\r\nI can train the network if I place this layer on the CPU (so that it uses main memory) or on another GPU.\r\n\r\nBut I still would like to use MirroredStrategy to distribute the training across multiple GPUs.\r\nCurrently this combination is not possible.\r\n\r\nTherefore I would like to request a feature to place parts of the computations inside a cross-replica context on the CPU. In a more generic case MirroredStrategy could distribute computations across device groups (instead of devices) and allow the user to place operations on different devices inside the group.\r\n\r\nThis could look like follows:\r\n```\r\nstrategy = tf.distribute.MirroredStrategy()\r\nwith strategy.scope():\r\n        x = f1()\r\n    with tf.device('/cpu:0'):\r\n        y = f2(x)\r\n```\r\n\r\nOr like this in the general case:\r\n```\r\nstrategy = tf.distribute.MirroredStrategy(devices=[['/gpu:0', '/gpu:1'], ['/gpu:3', '/gpu:4']])\r\nwith strategy.scope():\r\n    with tf.device('/vgpu:0'):\r\n        x = f1()\r\n    with tf.device('/vgpu:1'):\r\n        y = f2(x)\r\n```\r\n\r\n**Will this change the current api? How?**\r\nThe general case (device groups) needs a way to specify which devices are inside which group. See above for an example.\r\n\r\n**Who will benefit with this feature?**\r\nEveryone who wants to train larger models that do not fit into the VRAM of a single GPU but who still wants to use MirroredStrategy."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33640", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33640/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33640/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33640/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33640", "id": 511264667, "node_id": "MDU6SXNzdWU1MTEyNjQ2Njc=", "number": 33640, "title": "Feature_column  to surport  weighted_categorical_column  in sequence;  and   sequence or normal categorical_column in shared_embeddings.", "user": {"login": "dulm", "id": 1228446, "node_id": "MDQ6VXNlcjEyMjg0NDY=", "avatar_url": "https://avatars0.githubusercontent.com/u/1228446?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dulm", "html_url": "https://github.com/dulm", "followers_url": "https://api.github.com/users/dulm/followers", "following_url": "https://api.github.com/users/dulm/following{/other_user}", "gists_url": "https://api.github.com/users/dulm/gists{/gist_id}", "starred_url": "https://api.github.com/users/dulm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dulm/subscriptions", "organizations_url": "https://api.github.com/users/dulm/orgs", "repos_url": "https://api.github.com/users/dulm/repos", "events_url": "https://api.github.com/users/dulm/events{/privacy}", "received_events_url": "https://api.github.com/users/dulm/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-10-23T11:37:27Z", "updated_at": "2019-10-25T03:53:19Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): 2.0\r\n- Are you willing to contribute it (Yes/No): No\r\n\r\n**Describe the feature and the current behavior/state.**\r\nfor example:\r\n\r\nweighted_categorical_column  in sequence:\r\n\r\n```python\r\nimport tensorflow as tf\r\nfrom tensorflow.python.feature_column.feature_column_v2 import SequenceCategoricalColumn\r\n\r\nbatch_tensor_dict = {'dog': [[-1,-1],[1,1],[2,-1],[0,1]],\r\n                     'dog_weight': [[0.0,0.0],[1.0,2.0],[3.0,0.0],[4.0,5.0]]\r\n                     }\r\n\r\nfc_cat_dog = tf.feature_column.categorical_column_with_identity(key='dog',num_buckets=3)\r\nfc_wei_dog = tf.feature_column.weighted_categorical_column(fc_cat_dog, 'dog_weight')\r\n\r\nseq_dog = SequenceCategoricalColumn(fc_wei_dog)\r\nseq_dog2 = tf.feature_column.sequence_categorical_column_with_identity('dog', 3)\r\n\r\nind_dog = tf.feature_column.indicator_column(seq_dog)\r\ninput_layer = tf.keras.experimental.SequenceFeatures([ind_dog])\r\nseq_input, seq_len = input_layer(batch_tensor_dict)\r\nseq_len_mask = tf.sequence_mask(seq_len)\r\n\r\nprint(seq_input)\r\npass\r\n```\r\n\r\n\r\nsequence or normal categorical_column in shared_embeddings: \r\n```python\r\nimport tensorflow as tf\r\nimport tensorflow.feature_column as fc\r\n\r\n\r\nbatch_tensor_dict = {'item_id': [-1,1,2,0],\r\n                     'history_item_id_list': [[-1,-1],[1,1],[2,-1],[0,1]]\r\n                     }\r\n\r\nfc_cat_item_id = fc.categorical_column_with_identity('item_id', 3)\r\nfc_seq_cat_history_item_id_list = fc.sequence_categorical_column_with_identity('history_item_id_list', 3)\r\n\r\nfc_shared_emb_cols = fc.shared_embeddings(categorical_columns=[fc_cat_item_id, fc_seq_cat_history_item_id_list])\r\n```\r\ntf.keras.experimental.SequenceFeatures and tf.keras.layers.DenseFeatures  both are not suitable for fc_shared_emb_cols.\r\n\r\n\r\n\r\n**Will this change the current api? How?**\r\n\r\n**Who will benefit with this feature?**\r\n\r\n**Any Other info.**\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33636", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33636/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33636/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33636/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33636", "id": 511242313, "node_id": "MDU6SXNzdWU1MTEyNDIzMTM=", "number": 33636, "title": "MultiLabel Metric Support", "user": {"login": "SumNeuron", "id": 22868585, "node_id": "MDQ6VXNlcjIyODY4NTg1", "avatar_url": "https://avatars3.githubusercontent.com/u/22868585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SumNeuron", "html_url": "https://github.com/SumNeuron", "followers_url": "https://api.github.com/users/SumNeuron/followers", "following_url": "https://api.github.com/users/SumNeuron/following{/other_user}", "gists_url": "https://api.github.com/users/SumNeuron/gists{/gist_id}", "starred_url": "https://api.github.com/users/SumNeuron/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SumNeuron/subscriptions", "organizations_url": "https://api.github.com/users/SumNeuron/orgs", "repos_url": "https://api.github.com/users/SumNeuron/repos", "events_url": "https://api.github.com/users/SumNeuron/events{/privacy}", "received_events_url": "https://api.github.com/users/SumNeuron/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-10-23T10:52:03Z", "updated_at": "2020-01-29T14:52:16Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): 1.15+ \r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\n# Issue\r\nIn my comments on [issue](https://github.com/tensorflow/tensorflow/issues/28074) #28074 I outline that although it was suggested multi-label metric support exists, it does not. The reasons stands as\r\n\r\n1. The utility function `update_confusion_matrix_variables` is called without a user-exposed option resulting in the default argument `multi_label=False` to be used.\r\n\r\n2. `tf.keras.metrics.Metric` generally take in `y_pred` and `y_true`. Multi-label classification might use a loss like `tf.nn.sigmoid_cross_entropy_with_logits(labels=labels, logits=logits)`, which applies a sigmoid during the loss calculation. This suggests that the user should not have the output (logits) of their model undergo a sigmoid transformation, as the loss would then be calculated using `sigmoid(sigmoid(...))`.  While a putative solution to is to make a multi-tailed model (one with and one without the sigmoid transformation), a collective guide on these more nuanced use cases does not exist.\r\n\r\npseudo-code of the solution\r\n\r\n```python\r\n\r\ninputs = ...\r\ny = tf.keras.layer.SomeLayer(...)(inputs)\r\ny = tf.keras.layer.SomeLayer(...)(y)\r\noutput = tf.sigmoid(y)\r\n\r\n\r\nmodel = tf.keras.Model(inputs=inputs, outputs={\r\n    'logits': output,\r\n    'raw_out_for_loss': y\r\n})\r\n\r\nmodel.compile(\r\n    ...\r\n    metrics={\r\n        'logits': [MultiLabelMetric(...), ...], \r\n        'raw_out_for_loss': [],\r\n    }\r\n```\r\n\r\nThis issue does not arise in the [image segmentation guide](https://www.tensorflow.org/tutorials/images/segmentation#define_the_model) as the labels are no independent, so `sparse_categorical_crossentropy` loss is used. As reflected in the corresponding [`tf.keras.losses.SparseCategoricalCrossentropy` documentation](https://www.tensorflow.org/api_docs/python/tf/keras/losses/SparseCategoricalCrossentropy), while multiple labels exists, the input is expect to confirm to a single label.\r\n\r\nMini-rant aside, even if a user does use a multi-tail model to address this, it does not get around that the current `tf.keras.metrics` do not expose the `multi_label` option, despite it existing in the underlying utility code.\r\n\r\n# Feature\r\n\r\nAt bare minimum expose `multi_label` option to relevant metrics (e.g. `Precision`). \r\n\r\nIt would also be nice if a transformation could be applied to the automatically feed in `y_pred` (e.g. sigmoid transformation), so that a multi-tailed model is not required. This might be done with an optional `transformation` argument which will accept a label.\r\n\r\n## other option\r\nmove multilabel metrics to separate classes, e.g. \r\n\r\n```python\r\nclass MultiLabelMacroSpecificity(tf.keras.metrics.Metric):\r\n    \r\n    def __init__(self, name='multi_label_macro_specificity', threshold=0.5, **kwargs):        \r\n        super(MultiLabelMacroSpecificity, self).__init__(name=name, **kwargs)\r\n        self.specificity = self.add_weight(name='mlm_spec', initializer='zeros')        \r\n        self.threshold       = tf.constant(threshold)\r\n\r\n        # replace this with tf confusion_matrix utils\r\n        self.true_negatives  = self.add_weight(name='tn', initializer='zeros')\r\n        self.false_positives = self.add_weight(name='fp', initializer='zeros')\r\n    \r\n    def update_state(self, y_true, y_pred):\r\n        \r\n        # Compare predictions and threshold.        \r\n        pred_is_pos  = tf.greater(tf.cast(y_pred, tf.float32), self.threshold)            \r\n        pred_is_neg  = tf.logical_not(tf.cast(pred_is_pos, tf.bool))\r\n        # |-- in case of soft labeling        \r\n        label_is_pos = tf.greater(tf.cast(y_true, tf.float32), self.threshold)                \r\n        label_is_neg = tf.logical_not(tf.cast(label_is_pos, tf.bool))\r\n        \r\n        self.true_negatives.assign_add(tf.reduce_sum(tf.cast(tf.logical_and(pred_is_neg, label_is_neg), tf.float32)))\r\n        self.false_positives.assign_add(\r\n            tf.reduce_sum(tf.cast(tf.logical_and(pred_is_pos, label_is_neg), tf.float32))\r\n        )\r\n        \r\n        tn = self.true_negatives\r\n        fp = self.false_positives\r\n        specificity = tf.div_no_nan(tn, tf.add(tn, fp))\r\n        self.specificity.assign(specificity)\r\n        return specificity\r\n    \r\n    def result(self):\r\n        return self.specificity        \r\n\r\n```\r\n\r\n\r\n**Will this change the current api? How?**\r\nYes, but barely.  Expose at least `multi_label` on relevant metrics and maybe add / expose a `transformation` argument.\r\n\r\n\r\n\r\n**Who will benefit with this feature?**\r\nIf bare minimum is done, those requiring multi-label metrics but do not which to write their own function / subclass `tf.keras.metric.Metric`.\r\n\r\nIf `transformation` is also added to all metrics, then anyone using tf metrics could make existing metrics work with minimum overhead instead of redesigning their model to meet metric requirements.\r\n\r\n**Any Other info.**\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33634", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33634/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33634/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33634/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33634", "id": 511225433, "node_id": "MDU6SXNzdWU1MTEyMjU0MzM=", "number": 33634, "title": "Tensorflow lite dll build failed on Windows", "user": {"login": "twkx", "id": 301869, "node_id": "MDQ6VXNlcjMwMTg2OQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/301869?v=4", "gravatar_id": "", "url": "https://api.github.com/users/twkx", "html_url": "https://github.com/twkx", "followers_url": "https://api.github.com/users/twkx/followers", "following_url": "https://api.github.com/users/twkx/following{/other_user}", "gists_url": "https://api.github.com/users/twkx/gists{/gist_id}", "starred_url": "https://api.github.com/users/twkx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/twkx/subscriptions", "organizations_url": "https://api.github.com/users/twkx/orgs", "repos_url": "https://api.github.com/users/twkx/repos", "events_url": "https://api.github.com/users/twkx/events{/privacy}", "received_events_url": "https://api.github.com/users/twkx/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 24, "created_at": "2019-10-23T10:20:35Z", "updated_at": "2020-03-10T13:59:47Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10 Home\r\n- TensorFlow installed from (source or binary): source (master)\r\n- TensorFlow version: 2.0 (master)\r\n- Python version: 3.8.0\r\n- Installed using virtualenv? pip? conda?: VirtualBoxVM\r\n- Bazel version (if compiling from source): 0.26.1\r\n- GCC/Compiler version (if compiling from source): Visual Studio Build Tools 201\r\n\r\n**Describe the problem**\r\n\r\nI have a code base successfully running on Linux/MacOS/Android & iOS.\r\n\r\nNow I need to run tflite model inference under Windows system.\r\nFor this, I need to compile a tensorflowlite dll for Windows (I've not found any precompiled version)\r\n\r\nUnfortunately, the build fails at the link step... (see logs below).\r\n\r\nApparently, even if the build fails, a libtensorflowlite.so file is stil generated (and is indeed a dll), but it contains no exported symbols, so I cannot use it.\r\nAfter checking at the tensorflow/lite/BUILD file it appears that no .def file is generated for the tflite Windows link step, as it is done for tensorflow.dll (seen in tensorflow/BUILD), which explains why no symbols are exported.\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n\r\nIn Windows command prompt (Run as Administrator):\r\n\r\npython configure.py\r\nbazel build -s tensorflow/lite:libtensorflowlite.so\r\n\r\n**Any other info / logs**\r\n\r\nC:\\Users\\soule\\Downloads\\tensorflow> bazel build -s tensorflow/lite:libtensorflowlite.so\r\n[...]\r\n  C:/Program Files (x86)/Microsoft Visual Studio/2019/BuildTools/VC/Tools/MSVC/14.23.28105/bin/HostX64/x64/link.exe /nologo /DLL /SUBSYSTEM:CONSOLE -s -ignore:4221 -ignore:4221 -ignore:4221 -ignore:4221 /MACHINE:X64 @bazel-out/x64_windows-opt/bin/tensorflow/lite/libtensorflowlite.so-2.params /OPT:ICF /OPT:REF\r\nINFO: From Linking tensorflow/lite/libtensorflowlite.so:\r\nLINK : warning LNK4044: unrecognized option '/s'; ignored\r\nERROR: C:/users/soule/downloads/tensorflow/tensorflow/lite/BUILD:442:1: output 'tensorflow/lite/libtensorflowlite.so.if.lib' was not created\r\nERROR: C:/users/soule/downloads/tensorflow/tensorflow/lite/BUILD:442:1: not all outputs were created or valid\r\nTarget //tensorflow/lite:libtensorflowlite.so failed to build\r\nINFO: Elapsed time: 920.482s, Critical Path: 84.10s\r\nINFO: 235 processes: 235 local.\r\nFAILED: Build did NOT complete successfully\r\n\r\nC:\\Users\\soule\\Downloads\\tensorflow> dumpbin /exports bazel-out\\x64_windows-opt\\bin\\tensorflow\\lite\\libtensorflowlite.so\r\nMicrosoft (R) COFF/PE Dumper Version 14.23.28106.4\r\nCopyright (C) Microsoft Corporation.  All rights reserved.\r\n\r\n\r\nDump of file bazel-out\\x64_windows-opt\\bin\\tensorflow\\lite\\libtensorflowlite.so\r\n\r\nFile Type: DLL\r\n\r\n  Summary\r\n\r\n        1000 .data\r\n        1000 .pdata\r\n        1000 .rdata\r\n        1000 .reloc\r\n        2000 .text\r\n        1000 _RDATA\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33627", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33627/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33627/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33627/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33627", "id": 511104720, "node_id": "MDU6SXNzdWU1MTExMDQ3MjA=", "number": 33627, "title": "TF 1.14 Python CPU single thread configuration", "user": {"login": "deHsien", "id": 32103017, "node_id": "MDQ6VXNlcjMyMTAzMDE3", "avatar_url": "https://avatars1.githubusercontent.com/u/32103017?v=4", "gravatar_id": "", "url": "https://api.github.com/users/deHsien", "html_url": "https://github.com/deHsien", "followers_url": "https://api.github.com/users/deHsien/followers", "following_url": "https://api.github.com/users/deHsien/following{/other_user}", "gists_url": "https://api.github.com/users/deHsien/gists{/gist_id}", "starred_url": "https://api.github.com/users/deHsien/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/deHsien/subscriptions", "organizations_url": "https://api.github.com/users/deHsien/orgs", "repos_url": "https://api.github.com/users/deHsien/repos", "events_url": "https://api.github.com/users/deHsien/events{/privacy}", "received_events_url": "https://api.github.com/users/deHsien/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1104829434, "node_id": "MDU6TGFiZWwxMTA0ODI5NDM0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:mkl", "name": "comp:mkl", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "TensorFlow-MKL", "id": 44416303, "node_id": "MDQ6VXNlcjQ0NDE2MzAz", "avatar_url": "https://avatars2.githubusercontent.com/u/44416303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TensorFlow-MKL", "html_url": "https://github.com/TensorFlow-MKL", "followers_url": "https://api.github.com/users/TensorFlow-MKL/followers", "following_url": "https://api.github.com/users/TensorFlow-MKL/following{/other_user}", "gists_url": "https://api.github.com/users/TensorFlow-MKL/gists{/gist_id}", "starred_url": "https://api.github.com/users/TensorFlow-MKL/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TensorFlow-MKL/subscriptions", "organizations_url": "https://api.github.com/users/TensorFlow-MKL/orgs", "repos_url": "https://api.github.com/users/TensorFlow-MKL/repos", "events_url": "https://api.github.com/users/TensorFlow-MKL/events{/privacy}", "received_events_url": "https://api.github.com/users/TensorFlow-MKL/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "TensorFlow-MKL", "id": 44416303, "node_id": "MDQ6VXNlcjQ0NDE2MzAz", "avatar_url": "https://avatars2.githubusercontent.com/u/44416303?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TensorFlow-MKL", "html_url": "https://github.com/TensorFlow-MKL", "followers_url": "https://api.github.com/users/TensorFlow-MKL/followers", "following_url": "https://api.github.com/users/TensorFlow-MKL/following{/other_user}", "gists_url": "https://api.github.com/users/TensorFlow-MKL/gists{/gist_id}", "starred_url": "https://api.github.com/users/TensorFlow-MKL/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TensorFlow-MKL/subscriptions", "organizations_url": "https://api.github.com/users/TensorFlow-MKL/orgs", "repos_url": "https://api.github.com/users/TensorFlow-MKL/repos", "events_url": "https://api.github.com/users/TensorFlow-MKL/events{/privacy}", "received_events_url": "https://api.github.com/users/TensorFlow-MKL/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-10-23T06:28:49Z", "updated_at": "2019-12-20T03:35:58Z", "closed_at": null, "author_association": "NONE", "body": "### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No\r\n- **OS Platform and Distribution**: Ubuntu 18.04\r\n- **TensorFlow installed from**: pip2 install intel-tensorflow==1.14.0\r\n- **TensorFlow version (use command below)**: 1.14\r\n- **Python version**: 2.7\r\n\r\n### Describe the problem\r\nI'm going to participate in submissions limited to use CPU single thread. My implementation is in Python and I found that when construct tf.Session, a threadpool is created. However, I can't set it to single threaded even with the following suggested configuration:\r\n```python\r\nsess = tf.Session(config=tf.ConfigProto(\r\n    intra_op_parallelism_threads=1,\r\n    inter_op_parallelism_threads=1,\r\n    device_count = {'CPU': 1}\r\n))\r\n```\r\nHow can I reach single threaded?  \r\nThank you !!\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33626", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33626/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33626/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33626/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33626", "id": 511100957, "node_id": "MDU6SXNzdWU1MTExMDA5NTc=", "number": 33626, "title": "tf-lite 2.0 python", "user": {"login": "peter197321", "id": 46971586, "node_id": "MDQ6VXNlcjQ2OTcxNTg2", "avatar_url": "https://avatars3.githubusercontent.com/u/46971586?v=4", "gravatar_id": "", "url": "https://api.github.com/users/peter197321", "html_url": "https://github.com/peter197321", "followers_url": "https://api.github.com/users/peter197321/followers", "following_url": "https://api.github.com/users/peter197321/following{/other_user}", "gists_url": "https://api.github.com/users/peter197321/gists{/gist_id}", "starred_url": "https://api.github.com/users/peter197321/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/peter197321/subscriptions", "organizations_url": "https://api.github.com/users/peter197321/orgs", "repos_url": "https://api.github.com/users/peter197321/repos", "events_url": "https://api.github.com/users/peter197321/events{/privacy}", "received_events_url": "https://api.github.com/users/peter197321/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gargn", "id": 1900612, "node_id": "MDQ6VXNlcjE5MDA2MTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1900612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gargn", "html_url": "https://github.com/gargn", "followers_url": "https://api.github.com/users/gargn/followers", "following_url": "https://api.github.com/users/gargn/following{/other_user}", "gists_url": "https://api.github.com/users/gargn/gists{/gist_id}", "starred_url": "https://api.github.com/users/gargn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gargn/subscriptions", "organizations_url": "https://api.github.com/users/gargn/orgs", "repos_url": "https://api.github.com/users/gargn/repos", "events_url": "https://api.github.com/users/gargn/events{/privacy}", "received_events_url": "https://api.github.com/users/gargn/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gargn", "id": 1900612, "node_id": "MDQ6VXNlcjE5MDA2MTI=", "avatar_url": "https://avatars2.githubusercontent.com/u/1900612?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gargn", "html_url": "https://github.com/gargn", "followers_url": "https://api.github.com/users/gargn/followers", "following_url": "https://api.github.com/users/gargn/following{/other_user}", "gists_url": "https://api.github.com/users/gargn/gists{/gist_id}", "starred_url": "https://api.github.com/users/gargn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gargn/subscriptions", "organizations_url": "https://api.github.com/users/gargn/orgs", "repos_url": "https://api.github.com/users/gargn/repos", "events_url": "https://api.github.com/users/gargn/events{/privacy}", "received_events_url": "https://api.github.com/users/gargn/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-10-23T06:19:24Z", "updated_at": "2020-01-16T22:10:39Z", "closed_at": null, "author_association": "NONE", "body": "I'd like to have TensorFlow-lite python module. So is it and how to build from source?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33618", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33618/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33618/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33618/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33618", "id": 510834624, "node_id": "MDU6SXNzdWU1MTA4MzQ2MjQ=", "number": 33618, "title": "massive c++14 warning during build", "user": {"login": "alanpurple", "id": 4515120, "node_id": "MDQ6VXNlcjQ1MTUxMjA=", "avatar_url": "https://avatars1.githubusercontent.com/u/4515120?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alanpurple", "html_url": "https://github.com/alanpurple", "followers_url": "https://api.github.com/users/alanpurple/followers", "following_url": "https://api.github.com/users/alanpurple/following{/other_user}", "gists_url": "https://api.github.com/users/alanpurple/gists{/gist_id}", "starred_url": "https://api.github.com/users/alanpurple/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alanpurple/subscriptions", "organizations_url": "https://api.github.com/users/alanpurple/orgs", "repos_url": "https://api.github.com/users/alanpurple/repos", "events_url": "https://api.github.com/users/alanpurple/events{/privacy}", "received_events_url": "https://api.github.com/users/alanpurple/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1188421838, "node_id": "MDU6TGFiZWwxMTg4NDIxODM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:windows", "name": "subtype:windows", "color": "b619ea", "default": false, "description": "Windows Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-10-22T18:35:55Z", "updated_at": "2019-11-22T19:09:07Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): windows 10 1903 x64\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version: 2.0.0\r\n- Python version: 3.7.4 x64\r\n- Installed using virtualenv? pip? conda?: N/A\r\n- Bazel version (if compiling from source): 0.29.1\r\n- GCC/Compiler version (if compiling from source):   VS 2017 build tools\r\n- CUDA/cuDNN version: 10.1 / 7.6.4\r\n- GPU model and memory: RTX 2080Ti GDDR6 11GB\r\n\r\n\r\n\r\n**Describe the problem**\r\nmassive unknown option warning from compiler\r\n\r\nthe option '-std=c++14' should not be used\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\nbazel build //tensorflow/tools/pip_package:build_pip_package\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n```\r\ncl : Command line warning D9002 : ignoring unknown option '-std=c++14'\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33616", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33616/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33616/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33616/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33616", "id": 510792508, "node_id": "MDU6SXNzdWU1MTA3OTI1MDg=", "number": 33616, "title": "TFLiteConverter StridedSlice Error for Transformer Example Notebook", "user": {"login": "mattc-eostar", "id": 53350908, "node_id": "MDQ6VXNlcjUzMzUwOTA4", "avatar_url": "https://avatars3.githubusercontent.com/u/53350908?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mattc-eostar", "html_url": "https://github.com/mattc-eostar", "followers_url": "https://api.github.com/users/mattc-eostar/followers", "following_url": "https://api.github.com/users/mattc-eostar/following{/other_user}", "gists_url": "https://api.github.com/users/mattc-eostar/gists{/gist_id}", "starred_url": "https://api.github.com/users/mattc-eostar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mattc-eostar/subscriptions", "organizations_url": "https://api.github.com/users/mattc-eostar/orgs", "repos_url": "https://api.github.com/users/mattc-eostar/repos", "events_url": "https://api.github.com/users/mattc-eostar/events{/privacy}", "received_events_url": "https://api.github.com/users/mattc-eostar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jaeyoo", "id": 40815393, "node_id": "MDQ6VXNlcjQwODE1Mzkz", "avatar_url": "https://avatars1.githubusercontent.com/u/40815393?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaeyoo", "html_url": "https://github.com/jaeyoo", "followers_url": "https://api.github.com/users/jaeyoo/followers", "following_url": "https://api.github.com/users/jaeyoo/following{/other_user}", "gists_url": "https://api.github.com/users/jaeyoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaeyoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaeyoo/subscriptions", "organizations_url": "https://api.github.com/users/jaeyoo/orgs", "repos_url": "https://api.github.com/users/jaeyoo/repos", "events_url": "https://api.github.com/users/jaeyoo/events{/privacy}", "received_events_url": "https://api.github.com/users/jaeyoo/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jaeyoo", "id": 40815393, "node_id": "MDQ6VXNlcjQwODE1Mzkz", "avatar_url": "https://avatars1.githubusercontent.com/u/40815393?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaeyoo", "html_url": "https://github.com/jaeyoo", "followers_url": "https://api.github.com/users/jaeyoo/followers", "following_url": "https://api.github.com/users/jaeyoo/following{/other_user}", "gists_url": "https://api.github.com/users/jaeyoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaeyoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaeyoo/subscriptions", "organizations_url": "https://api.github.com/users/jaeyoo/orgs", "repos_url": "https://api.github.com/users/jaeyoo/repos", "events_url": "https://api.github.com/users/jaeyoo/events{/privacy}", "received_events_url": "https://api.github.com/users/jaeyoo/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-10-22T17:12:36Z", "updated_at": "2020-02-27T08:58:13Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Linux Ubuntu 18.04.2\r\n- Installed from binary\r\n- TensorFlow version 2.0.0\r\n\r\n**Provide the text output from tflite_convert**\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nConverterError                            Traceback (most recent call last)\r\n<ipython-input-82-0b556551beac> in <module>()\r\n      3 \r\n      4 converter = tf.lite.TFLiteConverter.from_concrete_functions([to_save])\r\n----> 5 tflite_model = converter.convert()\r\n\r\n~/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/lite/python/lite.py in convert(self)\r\n    444         input_tensors=input_tensors,\r\n    445         output_tensors=output_tensors,\r\n--> 446         **converter_kwargs)\r\n    447 \r\n    448     if self._is_calibration_quantize():\r\n\r\n~/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/lite/python/convert.py in toco_convert_impl(input_data, input_tensors, output_tensors, enable_mlir_converter, *args, **kwargs)\r\n    447       input_data.SerializeToString(),\r\n    448       debug_info_str=debug_info_str,\r\n--> 449       enable_mlir_converter=enable_mlir_converter)\r\n    450   return data\r\n    451 \r\n\r\n~/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/lite/python/convert.py in toco_convert_protos(model_flags_str, toco_flags_str, input_data_str, debug_info_str, enable_mlir_converter)\r\n    198       stdout = _try_convert_to_unicode(stdout)\r\n    199       stderr = _try_convert_to_unicode(stderr)\r\n--> 200       raise ConverterError(\"See console for info.\\n%s\\n%s\\n\" % (stdout, stderr))\r\n    201   finally:\r\n    202     # Must manually cleanup files.\r\n\r\nConverterError: See console for info.\r\n2019-10-22 12:59:50.304931: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 915 operators, 1487 arrays (0 quantized)\r\n2019-10-22 12:59:50.337611: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 915 operators, 1487 arrays (0 quantized)\r\n2019-10-22 12:59:50.397450: F tensorflow/lite/toco/graph_transformations/resolve_strided_slice_attributes.cc:95] Check failed: start_indices_size <= num_input_axes (4 vs. 2)StridedSlice op requires no more than 2 start indices\r\nFatal Python error: Aborted\r\n\r\nCurrent thread 0x00007f2d4bb1e740 (most recent call first):\r\n  File \"/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 52 in execute\r\n  File \"/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/absl/app.py\", line 251 in _run_main\r\n  File \"/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/absl/app.py\", line 300 in run\r\n  File \"/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/python/platform/app.py\", line 40 in run\r\n  File \"/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 89 in main\r\n  File \"/home/mattc/anaconda3/envs/main/bin/toco_from_protos\", line 10 in <module>\r\nAborted (core dumped)\r\n```\r\n\r\n**Any other info / logs**\r\n\r\nI am following this notebook: https://www.tensorflow.org/tutorials/text/transformer\r\nI am interested in doing NMT on an Android device with TFLite. The NMT Attention notebook uses an LSTM which is not supported yet for TF Lite conversion so I am looking into this approach that only uses Attention, Embeddings, and Dense layers in hope that it is convertible. \r\n\r\nI haven't edited the code from that notebook at all, but created a new inference concrete function and am trying to convert it. I am getting this vague error about the StridedSlice op.\r\n\r\nLooking for some guidance on what I can do from here.\r\n\r\n```python\r\ntf.random.set_seed(1234)\r\n\r\neval_step_signature = [\r\n    tf.TensorSpec(shape=(BATCH_SIZE, 64), dtype=tf.int64),\r\n    tf.TensorSpec(shape=(BATCH_SIZE, 26), dtype=tf.int64),\r\n]\r\n\r\n@tf.function(input_signature=eval_step_signature)\r\ndef eval_step(inp, tar):\r\n\r\n    enc_padding_mask, combined_mask, dec_padding_mask = create_masks(inp, tar)\r\n    \r\n    predictions, _ = transformer(inp, tar, \r\n                                 True, \r\n                                 enc_padding_mask, \r\n                                 combined_mask, \r\n                                 dec_padding_mask)\r\n    return predictions\r\n\r\nckpt.f = eval_step\r\nto_save = ckpt.f.get_concrete_function()\r\n\r\nconverter = tf.lite.TFLiteConverter.from_concrete_functions([to_save])\r\ntflite_model = converter.convert()\r\n```\r\n\r\nThank you!"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33613", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33613/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33613/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33613/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33613", "id": 510721962, "node_id": "MDU6SXNzdWU1MTA3MjE5NjI=", "number": 33613, "title": "[TFLite, Bug] Unexpected weights changes after conversion", "user": {"login": "Vooblin", "id": 39566915, "node_id": "MDQ6VXNlcjM5NTY2OTE1", "avatar_url": "https://avatars2.githubusercontent.com/u/39566915?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Vooblin", "html_url": "https://github.com/Vooblin", "followers_url": "https://api.github.com/users/Vooblin/followers", "following_url": "https://api.github.com/users/Vooblin/following{/other_user}", "gists_url": "https://api.github.com/users/Vooblin/gists{/gist_id}", "starred_url": "https://api.github.com/users/Vooblin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Vooblin/subscriptions", "organizations_url": "https://api.github.com/users/Vooblin/orgs", "repos_url": "https://api.github.com/users/Vooblin/repos", "events_url": "https://api.github.com/users/Vooblin/events{/privacy}", "received_events_url": "https://api.github.com/users/Vooblin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-10-22T15:06:52Z", "updated_at": "2019-11-11T09:56:22Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): no\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: no\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version (use command below): VERSION=2.0.0, GIT_VERSION=v1.12.1-15611-g025365a736\r\n- Python version: 3.6.8\r\n- Bazel version (if compiling from source): 0.26.1\r\n- GCC/Compiler version (if compiling from source): GCC 8.3.0\r\n- CUDA/cuDNN version: CUDA Version: 10.1\r\n- GPU model and memory: GeForce GTX 1080 Titan 11GB\r\n\r\n**Describe the current behavior**\r\nIn this issue code from tensorflow/models is used (tensorflow/models/official/nlp/bert_modeling.py). After conversion weights of model seriously changes. After some minimal fixes in source code of tensorflow/models it is solved but program mustn't changes. Below I show some cases. Code of keras layer EmbeddingPostprocessor:\r\n```\r\ndef call(self, inputs):\r\n    \"\"\"Implements call() for the layer.\"\"\"\r\n    unpacked_inputs = tf_utils.unpack_inputs(inputs)\r\n    word_embeddings = unpacked_inputs[0]\r\n    token_type_ids = unpacked_inputs[1]\r\n    input_shape = tf_utils.get_shape_list(word_embeddings, expected_rank=3)\r\n    batch_size = input_shape[0]\r\n    seq_length = input_shape[1]\r\n    width = input_shape[2]\r\n\r\n    output = word_embeddings\r\n    if self.use_type_embeddings:\r\n      flat_token_type_ids = tf.reshape(token_type_ids, [-1])\r\n      one_hot_ids = tf.one_hot(\r\n          flat_token_type_ids,\r\n          depth=self.token_type_vocab_size,\r\n          dtype=self.dtype)\r\n      token_type_embeddings = tf.matmul(one_hot_ids, self.type_embeddings)\r\n      token_type_embeddings = tf.reshape(token_type_embeddings,\r\n                                         [batch_size, seq_length, width])\r\n      output += token_type_embeddings\r\n\r\n    if self.use_position_embeddings:\r\n      position_embeddings = tf.expand_dims(\r\n          tf.slice(self.position_embeddings, [0, 0], [seq_length, width]),\r\n          axis=0)\r\n\r\n      output += position_embeddings\r\n\r\n    output = self.output_layer_norm(output)\r\n    output = self.output_dropout(output)\r\n\r\n    return output\r\n```\r\n\r\n1) Without changes in source code. Weights are incorrect.\r\n2) Fixes are shown under this point. In this case weights are correct.\r\n```\r\nif self.use_type_embeddings:\r\n      flat_token_type_ids = tf.reshape(token_type_ids, [-1])\r\n      token_type_embeddings = tf.gather(self.type_embeddings, flat_token_type_embeddings)\r\n      token_type_embeddings = tf.reshape(token_type_embeddings,\r\n                                         [batch_size, seq_length, width])\r\n      output += token_type_embeddings\r\n```\r\n3) Use EmbeddingPostprocessor without position_embeddings. In this case weights are correct. Example with full code is in the part \"Code to reproduce the issue\"\r\n```\r\noutputs = EmbeddingPostprocessor(\r\n    use_type_embeddings=True,\r\n    token_type_vocab_size=2,\r\n    use_position_embeddings=False,\r\n    dtype=tf.float32)(input1, input2)\r\n```\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\nfrom official.nlp.bert_modeling import EmbeddingPostprocessor\r\n\r\nsize = 100\r\n\r\ninput1 = tf.keras.layers.Input(shape=(size, size), dtype=tf.float32, name='1')\r\ninput2 = tf.keras.layers.Input(shape=(size,), dtype=tf.int32, name='2')\r\noutputs = EmbeddingPostprocessor(\r\n    use_type_embeddings=True,\r\n    token_type_vocab_size=2,\r\n    dtype=tf.float32)(input1, input2)\r\nmodel = tf.keras.Model(inputs=[input1, input2], outputs=outputs)\r\n\r\nexample1 = tf.constant(np.random.random_sample(size=(1, size, size)), dtype=tf.float32)\r\nexample2 = tf.constant(np.random.randint(2, size=(1, size), dtype=np.int32))\r\nexample = {'1': example1, '2': example2}\r\n\r\noutput1 = model.predict(example)\r\n\r\nconverter = tf.lite.TFLiteConverter.from_keras_model(model)\r\ntflite_model = converter.convert()\r\n\r\ninterpreter = tf.lite.Interpreter(model_content=tflite_model)\r\ninterpreter.allocate_tensors()\r\n\r\ninput_details = interpreter.get_input_details()\r\noutput_details = interpreter.get_output_details()\r\n\r\ninterpreter.reset_all_variables()\r\ninterpreter.set_tensor(input_details[0]['index'], example[input_details[0]['name']])\r\ninterpreter.set_tensor(input_details[1]['index'], example[input_details[1]['name']])\r\ninterpreter.invoke()\r\n\r\noutput2 = interpreter.get_tensor(output_details[0]['index'])\r\n\r\nprint(np.sum(np.abs(output1 - output2)))\r\n```\r\n\r\n**Other info / logs**\r\n* With error:\r\n```\r\n*** INFO MESSAGES ***\r\n691.0672\r\n```\r\n* Without error:\r\n```\r\n*** INFO MESSAGES ***\r\n0.0021286607\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33609", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33609/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33609/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33609/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33609", "id": 510653863, "node_id": "MDU6SXNzdWU1MTA2NTM4NjM=", "number": 33609, "title": "Arduino compilation fail : error: macro \"max\" requires 2 arguments, but only 1 given  max(0.0f),", "user": {"login": "jujuz777", "id": 22938676, "node_id": "MDQ6VXNlcjIyOTM4Njc2", "avatar_url": "https://avatars2.githubusercontent.com/u/22938676?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jujuz777", "html_url": "https://github.com/jujuz777", "followers_url": "https://api.github.com/users/jujuz777/followers", "following_url": "https://api.github.com/users/jujuz777/following{/other_user}", "gists_url": "https://api.github.com/users/jujuz777/gists{/gist_id}", "starred_url": "https://api.github.com/users/jujuz777/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jujuz777/subscriptions", "organizations_url": "https://api.github.com/users/jujuz777/orgs", "repos_url": "https://api.github.com/users/jujuz777/repos", "events_url": "https://api.github.com/users/jujuz777/events{/privacy}", "received_events_url": "https://api.github.com/users/jujuz777/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-10-22T13:24:35Z", "updated_at": "2019-11-16T06:51:43Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Arduino Nano 33 IOT\r\n\r\n**Describe the problem**\r\n\r\nThere is a compilation issue :\r\nDocuments/Arduino/libraries/Arduino_TensorFlowLite/src/tensorflow/lite/schema/schema_generated.h:6761:17: error: macro \"max\" requires 2 arguments, but only 1 given\r\n         max(0.0f),\r\n\r\nDocuments/Arduino/libraries/Arduino_TensorFlowLite/src/tensorflow/lite/schema/schema_generated.h:6778:13: error: macro \"max\" requires 2 arguments, but only 1 given\r\n   float max() const {\r\n\r\n\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n\r\nArduino IDE upload button\r\n\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33608", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33608/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33608/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33608/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33608", "id": 510625247, "node_id": "MDU6SXNzdWU1MTA2MjUyNDc=", "number": 33608, "title": "\"Failed to call mkldnn_sgemm. Error code: 3\" Error when training a simple CNN model", "user": {"login": "ophiry", "id": 5228696, "node_id": "MDQ6VXNlcjUyMjg2OTY=", "avatar_url": "https://avatars1.githubusercontent.com/u/5228696?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ophiry", "html_url": "https://github.com/ophiry", "followers_url": "https://api.github.com/users/ophiry/followers", "following_url": "https://api.github.com/users/ophiry/following{/other_user}", "gists_url": "https://api.github.com/users/ophiry/gists{/gist_id}", "starred_url": "https://api.github.com/users/ophiry/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ophiry/subscriptions", "organizations_url": "https://api.github.com/users/ophiry/orgs", "repos_url": "https://api.github.com/users/ophiry/repos", "events_url": "https://api.github.com/users/ophiry/events{/privacy}", "received_events_url": "https://api.github.com/users/ophiry/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1104829434, "node_id": "MDU6TGFiZWwxMTA0ODI5NDM0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:mkl", "name": "comp:mkl", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-10-22T12:33:47Z", "updated_at": "2019-12-06T00:42:27Z", "closed_at": null, "author_association": "NONE", "body": "\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): MacOS\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary):binary\r\n- TensorFlow version (use command below):2.1.0-dev20191021, 2.0.0\r\n- Python version: 3.6.8\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\nTrying to build a model that uses CNN over text. \r\nminimal code to reproduce the error:\r\n\r\n```\r\nimport tensorflow\r\nfrom tensorflow.keras.layers import Dense, LSTM, Bidirectional, Embedding, Lambda, Conv1D, GlobalMaxPool1D, concatenate\r\nfrom tensorflow.keras.models import Sequential, Model\r\nfrom tensorflow.keras import Input\r\nimport string\r\n\r\nCHARS = string.punctuation + string.digits + string.ascii_letters + string.whitespace\r\nCHAR_MAP = tensorflow.lookup.StaticHashTable(tensorflow.lookup.KeyValueTensorInitializer(list(CHARS), list(range(1, len(CHARS)+1)), 'string', 'int32'), 0)\r\n\r\n\r\ndef string_to_vec(s):\r\n    return tensorflow.ragged.map_flat_values (CHAR_MAP.lookup, tensorflow.strings.unicode_split(s, 'UTF-8')).to_tensor()\r\n\r\n\r\ninput_layer = Input(shape=tuple(), ragged=False, dtype='string')\r\nfeature_layer = Lambda(string_to_vec)(input_layer)\r\nembedding_layer = Embedding(input_dim=len(CHARS)+1, output_dim=10, name='char_embeddings')(feature_layer)\r\ncnn_layer = concatenate([Conv1D(10, kernel_size, activation='relu', padding='same')(embedding_layer) for kernel_size in range(5)])\r\nmax_pool = GlobalMaxPool1D()(cnn_layer)\r\ndense_layer = Dense(1, activation='relu')(max_pool)\r\nmodel = Model(inputs=[input_layer], outputs=[dense_layer])\r\nmodel.compile(optimizer='adam', loss='binary_crossentropy')\r\n\r\nprint(tensorflow.__version__)\r\n\r\nx = ['hello world', 'this is a test']\r\ny = [0] * len(x)\r\nprint(model.predict(x))\r\nmodel.fit(x,y)\r\n\r\n```\r\n\r\nOutput:\r\n```\r\n2.1.0-dev20191021\r\n[[0.]\r\n [0.]]\r\nTrain on 2 samples\r\n2019-10-22 15:29:13.322033: W tensorflow/core/common_runtime/base_collective_executor.cc:217] BaseCollectiveExecutor::StartAbort Internal: Failed to call mkldnn_sgemm. Error code: 3\r\n\t [[{{node Conv2DBackpropInput}}]]\r\n2/2 [==============================] - 1s 285ms/sample\r\nTraceback (most recent call last):\r\n  File \"/usr/local/miniconda3/envs/zr/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 3326, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-2-64494552324e>\", line 4, in <module>\r\n    runfile('/Users/ophir/dev/ophir/cnn_error.py', wdir='/Users/ophir/dev/ophir')\r\n  File \"/Applications/PyCharm.app/Contents/helpers/pydev/_pydev_bundle/pydev_umd.py\", line 197, in runfile\r\n    pydev_imports.execfile(filename, global_vars, local_vars)  # execute the script\r\n  File \"/Applications/PyCharm.app/Contents/helpers/pydev/_pydev_imps/_pydev_execfile.py\", line 18, in execfile\r\n    exec(compile(contents+\"\\n\", file, 'exec'), glob, loc)\r\n  File \"/Users/ophir/dev/ophir/cnn_error.py\", line 29, in <module>\r\n    model.fit(x,y)\r\n  File \"/usr/local/miniconda3/envs/zr/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training.py\", line 777, in fit\r\n    use_multiprocessing=use_multiprocessing)\r\n  File \"/usr/local/miniconda3/envs/zr/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 337, in fit\r\n    total_epochs=epochs)\r\n  File \"/usr/local/miniconda3/envs/zr/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 127, in run_one_epoch\r\n    batch_outs = execution_function(iterator)\r\n  File \"/usr/local/miniconda3/envs/zr/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_v2_utils.py\", line 86, in execution_function\r\n    distributed_function(input_fn))\r\n  File \"/usr/local/miniconda3/envs/zr/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py\", line 568, in __call__\r\n    result = self._call(*args, **kwds)\r\n  File \"/usr/local/miniconda3/envs/zr/lib/python3.6/site-packages/tensorflow_core/python/eager/def_function.py\", line 632, in _call\r\n    return self._stateless_fn(*args, **kwds)\r\n  File \"/usr/local/miniconda3/envs/zr/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 2339, in __call__\r\n    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access\r\n  File \"/usr/local/miniconda3/envs/zr/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 1589, in _filtered_call\r\n    self.captured_inputs)\r\n  File \"/usr/local/miniconda3/envs/zr/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 1670, in _call_flat\r\n    ctx, args, cancellation_manager=cancellation_manager))\r\n  File \"/usr/local/miniconda3/envs/zr/lib/python3.6/site-packages/tensorflow_core/python/eager/function.py\", line 521, in call\r\n    ctx=ctx)\r\n  File \"/usr/local/miniconda3/envs/zr/lib/python3.6/site-packages/tensorflow_core/python/eager/execute.py\", line 67, in quick_execute\r\n    six.raise_from(core._status_to_exception(e.code, message), None)\r\n  File \"<string>\", line 3, in raise_from\r\ntensorflow.python.framework.errors_impl.InternalError:  Failed to call mkldnn_sgemm. Error code: 3\r\n\t [[node Conv2DBackpropInput (defined at /Users/ophir/dev/ophir/cnn_error.py:29) ]] [Op:__inference_distributed_function_1725]\r\nFunction call stack:\r\ndistributed_function\r\n\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33605", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33605/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33605/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33605/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33605", "id": 510623079, "node_id": "MDU6SXNzdWU1MTA2MjMwNzk=", "number": 33605, "title": "OUT_OF_MEMORY error on Mali GPU.", "user": {"login": "wanfranck", "id": 14755072, "node_id": "MDQ6VXNlcjE0NzU1MDcy", "avatar_url": "https://avatars3.githubusercontent.com/u/14755072?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wanfranck", "html_url": "https://github.com/wanfranck", "followers_url": "https://api.github.com/users/wanfranck/followers", "following_url": "https://api.github.com/users/wanfranck/following{/other_user}", "gists_url": "https://api.github.com/users/wanfranck/gists{/gist_id}", "starred_url": "https://api.github.com/users/wanfranck/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wanfranck/subscriptions", "organizations_url": "https://api.github.com/users/wanfranck/orgs", "repos_url": "https://api.github.com/users/wanfranck/repos", "events_url": "https://api.github.com/users/wanfranck/events{/privacy}", "received_events_url": "https://api.github.com/users/wanfranck/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 32, "created_at": "2019-10-22T12:29:33Z", "updated_at": "2019-12-09T08:20:43Z", "closed_at": null, "author_association": "NONE", "body": "Hey there!\r\nIn my project I try to run inference on a simple one input model via GPU delegate and SSBO.\r\n\r\nI have 5 devices: Nexus 5X, Xiaomi Mi A1, Xiaomi Mi T9 Pro, Honor 10 and Huawei Mate 20.\r\n\r\nFirst three devices are on Adreno GPU and everything works perfectly, but in Huawei and Honor it turned out that during the intertpreter invoke method OpenGL ES OUT_OF_MEMORY error tracked on glGetUniformLocation call. I tried out different approaches to avoid this, but it didn't help. \r\n\r\nAt the moment of crash usage of Graphics memory is about 256 MB out of 1 GB.\r\n\r\nMaybe you could help me with that?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33599", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33599/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33599/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33599/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33599", "id": 510507720, "node_id": "MDU6SXNzdWU1MTA1MDc3MjA=", "number": 33599, "title": "C binding for tensorflow 2.0", "user": {"login": "oak-tree", "id": 667153, "node_id": "MDQ6VXNlcjY2NzE1Mw==", "avatar_url": "https://avatars0.githubusercontent.com/u/667153?v=4", "gravatar_id": "", "url": "https://api.github.com/users/oak-tree", "html_url": "https://github.com/oak-tree", "followers_url": "https://api.github.com/users/oak-tree/followers", "following_url": "https://api.github.com/users/oak-tree/following{/other_user}", "gists_url": "https://api.github.com/users/oak-tree/gists{/gist_id}", "starred_url": "https://api.github.com/users/oak-tree/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/oak-tree/subscriptions", "organizations_url": "https://api.github.com/users/oak-tree/orgs", "repos_url": "https://api.github.com/users/oak-tree/repos", "events_url": "https://api.github.com/users/oak-tree/events{/privacy}", "received_events_url": "https://api.github.com/users/oak-tree/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sjamesr", "id": 4641539, "node_id": "MDQ6VXNlcjQ2NDE1Mzk=", "avatar_url": "https://avatars0.githubusercontent.com/u/4641539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sjamesr", "html_url": "https://github.com/sjamesr", "followers_url": "https://api.github.com/users/sjamesr/followers", "following_url": "https://api.github.com/users/sjamesr/following{/other_user}", "gists_url": "https://api.github.com/users/sjamesr/gists{/gist_id}", "starred_url": "https://api.github.com/users/sjamesr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sjamesr/subscriptions", "organizations_url": "https://api.github.com/users/sjamesr/orgs", "repos_url": "https://api.github.com/users/sjamesr/repos", "events_url": "https://api.github.com/users/sjamesr/events{/privacy}", "received_events_url": "https://api.github.com/users/sjamesr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sjamesr", "id": 4641539, "node_id": "MDQ6VXNlcjQ2NDE1Mzk=", "avatar_url": "https://avatars0.githubusercontent.com/u/4641539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sjamesr", "html_url": "https://github.com/sjamesr", "followers_url": "https://api.github.com/users/sjamesr/followers", "following_url": "https://api.github.com/users/sjamesr/following{/other_user}", "gists_url": "https://api.github.com/users/sjamesr/gists{/gist_id}", "starred_url": "https://api.github.com/users/sjamesr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sjamesr/subscriptions", "organizations_url": "https://api.github.com/users/sjamesr/orgs", "repos_url": "https://api.github.com/users/sjamesr/repos", "events_url": "https://api.github.com/users/sjamesr/events{/privacy}", "received_events_url": "https://api.github.com/users/sjamesr/received_events", "type": "User", "site_admin": false}, {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-10-22T08:36:51Z", "updated_at": "2020-02-04T23:19:27Z", "closed_at": null, "author_association": "NONE", "body": "Is there a release date for `c binding` for `tf2`?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33598", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33598/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33598/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33598/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33598", "id": 510507230, "node_id": "MDU6SXNzdWU1MTA1MDcyMzA=", "number": 33598, "title": "about tf.gradients() API", "user": {"login": "candyzone", "id": 7778833, "node_id": "MDQ6VXNlcjc3Nzg4MzM=", "avatar_url": "https://avatars0.githubusercontent.com/u/7778833?v=4", "gravatar_id": "", "url": "https://api.github.com/users/candyzone", "html_url": "https://github.com/candyzone", "followers_url": "https://api.github.com/users/candyzone/followers", "following_url": "https://api.github.com/users/candyzone/following{/other_user}", "gists_url": "https://api.github.com/users/candyzone/gists{/gist_id}", "starred_url": "https://api.github.com/users/candyzone/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/candyzone/subscriptions", "organizations_url": "https://api.github.com/users/candyzone/orgs", "repos_url": "https://api.github.com/users/candyzone/repos", "events_url": "https://api.github.com/users/candyzone/events{/privacy}", "received_events_url": "https://api.github.com/users/candyzone/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-10-22T08:35:56Z", "updated_at": "2019-11-19T22:02:53Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "The API `tf.gradients` has a parameter `gate_gradients`\r\n```gate_gradients: If True, add a tuple around the gradients returned for an operations. This avoids some race conditions.```\r\n\r\nIn case of op has more than one in_grads, it makes a barrier, grads will not propagate until the whole grad subGraph was computed. It make sense.\r\n\r\nBut, in case of op has more than one in_grads and the upstream ops are not Variable, the barrier seems redundant. The OP parallelism can be improved.\r\n\r\nthanks"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33590", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33590/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33590/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33590/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/33590", "id": 510420367, "node_id": "MDExOlB1bGxSZXF1ZXN0MzMwNzk3ODgy", "number": 33590, "title": "Fix behavior difference between tf.io.GFile and python file for utf8", "user": {"login": "yongtang", "id": 6932348, "node_id": "MDQ6VXNlcjY5MzIzNDg=", "avatar_url": "https://avatars0.githubusercontent.com/u/6932348?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yongtang", "html_url": "https://github.com/yongtang", "followers_url": "https://api.github.com/users/yongtang/followers", "following_url": "https://api.github.com/users/yongtang/following{/other_user}", "gists_url": "https://api.github.com/users/yongtang/gists{/gist_id}", "starred_url": "https://api.github.com/users/yongtang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yongtang/subscriptions", "organizations_url": "https://api.github.com/users/yongtang/orgs", "repos_url": "https://api.github.com/users/yongtang/repos", "events_url": "https://api.github.com/users/yongtang/events{/privacy}", "received_events_url": "https://api.github.com/users/yongtang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1169365494, "node_id": "MDU6TGFiZWwxMTY5MzY1NDk0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:M", "name": "size:M", "color": "adafea", "default": false, "description": "CL Change Size: Medium"}], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-10-22T04:21:06Z", "updated_at": "2019-10-22T16:17:46Z", "closed_at": null, "author_association": "MEMBER", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/33590", "html_url": "https://github.com/tensorflow/tensorflow/pull/33590", "diff_url": "https://github.com/tensorflow/tensorflow/pull/33590.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/33590.patch"}, "body": "This PR tries to address the issue raised in #33563 where\r\ntf.io.GFile behavior is different from python file for utf8.\r\n\r\nThe issue was that tf.io.GFile's read does not take utf8 into\r\nconsideration for non binary mode.\r\n\r\nThis PR fixes the discrepancy.\r\n\r\nThis PR fixes #33563\r\n\r\nSigned-off-by: Yong Tang <yong.tang.github@outlook.com>"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33587", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33587/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33587/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33587/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33587", "id": 510378174, "node_id": "MDU6SXNzdWU1MTAzNzgxNzQ=", "number": 33587, "title": "Performant (distributed) tf dataset creation from replay buffer using distribute strategies?", "user": {"login": "mjlbach", "id": 13316262, "node_id": "MDQ6VXNlcjEzMzE2MjYy", "avatar_url": "https://avatars1.githubusercontent.com/u/13316262?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mjlbach", "html_url": "https://github.com/mjlbach", "followers_url": "https://api.github.com/users/mjlbach/followers", "following_url": "https://api.github.com/users/mjlbach/following{/other_user}", "gists_url": "https://api.github.com/users/mjlbach/gists{/gist_id}", "starred_url": "https://api.github.com/users/mjlbach/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mjlbach/subscriptions", "organizations_url": "https://api.github.com/users/mjlbach/orgs", "repos_url": "https://api.github.com/users/mjlbach/repos", "events_url": "https://api.github.com/users/mjlbach/events{/privacy}", "received_events_url": "https://api.github.com/users/mjlbach/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-10-22T01:13:37Z", "updated_at": "2019-10-23T06:31:30Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 2.0\r\n- Python version: 3.7.5\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: 10.0/7.6.2\r\n- GPU model and memory: Titan XP\r\n\r\n**Describe the current behavior**\r\n\r\nCurrently, there is a lot of overhead in making and distributing a dataset from a replay buffer (for RL) as this requires, pulling data from an Actor's queue, creating the dataset (tf.experimental_make_numpy_dataset), batching, distributing (self.strategy.experimental_distribute_dataset), and building the iterator upon each update to the replay buffer. See below for an example.\r\n\r\n```     \r\n    def gather_data(self):\r\n        self.output_queue = Queue(maxsize=self.data_params[\"num_envs\"])\r\n        self.data_provider = DataProvider( \r\n                    self.policy,\r\n                    self.output_queue,\r\n                    self.strategy,\r\n                    self.train_summary_writer,\r\n                )\r\n        for i in range(self.replay_buffer_len):\r\n            self.data_provider.collect_episode()\r\n\r\n    def get_batch(self):\r\n        with self.strategy.scope():\r\n            batch = self.output_queue.get()\r\n            dataset = self.strategy.experimental_make_numpy_dataset(batch)\r\n            dataset = dataset.batch(self.train_params[\"global_batch_size\"])\r\n            dataset = self.strategy.experimental_distribute_dataset(dataset)\r\n            self.iter = iter(dataset)\r\n\r\n    def distributed_train(self):\r\n        self.gather_data()\r\n        self.get_batch()\r\n        while step < self.train_steps:\r\n            if step > 0 and (step % train_steps_per_buffer_refresh == 0):\r\n                self.data_provider.collect_episode()\r\n                self.get_batch()\r\n            with self.strategy.scope():\r\n                train_res = self.train_step(\r\n                    next(self.iter),\r\n                    self.policy,\r\n                    self.strategy,\r\n                )\r\n            self.log_hook(train_res, step)\r\n            self.save_hook(step)\r\n            step += 1\r\n                                                                                                                                                        \r\n```\r\n\r\nThis follows the recommendation of the current docs. It takes a very long time (4s, 8x longer than each train step) to rebuild the dataset after adding to the replay buffer, distributed roughly evenly between self.strategy.experimental_make_numpy_dataset, self.strategy.experimental_distribute_dataset, and iter(dataset). Given than I updated the replay buffer every 4 train steps, this adds up to a significant performance hit.\r\n\r\nIt seems like tf-agents has an [implementation](https://github.com/tensorflow/agents/blob/e084e5184757dd84374e9b67176b8623d4b18a0f/tf_agents/replay_buffers/tf_uniform_replay_buffer.py#L301-L324) of a replay buffer to dataset Class method involving using tf.Counter and map, however, I haven't tested it's performance when calling distribute dataset on it. Is this the recommended way to have a Dataset does not have to be rebuilt after the replay buffer is updated? "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33585", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33585/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33585/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33585/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33585", "id": 510307320, "node_id": "MDU6SXNzdWU1MTAzMDczMjA=", "number": 33585, "title": "tf.compat.v1.wrap_function throws error when creating variable in tf.distribute scope", "user": {"login": "kazimuth", "id": 555667, "node_id": "MDQ6VXNlcjU1NTY2Nw==", "avatar_url": "https://avatars3.githubusercontent.com/u/555667?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kazimuth", "html_url": "https://github.com/kazimuth", "followers_url": "https://api.github.com/users/kazimuth/followers", "following_url": "https://api.github.com/users/kazimuth/following{/other_user}", "gists_url": "https://api.github.com/users/kazimuth/gists{/gist_id}", "starred_url": "https://api.github.com/users/kazimuth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kazimuth/subscriptions", "organizations_url": "https://api.github.com/users/kazimuth/orgs", "repos_url": "https://api.github.com/users/kazimuth/repos", "events_url": "https://api.github.com/users/kazimuth/events{/privacy}", "received_events_url": "https://api.github.com/users/kazimuth/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 1097541661, "node_id": "MDU6TGFiZWwxMDk3NTQxNjYx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tpus", "name": "comp:tpus", "color": "0052cc", "default": false, "description": "tpu, tpuestimator"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jhseu", "id": 170179, "node_id": "MDQ6VXNlcjE3MDE3OQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/170179?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jhseu", "html_url": "https://github.com/jhseu", "followers_url": "https://api.github.com/users/jhseu/followers", "following_url": "https://api.github.com/users/jhseu/following{/other_user}", "gists_url": "https://api.github.com/users/jhseu/gists{/gist_id}", "starred_url": "https://api.github.com/users/jhseu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jhseu/subscriptions", "organizations_url": "https://api.github.com/users/jhseu/orgs", "repos_url": "https://api.github.com/users/jhseu/repos", "events_url": "https://api.github.com/users/jhseu/events{/privacy}", "received_events_url": "https://api.github.com/users/jhseu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jhseu", "id": 170179, "node_id": "MDQ6VXNlcjE3MDE3OQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/170179?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jhseu", "html_url": "https://github.com/jhseu", "followers_url": "https://api.github.com/users/jhseu/followers", "following_url": "https://api.github.com/users/jhseu/following{/other_user}", "gists_url": "https://api.github.com/users/jhseu/gists{/gist_id}", "starred_url": "https://api.github.com/users/jhseu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jhseu/subscriptions", "organizations_url": "https://api.github.com/users/jhseu/orgs", "repos_url": "https://api.github.com/users/jhseu/repos", "events_url": "https://api.github.com/users/jhseu/events{/privacy}", "received_events_url": "https://api.github.com/users/jhseu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-10-21T21:35:02Z", "updated_at": "2019-11-25T01:58:53Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Google Colab TPU\r\n- TensorFlow installed from (source or binary): Binary\r\n- TensorFlow version (use command below): v2.0.0-rc2-26-g64c3d38 2.0.0\r\n- Python version: 3.6\r\n\r\n**Code to reproduce the issue**\r\n```python\r\n%tensorflow_version 2.x\r\nimport tensorflow as tf\r\n\r\n# define a function that uses tf.compat.v1.get_variable with some initializer\r\ndef f():\r\n    v = tf.compat.v1.get_variable(\r\n      'v',\r\n      initializer=tf.compat.v1.variance_scaling_initializer(), shape=(1), trainable=True\r\n    )\r\n    return v\r\n\r\n# this works:\r\nwrapped = tf.compat.v1.wrap_function(f, [])\r\n\r\n# but, connect to a TPU...\r\ntpu_address = 'grpc://' + os.environ['COLAB_TPU_ADDR']\r\ncluster_resolver = tf.distribute.cluster_resolver.TPUClusterResolver(tpu=tpu_address)\r\ntf.config.experimental_connect_to_cluster(cluster_resolver)\r\ntf.tpu.experimental.initialize_tpu_system(cluster_resolver)\r\nwith tf.distribute.experimental.TPUStrategy(cluster_resolver).scope():\r\n    # ...and, this throws:\r\n    # ValueError: Tensor-typed variable initializers must either be\r\n    # wrapped in an init_scope or callable\r\n    wrapped = tf.compat.v1.wrap_function(f, [])\r\n```\r\n\r\nIt seems like wrapped_function variable creation is interacting poorly with distribute somehow.\r\n\r\nNote, a simple `lambda: 0` initializer doesn't seem to cause this to happen. Not sure why. \r\n\r\n**Expected behavior**\r\nThis should \"just work\", unless these features aren't intended to be used together."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33584", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33584/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33584/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33584/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/33584", "id": 510200592, "node_id": "MDExOlB1bGxSZXF1ZXN0MzMwNjExNDQx", "number": 33584, "title": "Better Assertions for LearningRateScheduler", "user": {"login": "joaogui1", "id": 13261989, "node_id": "MDQ6VXNlcjEzMjYxOTg5", "avatar_url": "https://avatars0.githubusercontent.com/u/13261989?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joaogui1", "html_url": "https://github.com/joaogui1", "followers_url": "https://api.github.com/users/joaogui1/followers", "following_url": "https://api.github.com/users/joaogui1/following{/other_user}", "gists_url": "https://api.github.com/users/joaogui1/gists{/gist_id}", "starred_url": "https://api.github.com/users/joaogui1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joaogui1/subscriptions", "organizations_url": "https://api.github.com/users/joaogui1/orgs", "repos_url": "https://api.github.com/users/joaogui1/repos", "events_url": "https://api.github.com/users/joaogui1/events{/privacy}", "received_events_url": "https://api.github.com/users/joaogui1/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-10-21T18:45:39Z", "updated_at": "2020-02-12T10:14:13Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/33584", "html_url": "https://github.com/tensorflow/tensorflow/pull/33584", "diff_url": "https://github.com/tensorflow/tensorflow/pull/33584.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/33584.patch"}, "body": "The assertions used in the LearningRateScheduler test wouldn't show an error if the final learning rate was wrong but smaller than the correct value."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33573", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33573/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33573/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33573/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33573", "id": 509966362, "node_id": "MDU6SXNzdWU1MDk5NjYzNjI=", "number": 33573, "title": "Cannot find the placeholder op that is an input to ReadVariableOp.", "user": {"login": "PolinaDemochkina", "id": 50098076, "node_id": "MDQ6VXNlcjUwMDk4MDc2", "avatar_url": "https://avatars2.githubusercontent.com/u/50098076?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PolinaDemochkina", "html_url": "https://github.com/PolinaDemochkina", "followers_url": "https://api.github.com/users/PolinaDemochkina/followers", "following_url": "https://api.github.com/users/PolinaDemochkina/following{/other_user}", "gists_url": "https://api.github.com/users/PolinaDemochkina/gists{/gist_id}", "starred_url": "https://api.github.com/users/PolinaDemochkina/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PolinaDemochkina/subscriptions", "organizations_url": "https://api.github.com/users/PolinaDemochkina/orgs", "repos_url": "https://api.github.com/users/PolinaDemochkina/repos", "events_url": "https://api.github.com/users/PolinaDemochkina/events{/privacy}", "received_events_url": "https://api.github.com/users/PolinaDemochkina/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jianlijianli", "id": 43797323, "node_id": "MDQ6VXNlcjQzNzk3MzIz", "avatar_url": "https://avatars3.githubusercontent.com/u/43797323?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jianlijianli", "html_url": "https://github.com/jianlijianli", "followers_url": "https://api.github.com/users/jianlijianli/followers", "following_url": "https://api.github.com/users/jianlijianli/following{/other_user}", "gists_url": "https://api.github.com/users/jianlijianli/gists{/gist_id}", "starred_url": "https://api.github.com/users/jianlijianli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jianlijianli/subscriptions", "organizations_url": "https://api.github.com/users/jianlijianli/orgs", "repos_url": "https://api.github.com/users/jianlijianli/repos", "events_url": "https://api.github.com/users/jianlijianli/events{/privacy}", "received_events_url": "https://api.github.com/users/jianlijianli/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jianlijianli", "id": 43797323, "node_id": "MDQ6VXNlcjQzNzk3MzIz", "avatar_url": "https://avatars3.githubusercontent.com/u/43797323?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jianlijianli", "html_url": "https://github.com/jianlijianli", "followers_url": "https://api.github.com/users/jianlijianli/followers", "following_url": "https://api.github.com/users/jianlijianli/following{/other_user}", "gists_url": "https://api.github.com/users/jianlijianli/gists{/gist_id}", "starred_url": "https://api.github.com/users/jianlijianli/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jianlijianli/subscriptions", "organizations_url": "https://api.github.com/users/jianlijianli/orgs", "repos_url": "https://api.github.com/users/jianlijianli/repos", "events_url": "https://api.github.com/users/jianlijianli/events{/privacy}", "received_events_url": "https://api.github.com/users/jianlijianli/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-10-21T13:33:32Z", "updated_at": "2020-03-05T09:22:47Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux 4.15.0-62-generic\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: no\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version: tensorflow-gpu 2.0.0\r\n- Python version: 3.6\r\n- Bazel version (if compiling from source): no\r\n- GCC/Compiler version (if compiling from source): no\r\n- CUDA/cuDNN version:  V10.0.130\r\n- GPU model and memory: rtx 2060 6gb\r\n\r\n\r\n**Describe the current behavior**\r\nI'm unable to perform post-training quantization on my V2 model. \r\n\r\n**Code to reproduce the issue**\r\n```\r\nfrom tensorflow.keras import layers\r\nfrom tensorflow.keras import optimizers\r\nfrom tensorflow.keras.datasets import cifar100\r\nimport numpy as np\r\nimport tensorflow as tf\r\nfrom tensorflow import keras\r\nkeras.backend.clear_session()\r\nkeras.backend.set_learning_phase(0)\r\nfrom tensorflow.python.compiler.tensorrt import trt_convert as trt\r\nimport os\r\n\r\nos.environ['CUDA_VISIBLE_DEVICES'] = '-1'\r\n\r\n(x_train, y_train), (x_test, y_test) = cifar100.load_data()\r\nx_train = np.float32(x_train)[:64*(x_train.shape[0]//64)]\r\nx_train /= 255.0\r\ni_shape = x_train[0].shape\r\n\r\ninputs = layers.Input(i_shape)\r\nbase_model = keras.models.Sequential([\r\n    layers.Conv2D(128, 3, padding='same', strides=(2, 2)),\r\n    layers.BatchNormalization(),\r\n    layers.LeakyReLU(0.2),\r\n\r\n    layers.Conv2D(256, 3, padding='same', strides=(2, 2)),\r\n    layers.BatchNormalization(),\r\n    layers.LeakyReLU(0.2),\r\n\r\n    layers.Conv2D(512*100, 3, padding='same', strides=(2, 2)),\r\n    layers.BatchNormalization(),\r\n    layers.LeakyReLU(0.2),\r\n    layers.Flatten(),\r\n    layers.Dense(5*128),\r\n    layers.Reshape((5, 128)),\r\n    layers.LSTM(128),\r\n    layers.Flatten(),\r\n])(inputs)\r\n\r\nprediction = layers.Dense(100, activation='softmax')(base_model)\r\nmodel = keras.Model(inputs=inputs, outputs=prediction)\r\noptimizer = optimizers.Adam(0.00001)\r\nmodel.compile(optimizer, 'categorical_crossentropy', metrics=['accuracy'])\r\nprint(model.summary())\r\nsaved_model_dir = os.getcwd()\r\noutput_directory = os.getcwd()\r\ntf.saved_model.save(model, saved_model_dir)\r\n\r\n# graph quantization\r\nloaded = tf.saved_model.load(saved_model_dir)\r\n\r\nparams = trt.DEFAULT_TRT_CONVERSION_PARAMS._replace(\r\n    precision_mode='FP16',\r\n    is_dynamic_op=True,\r\n    maximum_cached_engines=16)\r\nconverter = trt.TrtGraphConverterV2(\r\n    input_saved_model_dir=saved_model_dir,\r\n    input_saved_model_tags=\"serve\",\r\n    input_saved_model_signature_key=\"serving_default\",\r\n    conversion_params=params)\r\nconverter.convert()\r\nsaved_model_dir_trt = output_directory\r\nconverter.save(saved_model_dir_trt)\r\n```\r\n\r\n**Other info / logs**\r\n```\r\nTraceback (most recent call last):\r\n  File \"optimize_graphv2.py\", line 33, in <module>\r\n    main(args)\r\n  File \"optimize_graphv2.py\", line 22, in main\r\n    converter.convert()\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/compiler/tensorrt/trt_convert.py\", line 960, in convert\r\n    frozen_func = convert_to_constants.convert_variables_to_constants_v2(func)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/convert_to_constants.py\", line 479, in convert_variables_to_constants_v2\r\n    raise ValueError(\"Cannot find the Placeholder op that is an input \"\r\nValueError: Cannot find the Placeholder op that is an input to the ReadVariableOp.\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33571", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33571/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33571/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33571/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33571", "id": 509952060, "node_id": "MDU6SXNzdWU1MDk5NTIwNjA=", "number": 33571, "title": "Tracing of first batch does not collect compute events", "user": {"login": "Flamefire", "id": 309017, "node_id": "MDQ6VXNlcjMwOTAxNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/309017?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Flamefire", "html_url": "https://github.com/Flamefire", "followers_url": "https://api.github.com/users/Flamefire/followers", "following_url": "https://api.github.com/users/Flamefire/following{/other_user}", "gists_url": "https://api.github.com/users/Flamefire/gists{/gist_id}", "starred_url": "https://api.github.com/users/Flamefire/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Flamefire/subscriptions", "organizations_url": "https://api.github.com/users/Flamefire/orgs", "repos_url": "https://api.github.com/users/Flamefire/repos", "events_url": "https://api.github.com/users/Flamefire/events{/privacy}", "received_events_url": "https://api.github.com/users/Flamefire/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}, {"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-10-21T13:10:22Z", "updated_at": "2019-11-21T18:52:37Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Mint 19.2\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: unknown\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): v2.0.0-rc2-26-g64c3d38 2.0.0\r\n- Python version: 3.6.9\r\n- CUDA/cuDNN version: none\r\n- GPU model and memory: none\r\n\r\n**Describe the current behavior**\r\n\r\nUsing `profile_batch=1` for `tf.keras.callbacks.TensorBoard` does not collect any compute calls in the profile/trace\r\n\r\n**Describe the expected behavior**\r\n\r\nSimilar timeline shown as for e.g. `profile_batch=2`.\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport tensorflow_datasets as tfds\r\nimport tensorflow as tf\r\nimport datetime\r\nimport os\r\n\r\ntf.config.threading.set_inter_op_parallelism_threads(1)\r\n\r\ndatasets, info = tfds.load(name='mnist',\r\n                           with_info=True,\r\n                           as_supervised=True,\r\n                           shuffle_files=False)\r\n\r\nmnist_train, mnist_test = datasets['train'], datasets['test']\r\nstrategy = tf.distribute.OneDeviceStrategy(\"/cpu:0\")\r\n\r\nnum_train_examples = info.splits['train'].num_examples\r\n\r\nBATCH_SIZE_PER_REPLICA = 64\r\nBATCH_SIZE = BATCH_SIZE_PER_REPLICA * strategy.num_replicas_in_sync\r\n\r\n\r\ndef scale(image, label):\r\n    image = tf.cast(image, tf.float32)\r\n    image /= 255\r\n    return image, label\r\n\r\n\r\ntrain_dataset = mnist_train.map(scale).cache().shuffle(\r\n    num_train_examples).batch(BATCH_SIZE)\r\neval_dataset = mnist_test.map(scale).batch(BATCH_SIZE)\r\n\r\nlog_dir = \"/tmp/tf_logs/fit/\" + datetime.datetime.now().strftime(\r\n    \"%Y%m%d-%H%M%S\")\r\n\r\nwith strategy.scope():\r\n    model = tf.keras.Sequential([\r\n        tf.keras.layers.Conv2D(32,\r\n                               3,\r\n                               activation='relu',\r\n                               input_shape=(28, 28, 1)),\r\n        tf.keras.layers.MaxPooling2D(),\r\n        tf.keras.layers.Flatten(),\r\n        tf.keras.layers.Dense(64, activation='relu'),\r\n        tf.keras.layers.Dense(10, activation='softmax')\r\n    ])\r\n\r\n    model.compile(loss='sparse_categorical_crossentropy',\r\n                  optimizer=tf.keras.optimizers.Adam(),\r\n                  metrics=['accuracy'])\r\n\r\n    callbacks = [\r\n            tf.keras.callbacks.TensorBoard(log_dir=log_dir,\r\n                                           histogram_freq=0,\r\n                                           profile_batch=1)\r\n    ]\r\n    model.fit(train_dataset, epochs=3, steps_per_epoch=20, callbacks=callbacks)\r\n```\r\n\r\n**Other info / logs**\r\n[epoch1.zip](https://github.com/tensorflow/tensorflow/files/3750929/epoch1.zip)\r\n[epoch2.zip](https://github.com/tensorflow/tensorflow/files/3750930/epoch2.zip)\r\n\r\nWhen opening the trace in TensorBoard there is a lot of \"stuff\" in epoch1, but no \"tf_compute\" section as with epoch2"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33567", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33567/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33567/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33567/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33567", "id": 509909987, "node_id": "MDU6SXNzdWU1MDk5MDk5ODc=", "number": 33567, "title": "Failure to load and remap a 2-D Tensor from checkpoint when variance scaling initializer is used", "user": {"login": "mbartzokas", "id": 6537250, "node_id": "MDQ6VXNlcjY1MzcyNTA=", "avatar_url": "https://avatars2.githubusercontent.com/u/6537250?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mbartzokas", "html_url": "https://github.com/mbartzokas", "followers_url": "https://api.github.com/users/mbartzokas/followers", "following_url": "https://api.github.com/users/mbartzokas/following{/other_user}", "gists_url": "https://api.github.com/users/mbartzokas/gists{/gist_id}", "starred_url": "https://api.github.com/users/mbartzokas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mbartzokas/subscriptions", "organizations_url": "https://api.github.com/users/mbartzokas/orgs", "repos_url": "https://api.github.com/users/mbartzokas/repos", "events_url": "https://api.github.com/users/mbartzokas/events{/privacy}", "received_events_url": "https://api.github.com/users/mbartzokas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-10-21T11:46:29Z", "updated_at": "2019-10-30T20:42:53Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): YES\r\n- OS Platform and Distribution:\r\nos: Darwin\r\nos kernel version: Darwin Kernel Version 17.7.0: Wed Feb 27 00:43:23 PST 2019; root:xnu-4570.71.35~1/RELEASE_X86_64\r\nos release version: 17.7.0\r\nos platform: Darwin-17.7.0-x86_64-i386-64bit\r\nlinux distribution: ('', '', '')\r\nlinux os distribution: ('', '', '')\r\nmac version: ('10.13.6', ('', '', ''), 'x86_64')\r\n- TensorFlow installed from (source or binary): NO\r\n- TensorFlow version (use command below):\r\ntf.version.VERSION = 1.14.0\r\ntf.version.GIT_VERSION = v1.14.0-rc1-22-gaf24dc91b5\r\ntf.version.COMPILER_VERSION = 4.2.1 Compatible Apple LLVM 10.0.0 (clang-1000.11.45.5)\r\n- Python version:\r\n(major, minor, micro, releaselevel, serial)\r\n(2, 7, 15, 'final', 0)\r\n- Bazel version (if compiling from source): NO\r\n- GCC/Compiler version (if compiling from source): NO\r\n- CUDA/cuDNN version: NO\r\n- GPU model and memory: NO\r\n\r\n**Describe the current behavior**\r\nI train with the estimator api and I wish to warm start a 2d variable (which I use as embedding). My old model has different embedding vocabulary than the new one so I pass a WarmStartSettings structure including tf.estimator.VocabInfo.\r\nIf I pass tf.estimator.VocabInfo without specifying a backup_initializer, the 0 initializer is used as default and the warm start and training finish successfully. However when I pass a backup_initializer, like tf.compat.v1.initializers.variance_scaling, I get a TypeError, which it looks like is caused because the initializer requires that its shape is a non Tensor, but the gen_checkpoint_ops.generate_vocab_remapping returns Tensors which are passed to the initilizer as shape.\r\n\r\n**Describe the expected behavior**\r\nAbility to load and remap a 2-D Tensor from a checkpoint when a custom initializer is used. So eventually be able to warm start whenever my new model embeddings have different vocabularies than the old\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport tensorflow as tf\r\nfrom tensorflow.python.training import checkpoint_ops\r\n\r\nif __name__ == '__main__':\r\n    initializer = tf.compat.v1.initializers.variance_scaling(scale=0.175, mode=\"fan_in\", distribution='uniform')\r\n\r\n    old_row_vocab_file = './old_vocab_path'  # text file with 2 rows\r\n    new_row_vocab_file = './new_vocab_path'  # text file with 2 rows\r\n\r\n    checkpoint_ops._load_and_remap_matrix(ckpt_path='', old_tensor_name='old_tensor/name', new_row_vocab_offset=0,\r\n                                          num_rows_to_load=2, new_col_vocab_size=3, initializer=initializer,\r\n                                          old_row_vocab_size=-1, old_row_vocab_file=old_row_vocab_file,\r\n                                          new_row_vocab_file=new_row_vocab_file)\r\n```\r\n\r\n**Other info / logs**\r\n```\r\nFile \"/env/lib/python2.7/site-packages/tensorflow_estimator/python/estimator/estimator.py\", line 1365, in _train_with_estimator_spec\r\n    warm_starting_util.warm_start(*self._warm_start_settings)\r\n  File \"/env/lib/python2.7/site-packages/tensorflow/python/training/warm_starting_util.py\", line 460, in warm_start\r\n    axis=vocab_info.axis)\r\n  File \"/env/lib/python2.7/site-packages/tensorflow/python/training/warm_starting_util.py\", line 301, in _warm_start_var_with_vocab\r\n    init(shape=v_shape, partition_info=partition_info))\r\n  File \"/env/lib/python2.7/site-packages/tensorflow/python/training/checkpoint_ops.py\", line 414, in _initializer\r\n    max_rows_in_memory=max_rows_in_memory)\r\n  File \"/env/lib/python2.7/site-packages/tensorflow/python/training/checkpoint_ops.py\", line 179, in _load_and_remap_matrix\r\n    num_rows_present * num_cols_present, 1\r\n  File \"/env/lib/python2.7/site-packages/tensorflow/python/ops/init_ops.py\", line 515, in __call__\r\n    fan_in, fan_out = _compute_fans(scale_shape)\r\n  File \"/env/lib/python2.7/site-packages/tensorflow/python/ops/init_ops.py\", line 1447, in _compute_fans\r\n    return int(fan_in), int(fan_out)\r\nTypeError: int() argument must be a string or a number, not 'Tensor'\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33566", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33566/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33566/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33566/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33566", "id": 509889051, "node_id": "MDU6SXNzdWU1MDk4ODkwNTE=", "number": 33566, "title": "TimeseriesGenerator for labeled time-series such as sensor data", "user": {"login": "mmalekzadeh", "id": 9408434, "node_id": "MDQ6VXNlcjk0MDg0MzQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/9408434?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mmalekzadeh", "html_url": "https://github.com/mmalekzadeh", "followers_url": "https://api.github.com/users/mmalekzadeh/followers", "following_url": "https://api.github.com/users/mmalekzadeh/following{/other_user}", "gists_url": "https://api.github.com/users/mmalekzadeh/gists{/gist_id}", "starred_url": "https://api.github.com/users/mmalekzadeh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mmalekzadeh/subscriptions", "organizations_url": "https://api.github.com/users/mmalekzadeh/orgs", "repos_url": "https://api.github.com/users/mmalekzadeh/repos", "events_url": "https://api.github.com/users/mmalekzadeh/events{/privacy}", "received_events_url": "https://api.github.com/users/mmalekzadeh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-10-21T11:00:24Z", "updated_at": "2019-10-22T10:09:47Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version: v2.0.0\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n**Describe the feature and the current behavior/state.**\r\nCurrently,  `TimeseriesGenerator` gets `data` and `target` as input and return a generator that can be used for iterating over a time-series with a sliding window.\r\n- If `row` is the current time-point,  then for each time-window of length `[row - self.length, ..., row`] , the  `target` is chosen as the`self.targets[row]`.  This means the `target` (label) for a time-window is chosen to be the last observed label.\r\n\r\nSometimes, this is not the right assumption. For example, consider this time-series and the related labels:\r\n```python\r\ndata    = [a,a,a,a,a,a,a,a,a,a,a,b,b,b,b,b,b,b,b,b,b,b,b,b,c,c,c,c,c,c,c,c]\r\ntarget =  [0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2]\r\n```\r\nIf we choose `length=8` and `stride=4`, then it generates these windows:\r\n```python\r\na,a,a,a,a,a,a,a >  0  (Good label!)\r\na,a,a,a,a,a,a,b >  1  (Bad label!)\r\na,a,a,b,b,b,b,b > 1 (Not Good label!)\r\nb,b,b,b,b,b,b,b > 1 (Good label!)\r\nb,b,b,b, c,c,c,c > 2 (Bad label!)\r\nc,c,c,c,c,c,c,c, > 2 (Good label!)\r\n```\r\nSo, as you see, if I use this method in training (e.g. for an activity recognition method based on accelerometer time-seires) then some windows will be labeled in a Not Good way!\r\n\r\n**There should be a feature to choose if we want this behavior or not!**\r\n\r\nThere are two ideas:\r\n1. to simply ignore these windows with an inconsistent label in the beginning and the end! I mean just jump over them until we get a window that label is same for all the time-points. like this:\r\n```python\r\ntargets = np.array([self.targets[row] for row in rows if self.targets[row - self.length] == self.targets[row]])\r\n```\r\n2. Using the `mode` of the target window as the label. like this:\r\n```python \r\ntargets = np.array([ max(set(self.targets[row - self.length:row:self.sampling_rate] ), key=list.count) for row in rows])\r\n```\r\n\r\n**Will this change the current api? How?**\r\nThere are two ways to handle this:\r\n1.  To add more options to the current `TimeseriesGenerator` that will change the current api for this class.\r\n2. To add another class and call it something like \"LabeledTimeseriesGenerator\" that extends the `TimeseriesGenerator` and overrides the `__getitem__` function.\r\n\r\n**Who will benefit with this feature?**\r\nPeople who use Tensorflow for training a classifier on labeled time-series of mobile and wearable sensors or using financial data time-series."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33564", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33564/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33564/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33564/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33564", "id": 509869474, "node_id": "MDU6SXNzdWU1MDk4Njk0NzQ=", "number": 33564, "title": "TFLite metal delegate can't share MTLDevice", "user": {"login": "stakemura", "id": 1152138, "node_id": "MDQ6VXNlcjExNTIxMzg=", "avatar_url": "https://avatars0.githubusercontent.com/u/1152138?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stakemura", "html_url": "https://github.com/stakemura", "followers_url": "https://api.github.com/users/stakemura/followers", "following_url": "https://api.github.com/users/stakemura/following{/other_user}", "gists_url": "https://api.github.com/users/stakemura/gists{/gist_id}", "starred_url": "https://api.github.com/users/stakemura/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stakemura/subscriptions", "organizations_url": "https://api.github.com/users/stakemura/orgs", "repos_url": "https://api.github.com/users/stakemura/repos", "events_url": "https://api.github.com/users/stakemura/events{/privacy}", "received_events_url": "https://api.github.com/users/stakemura/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-10-21T10:20:09Z", "updated_at": "2020-02-21T18:43:19Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using):master branch\r\n- Are you willing to contribute it (Yes/No):Yes\r\n\r\n**Describe the feature and the current behavior/state.**\r\nAs Apple [the official document](https://developer.apple.com/library/archive/documentation/3DDrawing/Conceptual/MTLBestPracticesGuide/PersistentObjects.html) mentioned, all apps should create only one MTLDevice object.\r\n\r\n> All apps should create only one MTLDevice object per GPU and reuse it for all your Metal work on that GPU. Most apps should create only one MTLCommandQueue object per GPU, though you may want more if each command queue represents different Metal work (for example, non-real-time compute processing and real-time graphics rendering)..\r\n\r\nHowever, the current TFLite implementation doesn't have the interface to share MTLDevice as [metal_delegate.mm](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/lite/delegates/gpu/metal_delegate.mm) shows.\r\n\r\n```mm\r\n  explicit Delegate(const TFLGpuDelegateOptions* options) {\r\n    if (options) {\r\n      options_ = *options;\r\n    } else {\r\n      // Default options.\r\n      options_.allow_precision_loss = false;\r\n      options_.wait_type = TFLGpuDelegateWaitType::TFLGpuDelegateWaitTypePassive;\r\n    }\r\n    metal_device_ = MTLCreateSystemDefaultDevice();\r\n```\r\nThis issue is critical for me since I should integrate TFLite into the existing metal application.\r\nWould you like to improve this initialization function?\r\nOne of my idea is that adds default MTLDevice parameter to TFLGpuDelegateOptions.\r\nIf you need, I will send PR.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33563", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33563/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33563/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33563/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33563", "id": 509844266, "node_id": "MDU6SXNzdWU1MDk4NDQyNjY=", "number": 33563, "title": "tf.io.GFIle not working correctly with UTF-8 files and Python3", "user": {"login": "cyfra", "id": 11492046, "node_id": "MDQ6VXNlcjExNDkyMDQ2", "avatar_url": "https://avatars1.githubusercontent.com/u/11492046?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cyfra", "html_url": "https://github.com/cyfra", "followers_url": "https://api.github.com/users/cyfra/followers", "following_url": "https://api.github.com/users/cyfra/following{/other_user}", "gists_url": "https://api.github.com/users/cyfra/gists{/gist_id}", "starred_url": "https://api.github.com/users/cyfra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cyfra/subscriptions", "organizations_url": "https://api.github.com/users/cyfra/orgs", "repos_url": "https://api.github.com/users/cyfra/repos", "events_url": "https://api.github.com/users/cyfra/events{/privacy}", "received_events_url": "https://api.github.com/users/cyfra/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-10-21T09:32:06Z", "updated_at": "2020-03-10T23:44:36Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu\r\n- TensorFlow installed from (source or binary): source internal Google\r\n- TensorFlow version (use command below): 1.5.0, internal Google\r\n- Python version: 3.6.7\r\n\r\n**Describe the current behavior**\r\nCalling 'read(X)' on the text files opened with GFile in python3 doesn't work properly (it fetches X bytes rather than X characters). This often results with the UnicodeDecodeError (as the read can happen in the middle of the unicode character).\r\n\r\n**Describe the expected behavior**\r\nIt should behave like python3: reading the X characters.\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n```python\r\nmy_text = 'B\u00e4ren'\r\nwith open('/tmp/ex1', 'w') as f:\r\n  f.write(my_text)\r\n\r\n// Will read the whole string correctly.\r\nwith open('/tmp/ex1', 'r') as f:\r\n  print(f.read())\r\n\r\n// This will print 2 chars Ba\r\nwith open('/tmp/ex1', 'r') as f:\r\n print(f.read(2))\r\n\r\n// This will print 3 chars: Bar\r\nwith open('/tmp/ex1', 'r') as f:\r\n print(f.read(3))\r\n\r\n// This will print the whole thing.\r\nwith tf.io.gfile.GFile('/tmp/ex1', 'r') as f:\r\n  print(f.read())\r\n\r\n// This will crash.. :-(\r\nwith tf.io.gfile.GFile('/tmp/ex1', 'r') as f:\r\n  print(f.read(2))\r\n```\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\nThe error will be:\r\n```\r\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 1: unexpected end of data\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33562", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33562/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33562/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33562/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33562", "id": 509810423, "node_id": "MDU6SXNzdWU1MDk4MTA0MjM=", "number": 33562, "title": "symbol \"_SaverDef_default_instance_\" becomes undefined after updating tensorflow from 1.2 to 1.12", "user": {"login": "RaymondReddington", "id": 15521126, "node_id": "MDQ6VXNlcjE1NTIxMTI2", "avatar_url": "https://avatars2.githubusercontent.com/u/15521126?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RaymondReddington", "html_url": "https://github.com/RaymondReddington", "followers_url": "https://api.github.com/users/RaymondReddington/followers", "following_url": "https://api.github.com/users/RaymondReddington/following{/other_user}", "gists_url": "https://api.github.com/users/RaymondReddington/gists{/gist_id}", "starred_url": "https://api.github.com/users/RaymondReddington/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RaymondReddington/subscriptions", "organizations_url": "https://api.github.com/users/RaymondReddington/orgs", "repos_url": "https://api.github.com/users/RaymondReddington/repos", "events_url": "https://api.github.com/users/RaymondReddington/events{/privacy}", "received_events_url": "https://api.github.com/users/RaymondReddington/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1162044565, "node_id": "MDU6TGFiZWwxMTYyMDQ0NTY1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.12", "name": "TF 1.12", "color": "c2e0c6", "default": false, "description": "Issues related to TF 1.12"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1205657510, "node_id": "MDU6TGFiZWwxMjA1NjU3NTEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:centos", "name": "subtype:centos", "color": "b619ea", "default": false, "description": "Centos Build/Installation issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-10-21T08:29:10Z", "updated_at": "2019-10-29T03:58:32Z", "closed_at": null, "author_association": "NONE", "body": "symbol \"_SaverDef_default_instance_\" becomes undefined after updating tensorflow from 1.2 to 1.12\r\n\r\nwhat dependency shoud i add to BUILD file?\r\n\r\n_SaverDef_default_instance_ is in cc file generated by tensorflow/core/framework/saver.proto in 1.2\r\n\r\nin 1.12, saver.proto is not compiled. has the target changed?\r\n\r\nthe dependency targets in BUILD are:\r\n       \"//tensorflow/cc:cc_ops\",\r\n        \"//tensorflow/cc:client_session\",\r\n        \"//tensorflow/core:tensorflow\"\r\n\r\n\r\n\r\nEnv Info:\r\ntensorflow:  HEAD detached at v1.12.1\r\n                    https://github.com/tensorflow/tensorflow.git\r\n\r\n```shell\r\ncommit c20310273f663b1dbf9ca9e68068784d44a95ae2\r\nMerge: cc494ee f303882\r\nAuthor: TensorFlower Gardener <gardener@tensorflow.org>\r\nDate:   Thu Apr 18 06:15:58 2019 -0700\r\n\r\n    Merge pull request #27699 from yongtang:27497-ragged-axis\r\n    \r\n    PiperOrigin-RevId: 244173513\r\n```\r\n\r\nbazel:  get from https://releases.bazel.build/0.25.0/rc3/index.html\r\n\r\nos: centos7 \r\nkernel: 3.10.107 \r\ngcc version 4.8.5 20150623 (Red Hat 4.8.5-4) (GCC)\r\ncpu:\r\n```shell\r\nArchitecture:          x86_64\r\nCPU op-mode(s):        32-bit, 64-bit\r\nByte Order:            Little Endian\r\nCPU(s):                8\r\nOn-line CPU(s) list:   0-7\r\nThread(s) per core:    1\r\nCore(s) per socket:    8\r\nSocket(s):             1\r\nNUMA node(s):          1\r\nVendor ID:             GenuineIntel\r\nCPU family:            6\r\nModel:                 94\r\nModel name:            Intel(R) Xeon(R) Gold 61xx CPU\r\nStepping:              3\r\nCPU MHz:               2494.140\r\nBogoMIPS:              4988.28\r\nHypervisor vendor:     KVM\r\nVirtualization type:   full\r\nL1d cache:             32K\r\nL1i cache:             32K\r\nL2 cache:              4096K\r\nNUMA node0 CPU(s):     0-7\r\n```\r\n\r\n\r\ndir structure: tensorflow-1.12(git root)/tensorflow/my_implement/BUILD\r\nBUILD file:\r\n```shell\r\ncc_binary(\r\n    name = \"libMyImplement.so\",\r\n    srcs = [\"my_implement.h\",\r\n            \"my_implement.cc\",\r\n            ],\r\n    linkshared = 1,\r\n    deps = [\r\n        \"//tensorflow/cc:cc_ops\",\r\n        \"//tensorflow/cc:client_session\",\r\n        \"//tensorflow/core:tensorflow\"\r\n        ],\r\n)\r\n```\r\n\r\n\r\n\r\n\r\nit reports symbol \"_SaverDef_default_instance_\" undefined while loading libMyImplement.so which compiled in v1.12.1\r\n\r\ni think maybe something i forget to add to deps list. or should i execute some ./configure command with any special parameter before compiling?\r\n\r\nthere is no errors loading libMyImplement.so compiled in tensorflow v1.2.0\r\n\r\nand i have tried compile libMyImplement.so in tensorflow v1.13, and there is still this error"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33557", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33557/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33557/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33557/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33557", "id": 509751550, "node_id": "MDU6SXNzdWU1MDk3NTE1NTA=", "number": 33557, "title": "Support for Mediapipe tflite ops.", "user": {"login": "SanthoshRajendiran", "id": 41156980, "node_id": "MDQ6VXNlcjQxMTU2OTgw", "avatar_url": "https://avatars3.githubusercontent.com/u/41156980?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SanthoshRajendiran", "html_url": "https://github.com/SanthoshRajendiran", "followers_url": "https://api.github.com/users/SanthoshRajendiran/followers", "following_url": "https://api.github.com/users/SanthoshRajendiran/following{/other_user}", "gists_url": "https://api.github.com/users/SanthoshRajendiran/gists{/gist_id}", "starred_url": "https://api.github.com/users/SanthoshRajendiran/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SanthoshRajendiran/subscriptions", "organizations_url": "https://api.github.com/users/SanthoshRajendiran/orgs", "repos_url": "https://api.github.com/users/SanthoshRajendiran/repos", "events_url": "https://api.github.com/users/SanthoshRajendiran/events{/privacy}", "received_events_url": "https://api.github.com/users/SanthoshRajendiran/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, {"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2019-10-21T06:11:35Z", "updated_at": "2020-01-11T10:39:53Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using): 2.0 \r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nMediapipe gives some custom implementation for few operators that can run only in Android GPU (Maxunpooling, Maxpoolingwithargmax2d, Convolution2dtransposebias). In tensorflow github repository, they have been mentioned as custom ops. But could not find out implementation for the same.Android GPU delegate does not run the model, and fails with error it is unresolved custom op.\r\n\r\n**Will this change the current api? How?**\r\nNo. It will be one another addition to the already existing operators in TFLite GPU delegate.\r\n\r\n**Who will benefit with this feature?**\r\nMediapipe, Tensorflow and Android researchers\r\n\r\n**Any Other info.**\r\nAttached with this is the sample hair segmentation TFLite, that they are using.\r\n\r\n[hair_segmentation.tflite.zip](https://github.com/tensorflow/tensorflow/files/3749221/hair_segmentation.tflite.zip)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33544", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33544/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33544/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33544/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33544", "id": 509588319, "node_id": "MDU6SXNzdWU1MDk1ODgzMTk=", "number": 33544, "title": "TF2.0 for compute capability 3.0", "user": {"login": "VitaMusic", "id": 12452501, "node_id": "MDQ6VXNlcjEyNDUyNTAx", "avatar_url": "https://avatars1.githubusercontent.com/u/12452501?v=4", "gravatar_id": "", "url": "https://api.github.com/users/VitaMusic", "html_url": "https://github.com/VitaMusic", "followers_url": "https://api.github.com/users/VitaMusic/followers", "following_url": "https://api.github.com/users/VitaMusic/following{/other_user}", "gists_url": "https://api.github.com/users/VitaMusic/gists{/gist_id}", "starred_url": "https://api.github.com/users/VitaMusic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/VitaMusic/subscriptions", "organizations_url": "https://api.github.com/users/VitaMusic/orgs", "repos_url": "https://api.github.com/users/VitaMusic/repos", "events_url": "https://api.github.com/users/VitaMusic/events{/privacy}", "received_events_url": "https://api.github.com/users/VitaMusic/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 27, "created_at": "2019-10-20T12:25:10Z", "updated_at": "2020-01-23T14:08:51Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): 2.0\r\n- Are you willing to contribute it (Yes/No): no\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nwould like to use TF2.0 gpu with old cards Geforce GTX 870m\r\n\r\n**Will this change the current api? How?**\r\nnon\r\n\r\n**Who will benefit with this feature?**\r\nall users with older gpu cards\r\n\r\n**Any Other info.**\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33534", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33534/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33534/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33534/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33534", "id": 509481739, "node_id": "MDU6SXNzdWU1MDk0ODE3Mzk=", "number": 33534, "title": "Finish making strided_slice equivalent to numpy's strided_slice", "user": {"login": "jbuckman", "id": 10989937, "node_id": "MDQ6VXNlcjEwOTg5OTM3", "avatar_url": "https://avatars3.githubusercontent.com/u/10989937?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jbuckman", "html_url": "https://github.com/jbuckman", "followers_url": "https://api.github.com/users/jbuckman/followers", "following_url": "https://api.github.com/users/jbuckman/following{/other_user}", "gists_url": "https://api.github.com/users/jbuckman/gists{/gist_id}", "starred_url": "https://api.github.com/users/jbuckman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jbuckman/subscriptions", "organizations_url": "https://api.github.com/users/jbuckman/orgs", "repos_url": "https://api.github.com/users/jbuckman/repos", "events_url": "https://api.github.com/users/jbuckman/events{/privacy}", "received_events_url": "https://api.github.com/users/jbuckman/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gadagashwini", "id": 48476109, "node_id": "MDQ6VXNlcjQ4NDc2MTA5", "avatar_url": "https://avatars3.githubusercontent.com/u/48476109?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gadagashwini", "html_url": "https://github.com/gadagashwini", "followers_url": "https://api.github.com/users/gadagashwini/followers", "following_url": "https://api.github.com/users/gadagashwini/following{/other_user}", "gists_url": "https://api.github.com/users/gadagashwini/gists{/gist_id}", "starred_url": "https://api.github.com/users/gadagashwini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gadagashwini/subscriptions", "organizations_url": "https://api.github.com/users/gadagashwini/orgs", "repos_url": "https://api.github.com/users/gadagashwini/repos", "events_url": "https://api.github.com/users/gadagashwini/events{/privacy}", "received_events_url": "https://api.github.com/users/gadagashwini/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gadagashwini", "id": 48476109, "node_id": "MDQ6VXNlcjQ4NDc2MTA5", "avatar_url": "https://avatars3.githubusercontent.com/u/48476109?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gadagashwini", "html_url": "https://github.com/gadagashwini", "followers_url": "https://api.github.com/users/gadagashwini/followers", "following_url": "https://api.github.com/users/gadagashwini/following{/other_user}", "gists_url": "https://api.github.com/users/gadagashwini/gists{/gist_id}", "starred_url": "https://api.github.com/users/gadagashwini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gadagashwini/subscriptions", "organizations_url": "https://api.github.com/users/gadagashwini/orgs", "repos_url": "https://api.github.com/users/gadagashwini/repos", "events_url": "https://api.github.com/users/gadagashwini/events{/privacy}", "received_events_url": "https://api.github.com/users/gadagashwini/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-10-19T17:12:07Z", "updated_at": "2019-10-22T10:13:38Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): 1.14\r\n- Are you willing to contribute it (Yes/No): No\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\nCurrently, Tensorflow uses a slicing syntax very similar to Numpy's: for example, x[...,:,0:-4] would work equivalently in both TF and Numpy. However, more advanced indexing does not work; for example, trying to use [this approach](https://matthewmcgonagle.github.io/blog/2017/10/13/SelectingSubsquaresWithNumpyIndexing) to get sub-squares from a Tensorflow tensor does not work, and in fact as far as I can tell, clever advanced indexing like this is currently impossible. As a researcher, I'm often trying to do somewhat non-standard things, and I've encountered these indexing issues several times. With TF reaching maturity, it would be good to have these advanced indexing features implemented so that slicing is fully on-par with Numpy.\r\n\r\n**Will this change the current api? How?**\r\n\r\nNo, it will integrate seamlessly, simply providing more functionality.\r\n\r\n**Who will benefit with this feature?**\r\n\r\nMost advanced users of Tensorflow (especially researchers) will get a lot of benefit from this.\r\n\r\n**Any Other info.**\r\n\r\nNumpy has already implemented this, so it shouldn't be too difficult to port that code to TF."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33531", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33531/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33531/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33531/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33531", "id": 509454271, "node_id": "MDU6SXNzdWU1MDk0NTQyNzE=", "number": 33531, "title": "MultiWorkerMirroredStrategy does not work with Keras + accuracy metric", "user": {"login": "vmarkovtsev", "id": 2793551, "node_id": "MDQ6VXNlcjI3OTM1NTE=", "avatar_url": "https://avatars3.githubusercontent.com/u/2793551?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vmarkovtsev", "html_url": "https://github.com/vmarkovtsev", "followers_url": "https://api.github.com/users/vmarkovtsev/followers", "following_url": "https://api.github.com/users/vmarkovtsev/following{/other_user}", "gists_url": "https://api.github.com/users/vmarkovtsev/gists{/gist_id}", "starred_url": "https://api.github.com/users/vmarkovtsev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vmarkovtsev/subscriptions", "organizations_url": "https://api.github.com/users/vmarkovtsev/orgs", "repos_url": "https://api.github.com/users/vmarkovtsev/repos", "events_url": "https://api.github.com/users/vmarkovtsev/events{/privacy}", "received_events_url": "https://api.github.com/users/vmarkovtsev/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rmothukuru", "id": 48206667, "node_id": "MDQ6VXNlcjQ4MjA2NjY3", "avatar_url": "https://avatars3.githubusercontent.com/u/48206667?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmothukuru", "html_url": "https://github.com/rmothukuru", "followers_url": "https://api.github.com/users/rmothukuru/followers", "following_url": "https://api.github.com/users/rmothukuru/following{/other_user}", "gists_url": "https://api.github.com/users/rmothukuru/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmothukuru/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmothukuru/subscriptions", "organizations_url": "https://api.github.com/users/rmothukuru/orgs", "repos_url": "https://api.github.com/users/rmothukuru/repos", "events_url": "https://api.github.com/users/rmothukuru/events{/privacy}", "received_events_url": "https://api.github.com/users/rmothukuru/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rmothukuru", "id": 48206667, "node_id": "MDQ6VXNlcjQ4MjA2NjY3", "avatar_url": "https://avatars3.githubusercontent.com/u/48206667?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmothukuru", "html_url": "https://github.com/rmothukuru", "followers_url": "https://api.github.com/users/rmothukuru/followers", "following_url": "https://api.github.com/users/rmothukuru/following{/other_user}", "gists_url": "https://api.github.com/users/rmothukuru/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmothukuru/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmothukuru/subscriptions", "organizations_url": "https://api.github.com/users/rmothukuru/orgs", "repos_url": "https://api.github.com/users/rmothukuru/repos", "events_url": "https://api.github.com/users/rmothukuru/events{/privacy}", "received_events_url": "https://api.github.com/users/rmothukuru/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-10-19T13:48:42Z", "updated_at": "2020-01-23T16:48:55Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\nThe same environment as in https://github.com/tensorflow/tensorflow/issues/32654\r\nBut with 2 machines instead of 1 **and** Tensorflow 2.0 release from PyPi.\r\n\r\n**Describe the current behavior**\r\n\r\nI am training DenseNet121 on Imagenet with standard Keras code and custom dataset pipeline. `model.compile` is called with the only \"accuracy\" metric. I am using `MultiWorkerMirroredStrategy` as described in the tutorial. Here is the log. I had to erase ~7,000 warnings which are all the same: `2019-10-19 12:23:10.615259: W tensorflow/core/framework/op_kernel.cc:309] OpKernelContext is tracking allocations but they are not being consumed by the StepStatsCollector.`\r\n\r\n```\r\nCompiling with RMSprop\r\nFitting...\r\nWARNING:tensorflow:`eval_fn` is not passed in. The `worker_fn` will be used if an \"evaluator\" task exists in the cluster.\r\n`eval_fn` is not passed in. The `worker_fn` will be used if an \"evaluator\" task exists in the cluster.\r\nWARNING:tensorflow:`eval_strategy` is not passed in. No distribution strategy will be used for evaluation.\r\n`eval_strategy` is not passed in. No distribution strategy will be used for evaluation.\r\n2019-10-19 03:57:05.813768: W tensorflow/core/grappler/optimizers/data/auto_shard.cc:400] Cannot find shardable dataset, adding a shard node at the end of the dataset instead. This may have performance implications.\r\n2019-10-19 03:57:19.342401: W tensorflow/core/grappler/optimizers/data/auto_shard.cc:400] Cannot find shardable dataset, adding a shard node at the end of the dataset instead. This may have performance implications.\r\n2019-10-19 03:59:48.236258: I tensorflow/core/grappler/optimizers/scoped_allocator_optimizer.cc:316] Abandoning ScopedAllocatorOptimizer because input FusedBatchNormGradV3_99 output 1 is already assigned to scope_id 132\r\n2019-10-19 03:59:48.236611: W tensorflow/core/grappler/optimizers/scoped_allocator_optimizer.cc:381] error: Internal: Abandoning ScopedAllocatorOptimizer because input FusedBatchNormGradV3_99 output 1 is already assigned to scope_id 132\r\n2019-10-19 03:59:48.236834: W tensorflow/core/grappler/optimizers/scoped_allocator_optimizer.cc:990] error: Internal: Abandoning ScopedAllocatorOptimizer because input FusedBatchNormGradV3_99 output 1 is already assigned to scope_id 132\r\n2019-10-19 03:59:48.237468: E tensorflow/core/grappler/optimizers/scoped_allocator_optimizer.cc:1007] ScopedAllocatorOptimizer: Internal: Abandoning ScopedAllocatorOptimizer because input FusedBatchNormGradV3_99 output 1 is already assigned to scope_id 132\r\n2019-10-19 03:59:48.237593: W tensorflow/core/grappler/optimizers/scoped_allocator_optimizer.cc:782] error: Internal: Abandoning ScopedAllocatorOptimizer because input FusedBatchNormGradV3_99 output 1 is already assigned to scope_id 132\r\n2019-10-19 03:59:48.299255: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:502] scoped_allocator_optimizer failed: Internal: Abandoning ScopedAllocatorOptimizer because input FusedBatchNormGradV3_99 output 1 is already assigned to scope_id 132\r\n2019-10-19 04:00:01.523007: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0\r\n2019-10-19 04:00:11.506609: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7\r\n2019-10-19 04:00:19.689077: W tensorflow/stream_executor/cuda/redzone_allocator.cc:312] Not found: ./bin/ptxas not found\r\nRelying on driver to perform ptx compilation. This message will be only logged once.\r\n2019-10-19 04:00:29.848332: I tensorflow/core/profiler/lib/profiler_session.cc:184] Profiler session started.\r\n2019-10-19 04:00:29.848931: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcupti.so.10.0'; dlerror: libcupti.so.10.0: cannot open shared object file: No such file or directory\r\n2019-10-19 04:00:29.849025: W tensorflow/core/profiler/lib/profiler_session.cc:192] Encountered error while starting profiler: Unavailable: CUPTI error: CUPTI could not be loaded or symbol could not be found.\r\nTrain for 15974.0 steps\r\n\r\nEpoch 00001: LearningRateScheduler reducing learning rate to 0.0009375.\r\nEpoch 1/400\r\n2019-10-19 04:00:34.268294: I tensorflow/core/platform/default/device_tracer.cc:588] Collecting 0 kernel records, 0 memcpy records.\r\n2019-10-19 04:00:34.314465: E tensorflow/core/platform/default/device_tracer.cc:70] CUPTI error: CUPTI could not be loaded or symbol could not be found.\r\n15973/15974 [============================>.] - ETA: 1s - loss: 8.3656 - accuracy: 0.01342019-10-19 12:14:21.634609: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Out of range: End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n2019-10-19 12:14:21.635077: E tensorflow/core/common_runtime/ring_alg.cc:279] Aborting RingReduce with Out of range: [_Derived_]End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n2019-10-19 12:14:21.635164: E tensorflow/core/common_runtime/ring_alg.cc:279] Aborting RingReduce with Out of range: [_Derived_]End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n2019-10-19 12:14:21.635253: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Out of range: End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[replica_3/metrics/accuracy/AssignAddVariableOp_1/_55]]\r\n2019-10-19 12:14:21.635336: E tensorflow/core/common_runtime/ring_alg.cc:279] Aborting RingReduce with Cancelled: [_Derived_]Cancelled\r\nAdditional GRPC error information:\r\n{\"created\":\"@1571487261.635191370\",\"description\":\"Error received from peer\",\"file\":\"external/grpc/src/core/lib/surface/call.cc\",\"file_line\":1039,\"grpc_message\":\"Cancelled\",\"grpc_status\":1}\r\n2019-10-19 12:14:21.635412: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Out of range: [_Derived_]End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n2019-10-19 12:14:21.635529: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Out of range: [_Derived_]End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n2019-10-19 12:14:21.635680: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Out of range: End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[replica_3/metrics/accuracy/AssignAddVariableOp_1/_43]]\r\n2019-10-19 12:14:21.635764: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Cancelled: [_Derived_]Cancelled\r\nAdditional GRPC error information:\r\n{\"created\":\"@1571487261.635191370\",\"description\":\"Error received from peer\",\"file\":\"external/grpc/src/core/lib/surface/call.cc\",\"file_line\":1039,\"grpc_message\":\"Cancelled\",\"grpc_status\":1}\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n2019-10-19 12:14:21.635930: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Out of range: End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[replica_1/metrics/accuracy/AssignAddVariableOp_1/_63]]\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\nAdditional GRPC error information:\r\n{\"created\":\"@1571487261.635191370\",\"description\":\"Error received from peer\",\"file\":\"external/grpc/src/core/lib/surface/call.cc\",\"file_line\":1039,\"grpc_message\":\"Cancelled\",\"grpc_status\":1}\r\n2019-10-19 12:14:21.636135: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Out of range: End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n2019-10-19 12:14:23.196391: E tensorflow/core/common_runtime/ring_alg.cc:279] Aborting RingReduce with Out of range: [_Derived_]End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n2019-10-19 12:14:23.196583: E tensorflow/core/common_runtime/ring_alg.cc:279] Aborting RingReduce with Out of range: [_Derived_]End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n2019-10-19 12:14:23.196683: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Out of range: [_Derived_]End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n2019-10-19 12:14:23.196964: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Out of range: [_Derived_]End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n2019-10-19 12:14:23.197197: E tensorflow/core/common_runtime/ring_alg.cc:279] Aborting RingReduce with Out of range: [_Derived_]End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n2019-10-19 12:14:23.197232: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Out of range: [_Derived_]End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n\t [[CollectiveReduce_3]]\r\n\t [[CollectiveReduce_1/_16]]\r\n2019-10-19 12:14:23.197283: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Out of range: [_Derived_]End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n\t [[CollectiveReduce_2]]\r\n2019-10-19 12:14:23.197353: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Out of range: [_Derived_]End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n\t [[CollectiveReduce_3]]\r\n\t [[CollectiveReduce/ReadVariableOp/_18]]\r\n2019-10-19 12:14:23.197395: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Out of range: [_Derived_]End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n2019-10-19 12:14:23.197460: E tensorflow/core/common_runtime/ring_alg.cc:279] Aborting RingReduce with Out of range: [_Derived_]End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n2019-10-19 12:14:23.197507: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Out of range: [_Derived_]End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n\t [[CollectiveReduce_3]]\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n2019-10-19 12:14:23.197742: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Out of range: [_Derived_]End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n2019-10-19 12:14:23.197870: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Out of range: [_Derived_]End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n\t [[CollectiveReduce_1]]\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 668, in on_start\r\n    yield\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 372, in fit\r\n    prefix='val_')\r\n  File \"/usr/lib/python3.6/contextlib.py\", line 88, in __exit__\r\n    next(self.gen)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 685, in on_epoch\r\n    self.callbacks.on_epoch_end(epoch, epoch_logs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/callbacks.py\", line 298, in on_epoch_end\r\n    callback.on_epoch_end(epoch, logs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/callbacks.py\", line 963, in on_epoch_end\r\n    self._save_model(epoch=epoch, logs=logs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/callbacks.py\", line 1001, in _save_model\r\n    self.model.save(filepath, overwrite=True)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/network.py\", line 975, in save\r\n    signatures, options)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/save.py\", line 112, in save_model\r\n    model, filepath, overwrite, include_optimizer)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/hdf5_format.py\", line 109, in save_model_to_hdf5\r\n    save_weights_to_hdf5_group(model_weights_group, model_layers)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/saving/hdf5_format.py\", line 627, in save_weights_to_hdf5_group\r\n    weight_values = K.batch_get_value(weights)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/backend.py\", line 3296, in batch_get_value\r\n    return [x.numpy() for x in tensors]\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/backend.py\", line 3296, in <listcomp>\r\n    return [x.numpy() for x in tensors]\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/values.py\", line 389, in __getattr__\r\n    return getattr(self.get(), name)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/values.py\", line 322, in get\r\n    return self._get_cross_replica()\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/values.py\", line 1237, in _get_cross_replica\r\n    self, axis=None)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/distribute_lib.py\", line 805, in reduce\r\n    return self._extended._reduce(reduce_op, value)  # pylint: disable=protected-access\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/distribute_lib.py\", line 1436, in _reduce\r\n    device_util.current() or \"/device:CPU:0\"))[0]\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/collective_all_reduce_strategy.py\", line 490, in _reduce_to\r\n    reduce_op, value, destinations=destinations)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/cross_device_ops.py\", line 282, in reduce\r\n    destinations)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/cross_device_ops.py\", line 1025, in reduce_implementation\r\n    all_reduced = self._batch_all_reduce(reduce_op, [per_replica_value])[0]\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/cross_device_ops.py\", line 1091, in _batch_all_reduce\r\n    dense_results = self._do_batch_all_reduce_dense(reduce_op, dense_values)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/cross_device_ops.py\", line 1120, in _do_batch_all_reduce_dense\r\n    \"Id\")\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/cross_device_utils.py\", line 365, in build_collective_reduce\r\n    return collective_all_reduce()\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/eager/def_function.py\", line 457, in __call__\r\n    result = self._call(*args, **kwds)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/eager/def_function.py\", line 526, in _call\r\n    return self._concrete_stateful_fn._filtered_call(canon_args, canon_kwds)  # pylint: disable=protected-access\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/eager/function.py\", line 1141, in _filtered_call\r\n    self.captured_inputs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/eager/function.py\", line 1224, in _call_flat\r\n    ctx, args, cancellation_manager=cancellation_manager)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/eager/function.py\", line 511, in call\r\n    ctx=ctx)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/eager/execute.py\", line 67, in quick_execute\r\n    six.raise_from(core._status_to_exception(e.code, message), None)\r\n  File \"<string>\", line 3, in raise_from\r\ntensorflow.python.framework.errors_impl.OutOfRangeError:  [_Derived_]End of sequence\r\n\t [[{{node IteratorGetNext_3}}]]\r\n\t [[GroupCrossDeviceControlEdges_1/metrics/accuracy/div_no_nan/_127]]\r\n\t [[CollectiveReduce_2]] [Op:__inference_collective_all_reduce_2894985]\r\n\r\nFunction call stack:\r\ncollective_all_reduce\r\n\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.6/runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"/usr/lib/python3.6/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/user/vmarkovtsev/images/efficientoffice/efficientoffice/__main__.py\", line 5, in <module>\r\n    sys.exit(main())\r\n  File \"/user/vmarkovtsev/images/efficientoffice/efficientoffice/main.py\", line 221, in main\r\n    callbacks=[tensorboard_callback, checkpoint_callback, scheduler])\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training.py\", line 728, in fit\r\n    use_multiprocessing=use_multiprocessing)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_distributed.py\", line 789, in fit\r\n    *args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_distributed.py\", line 776, in wrapper\r\n    mode=dc.CoordinatorMode.INDEPENDENT_WORKER)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/distribute_coordinator.py\", line 853, in run_distribute_coordinator\r\n    task_id, session_config, rpc_layer)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/distribute_coordinator.py\", line 360, in _run_single_worker\r\n    return worker_fn(strategy)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_distributed.py\", line 771, in _worker_fn\r\n    return method(model, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 372, in fit\r\n    prefix='val_')\r\n  File \"/usr/lib/python3.6/contextlib.py\", line 99, in __exit__\r\n    self.gen.throw(type, value, traceback)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 671, in on_start\r\n    self.callbacks._call_end_hook(mode)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/callbacks.py\", line 258, in _call_end_hook\r\n    self.on_train_end()\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/callbacks.py\", line 375, in on_train_end\r\n    callback.on_train_end(logs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/callbacks.py\", line 940, in on_train_end\r\n    self._training_state.delete_backup()\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/distribute/multi_worker_training_state.py\", line 161, in delete_backup\r\n    tracking.AutoTrackable.__delattr__(self._model, CKPT_SAVED_EPOCH)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/training/tracking/tracking.py\", line 94, in __delattr__\r\n    super(AutoTrackable, self).__delattr__(name)\r\nAttributeError: _ckpt_saved_epoch\r\n\r\nEpoch 00001: loss improved from inf to 8.36576, saving model to model/DenseNet121-0001-8.366.hdf5\r\n2019-10-19 12:14:33.567096: W tensorflow/core/common_runtime/eager/context.cc:290] Unable to destroy server_ object, so releasing instead. Servers don't support clean shutdown.\r\n```\r\n\r\n**Describe the expected behavior**\r\n\r\nThe expected behavior is a successful epoch ending.\r\n\r\n**Code to reproduce the issue**\r\n\r\n```python\r\n#!/usr/bin/env python3\r\nimport sys\r\nimport tensorflow as tf\r\n# Otherwise nothing works, and it really sucks, but is declared in the docs\r\nmulti_worker_strategy = tf.distribute.experimental.MultiWorkerMirroredStrategy()\r\n\r\ndef main():\r\n    batch_size = 12\r\n    features_shape = 372, 558, 3\r\n    labels = 10\r\n    sample = tf.random.uniform(features_shape)\r\n\r\n    def with_shape(t, shape):\r\n        t = tf.squeeze(t)\r\n        t.set_shape(shape)\r\n        return t\r\n\r\n    ds_train = tf.data.Dataset.from_tensors([sample]).map(lambda s: (s, tf.ones((labels,)))) \\\r\n        .repeat().batch(batch_size).map(lambda s, l: (with_shape(s, (batch_size,) + features_shape),\r\n                                                      with_shape(l, (batch_size, labels))))\r\n    ds_val = tf.data.Dataset.from_tensors([sample]).map(lambda s: (s, tf.ones((labels,)))) \\\r\n        .repeat().batch(batch_size).take(10).map(\r\n        lambda s, l: (with_shape(s, (batch_size,) + features_shape), with_shape(l, (batch_size, labels))))\r\n    with multi_worker_strategy.scope():\r\n        model = tf.keras.applications.DenseNet121(\r\n            weights=None, input_shape=features_shape, classes=labels)\r\n        model.build((batch_size,) + features_shape)\r\n        model.summary()\r\n        optimizer = tf.keras.optimizers.RMSprop(learning_rate=0.001)\r\n        cross_entropy = tf.keras.losses.CategoricalCrossentropy(label_smoothing=0.1)\r\n        model.compile(optimizer=optimizer, loss=cross_entropy, metrics=[\"accuracy\"])\r\n    model.fit(ds_train, validation_data=ds_val, epochs=1, steps_per_epoch=100)\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    sys.exit(main())\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33527", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33527/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33527/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33527/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33527", "id": 509416195, "node_id": "MDU6SXNzdWU1MDk0MTYxOTU=", "number": 33527, "title": "Custom tf.keras.Model memory footprint drastically affects performance", "user": {"login": "schmiflo", "id": 8803950, "node_id": "MDQ6VXNlcjg4MDM5NTA=", "avatar_url": "https://avatars1.githubusercontent.com/u/8803950?v=4", "gravatar_id": "", "url": "https://api.github.com/users/schmiflo", "html_url": "https://github.com/schmiflo", "followers_url": "https://api.github.com/users/schmiflo/followers", "following_url": "https://api.github.com/users/schmiflo/following{/other_user}", "gists_url": "https://api.github.com/users/schmiflo/gists{/gist_id}", "starred_url": "https://api.github.com/users/schmiflo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/schmiflo/subscriptions", "organizations_url": "https://api.github.com/users/schmiflo/orgs", "repos_url": "https://api.github.com/users/schmiflo/repos", "events_url": "https://api.github.com/users/schmiflo/events{/privacy}", "received_events_url": "https://api.github.com/users/schmiflo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "qlzh727", "id": 5118881, "node_id": "MDQ6VXNlcjUxMTg4ODE=", "avatar_url": "https://avatars3.githubusercontent.com/u/5118881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qlzh727", "html_url": "https://github.com/qlzh727", "followers_url": "https://api.github.com/users/qlzh727/followers", "following_url": "https://api.github.com/users/qlzh727/following{/other_user}", "gists_url": "https://api.github.com/users/qlzh727/gists{/gist_id}", "starred_url": "https://api.github.com/users/qlzh727/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qlzh727/subscriptions", "organizations_url": "https://api.github.com/users/qlzh727/orgs", "repos_url": "https://api.github.com/users/qlzh727/repos", "events_url": "https://api.github.com/users/qlzh727/events{/privacy}", "received_events_url": "https://api.github.com/users/qlzh727/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "qlzh727", "id": 5118881, "node_id": "MDQ6VXNlcjUxMTg4ODE=", "avatar_url": "https://avatars3.githubusercontent.com/u/5118881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qlzh727", "html_url": "https://github.com/qlzh727", "followers_url": "https://api.github.com/users/qlzh727/followers", "following_url": "https://api.github.com/users/qlzh727/following{/other_user}", "gists_url": "https://api.github.com/users/qlzh727/gists{/gist_id}", "starred_url": "https://api.github.com/users/qlzh727/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qlzh727/subscriptions", "organizations_url": "https://api.github.com/users/qlzh727/orgs", "repos_url": "https://api.github.com/users/qlzh727/repos", "events_url": "https://api.github.com/users/qlzh727/events{/privacy}", "received_events_url": "https://api.github.com/users/qlzh727/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-10-19T08:26:47Z", "updated_at": "2019-10-22T12:48:20Z", "closed_at": null, "author_association": "NONE", "body": "\r\n**System information**\r\n16.04.6 LTS\r\nPython 3.5.2\r\nGPU TITAN X (Pascal) 13GB\r\n\r\n**Describe the current behavior**\r\n\r\nThe memory footprint of a custom tf.keras.Model object affects training performance by almost two orders of magnitude.\r\n\r\n\r\n**Code to reproduce the issue**\r\n\r\nThe following is a stripped-down implementation of an RNN for text data loosely resembling the one in the [Effective Tensorflow 2.0 Tutorial](https://www.tensorflow.org/guide/effective_tf2)\r\n\r\n```ruby\r\nclass DynamicRNN(tf.keras.Model): \r\n\r\n  def __init__(self, state_size, embedding_size, vocab_size, something):\r\n    super(DynamicRNN, self).__init__(self)\r\n\r\n    self.state_size = state_size\r\n    self.embedding_size = embedding_size\r\n    self.vocab_size = vocab_size\r\n    self.something = something\r\n\r\n    # The internal GRU\r\n    self.cell = tf.keras.layers.GRUCell(state_size)\r\n    \r\n    # Input embedding and softmax parameters\r\n    emb_initializer = tf.initializers.RandomUniform(-0.5, 0.5)\r\n    self.emb = tf.Variable(emb_initializer(shape=[self.vocab_size, self.embedding_size]), name=\"emb\")\r\n    softmax_w_initializer = tf.initializers.GlorotUniform()\r\n    self.softmax_w = tf.Variable(softmax_w_initializer(shape=[self.vocab_size, self.state_size]), name=\"softmax_w\")\r\n    self.softmax_b = tf.Variable(tf.zeros([self.vocab_size]), name=\"softmax_b\")\r\n\r\n\r\n  @tf.function\r\n  def _step(self, last_state, last_symbol):\r\n    # Embed last symbol\r\n    last_symbol_emb = tf.nn.embedding_lookup(self.emb, last_symbol)\r\n    \r\n    # Compute new state\r\n    _, state = self.cell(last_symbol_emb, [last_state], training=False)\r\n    state = state[0]\r\n \r\n    # Predict new symbol\r\n    logits = tf.matmul(state, self.softmax_w, transpose_b=True) + self.softmax_b\r\n\r\n    return state, logits\r\n  \r\n\r\n  @tf.function\r\n  def __call__(self, inputs):\r\n    batch_size, L = tf.shape(inputs)[0], tf.shape(inputs)[1]\r\n\r\n    last_state = self.cell.get_initial_state(batch_size=batch_size, dtype=tf.float32)\r\n    last_symbol = tf.fill([batch_size], 0)\r\n\r\n    # One loss term per time-step\r\n    total_loss = 0.0\r\n    for i in tf.range(L):\r\n      last_state, logits = self._step(last_state, last_symbol)\r\n      last_symbol = inputs[:, i]\r\n  \r\n      batch_loss = tf.nn.sparse_softmax_cross_entropy_with_logits(logits=logits, labels=inputs[:,i])\r\n      total_loss += tf.reduce_mean(batch_loss)\r\n      \r\n    total_loss /= tf.cast(L, tf.float32)\r\n\r\n    return total_loss\r\n```\r\n\r\nTo rule out one culprit, the `TensorArray`s have been removed. Clearly, an efficient model would not perform embedding and loss computation in every step but that's not relevant here.\r\n\r\nTo perform training I use a standard tensorflow 2.0 loop (with dummy input for simplicity)\r\n\r\n```python\r\n# Parameters\r\nbatch_size = 64\r\nvocab_size = 30000\r\nseq_length = 28\r\n\r\n# Model\r\nsomething = {str(i) : i for i in range(400000)}\r\nrnn = DynamicRNN(512, 100, vocab_size, something)\r\n# Optimizer\r\noptimizer = tf.keras.optimizers.Adam(learning_rate=0.001, clipvalue=0.5)\r\n\r\n# Dummy input\r\nseq = tf.ones([batch_size, seq_length], dtype=tf.int32)\r\n\r\n# Training loop\r\nfor step in tqdm.tqdm(range(100000)):\r\n  with tf.GradientTape() as tape:\r\n    loss = rnn(seq)\r\n  grads = tape.gradient(loss, rnn.trainable_variables)\r\n  optimizer.apply_gradients(zip(grads, rnn.trainable_variables))\r\n```\r\n\r\nThe crucial part here is the `something` object which is passed to the model. Note that the object is never used inside the model, hence we can also pass `None` instead.\r\n\r\nMy point is that the training performance on GPU and CPU is significantly degraded when the relatively memory costly  `something` object is passed instead of `None`. Precisely, I get a slowdown from 0.13s/it to 7.7s/it on the GPU and 2s/it to 9s/it on the CPU. Utilization drops from ~65% to %5 on the GPU and from 800% to 300% (24 cores available) on the cpu.\r\n\r\nThe above makes me suspicious that the model is being copied in *every* training step. I found this behavior nowhere documented. Is it? Also note that such an `something` dictionary is entirely realistic if what you do is NLP and you need to carry your vocabulary around. If that object is being used internally, a more efficient alternative might be to pass it as a function argument, instead of storing it internally."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33526", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33526/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33526/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33526/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33526", "id": 509403245, "node_id": "MDU6SXNzdWU1MDk0MDMyNDU=", "number": 33526, "title": "Error while trying to use tf.broadcast_weights ", "user": {"login": "MeghnaNatraj", "id": 8790823, "node_id": "MDQ6VXNlcjg3OTA4MjM=", "avatar_url": "https://avatars0.githubusercontent.com/u/8790823?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MeghnaNatraj", "html_url": "https://github.com/MeghnaNatraj", "followers_url": "https://api.github.com/users/MeghnaNatraj/followers", "following_url": "https://api.github.com/users/MeghnaNatraj/following{/other_user}", "gists_url": "https://api.github.com/users/MeghnaNatraj/gists{/gist_id}", "starred_url": "https://api.github.com/users/MeghnaNatraj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MeghnaNatraj/subscriptions", "organizations_url": "https://api.github.com/users/MeghnaNatraj/orgs", "repos_url": "https://api.github.com/users/MeghnaNatraj/repos", "events_url": "https://api.github.com/users/MeghnaNatraj/events{/privacy}", "received_events_url": "https://api.github.com/users/MeghnaNatraj/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-10-19T06:22:11Z", "updated_at": "2020-02-06T16:38:30Z", "closed_at": null, "author_association": "MEMBER", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux (Google Colab)\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: Google Colab\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 2.0\r\n- Python version: 3.x\r\n- Bazel version (if compiling from source): -\r\n- GCC/Compiler version (if compiling from source): -\r\n- CUDA/cuDNN version: -\r\n- GPU model and memory: - \r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nUnable to import tf.broadcast_weights in TF 2.0. \r\n\r\n**Describe the expected behavior**\r\nShould be able to import tf.broadcast_weights in TF 2.0\r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\nMethod 1: Plain python + TF 2.0\r\n```\r\nimport tensorflow as tf     # version 2.0\r\ntf.broadcast_weights\r\n```\r\n_throws_ ** AttributeError: module 'tensorflow' has no attribute 'broadcast_weights'**\r\n\r\nMethod 2: Codelab\r\nI found this error in a recent TF 2.0 + Keras tutorial - https://colab.sandbox.google.com/drive/1UCJt8EYjlzCs1H1d1X0iDGYJsHKwu-NO\r\n\r\n- Search for \"broadcast_weights\" in this codelab. \r\n- Run all cells before this.\r\n- Modify code \"m.update_state([0, 1, 1, 1], [0, 1, 0, 0])\" to \"m.update_state([0, 1, 1, 1], [0, 1, 0, 0]), sample_weight=[0.1,0.2,0.3,0.4]\"\r\n- Run this cell\r\n- throws AttributeError: module 'tensorflow' has no attribute 'broadcast_weights'\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33524", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33524/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33524/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33524/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/33524", "id": 509357511, "node_id": "MDExOlB1bGxSZXF1ZXN0MzI5OTU5OTg5", "number": 33524, "title": "Suspected fix for progressive slowdown when training", "user": {"login": "Loca123", "id": 13148657, "node_id": "MDQ6VXNlcjEzMTQ4NjU3", "avatar_url": "https://avatars0.githubusercontent.com/u/13148657?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Loca123", "html_url": "https://github.com/Loca123", "followers_url": "https://api.github.com/users/Loca123/followers", "following_url": "https://api.github.com/users/Loca123/following{/other_user}", "gists_url": "https://api.github.com/users/Loca123/gists{/gist_id}", "starred_url": "https://api.github.com/users/Loca123/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Loca123/subscriptions", "organizations_url": "https://api.github.com/users/Loca123/orgs", "repos_url": "https://api.github.com/users/Loca123/repos", "events_url": "https://api.github.com/users/Loca123/events{/privacy}", "received_events_url": "https://api.github.com/users/Loca123/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1169364259, "node_id": "MDU6TGFiZWwxMTY5MzY0MjU5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:XS", "name": "size:XS", "color": "adafea", "default": false, "description": "CL Change Size: Extra Small"}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 12, "created_at": "2019-10-18T23:53:20Z", "updated_at": "2020-03-05T06:14:36Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/33524", "html_url": "https://github.com/tensorflow/tensorflow/pull/33524", "diff_url": "https://github.com/tensorflow/tensorflow/pull/33524.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/33524.patch"}, "body": "When training on multiple GPUs, with a validation dataset, I have been seeing a significant reduction in training speed after each epoch. When validation epochs are sufficiently frequent, this is very detremental. This does not present when running on a single GPU with the validation set, or when running on multiple GPUs without the validation set.\r\n\r\nThe graph below shows a toy example to exascerbate the problem for illustration, but this occurs in a much larger network that was taking around a week to train on a single GPU. After 24 hours, with a high validation frequency, the system had effectively stopped training. I've spent several days logging times and plotting graphs on different hardware, operating systems, versions of tensorflow and with different networks and datasets and this is what I have narrowed it down to. It also appears to have an exponential nature, initially it can look like quite a steady increase in training time, but some of the tests that I ran showed, a rapid increase in time beyond a certain point.\r\n\r\n![image](https://user-images.githubusercontent.com/13148657/67134089-1a838d80-f208-11e9-9540-f47cd142a852.png)\r\n\r\nHere's another graph. This shows Ubuntu with 4xGPUs on Amazon, 1 GPU on a local Windows machine and 2 GPUs on a local WIndows machine. Running TF 1.14 installed from pip. The issue is present in TF 1.15 too.\r\n\r\n![image](https://user-images.githubusercontent.com/13148657/67134473-36882e80-f20a-11e9-9f73-e00c0962b1b0.png)\r\n \r\n\r\nIt appears to me, looking through the code that the condition around the iterator reset for the validation set should be the same as the one for the training data set further down. Though I am not 100% sure if this is this.\r\n\r\n\r\nScript for reproducing the issue:\r\n```\r\n\r\nimport tensorflow as tf\r\nimport tensorflow.keras.backend as K\r\nfrom tensorflow.keras import Sequential\r\nfrom tensorflow.keras.layers import Conv2D, Flatten, Dense\r\nimport tensorflow.keras.losses as losses\r\nfrom tensorflow.keras.optimizers import Adam\r\nimport numpy as np\r\n\r\ndef CreateModel():\r\n  model = Sequential()\r\n  model.add(Conv2D(filters=32, kernel_size=3, name='images', activation='relu', kernel_initializer='glorot_normal', input_shape=(39, 39, 3)))\r\n  model.add(Flatten())\r\n  model.add(Dense(10, bias_initializer='zeros', kernel_initializer='glorot_normal'))\r\n\r\n  return model\r\n\r\ndef generatorFunction():\r\n  while 1:\r\n    s = (39, 39, 3)\r\n    z = np.zeros(s, dtype=np.float64)\r\n\r\n    zo = np.zeros(10, dtype=np.float64)\r\n    yield z, zo\r\n\r\ndef RunScript():\r\n  # Setup session options\r\n  config = tf.ConfigProto()\r\n\r\n  if tf.test.is_gpu_available():\r\n    config.gpu_options.allow_growth = True\r\n\r\n  session = tf.Session(config=config)\r\n  session.run(tf.global_variables_initializer())\r\n  K.set_session(session)\r\n\r\n  # Setup strategy\r\n  cross_device_ops = tf.distribute.ReductionToOneDevice(reduce_to_device='/device:CPU:0')\r\n  mirrored_strategy = tf.distribute.MirroredStrategy(cross_device_ops=cross_device_ops)\r\n\r\n  # Setup data\r\n  trainingDataPrepped = tf.data.Dataset.from_generator(\r\n    generatorFunction,\r\n    output_types=(tf.float32, tf.float32),\r\n    output_shapes=((39,39,3), (10))).batch(32)\r\n\r\n  vDataPrepped = tf.data.Dataset.from_generator(\r\n    generatorFunction,\r\n    output_types=(tf.float32, tf.float32),\r\n    output_shapes=((39,39,3), (10))).batch(32)\r\n\r\n  # Create and train model\r\n  with mirrored_strategy.scope():\r\n    model = CreateModel()\r\n    lossType = losses.mean_squared_error\r\n    model.compile(optimizer=Adam(), loss=lossType)\r\n\r\n\r\n    model.fit(trainingDataPrepped,\r\n              validation_data=vDataPrepped,\r\n              validation_steps=1,\r\n              epochs=3000,\r\n              shuffle=True,\r\n              steps_per_epoch=1)\r\n\r\nif __name__ == \"__main__\":\r\n  RunScript()\r\n\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33515", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33515/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33515/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33515/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33515", "id": 509189336, "node_id": "MDU6SXNzdWU1MDkxODkzMzY=", "number": 33515, "title": "tf.lite operators missing for `tf.nn.ctc_loss`: `Empty`, `InplaceAdd` and `While`", "user": {"login": "BeWe11", "id": 14355528, "node_id": "MDQ6VXNlcjE0MzU1NTI4", "avatar_url": "https://avatars0.githubusercontent.com/u/14355528?v=4", "gravatar_id": "", "url": "https://api.github.com/users/BeWe11", "html_url": "https://github.com/BeWe11", "followers_url": "https://api.github.com/users/BeWe11/followers", "following_url": "https://api.github.com/users/BeWe11/following{/other_user}", "gists_url": "https://api.github.com/users/BeWe11/gists{/gist_id}", "starred_url": "https://api.github.com/users/BeWe11/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/BeWe11/subscriptions", "organizations_url": "https://api.github.com/users/BeWe11/orgs", "repos_url": "https://api.github.com/users/BeWe11/repos", "events_url": "https://api.github.com/users/BeWe11/events{/privacy}", "received_events_url": "https://api.github.com/users/BeWe11/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-10-18T16:36:44Z", "updated_at": "2019-11-05T16:44:50Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): macOS 10.14.6\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (or github SHA if from source): 2.0.0\r\n\r\n\r\n**Provide the text output from tflite_convert**\r\n\r\n```\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime and are not recognized by TensorFlow. If you have a custom implementation for them you can disable this error with --allow_custom_o\r\nps, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: ADD, CAST, CONCATENATION, CONV_2D, DIV, EXP, EXPAND_DIMS, FLOOR_DIV, FULLY_CONNECTED, GATHER,\r\n LESS, LOG, LOG_SOFTMAX, MAXIMUM, MAX_POOL_2D, MEAN, MUL, NEG, ONE_HOT, PACK, PAD, PADV2, RANGE, RESHAPE, SHAPE, SPLIT_V, SQRT, SQUARE, SQUEEZE, STRIDED_SLICE, SUB, SUM, TILE, TRANSPOSE. Here is a list of operators for which\r\n you will need custom implementations: Empty, InplaceAdd, While.\r\nTraceback (most recent call last):\r\n  File \"/Users/ben/miniconda3/envs/wakeword/bin/toco_from_protos\", line 10, in <module>\r\n    sys.exit(main())\r\n  File \"/Users/ben/miniconda3/envs/wakeword/lib/python3.6/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 89, in main                                                                                \r\n    app.run(main=execute, argv=[sys.argv[0]] + unparsed)\r\n  File \"/Users/ben/miniconda3/envs/wakeword/lib/python3.6/site-packages/tensorflow_core/python/platform/app.py\", line 40, in run                                                                                               \r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/Users/ben/miniconda3/envs/wakeword/lib/python3.6/site-packages/absl/app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"/Users/ben/miniconda3/envs/wakeword/lib/python3.6/site-packages/absl/app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/Users/ben/miniconda3/envs/wakeword/lib/python3.6/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 52, in execute                                                                             \r\n    enable_mlir_converter)\r\nException: We are continually in the process of adding support to TensorFlow Lite for more ops. It would be helpful if you could inform us of how this conversion went by opening a github issue at https://github.com/tensorflo\r\nw/tensorflow/issues/new?template=40-tflite-op-request.md\r\n and pasting the following:\r\n\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime and are not recognized by TensorFlow. If you have a custom implementation for them you can disable this error with --allow_custom_o\r\nps, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: ADD, CAST, CONCATENATION, CONV_2D, DIV, EXP, EXPAND_DIMS, FLOOR_DIV, FULLY_CONNECTED, GATHER,\r\n LESS, LOG, LOG_SOFTMAX, MAXIMUM, MAX_POOL_2D, MEAN, MUL, NEG, ONE_HOT, PACK, PAD, PADV2, RANGE, RESHAPE, SHAPE, SPLIT_V, SQRT, SQUARE, SQUEEZE, STRIDED_SLICE, SUB, SUM, TILE, TRANSPOSE. Here is a list of operators for which\r\n you will need custom implementations: Empty, InplaceAdd, While.\r\n```\r\n\r\n**Any other info / logs**\r\n\r\nI'm trying to convert a keras model using tf.lite. The last layer of the model uses the `tf.nn.ctc_loss` in its `call` method. When I leave this layer off the model, the conversion works just fine.\r\n\r\nApparantly, only three operators are missing from making this work: `Empty`, `InplaceAdd` and `While`.\r\n\r\nThe error message also says this:\r\n```\r\n2019-10-18 18:19:25.694843: W tensorflow/lite/toco/tflite/operator.cc:2692] Op Empty is a valid TensorFlow op but has not been whitelisted for the TensorFlow Lite flex op set.                                                 \r\n2019-10-18 18:19:25.694848: W tensorflow/lite/toco/tflite/operator.cc:2692] Op InplaceAdd is a valid TensorFlow op but has not been whitelisted for the TensorFlow Lite flex op set.                                            \r\n2019-10-18 18:19:25.694852: W tensorflow/lite/toco/tflite/operator.cc:2692] Op While is a valid TensorFlow op but has not been whitelisted for the TensorFlow Lite flex op set. \r\n```\r\nDoes this mean that the only thing missing from making this work is to somehow add these operators to the whitelist? Is this something that users can do? How are the chances that these operators are going to be included in tf.lite by default in the near feature?\r\n\r\nThanks!"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33513", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33513/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33513/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33513/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33513", "id": 509096937, "node_id": "MDU6SXNzdWU1MDkwOTY5Mzc=", "number": 33513, "title": "Cannot build libtensorflowlite_c.so -- problem with bazel build", "user": {"login": "lordalcol", "id": 12187615, "node_id": "MDQ6VXNlcjEyMTg3NjE1", "avatar_url": "https://avatars2.githubusercontent.com/u/12187615?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lordalcol", "html_url": "https://github.com/lordalcol", "followers_url": "https://api.github.com/users/lordalcol/followers", "following_url": "https://api.github.com/users/lordalcol/following{/other_user}", "gists_url": "https://api.github.com/users/lordalcol/gists{/gist_id}", "starred_url": "https://api.github.com/users/lordalcol/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lordalcol/subscriptions", "organizations_url": "https://api.github.com/users/lordalcol/orgs", "repos_url": "https://api.github.com/users/lordalcol/repos", "events_url": "https://api.github.com/users/lordalcol/events{/privacy}", "received_events_url": "https://api.github.com/users/lordalcol/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-10-18T13:55:06Z", "updated_at": "2019-11-07T17:06:36Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Windows 10 64-bit\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version: v2.0.0\r\n- Python version: 3.7.4\r\n- Installed using virtualenv? pip? conda?:\r\n- Bazel version (if compiling from source): v1.0.0\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\n**Describe the problem**\r\n\r\nI am trying to build libtensorflowlite_c.so following the instructions at https://github.com/tensorflow/tensorflow/blob/master/tensorflow/lite/experimental/examples/unity/TensorFlowLitePlugin/README.md but the build is failing the the following log.\r\n\r\n**Any other info / logs**\r\nFirst run log:\r\n```\r\nC:\\Users\\Lorenzo\\Documents\\tensorflow>bazel build -c opt --cxxopt=--std=c++11 \\\r\nINFO: Writing tracer profile to 'C:/users/lorenzo/_bazel_lorenzo/6xammqtc/command.profile.gz'\r\nINFO: Options provided by the client:\r\n  Inherited 'common' options: --isatty=1 --terminal_columns=172\r\nINFO: Options provided by the client:\r\n  'build' options: --python_path=C:/Users/Lorenzo/AppData/Local/Programs/Python/Python37/python.exe\r\nINFO: Reading rc options for 'build' from c:\\users\\lorenzo\\documents\\tensorflow\\.bazelrc:\r\n  'build' options: --apple_platform_type=macos --define framework_shared_object=true --define open_source_build=true --java_toolchain=//third_party/toolchains/java:tf_java_toolchain --host_java_toolchain=//third_party/toolchains/java:tf_java_toolchain --define=use_fast_cpp_protos=true --define=allow_oversize_protos=true --spawn_strategy=standalone --strategy=Genrule=standalone -c opt --cxxopt=-std=c++14 --host_cxxopt=-std=c++14 --announce_rc --define=grpc_no_ares=true --define=PREFIX=/usr --define=LIBDIR=$(PREFIX)/lib --define=INCLUDEDIR=$(PREFIX)/include --config=v2\r\nINFO: Found applicable config definition build:v2 in file c:\\users\\lorenzo\\documents\\tensorflow\\.bazelrc: --define=tf_api_version=2\r\nWARNING: Download from https://storage.googleapis.com/mirror.tensorflow.org/github.com/bazelbuild/bazel-toolchains/archive/92dd8a7a518a2fb7ba992d47c8b38299fe0be825.tar.gz failed: class com.google.devtools.build.lib.bazel.repository.downloader.UnrecoverableHttpException GET returned 404 Not Found\r\nDEBUG: Rule 'io_bazel_rules_docker' indicated that a canonical reproducible form can be obtained by modifying arguments shallow_since = \"1556410077 -0400\"\r\nDEBUG: Call stack for the definition of repository 'io_bazel_rules_docker' which is a git_repository (rule definition at C:/users/lorenzo/_bazel_lorenzo/6xammqtc/external/bazel_tools/tools/build_defs/repo/git.bzl:195:18):\r\n - C:/users/lorenzo/_bazel_lorenzo/6xammqtc/external/bazel_toolchains/repositories/repositories.bzl:37:9\r\n - C:/users/lorenzo/documents/tensorflow/WORKSPACE:37:1\r\nERROR: Skipping '\\': Bad target pattern '\\': package names may contain A-Z, a-z, 0-9, or any of ' !\"#$%&'()*+,-./;<=>?[]^_`{|}~' (most 7-bit ascii characters except 0-31, 127, ':', or '\\')\r\nWARNING: Target pattern parsing failed.\r\nERROR: Bad target pattern '\\': package names may contain A-Z, a-z, 0-9, or any of ' !\"#$%&'()*+,-./;<=>?[]^_`{|}~' (most 7-bit ascii characters except 0-31, 127, ':', or '\\')\r\nINFO: Elapsed time: 0.139s\r\nINFO: 0 processes.\r\nFAILED: Build did NOT complete successfully (0 packages loaded)\r\n```\r\n\r\nSecond run log:\r\n```\r\nC:\\Users\\Lorenzo\\Documents\\tensorflow>bazel build -c opt --cxxopt=--std=c++11 //tensorflow/lite/experimental/c:libtensorflowlite_c.so\r\nINFO: Writing tracer profile to 'C:/users/lorenzo/_bazel_lorenzo/6xammqtc/command.profile.gz'\r\nINFO: Options provided by the client:\r\n  Inherited 'common' options: --isatty=1 --terminal_columns=172\r\nINFO: Options provided by the client:\r\n  'build' options: --python_path=C:/Users/Lorenzo/AppData/Local/Programs/Python/Python37/python.exe\r\nINFO: Reading rc options for 'build' from c:\\users\\lorenzo\\documents\\tensorflow\\.bazelrc:\r\n  'build' options: --apple_platform_type=macos --define framework_shared_object=true --define open_source_build=true --define=use_fast_cpp_protos=true --define=allow_oversize_protos=true --spawn_strategy=standalone --strategy=Genrule=standalone -c opt --announce_rc --define=grpc_no_ares=true --define=PREFIX=/usr --define=LIBDIR=$(PREFIX)/lib --define=INCLUDEDIR=$(PREFIX)/include --config=v2\r\nINFO: Found applicable config definition build:v2 in file c:\\users\\lorenzo\\documents\\tensorflow\\.bazelrc: --define=tf_api_version=2\r\nINFO: Build options --cxxopt, --host_cxxopt, --host_java_toolchain, and 1 more have changed, discarding analysis cache.\r\nINFO: Call stack for the definition of repository 'com_google_protobuf' which is a tf_http_archive (rule definition at C:/users/lorenzo/documents/tensorflow/third_party/repo.bzl:124:19):\r\n - C:/users/lorenzo/documents/tensorflow/tensorflow/workspace.bzl:432:5\r\n - C:/users/lorenzo/documents/tensorflow/WORKSPACE:19:1\r\nINFO: Repository 'com_google_protobuf' used the following cache hits instead of downloading the corresponding file.\r\n * Hash 'b9e92f9af8819bbbc514e2902aec860415b70209f31dfc8c4fa72515a5df9d59' for https://storage.googleapis.com/mirror.tensorflow.org/github.com/protocolbuffers/protobuf/archive/310ba5ee72661c081129eb878c1bbcec936b20f0.tar.gz\r\nIf the definition of 'com_google_protobuf' was updated, verify that the hashes were also updated.\r\nERROR: An error occurred during the fetch of repository 'com_google_protobuf':\r\n   Traceback (most recent call last):\r\n        File \"C:/users/lorenzo/documents/tensorflow/third_party/repo.bzl\", line 104\r\n                _apply_patch(ctx, ctx.attr.patch_file)\r\n        File \"C:/users/lorenzo/documents/tensorflow/third_party/repo.bzl\", line 70, in _apply_patch\r\n                _wrap_bash_cmd(ctx, patch_command)\r\n        File \"C:/users/lorenzo/documents/tensorflow/third_party/repo.bzl\", line 28, in _wrap_bash_cmd\r\n                fail(\"BAZEL_SH environment variable i...\")\r\nBAZEL_SH environment variable is not set\r\nERROR: Analysis of target '//tensorflow/lite/experimental/c:libtensorflowlite_c.so' failed; build aborted: no such package '@com_google_protobuf//': Traceback (most recent call last):\r\n        File \"C:/users/lorenzo/documents/tensorflow/third_party/repo.bzl\", line 104\r\n                _apply_patch(ctx, ctx.attr.patch_file)\r\n        File \"C:/users/lorenzo/documents/tensorflow/third_party/repo.bzl\", line 70, in _apply_patch\r\n                _wrap_bash_cmd(ctx, patch_command)\r\n        File \"C:/users/lorenzo/documents/tensorflow/third_party/repo.bzl\", line 28, in _wrap_bash_cmd\r\n                fail(\"BAZEL_SH environment variable i...\")\r\nBAZEL_SH environment variable is not set\r\nINFO: Elapsed time: 4.906s\r\nINFO: 0 processes.\r\nFAILED: Build did NOT complete successfully (1 packages loaded, 0 targets configured)\r\n    currently loading: tensorflow\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33511", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33511/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33511/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33511/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33511", "id": 509073419, "node_id": "MDU6SXNzdWU1MDkwNzM0MTk=", "number": 33511, "title": "Using GPU for Tflite on Android", "user": {"login": "ArtyomMashkin", "id": 35456423, "node_id": "MDQ6VXNlcjM1NDU2NDIz", "avatar_url": "https://avatars0.githubusercontent.com/u/35456423?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ArtyomMashkin", "html_url": "https://github.com/ArtyomMashkin", "followers_url": "https://api.github.com/users/ArtyomMashkin/followers", "following_url": "https://api.github.com/users/ArtyomMashkin/following{/other_user}", "gists_url": "https://api.github.com/users/ArtyomMashkin/gists{/gist_id}", "starred_url": "https://api.github.com/users/ArtyomMashkin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ArtyomMashkin/subscriptions", "organizations_url": "https://api.github.com/users/ArtyomMashkin/orgs", "repos_url": "https://api.github.com/users/ArtyomMashkin/repos", "events_url": "https://api.github.com/users/ArtyomMashkin/events{/privacy}", "received_events_url": "https://api.github.com/users/ArtyomMashkin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 13, "created_at": "2019-10-18T13:15:34Z", "updated_at": "2019-12-11T12:04:43Z", "closed_at": null, "author_association": "NONE", "body": "My first problem was it this post #33011  So for now I have code which works according to answers from the previousl post.  \r\n                float[] masked = coreResult.getMasked();\r\n                float[] inverted = coreResult.getInverted();\r\n\r\n                byteBufferMasked.asFloatBuffer().put(masked);\r\n                byteBufferInverted.asFloatBuffer().put(inverted);\r\n                Object[] inputs = new Object[]{byteBufferMasked, byteBufferInverted};\r\n                Map<Integer, Object> outputs = new HashMap();\r\n                outputs.put(0, byteBufferOutput);\r\n\r\n                interpreter.runForMultipleInputsOutputs(inputs, outputs);\r\n\r\n                byteBufferOutput.rewind();\r\n                byteBufferOutput.asFloatBuffer().get(output);\r\n                initializeSecond(coreRequest, output);\r\n                interpreter.close();\r\noutput is resulf float array and method initializeSecond() make the bitmap from this array.\r\nThis code takes about 16-20 sec.And almost all this time is working of the model in the following line:\r\n                interpreter.runForMultipleInputsOutputs(inputs, outputs);\r\nI have added some threads through: \r\n               new Interpreter.Options().setNumThreads(4)\r\nAnd now it works faster in 2 times(interesting thing - if I put for example 4 threads or 20 threads - result the same). And this results are only for strong phones, for old models - it is about 20 sec after adding threads.(without it - about 35 sec)\r\nSo it  I am trying to add GPU delegate supporting for my Interpreter. According to Tflite docs from here https://www.tensorflow.org/lite/performance/gpu_advanced I am trying the following\r\n                GpuDelegate delegateGPU = new GpuDelegate();\r\n                interpreter = new Interpreter(map,  new \r\n                Interpreter.Options().addDelegate(delegateGPU).setNumThreads(4));\r\nAnd result is the same.(But in the demo from docs it is enough for GPU supporting) And the one thing that I did not do - adding OpenGL Shader (SSBO). And the main my problem I can not completry understant how I can implement it for my case. First of all I have two inputs and one output.  The code from tflite GPU demo is about getting bitmap from camera, in my case I already have the two inputs as images. I have seens in the docs that we can do it for only inputs or for only outputs, right? \r\nIf yes I do not know maybe in my case it will be better for output considering that I have two inputs. Also if I run  runForMultipleInputsOutputs(inputs, null); I will have the exception about null parameter. \r\nAnd only now I understand that method interpreter.runInference(null, outputArray); from GPU docs is from Tflite demo. And I think it is not so good for understanding. Also if I should do it for output I can not understand what is means the method from GPU docs : renderOutputSsbo(outputSsboId); There is not this function in the demo."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33501", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33501/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33501/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33501/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33501", "id": 508948449, "node_id": "MDU6SXNzdWU1MDg5NDg0NDk=", "number": 33501, "title": "tf.keras.applications download path should be made configurable.", "user": {"login": "indranaut", "id": 54289924, "node_id": "MDQ6VXNlcjU0Mjg5OTI0", "avatar_url": "https://avatars0.githubusercontent.com/u/54289924?v=4", "gravatar_id": "", "url": "https://api.github.com/users/indranaut", "html_url": "https://github.com/indranaut", "followers_url": "https://api.github.com/users/indranaut/followers", "following_url": "https://api.github.com/users/indranaut/following{/other_user}", "gists_url": "https://api.github.com/users/indranaut/gists{/gist_id}", "starred_url": "https://api.github.com/users/indranaut/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/indranaut/subscriptions", "organizations_url": "https://api.github.com/users/indranaut/orgs", "repos_url": "https://api.github.com/users/indranaut/repos", "events_url": "https://api.github.com/users/indranaut/events{/privacy}", "received_events_url": "https://api.github.com/users/indranaut/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-10-18T09:01:07Z", "updated_at": "2019-10-23T06:39:22Z", "closed_at": null, "author_association": "NONE", "body": "The download path for the models downloaded using tf.keras.applications seems to be hardcoded to `~/.keras/models`.  \r\nThis path should be made configurable. \r\nIt will benefit people who have less storage space in their home folder, which is a feature in many large-scale computational clusters."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33498", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33498/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33498/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33498/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33498", "id": 508891516, "node_id": "MDU6SXNzdWU1MDg4OTE1MTY=", "number": 33498, "title": "TFLite slower than Keras on RPi 4", "user": {"login": "JesperChristensen89", "id": 15313473, "node_id": "MDQ6VXNlcjE1MzEzNDcz", "avatar_url": "https://avatars1.githubusercontent.com/u/15313473?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JesperChristensen89", "html_url": "https://github.com/JesperChristensen89", "followers_url": "https://api.github.com/users/JesperChristensen89/followers", "following_url": "https://api.github.com/users/JesperChristensen89/following{/other_user}", "gists_url": "https://api.github.com/users/JesperChristensen89/gists{/gist_id}", "starred_url": "https://api.github.com/users/JesperChristensen89/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JesperChristensen89/subscriptions", "organizations_url": "https://api.github.com/users/JesperChristensen89/orgs", "repos_url": "https://api.github.com/users/JesperChristensen89/repos", "events_url": "https://api.github.com/users/JesperChristensen89/events{/privacy}", "received_events_url": "https://api.github.com/users/JesperChristensen89/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, {"login": "terryheo", "id": 2908505, "node_id": "MDQ6VXNlcjI5MDg1MDU=", "avatar_url": "https://avatars2.githubusercontent.com/u/2908505?v=4", "gravatar_id": "", "url": "https://api.github.com/users/terryheo", "html_url": "https://github.com/terryheo", "followers_url": "https://api.github.com/users/terryheo/followers", "following_url": "https://api.github.com/users/terryheo/following{/other_user}", "gists_url": "https://api.github.com/users/terryheo/gists{/gist_id}", "starred_url": "https://api.github.com/users/terryheo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/terryheo/subscriptions", "organizations_url": "https://api.github.com/users/terryheo/orgs", "repos_url": "https://api.github.com/users/terryheo/repos", "events_url": "https://api.github.com/users/terryheo/events{/privacy}", "received_events_url": "https://api.github.com/users/terryheo/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-10-18T06:57:07Z", "updated_at": "2020-02-27T01:01:58Z", "closed_at": null, "author_association": "NONE", "body": "When doing inference on a Raspberry Pi 4 with Keras and Tensorflow installed using `pip`, the inference time is slower using TFLite. \r\n\r\nThe initial Keras model is about 20 mb - after converting it to TFLite it is about 2.4 mb. During inference the Keras model processes a sample in about 50 ms and TFLite does it in about 80 ms. \r\n\r\nInitially the pip-installed version of Tensorflow caused errors with TFLite, so I installed TFLite-runtime using this information: https://www.tensorflow.org/lite/guide/python\r\n\r\n\r\n\r\nDuring inference in TFLite I use the following snippet:\r\n```python\r\ninterpreter = tflite.Interpreter(model_path=CHECKPOINT)\r\ninterpreter.allocate_tensors()\r\n\r\ninput_index = interpreter.get_input_details()[0][\"index\"]\r\noutput_index = interpreter.get_output_details()[0][\"index\"]\r\n\r\nfor im in images:\r\n\tt = time.time()\r\n\t\r\n\tinp = np.expand_dims(np.expand_dims(im,-1),0)\r\n\r\n\tinterpreter.set_tensor(input_index, inp)\r\n\tinterpreter.invoke()\r\n\t\r\n\tpredictions = interpreter.get_tensor(output_index)\r\n\r\n\tprint(\"Time: {}\".format(time.time()-t),end=\"\\r\")\r\n```\r\n\r\nDoes anybody have any experience with TFLite on Raspberry Pi? Am I missing something in order accelerate inference further? It seems wrong that inference should be faster in Keras with 10x model size."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33494", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33494/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33494/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33494/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33494", "id": 508844748, "node_id": "MDU6SXNzdWU1MDg4NDQ3NDg=", "number": 33494, "title": "CTC tensorflow lite conversion problem", "user": {"login": "tulasiram58827", "id": 27290902, "node_id": "MDQ6VXNlcjI3MjkwOTAy", "avatar_url": "https://avatars1.githubusercontent.com/u/27290902?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tulasiram58827", "html_url": "https://github.com/tulasiram58827", "followers_url": "https://api.github.com/users/tulasiram58827/followers", "following_url": "https://api.github.com/users/tulasiram58827/following{/other_user}", "gists_url": "https://api.github.com/users/tulasiram58827/gists{/gist_id}", "starred_url": "https://api.github.com/users/tulasiram58827/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tulasiram58827/subscriptions", "organizations_url": "https://api.github.com/users/tulasiram58827/orgs", "repos_url": "https://api.github.com/users/tulasiram58827/repos", "events_url": "https://api.github.com/users/tulasiram58827/events{/privacy}", "received_events_url": "https://api.github.com/users/tulasiram58827/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-10-18T04:17:38Z", "updated_at": "2020-02-05T06:52:34Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):Ubuntu 19.04\r\n- TensorFlow installed from (source or binary):binary\r\n- TensorFlow version (or github SHA if from source): 2.0\r\n\r\n\r\n**Provide the text output from tflite_convert**\r\n```\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime and are not recognized by TensorFlow. If you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: . Here is a list of operators for which you will need custom implementations: CTC_BEAM_SEARCH_DECODER.```\r\n\r\nAlso, please include a link to a GraphDef or the model if possible.\r\nimport tensorflow as tf\r\nclass BasicModel(tf.Module):\r\n  def __init__(self):\r\n    self.const = None\r\n  @tf.function(input_signature=[tf.TensorSpec(shape=[None,500,28], dtype=tf.float32),tf.TensorSpec(shape=[None,], dtype=tf.int32)])\r\n  def decoder(self, logits,seq_len):\r\n    decoded, log_prob = tf.nn.ctc_beam_search_decoder(logits, seq_len)\r\n    return decoded\r\n# Create the tf.Module object.\r\nroot = BasicModel()\r\n# Get the concrete function.\r\nconcrete_func = root.decoder.get_concrete_function()\r\nconverter = tf.lite.TFLiteConverter.from_concrete_functions([concrete_func])\r\nconverter.allow_custom_ops = False\r\nconverter.target_spec.supported_ops = [tf.lite.OpsSet.TFLITE_BUILTINS,tf.lite.OpsSet.SELECT_TF_OPS]\r\ntflite_model =converter.convert()\r\n\r\nopen(\"ctc_greedy_decoder.tflite\",'wb').write(tflite_model)\r\n\r\n**Any other info / logs**\r\n\r\nBut according to this link https://github.com/tensorflow/tensorflow/tree/r2.0/tensorflow/lite/experimental/kernels ctc_beam_search_decoder is registered as tflite op.\r\n\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33491", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33491/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33491/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33491/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33491", "id": 508812493, "node_id": "MDU6SXNzdWU1MDg4MTI0OTM=", "number": 33491, "title": "[TF2.0.0]ValueError: The two structures don't have the same nested structure.", "user": {"login": "yxleung", "id": 1773899, "node_id": "MDQ6VXNlcjE3NzM4OTk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1773899?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yxleung", "html_url": "https://github.com/yxleung", "followers_url": "https://api.github.com/users/yxleung/followers", "following_url": "https://api.github.com/users/yxleung/following{/other_user}", "gists_url": "https://api.github.com/users/yxleung/gists{/gist_id}", "starred_url": "https://api.github.com/users/yxleung/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yxleung/subscriptions", "organizations_url": "https://api.github.com/users/yxleung/orgs", "repos_url": "https://api.github.com/users/yxleung/repos", "events_url": "https://api.github.com/users/yxleung/events{/privacy}", "received_events_url": "https://api.github.com/users/yxleung/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2019-10-18T02:09:38Z", "updated_at": "2020-03-19T06:34:23Z", "closed_at": null, "author_association": "NONE", "body": "I can run my code in tensorflow==2.0.0b1, but when I update tensorflow to 2.0.0; I got an error;\r\nThis is my code:\r\n```python\r\nimport tensorflow as tf\r\nfrom tensorflow import feature_column\r\n\r\nprint('tf version:', tf.__version__)\r\n\r\nfeature_description = {\r\n    'h_k_u_watchanch_his': tf.io.VarLenFeature(tf.string),\r\n    'a_gender': tf.io.FixedLenFeature(shape=(1,), dtype=tf.int64),\r\n    'l_label': tf.io.FixedLenFeature([], tf.int64)\r\n}\r\nfeature_columns = []\r\nthal = feature_column.categorical_column_with_hash_bucket(\r\n    'h_k_u_watchanch_his', hash_bucket_size=100\r\n)\r\nthal_one_hot = feature_column.embedding_column(thal, dimension=10, combiner='mean')\r\nfeature_columns.append(thal_one_hot)\r\n\r\ndataSet = tf.data.TFRecordDataset(\r\n    \"/Users/lyx/projects/recommend/embedding/tmp/PUSH.TFRecords/dt=20191012/hour=10/part-r-00000\")\r\n\r\n\r\ndef _parse_function(serilized_example):\r\n    feature = tf.io.parse_single_example(\r\n        serilized_example,\r\n        feature_description\r\n    )\r\n    label = feature.get('l_label')\r\n    return feature, label\r\n\r\n\r\nparsed_dataset = dataSet.map(_parse_function)\r\n\r\ninput1 = tf.keras.Input(shape=(), name='h_k_u_watchanch_his', sparse=True, dtype=tf.string)\r\ninput2 = tf.keras.Input(shape=(), name='a_gender', dtype=tf.int64)\r\n\r\ninput_layers = {'h_k_u_watchanch_his': input1, 'a_gender': input2}\r\nfeature_layer = tf.keras.layers.DenseFeatures(feature_columns, name='DenseFeatures')(input_layers)\r\noutputs = tf.keras.layers.Dense(1, activation='sigmoid')(feature_layer)\r\nmodel = tf.keras.Model(inputs=[input1, input2], outputs=outputs)\r\n\r\nmodel.compile(\r\n    optimizer='adam',\r\n    loss='binary_crossentropy',\r\n    metrics=['accuracy']\r\n)\r\n\r\nmodel.fit(\r\n    x=parsed_dataset,\r\n    validation_data=parsed_dataset,\r\n    epochs=5,\r\n)\r\n\r\nloss, accuracy = model.evaluate(parsed_dataset)\r\nprint(\"Accuracy\", accuracy)\r\n```\r\n\r\nError output:\r\n```\r\ntf version: 2.0.0\r\n2019-10-18 09:59:10.095365: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2019-10-18 09:59:10.118556: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fbcd9c21e00 executing computations on platform Host. Devices:\r\n2019-10-18 09:59:10.118572: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.7/site-packages/tensorflow_core/python/util/nest.py\", line 318, in assert_same_structure\r\n    expand_composites)\r\nValueError: The two structures don't have the same nested structure.\r\n\r\nFirst structure: type=TensorSpec str=TensorSpec(shape=(1,), dtype=tf.int64, name=None)\r\n\r\nSecond structure: type=SparseTensor str=SparseTensor(indices=Tensor(\"h_k_u_watchanch_his/indices:0\", shape=(None, 1), dtype=int64), values=Tensor(\"h_k_u_watchanch_his/values:0\", shape=(None,), dtype=string), dense_shape=Tensor(\"h_k_u_watchanch_his/shape:0\", shape=(1,), dtype=int64))\r\n\r\nMore specifically: Substructure \"type=SparseTensor str=SparseTensor(indices=Tensor(\"h_k_u_watchanch_his/indices:0\", shape=(None, 1), dtype=int64), values=Tensor(\"h_k_u_watchanch_his/values:0\", shape=(None,), dtype=string), dense_shape=Tensor(\"h_k_u_watchanch_his/shape:0\", shape=(1,), dtype=int64))\" is a sequence, while substructure \"type=TensorSpec str=TensorSpec(shape=(1,), dtype=tf.int64, name=None)\" is not\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/Users/lyx/projects/recommend/embedding/tmp/test.py\", line 52, in <module>\r\n    epochs=5,\r\n  File \"/usr/local/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py\", line 728, in fit\r\n    use_multiprocessing=use_multiprocessing)\r\n  File \"/usr/local/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 224, in fit\r\n    distribution_strategy=strategy)\r\n  File \"/usr/local/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 547, in _process_training_inputs\r\n    use_multiprocessing=use_multiprocessing)\r\n  File \"/usr/local/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training_v2.py\", line 594, in _process_inputs\r\n    steps=steps)\r\n  File \"/usr/local/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/training.py\", line 2497, in _standardize_user_data\r\n    nest.assert_same_structure(a, b, expand_composites=True)\r\n  File \"/usr/local/lib/python3.7/site-packages/tensorflow_core/python/util/nest.py\", line 325, in assert_same_structure\r\n    % (str(e), str1, str2))\r\nValueError: The two structures don't have the same nested structure.\r\n\r\nFirst structure: type=TensorSpec str=TensorSpec(shape=(1,), dtype=tf.int64, name=None)\r\n\r\nSecond structure: type=SparseTensor str=SparseTensor(indices=Tensor(\"h_k_u_watchanch_his/indices:0\", shape=(None, 1), dtype=int64), values=Tensor(\"h_k_u_watchanch_his/values:0\", shape=(None,), dtype=string), dense_shape=Tensor(\"h_k_u_watchanch_his/shape:0\", shape=(1,), dtype=int64))\r\n\r\nMore specifically: Substructure \"type=SparseTensor str=SparseTensor(indices=Tensor(\"h_k_u_watchanch_his/indices:0\", shape=(None, 1), dtype=int64), values=Tensor(\"h_k_u_watchanch_his/values:0\", shape=(None,), dtype=string), dense_shape=Tensor(\"h_k_u_watchanch_his/shape:0\", shape=(1,), dtype=int64))\" is a sequence, while substructure \"type=TensorSpec str=TensorSpec(shape=(1,), dtype=tf.int64, name=None)\" is not\r\nEntire first structure:\r\n.\r\nEntire second structure:\r\n.\r\n\r\n```\r\n\r\nLooking forward to your reply!"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33478", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33478/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33478/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33478/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33478", "id": 508604815, "node_id": "MDU6SXNzdWU1MDg2MDQ4MTU=", "number": 33478, "title": "Need a way to get Intermediate Layer Inputs/Activations for tf.keras Models", "user": {"login": "n2cholas", "id": 12474257, "node_id": "MDQ6VXNlcjEyNDc0MjU3", "avatar_url": "https://avatars1.githubusercontent.com/u/12474257?v=4", "gravatar_id": "", "url": "https://api.github.com/users/n2cholas", "html_url": "https://github.com/n2cholas", "followers_url": "https://api.github.com/users/n2cholas/followers", "following_url": "https://api.github.com/users/n2cholas/following{/other_user}", "gists_url": "https://api.github.com/users/n2cholas/gists{/gist_id}", "starred_url": "https://api.github.com/users/n2cholas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/n2cholas/subscriptions", "organizations_url": "https://api.github.com/users/n2cholas/orgs", "repos_url": "https://api.github.com/users/n2cholas/repos", "events_url": "https://api.github.com/users/n2cholas/events{/privacy}", "received_events_url": "https://api.github.com/users/n2cholas/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-10-17T17:01:13Z", "updated_at": "2020-01-11T11:32:22Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using):\r\n2.0\r\n- Are you willing to contribute it (Yes/No):\r\nYes, if there is a consensus on how it should be designed. \r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nIn eager mode, there is no way to access a tf.keras model's layer inputs/outputs during training (as far as I can tell, please correct me if I'm wrong). In TF 1.x (graph mode), this was not a problem, since you could use <s>[`layer.input`](https://github.com/tensorflow/tensorflow/blob/r2.0/tensorflow/python/keras/engine/base_layer.py#L1541-L1558) or [`layer.output`](https://github.com/tensorflow/tensorflow/blob/r2.0/tensorflow/python/keras/engine/base_layer.py#L1560-L1577)</s> [`layer.inbound_nodes` or `layer.outbound_nodes`](https://github.com/tensorflow/tensorflow/blob/r2.0/tensorflow/python/keras/engine/base_layer.py#L1663-L1673) to get these tensors and use those values, but this is no longer possible in eager mode. \r\n\r\nPyTorch solves this issue by allowing users to register hooks on layers, which is essentially a function that is called before/after the forward/backward pass on a layer. [Here](https://pytorch.org/docs/stable/_modules/torch/nn/modules/module.html#Module.register_forward_hook) is the code for `register_forward_hook` in PyTorch.\r\n\r\nAlternatively, the input/output properties of a layer could store a reference to the tensors used in the most recent forward pass.\r\n\r\n**Will this change the current api? How?**\r\nYes, depending on how this is implemented. If a hooks approach is used, this public method would have to be added to `tf.keras.layers.Layer`. If the input/output property approach is used, these properties would have new behavior in eager mode.\r\n\r\n**Who will benefit with this feature?**\r\nBeing able to access, record, manipulate, or otherwise use layer inputs and outputs for models during training/inference is generally very useful. \r\n\r\nA specific example is the [K-FAC](https://arxiv.org/abs/1503.05671) optimization algorithm, which uses each layer's inputs and pre-activation gradients to approximate the Fisher information matrix. The [current implementation](https://github.com/tensorflow/kfac) does not support eager. PyTorch implementations (e.g. [this one](https://github.com/alecwangcq/KFAC-Pytorch/blob/master/optimizers/kfac.py#L81-L82)) of this algorithm use hooks to do this.\r\n\r\nAnother use case is visualizing intermediate activations of CNNs. [This example](https://towardsdatascience.com/visualizing-intermediate-activation-in-convolutional-neural-networks-with-keras-260b36d60d0) uses layer.outputs in TF 1.x + Keras to grab the right tensors then creating an augmented model. This process would be greatly simplified by allowing access to intermediate activations without augmenting the model. \r\n  \r\n**Any Other info.**\r\n[Here](https://github.com/tensorflow/tensorflow/issues/33129) is a related issue about getting intermediate activations.\r\n\r\n\r\n**EDIT (2019-10-20):** I learned that `layer.inbound_nodes `and `layer.outbound_nodes` used to have this behavior, not `layer.input` and `layer.output`. `layer.input` and `layer.output` track the tensors that are created when [`model.build(input_shape)`](https://github.com/tensorflow/tensorflow/blob/r2.0/tensorflow/python/keras/engine/base_layer.py#L365-L379) is called. When you use the model as a callable on your own input (i.e. `predictions = model(inputs)`), new tensors are created (reusing the model's weights/architecture). In TF 1.x, `inputs` would be added to the `inbound_nodes` list and `predictions` would be added to the `outbound_nodes` list during this call. Now, since in eager mode the model is called on a new `EagerTensor` for every training step, it is not reasonable to add that many new tensors to these lists, so the property was deprecated. Since this feature used to exist, I think it's important for a reasonable replacement to exist in TF2 (such as hooks or a layer property tracking the most recent inputs/outputs)."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33472", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33472/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33472/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33472/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33472", "id": 508540765, "node_id": "MDU6SXNzdWU1MDg1NDA3NjU=", "number": 33472, "title": "Allowing to provide pre-built flatbuffers when building tflite C++", "user": {"login": "DoumanAsh", "id": 5676053, "node_id": "MDQ6VXNlcjU2NzYwNTM=", "avatar_url": "https://avatars3.githubusercontent.com/u/5676053?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DoumanAsh", "html_url": "https://github.com/DoumanAsh", "followers_url": "https://api.github.com/users/DoumanAsh/followers", "following_url": "https://api.github.com/users/DoumanAsh/following{/other_user}", "gists_url": "https://api.github.com/users/DoumanAsh/gists{/gist_id}", "starred_url": "https://api.github.com/users/DoumanAsh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DoumanAsh/subscriptions", "organizations_url": "https://api.github.com/users/DoumanAsh/orgs", "repos_url": "https://api.github.com/users/DoumanAsh/repos", "events_url": "https://api.github.com/users/DoumanAsh/events{/privacy}", "received_events_url": "https://api.github.com/users/DoumanAsh/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-10-17T15:05:52Z", "updated_at": "2020-01-30T17:20:06Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Android/Ubuntu\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): Source\r\n- TensorFlow version: 1.15.0\r\n- Python version: 3.6.8\r\n- Installed using virtualenv? pip? conda?: ip\r\n- Bazel version (if compiling from source): 0.24.1\r\n- GCC/Compiler version (if compiling from source): NDK r17b clang\r\n- CUDA/cuDNN version: -\r\n- GPU model and memory: -\r\n\r\n\r\n**Describe the problem**\r\nCurrently tensorflow build always pulls flatbuffers on its own, resulting in duplication of flatbuffers, if user already has dependency on flatbuffers.\r\nDue to how tensorflow headers work, it leaks dependency to generated schema (and therefore flatbuffers.h) \r\nBut as we used flatbuffers 1.10.0 in our project, we had no compilation errors due to missing header.\r\nSince tf 1.15 schema uses some specific feature of flatbuffers 1.11.0 which results in failed build when including model.h for example\r\n\r\nIdeally it would be great if flatbuffers schema wouldn't be leaked, but I doubt it is feasible.\r\nSo my plan is currently upgrading our own flatbuffers to 1.11.0.\r\n\r\nBut this brings me to a question, if we could somehow tell bazel to use our own flatbuffers instead of pulling its own?\r\n\r\nP.s. I tried to find some options in configuration script, but there seem to be none. So I assume most common use case is always build own copy of flatbuffers as part of build process.\r\n\r\n**Any other info / logs**\r\n\r\nHaving proper instructions to how build and install self-contained C++ tflite would be nice too :)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33464", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33464/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33464/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33464/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33464", "id": 508462974, "node_id": "MDU6SXNzdWU1MDg0NjI5NzQ=", "number": 33464, "title": "TFLite-micro: AllocateTensors produces HardFault even for small models", "user": {"login": "antofara", "id": 48907599, "node_id": "MDQ6VXNlcjQ4OTA3NTk5", "avatar_url": "https://avatars3.githubusercontent.com/u/48907599?v=4", "gravatar_id": "", "url": "https://api.github.com/users/antofara", "html_url": "https://github.com/antofara", "followers_url": "https://api.github.com/users/antofara/followers", "following_url": "https://api.github.com/users/antofara/following{/other_user}", "gists_url": "https://api.github.com/users/antofara/gists{/gist_id}", "starred_url": "https://api.github.com/users/antofara/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/antofara/subscriptions", "organizations_url": "https://api.github.com/users/antofara/orgs", "repos_url": "https://api.github.com/users/antofara/repos", "events_url": "https://api.github.com/users/antofara/events{/privacy}", "received_events_url": "https://api.github.com/users/antofara/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-10-17T13:06:10Z", "updated_at": "2019-12-10T23:42:03Z", "closed_at": null, "author_association": "NONE", "body": "I am deploying a model consisting of a GRU with 128 input units and 64 Hidden units (total 37,056 parameters) on the following platform:\r\nNRF52832 Arm cortex M4, with 64 KB ram and 512 KB FLASH.\r\n\r\nTo build the tflite model I follow the steps below:\r\n```python \r\nconverter=tf.lite.TFLiteConverter.from_keras_model(new_gru)\r\nconverter.optimizations= [tf.lite.Optimize.OPTIMIZE_FOR_SIZE]\r\ngruQ=converter.convert()\r\nf=open('gruQ.tflite',\"wb\").write(gruQ)\r\n```\r\nand I convert it to a c++ array with\r\n`xxd -i gruQ.tflite > gruQ.h`\r\n\r\nOn the embedded platform:\r\n```cpp\r\nstatic tflite::MicroErrorReporter micro_error_reporter;\r\n      error_reporter = &micro_error_reporter;\r\n\r\n   //extern unsigned char* quantQ5_tflite;\r\n   const tflite::Model* model = ::tflite::GetModel(gruQ_tflite);\r\n\t\r\n   if (model->version() != TFLITE_SCHEMA_VERSION) {\r\n     error_reporter->Report(\r\n         \"Model provided is schema version %d not equal \"\r\n         \"to supported version %d.\\n\",\r\n         model->version(), TFLITE_SCHEMA_VERSION);\r\n   }\r\n\r\n   // This pulls in all the operation implementations we need\r\n   tflite::ops::micro::AllOpsResolver resolver;\r\n\r\n   static tflite::MicroInterpreter static_interpreter(\r\n         model, resolver, tensor_arena, kTensorArenaSize, error_reporter);\r\n     interpreter = &static_interpreter;\r\n\r\n     TfLiteStatus allocate_status = interpreter->AllocateTensors();\r\n```\r\n\r\nThe last line of code generates a HardFault regardless the size of the TensorArena, which I also tried to set to the maximum allowed by my system (45*1024). More into the details, the function call that produces it is:\r\n`if (auto* array = buffer->data()) {`\r\nin\r\n`tensorflow/lite/experimental/micro/micro_allocator.cc    Line 259`\r\nThe size of the converted model (flatbuffer) is 43304\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): NO\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): v2.0.0-rc2-26-g64c3d382ca 2.0.0\r\n- Python version: 3.7.3\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33463", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33463/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33463/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33463/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33463", "id": 508454571, "node_id": "MDU6SXNzdWU1MDg0NTQ1NzE=", "number": 33463, "title": "Undefined symbols for architecture arm64:   \"NewGpuDelegate(GpuDelegateOptions const*)", "user": {"login": "Mana-M", "id": 54024401, "node_id": "MDQ6VXNlcjU0MDI0NDAx", "avatar_url": "https://avatars1.githubusercontent.com/u/54024401?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mana-M", "html_url": "https://github.com/Mana-M", "followers_url": "https://api.github.com/users/Mana-M/followers", "following_url": "https://api.github.com/users/Mana-M/following{/other_user}", "gists_url": "https://api.github.com/users/Mana-M/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mana-M/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mana-M/subscriptions", "organizations_url": "https://api.github.com/users/Mana-M/orgs", "repos_url": "https://api.github.com/users/Mana-M/repos", "events_url": "https://api.github.com/users/Mana-M/events{/privacy}", "received_events_url": "https://api.github.com/users/Mana-M/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}, {"login": "NikolayChirkov", "id": 11627523, "node_id": "MDQ6VXNlcjExNjI3NTIz", "avatar_url": "https://avatars3.githubusercontent.com/u/11627523?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NikolayChirkov", "html_url": "https://github.com/NikolayChirkov", "followers_url": "https://api.github.com/users/NikolayChirkov/followers", "following_url": "https://api.github.com/users/NikolayChirkov/following{/other_user}", "gists_url": "https://api.github.com/users/NikolayChirkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/NikolayChirkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NikolayChirkov/subscriptions", "organizations_url": "https://api.github.com/users/NikolayChirkov/orgs", "repos_url": "https://api.github.com/users/NikolayChirkov/repos", "events_url": "https://api.github.com/users/NikolayChirkov/events{/privacy}", "received_events_url": "https://api.github.com/users/NikolayChirkov/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-10-17T12:51:32Z", "updated_at": "2019-11-28T04:56:59Z", "closed_at": null, "author_association": "NONE", "body": "System information\r\n\r\n    Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n    OS Platform and Distribution (e.g., Linux Ubuntu 16.04): macOS 10.14.6\r\n    Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: iPhone X.s, 13.1.3\r\n    TensorFlow installed from (source or binary): source\r\n    TensorFlow version (use command below): master branch cloned on 2019-10-8\r\n    Python version: 3.7.4\r\n    Bazel version (if compiling from source):  0.26.1\r\n    GCC/Compiler version (if compiling from source): NA\r\n    CUDA/cuDNN version: NA\r\n    GPU model and memory: NA\r\n\r\nDescribe the current behavior:\r\nIt fails to build the library in Xcode.\r\nUndefined symbols for architecture arm64:   \"NewGpuDelegate(GpuDelegateOptions const*)\r\n\r\nDescribe the expected behavior:\r\nI want to build my C++ library with the ability to run it with GPU in an iOS app\r\n\r\nCode to reproduce the issue\r\n\r\nOther info / logs\r\nI changed the extension of the file having this line of code: \r\n_delegate = NewGpuDelegate(&options);_\r\nfrom cpp to mm, as otherwise I couldn't include header files for metal(which are written in obj-c).\r\nI tested the tensorflow ios/camera example and it builds and runs fine. But using the same .framework lib gives me the same undefined symbol error.\r\n\r\nBazel Command for building the tensorflow lib:\r\n**bazel build -c opt --cpu ios_arm64 --copt -Os --copt -DTFLITE_GPU_BINARY_RELEASE --copt -fvisibility=hidden --linkopt -s --strip always --cxxopt=-std=c++14 :tensorflow_lite_gpu_framework --apple_platform_type=ios**\r\n\r\nAny help would be appreciated!"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33446", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33446/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33446/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/33446/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/33446", "id": 508176982, "node_id": "MDU6SXNzdWU1MDgxNzY5ODI=", "number": 33446, "title": "GraphKeys.BIASES variables present in losses.get_regularization_losses()", "user": {"login": "pisiiki", "id": 1302640, "node_id": "MDQ6VXNlcjEzMDI2NDA=", "avatar_url": "https://avatars1.githubusercontent.com/u/1302640?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pisiiki", "html_url": "https://github.com/pisiiki", "followers_url": "https://api.github.com/users/pisiiki/followers", "following_url": "https://api.github.com/users/pisiiki/following{/other_user}", "gists_url": "https://api.github.com/users/pisiiki/gists{/gist_id}", "starred_url": "https://api.github.com/users/pisiiki/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pisiiki/subscriptions", "organizations_url": "https://api.github.com/users/pisiiki/orgs", "repos_url": "https://api.github.com/users/pisiiki/repos", "events_url": "https://api.github.com/users/pisiiki/events{/privacy}", "received_events_url": "https://api.github.com/users/pisiiki/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-10-17T01:13:23Z", "updated_at": "2019-10-18T08:39:37Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes.\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04.\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 1.14 GPU\r\n- Python version: 3.6\r\n- CUDA/cuDNN version: 10.2\r\n- GPU model and memory: 1060 ti\r\n\r\n**Describe the current behavior**\r\n\r\nAll variables, including biases are added to regularization losses (not only weights) within a tf.variable_scope with a regularizer.\r\n\r\n**Describe the expected behavior**\r\n\r\nI find this behavior very strange. As far as I know only weights should be added to the l1/l2 losses list. Even if some of the losses resolve to zero later (doesn't seem the case). I asume this is by design, however this has caused me tons of confusion in the past and forces me to manually pass the regularizer everywhere. Please point me in the right direction if I'm missing something here, because I find this quite odd.\r\n\r\n**Code to reproduce the issue**\r\n\r\n\r\n```\r\nimport tensorflow.compat.v1 as tf\r\nimport tensorflow.contrib.layers as tf_c_l\r\n\r\nwith tf.Session() as sess:\r\n    t0 = tf.placeholder(dtype=tf.float32, shape=(20, 10,))\r\n\r\n    reg = tf_c_l.l1_l2_regularizer()\r\n    with tf.variable_scope('test', regularizer=reg):\r\n        v2 = tf.get_variable('test', shape=(20, 10), collections=[tf.GraphKeys.BIASES])\r\n        layer = tf_c_l.fully_connected(t0, num_outputs=10)\r\n\r\n    print('Bias Variables:')\r\n    for i in tf.get_collection(tf.GraphKeys.BIASES):\r\n        print('{} {}'.format(i.shape.as_list(), i.name))\r\n\r\n    print()\r\n\r\n    print('Regularization losses:')\r\n    for i in tf.losses.get_regularization_losses():\r\n        print('{} {}'.format(i.shape.as_list(), i.name))\r\n```\r\n\r\n\r\n**Other info / logs**\r\n\r\n```\r\nBias Variables:\r\n[20, 10] test/test:0\r\n\r\nRegularization losses:\r\n[] test/test/Regularizer/l1_l2_regularizer:0\r\n[] test/fully_connected/weights/Regularizer/l1_l2_regularizer:0\r\n[] test/fully_connected/biases/Regularizer/l1_l2_regularizer:0\r\n```\r\n"}]