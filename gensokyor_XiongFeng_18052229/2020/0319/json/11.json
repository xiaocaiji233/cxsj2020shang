[{"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34679", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34679/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34679/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34679/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34679", "id": 529810412, "node_id": "MDU6SXNzdWU1Mjk4MTA0MTI=", "number": 34679, "title": "Missing Operations for TfLite GPU Delegate", "user": {"login": "Noltibus", "id": 15614838, "node_id": "MDQ6VXNlcjE1NjE0ODM4", "avatar_url": "https://avatars3.githubusercontent.com/u/15614838?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Noltibus", "html_url": "https://github.com/Noltibus", "followers_url": "https://api.github.com/users/Noltibus/followers", "following_url": "https://api.github.com/users/Noltibus/following{/other_user}", "gists_url": "https://api.github.com/users/Noltibus/gists{/gist_id}", "starred_url": "https://api.github.com/users/Noltibus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Noltibus/subscriptions", "organizations_url": "https://api.github.com/users/Noltibus/orgs", "repos_url": "https://api.github.com/users/Noltibus/repos", "events_url": "https://api.github.com/users/Noltibus/events{/privacy}", "received_events_url": "https://api.github.com/users/Noltibus/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "terryheo", "id": 2908505, "node_id": "MDQ6VXNlcjI5MDg1MDU=", "avatar_url": "https://avatars2.githubusercontent.com/u/2908505?v=4", "gravatar_id": "", "url": "https://api.github.com/users/terryheo", "html_url": "https://github.com/terryheo", "followers_url": "https://api.github.com/users/terryheo/followers", "following_url": "https://api.github.com/users/terryheo/following{/other_user}", "gists_url": "https://api.github.com/users/terryheo/gists{/gist_id}", "starred_url": "https://api.github.com/users/terryheo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/terryheo/subscriptions", "organizations_url": "https://api.github.com/users/terryheo/orgs", "repos_url": "https://api.github.com/users/terryheo/repos", "events_url": "https://api.github.com/users/terryheo/events{/privacy}", "received_events_url": "https://api.github.com/users/terryheo/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "terryheo", "id": 2908505, "node_id": "MDQ6VXNlcjI5MDg1MDU=", "avatar_url": "https://avatars2.githubusercontent.com/u/2908505?v=4", "gravatar_id": "", "url": "https://api.github.com/users/terryheo", "html_url": "https://github.com/terryheo", "followers_url": "https://api.github.com/users/terryheo/followers", "following_url": "https://api.github.com/users/terryheo/following{/other_user}", "gists_url": "https://api.github.com/users/terryheo/gists{/gist_id}", "starred_url": "https://api.github.com/users/terryheo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/terryheo/subscriptions", "organizations_url": "https://api.github.com/users/terryheo/orgs", "repos_url": "https://api.github.com/users/terryheo/repos", "events_url": "https://api.github.com/users/terryheo/events{/privacy}", "received_events_url": "https://api.github.com/users/terryheo/received_events", "type": "User", "site_admin": false}, {"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-11-28T10:02:02Z", "updated_at": "2020-03-06T20:51:10Z", "closed_at": null, "author_association": "NONE", "body": "\r\n**System information**\r\n- TensorFlow version (you are using): \r\non Android: 'org.tensorflow:tensorflow-lite:0.0.0-nightly' and 'org.tensorflow:tensorflow-lite-gpu:0.0.0-nightly'\r\n- Are you willing to contribute it (Yes/No): Yes to the best of my possibilities\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nI'm trying to use the GPU delegate for my custom tflite model. Creating the interpreter with the GPU delegate using this code:\r\n```\r\n val options = Options()\r\noptions.setUseNNAPI(false)\r\noptions.setAllowFp16PrecisionForFp32(true)\r\noptions.setNumThreads(NUM_THREADS)\r\nval gpuDelegate = GpuDelegate()\r\noptions.addDelegate(gpuDelegate)\r\n\r\nd.tfLite = Interpreter( loadModelFile(assetManager)!!, options)\r\n```\r\n results in my model being run normally, hence delivering the correct outputs but not being accelerated by the GPU in my opinion, since the execution time is exactly the same as without using the delegate. Adding the line  `d.tfLite!!.modifyGraphWithDelegate(gpuDelegate)` (I don't know if this is necessary, it would also be nice to know?) results in the following error:\r\n```\r\njava.lang.IllegalArgumentException: Internal error: Failed to apply delegate: Next operations are not supported by GPU delegate:\r\n    CONV_2D: Max version supported: 1. Requested version 2.\r\n    LOCAL_RESPONSE_NORMALIZATION: Operation is not supported.\r\n    SPLIT: Operation is not supported.\r\n    First 0 operations will run on the GPU, and the remaining 12 on the CPU.ModifyGraphWithDelegate is disallowed when graph is immutable.\r\n    java.lang.RuntimeException: java.lang.IllegalArgumentException: Internal error: Failed to apply delegate: Next operations are not supported by GPU delegate:\r\n    CONV_2D: Max version supported: 1. Requested version 2.\r\n    LOCAL_RESPONSE_NORMALIZATION: Operation is not supported.\r\n    SPLIT: Operation is not supported.\r\n    First 0 operations will run on the GPU, and the remaining 12 on the CPU.ModifyGraphWithDelegate is disallowed when graph is immutable.\r\n```\r\n\r\nSo first of all: It would be nice to have those unsupported operations, i.e. \r\n\r\n- CONV_2D v2\r\n- LOCAL_RESPONSE_NORMALIZATION\r\n- SPLIT\r\n\r\nSecond of all: what does `ModifyGraphWithDelegate is disallowed when graph is immutable` mean? Do I have to make any changes to my tflite model?\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34664", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34664/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34664/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34664/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34664", "id": 529624105, "node_id": "MDU6SXNzdWU1Mjk2MjQxMDU=", "number": 34664, "title": "TensorFlow Lite for Microcontrollers fails to build ", "user": {"login": "kenthinson", "id": 2245494, "node_id": "MDQ6VXNlcjIyNDU0OTQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/2245494?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kenthinson", "html_url": "https://github.com/kenthinson", "followers_url": "https://api.github.com/users/kenthinson/followers", "following_url": "https://api.github.com/users/kenthinson/following{/other_user}", "gists_url": "https://api.github.com/users/kenthinson/gists{/gist_id}", "starred_url": "https://api.github.com/users/kenthinson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kenthinson/subscriptions", "organizations_url": "https://api.github.com/users/kenthinson/orgs", "repos_url": "https://api.github.com/users/kenthinson/repos", "events_url": "https://api.github.com/users/kenthinson/events{/privacy}", "received_events_url": "https://api.github.com/users/kenthinson/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, {"login": "wangtz", "id": 34290063, "node_id": "MDQ6VXNlcjM0MjkwMDYz", "avatar_url": "https://avatars1.githubusercontent.com/u/34290063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wangtz", "html_url": "https://github.com/wangtz", "followers_url": "https://api.github.com/users/wangtz/followers", "following_url": "https://api.github.com/users/wangtz/following{/other_user}", "gists_url": "https://api.github.com/users/wangtz/gists{/gist_id}", "starred_url": "https://api.github.com/users/wangtz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wangtz/subscriptions", "organizations_url": "https://api.github.com/users/wangtz/orgs", "repos_url": "https://api.github.com/users/wangtz/repos", "events_url": "https://api.github.com/users/wangtz/events{/privacy}", "received_events_url": "https://api.github.com/users/wangtz/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-11-28T00:01:55Z", "updated_at": "2020-01-22T01:23:02Z", "closed_at": null, "author_association": "NONE", "body": "Attempting to build the test arduino library using:\r\n./tensorflow/lite/experimental/micro/tools/ci_build/test_arduino.sh\r\nThrows a error about not being able to execute Arduino-cli.\r\nI installed Arduino-cli through brew but still get the error.\r\n\r\n**System information**\r\n- Mac OSX 10.15.1\r\n- TensorFlow version: Master\r\n- Python version: 2.7\r\n\r\nIf I had to guess the build script is pulling down the linux binary and failing to run it. But I have not verified this."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34659", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34659/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34659/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34659/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34659", "id": 529565124, "node_id": "MDU6SXNzdWU1Mjk1NjUxMjQ=", "number": 34659, "title": "Dataset iterator hanging from within a dataset interleave ", "user": {"login": "andrewstanfordjason", "id": 1251779, "node_id": "MDQ6VXNlcjEyNTE3Nzk=", "avatar_url": "https://avatars0.githubusercontent.com/u/1251779?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andrewstanfordjason", "html_url": "https://github.com/andrewstanfordjason", "followers_url": "https://api.github.com/users/andrewstanfordjason/followers", "following_url": "https://api.github.com/users/andrewstanfordjason/following{/other_user}", "gists_url": "https://api.github.com/users/andrewstanfordjason/gists{/gist_id}", "starred_url": "https://api.github.com/users/andrewstanfordjason/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andrewstanfordjason/subscriptions", "organizations_url": "https://api.github.com/users/andrewstanfordjason/orgs", "repos_url": "https://api.github.com/users/andrewstanfordjason/repos", "events_url": "https://api.github.com/users/andrewstanfordjason/events{/privacy}", "received_events_url": "https://api.github.com/users/andrewstanfordjason/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-11-27T20:44:38Z", "updated_at": "2019-12-09T22:03:05Z", "closed_at": null, "author_association": "NONE", "body": "\r\n> \r\n> == check python ===================================================\r\n> python version: 3.7.4\r\n> python branch: \r\n> python build version: ('default', 'Sep  7 2019 18:27:02')\r\n> python compiler version: Clang 10.0.1 (clang-1001.0.46.4)\r\n> python implementation: CPython\r\n> \r\n> \r\n> == check os platform ===============================================\r\n> os: Darwin\r\n> os kernel version: Darwin Kernel Version 19.0.0: Wed Sep 25 20:18:50 PDT 2019; root:xnu-6153.11.26~2/RELEASE_X86_64\r\n> os release version: 19.0.0\r\n> os platform: Darwin-19.0.0-x86_64-i386-64bit\r\n> linux distribution: ('', '', '')\r\n> linux os distribution: ('', '', '')\r\n> mac version: ('10.15', ('', '', ''), 'x86_64')\r\n> uname: uname_result(system='Darwin', node='Andrews-MacBook.local', release='19.0.0', version='Darwin Kernel Version 19.0.0: Wed Sep 25 20:18:50 PDT 2019; root:xnu-6153.11.26~2/RELEASE_X86_64', machine='x86_64', processor='i386')\r\n> architecture: ('64bit', '')\r\n> machine: x86_64\r\n> \r\n> \r\n> == are we in docker =============================================\r\n> No\r\n> \r\n> == compiler =====================================================\r\n> xcrun: error: invalid active developer path (/Library/Developer/CommandLineTools), missing xcrun at: /Library/Developer/CommandLineTools/usr/bin/xcrun\r\n> \r\n> == check pips ===================================================\r\n> numpy                1.17.4   \r\n> protobuf             3.10.0   \r\n> tensorflow           2.0.0    \r\n> tensorflow-estimator 2.0.1    \r\n> \r\n> == check for virtualenv =========================================\r\n> True\r\n> \r\n> == tensorflow import ============================================\r\n> tf.version.VERSION = 2.0.0\r\n> tf.version.GIT_VERSION = v2.0.0-rc2-26-g64c3d382ca\r\n> tf.version.COMPILER_VERSION = 4.2.1 Compatible Apple LLVM 10.0.0 (clang-1000.11.45.5)\r\n> \r\n> == env ==========================================================\r\n> LD_LIBRARY_PATH is unset\r\n> DYLD_LIBRARY_PATH is unset\r\n> \r\n> == nvidia-smi ===================================================\r\n> ./tf_env_collect.sh: line 147: nvidia-smi: command not found\r\n> \r\n> == cuda libs  ===================================================\r\n> \r\n> == tensorflow installed from info ==================\r\n> Name: tensorflow\r\n> Version: 2.0.0\r\n> Summary: TensorFlow is an open source machine learning framework for everyone.\r\n> Home-page: https://www.tensorflow.org/\r\n> Author-email: packages@tensorflow.org\r\n> License: Apache 2.0\r\n> Location: /Users/andrew/.local/share/virtualenvs/lib_andrew_scratch--yvJ8pLH/lib/python3.7/site-packages\r\n> Required-by: \r\n> \r\n> == python version  ==============================================\r\n> (major, minor, micro, releaselevel, serial)\r\n> (3, 7, 4, 'final', 0)\r\n> \r\n> == bazel version  ===============================================\r\n> \r\n\r\n**Describe the current behavior**\r\nIt seems all threads are waiting in a deadlock behaviour\r\n\r\n**Describe the expected behavior**\r\nTo return a dataset iterator\r\n\r\n**Code to reproduce the issue**\r\n\r\n\r\n\r\n```\r\n#!/usr/bin/env python\r\nimport tensorflow as tf\r\n\r\ndef gen( ):\r\n\tnoise_tfrecord = \"test.tfrecord\"\r\n\traw_noise_dataset = tf.data.TFRecordDataset(noise_tfrecord)\r\n\tnoise_count = sum(1 for _ in raw_noise_dataset)\r\n\tyield 1.\r\n\r\ndef do_bug():\r\n\tsignal_tfrecord = \"test.tfrecord\"\r\n\traw_signal_dataset = tf.data.TFRecordDataset(signal_tfrecord)\r\n\tdataset = raw_signal_dataset.interleave(lambda x: tf.data.Dataset.from_generator(gen, \r\n\t\t\toutput_types=(tf.float32), \r\n\t\t\targs=( )),\r\n\t\t\tcycle_length=2,\r\n\t\t\tblock_length=1,\r\n\t\t\tnum_parallel_calls = 1 )\r\n\r\n\tfor d in dataset:\r\n\t\tprint(d)\r\n\r\n\treturn \r\n\r\ndef _int_feature(value):\r\n    return tf.train.Feature(int64_list=tf.train.Int64List(value=[value]))\r\n\r\ndef make_dataset():\r\n\ttfrecord_filename = \"test.tfrecord\"\r\n\twith tf.io.TFRecordWriter(tfrecord_filename) as writer:\r\n\t\tfor i in range(4):\r\n\t\t\tfeature = {'feat' : _int_feature(42)}\r\n\r\n\t\t\texample_proto = tf.train.Example(features=tf.train.Features(feature=feature))\r\n\t\t\twriter.write(example_proto.SerializeToString())  \r\n\r\nif __name__== \"__main__\":\r\n\tmake_dataset()\r\n\tdo_bug()\r\n\r\n```\r\n\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\n[bug.py.zip](https://github.com/tensorflow/tensorflow/files/3898706/bug.py.zip)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34657", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34657/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34657/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34657/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34657", "id": 529525021, "node_id": "MDU6SXNzdWU1Mjk1MjUwMjE=", "number": 34657, "title": "problems when I build tensorflow from source, someone helps please", "user": {"login": "652994331", "id": 51428350, "node_id": "MDQ6VXNlcjUxNDI4MzUw", "avatar_url": "https://avatars3.githubusercontent.com/u/51428350?v=4", "gravatar_id": "", "url": "https://api.github.com/users/652994331", "html_url": "https://github.com/652994331", "followers_url": "https://api.github.com/users/652994331/followers", "following_url": "https://api.github.com/users/652994331/following{/other_user}", "gists_url": "https://api.github.com/users/652994331/gists{/gist_id}", "starred_url": "https://api.github.com/users/652994331/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/652994331/subscriptions", "organizations_url": "https://api.github.com/users/652994331/orgs", "repos_url": "https://api.github.com/users/652994331/repos", "events_url": "https://api.github.com/users/652994331/events{/privacy}", "received_events_url": "https://api.github.com/users/652994331/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-11-27T19:03:19Z", "updated_at": "2019-11-29T11:00:53Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: no\r\n- TensorFlow installed from (source or binary): source(not sure, i am using ./configure and  then bazel build)\r\n- TensorFlow version: 1.14(for my conda environment)\r\n- Python version: 3.6.8\r\n- Installed using virtualenv? pip? conda?: conda create -n xxx python=3.6.8 the enter the env and pip install tensorflow==1.14\r\n- Bazel version (if compiling from source):1.1.0\r\n- GCC/Compiler version (if compiling from source): 6.4.0\r\n- CUDA/cuDNN version: cuda 10/cudnn  CUDNN_MAJOR 7\r\n- GPU model and memory: TESLA P40\r\n\r\n\r\n\r\n**Describe the problem**\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n\r\nHI, GUYS, I was trying to build tensorflow transform_graph tools  from source(same way as build tensorflow), I already installed bazel and clone tensorflow from github. When i use command\r\nbazel build tensorflow/tools/graph_transforms:transform_graph, i got this problem\r\n![image](https://user-images.githubusercontent.com/51428350/69752002-2286f500-1105-11ea-9f50-547851b71f59.png)\r\n\r\nafter searching for a while, i think it might because of the CUDA , so i ./configure again, this time, when it needs me to choose do you wish to build tf with cuda support, i chose no\r\nand build again, but this time still not work\r\n![image](https://user-images.githubusercontent.com/51428350/69752146-78f43380-1105-11ea-8407-c0de92760ec9.png)\r\n\r\ncould you please help me out? thanks so much\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34652", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34652/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34652/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34652/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34652", "id": 529446209, "node_id": "MDU6SXNzdWU1Mjk0NDYyMDk=", "number": 34652, "title": "GPU unit-test infrastructure breakage (`Dockerfile.gpu`, `gpu/run_py3_core.sh`) ", "user": {"login": "deven-amd", "id": 36858332, "node_id": "MDQ6VXNlcjM2ODU4MzMy", "avatar_url": "https://avatars2.githubusercontent.com/u/36858332?v=4", "gravatar_id": "", "url": "https://api.github.com/users/deven-amd", "html_url": "https://github.com/deven-amd", "followers_url": "https://api.github.com/users/deven-amd/followers", "following_url": "https://api.github.com/users/deven-amd/following{/other_user}", "gists_url": "https://api.github.com/users/deven-amd/gists{/gist_id}", "starred_url": "https://api.github.com/users/deven-amd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/deven-amd/subscriptions", "organizations_url": "https://api.github.com/users/deven-amd/orgs", "repos_url": "https://api.github.com/users/deven-amd/repos", "events_url": "https://api.github.com/users/deven-amd/events{/privacy}", "received_events_url": "https://api.github.com/users/deven-amd/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2019-11-27T16:15:14Z", "updated_at": "2020-02-03T21:48:22Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "Evertyime we sync (the `develop-upstream` branch) in our TF fork (with the `master` branch of this repo), we run a bunch of test-suites to qualify the changes before taking them.\r\n\r\nOne of those testsuites involves running the `GPU` tests (on the `cuda` platform) using the following command \r\n\r\n```\r\ntensorflow/tools/ci_build/ci_build.sh GPU ./tensorflow/tools/ci_build/linux/gpu/run_py3_core.sh\r\n```\r\n\r\nThe above testsuite failed for us during our latest sync attempt. \r\n\r\nWe re-ran the CI job directly on the code in the `master` branch (as opposed to the merged code in our repo), and we see the same errors, leading us to believe that the breakage originates due to changes in the upstream repo.\r\n\r\nLink to the CI run log mentioned above : http://ml-ci.amd.com:21096/job/tensorflow-cuda/1/console\r\n\r\nOur last successful merge was about 3 weeks ago, so the breakage seems to have been introduced sometime within the last 3 weeks. \r\n\r\nErrors similar to the ones we see, have been reported in other github issues.\r\nhttps://github.com/tensorflow/tensorflow/issues/34429\r\nhttps://github.com/tensorflow/tensorflow/issues/34117\r\n\r\nWhen we look at the invocation log for the `Linux GPU` (in the **Continuous build status** section of README.md), the run is passing, but it seems to use a different script and different env-vars/options/etc as compared to those used by the `Dockerfile.gpu` and `./tensorflow/tools/ci_build/linux/gpu/*.sh` scripts that are used by our CI job.\r\n\r\nThe request here is to please identify what is causing the breakage we see on our end, and fix it. Also please update the GPU test scripts (`Dockerfile.gpu` + `./tensorflow/tools/ci_build/linux/gpu/*.sh` ) to match what is done by the GPU CI runs kicked off internally.\r\n\r\nthanks\r\n\r\n\r\n/cc @chsigg @parallelo @sunway513 @whchung \r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34643", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34643/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34643/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34643/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34643", "id": 529276453, "node_id": "MDU6SXNzdWU1MjkyNzY0NTM=", "number": 34643, "title": "TypeError while importing tensorflow caused by site.USER_SITE is set to None", "user": {"login": "tkilias", "id": 5796845, "node_id": "MDQ6VXNlcjU3OTY4NDU=", "avatar_url": "https://avatars1.githubusercontent.com/u/5796845?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tkilias", "html_url": "https://github.com/tkilias", "followers_url": "https://api.github.com/users/tkilias/followers", "following_url": "https://api.github.com/users/tkilias/following{/other_user}", "gists_url": "https://api.github.com/users/tkilias/gists{/gist_id}", "starred_url": "https://api.github.com/users/tkilias/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tkilias/subscriptions", "organizations_url": "https://api.github.com/users/tkilias/orgs", "repos_url": "https://api.github.com/users/tkilias/repos", "events_url": "https://api.github.com/users/tkilias/events{/privacy}", "received_events_url": "https://api.github.com/users/tkilias/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-11-27T11:06:50Z", "updated_at": "2019-11-29T05:01:04Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: --\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 2.0.0\r\n- Python version: 3.6\r\n- Bazel version (if compiling from source): --\r\n- GCC/Compiler version (if compiling from source): --\r\n- CUDA/cuDNN version: --\r\n- GPU model and memory: --\r\n\r\n**Describe the current behavior**\r\n\r\nWhen importing the tensorflow module with\r\n\r\n`import tensorflow`\r\n\r\nthe following Exception gets thrown\r\n\r\n> Traceback (most recent call last):\r\n>   File \"IMPORT_TENSORFLOW\", line 8, in run\r\n>   File \"/usr/local/lib/python3.6/dist-packages/tensorflow/__init__.py\", line 98, in <module>\r\n>     from tensorflow_core import *\r\n>   File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/__init__.py\", line 403, in <module>\r\n>     if _running_from_pip_package():\r\n>   File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/__init__.py\", line 401, in _running_from_pip_package\r\n>     _current_file_location.startswith(dir_) for dir_ in _site_packages_dirs)\r\n>   File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/__init__.py\", line 401, in <genexpr>\r\n    _current_file_location.startswith(dir_) for dir_ in _site_packages_dirs)\r\n> TypeError: startswith first arg must be str or a tuple of str, not NoneType\r\n\r\nfrom\r\n\r\nhttps://github.com/tensorflow/tensorflow/blob/64c3d382cadf7bbe8e7e99884bede8284ff67f56/tensorflow/api_template.__init__.py#L119\r\n\r\nThe cause for this is\r\n\r\nhttps://github.com/tensorflow/tensorflow/blob/64c3d382cadf7bbe8e7e99884bede8284ff67f56/tensorflow/api_template.__init__.py#L104\r\n\r\nbecause `site.USER_SITE` can be `None` accordingly to the python documentation https://docs.python.org/3.6/library/site.html#site.USER_SITE and in this environment it happens to be the case.\r\n\r\nA workaround for this is to call  site.getusersitepackages() before importing tensorflow. However, in my opinion the `USER_SITE` needs to be checked here before it is used, or the list _site_packages_dirs needs to be filtered for `None` values.\r\n\r\n**Describe the expected behavior**\r\n\r\n`import tensorflow` succeeds without the exception\r\n\r\n**Code to reproduce the issue**\r\n\r\nStart container:\r\n\r\n`docker run --rm -it tensorflow/tensorflow:2.0.0-py3 bash`\r\n\r\nStart python3 in the container without site initialization:\r\n\r\n`python3 -S`\r\n\r\nAdd package locations to the sys.path and import tensorflow:\r\n\r\n```\r\nimport sys\r\nsys.path=['', '/usr/lib/python36.zip', '/usr/lib/python3.6', '/usr/lib/python3.6/lib-dynload', '/usr/local/lib/python3.6/dist-packages', '/usr/lib/python3/dist-packages']\r\nimport tensorflow\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34642", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34642/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34642/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34642/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34642", "id": 529249685, "node_id": "MDU6SXNzdWU1MjkyNDk2ODU=", "number": 34642, "title": "[tflite] Output difference for simple MobileNetV2 model", "user": {"login": "hgaiser", "id": 716138, "node_id": "MDQ6VXNlcjcxNjEzOA==", "avatar_url": "https://avatars1.githubusercontent.com/u/716138?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hgaiser", "html_url": "https://github.com/hgaiser", "followers_url": "https://api.github.com/users/hgaiser/followers", "following_url": "https://api.github.com/users/hgaiser/following{/other_user}", "gists_url": "https://api.github.com/users/hgaiser/gists{/gist_id}", "starred_url": "https://api.github.com/users/hgaiser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hgaiser/subscriptions", "organizations_url": "https://api.github.com/users/hgaiser/orgs", "repos_url": "https://api.github.com/users/hgaiser/repos", "events_url": "https://api.github.com/users/hgaiser/events{/privacy}", "received_events_url": "https://api.github.com/users/hgaiser/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}, {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, {"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}, {"login": "renjie-liu", "id": 36247193, "node_id": "MDQ6VXNlcjM2MjQ3MTkz", "avatar_url": "https://avatars3.githubusercontent.com/u/36247193?v=4", "gravatar_id": "", "url": "https://api.github.com/users/renjie-liu", "html_url": "https://github.com/renjie-liu", "followers_url": "https://api.github.com/users/renjie-liu/followers", "following_url": "https://api.github.com/users/renjie-liu/following{/other_user}", "gists_url": "https://api.github.com/users/renjie-liu/gists{/gist_id}", "starred_url": "https://api.github.com/users/renjie-liu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/renjie-liu/subscriptions", "organizations_url": "https://api.github.com/users/renjie-liu/orgs", "repos_url": "https://api.github.com/users/renjie-liu/repos", "events_url": "https://api.github.com/users/renjie-liu/events{/privacy}", "received_events_url": "https://api.github.com/users/renjie-liu/received_events", "type": "User", "site_admin": false}, {"login": "multiverse-tf", "id": 48348070, "node_id": "MDQ6VXNlcjQ4MzQ4MDcw", "avatar_url": "https://avatars0.githubusercontent.com/u/48348070?v=4", "gravatar_id": "", "url": "https://api.github.com/users/multiverse-tf", "html_url": "https://github.com/multiverse-tf", "followers_url": "https://api.github.com/users/multiverse-tf/followers", "following_url": "https://api.github.com/users/multiverse-tf/following{/other_user}", "gists_url": "https://api.github.com/users/multiverse-tf/gists{/gist_id}", "starred_url": "https://api.github.com/users/multiverse-tf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/multiverse-tf/subscriptions", "organizations_url": "https://api.github.com/users/multiverse-tf/orgs", "repos_url": "https://api.github.com/users/multiverse-tf/repos", "events_url": "https://api.github.com/users/multiverse-tf/events{/privacy}", "received_events_url": "https://api.github.com/users/multiverse-tf/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 17, "created_at": "2019-11-27T10:18:28Z", "updated_at": "2020-01-20T11:58:56Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): **Arch Linux**\r\n- TensorFlow installed from (source or binary): **binary**\r\n- TensorFlow version (or github SHA if from source): **Tested on tf_nightly_gpu-2.1.0.dev20191126 from pip and 2.0.0 from the Arch repositories.**\r\n\r\n\r\n**Command used to run the converter or code if you\u2019re using the Python API**\r\nOriginal implementation from [here](https://www.tensorflow.org/lite/convert/python_api#end-to-end_mobilenet_conversion_).\r\n\r\n```python\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\n# Load the MobileNet tf.keras model (and set include_top=False).\r\nmodel = tf.keras.applications.MobileNetV2(\r\n    weights=\"imagenet\", input_shape=(224, 224, 3), include_top=False)\r\n\r\n# Convert the model.\r\nconverter = tf.lite.TFLiteConverter.from_keras_model(model)\r\ntflite_model = converter.convert()\r\n\r\n# Load TFLite model and allocate tensors.\r\ninterpreter = tf.lite.Interpreter(model_content=tflite_model)\r\ninterpreter.allocate_tensors()\r\n\r\n# Get input and output tensors.\r\ninput_details = interpreter.get_input_details()\r\noutput_details = interpreter.get_output_details()\r\n\r\n# Test the TensorFlow Lite model on random input data.\r\ninput_shape = input_details[0]['shape']\r\ninput_data = np.array(np.random.random_sample(input_shape), dtype=np.float32)\r\ninterpreter.set_tensor(input_details[0]['index'], input_data)\r\n\r\ninterpreter.invoke()\r\n\r\n# The function `get_tensor()` returns a copy of the tensor data.\r\n# Use `tensor()` in order to get a pointer to the tensor.\r\ntflite_results = interpreter.get_tensor(output_details[0]['index'])\r\n\r\n# Test the TensorFlow model on random input data.\r\ntf_results = model(tf.constant(input_data))\r\n\r\n# Compare the result.\r\nfor tf_result, tflite_result in zip(tf_results, tflite_results):\r\n  np.testing.assert_almost_equal(tf_result, tflite_result, decimal=5)\r\n```\r\n\r\n**The output from the converter invocation**\r\n\r\n```\r\nAssertionError: \r\nArrays are not almost equal to 5 decimals\r\n\r\nMismatch: 2.78%\r\nMax absolute difference: 5.4180622e-05\r\nMax relative difference: 0.01288559\r\n x: array([[[0.     , 0.     , 0.     , ..., 0.     , 0.     , 0.     ],\r\n        [0.     , 0.     , 0.     , ..., 0.     , 0.82339, 0.74743],\r\n        [0.     , 0.88872, 0.     , ..., 0.     , 2.61463, 2.41743],...\r\n y: array([[[0.     , 0.     , 0.     , ..., 0.     , 0.     , 0.     ],\r\n        [0.     , 0.     , 0.     , ..., 0.     , 0.8234 , 0.74745],\r\n        [0.     , 0.88871, 0.     , ..., 0.     , 2.61464, 2.41744],...\r\n\r\n```\r\n\r\n**Failure details**\r\nAs per the [converter documentation](https://www.tensorflow.org/lite/convert/python_api), I am trying to verify that the output of my converted model and the output of my original model are identical. This is the case if I run [this](https://www.tensorflow.org/lite/convert/python_api#end-to-end_mobilenet_conversion_) code from the documentation page, however if I add `include_top=False` to the `MobileNetV2` constructor, then I get different output. I would expect the exact same output, regardless of what part of the model I select.\r\n\r\nAs per the output log, there is a max relative difference of 0.01288559, which in my opinion is pretty significant.\r\n\r\nNote that there is no quantization being performed. It is simply creating a random MobileNetV2 model, converting it and passing through some random data. I find it weird that the output is different, but that the outputs are identical if `include_top=True`.\r\n\r\n**Any other info / logs**\r\nI have tested on other backbones as well, `MobileNet` and `ResNet50`; they have the same issue that the output is different when adding `include_top=False`.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34641", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34641/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34641/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34641/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34641", "id": 529244298, "node_id": "MDU6SXNzdWU1MjkyNDQyOTg=", "number": 34641, "title": "Shape_refiner.cc documentation", "user": {"login": "Kelkka7", "id": 19335589, "node_id": "MDQ6VXNlcjE5MzM1NTg5", "avatar_url": "https://avatars3.githubusercontent.com/u/19335589?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Kelkka7", "html_url": "https://github.com/Kelkka7", "followers_url": "https://api.github.com/users/Kelkka7/followers", "following_url": "https://api.github.com/users/Kelkka7/following{/other_user}", "gists_url": "https://api.github.com/users/Kelkka7/gists{/gist_id}", "starred_url": "https://api.github.com/users/Kelkka7/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Kelkka7/subscriptions", "organizations_url": "https://api.github.com/users/Kelkka7/orgs", "repos_url": "https://api.github.com/users/Kelkka7/repos", "events_url": "https://api.github.com/users/Kelkka7/events{/privacy}", "received_events_url": "https://api.github.com/users/Kelkka7/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ezhulenev", "id": 1174378, "node_id": "MDQ6VXNlcjExNzQzNzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/1174378?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezhulenev", "html_url": "https://github.com/ezhulenev", "followers_url": "https://api.github.com/users/ezhulenev/followers", "following_url": "https://api.github.com/users/ezhulenev/following{/other_user}", "gists_url": "https://api.github.com/users/ezhulenev/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezhulenev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezhulenev/subscriptions", "organizations_url": "https://api.github.com/users/ezhulenev/orgs", "repos_url": "https://api.github.com/users/ezhulenev/repos", "events_url": "https://api.github.com/users/ezhulenev/events{/privacy}", "received_events_url": "https://api.github.com/users/ezhulenev/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ezhulenev", "id": 1174378, "node_id": "MDQ6VXNlcjExNzQzNzg=", "avatar_url": "https://avatars2.githubusercontent.com/u/1174378?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ezhulenev", "html_url": "https://github.com/ezhulenev", "followers_url": "https://api.github.com/users/ezhulenev/followers", "following_url": "https://api.github.com/users/ezhulenev/following{/other_user}", "gists_url": "https://api.github.com/users/ezhulenev/gists{/gist_id}", "starred_url": "https://api.github.com/users/ezhulenev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ezhulenev/subscriptions", "organizations_url": "https://api.github.com/users/ezhulenev/orgs", "repos_url": "https://api.github.com/users/ezhulenev/repos", "events_url": "https://api.github.com/users/ezhulenev/events{/privacy}", "received_events_url": "https://api.github.com/users/ezhulenev/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-11-27T10:08:38Z", "updated_at": "2019-12-16T23:36:52Z", "closed_at": null, "author_association": "NONE", "body": "I get this as an output from my model, but the model runs and outputs a loss and an accuracy. It always posts the same 49 index numbers (I'm only posting one to avoid flooding), each of them twice. \r\n\r\n`W tensorflow/core/common_runtime/shape_refiner.cc:89] Function instantiation has undefined input shape at index: 380 in the outer inference context.`\r\n\r\nWhat does it mean? I'm using Python and I've posted a question about this [here](https://stackoverflow.com/questions/59057300/what-is-the-outer-inference-context-shape-refiner-cc-in-tensorflow-2?noredirect=1#comment104357261_59057300) and [here](https://stackoverflow.com/questions/59039788/how-to-combine-a-pre-trained-keraslayer-from-tensorflow-v-2-hub-and-tfrecords).\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34631", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34631/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34631/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34631/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34631", "id": 529089699, "node_id": "MDU6SXNzdWU1MjkwODk2OTk=", "number": 34631, "title": "Tutorial on basic classification needs some documentation improvement ", "user": {"login": "copperwiring", "id": 23316280, "node_id": "MDQ6VXNlcjIzMzE2Mjgw", "avatar_url": "https://avatars1.githubusercontent.com/u/23316280?v=4", "gravatar_id": "", "url": "https://api.github.com/users/copperwiring", "html_url": "https://github.com/copperwiring", "followers_url": "https://api.github.com/users/copperwiring/followers", "following_url": "https://api.github.com/users/copperwiring/following{/other_user}", "gists_url": "https://api.github.com/users/copperwiring/gists{/gist_id}", "starred_url": "https://api.github.com/users/copperwiring/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/copperwiring/subscriptions", "organizations_url": "https://api.github.com/users/copperwiring/orgs", "repos_url": "https://api.github.com/users/copperwiring/repos", "events_url": "https://api.github.com/users/copperwiring/events{/privacy}", "received_events_url": "https://api.github.com/users/copperwiring/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "lamberta", "id": 43051, "node_id": "MDQ6VXNlcjQzMDUx", "avatar_url": "https://avatars2.githubusercontent.com/u/43051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lamberta", "html_url": "https://github.com/lamberta", "followers_url": "https://api.github.com/users/lamberta/followers", "following_url": "https://api.github.com/users/lamberta/following{/other_user}", "gists_url": "https://api.github.com/users/lamberta/gists{/gist_id}", "starred_url": "https://api.github.com/users/lamberta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lamberta/subscriptions", "organizations_url": "https://api.github.com/users/lamberta/orgs", "repos_url": "https://api.github.com/users/lamberta/repos", "events_url": "https://api.github.com/users/lamberta/events{/privacy}", "received_events_url": "https://api.github.com/users/lamberta/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "lamberta", "id": 43051, "node_id": "MDQ6VXNlcjQzMDUx", "avatar_url": "https://avatars2.githubusercontent.com/u/43051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lamberta", "html_url": "https://github.com/lamberta", "followers_url": "https://api.github.com/users/lamberta/followers", "following_url": "https://api.github.com/users/lamberta/following{/other_user}", "gists_url": "https://api.github.com/users/lamberta/gists{/gist_id}", "starred_url": "https://api.github.com/users/lamberta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lamberta/subscriptions", "organizations_url": "https://api.github.com/users/lamberta/orgs", "repos_url": "https://api.github.com/users/lamberta/repos", "events_url": "https://api.github.com/users/lamberta/events{/privacy}", "received_events_url": "https://api.github.com/users/lamberta/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-11-27T03:19:56Z", "updated_at": "2020-01-04T02:57:07Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "Thank you for submitting a TensorFlow documentation issue. Per our GitHub\r\npolicy, we only address code/doc bugs, performance issues, feature requests, and\r\nbuild/installation issues on GitHub.\r\n\r\nThe TensorFlow docs are open source! To get involved, read the documentation\r\ncontributor guide: https://www.tensorflow.org/community/contribute/docs\r\n\r\n## URL(s) with the issue: \r\n\r\nPlease provide a link to the documentation entry, for example:\r\nhttps://www.tensorflow.org/tutorials/keras/classification/ \r\n\r\n## Description of issue (what needs changing):\r\nOne of the first step-by-step tutorial which explains a neural network is on Basic Classification [here](https://www.tensorflow.org/tutorials/keras/classification/). However, it can benefit from additional explanations on few terms like overfitting, optimizer etc.  \r\n\r\n### Clear description\r\nWe add one line description for *overfitting*  to help user get a first hand idea of what *overfitting* does. Later, we add an extra line with a link to TensorFlow definition of overfit where user can find more information. The suggested changes  are expected to make it easier for users to get an intuitive understanding of the term.\r\n\r\n### Correct links\r\n\r\nIs the link to the source code correct? Yes\r\n\r\n### Submit a pull request? \r\n\r\nYes.\r\n\r\nAre you planning to also submit a pull request to fix the issue? See the docs\r\ncontributor guide: https://www.tensorflow.org/community/contribute/docs,\r\ndocs API guide: https://www.tensorflow.org/community/contribute/docs_ref and the\r\ndocs style guide: https://www.tensorflow.org/community/contribute/docs_style\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34622", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34622/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34622/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34622/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34622", "id": 528891623, "node_id": "MDU6SXNzdWU1Mjg4OTE2MjM=", "number": 34622, "title": "Fold ADD with TRANSPOSECONV in tflite converter.", "user": {"login": "psunn", "id": 55463253, "node_id": "MDQ6VXNlcjU1NDYzMjUz", "avatar_url": "https://avatars3.githubusercontent.com/u/55463253?v=4", "gravatar_id": "", "url": "https://api.github.com/users/psunn", "html_url": "https://github.com/psunn", "followers_url": "https://api.github.com/users/psunn/followers", "following_url": "https://api.github.com/users/psunn/following{/other_user}", "gists_url": "https://api.github.com/users/psunn/gists{/gist_id}", "starred_url": "https://api.github.com/users/psunn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/psunn/subscriptions", "organizations_url": "https://api.github.com/users/psunn/orgs", "repos_url": "https://api.github.com/users/psunn/repos", "events_url": "https://api.github.com/users/psunn/events{/privacy}", "received_events_url": "https://api.github.com/users/psunn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-11-26T18:10:29Z", "updated_at": "2019-12-06T15:34:16Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n- This is a feature request and also relative to performance issue.\r\n\r\n**System information**\r\n- TensorFlow version (you are using):\r\ntf-nightly '2.1.0-dev20191126'\r\n- Are you willing to contribute it (Yes/No):\r\nYes\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nFor generating _.tflite_ file with [_TFLiteConverter_](https://www.tensorflow.org/api_docs/python/tf/lite/TFLiteConverter), when model contains [_Conv2DTranspose_](https://www.tensorflow.org/api_docs/python/tf/keras/layers/Conv2DTranspose) layers, bias cannot fold into Operator TRANSPOSECONV. It will result with extra Op ADD following Op TRANSPOSECONV.\r\nBut with other CONV-like layers (Conv2D, DepthwiseConv2D), bias will be fold into CONV layer.\r\n\r\n- [ ] **bias should fold into Op TRANSPOSECONV in tflite.**\r\n\r\nReproduce current behaviors with example code and model graph:\r\n```\r\ndef get_keras_model():\r\n    input_0 = tf.keras.layers.Input(shape=[100,100,3])\r\n    # Conv2D with bias\r\n    conv_0 = tf.keras.layers.Conv2D(filters=3, kernel_size=[3, 3],\r\n                                    use_bias=True, padding=\"same\",\r\n                                    kernel_initializer=tf.random_uniform_initializer,\r\n                                    bias_initializer=tf.random_uniform_initializer)(input_0)\r\n    # Conv2D without bias\r\n    conv_1 = tf.keras.layers.Conv2D(filters=3, kernel_size=[3, 3],\r\n                                    use_bias=False, padding=\"same\",\r\n                                    kernel_initializer=tf.random_uniform_initializer)(conv_0)\r\n    # DepthwiseConv2D with bias\r\n    depthwise_conv_0 = tf.keras.layers.DepthwiseConv2D(kernel_size=[3, 3],\r\n                                                       use_bias=True, padding=\"same\",\r\n                                                       kernel_initializer=tf.random_uniform_initializer,\r\n                                                       bias_initializer=tf.random_uniform_initializer)(conv_1)\r\n    # DepthiseConv2D without bias\r\n    depthwise_conv_1 = tf.keras.layers.DepthwiseConv2D(kernel_size=[3, 3],\r\n                                                       use_bias=False, padding=\"same\",\r\n                                                       kernel_initializer=tf.random_uniform_initializer)(depthwise_conv_0)\r\n    # TrasposeConv with bias\r\n    transpose_conv_0 = tf.keras.layers.Conv2DTranspose(filters=3, kernel_size=[3,3],\r\n                                                       use_bias=True, padding=\"same\",\r\n                                                       kernel_initializer=tf.random_uniform_initializer,\r\n                                                       bias_initializer=tf.random_uniform_initializer)(depthwise_conv_1)\r\n    # TrasposeConv without bias\r\n    transpose_conv_1 = tf.keras.layers.Conv2DTranspose(filters=3, kernel_size=[3, 3],\r\n                                                       use_bias=False, padding=\"same\",\r\n                                                       kernel_initializer=tf.random_uniform_initializer)(transpose_conv_0)\r\n\r\n    keras_model = tf.keras.models.Model(inputs=[input_0], outputs=[transpose_conv_1])\r\n\r\n    return keras_model\r\n\r\n\r\ndef gen_tflite():\r\n\r\n    keras_model = get_keras_model()\r\n    keras_model.compile(loss=tf.keras.losses.categorical_crossentropy,\r\n                        optimizer='adam',\r\n                        metrics=['accuracy'])\r\n    converter = tf.lite.TFLiteConverter.from_keras_model(keras_model)\r\n    tflite_quant_model = converter.convert()\r\n    open('conv.tflite', 'wb').write(tflite_quant_model)\r\n\r\ngen_tflite()\r\n```\r\nAs the graph below shows, _TFLiteConverter_ will fold bias with Conv2D and Depthwise2D, but not fold bias with TransposeConv:\r\n![image](https://user-images.githubusercontent.com/55463253/69658482-2f0f3d00-1074-11ea-944f-f46fe3723453.png)\r\n\r\n**Will this change the current api? How?**\r\n\r\nIt will not affect any TF python api.\r\nIt will affect [tflite](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/lite/kernels/transpose_conv.cc#L341) as bias added.\r\n\r\n**Who will benefit with this feature?**\r\n\r\nUsers of TensorFlow, as \r\n\r\n- consistent implementation/behavior between conv-like layers\r\n\r\n- Performance boost when tflite running on device, as TRANSPOSECONV + ADD folded into TRANSPOSECONV\r\n\r\n**Any Other info.**\r\nN/A"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34618", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34618/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34618/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34618/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34618", "id": 528776249, "node_id": "MDU6SXNzdWU1Mjg3NzYyNDk=", "number": 34618, "title": "Support exporting the transform graph from tf.Transform together with the model graph defined using Keras to SavedModel in TensorFlow 2.0", "user": {"login": "brightcoder01", "id": 55301748, "node_id": "MDQ6VXNlcjU1MzAxNzQ4", "avatar_url": "https://avatars2.githubusercontent.com/u/55301748?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brightcoder01", "html_url": "https://github.com/brightcoder01", "followers_url": "https://api.github.com/users/brightcoder01/followers", "following_url": "https://api.github.com/users/brightcoder01/following{/other_user}", "gists_url": "https://api.github.com/users/brightcoder01/gists{/gist_id}", "starred_url": "https://api.github.com/users/brightcoder01/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brightcoder01/subscriptions", "organizations_url": "https://api.github.com/users/brightcoder01/orgs", "repos_url": "https://api.github.com/users/brightcoder01/repos", "events_url": "https://api.github.com/users/brightcoder01/events{/privacy}", "received_events_url": "https://api.github.com/users/brightcoder01/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-11-26T14:52:25Z", "updated_at": "2020-02-17T00:50:04Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using): TensorFlow 2.0\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n**Describe the feature and the current behavior/state.**\r\nThe feature is:  improve `tf.saved.saved_model` Api in Keras and support exporting the transform graph from tf.Transform and the graph from the Keras model together into a single SavedModel.\r\n\r\n**Current behavior/state** about how to export transform graph and model graph together to a SavedModel?  \r\nEstimator (Work well):  \r\nFrom [tf.transform official tutorial](https://github.com/tensorflow/transform/blob/cf517f1a8765e6552d09cee65efea80e26c05f5e/examples/census_example.py#L380-L382), at the stage of exporting model, it will call [estimator.export_saved_model(exported_model_dir, serving_input_fn)](https://github.com/tensorflow/estimator/blob/b22a912de2693322622d6f50e3a19e98fecac441/tensorflow_estimator/python/estimator/estimator.py#L661) to complete the model exporting work. Inside its implementation, it calls serving_input_fn to load the transform graph from SavedModel at first, and then calls estimator's model_fn to generate the model graph, combines these two graph into one graph and finally exports it into one SavedModel. Please check the [code snippet](https://github.com/tensorflow/estimator/blob/43921b4552d1c30acc31d3b5989112cb397383e0/tensorflow_estimator/python/estimator/estimator.py#L926-L937).  \r\n\r\nKeras (Can not):  \r\nFor TF2.0, we define a model using keras and exports it by calling [tf.saved.saved_model](https://www.tensorflow.org/api_docs/python/tf/saved_model/save). This SavedModel only contains the model definition including feature columns and network structure. `tf.saved.saved_model` api doesn't have the parameter `serving_input_fn` just like estimator and **it lacks the flexibility to combine transform graph and model graph together for inference**.\r\n\r\n**Will this change the current api? How?**\r\nWill change the Api `tf.saved.save_model`, add a new parameter `serving_input_fn`.\r\n\r\n**Who will benefit with this feature?**\r\nThe users of tf.Transform and TensorFlow 2.0\r\n\r\n**Any Other info.**\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34612", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34612/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34612/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34612/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34612", "id": 528657152, "node_id": "MDU6SXNzdWU1Mjg2NTcxNTI=", "number": 34612, "title": "Build a static tensorflow on Alpine linux ", "user": {"login": "stereomatchingkiss", "id": 1801914, "node_id": "MDQ6VXNlcjE4MDE5MTQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/1801914?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stereomatchingkiss", "html_url": "https://github.com/stereomatchingkiss", "followers_url": "https://api.github.com/users/stereomatchingkiss/followers", "following_url": "https://api.github.com/users/stereomatchingkiss/following{/other_user}", "gists_url": "https://api.github.com/users/stereomatchingkiss/gists{/gist_id}", "starred_url": "https://api.github.com/users/stereomatchingkiss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stereomatchingkiss/subscriptions", "organizations_url": "https://api.github.com/users/stereomatchingkiss/orgs", "repos_url": "https://api.github.com/users/stereomatchingkiss/repos", "events_url": "https://api.github.com/users/stereomatchingkiss/events{/privacy}", "received_events_url": "https://api.github.com/users/stereomatchingkiss/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-11-26T11:16:48Z", "updated_at": "2019-12-19T22:02:20Z", "closed_at": null, "author_association": "NONE", "body": "Any instructions, documents or blogs show us how to build static library of tensorflow on Alpine linux? I want to port the object detection model(and other) to aws lambda, build tensorflow as a static library could save a lot of troubles"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34608", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34608/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34608/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34608/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34608", "id": 528574911, "node_id": "MDU6SXNzdWU1Mjg1NzQ5MTE=", "number": 34608, "title": " whether tflite can not support the two operator ( MaxPool2D and QUANTIZE) in TensorFlow 2.0.0 when running the mode in embed freeRTOS system?", "user": {"login": "raygong1207", "id": 58207794, "node_id": "MDQ6VXNlcjU4MjA3Nzk0", "avatar_url": "https://avatars3.githubusercontent.com/u/58207794?v=4", "gravatar_id": "", "url": "https://api.github.com/users/raygong1207", "html_url": "https://github.com/raygong1207", "followers_url": "https://api.github.com/users/raygong1207/followers", "following_url": "https://api.github.com/users/raygong1207/following{/other_user}", "gists_url": "https://api.github.com/users/raygong1207/gists{/gist_id}", "starred_url": "https://api.github.com/users/raygong1207/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/raygong1207/subscriptions", "organizations_url": "https://api.github.com/users/raygong1207/orgs", "repos_url": "https://api.github.com/users/raygong1207/repos", "events_url": "https://api.github.com/users/raygong1207/events{/privacy}", "received_events_url": "https://api.github.com/users/raygong1207/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-11-26T08:48:54Z", "updated_at": "2019-12-03T22:08:27Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution : Window 7\r\n- TensorFlow installed from : Install TensorFlow 2.0.0  by anaconda. It should be binary\r\n- TensorFlow version (or github SHA if from source): 2.0.0\r\n\r\n\r\n**Provide the text output from tflite_convert**\r\nBelow is the tf.lite.convert output information after convert finished.\r\n```\r\n2019-11-26 16:16:17.608537: I tensorflow/core/grappler/devices.cc:60] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0 (Note: TensorFlow was not compiled with CUDA support)\r\n2019-11-26 16:16:17.609537: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2019-11-26 16:16:17.712547: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:716] Optimization results for grappler item: graph_to_optimize\r\n2019-11-26 16:16:17.712547: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:718]   function_optimizer: function_optimizer did nothing. time = 8.001ms.\r\n2019-11-26 16:16:17.712547: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:718]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2019-11-26 16:16:17.738550: I tensorflow/core/grappler/devices.cc:60] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0 (Note: TensorFlow was not compiled with CUDA support)\r\n2019-11-26 16:16:17.739550: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2019-11-26 16:16:17.807557: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:716] Optimization results for grappler item: graph_to_optimize\r\n2019-11-26 16:16:17.808557: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:718]   constant folding: Graph size after: 15 nodes (-4), 18 edges (-4), time = 52.005ms.\r\n2019-11-26 16:16:17.808557: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:718]   constant folding: Graph size after: 15 nodes (0), 18 edges (0), time = 1ms.\r\nINFO: Initialized TensorFlow Lite runtime.\r\ngenerate: ./cnn.tflite\r\n```\r\n\r\nAlso, please include a link to a GraphDef or the model if possible.\r\nMy first model code:\r\nmodel = tf.keras.models.Sequential()\r\nmodel.add(tf.keras.layers.Conv2D(filters=32,   kernel_size=[5, 5],  padding='same',\r\n                                activation=tf.nn.relu,input_shape=(feature_cnt_max, feature_dim_cnt,1)))\r\nmodel.add(tf.keras.layers.Dropout(0.2))\r\nmodel.add(tf.keras.layers.MaxPool2D(pool_size=[2, 2], strides=2))\r\nmodel.add(tf.keras.layers.Conv2D(filters=32, kernel_size=[3, 3],padding='same',activation=tf.nn.relu))\r\nmodel.add(tf.keras.layers.MaxPool2D(pool_size=[2, 2], strides=2))\r\nmodel.add(tf.keras.layers.Dropout(0.2))\r\nmodel.add(tf.keras.layers.Flatten())\r\nmodel.add(tf.keras.layers.Dense(units=num_fc_hide,activation=tf.nn.relu))\r\nmodel.add(tf.keras.layers.Dropout(0.2))\r\nmodel.add(tf.keras.layers.Dense(units=num_class,activation=tf.nn.softmax))\r\nmodel.build(input_shape=(None,feature_cnt_max, feature_dim_cnt,1))\r\n\r\nMy second model code:\r\nmodel = tf.keras.models.Sequential()\r\nmodel.add(tf.keras.layers.Conv2D(filters=186,\r\n                                kernel_size=[first_filter_height, first_filter_width],\r\n                                padding='valid',\r\n                                activation=tf.nn.relu,input_shape=(feature_cnt_max, feature_dim_cnt,1)))\r\nmodel.add(tf.keras.layers.Dropout(0.2))\r\nmodel.add(tf.keras.layers.Flatten())\r\nmodel.add(tf.keras.layers.Dense(units=num_class,activation=tf.nn.softmax))\r\nmodel.build(input_shape=(None,feature_cnt_max, feature_dim_cnt,1))\r\n\r\n\r\n**Any other info / logs**\r\nI convert the two model into *tflite by below code:\r\n(https://github.com/tensorflow/tensorflow/files/3890814/covert_h5_to_tflite.txt)\r\n\r\ncovert_h5_to_tflite.py\r\nMy question is:\r\n1: When i use the first model and do not do quantization, i meet the the err info report \"Didn't find op for builtin opcode 'MaxPool2D' version '1'\" when run the the model in my Embedded freeRTOS system.\r\n2: When i use the second model and do quantization, i meet the the err info report \"Didn't find op for builtin opcode 'QUANTIZE' version '1'\" when run the the model in my Embedded freeRTOS system.\r\n3: Below code add the TF_OPS, but the tflite are same with no TF_OPS, why?\r\n    converter.target_spec.supported_ops = [tf.lite.OpsSet.TFLITE_BUILTINS,tf.lite.OpsSet.SELECT_TF_OPS]\r\n\r\nSo i want to know whether tflite can not support the two operator ( MaxPool2D and QUANTIZE) in tensorflow 2.0.0? How about tensorflow 1.1x?\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34607", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34607/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34607/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34607/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34607", "id": 528543048, "node_id": "MDU6SXNzdWU1Mjg1NDMwNDg=", "number": 34607, "title": "ModuleNotFoundError: No module named 'tensorflow_core.keras' in Flask", "user": {"login": "zzeniale", "id": 49807268, "node_id": "MDQ6VXNlcjQ5ODA3MjY4", "avatar_url": "https://avatars2.githubusercontent.com/u/49807268?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zzeniale", "html_url": "https://github.com/zzeniale", "followers_url": "https://api.github.com/users/zzeniale/followers", "following_url": "https://api.github.com/users/zzeniale/following{/other_user}", "gists_url": "https://api.github.com/users/zzeniale/gists{/gist_id}", "starred_url": "https://api.github.com/users/zzeniale/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zzeniale/subscriptions", "organizations_url": "https://api.github.com/users/zzeniale/orgs", "repos_url": "https://api.github.com/users/zzeniale/repos", "events_url": "https://api.github.com/users/zzeniale/events{/privacy}", "received_events_url": "https://api.github.com/users/zzeniale/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1205765054, "node_id": "MDU6TGFiZWwxMjA1NzY1MDU0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:macOS", "name": "subtype:macOS", "color": "b619ea", "default": false, "description": "macOS Build/Installation issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 44, "created_at": "2019-11-26T07:35:02Z", "updated_at": "2020-03-10T21:01:35Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS X 10.15.1 Catalina\r\n- TensorFlow version: 1.15.0\r\n- Python version: 3.7.3\r\n- virtualenv (Flask)\r\n\r\n**Describe the problem**\r\nI'm unable to import and run a model using Flask services because of this error: ModuleNotFoundError: No module named 'tensorflow_core.keras'\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n- I have pip installed keras and tensorflow into my virtualenv (I've also tried pip3 install)\r\n- My code is like this:\r\n```\r\nimport tensorflow as tf\r\nfrom keras.models import load_model\r\nmodel = load_model(\"model.hdf5\")\r\n# ... preprocess images\r\npredictions = model.predict(processed_images)\r\n```\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/Users/llemonthyme/Desktop/traffic-app/flaskservice/bin/flask\", line 8, in <module>\r\n    sys.exit(main())\r\n  File \"/Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/flask/cli.py\", line 966, in main\r\n    cli.main(prog_name=\"python -m flask\" if as_module else None)\r\n  File \"/Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/flask/cli.py\", line 586, in main\r\n    return super(FlaskGroup, self).main(*args, **kwargs)\r\n  File \"/Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/click/core.py\", line 717, in main\r\n    rv = self.invoke(ctx)\r\n  File \"/Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/click/core.py\", line 1137, in invoke\r\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\r\n  File \"/Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/click/core.py\", line 956, in invoke\r\n    return ctx.invoke(self.callback, **ctx.params)\r\n  File \"/Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/click/core.py\", line 555, in invoke\r\n    return callback(*args, **kwargs)\r\n  File \"/Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/click/decorators.py\", line 64, in new_func\r\n    return ctx.invoke(f, obj, *args, **kwargs)\r\n  File \"/Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/click/core.py\", line 555, in invoke\r\n    return callback(*args, **kwargs)\r\n  File \"/Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/flask/cli.py\", line 860, in run_command\r\n    extra_files=extra_files,\r\n  File \"/Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/werkzeug/serving.py\", line 1008, in run_simple\r\n    run_with_reloader(inner, extra_files, reloader_interval, reloader_type)\r\n  File \"/Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/werkzeug/_reloader.py\", line 337, in run_with_reloader\r\n    reloader.run()\r\n  File \"/Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/werkzeug/_reloader.py\", line 202, in run\r\n    for filename in chain(_iter_module_files(), self.extra_files):\r\n  File \"/Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/werkzeug/_reloader.py\", line 24, in _iter_module_files\r\n    filename = getattr(module, \"__file__\", None)\r\n  File \"/Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/tensorflow/__init__.py\", line 50, in __getattr__\r\n    module = self._load()\r\n  File \"/Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/tensorflow/__init__.py\", line 44, in _load\r\n    module = _importlib.import_module(self.__name__)\r\n  File \"/Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/importlib/__init__.py\", line 127, in import_module\r\n    return _bootstrap._gcd_import(name[level:], package, level)\r\n  File \"<frozen importlib._bootstrap>\", line 1006, in _gcd_import\r\n  File \"<frozen importlib._bootstrap>\", line 983, in _find_and_load\r\n  File \"<frozen importlib._bootstrap>\", line 965, in _find_and_load_unlocked\r\nModuleNotFoundError: No module named 'tensorflow_core.keras'\r\nUsing TensorFlow backend.\r\nUsing TensorFlow backend.\r\nWARNING:tensorflow:From /Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nIf using Keras pass *_constraint arguments to layers.\r\nWARNING:tensorflow:From /Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nIf using Keras pass *_constraint arguments to layers.\r\nWARNING:tensorflow:From /Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4070: The name tf.nn.max_pool is deprecated. Please use tf.nn.max_pool2d instead.\r\n\r\nWARNING:tensorflow:From /Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4070: The name tf.nn.max_pool is deprecated. Please use tf.nn.max_pool2d instead.\r\n\r\n2019-11-26 15:33:29.703531: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fb84403e4f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n2019-11-26 15:33:29.703585: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\n2019-11-26 15:33:29.705059: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa1f9bbcd00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n2019-11-26 15:33:29.705389: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\nWARNING:tensorflow:From /Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1424: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse tf.where in 2.0, which has the same broadcast rule as np.where\r\nWARNING:tensorflow:From /Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/tensorflow_core/python/ops/math_grad.py:1424: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse tf.where in 2.0, which has the same broadcast rule as np.where\r\nWARNING:tensorflow:From /Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:422: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.\r\n\r\nWARNING:tensorflow:From /Users/llemonthyme/Desktop/traffic-app/flaskservice/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:422: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34604", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34604/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34604/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34604/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34604", "id": 528503409, "node_id": "MDU6SXNzdWU1Mjg1MDM0MDk=", "number": 34604, "title": "How to quickly add extract_image_patch op support in tflite?", "user": {"login": "siju-samuel", "id": 15828974, "node_id": "MDQ6VXNlcjE1ODI4OTc0", "avatar_url": "https://avatars1.githubusercontent.com/u/15828974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/siju-samuel", "html_url": "https://github.com/siju-samuel", "followers_url": "https://api.github.com/users/siju-samuel/followers", "following_url": "https://api.github.com/users/siju-samuel/following{/other_user}", "gists_url": "https://api.github.com/users/siju-samuel/gists{/gist_id}", "starred_url": "https://api.github.com/users/siju-samuel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/siju-samuel/subscriptions", "organizations_url": "https://api.github.com/users/siju-samuel/orgs", "repos_url": "https://api.github.com/users/siju-samuel/repos", "events_url": "https://api.github.com/users/siju-samuel/events{/privacy}", "received_events_url": "https://api.github.com/users/siju-samuel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-11-26T05:48:12Z", "updated_at": "2019-12-11T05:48:13Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):Ubuntu 18.04\r\n- TensorFlow installed from (source or binary):Source\r\n- TensorFlow version (or github SHA if from source):1.14\r\n\r\n\r\n**Command used to run the converter or code if you\u2019re using the Python API**\r\n\r\n```\r\nimport tensorflow as tf\r\nsaved_model_dir=\"./\"\r\nconverter = tf.lite.TFLiteConverter.from_saved_model(saved_model_dir)\r\nconverter.target_ops = [tf.lite.OpsSet.TFLITE_BUILTINS,\r\n                                       tf.lite.OpsSet.SELECT_TF_OPS]\r\n#converter.allow_custom_ops=True\r\ntflite_model = converter.convert()\r\nopen(\"./converted_model.tflite\", \"wb\").write(tflite_model)\r\n```\r\n\r\n**The output from the converter invocation**\r\n\r\n```\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime and are not recognized by TensorFlow. If you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: ADD, CAST, CONCATENATION, CONV_2D, DIV, ELU, LOGISTIC, MAXIMUM, MINIMUM, MUL, RELU, RESHAPE, RESIZE_NEAREST_NEIGHBOR, REVERSE_V2, SOFTMAX, SPLIT, SQRT, SQUARE, STRIDED_SLICE, SUM, TANH, TRANSPOSE, TRANSPOSE_CONV. Here is a list of operators for which you will need custom implementations: ExtractImagePatches.\r\nTraceback (most recent call last):\r\n  File \"/home/siju/.local/bin/toco_from_protos\", line 8, in <module>\r\n    sys.exit(main())\r\n  File \"/home/siju/.local/lib/python3.6/site-packages/tensorflow/lite/toco/python/toco_from_protos.py\", line 59, in main\r\n    app.run(main=execute, argv=[sys.argv[0]] + unparsed)\r\n  File \"/home/siju/.local/lib/python3.6/site-packages/tensorflow/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/home/siju/.local/lib/python3.6/site-packages/absl/app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"/home/siju/.local/lib/python3.6/site-packages/absl/app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/home/siju/.local/lib/python3.6/site-packages/tensorflow/lite/toco/python/toco_from_protos.py\", line 33, in execute\r\n    output_str = tensorflow_wrap_toco.TocoConvert(model_str, toco_str, input_str)\r\nException: We are continually in the process of adding support to TensorFlow Lite for more ops. It would be helpful if you could inform us of how this conversion went by opening a github issue at https://github.com/tensorflow/tensorflow/issues/new?template=40-tflite-op-request.md\r\n and pasting the following:\r\n\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime and are not recognized by TensorFlow. If you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: ADD, CAST, CONCATENATION, CONV_2D, DIV, ELU, LOGISTIC, MAXIMUM, MINIMUM, MUL, RELU, RESHAPE, RESIZE_NEAREST_NEIGHBOR, REVERSE_V2, SOFTMAX, SPLIT, SQRT, SQUARE, STRIDED_SLICE, SUM, TANH, TRANSPOSE, TRANSPOSE_CONV. Here is a list of operators for which you will need custom implementations: ExtractImagePatches.\r\n```\r\n\r\n**Also, please include a link to the saved model or GraphDef**\r\n\r\n[saved_model.zip](https://github.com/tensorflow/tensorflow/files/3890254/saved_model.zip)\r\n\r\n\r\n**Failure details**\r\nI want to implement a block of contextual attenuation which contains op\r\n[extract image patches](https://www.tensorflow.org/api_docs/python/tf/image/extract_patches)\r\nThis op is not the first/last one. its in the middle so that i cannot do the processing outside the model.\r\n\r\n**Any other info / logs**\r\nNO\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34595", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34595/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34595/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34595/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34595", "id": 528353601, "node_id": "MDU6SXNzdWU1MjgzNTM2MDE=", "number": 34595, "title": "Custom loss with VGG16 features works in keras and doesn't work in tf.keras", "user": {"login": "muxgt", "id": 54779582, "node_id": "MDQ6VXNlcjU0Nzc5NTgy", "avatar_url": "https://avatars3.githubusercontent.com/u/54779582?v=4", "gravatar_id": "", "url": "https://api.github.com/users/muxgt", "html_url": "https://github.com/muxgt", "followers_url": "https://api.github.com/users/muxgt/followers", "following_url": "https://api.github.com/users/muxgt/following{/other_user}", "gists_url": "https://api.github.com/users/muxgt/gists{/gist_id}", "starred_url": "https://api.github.com/users/muxgt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/muxgt/subscriptions", "organizations_url": "https://api.github.com/users/muxgt/orgs", "repos_url": "https://api.github.com/users/muxgt/repos", "events_url": "https://api.github.com/users/muxgt/events{/privacy}", "received_events_url": "https://api.github.com/users/muxgt/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-11-25T21:42:42Z", "updated_at": "2020-03-16T18:37:45Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Google Colab. Ubuntu 18.04.3\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary):\r\n- TensorFlow version (use command below): 1.15\r\n- Python version: 3\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\n**Describe the current behavior**\r\n\r\nI'm using tensorflow.keras with TF 1.15 in Colab. I have custom loss function that loads VGG16 from tf.keras and does feature extraction from y_pred and y_true. This feature extraction works if I pass as arguments either y_true or y_pred or any expression without y_true. If I pass expression with y_true and something else it raises error: `You must feed a value for placeholder tensor 'dense_4_target' with dtype float and shape [?,?,?,?]\r\n\t [[{{node dense_4_target}}]]` The same code works when I change tensorflow.keras to just keras.\r\n\r\n**Describe the expected behavior**\r\n\r\nModel should compile without errors as in pure Keras\r\n\r\n**Code to reproduce the issue**\r\nPlease find gist [here](https://colab.research.google.com/gist/muxgt/c467f0a999f3a517264040465af4a5a0/untitled10.ipynb#scrollTo=GEBbaquGImyU)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34590", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34590/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34590/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34590/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/34590", "id": 528298005, "node_id": "MDExOlB1bGxSZXF1ZXN0MzQ1Mzg1NTMz", "number": 34590, "title": "Make a TFLite test case run on big-endian machines", "user": {"login": "frreiss", "id": 12436991, "node_id": "MDQ6VXNlcjEyNDM2OTkx", "avatar_url": "https://avatars1.githubusercontent.com/u/12436991?v=4", "gravatar_id": "", "url": "https://api.github.com/users/frreiss", "html_url": "https://github.com/frreiss", "followers_url": "https://api.github.com/users/frreiss/followers", "following_url": "https://api.github.com/users/frreiss/following{/other_user}", "gists_url": "https://api.github.com/users/frreiss/gists{/gist_id}", "starred_url": "https://api.github.com/users/frreiss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/frreiss/subscriptions", "organizations_url": "https://api.github.com/users/frreiss/orgs", "repos_url": "https://api.github.com/users/frreiss/repos", "events_url": "https://api.github.com/users/frreiss/events{/privacy}", "received_events_url": "https://api.github.com/users/frreiss/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-11-25T19:43:22Z", "updated_at": "2020-03-19T12:26:29Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/34590", "html_url": "https://github.com/tensorflow/tensorflow/pull/34590", "diff_url": "https://github.com/tensorflow/tensorflow/pull/34590.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/34590.patch"}, "body": "The test case `BasicInterpreter.ThreeStepAllocate` in `/tensorflow/lite/interpreter_test.cc` uses an array of little-endian binary data as one of its inputs. The little-endian data prevents this test from working properly on big-endian machines.\r\n\r\nThis pull request replaces the array of little-endian data with a struct, so that the embedded 32-bit fields will be in little-endian format on little-endian machines and in big-endian format on big-endian machines. After this change, the test case passes on both little-endian and big-endian machines."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34589", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34589/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34589/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34589/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/34589", "id": 528254412, "node_id": "MDExOlB1bGxSZXF1ZXN0MzQ1MzUxODMx", "number": 34589, "title": "TANH/Sigmoid 16-bit activation functions using LUT", "user": {"login": "wwwind", "id": 1513336, "node_id": "MDQ6VXNlcjE1MTMzMzY=", "avatar_url": "https://avatars0.githubusercontent.com/u/1513336?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wwwind", "html_url": "https://github.com/wwwind", "followers_url": "https://api.github.com/users/wwwind/followers", "following_url": "https://api.github.com/users/wwwind/following{/other_user}", "gists_url": "https://api.github.com/users/wwwind/gists{/gist_id}", "starred_url": "https://api.github.com/users/wwwind/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wwwind/subscriptions", "organizations_url": "https://api.github.com/users/wwwind/orgs", "repos_url": "https://api.github.com/users/wwwind/repos", "events_url": "https://api.github.com/users/wwwind/events{/privacy}", "received_events_url": "https://api.github.com/users/wwwind/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1169365494, "node_id": "MDU6TGFiZWwxMTY5MzY1NDk0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:M", "name": "size:M", "color": "adafea", "default": false, "description": "CL Change Size: Medium"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 13, "created_at": "2019-11-25T18:16:30Z", "updated_at": "2020-03-19T12:24:14Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/34589", "html_url": "https://github.com/tensorflow/tensorflow/pull/34589", "diff_url": "https://github.com/tensorflow/tensorflow/pull/34589.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/34589.patch"}, "body": "We think the reference functions for 16-bit activation are too complex for efficient implementation on resource constrained platforms and propose to replace the functions with a lookup table approach as follows:\r\n\r\nFirst rescale the input data to fixed range of -10.7 to +10.7. Then use a 256-entry lookup table for Sigmoid followed by linear interpolation to efficiently derive the result.\r\n\r\nThe Sigmoid LUT table is used for the TANH function, because tanh(x) = 2*sigmoid(2*x) -1 and we take into account the symmetry.\r\n\r\nThe proposed reference kernel implementation also has higher accuracy than the existing one.\r\nOn the current functions we measure a difference of up to 6.3 for sigmoid and 11.7 for tanh in quantized units compared to the floating point reference implementation over the 16-bit input range (representing -8.0 to +8.0). For the implementation of this patch we see the error reduced to less than 1.5 quantized units compared to floating point reference for both tanh and sigmoid."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34586", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34586/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34586/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34586/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34586", "id": 528228372, "node_id": "MDU6SXNzdWU1MjgyMjgzNzI=", "number": 34586, "title": "Documentation Error on nn.ctc_loss", "user": {"login": "leonardoaraujosantos", "id": 898383, "node_id": "MDQ6VXNlcjg5ODM4Mw==", "avatar_url": "https://avatars1.githubusercontent.com/u/898383?v=4", "gravatar_id": "", "url": "https://api.github.com/users/leonardoaraujosantos", "html_url": "https://github.com/leonardoaraujosantos", "followers_url": "https://api.github.com/users/leonardoaraujosantos/followers", "following_url": "https://api.github.com/users/leonardoaraujosantos/following{/other_user}", "gists_url": "https://api.github.com/users/leonardoaraujosantos/gists{/gist_id}", "starred_url": "https://api.github.com/users/leonardoaraujosantos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/leonardoaraujosantos/subscriptions", "organizations_url": "https://api.github.com/users/leonardoaraujosantos/orgs", "repos_url": "https://api.github.com/users/leonardoaraujosantos/repos", "events_url": "https://api.github.com/users/leonardoaraujosantos/events{/privacy}", "received_events_url": "https://api.github.com/users/leonardoaraujosantos/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-11-25T17:22:45Z", "updated_at": "2019-11-26T19:22:35Z", "closed_at": null, "author_association": "NONE", "body": "Thank you for submitting a TensorFlow documentation issue. Per our GitHub\r\npolicy, we only address code/doc bugs, performance issues, feature requests, and\r\nbuild/installation issues on GitHub.\r\n\r\nThe TensorFlow docs are open source! To get involved, read the documentation\r\ncontributor guide: https://www.tensorflow.org/community/contribute/docs\r\n\r\n## URL(s) with the issue:\r\nhttps://www.tensorflow.org/api_docs/python/tf/nn/ctc_loss\r\n\r\n## Description of issue (what needs changing):\r\nThe logits and logits_time_major parameters are ill defined.\r\n### Current on docs\r\n* logits: tensor of shape [frames, batch_size, num_labels], if logits_time_major == False, shape is [batch_size, frames, num_labels].\r\n* logits_time_major: (optional) If True (default), logits is shaped [time, batch, logits]. If False, shape is [batch, time, logits]\r\n\r\n### Clear description\r\n* logits: tensor of shape [time, batch_size, num_labels], if logits_time_major == True. Shape is [batch_size, frames, num_labels] if logits_time_major == False.\r\n* logits_time_major: (optional) If True (default), logits is shaped [time, batch_size, num_labels]. If False, shape is [batch_size, time, num_labels]\r\n\r\n### Submit a pull request?\r\nI'm preparing a PR\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34585", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34585/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34585/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34585/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34585", "id": 528141786, "node_id": "MDU6SXNzdWU1MjgxNDE3ODY=", "number": 34585, "title": "Tensorflow 2.0 does not iterate through entire dataset when tf.keras.model.fit is called", "user": {"login": "michaelarfreed", "id": 9046261, "node_id": "MDQ6VXNlcjkwNDYyNjE=", "avatar_url": "https://avatars1.githubusercontent.com/u/9046261?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michaelarfreed", "html_url": "https://github.com/michaelarfreed", "followers_url": "https://api.github.com/users/michaelarfreed/followers", "following_url": "https://api.github.com/users/michaelarfreed/following{/other_user}", "gists_url": "https://api.github.com/users/michaelarfreed/gists{/gist_id}", "starred_url": "https://api.github.com/users/michaelarfreed/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michaelarfreed/subscriptions", "organizations_url": "https://api.github.com/users/michaelarfreed/orgs", "repos_url": "https://api.github.com/users/michaelarfreed/repos", "events_url": "https://api.github.com/users/michaelarfreed/events{/privacy}", "received_events_url": "https://api.github.com/users/michaelarfreed/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}, {"login": "rachellim", "id": 9589037, "node_id": "MDQ6VXNlcjk1ODkwMzc=", "avatar_url": "https://avatars3.githubusercontent.com/u/9589037?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rachellim", "html_url": "https://github.com/rachellim", "followers_url": "https://api.github.com/users/rachellim/followers", "following_url": "https://api.github.com/users/rachellim/following{/other_user}", "gists_url": "https://api.github.com/users/rachellim/gists{/gist_id}", "starred_url": "https://api.github.com/users/rachellim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rachellim/subscriptions", "organizations_url": "https://api.github.com/users/rachellim/orgs", "repos_url": "https://api.github.com/users/rachellim/repos", "events_url": "https://api.github.com/users/rachellim/events{/privacy}", "received_events_url": "https://api.github.com/users/rachellim/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-11-25T14:58:33Z", "updated_at": "2020-02-11T15:46:14Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): **yes**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): **Mac OS 10.14.6**\r\n- TensorFlow installed from (source or binary): **source**\r\n- TensorFlow version (use command below): **2.0**\r\n- Python version: **3.6.0**\r\n\r\n**Describe the current behavior**\r\nI am training a model in tf.keras with tensorflow 2.0. **I am having an issue where my model appears to train successfully, but it is not iterating through the entire dataset.** A few things indicate that it's not going through the entire dataset: \r\n\r\n1. the model is training super fast (an epoch should take ~45 minutes, which is estimated, but it always finishes in < 1 minute),\r\n2. the validation metrics are always reported 0. and,\r\n3. the progress bar that prints out never fills up, and it stops at ~1/1000 of the data. \r\n\r\nThe progress bar during training looks something like this:\r\n\r\n```\r\nEpoch 1/300   192/162636 [..............................] - ETA: 45:42 - loss: 0.4783 - mean_squared_error: 0.4783 - val_loss: 0.0000e+00 - val_mean_squared_error: 0.0000e+00\r\nEpoch 2/300   186/162636 [..............................] - ETA: 45:42 - loss: 0.4783 - mean_squared_error: 0.4783 - val_loss: 0.0000e+00 - val_mean_squared_error: 0.0000e+00\r\n...\r\nEpoch X/300   192/162636 [..............................] - ETA: 45:42 - loss: 0.4783 - mean_squared_error: 0.4783 - val_loss: 0.0000e+00 - val_mean_squared_error: 0.0000e+00\r\n```\r\n\r\n I restructured the code into tensorflow 1.15, and I do not have this issue. When I call `tf.compat.v1.enable_v2_behavior()`, I see this behavior again. There are no errors, warnings, or info that is reported, it just stops iterating through my dataset early. I am following [this tutorial](https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/#comment-510384) for Multiple Input Series. \r\n\r\n**Describe the expected behavior**\r\nThe expected behavior is that an epoch will completely go through the dataset, and it will report a reasonable validation loss, and it will take some time to go through the entire dataset. I see the correct behavior in TF 1.15, and the epochs take ~45 minutes to complete (as expected), the validation metrics are calculated, and the progress bar looks something like this (which is nothing special :) )\r\n```\r\nEpoch 16/300\r\n162605/162636 [============================>.] - ETA: 0s - loss: 1.2883e-05\r\n162636/162636 [==============================] - 2946s 1ms/sample - loss: 1.2883e-05 - val_loss: 1.5680e-05\r\nEpoch 17/300\r\n162605/162636 [============================>.] - ETA: 0s - loss: 1.2631e-05\r\n162636/162636 [==============================] - 2688s 5ms/sample - loss: 1.2633e-05 - val_loss: 2.1342e-05\r\n```\r\n\r\n**Code to reproduce the issue**\r\nI have a time-series dataset. It is very small so I am able to load it into memory, so I do not need the dataset API. I am windowing the time-series to produce two arrays, X and Y, and it looks something like this, \r\n\r\n```\r\nX=[\r\n   [[1,2,3],[4,5,6],   [7,8,9]],\r\n   [[4,5,6],[7,8,9],   [10,11,12]],\r\n   [[7,8,9],[10,11,12],[13,14,15]],\r\n   ...\r\n  ] \r\nY = [\r\n     [4],\r\n     [7],\r\n     [10],\r\n     ...\r\n    ]\r\n```\r\n\r\n(yes, I realize that I could just as easily only include one of the features. I've tried that, i.e. `X=[[[1,2,3]], [[4,5,6]], [[7,8,9]], ...], and it still doesn't work)\r\n\r\nThen, I build my model:\r\n\r\n```\r\nmodel = Sequential()\r\nmodel.add(LSTM(50, activation='relu', input_shape=(n_steps, n_features)))\r\nmodel.add(Dense(1))\r\nmodel.compile(optimizer='adam', loss='mse')\r\n```\r\n\r\nand then I train it:\r\n\r\n```\r\nmodel.fit([X],[Y],num_epochs=300,validation_split=0.2)\r\n```\r\n\r\nIt correctly reports the number of train and validation samples, and then the progress bar pops up... but that's where the success stops. The val_loss and val_mean_squared_error is always 0, for every epoch, and it appears to never train more than a fraction (~1/1000) of my dataset, although that fraction varies slightly between epochs. This is the print out:\r\n\r\n```\r\nEpoch 1/300   192/162636 [..............................] - ETA: 45:42 - loss: 0.4783 - mean_squared_error: 0.4783 - val_loss: 0.0000e+00 - val_mean_squared_error: 0.0000e+00\r\nEpoch 2/300   186/162636 [..............................] - ETA: 45:42 - loss: 0.4783 - mean_squared_error: 0.4783 - val_loss: 0.0000e+00 - val_mean_squared_error: 0.0000e+00\r\n...\r\nEpoch X/300   192/162636 [..............................] - ETA: 45:42 - loss: 0.4783 - mean_squared_error: 0.4783 - val_loss: 0.0000e+00 - val_mean_squared_error: 0.0000e+00\r\n```\r\n\r\nWhen I call `tf.compat.v1.enable_v2_behavior()` in TF 1.15, the behavior is the same as TF 2.0.\r\n\r\n\r\n**Other info / logs**\r\n[Here is a link to the StackOverflow question that I proposed before I had confirmed that this is a TensorFlow bug](https://stackoverflow.com/questions/58826512/tensorflow-2-0-does-not-iterate-through-entire-dataset-when-tf-keras-model-fit-i/59001781#59001781)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34583", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34583/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34583/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34583/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34583", "id": 528078426, "node_id": "MDU6SXNzdWU1MjgwNzg0MjY=", "number": 34583, "title": "Filter outputs for available estimators", "user": {"login": "tejaslodaya", "id": 10500049, "node_id": "MDQ6VXNlcjEwNTAwMDQ5", "avatar_url": "https://avatars0.githubusercontent.com/u/10500049?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tejaslodaya", "html_url": "https://github.com/tejaslodaya", "followers_url": "https://api.github.com/users/tejaslodaya/followers", "following_url": "https://api.github.com/users/tejaslodaya/following{/other_user}", "gists_url": "https://api.github.com/users/tejaslodaya/gists{/gist_id}", "starred_url": "https://api.github.com/users/tejaslodaya/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tejaslodaya/subscriptions", "organizations_url": "https://api.github.com/users/tejaslodaya/orgs", "repos_url": "https://api.github.com/users/tejaslodaya/repos", "events_url": "https://api.github.com/users/tejaslodaya/events{/privacy}", "received_events_url": "https://api.github.com/users/tejaslodaya/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-11-25T13:13:59Z", "updated_at": "2019-12-16T06:31:04Z", "closed_at": null, "author_association": "NONE", "body": "Hi,\r\n\r\nI have trouble standardizing outputs of Tensorflow estimators. This is achievable for pre-estimator `tf.session()` era and in custom estimators.\r\n\r\n1. Before `tf.Estimators()` came into play, I could play with the output of inference graph using `add_meta_graph_and_variables`. But I can't use this in estimators since it wraps intitalizing sessions from user.\r\n2. When building a custom estimator, I can specify `export_output` parameter and define the specific fields which I want to output.\r\n\r\nFor pre-made estimators, is there a way to pick specific fields out of the standard output?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34574", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34574/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34574/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34574/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34574", "id": 527872297, "node_id": "MDU6SXNzdWU1Mjc4NzIyOTc=", "number": 34574, "title": "tf-trt using error", "user": {"login": "andyqian2015", "id": 13864953, "node_id": "MDQ6VXNlcjEzODY0OTUz", "avatar_url": "https://avatars2.githubusercontent.com/u/13864953?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andyqian2015", "html_url": "https://github.com/andyqian2015", "followers_url": "https://api.github.com/users/andyqian2015/followers", "following_url": "https://api.github.com/users/andyqian2015/following{/other_user}", "gists_url": "https://api.github.com/users/andyqian2015/gists{/gist_id}", "starred_url": "https://api.github.com/users/andyqian2015/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andyqian2015/subscriptions", "organizations_url": "https://api.github.com/users/andyqian2015/orgs", "repos_url": "https://api.github.com/users/andyqian2015/repos", "events_url": "https://api.github.com/users/andyqian2015/events{/privacy}", "received_events_url": "https://api.github.com/users/andyqian2015/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 1754777628, "node_id": "MDU6TGFiZWwxNzU0Nzc3NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu:tensorrt", "name": "comp:gpu:tensorrt", "color": "ea98ba", "default": false, "description": "Issues specific to TensorRT"}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, {"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-11-25T06:15:09Z", "updated_at": "2019-12-26T18:34:22Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\nwhen I run  the model of  trensorrt model transforming from a tensorflow pb modle, it turn out to be an error.\r\nthe code is below:\r\nimport numpy as np\r\nimport tensorflow as tf\r\nimport time\r\n\r\nimport os\r\nos.environ[\"CUDA_DEVICE_ORDER\"] = \"PCI_BUS_ID\"\r\nos.environ[\"CUDA_VISIBLE_DEVICES\"] = \"0\"\r\n\r\nfloat16 = False\r\n\r\nif float16:\r\n    trtfilepath = \"/home/andy/models_trt/ssd/ssd_rt_16.pb\"\r\nelse:\r\n    trtfilepath = \"/home/andy/models_trt/ssd/ssd_rt_32.pb\"\r\n\r\nfeaturepath = \"/home/andy/model_data/cat.npy\"\r\n\r\noutputpath1 = \"/home/andy/model_data/ssdoutput1.npy\"\r\noutputpath2 = \"/home/andy/model_data/ssdoutput2.npy\"\r\noutputpath3 = \"/home/andy/model_data/ssdoutput3.npy\"\r\noutputpath4 = \"/home/andy/model_data/ssdoutput4.npy\"\r\n\r\nfeatures = np.load(featurepath)\r\n\r\nif float16:\r\n    features = np.load(featurepath).astype(np.float16)\r\nelse:\r\n    features = np.load(featurepath).astype(np.float32)\r\n\r\n\r\ninputs = \"image_tensor:0\"\r\noutputs1 = \"detection_boxes:0\"\r\noutputs2 = \"detection_scores:0\"\r\noutputs3 = \"num_detections:0\"\r\noutputs4 = \"detection_classes:0\"\r\n\r\nconfig = tf.ConfigProto()\r\nconfig.gpu_options.per_process_gpu_memory_fraction = 0.6\r\n\r\nwith tf.Session(config=config) as sess:\r\n    with tf.gfile.GFile(trtfilepath, 'rb') as f:\r\n        frozen_graph = tf.GraphDef()\r\n        frozen_graph.ParseFromString(f.read())\r\n        sess.graph.as_default()\r\n        tf.import_graph_def(frozen_graph, name='')\r\n        tf_input = sess.graph.get_tensor_by_name(inputs)\r\n\r\n        tf_output1 = sess.graph.get_tensor_by_name(outputs1)\r\n        tf_output2 = sess.graph.get_tensor_by_name(outputs2)\r\n        tf_output3 = sess.graph.get_tensor_by_name(outputs3)\r\n        tf_output4 = sess.graph.get_tensor_by_name(outputs4)\r\n        t1 = time.time()\r\n        output1, output2, output3, output4 = sess.run([tf_output1, tf_output2, tf_output3, tf_output4], feed_dict={\r\n            tf_input: features\r\n        })\r\n        t2 = time.time() \r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):no\r\n- OS Platform and Distribution :Linux Ubuntu 16.04):\r\n\r\n- TensorFlow installed from (source or binary):yes\r\n- TensorFlow version (use command below):tensorflow-1.14.0\r\n- Python version:python3.6\r\n- Bazel version (if compiling from source):0.24.1\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:cuda version:10.0/cudnn version7.6.2\r\n- GPU model and memory:GForce \uff11\uff10\uff16\uff10\r\n\r\nthe error list as:\r\n2019-11-25 14:23:12.077309: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1558] (One-time warning): Not using XLA:CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that envvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cache=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.\r\n2019-11-25 14:23:12.635331: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7\r\n2019-11-25 14:23:13.452120: W tensorflow/core/common_runtime/bfc_allocator.cc:237] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.04GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.\r\n2019-11-25 14:23:13.457413: W tensorflow/core/common_runtime/bfc_allocator.cc:237] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.04GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.\r\n2019-11-25 14:23:13.462873: W tensorflow/core/common_runtime/bfc_allocator.cc:237] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.06GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.\r\n2019-11-25 14:23:13.468059: W tensorflow/core/common_runtime/bfc_allocator.cc:237] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.05GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.\r\n2019-11-25 14:23:13.473325: W tensorflow/core/common_runtime/bfc_allocator.cc:237] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.09GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.\r\n2019-11-25 14:23:13.478631: W tensorflow/core/common_runtime/bfc_allocator.cc:237] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.08GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.\r\n2019-11-25 14:23:13.484220: W tensorflow/core/common_runtime/bfc_allocator.cc:237] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.15GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.\r\n2019-11-25 14:23:13.490953: W tensorflow/core/common_runtime/bfc_allocator.cc:237] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.15GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.\r\n2019-11-25 14:23:13.502852: W tensorflow/core/common_runtime/bfc_allocator.cc:237] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.14GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.\r\n2019-11-25 14:23:13.510147: W tensorflow/core/common_runtime/bfc_allocator.cc:237] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.27GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.\r\n\r\nProcess finished with exit code 139 (interrupted by signal 11: SIGSEGV)\r\n\r\nwhich make me puzzle.wish to get your reply soon.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34564", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34564/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34564/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34564/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34564", "id": 527765976, "node_id": "MDU6SXNzdWU1Mjc3NjU5NzY=", "number": 34564, "title": "experimental_connect_to_cluster hangs", "user": {"login": "MikeOfZen", "id": 28424677, "node_id": "MDQ6VXNlcjI4NDI0Njc3", "avatar_url": "https://avatars2.githubusercontent.com/u/28424677?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MikeOfZen", "html_url": "https://github.com/MikeOfZen", "followers_url": "https://api.github.com/users/MikeOfZen/followers", "following_url": "https://api.github.com/users/MikeOfZen/following{/other_user}", "gists_url": "https://api.github.com/users/MikeOfZen/gists{/gist_id}", "starred_url": "https://api.github.com/users/MikeOfZen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MikeOfZen/subscriptions", "organizations_url": "https://api.github.com/users/MikeOfZen/orgs", "repos_url": "https://api.github.com/users/MikeOfZen/repos", "events_url": "https://api.github.com/users/MikeOfZen/events{/privacy}", "received_events_url": "https://api.github.com/users/MikeOfZen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 1097541661, "node_id": "MDU6TGFiZWwxMDk3NTQxNjYx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tpus", "name": "comp:tpus", "color": "0052cc", "default": false, "description": "tpu, tpuestimator"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jvishnuvardhan", "id": 46058173, "node_id": "MDQ6VXNlcjQ2MDU4MTcz", "avatar_url": "https://avatars2.githubusercontent.com/u/46058173?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jvishnuvardhan", "html_url": "https://github.com/jvishnuvardhan", "followers_url": "https://api.github.com/users/jvishnuvardhan/followers", "following_url": "https://api.github.com/users/jvishnuvardhan/following{/other_user}", "gists_url": "https://api.github.com/users/jvishnuvardhan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jvishnuvardhan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jvishnuvardhan/subscriptions", "organizations_url": "https://api.github.com/users/jvishnuvardhan/orgs", "repos_url": "https://api.github.com/users/jvishnuvardhan/repos", "events_url": "https://api.github.com/users/jvishnuvardhan/events{/privacy}", "received_events_url": "https://api.github.com/users/jvishnuvardhan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-11-24T22:17:08Z", "updated_at": "2019-12-05T18:00:14Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):No custom code\r\n\r\n- TensorFlow installed from (source or binary):Binary\r\n- TensorFlow version (use command below): '2.1.0-dev20191124'\r\n- Python version:3.5.3\r\n- Using GCP image: debian-9-tf-nightly-2-x-v20191124\r\n- Using TPU version: v2-8 , nightly-2.x , preempitble\r\n- zone(probably irrelevent): us-central1-b\r\n\r\n*The TPU and Host were built without `ctpu` tool\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport tensorflow as tf\r\nresolver = tf.distribute.cluster_resolver.TPUClusterResolver(tpu='grpc://10.0.101.2:8470')\r\ntf.config.experimental_connect_to_cluster(resolver)\r\n```\r\n\r\n\r\n**Describe the current behavior**\r\nThe `experimental_connect_to_cluster` call hangs indefinitely. \r\nNo error message is produced, it is unclear what should be done.\r\nI had the same problem in 2.0.0.\r\n\r\n**Describe the expected behavior**\r\na.Call shouldn't hang and should provide informative error information\r\nb. If some environment settings need to be set to facilitate TPU-host communications, it should be better documented.\r\n\r\n**Other info / logs**\r\nJupyter log is:\r\n```\r\n[I 22:07:17.299 NotebookApp] Kernel restarted: c9cf10ac-3d03-4a62-a737-3f8e94b44aec\r\n[W 22:07:18.426 NotebookApp] SSL Error on 13 ('79.181.28.67', 59971): [SSL: SSLV3_ALERT_CERTIFICATE_UNKNOWN] sslv3 alert certificate unknown (_ssl.c:720)\r\n[I 22:07:18.935 NotebookApp] Restoring connection for c9cf10ac-3d03-4a62-a737-3f8e94b44aec:c5d1ab723abe433986849772ed497483\r\n[I 22:07:18.935 NotebookApp] Replaying 3 buffered messages\r\n2019-11-24 22:07:31.539205: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2019-11-24 22:07:31.546892: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2300000000 Hz\r\n2019-11-24 22:07:31.547399: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55dc09561c30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n2019-11-24 22:07:31.547455: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\n2019-11-24 22:07:31.554227: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:300] Initialize GrpcChannelCache for job worker -> {0 -> 10.0.101.2:8470}\r\n2019-11-24 22:07:31.554338: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:300] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:31900}\r\n[I 22:07:43.819 NotebookApp] Saving file at /project_drive/project/Trainv3.ipynb\r\n[W 22:07:43.820 NotebookApp] Notebook project_drive/project/Trainv3.ipynb is not trusted\r\n```\r\n\r\ngcloud compute instances describe host:\r\n```\r\ncanIpForward: false                                                                                                                        \r\ncpuPlatform: Intel Haswell                                                                                                                 \r\ncreationTimestamp: '2019-11-24T10:28:54.344-08:00'                                                                                         \r\ndeletionProtection: false                                                                                                                  \r\ndescription: ''                                                                                                                            \r\ndisks:                                                                                                                                     \r\n- autoDelete: false                                                                                                                        \r\n  boot: true                                                                                                                               \r\n  deviceName: instance-1                                                                                                                   \r\n  guestOsFeatures:                                                                                                                         \r\n  - type: VIRTIO_SCSI_MULTIQUEUE                                                                                                           \r\n  index: 0                                                                                                                                 \r\n  interface: SCSI                                                                                                                          \r\n  kind: compute#attachedDisk                                                                                                               \r\n  licenses:                                                                                                                                \r\n  - https://www.googleapis.com/compute/v1/projects/debian-cloud/global/licenses/debian-9-stretch                                           \r\n  - https://www.googleapis.com/compute/v1/projects/ml-images/global/licenses/debian-tensorflow                                             \r\n  mode: READ_WRITE                                                                                                                         \r\n  source: https://www.googleapis.com/compute/v1/projects/deeplearning-257902/zones/us-central1-b/disks/instance-1                          \r\n  type: PERSISTENT                                                                                                                         \r\n- autoDelete: false                                                                                                                        \r\n  boot: false                                                                                                                              \r\n  deviceName: yaop-project                                                                                                                 \r\n  index: 1                                                                                                                                 \r\n  interface: SCSI                                                                                                                          \r\n  kind: compute#attachedDisk                                                                                                               \r\n  mode: READ_WRITE                                                                                                                         \r\n  source: https://www.googleapis.com/compute/v1/projects/deeplearning-257902/zones/us-central1-b/disks/yaop-project                        \r\n  type: PERSISTENT                                                                                                                         \r\ndisplayDevice:                                                                                                                             \r\n  enableDisplay: false                                                                                                                     \r\nid: '7023192423693513994'                                                                                                                  \r\nkind: compute#instance                                                                                                                     \r\nlabelFingerprint: 42WmSpB8rSM=                                                                                                             \r\nmachineType: https://www.googleapis.com/compute/v1/projects/deeplearning-257902/zones/us-central1-b/machineTypes/n1-highmem-4              \r\nmetadata:                                                                                                                                  \r\n  fingerprint: oW9kyu6jwEE=                                                                                                                \r\n  kind: compute#metadata                                                                                                                   \r\nname: instance-1                                                                                                                           \r\nnetworkInterfaces:                                                                                                                         \r\n- accessConfigs:                                                                                                                           \r\n  - kind: compute#accessConfig                                                                                                             \r\n    name: External NAT                                                                                                                     \r\n    natIP: 35.225.64.207                                                                                                                   \r\n    networkTier: PREMIUM                                                                                                                   \r\n    type: ONE_TO_ONE_NAT                                                                                                                   \r\n  fingerprint: VbmPG2_4Dak=                                                                                                                \r\n  kind: compute#networkInterface                                                                                                           \r\n  name: nic0                                                                                                                               \r\n  network: https://www.googleapis.com/compute/v1/projects/deeplearning-257902/global/networks/default                                      \r\n  networkIP: 10.128.0.18                                                                                                                   \r\n  subnetwork: https://www.googleapis.com/compute/v1/projects/deeplearning-257902/regions/us-central1/subnetworks/default                   \r\nreservationAffinity:                                                                                                                       \r\n  consumeReservationType: ANY_RESERVATION                                                                                                  \r\nscheduling:                                                                                                                                \r\n  automaticRestart: true                                                                                                                   \r\n  onHostMaintenance: MIGRATE                                                                                                               \r\n  preemptible: false                                                                                                                       \r\nselfLink: https://www.googleapis.com/compute/v1/projects/deeplearning-257902/zones/us-central1-b/instances/instance-1                      \r\nserviceAccounts:                                                                                                                           \r\n- email: 312164605303-compute@developer.gserviceaccount.com                                                                                \r\n  scopes:                                                                                                                                  \r\n  - https://www.googleapis.com/auth/devstorage.read_only                                                                                   \r\n  - https://www.googleapis.com/auth/logging.write                                                                                          \r\n  - https://www.googleapis.com/auth/monitoring.write                                                                                       \r\n  - https://www.googleapis.com/auth/servicecontrol                                                                                         \r\n  - https://www.googleapis.com/auth/service.management.readonly                                                                            \r\n  - https://www.googleapis.com/auth/trace.append                                                                                           \r\nstartRestricted: false                                                                                                                     \r\nstatus: RUNNING                                                                                                                            \r\ntags:                                                                                                                                      \r\n  fingerprint: Uv7CXg8qQhM=                                                                                                                \r\n  items:                                                                                                                                   \r\n  - http-server                                                                                                                            \r\n  - https-server                                                                                                                           \r\n  - jupyter                                                                                                                                \r\n  - nomachine                                                                                                                              \r\nzone: https://www.googleapis.com/compute/v1/projects/deeplearning-257902/zones/us-central1-b                                               \r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34560", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34560/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34560/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34560/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34560", "id": 527707433, "node_id": "MDU6SXNzdWU1Mjc3MDc0MzM=", "number": 34560, "title": "Check failed: s.ok() copy tensor to gpu sync", "user": {"login": "wangshuaizs", "id": 21264093, "node_id": "MDQ6VXNlcjIxMjY0MDkz", "avatar_url": "https://avatars2.githubusercontent.com/u/21264093?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wangshuaizs", "html_url": "https://github.com/wangshuaizs", "followers_url": "https://api.github.com/users/wangshuaizs/followers", "following_url": "https://api.github.com/users/wangshuaizs/following{/other_user}", "gists_url": "https://api.github.com/users/wangshuaizs/gists{/gist_id}", "starred_url": "https://api.github.com/users/wangshuaizs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wangshuaizs/subscriptions", "organizations_url": "https://api.github.com/users/wangshuaizs/orgs", "repos_url": "https://api.github.com/users/wangshuaizs/repos", "events_url": "https://api.github.com/users/wangshuaizs/events{/privacy}", "received_events_url": "https://api.github.com/users/wangshuaizs/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 1105108936, "node_id": "MDU6TGFiZWwxMTA1MTA4OTM2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:model", "name": "comp:model", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-11-24T14:37:52Z", "updated_at": "2019-12-09T06:27:33Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: No\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version (use command below): [v1.13.1](https://github.com/tensorflow/tensorflow/archive/v1.13.1.zip)\r\n- Python version: 2.7\r\n- Bazel version (if compiling from source): 0.19.2\r\n- GCC/Compiler version (if compiling from source): 5.4.0\r\n- CUDA/cuDNN version: 9.0 / 7\r\n- GPU model and memory: Tesla K40c 12GB\r\n\r\n\r\n**Describe the current behavior**\r\nI tried to run distributed training (1 ps and 1 worker). I used VGG19 from [tensorflow/benchmark v1.13 compatible](https://github.com/tensorflow/benchmarks) as the training model.  \r\nWhen `server_protocol` was set to `grpc` or `grpc+gdr`, the training was normal. But when it was set to `grpc+verbs`, the error `F tensorflow/contrib/verbs/rdma.cc:1635] Check failed: s.ok() copy tensor to gpu sync\r\nAborted (core dumped)` occured at PS (not at worker).  Is this a bug?\r\nThe whole log is as follows:\r\n\r\n```\r\n$ CUDA_VISIBLE_DEVICES='' python benchmarks/scripts/tf_cnn_benchmarks/tf_cnn_benchmarks.py --local_parameter_device=cpu --num_gpus=1 --batch_size=64 --model=vgg19 --variable_update=parameter_server --num_batches=5000 --server_protocol=grpc+verbs --ps_hosts=\"localhost:2222\" --worker_hosts=\"localhost:3333\" --job_name=ps --task_index=0\r\n2019-11-24 22:06:17.143431: E tensorflow/stream_executor/cuda/cuda_driver.cc:300] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected\r\n2019-11-24 22:06:17.143507: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:161] retrieving CUDA diagnostic information for host: g3-nasp\r\n2019-11-24 22:06:17.143525: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:168] hostname: g3-nasp\r\n2019-11-24 22:06:17.143595: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:192] libcuda reported version is: 418.39.0\r\n2019-11-24 22:06:17.143652: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:196] kernel reported version is: 418.39.0\r\n2019-11-24 22:06:17.143668: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:303] kernel version seems to match DSO: 418.39.0\r\n2019-11-24 22:06:17.145757: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:252] Initialize GrpcChannelCache for job ps -> {0 -> localhost:2222}\r\n2019-11-24 22:06:17.145788: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:252] Initialize GrpcChannelCache for job worker -> {0 -> 12.12.12.13:3333}\r\n2019-11-24 22:06:17.151396: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:252] Initialize GrpcChannelCache for job ps -> {0 -> localhost:2222}\r\n2019-11-24 22:06:17.151432: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:252] Initialize GrpcChannelCache for job worker -> {0 -> 12.12.12.13:3333}\r\n2019-11-24 22:06:17.161484: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:391] Started server with target: grpc://localhost:2222\r\n2019-11-24 22:06:17.164512: I tensorflow/contrib/verbs/rdma_mgr.cc:130] Connected to remote node /job:worker/replica:0/task:0\r\nTensorFlow:  1.13\r\nModel:       vgg19\r\nDataset:     imagenet (synthetic)\r\nMode:        training\r\nSingleSess:  False\r\nBatch size:  64 global\r\n             64 per device\r\nNum batches: 5000\r\nNum epochs:  0.25\r\nDevices:     ['/job:worker/replica:0/task:0/gpu:0']\r\nNUMA bind:   False\r\nData format: NCHW\r\nOptimizer:   sgd\r\nVariables:   parameter_server\r\nSync:        True\r\n==========\r\nRunning parameter server 0\r\n2019-11-24 22:06:22.987281: F tensorflow/contrib/verbs/rdma.cc:1635] Check failed: s.ok() copy tensor to gpu sync\r\nAborted (core dumped)\r\n```\r\nand the gdb log is as follows:\r\n```\r\n[...]\r\n[Thread debugging using libthread_db enabled]\r\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\r\nCore was generated by `python benchmarks/scripts/tf_cnn_benchmarks/t'.\r\nProgram terminated with signal SIGABRT, Aborted.\r\n#0  0x00007fc91eb02428 in __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:54\r\n54      ../sysdeps/unix/sysv/linux/raise.c: No such file or directory.\r\n[Current thread is 1 (Thread 0x7fc782ffd700 (LWP 1941))]\r\n(gdb) where\r\n#0  0x00007fc91eb02428 in __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:54\r\n#1  0x00007fc91eb0402a in __GI_abort () at abort.c:89\r\n#2  0x00007fc8c14a2a94 in tensorflow::internal::LogMessageFatal::~LogMessageFatal() ()\r\n   from /tf1.13/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n#3  0x00007fc8bc9a6fe3 in tensorflow::RdmaTensorRequest::RecvTensorContent()::{lambda(tensorflow::Status const&)#2}::operator()(tensorflow::Status const&) const ()\r\n   from /tf1.13/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n#4  0x00007fc8ba236688 in tensorflow::GPUUtil::CopyCPUTensorToGPU(tensorflow::Tensor const*, tensorflow::DeviceContext const*, tensorflow::Device*, tensorflow::Tensor*, std::function<void (tensorflow::Status const&)>) () from /tf1.13/lib/python2.7/site-packages/tensorflow/python/../libtensorflow_framework.so\r\n#5  0x00007fc8bc9a9199 in tensorflow::RdmaTensorRequest::RecvTensorContent() ()\r\n   from /tf1.13/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n#6  0x00007fc8bc9ab95e in tensorflow::RdmaAdapter::Process_CQ() ()\r\n   from /tf1.13/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so\r\n#7  0x00007fc8b0545c80 in ?? () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\r\n#8  0x00007fc91f5ae6ba in start_thread (arg=0x7fc782ffd700) at pthread_create.c:333\r\n#9  0x00007fc91ebd441d in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:109\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34559", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34559/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34559/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34559/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34559", "id": 527706824, "node_id": "MDU6SXNzdWU1Mjc3MDY4MjQ=", "number": 34559, "title": "Gradient doesn't exist/ becomes None for conv_transpose layers", "user": {"login": "Dieblitzen", "id": 39067298, "node_id": "MDQ6VXNlcjM5MDY3Mjk4", "avatar_url": "https://avatars2.githubusercontent.com/u/39067298?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Dieblitzen", "html_url": "https://github.com/Dieblitzen", "followers_url": "https://api.github.com/users/Dieblitzen/followers", "following_url": "https://api.github.com/users/Dieblitzen/following{/other_user}", "gists_url": "https://api.github.com/users/Dieblitzen/gists{/gist_id}", "starred_url": "https://api.github.com/users/Dieblitzen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Dieblitzen/subscriptions", "organizations_url": "https://api.github.com/users/Dieblitzen/orgs", "repos_url": "https://api.github.com/users/Dieblitzen/repos", "events_url": "https://api.github.com/users/Dieblitzen/events{/privacy}", "received_events_url": "https://api.github.com/users/Dieblitzen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-11-24T14:33:23Z", "updated_at": "2019-12-21T00:30:34Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Custom code\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): MacOS Catalina\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: No\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 2.0\r\n- Python version: 3.6.8\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source):N/A\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: N/A\r\n\r\n**Describe the current behavior**\r\nI get a warning \r\n`WARNING:tensorflow:Gradients do not exist for variables ['mrf__block_2/conv2d_transpose_5/kernel:0', 'mrf__block_2/conv2d_transpose_5/bias:0'] when minimizing the loss.` \r\nwhen trying to backprop loss for a specific layer in my model. The gradients keep turning out to be None regardless of optimizer.\r\n\r\n\r\n**Describe the expected behavior**\r\nThe gradients should exist for these layers.\r\n\r\n\r\n**Code to reproduce the issue**\r\nThis is the model in question:\r\n```\r\nimport tensorflow as tf\r\nimport tensorflow.keras.layers as layers\r\nfrom tensorflow.keras import Model\r\n\r\nclass MRF_Block(Model):\r\n  def __init__(self, out_channels, num_inputs, use_deconv=True, \r\n               kernel_size=(3,3), strides=(1,1), padding='same'):\r\n    super(MRF_Block, self).__init__()\r\n\r\n    # Add the conv/deconv layers.\r\n    for i in range(num_inputs):\r\n      # Convolve input tensors to output tensors of same channel depth (# of channels)\r\n      conv_layer = layers.Conv2D(out_channels, kernel_size, strides=strides, padding=padding)\r\n      setattr(self, f'conv_{i}', conv_layer)\r\n\r\n      # Deconv input tensors. Input tensor at index i will be upsampled by factor 2^(n_inputs - (i+1))\r\n      # Eg: if input tensors are [t1, t2, t3], t1 will be upsampled x 4, t2 upsampled x 2, t3 not upsampled.\r\n      if use_deconv:\r\n        deconv_layer = layers.Conv2DTranspose(out_channels, kernel_size, padding='same',\r\n                                              strides=(2**(num_inputs-(i+1)), 2**(num_inputs-(i+1))))\r\n        setattr(self, f'deconv_{i}', deconv_layer)\r\n\r\n  ## inputs: a list of tensors being inputted to the block.\r\n  def call(self, inputs):\r\n\r\n    # Make #channels the same for input tensors (smallest depth)\r\n    convolved = []\r\n    for i, t in enumerate(inputs):\r\n      conv = getattr(self, f'conv_{i}')\r\n      convolved.append(conv(t))\r\n\r\n    # Upsample to largest (h, w) resolution\r\n    largest_res = max(inputs, key=lambda t: t.shape[1] * t.shape[2])\r\n    resized = []\r\n    for i, t in enumerate(convolved):\r\n      deconv = getattr(self, f'deconv_{i}', lambda t: t)\r\n      up_sampled = deconv(t)\r\n      \r\n      # Use bilinear resizing if resolution of optional conv_transpose doesn't match\r\n      if up_sampled.shape[1:3] != largest_res.shape[1:3]:\r\n        up_sampled = tf.image.resize(t, size=largest_res.shape[1:3])\r\n    \r\n      resized.append(up_sampled)\r\n\r\n    # Fuse by summing\r\n    return sum(resized)\r\n```\r\n\r\nAnd then running this code is what results in the error:\r\n```\r\nt = tf.random.normal((2, 224, 224, 3))\r\noptimizer = tf.keras.optimizers.SGD()\r\n\r\nmrf = MRF_Block(12, 2)\r\nwith tf.GradientTape() as tape: \r\n    preds = mrf([t, t]) \r\n    loss = tf.keras.losses.BinaryCrossentropy(from_logits=True)(tf.random.normal((2, 224, 224, 12)), preds) \r\ngradients = tape.gradient(loss, mrf.trainable_variables)\r\noptimizer.apply_gradients(zip(gradients, mrf.trainable_variables))  \r\n```\r\nChanging SGD() to Adam() yields the same warning. Is it a problem with how the model is defined? Repeatedly running the above code yields the same warning (with/without reinitialising the optimizer).\r\n\r\n**Other info / logs**\r\nNone at the moment.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34558", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34558/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34558/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34558/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34558", "id": 527706813, "node_id": "MDU6SXNzdWU1Mjc3MDY4MTM=", "number": 34558, "title": "undefined reference to `_imp__TF_Version' when compiling in C", "user": {"login": "JushBJJ", "id": 36951064, "node_id": "MDQ6VXNlcjM2OTUxMDY0", "avatar_url": "https://avatars1.githubusercontent.com/u/36951064?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JushBJJ", "html_url": "https://github.com/JushBJJ", "followers_url": "https://api.github.com/users/JushBJJ/followers", "following_url": "https://api.github.com/users/JushBJJ/following{/other_user}", "gists_url": "https://api.github.com/users/JushBJJ/gists{/gist_id}", "starred_url": "https://api.github.com/users/JushBJJ/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JushBJJ/subscriptions", "organizations_url": "https://api.github.com/users/JushBJJ/orgs", "repos_url": "https://api.github.com/users/JushBJJ/repos", "events_url": "https://api.github.com/users/JushBJJ/events{/privacy}", "received_events_url": "https://api.github.com/users/JushBJJ/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1188421838, "node_id": "MDU6TGFiZWwxMTg4NDIxODM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:windows", "name": "subtype:windows", "color": "b619ea", "default": false, "description": "Windows Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gunan", "id": 7946809, "node_id": "MDQ6VXNlcjc5NDY4MDk=", "avatar_url": "https://avatars3.githubusercontent.com/u/7946809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gunan", "html_url": "https://github.com/gunan", "followers_url": "https://api.github.com/users/gunan/followers", "following_url": "https://api.github.com/users/gunan/following{/other_user}", "gists_url": "https://api.github.com/users/gunan/gists{/gist_id}", "starred_url": "https://api.github.com/users/gunan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gunan/subscriptions", "organizations_url": "https://api.github.com/users/gunan/orgs", "repos_url": "https://api.github.com/users/gunan/repos", "events_url": "https://api.github.com/users/gunan/events{/privacy}", "received_events_url": "https://api.github.com/users/gunan/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-11-24T14:33:18Z", "updated_at": "2020-02-08T13:54:24Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10 x86 Version 10.0.18362.476]\r\n- TensorFlow installed from (source or binary): Binary\r\n- TensorFlow version: Below 2.0\r\n**GCC:**\r\nCOLLECT_GCC=gcc\r\nCOLLECT_LTO_WRAPPER=c:/mingw/bin/../libexec/gcc/mingw32/8.2.0/lto-wrapper.exe\r\nTarget: mingw32\r\nConfigured with: ../src/gcc-8.2.0/configure --build=x86_64-pc-linux-gnu --host=mingw32 --target=mingw32 --prefix=/mingw --disable-win32-registry --with-arch=i586 --with-tune=generic --enable-languages=c,c++,objc,obj-c++,fortran,ada --with-pkgversion='MinGW.org GCC-8.2.0-3' --with-gmp=/mingw --with-mpfr=/mingw --with-mpc=/mingw --enable-static --enable-shared --enable-threads --with-dwarf2 --disable-sjlj-exceptions --enable-version-specific-runtime-libs --with-libiconv-prefix=/mingw --with-libintl-prefix=/mingw --enable-libstdcxx-debug --with-isl=/mingw --enable-libgomp --disable-libvtv --enable-nls --disable-build-format-warnings\r\nThread model: win32\r\ngcc version 8.2.0 (MinGW.org GCC-8.2.0-3)\r\n\r\n**Describe the problem**\r\nTensorflow functions for C api doesn't work.\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n\r\nVisited: https://www.tensorflow.org/install/lang_c\r\nDownloaded Binary for Windows (CPU Only): https://storage.googleapis.com/tensorflow/libtensorflow/libtensorflow-cpu-windows-x86_64-1.14.0.zip\r\nExtracted zip file into folder.\r\nCopy and Pasted lib files (including the dll file) into C:\\MinGW\\lib \r\nCopy and Pasted include files and folders into C:\\MinGW\\include\r\n\r\nMade new file called \"hello_tf.c\".\r\nCopy and pasted the example program source code from https://www.tensorflow.org/install/lang_c into the file.\r\n\r\nOpened up cmd, went to the file directory and typed:\r\n**gcc hello_tf.c -ltensorflow -o hello_tf.exe && hello_tf.exe**\r\n\r\nOutput:\r\n![image](https://user-images.githubusercontent.com/36951064/69496153-c6f91380-0f1a-11ea-8be0-80786052dfcb.png)\r\n\r\nBasically the same on other functions like TF_DataTypeSize:\r\n![image](https://user-images.githubusercontent.com/36951064/69496162-e8f29600-0f1a-11ea-86a6-a92afa4229a5.png)\r\n\r\nCode: \r\n![image](https://user-images.githubusercontent.com/36951064/69496178-20614280-0f1b-11ea-84cd-ea039b5d1ad1.png)\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34556", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34556/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34556/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34556/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34556", "id": 527694395, "node_id": "MDU6SXNzdWU1Mjc2OTQzOTU=", "number": 34556, "title": "tf.keras fit is incompatible with tf.function", "user": {"login": "Danmou", "id": 7031745, "node_id": "MDQ6VXNlcjcwMzE3NDU=", "avatar_url": "https://avatars3.githubusercontent.com/u/7031745?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Danmou", "html_url": "https://github.com/Danmou", "followers_url": "https://api.github.com/users/Danmou/followers", "following_url": "https://api.github.com/users/Danmou/following{/other_user}", "gists_url": "https://api.github.com/users/Danmou/gists{/gist_id}", "starred_url": "https://api.github.com/users/Danmou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Danmou/subscriptions", "organizations_url": "https://api.github.com/users/Danmou/orgs", "repos_url": "https://api.github.com/users/Danmou/repos", "events_url": "https://api.github.com/users/Danmou/events{/privacy}", "received_events_url": "https://api.github.com/users/Danmou/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "omalleyt12", "id": 29100818, "node_id": "MDQ6VXNlcjI5MTAwODE4", "avatar_url": "https://avatars3.githubusercontent.com/u/29100818?v=4", "gravatar_id": "", "url": "https://api.github.com/users/omalleyt12", "html_url": "https://github.com/omalleyt12", "followers_url": "https://api.github.com/users/omalleyt12/followers", "following_url": "https://api.github.com/users/omalleyt12/following{/other_user}", "gists_url": "https://api.github.com/users/omalleyt12/gists{/gist_id}", "starred_url": "https://api.github.com/users/omalleyt12/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/omalleyt12/subscriptions", "organizations_url": "https://api.github.com/users/omalleyt12/orgs", "repos_url": "https://api.github.com/users/omalleyt12/repos", "events_url": "https://api.github.com/users/omalleyt12/events{/privacy}", "received_events_url": "https://api.github.com/users/omalleyt12/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-11-24T12:59:54Z", "updated_at": "2019-11-25T19:43:03Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (use command below): 2.0.0\r\n- Python version: 3.7\r\n\r\n**Describe the current behavior**\r\nI'm not sure if this is a bug or a documentation issue. The [migration guide](https://www.tensorflow.org/guide/migrate#mixed_variables_v1layers) recommends adding the `@tf.function` decorator to the `call` method of subclassed Keras models or layers. However, this causes problems when using the `Layer.add_loss` method with input-dependent losses as described in the [Keras guide](https://www.tensorflow.org/guide/keras/custom_layers_and_models#layers_recursively_collect_losses_created_during_the_forward_pass). In retrospect it makes sense that this doesn't work since `tf.function` requires all outputs to be returned from the function, but this is not made very clear in the docs and the resulting error message is not very helpful.\r\n\r\n**Code to reproduce the issue**\r\n```python\r\nimport numpy as np\r\nimport tensorflow as tf\r\nfrom tensorflow.keras import layers\r\n\r\nclass MyModel(tf.keras.Model):\r\n    def __init__(self, num_classes):\r\n        super().__init__()\r\n        self.num_classes = num_classes\r\n        self.dense = layers.Dense(num_classes, activation='sigmoid')\r\n\r\n    @tf.function\r\n    def call(self, inputs):\r\n        self.add_loss(tf.reduce_sum(inputs), inputs=True)\r\n        return self.dense(inputs)\r\n\r\ndata = np.random.random((1000, 32))\r\nlabels = np.random.random((1000, 10))\r\nmodel = MyModel(num_classes=10)\r\nmodel.compile(optimizer=tf.keras.optimizers.RMSprop(0.001),\r\n              loss='categorical_crossentropy')\r\nmodel.fit(data, labels, epochs=50)\r\n```\r\nAnd the resulting error:\r\n```\r\nTypeError: An op outside of the function building code is being passed\r\na \"Graph\" tensor. It is possible to have Graph tensors\r\nleak out of the function building context by including a\r\ntf.init_scope in your function building code.\r\nFor example, the following function will fail:\r\n  @tf.function\r\n  def has_init_scope():\r\n    my_constant = tf.constant(1.)\r\n    with tf.init_scope():\r\n      added = my_constant * 2\r\nThe graph tensor has name: Sum:0\r\n```\r\n\r\n**Expected behavior**\r\nIdeally `add_loss` and `tf.function` would somehow be compatible. This would give me the flexibility to use the model directly by calling it or use the keras `fit` and `predict` functions as I please without hurting performance. Alternatively, at least the `tf.keras` guide should make the incompatibility clear, and perhaps an explicit check should be added to make sure `add_loss` is not called inside a `tf.function`."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34539", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34539/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34539/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34539/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34539", "id": 527523157, "node_id": "MDU6SXNzdWU1Mjc1MjMxNTc=", "number": 34539, "title": "RNN document is not clear", "user": {"login": "zwenju", "id": 27112868, "node_id": "MDQ6VXNlcjI3MTEyODY4", "avatar_url": "https://avatars3.githubusercontent.com/u/27112868?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zwenju", "html_url": "https://github.com/zwenju", "followers_url": "https://api.github.com/users/zwenju/followers", "following_url": "https://api.github.com/users/zwenju/following{/other_user}", "gists_url": "https://api.github.com/users/zwenju/gists{/gist_id}", "starred_url": "https://api.github.com/users/zwenju/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zwenju/subscriptions", "organizations_url": "https://api.github.com/users/zwenju/orgs", "repos_url": "https://api.github.com/users/zwenju/repos", "events_url": "https://api.github.com/users/zwenju/events{/privacy}", "received_events_url": "https://api.github.com/users/zwenju/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-11-23T07:28:19Z", "updated_at": "2019-12-13T13:08:18Z", "closed_at": null, "author_association": "NONE", "body": "Thank you for submitting a TensorFlow documentation issue. Per our GitHub\r\npolicy, we only address code/doc bugs, performance issues, feature requests, and\r\nbuild/installation issues on GitHub.\r\n\r\nThe TensorFlow docs are open source! To get involved, read the documentation\r\ncontributor guide: https://www.tensorflow.org/community/contribute/docs\r\n\r\n## URL(s) with the issue:\r\nhttps://www.tensorflow.org/api_docs/python/tf/keras/layers/RNN\r\n\r\nPlease provide a link to the documentation entry, for example:\r\nhttps://www.tensorflow.org/versions/r2.0/api_docs/python/tf/MyMethod\r\n\r\n## Description of issue (what needs changing):\r\n\r\n### Clear description\r\n\r\nProblem 1:\r\nCould you provides the math model of the rnn?\r\n\r\nProblem 2:   this is not return information about  the method of \r\nget_initial_state(inputs=None, batch_size=None, dtype=None).\r\nand \r\nhow to define own get_initial_state ?\r\nwhat is the connect between   state_size  and get_initial_state\r\nProblem 3, \r\ncould  you write more clear about  arguments  of the methods:  call, build, get_initial_state,\r\nsuch as the   dimension of them.  each dimension is what .\r\n\r\nProblem 4:\r\nis the  cell  defined layer by user ?\r\n\r\nthanks! \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n \r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34538", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34538/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34538/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34538/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34538", "id": 527518373, "node_id": "MDU6SXNzdWU1Mjc1MTgzNzM=", "number": 34538, "title": "Build from head fails with Bazel 1.1.0 but succeeds with Bazel 0.26.1", "user": {"login": "dbonner", "id": 241474, "node_id": "MDQ6VXNlcjI0MTQ3NA==", "avatar_url": "https://avatars3.githubusercontent.com/u/241474?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbonner", "html_url": "https://github.com/dbonner", "followers_url": "https://api.github.com/users/dbonner/followers", "following_url": "https://api.github.com/users/dbonner/following{/other_user}", "gists_url": "https://api.github.com/users/dbonner/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbonner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbonner/subscriptions", "organizations_url": "https://api.github.com/users/dbonner/orgs", "repos_url": "https://api.github.com/users/dbonner/repos", "events_url": "https://api.github.com/users/dbonner/events{/privacy}", "received_events_url": "https://api.github.com/users/dbonner/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-11-23T06:31:10Z", "updated_at": "2019-11-25T11:03:27Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- TensorFlow installed from (source or binary): source (building source issue)\r\n- TensorFlow version: build from head (2.0.0)\r\n- Python version: 3.7.3\r\n- Installed using virtualenv? pip? conda?: Conda\r\n- Bazel version (if compiling from source): 1.1.0 fails while 0.26.1 succeeds\r\n- GCC/Compiler version (if compiling from source): 7.4.0\r\n- CUDA/cuDNN version: CUDA 10.1, cuDNN 7.6.5\r\n- GPU model and memory: Nvidia RTX 2080 Ti\r\n\r\n**Describe the problem**\r\n\r\nBuilding with Bazel 1.1.0 fails with the following message:\r\nImportError: /home/daniel/.cache/bazel/_bazel_daniel/79db702fc9f94af7d11e11c5d64854d0/execroot/org_tensorflow/bazel-out/host/bin/tensorflow/python/keras/api/create_tensorflow.python_api_1_keras_python_api_gen.runfiles/org_tensorflow/tensorflow/compiler/tf2tensorrt/_wrap_py_utils.so: undefined symbol: _ZN10tensorflowlsERSoRKNS_6StatusE\r\n\r\nNote: The failure of target //tensorflow/python/keras/api:create_tensorflow.python_api_1_keras_python_api_gen (with exit code 1) may have been caused by the fact that it is a Python 2 program that was built in the host configuration, which uses Python 3. You can change the host configuration (for the entire build) to instead use Python 2 by setting --host_force_python=PY2.\r\nIf this error started occurring in Bazel 0.27 and later, it may be because the Python toolchain now enforces that targets analyzed as PY2 and PY3 run under a Python 2 and Python 3 interpreter, respectively. See https://github.com/bazelbuild/bazel/issues/7899 for more information.\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\ngit clone https://github.com/tensorflow/tensorflow.git\r\ncd tensorflow\r\ngit checkout -b mybranch\r\n./configure\r\n[tf_configure.bazelrc.txt](https://github.com/tensorflow/tensorflow/files/3882194/tf_configure.bazelrc.txt)\r\nbazel build --explain=verbose_explanations.txt --verbose_explanations --verbose_failures --subcommands=pretty_print --config=opt --config=cuda --config=v2 --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" //tensorflow/tools/pip_package:build_pip_package &> log.txt\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\nSee ful log.txt (which shows failure with Bazel 1.1.0)\r\nand log2.txt (which shows success with Bazel 0.26.1)\r\nfrom the following link: [Dropbox folder](https://www.dropbox.com/sh/mz1qvrd2yw0fb0a/AAB5ZAIWH0fj7C5okI1By-rna?dl=0)"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34528", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34528/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34528/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34528/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34528", "id": 527352440, "node_id": "MDU6SXNzdWU1MjczNTI0NDA=", "number": 34528, "title": "External loss function raises error on incompatible types", "user": {"login": "andmax", "id": 1919506, "node_id": "MDQ6VXNlcjE5MTk1MDY=", "avatar_url": "https://avatars2.githubusercontent.com/u/1919506?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andmax", "html_url": "https://github.com/andmax", "followers_url": "https://api.github.com/users/andmax/followers", "following_url": "https://api.github.com/users/andmax/following{/other_user}", "gists_url": "https://api.github.com/users/andmax/gists{/gist_id}", "starred_url": "https://api.github.com/users/andmax/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andmax/subscriptions", "organizations_url": "https://api.github.com/users/andmax/orgs", "repos_url": "https://api.github.com/users/andmax/repos", "events_url": "https://api.github.com/users/andmax/events{/privacy}", "received_events_url": "https://api.github.com/users/andmax/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, {"login": "ravikyram", "id": 51902062, "node_id": "MDQ6VXNlcjUxOTAyMDYy", "avatar_url": "https://avatars2.githubusercontent.com/u/51902062?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ravikyram", "html_url": "https://github.com/ravikyram", "followers_url": "https://api.github.com/users/ravikyram/followers", "following_url": "https://api.github.com/users/ravikyram/following{/other_user}", "gists_url": "https://api.github.com/users/ravikyram/gists{/gist_id}", "starred_url": "https://api.github.com/users/ravikyram/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ravikyram/subscriptions", "organizations_url": "https://api.github.com/users/ravikyram/orgs", "repos_url": "https://api.github.com/users/ravikyram/repos", "events_url": "https://api.github.com/users/ravikyram/events{/privacy}", "received_events_url": "https://api.github.com/users/ravikyram/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-11-22T18:37:30Z", "updated_at": "2020-03-09T10:46:51Z", "closed_at": null, "author_association": "NONE", "body": "On TensorFlow 2.0 (OS Ubuntu 16.04), when I've an external loss function, the tf.keras.model fit() function call raises an error of incompatible types, whereas the same code on TensorFlow 1.15 does not raise any error and works fine.  The function fit() fails with:\r\n\r\n```\r\n(...)\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/op_def_library.py in\r\n_apply_op_helper(self, op_type_name, name, **keywords)\r\n    561                   \"%s type %s of argument '%s'.\" %\r\n    562                   (prefix, dtypes.as_dtype(attrs[input_arg.type_attr]).name,\r\n--> 563                    inferred_from[input_arg.type_attr]))\r\n    564 \r\n    565           types = [values.dtype]\r\n\r\nTypeError: Input 'y' of 'Mul' Op has type float32 that does not match type uint8 of\r\nargument 'x'.\r\n```\r\n\r\nThe minimal code to reproduce is:\r\n\r\n```\r\nimport tensorflow as tf\r\nfrom tensorflow.keras.utils import to_categorical\r\nfrom tensorflow.keras import backend as K\r\n\r\ndef loss_func(y_true, y_pred):\r\n    y_true_f = K.batch_flatten(y_true)\r\n    y_pred_f = K.batch_flatten(y_pred)\r\n    intersection = K.sum(y_true_f * y_pred_f, axis=1, keepdims=True)\r\n    union = K.sum(y_true_f, axis=1, keepdims=True) \\\r\n            + K.sum(y_pred_f, axis=1, keepdims=True)\r\n    return -(2. * intersection + K.epsilon()) / (union + K.epsilon())\r\n\r\n(Xtr, Ytr), (Xva, Yva) = tf.keras.datasets.cifar10.load_data()\r\nXtr, Ytr, Xva, Yva, nc = Xtr[:1000], Ytr[:1000], Xva[:100], Yva[:100], 10\r\nXtr, Xva = Xtr.astype('float32') / 255, Xva.astype('float32') / 255\r\nYtr, Yva, ins = to_categorical(Ytr, nc), to_categorical(Yva, nc), Xtr.shape[1:]\r\n\r\nmodel = tf.keras.models.Sequential()\r\nmodel.add(tf.keras.layers.Input(ins))\r\nmodel.add(tf.keras.layers.Conv2D(8, (3, 3)))\r\nmodel.add(tf.keras.layers.Activation('relu'))\r\nmodel.add(tf.keras.layers.Conv2D(8, (3, 3), activation='relu'))\r\nmodel.add(tf.keras.layers.MaxPooling2D(pool_size=(2, 2)))\r\nmodel.add(tf.keras.layers.Dropout(0.25))\r\nmodel.add(tf.keras.layers.Conv2D(16, (3, 3), activation='relu'))\r\nmodel.add(tf.keras.layers.Conv2D(16, (3, 3), activation='relu'))\r\nmodel.add(tf.keras.layers.MaxPooling2D(pool_size=(2, 2)))\r\nmodel.add(tf.keras.layers.Dropout(0.25))\r\nmodel.add(tf.keras.layers.Flatten())\r\nmodel.add(tf.keras.layers.Dense(32, activation='relu'))\r\nmodel.add(tf.keras.layers.Dropout(0.5))\r\nmodel.add(tf.keras.layers.Dense(nc, activation='softmax'))\r\nopt = tf.keras.optimizers.RMSprop(lr=0.0001, decay=1e-6)\r\nmodel.compile(loss=loss_func, optimizer=opt, metrics=[])\r\n\r\nYtr, Yva = Ytr.astype('uint8'), Yva.astype('uint8') # (1)\r\n\r\nmodel.fit(x=Xtr, y=Ytr, batch_size=32, epochs=1, validation_data=(Xva, Yva))\r\n```\r\n\r\nIf I remove line (1) it works on TensorFlow 2.0."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34523", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34523/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34523/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34523/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34523", "id": 527221269, "node_id": "MDU6SXNzdWU1MjcyMjEyNjk=", "number": 34523, "title": "TensorFlow Lite schema updater loses floating-point precision", "user": {"login": "vmarkovtsev", "id": 2793551, "node_id": "MDQ6VXNlcjI3OTM1NTE=", "avatar_url": "https://avatars3.githubusercontent.com/u/2793551?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vmarkovtsev", "html_url": "https://github.com/vmarkovtsev", "followers_url": "https://api.github.com/users/vmarkovtsev/followers", "following_url": "https://api.github.com/users/vmarkovtsev/following{/other_user}", "gists_url": "https://api.github.com/users/vmarkovtsev/gists{/gist_id}", "starred_url": "https://api.github.com/users/vmarkovtsev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vmarkovtsev/subscriptions", "organizations_url": "https://api.github.com/users/vmarkovtsev/orgs", "repos_url": "https://api.github.com/users/vmarkovtsev/repos", "events_url": "https://api.github.com/users/vmarkovtsev/events{/privacy}", "received_events_url": "https://api.github.com/users/vmarkovtsev/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": {"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-11-22T14:14:45Z", "updated_at": "2019-11-22T23:03:37Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "I am concerned about [tensorflow/lite/schema/upgrade_schema.py](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/lite/schema/upgrade_schema.py). I see that the schema upgrade is performed by converting flatbuffers binary to JSON and then backward.\r\nHowever, there is a problem with flatbuffers binary -> JSON step described in https://github.com/google/flatbuffers/issues/5371 which leads to float32 precision loss. `float`-s are serialized as `\"0.6f\"` and `double`-s as `\"0.12d\"` (equivalent to C++'s stringstream API). Thus, for example, float32 values that are very small, e.g. `0.123e-6`, will be written as `0.0`."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34519", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34519/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34519/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34519/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34519", "id": 527136133, "node_id": "MDU6SXNzdWU1MjcxMzYxMzM=", "number": 34519, "title": "tf.range + for x,y in dataset issue", "user": {"login": "SSSxCCC", "id": 24839738, "node_id": "MDQ6VXNlcjI0ODM5NzM4", "avatar_url": "https://avatars2.githubusercontent.com/u/24839738?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SSSxCCC", "html_url": "https://github.com/SSSxCCC", "followers_url": "https://api.github.com/users/SSSxCCC/followers", "following_url": "https://api.github.com/users/SSSxCCC/following{/other_user}", "gists_url": "https://api.github.com/users/SSSxCCC/gists{/gist_id}", "starred_url": "https://api.github.com/users/SSSxCCC/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SSSxCCC/subscriptions", "organizations_url": "https://api.github.com/users/SSSxCCC/orgs", "repos_url": "https://api.github.com/users/SSSxCCC/repos", "events_url": "https://api.github.com/users/SSSxCCC/events{/privacy}", "received_events_url": "https://api.github.com/users/SSSxCCC/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1190546177, "node_id": "MDU6TGFiZWwxMTkwNTQ2MTc3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:autograph", "name": "comp:autograph", "color": "0052cc", "default": false, "description": ""}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 16, "created_at": "2019-11-22T11:13:57Z", "updated_at": "2020-02-11T18:52:25Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code: yes\r\n- OS Platform and Distribution: win10 1809, pycharm2019.2.3\r\n- TensorFlow installed from: pip install tensorflow-gpu\r\n- TensorFlow version: tensorflow-gpu 2.0.0\r\n- Python version: 3.6\r\n- CUDA/cuDNN version: 10.0/7.6.4\r\n- GPU model and memory: rtx2080 8g\r\n\r\n**Describe the current behavior**\r\ntf.range + for x,y in dataset raise exception.\r\n\r\n**Describe the expected behavior**\r\nrun normally\r\n\r\n**Code to reproduce the issue**\r\n```python\r\nimport tensorflow as tf\r\n\r\nif __name__ == '__main__':\r\n    dataset = tf.data.Dataset.from_tensor_slices(([1, 2, 3], [4, 5, 6]))\r\n\r\n    @tf.function\r\n    def f():\r\n        for e in tf.range(3):\r\n            for x, y in dataset:\r\n                tf.print(x, y, e)\r\n    f()\r\n```\r\n\r\n**Other info / logs**\r\n```\r\n2019-11-22 18:56:57.100113: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library cudart64_100.dll\r\n2019-11-22 18:56:58.357108: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library nvcuda.dll\r\n2019-11-22 18:56:58.432503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: \r\nname: GeForce RTX 2080 major: 7 minor: 5 memoryClockRate(GHz): 1.8\r\npciBusID: 0000:01:00.0\r\n2019-11-22 18:56:58.432679: I tensorflow/stream_executor/platform/default/dlopen_checker_stub.cc:25] GPU libraries are statically linked, skip dlopen check.\r\n2019-11-22 18:56:58.433099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0\r\n2019-11-22 18:56:58.433463: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2\r\n2019-11-22 18:56:58.435936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: \r\nname: GeForce RTX 2080 major: 7 minor: 5 memoryClockRate(GHz): 1.8\r\npciBusID: 0000:01:00.0\r\n2019-11-22 18:56:58.436136: I tensorflow/stream_executor/platform/default/dlopen_checker_stub.cc:25] GPU libraries are statically linked, skip dlopen check.\r\n2019-11-22 18:56:58.436559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0\r\n2019-11-22 18:56:59.016772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:\r\n2019-11-22 18:56:59.016930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 \r\n2019-11-22 18:56:59.017022: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N \r\n2019-11-22 18:56:59.017714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6273 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080, pci bus id: 0000:01:00.0, compute capability: 7.5)\r\n2019-11-22 18:56:59.409303: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Internal: No unary variant device copy function found for direction: 1 and Variant type_index: class tensorflow::data::`anonymous namespace'::DatasetVariantWrapper\r\n\t [[{{node while_input_4/_12}}]]\r\n\t [[Func/while/body/_1/input/_47/_20]]\r\n2019-11-22 18:56:59.409640: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Internal: No unary variant device copy function found for direction: 1 and Variant type_index: class tensorflow::data::`anonymous namespace'::DatasetVariantWrapper\r\n\t [[{{node while_input_4/_12}}]]\r\nTraceback (most recent call last):\r\n  File \"D:/work/python/PycharmProjects/tftest/test.py\", line 83, in <module>\r\n    f()\r\n  File \"D:\\work\\python\\PycharmProjects\\tftest\\venv-gpu\\lib\\site-packages\\tensorflow_core\\python\\eager\\def_function.py\", line 457, in __call__\r\n    result = self._call(*args, **kwds)\r\n  File \"D:\\work\\python\\PycharmProjects\\tftest\\venv-gpu\\lib\\site-packages\\tensorflow_core\\python\\eager\\def_function.py\", line 526, in _call\r\n    return self._concrete_stateful_fn._filtered_call(canon_args, canon_kwds)  # pylint: disable=protected-access\r\n  File \"D:\\work\\python\\PycharmProjects\\tftest\\venv-gpu\\lib\\site-packages\\tensorflow_core\\python\\eager\\function.py\", line 1141, in _filtered_call\r\n    self.captured_inputs)\r\n  File \"D:\\work\\python\\PycharmProjects\\tftest\\venv-gpu\\lib\\site-packages\\tensorflow_core\\python\\eager\\function.py\", line 1224, in _call_flat\r\n    ctx, args, cancellation_manager=cancellation_manager)\r\n  File \"D:\\work\\python\\PycharmProjects\\tftest\\venv-gpu\\lib\\site-packages\\tensorflow_core\\python\\eager\\function.py\", line 511, in call\r\n    ctx=ctx)\r\n  File \"D:\\work\\python\\PycharmProjects\\tftest\\venv-gpu\\lib\\site-packages\\tensorflow_core\\python\\eager\\execute.py\", line 67, in quick_execute\r\n    six.raise_from(core._status_to_exception(e.code, message), None)\r\n  File \"<string>\", line 3, in raise_from\r\ntensorflow.python.framework.errors_impl.InternalError: 2 root error(s) found.\r\n  (0) Internal:  No unary variant device copy function found for direction: 1 and Variant type_index: class tensorflow::data::`anonymous namespace'::DatasetVariantWrapper\r\n\t [[{{node while_input_4/_12}}]]\r\n\t [[Func/while/body/_1/input/_47/_20]]\r\n  (1) Internal:  No unary variant device copy function found for direction: 1 and Variant type_index: class tensorflow::data::`anonymous namespace'::DatasetVariantWrapper\r\n\t [[{{node while_input_4/_12}}]]\r\n0 successful operations.\r\n0 derived errors ignored. [Op:__inference_f_61]\r\n\r\nFunction call stack:\r\nf -> f\r\n\r\n\r\nProcess finished with exit code 1\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34515", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34515/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34515/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34515/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/34515", "id": 527031980, "node_id": "MDExOlB1bGxSZXF1ZXN0MzQ0Mzg1MTc4", "number": 34515, "title": "Avoid doing reset when position is still in buffer in BufferedInputStream.", "user": {"login": "burgerkingeater", "id": 1428327, "node_id": "MDQ6VXNlcjE0MjgzMjc=", "avatar_url": "https://avatars0.githubusercontent.com/u/1428327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/burgerkingeater", "html_url": "https://github.com/burgerkingeater", "followers_url": "https://api.github.com/users/burgerkingeater/followers", "following_url": "https://api.github.com/users/burgerkingeater/following{/other_user}", "gists_url": "https://api.github.com/users/burgerkingeater/gists{/gist_id}", "starred_url": "https://api.github.com/users/burgerkingeater/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/burgerkingeater/subscriptions", "organizations_url": "https://api.github.com/users/burgerkingeater/orgs", "repos_url": "https://api.github.com/users/burgerkingeater/repos", "events_url": "https://api.github.com/users/burgerkingeater/events{/privacy}", "received_events_url": "https://api.github.com/users/burgerkingeater/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1178505529, "node_id": "MDU6TGFiZWwxMTc4NTA1NTI5", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/prtype:bugfix", "name": "prtype:bugfix", "color": "159b2e", "default": false, "description": "PR to fix a bug"}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2019-11-22T07:22:10Z", "updated_at": "2020-03-16T11:38:02Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/34515", "html_url": "https://github.com/tensorflow/tensorflow/pull/34515", "diff_url": "https://github.com/tensorflow/tensorflow/pull/34515.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/34515.patch"}, "body": "See https://github.com/tensorflow/tensorflow/issues/34510"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34510", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34510/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34510/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34510/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34510", "id": 527016397, "node_id": "MDU6SXNzdWU1MjcwMTYzOTc=", "number": 34510, "title": "BufferedInputStream should avoid doing Reset() in Seek when new position is still in buffer. ", "user": {"login": "burgerkingeater", "id": 1428327, "node_id": "MDQ6VXNlcjE0MjgzMjc=", "avatar_url": "https://avatars0.githubusercontent.com/u/1428327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/burgerkingeater", "html_url": "https://github.com/burgerkingeater", "followers_url": "https://api.github.com/users/burgerkingeater/followers", "following_url": "https://api.github.com/users/burgerkingeater/following{/other_user}", "gists_url": "https://api.github.com/users/burgerkingeater/gists{/gist_id}", "starred_url": "https://api.github.com/users/burgerkingeater/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/burgerkingeater/subscriptions", "organizations_url": "https://api.github.com/users/burgerkingeater/orgs", "repos_url": "https://api.github.com/users/burgerkingeater/repos", "events_url": "https://api.github.com/users/burgerkingeater/events{/privacy}", "received_events_url": "https://api.github.com/users/burgerkingeater/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-11-22T06:37:08Z", "updated_at": "2019-12-05T06:03:27Z", "closed_at": null, "author_association": "NONE", "body": "Check the [code here](https://github.com/tensorflow/tensorflow/blob/597a30bc61134ee1deec0b439b3649f346f1f119/tensorflow/core/lib/io/buffered_inputstream.cc#L161) \r\n``` \r\n // Position of the buffer within file.\r\n  const int64 bufpos = Tell();\r\n  if (position < bufpos) {\r\n    // Reset input stream and skip 'position' bytes.\r\n    TF_RETURN_IF_ERROR(Reset());\r\n    return SkipNBytes(position);\r\n  }\r\n```\r\n\r\n I see two issues, correct me if i'm wrong:\r\n1. Tell() doesn't return the position of the buffer within file as suggested in comment, in fact it returns the position of the `pos_` within the file.\r\n2. when `position` is still inside buffer, it will do a `Reset` anyway, which could impact the performance for read later since it would fill buffer of the previously buffered data. \r\n\r\nFixing PR: #34515 "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34508", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34508/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34508/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34508/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34508", "id": 526976625, "node_id": "MDU6SXNzdWU1MjY5NzY2MjU=", "number": 34508, "title": "How to get sample_weights and learning_phase? (TF2 Eager)", "user": {"login": "OverLordGoldDragon", "id": 16495490, "node_id": "MDQ6VXNlcjE2NDk1NDkw", "avatar_url": "https://avatars2.githubusercontent.com/u/16495490?v=4", "gravatar_id": "", "url": "https://api.github.com/users/OverLordGoldDragon", "html_url": "https://github.com/OverLordGoldDragon", "followers_url": "https://api.github.com/users/OverLordGoldDragon/followers", "following_url": "https://api.github.com/users/OverLordGoldDragon/following{/other_user}", "gists_url": "https://api.github.com/users/OverLordGoldDragon/gists{/gist_id}", "starred_url": "https://api.github.com/users/OverLordGoldDragon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/OverLordGoldDragon/subscriptions", "organizations_url": "https://api.github.com/users/OverLordGoldDragon/orgs", "repos_url": "https://api.github.com/users/OverLordGoldDragon/repos", "events_url": "https://api.github.com/users/OverLordGoldDragon/events{/privacy}", "received_events_url": "https://api.github.com/users/OverLordGoldDragon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "fchollet", "id": 710255, "node_id": "MDQ6VXNlcjcxMDI1NQ==", "avatar_url": "https://avatars3.githubusercontent.com/u/710255?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fchollet", "html_url": "https://github.com/fchollet", "followers_url": "https://api.github.com/users/fchollet/followers", "following_url": "https://api.github.com/users/fchollet/following{/other_user}", "gists_url": "https://api.github.com/users/fchollet/gists{/gist_id}", "starred_url": "https://api.github.com/users/fchollet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fchollet/subscriptions", "organizations_url": "https://api.github.com/users/fchollet/orgs", "repos_url": "https://api.github.com/users/fchollet/repos", "events_url": "https://api.github.com/users/fchollet/events{/privacy}", "received_events_url": "https://api.github.com/users/fchollet/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-11-22T04:12:02Z", "updated_at": "2019-11-27T14:08:24Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "`model.sample_weights` works w/ `from keras` imports but not `from tensorflow.keras`; I need the sample weights _tensor_  to feed to `K.function` to get layer gradients, outputs, etc.\r\n\r\nUsing `model._feed_sample_weights` instead does eliminate the error, but returns `[]`, and feeding `np.ones(32)` vs. `4*np.ones(32)` for sample weights yields the same outputs (it shouldn't).\r\n\r\n<hr>\r\n\r\n**Note**: see [this thread](https://github.com/tensorflow/tensorflow/issues/34507) regarding learning_phase\r\n\r\n<hr>\r\n\r\n**Applied example**:\r\n\r\n```python\r\nimport tensorflow.keras.backend as K\r\nfrom tensorflow.keras.layers import Input, Dense\r\nfrom tensorflow.keras.models import Model\r\nimport numpy as np\r\n\r\nipt = Input((16,))\r\nout = Dense(16)(ipt)\r\nmodel = Model(ipt, out)\r\nmodel.compile('adam', 'mse')\r\n\r\nx = np.random.randn(32, 16)\r\nmodel.train_on_batch(x, x)\r\n\r\ngrads = model.optimizer.get_gradients(model.total_loss, model.layers[-1].output)\r\ngrads_fn = K.function(inputs=[model.inputs[0], model._feed_targets[0], model.sample_weights[0]], \r\n                      outputs=grads)\r\n```\r\n\r\n**Full error trace**:\r\n\r\n```python\r\nFile \"<ipython-input-3-ef022490b960>\", line 16, in <module>\r\n  outputs=grads)\r\nFile \"D:\\Anaconda\\envs\\tf2_env\\lib\\site-packages\\tensorflow_core\\python\\keras\\backend.py\", line 3773, in function\r\n  return EagerExecutionFunction(inputs, outputs, updates=updates, name=name)\r\nFile \"D:\\Anaconda\\envs\\tf2_env\\lib\\site-packages\\tensorflow_core\\python\\keras\\backend.py\", line 3670, in __init__\r\n  base_graph=source_graph)\r\nFile \"D:\\Anaconda\\envs\\tf2_env\\lib\\site-packages\\tensorflow_core\\python\\eager\\lift_to_graph.py\", line 249, in lift_to_graph\r\n  visited_ops = set([x.op for x in sources])\r\nFile \"D:\\Anaconda\\envs\\tf2_env\\lib\\site-packages\\tensorflow_core\\python\\eager\\lift_to_graph.py\", line 249, in <listcomp>\r\n  visited_ops = set([x.op for x in sources])\r\n\r\nAttributeError: 'NoneType' object has no attribute 'op'\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34504", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34504/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34504/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34504/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/34504", "id": 526918680, "node_id": "MDExOlB1bGxSZXF1ZXN0MzQ0Mjk3NTEw", "number": 34504, "title": "[Intel MKL] Automatic BFloat16 converter", "user": {"login": "nhasabni", "id": 22304502, "node_id": "MDQ6VXNlcjIyMzA0NTAy", "avatar_url": "https://avatars0.githubusercontent.com/u/22304502?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nhasabni", "html_url": "https://github.com/nhasabni", "followers_url": "https://api.github.com/users/nhasabni/followers", "following_url": "https://api.github.com/users/nhasabni/following{/other_user}", "gists_url": "https://api.github.com/users/nhasabni/gists{/gist_id}", "starred_url": "https://api.github.com/users/nhasabni/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nhasabni/subscriptions", "organizations_url": "https://api.github.com/users/nhasabni/orgs", "repos_url": "https://api.github.com/users/nhasabni/repos", "events_url": "https://api.github.com/users/nhasabni/events{/privacy}", "received_events_url": "https://api.github.com/users/nhasabni/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1097545273, "node_id": "MDU6TGFiZWwxMDk3NTQ1Mjcz", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:grappler", "name": "comp:grappler", "color": "0052cc", "default": false, "description": ""}, {"id": 1173072136, "node_id": "MDU6TGFiZWwxMTczMDcyMTM2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:XL", "name": "size:XL", "color": "adafea", "default": false, "description": "CL Change Size:Extra Large"}], "state": "open", "locked": false, "assignee": {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 35, "created_at": "2019-11-22T00:33:40Z", "updated_at": "2020-03-16T11:37:24Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/34504", "html_url": "https://github.com/tensorflow/tensorflow/pull/34504", "diff_url": "https://github.com/tensorflow/tensorflow/pull/34504.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/34504.patch"}, "body": "This PR enables a grappler based pass that automatically converts FP32\r\ngraph into BFloat16 graph for training and inference. The PR also adds\r\nsupport for 1) producing verbose logs in a file, and 2) context-based rewrite\r\nfor some ops (such as element-wise) that may not benefit with BFloat16 always.\r\nThe PR also adds grappler-based unit tests. The optimizer is turned OFF\r\nby default (for now). It can turned ON via RewriterConfig.\r\n\r\nChange in meta_optimizer.cc - one change is suggested by Clang and not related\r\nto this feature."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34500", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34500/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34500/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34500/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34500", "id": 526895476, "node_id": "MDU6SXNzdWU1MjY4OTU0NzY=", "number": 34500, "title": "[TF2.1] Performance: Control flow and scalar ops 225x slower than raw Python and 24000x slower than C++", "user": {"login": "divyekapoor", "id": 219248, "node_id": "MDQ6VXNlcjIxOTI0OA==", "avatar_url": "https://avatars0.githubusercontent.com/u/219248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/divyekapoor", "html_url": "https://github.com/divyekapoor", "followers_url": "https://api.github.com/users/divyekapoor/followers", "following_url": "https://api.github.com/users/divyekapoor/following{/other_user}", "gists_url": "https://api.github.com/users/divyekapoor/gists{/gist_id}", "starred_url": "https://api.github.com/users/divyekapoor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/divyekapoor/subscriptions", "organizations_url": "https://api.github.com/users/divyekapoor/orgs", "repos_url": "https://api.github.com/users/divyekapoor/repos", "events_url": "https://api.github.com/users/divyekapoor/events{/privacy}", "received_events_url": "https://api.github.com/users/divyekapoor/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1478826728, "node_id": "MDU6TGFiZWwxNDc4ODI2NzI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:core", "name": "comp:core", "color": "024391", "default": false, "description": ""}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 1097543484, "node_id": "MDU6TGFiZWwxMDk3NTQzNDg0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:runtime", "name": "comp:runtime", "color": "0052cc", "default": false, "description": "c++ runtime, performance issues (cpu)"}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "mdanatg", "id": 26628547, "node_id": "MDQ6VXNlcjI2NjI4NTQ3", "avatar_url": "https://avatars1.githubusercontent.com/u/26628547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mdanatg", "html_url": "https://github.com/mdanatg", "followers_url": "https://api.github.com/users/mdanatg/followers", "following_url": "https://api.github.com/users/mdanatg/following{/other_user}", "gists_url": "https://api.github.com/users/mdanatg/gists{/gist_id}", "starred_url": "https://api.github.com/users/mdanatg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mdanatg/subscriptions", "organizations_url": "https://api.github.com/users/mdanatg/orgs", "repos_url": "https://api.github.com/users/mdanatg/repos", "events_url": "https://api.github.com/users/mdanatg/events{/privacy}", "received_events_url": "https://api.github.com/users/mdanatg/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mdanatg", "id": 26628547, "node_id": "MDQ6VXNlcjI2NjI4NTQ3", "avatar_url": "https://avatars1.githubusercontent.com/u/26628547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mdanatg", "html_url": "https://github.com/mdanatg", "followers_url": "https://api.github.com/users/mdanatg/followers", "following_url": "https://api.github.com/users/mdanatg/following{/other_user}", "gists_url": "https://api.github.com/users/mdanatg/gists{/gist_id}", "starred_url": "https://api.github.com/users/mdanatg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mdanatg/subscriptions", "organizations_url": "https://api.github.com/users/mdanatg/orgs", "repos_url": "https://api.github.com/users/mdanatg/repos", "events_url": "https://api.github.com/users/mdanatg/events{/privacy}", "received_events_url": "https://api.github.com/users/mdanatg/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 11, "created_at": "2019-11-21T23:18:17Z", "updated_at": "2020-01-04T13:45:17Z", "closed_at": null, "author_association": "NONE", "body": "**Summary**\r\nTF Op performance for a simple subgraph (built with AutoGraph) is at-least 2 orders of magnitude slower than expected: looping over 100K numbers takes 4+ seconds instead of 18ms (or much faster)\r\n\r\n**Benchmark code and repro instructions:**\r\nhttps://github.com/divyekapoor/ml-op-benchmarks\r\n\r\n1. Clone the repo\r\n2. `make tfbench`\r\n\r\n```\r\nclass FizzBuzz(tf.Module):\r\n    @tf.function(input_signature=[tf.TensorSpec([], tf.int32)])\r\n    def model(self,\r\n              n  # Shape [] -- int32 the max number to loop FizzBuzz to\r\n              ):  # Returns counts for fizz, buzz and fizzbuzz. Shape: [1] with length 3\r\n        fizz = 0\r\n        buzz = 0\r\n        fizzbuzz = 0\r\n        for i in range(n):\r\n            if i % 6 == 0:\r\n                fizzbuzz += 1\r\n            elif i % 3 == 0:\r\n                buzz += 1\r\n            elif i % 2 == 0:\r\n                fizz += 1\r\n        return [fizz, buzz, fizzbuzz]\r\n```\r\nRaw python: Running the same code without tf.Module and @tf.function.\r\nRaw C++: Equivalent implementation in straight C++.\r\n\r\nPerformance table:\r\n\r\nFizzBuzz Iteration Counts | 100000 | \u00a0 | \u00a0 | \u00a0\r\n-- | -- | -- | -- | --\r\n\u00a0 | Raw Latency (ms) | Per Run Latency (usec) | Python Multiplier | C++ Multiplier\r\nTensorflow Python | 4087 | 40.87 | **227.06** | 24327\r\nTensorflow Saved Model Python | 4046 | 40.46 | **224.78** | 24083\r\nRaw Python | 18 | 0.18 | 1.00 | 107\r\nRaw C++ | 0.168 | 0.00168 | 0.01 | 1\r\n\r\nThe multiplers use the corresponding Python and C++ code as unit = 1.\r\nBenchmark script is attached at the bottom of this issue and only has a dependency on Tensorflow.\r\n\r\nhttps://github.com/divyekapoor/ml-op-benchmarks has something to directly clone and execute.\r\n\r\n(If it would help, TF ops are ~40% slower than Torch ops for the same FizzBuzz benchmark)\r\nhttps://github.com/pytorch/pytorch/issues/30365 for the related PyTorch issue.\r\n\r\nFizzBuzz Iteration Counts | 100000 | \u00a0 | \u00a0 | \u00a0\r\n-- | -- | -- | -- | --\r\n\u00a0 | Raw Latency (ms) | Per Run Latency (usec) | Python Multiplier | C++ Multiplier\r\nPyTorch Python | 4007 | 40.07 | 222.61 | 23851\r\nPyTorch TorchScript Python (from Loaded TorchScript) | 2830 | 28.3 | **157.22** | 16845\r\nPyTorch TorchScript C++ (Native) | 255 | 2.55 | **14.17** | 1518\r\nPyTorch TorchScript C++ (Native + ATen Tensors) | 252 | 2.52 | **14.00** | 1500\r\nRaw Python | 18 | 0.18 | 1.00 | 107\r\nRaw C++ | 0.168 | 0.00168 | 0.01 | 1\r\n\r\n\r\n\r\n\r\nPerformance similar to raw Python is the expected behavior.\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): MacOS Mojave 10.14.6 (18G1012)\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: Not tested.\r\n- TensorFlow installed from (source or binary): binary.\r\n- TensorFlow version (use command below): \r\n== tensorflow import ============================================\r\ntf.version.VERSION = 2.1.0-dev20191107\r\ntf.version.GIT_VERSION = v1.12.1-17543-gb4b5ce680c\r\ntf.version.COMPILER_VERSION = 4.2.1 Compatible Apple LLVM 10.0.0 (clang-1000.11.45.5)\r\n- Python version: \r\n== python version  ==============================================\r\n(major, minor, micro, releaselevel, serial)\r\n(3, 7, 4, 'final', 0)\r\n- Bazel version (if compiling from source): NA.\r\n- GCC/Compiler version (if compiling from source): NA\r\n- CUDA/cuDNN version: NA\r\n- GPU model and memory: NA\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Setup**\r\nPerformance benchmark for conditional ops set up with a FizzBuzz test case:\r\nInput: n -> a range limit (100K)\r\nOutput: a 3 element tensor with counts for (fizz, buzz, fizzbuzz)\r\nGoal: To estimate the performance overhead of TF ops versus raw python / raw C++.\r\nBenchmark file is attached.\r\n\r\n**Describe the current behavior**\r\nFizzBuzz with TF ops is 225x slower than the same code in Raw Python and 24K+x slower than the corresponding C++ implementation. \r\n\r\n**Describe the expected behavior**\r\nFizzBuzz with TF ops should be within 10-50% of raw Python or faster.  \r\n\r\n**Code to reproduce the issue**\r\nAttached to this report.\r\nTo reproduce:\r\n```\r\n$ python3 -m venv venv3\r\n$ source venv3/bin/activate\r\n$ pip3 install tensorflow\r\n$ python3 fizz.py\r\n```\r\nFull version: https://github.com/divyekapoor/ml-op-benchmarks\r\n\r\n**Other info / logs**\r\nPerformance table:\r\n\r\nFizzBuzz Iteration Counts | 100000 | \u00a0 | \u00a0 | \u00a0\r\n-- | -- | -- | -- | --\r\n\u00a0 | Raw Latency (ms) | Per Run Latency (usec) | Python Multiplier | C++ Multiplier\r\nTensorflow Python | 4087 | 40.87 | 227.06 | 24327\r\nTensorflow Saved Model Python | 4046 | 40.46 | 224.78 | 24083\r\nRaw Python | 18 | 0.18 | 1.00 | 107\r\nRaw C++ | 0.168 | 0.00168 | 0.01 | 1\r\n\r\nRaw latency == run with range input N = 100K\r\nPer Run latency == Raw latency / 100K (one run through the op graph)\r\n[fizz.tar.gz](https://github.com/tensorflow/tensorflow/files/3877175/fizz.tar.gz)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34498", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34498/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34498/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34498/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/34498", "id": 526869903, "node_id": "MDExOlB1bGxSZXF1ZXN0MzQ0MjU3MjIy", "number": 34498, "title": "[TFLite] Add support for Particle MCUs to TensorFlow Lite Micro", "user": {"login": "bsatrom", "id": 108356, "node_id": "MDQ6VXNlcjEwODM1Ng==", "avatar_url": "https://avatars2.githubusercontent.com/u/108356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bsatrom", "html_url": "https://github.com/bsatrom", "followers_url": "https://api.github.com/users/bsatrom/followers", "following_url": "https://api.github.com/users/bsatrom/following{/other_user}", "gists_url": "https://api.github.com/users/bsatrom/gists{/gist_id}", "starred_url": "https://api.github.com/users/bsatrom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bsatrom/subscriptions", "organizations_url": "https://api.github.com/users/bsatrom/orgs", "repos_url": "https://api.github.com/users/bsatrom/repos", "events_url": "https://api.github.com/users/bsatrom/events{/privacy}", "received_events_url": "https://api.github.com/users/bsatrom/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1169365682, "node_id": "MDU6TGFiZWwxMTY5MzY1Njgy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:L", "name": "size:L", "color": "adafea", "default": false, "description": "CL Change Size: Large"}], "state": "open", "locked": false, "assignee": {"login": "njeffrie", "id": 6947391, "node_id": "MDQ6VXNlcjY5NDczOTE=", "avatar_url": "https://avatars2.githubusercontent.com/u/6947391?v=4", "gravatar_id": "", "url": "https://api.github.com/users/njeffrie", "html_url": "https://github.com/njeffrie", "followers_url": "https://api.github.com/users/njeffrie/followers", "following_url": "https://api.github.com/users/njeffrie/following{/other_user}", "gists_url": "https://api.github.com/users/njeffrie/gists{/gist_id}", "starred_url": "https://api.github.com/users/njeffrie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/njeffrie/subscriptions", "organizations_url": "https://api.github.com/users/njeffrie/orgs", "repos_url": "https://api.github.com/users/njeffrie/repos", "events_url": "https://api.github.com/users/njeffrie/events{/privacy}", "received_events_url": "https://api.github.com/users/njeffrie/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "njeffrie", "id": 6947391, "node_id": "MDQ6VXNlcjY5NDczOTE=", "avatar_url": "https://avatars2.githubusercontent.com/u/6947391?v=4", "gravatar_id": "", "url": "https://api.github.com/users/njeffrie", "html_url": "https://github.com/njeffrie", "followers_url": "https://api.github.com/users/njeffrie/followers", "following_url": "https://api.github.com/users/njeffrie/following{/other_user}", "gists_url": "https://api.github.com/users/njeffrie/gists{/gist_id}", "starred_url": "https://api.github.com/users/njeffrie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/njeffrie/subscriptions", "organizations_url": "https://api.github.com/users/njeffrie/orgs", "repos_url": "https://api.github.com/users/njeffrie/repos", "events_url": "https://api.github.com/users/njeffrie/events{/privacy}", "received_events_url": "https://api.github.com/users/njeffrie/received_events", "type": "User", "site_admin": false}, {"login": "gbaned", "id": 48215717, "node_id": "MDQ6VXNlcjQ4MjE1NzE3", "avatar_url": "https://avatars3.githubusercontent.com/u/48215717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gbaned", "html_url": "https://github.com/gbaned", "followers_url": "https://api.github.com/users/gbaned/followers", "following_url": "https://api.github.com/users/gbaned/following{/other_user}", "gists_url": "https://api.github.com/users/gbaned/gists{/gist_id}", "starred_url": "https://api.github.com/users/gbaned/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gbaned/subscriptions", "organizations_url": "https://api.github.com/users/gbaned/orgs", "repos_url": "https://api.github.com/users/gbaned/repos", "events_url": "https://api.github.com/users/gbaned/events{/privacy}", "received_events_url": "https://api.github.com/users/gbaned/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-11-21T22:10:26Z", "updated_at": "2020-02-26T00:28:16Z", "closed_at": null, "author_association": "NONE", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/34498", "html_url": "https://github.com/tensorflow/tensorflow/pull/34498", "diff_url": "https://github.com/tensorflow/tensorflow/pull/34498.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/34498.patch"}, "body": "This is a WIP PR for adding support for Particle MCUs to TFLite Micro. It includes the following:\r\n\r\n- [x] `debug_log` implementation for Particle\r\n- [x] `hello_world` example source\r\n- [x] Particle additions to `Makefile` and `helper_functions.inc`\r\n- [x] `test_particle.sh`\r\n- [x] Generate and merge zips in a similar fashion to Arduino builds\r\n- [x] Modifications to `transform_source.py`\r\n- [x] Add `magic_wand` source\r\n- [x] Add `micro_speech` source\r\n\r\nStill to complete:\r\n\r\n- [ ] Remove `fprintf` calls from `kissfft` for Particle projects\r\n- [ ] Transform example projects for standard Particle project formats (`project.properties` and `src` directory)"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34496", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34496/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34496/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34496/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34496", "id": 526793580, "node_id": "MDU6SXNzdWU1MjY3OTM1ODA=", "number": 34496, "title": "\"Conv2DBackpropFilter uses a while_loop. Fix that!\"", "user": {"login": "hnyu", "id": 51248379, "node_id": "MDQ6VXNlcjUxMjQ4Mzc5", "avatar_url": "https://avatars0.githubusercontent.com/u/51248379?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hnyu", "html_url": "https://github.com/hnyu", "followers_url": "https://api.github.com/users/hnyu/followers", "following_url": "https://api.github.com/users/hnyu/following{/other_user}", "gists_url": "https://api.github.com/users/hnyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/hnyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hnyu/subscriptions", "organizations_url": "https://api.github.com/users/hnyu/orgs", "repos_url": "https://api.github.com/users/hnyu/repos", "events_url": "https://api.github.com/users/hnyu/events{/privacy}", "received_events_url": "https://api.github.com/users/hnyu/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-11-21T19:23:24Z", "updated_at": "2019-12-12T21:05:26Z", "closed_at": null, "author_association": "NONE", "body": "\r\n**Describe the current behavior**\r\nCurrently when I compute Jacobian with the option \"experimental_use_pfor=True\" on Conv2D layers, the GPU memory will explode. For other layers like FC (with the same amount of parameters), there is no such issue.\r\n\r\n**Describe the expected behavior**\r\nIf there is any efficient alternative way of doing this (hopefully YES, as indicated by the warning message in the code \"Conv2DBackpropFilter uses a while_loop. Fix that!\"), please kindly update.\r\n\r\n**Code to reproduce the issue**\r\nCall tape.jacobian on a Conv2D network of a moderate size with \"experimental_use_pfor=True\".\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34491", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34491/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34491/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34491/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34491", "id": 526712111, "node_id": "MDU6SXNzdWU1MjY3MTIxMTE=", "number": 34491, "title": "tf.keras computes incorrect loss values with Masking", "user": {"login": "Innuendo1975", "id": 3993300, "node_id": "MDQ6VXNlcjM5OTMzMDA=", "avatar_url": "https://avatars1.githubusercontent.com/u/3993300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Innuendo1975", "html_url": "https://github.com/Innuendo1975", "followers_url": "https://api.github.com/users/Innuendo1975/followers", "following_url": "https://api.github.com/users/Innuendo1975/following{/other_user}", "gists_url": "https://api.github.com/users/Innuendo1975/gists{/gist_id}", "starred_url": "https://api.github.com/users/Innuendo1975/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Innuendo1975/subscriptions", "organizations_url": "https://api.github.com/users/Innuendo1975/orgs", "repos_url": "https://api.github.com/users/Innuendo1975/repos", "events_url": "https://api.github.com/users/Innuendo1975/events{/privacy}", "received_events_url": "https://api.github.com/users/Innuendo1975/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-11-21T16:41:00Z", "updated_at": "2020-01-07T18:33:39Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 18.04\r\n- TensorFlow installed from (source or binary): pip install tensorflow  /  pip install tf-nightly-2.0-preview\r\n- TensorFlow version (use command below): 2.0  /  2.0.0-dev20191002\r\n- Python version: 3.7.5\r\n\r\n**Describe the current behavior**\r\n\r\nWhen fitting an LSTM model with a Masking layer using Keras, if you use binary_crossentropy both as loss and metric, the values are different. In particular, the printed metric is correct, while the loss appears to be calculated without masking.\r\n\r\n**Code to reproduce the issue**\r\n\r\n```\r\nimport numpy as np\r\nfrom numpy.random import normal, randint\r\nfrom tensorflow.keras.preprocessing.sequence import pad_sequences\r\nfrom tensorflow.keras.models import Sequential\r\nfrom tensorflow.keras.layers import Masking, LSTM, Activation, Dense\r\n\r\ntime_steps = 20\r\nnum_seqs = 100\r\nX = normal(size=(num_seqs, time_steps))  # create artificial data\r\nY = np.where(X > 0, 1, 0)  # create simple target\r\n\r\nlens = randint(low=1, high=time_steps, size=num_seqs)  # create lengths < time_steps (padding needed)\r\nseqs = [row[:row_len] for row, row_len in zip(X, lens)]  # artificially cut sequences\r\ntarget_seqs = [row[:row_len] for row, row_len in zip(Y, lens)]  # artificially cut target sequences\r\n\r\npadded_seqs = pad_sequences(seqs, padding='post', dtype='float32', maxlen=time_steps).reshape(num_seqs, time_steps, -1)\r\npadded_targets = pad_sequences(target_seqs, dtype='float32', padding='post', maxlen=time_steps).reshape(num_seqs, time_steps, -1)\r\n\r\nLSTM_SIZE = 16\r\nmodel = Sequential()\r\nmodel.add(Masking(mask_value=0., input_shape=(time_steps,1)))\r\nmodel.add(LSTM(LSTM_SIZE, return_sequences=True))\r\nmodel.add(Dense(1))\r\nmodel.add(Activation(\"sigmoid\"))\r\nmodel.compile(loss=\"binary_crossentropy\", optimizer=\"adam\", metrics=[\"binary_crossentropy\"])\r\nprint(model.summary())\r\n\r\nmodel.fit(padded_seqs, padded_targets, batch_size=1024, epochs=10)\r\n```\r\n\r\nand observe that the loss and metric values are different:\r\n\r\n```\r\nTrain on 100 samples\r\nEpoch 1/10\r\n100/100 [==============================] - 4s 38ms/sample - loss: 0.3365 - binary_crossentropy: 0.6434\r\nEpoch 2/10\r\n100/100 [==============================] - 0s 253us/sample - loss: 0.3361 - binary_crossentropy: 0.6427\r\nEpoch 3/10\r\n100/100 [==============================] - 0s 260us/sample - loss: 0.3357 - binary_crossentropy: 0.6419\r\nEpoch 4/10\r\n100/100 [==============================] - 0s 271us/sample - loss: 0.3353 - binary_crossentropy: 0.6412\r\nEpoch 5/10\r\n100/100 [==============================] - 0s 266us/sample - loss: 0.3349 - binary_crossentropy: 0.6404\r\nEpoch 6/10\r\n100/100 [==============================] - 0s 250us/sample - loss: 0.3345 - binary_crossentropy: 0.6396\r\nEpoch 7/10\r\n100/100 [==============================] - 0s 275us/sample - loss: 0.3341 - binary_crossentropy: 0.6389\r\nEpoch 8/10\r\n100/100 [==============================] - 0s 247us/sample - loss: 0.3337 - binary_crossentropy: 0.6381\r\nEpoch 9/10\r\n100/100 [==============================] - 0s 196us/sample - loss: 0.3333 - binary_crossentropy: 0.6373\r\nEpoch 10/10\r\n100/100 [==============================] - 0s 217us/sample - loss: 0.3329 - binary_crossentropy: 0.6366\r\n```\r\n\r\n**Other info / logs**\r\n\r\nI already saw this closed issue: https://github.com/tensorflow/tensorflow/issues/25970 and the linked https://stackoverflow.com/questions/54802328/why-am-i-getting-different-values-between-loss-functions-and-metrics-in-tensorfl\r\nThat problem appears to be solved in my version, but my problem persists.\r\n \r\nI also saw this stackoverflow post: https://stackoverflow.com/questions/53808163/same-function-in-keras-loss-and-metric-give-different-values-even-without-regula\r\n\r\nThe solution doesn't work for me. I tried changing the import statements to\r\n\r\n```\r\nfrom keras.preprocessing.sequence import pad_sequences\r\nfrom keras.models import Sequential\r\nfrom keras.layers import Masking, LSTM, Activation, Dense\r\n```\r\n\r\nbut the problem remains.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34488", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34488/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34488/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34488/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34488", "id": 526640896, "node_id": "MDU6SXNzdWU1MjY2NDA4OTY=", "number": 34488, "title": "ListWrapper does not support insert method for nested lists of layers", "user": {"login": "fjean", "id": 7607454, "node_id": "MDQ6VXNlcjc2MDc0NTQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/7607454?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fjean", "html_url": "https://github.com/fjean", "followers_url": "https://api.github.com/users/fjean/followers", "following_url": "https://api.github.com/users/fjean/following{/other_user}", "gists_url": "https://api.github.com/users/fjean/gists{/gist_id}", "starred_url": "https://api.github.com/users/fjean/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fjean/subscriptions", "organizations_url": "https://api.github.com/users/fjean/orgs", "repos_url": "https://api.github.com/users/fjean/repos", "events_url": "https://api.github.com/users/fjean/events{/privacy}", "received_events_url": "https://api.github.com/users/fjean/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "qlzh727", "id": 5118881, "node_id": "MDQ6VXNlcjUxMTg4ODE=", "avatar_url": "https://avatars3.githubusercontent.com/u/5118881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qlzh727", "html_url": "https://github.com/qlzh727", "followers_url": "https://api.github.com/users/qlzh727/followers", "following_url": "https://api.github.com/users/qlzh727/following{/other_user}", "gists_url": "https://api.github.com/users/qlzh727/gists{/gist_id}", "starred_url": "https://api.github.com/users/qlzh727/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qlzh727/subscriptions", "organizations_url": "https://api.github.com/users/qlzh727/orgs", "repos_url": "https://api.github.com/users/qlzh727/repos", "events_url": "https://api.github.com/users/qlzh727/events{/privacy}", "received_events_url": "https://api.github.com/users/qlzh727/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "qlzh727", "id": 5118881, "node_id": "MDQ6VXNlcjUxMTg4ODE=", "avatar_url": "https://avatars3.githubusercontent.com/u/5118881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qlzh727", "html_url": "https://github.com/qlzh727", "followers_url": "https://api.github.com/users/qlzh727/followers", "following_url": "https://api.github.com/users/qlzh727/following{/other_user}", "gists_url": "https://api.github.com/users/qlzh727/gists{/gist_id}", "starred_url": "https://api.github.com/users/qlzh727/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qlzh727/subscriptions", "organizations_url": "https://api.github.com/users/qlzh727/orgs", "repos_url": "https://api.github.com/users/qlzh727/repos", "events_url": "https://api.github.com/users/qlzh727/events{/privacy}", "received_events_url": "https://api.github.com/users/qlzh727/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-11-21T14:47:10Z", "updated_at": "2020-01-08T17:14:59Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code: **yes**\r\n- OS Platform and Distribution: **Linux Ubuntu 18.04**\r\n- Mobile device: **N/A**\r\n- TensorFlow installed from: **binary**\r\n- TensorFlow version: **2.0.0**\r\n- Python version: **3.7.5**\r\n- Bazel version: **N/A**\r\n- GCC/Compiler version: **N/A**\r\n- CUDA/cuDNN version: **10.1 / 7.6.4**\r\n- GPU model and memory: **GeForce GTX 1070, 8 GB**\r\n\r\n**Describe the current behavior**\r\nList of layers added to another `list` with the `insert` method are ignored by the model; it works fine with the `append` method.\r\n\r\nThis seems to be a problem with ListWrapper.\r\n\r\n**Describe the expected behavior**\r\nAll `list` methods should be supported for defining nested list of layers.\r\n\r\n**Code to reproduce the issue**\r\n\r\nMinimal example:\r\n\r\n```python\r\nclass MyModel(tf.keras.Model): \r\n    def __init__(self, **kwargs): \r\n        super().__init__(**kwargs) \r\n        self.conv1 = [] \r\n        self.conv1.append([tf.keras.layers.Conv2D(8, 3, name=\"conv1\")]) \r\n        self.conv2 = [] \r\n        self.conv2.insert(0, [tf.keras.layers.Conv2D(16, 3, name=\"conv2\")]) \r\n\r\n    def call(self, inputs): \r\n        x = inputs \r\n        x = self.conv1[0][0](x) \r\n        x = self.conv2[0][0](x) \r\n        return x\r\n\r\n\r\nm = MyModel()\r\nm.build((None, None, None, 3))\r\nm.summary()\r\n\r\nfor w in m.trainable_weights: \r\n    print(w.name)\r\n```\r\noutput is:\r\n```\r\nModel: \"my_model\"\r\n_________________________________________________________________\r\nLayer (type)                 Output Shape              Param #   \r\n=================================================================\r\nconv1 (Conv2D)               multiple                  224       \r\n=================================================================\r\nTotal params: 224\r\nTrainable params: 224\r\nNon-trainable params: 0\r\n_________________________________________________________________\r\n\r\nconv1/kernel:0\r\nconv1/bias:0\r\n```\r\nNote that `conv2` has been ignored.\r\n\r\n**Other info / logs**\r\n\r\nN/A"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34481", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34481/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34481/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34481/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34481", "id": 526480307, "node_id": "MDU6SXNzdWU1MjY0ODAzMDc=", "number": 34481, "title": "Summaries producing warnings", "user": {"login": "plooney", "id": 5527810, "node_id": "MDQ6VXNlcjU1Mjc4MTA=", "avatar_url": "https://avatars0.githubusercontent.com/u/5527810?v=4", "gravatar_id": "", "url": "https://api.github.com/users/plooney", "html_url": "https://github.com/plooney", "followers_url": "https://api.github.com/users/plooney/followers", "following_url": "https://api.github.com/users/plooney/following{/other_user}", "gists_url": "https://api.github.com/users/plooney/gists{/gist_id}", "starred_url": "https://api.github.com/users/plooney/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/plooney/subscriptions", "organizations_url": "https://api.github.com/users/plooney/orgs", "repos_url": "https://api.github.com/users/plooney/repos", "events_url": "https://api.github.com/users/plooney/events{/privacy}", "received_events_url": "https://api.github.com/users/plooney/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1190546177, "node_id": "MDU6TGFiZWwxMTkwNTQ2MTc3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:autograph", "name": "comp:autograph", "color": "0052cc", "default": false, "description": ""}, {"id": 284285184, "node_id": "MDU6TGFiZWwyODQyODUxODQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tensorboard", "name": "comp:tensorboard", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "nfelt", "id": 710113, "node_id": "MDQ6VXNlcjcxMDExMw==", "avatar_url": "https://avatars0.githubusercontent.com/u/710113?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nfelt", "html_url": "https://github.com/nfelt", "followers_url": "https://api.github.com/users/nfelt/followers", "following_url": "https://api.github.com/users/nfelt/following{/other_user}", "gists_url": "https://api.github.com/users/nfelt/gists{/gist_id}", "starred_url": "https://api.github.com/users/nfelt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nfelt/subscriptions", "organizations_url": "https://api.github.com/users/nfelt/orgs", "repos_url": "https://api.github.com/users/nfelt/repos", "events_url": "https://api.github.com/users/nfelt/events{/privacy}", "received_events_url": "https://api.github.com/users/nfelt/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "nfelt", "id": 710113, "node_id": "MDQ6VXNlcjcxMDExMw==", "avatar_url": "https://avatars0.githubusercontent.com/u/710113?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nfelt", "html_url": "https://github.com/nfelt", "followers_url": "https://api.github.com/users/nfelt/followers", "following_url": "https://api.github.com/users/nfelt/following{/other_user}", "gists_url": "https://api.github.com/users/nfelt/gists{/gist_id}", "starred_url": "https://api.github.com/users/nfelt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nfelt/subscriptions", "organizations_url": "https://api.github.com/users/nfelt/orgs", "repos_url": "https://api.github.com/users/nfelt/repos", "events_url": "https://api.github.com/users/nfelt/events{/privacy}", "received_events_url": "https://api.github.com/users/nfelt/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-11-21T09:50:21Z", "updated_at": "2019-12-03T22:41:10Z", "closed_at": null, "author_association": "NONE", "body": "The example code states \r\n\r\n```\r\nwriter = tf.summary.create_file_writer(\"/tmp/mylogs/tf_function\")\r\n\r\n@tf.function\r\ndef my_func(step):\r\n  with writer.as_default():\r\n    # other model code would go here\r\n    tf.summary.scalar(\"my_metric\", 0.5, step=step)\r\n\r\nfor step in range(100):\r\n  my_func(step)\r\n  writer.flush()\r\n```\r\n\r\nBut on multiple systems and operating systems I am seeing warnings using code like this of the form \r\n\r\n> \r\nWARNING:tensorflow:5 out of the last 5 calls to <function my_func at 0x7fc4f0197ae8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings is likely due to passing python objects instead of tensors. Also, tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. Please refer to https://www.tensorflow.org/beta/tutorials/eager/tf_function#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for more details.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34462", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34462/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34462/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34462/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34462", "id": 526081217, "node_id": "MDU6SXNzdWU1MjYwODEyMTc=", "number": 34462, "title": "Please don't implement a feature suggested in a categorical cross-entropy TODO", "user": {"login": "JimBiardCics", "id": 17711910, "node_id": "MDQ6VXNlcjE3NzExOTEw", "avatar_url": "https://avatars2.githubusercontent.com/u/17711910?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBiardCics", "html_url": "https://github.com/JimBiardCics", "followers_url": "https://api.github.com/users/JimBiardCics/followers", "following_url": "https://api.github.com/users/JimBiardCics/following{/other_user}", "gists_url": "https://api.github.com/users/JimBiardCics/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBiardCics/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBiardCics/subscriptions", "organizations_url": "https://api.github.com/users/JimBiardCics/orgs", "repos_url": "https://api.github.com/users/JimBiardCics/repos", "events_url": "https://api.github.com/users/JimBiardCics/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBiardCics/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-11-20T19:26:14Z", "updated_at": "2019-11-22T23:49:44Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): v2.0.0\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nThis is actually an anti-request. I'm requesting that the developers not implement suggested future behavior.\r\n\r\nThere is a TODO comment in [tensorflow/python/ops/nn_ops.py line 3289](https://github.com/tensorflow/tensorflow/blob/b646d41f69f8a1cf2f5c76d934adbf8c067e4444/tensorflow/python/ops/nn_ops.py#L3289) that states an intention to change the categorical cross-entropy loss algorithm so that it will raise an error if the sum of any label vector is not equal to 1. The comment states:\r\n```\r\n  # TODO(pcmurray) Raise an error when the labels do not sum to 1. Note: This\r\n  # could break users who call this with bad labels, but disregard the bad\r\n  # results.\r\n```\r\n\r\nI make use of label vectors with all elements set to zero in order to perform spatial masking of data in my 2D convolutional neural network. I have regions in some of my images where there is no label available, and the regions change from image to image. These regions make no contribution to the loss if the corresponding label vectors are set to all zero, effectively removing them from gradient calculation and back-propagation. (The regions in the images have valid input data, but a label cannot be assigned.) My suggestion is that this TODO not be implemented or that the implementation would allow for all-zero label vectors.\r\n\r\n**Will this change the current api? How?**\r\nThis will not change the current API.\r\n\r\n**Who will benefit with this feature?**\r\nPeople (like me) who use the current way the algorithm is implemented to do per-image spatial masking."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34460", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34460/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34460/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34460/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34460", "id": 525915615, "node_id": "MDU6SXNzdWU1MjU5MTU2MTU=", "number": 34460, "title": "404 link in documentation", "user": {"login": "gregsadetsky", "id": 1017304, "node_id": "MDQ6VXNlcjEwMTczMDQ=", "avatar_url": "https://avatars0.githubusercontent.com/u/1017304?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gregsadetsky", "html_url": "https://github.com/gregsadetsky", "followers_url": "https://api.github.com/users/gregsadetsky/followers", "following_url": "https://api.github.com/users/gregsadetsky/following{/other_user}", "gists_url": "https://api.github.com/users/gregsadetsky/gists{/gist_id}", "starred_url": "https://api.github.com/users/gregsadetsky/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gregsadetsky/subscriptions", "organizations_url": "https://api.github.com/users/gregsadetsky/orgs", "repos_url": "https://api.github.com/users/gregsadetsky/repos", "events_url": "https://api.github.com/users/gregsadetsky/events{/privacy}", "received_events_url": "https://api.github.com/users/gregsadetsky/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1114343535, "node_id": "MDU6TGFiZWwxMTE0MzQzNTM1", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:data", "name": "comp:data", "color": "0052cc", "default": false, "description": "tf.data related issues"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-11-20T16:26:04Z", "updated_at": "2020-03-05T17:01:19Z", "closed_at": null, "author_association": "NONE", "body": "## URL(s) with the issue:\r\n\r\nhttps://github.com/tensorflow/docs/blob/master/site/en/r1/tutorials/sequences/audio_recognition.md\r\n\r\n## Description of issue (what needs changing):\r\n\r\nNon functioning link in the documentation:\r\n\r\n```\r\n### Custom Training Data\r\nBy default the script will download the [Speech Commands\r\ndataset](https://download.tensorflow.org/data/speech_commands_v0.01.tgz)\r\n```\r\n\r\nhttps://download.tensorflow.org/data/speech_commands_v0.01.tgz leads to a non working page. "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34459", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34459/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34459/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34459/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34459", "id": 525903673, "node_id": "MDU6SXNzdWU1MjU5MDM2NzM=", "number": 34459, "title": "Modifications to BUILD to Use Target libtensorflowlite and make tar.gz", "user": {"login": "dtsmith2001", "id": 3189861, "node_id": "MDQ6VXNlcjMxODk4NjE=", "avatar_url": "https://avatars1.githubusercontent.com/u/3189861?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dtsmith2001", "html_url": "https://github.com/dtsmith2001", "followers_url": "https://api.github.com/users/dtsmith2001/followers", "following_url": "https://api.github.com/users/dtsmith2001/following{/other_user}", "gists_url": "https://api.github.com/users/dtsmith2001/gists{/gist_id}", "starred_url": "https://api.github.com/users/dtsmith2001/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dtsmith2001/subscriptions", "organizations_url": "https://api.github.com/users/dtsmith2001/orgs", "repos_url": "https://api.github.com/users/dtsmith2001/repos", "events_url": "https://api.github.com/users/dtsmith2001/events{/privacy}", "received_events_url": "https://api.github.com/users/dtsmith2001/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-11-20T16:08:01Z", "updated_at": "2019-11-25T18:18:54Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04.3 LTS\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version: tag v2.0.0\r\n- Python version: Python 3.6.8\r\n- Installed using virtualenv? pip? conda?: from GitHub repository\r\n- Bazel version (if compiling from source): Build label: 0.26.0\r\n- GCC/Compiler version (if compiling from source): gcc version 7.4.0 (Ubuntu 7.4.0-1ubuntu1~18.04.1)\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: N/A\r\n\r\n\r\n\r\n**Describe the problem**\r\n\r\nI modified `tensorflow/tensorflow/tools/lib_package/BUILD` (enclosed). I am trying to build Tensorflow Lite in the same way the Tensorflow C library is built.\r\n\r\n```bash\r\nbazel build --jobs=1 --local_ram_resources=1024 --config=opt --config=v2 --config=noaws //tensorflow/tools/lib_package:libtensorflow\r\n```\r\n\r\nFinal output:\r\n\r\n```\r\nTarget //tensorflow/tools/lib_package:libtensorflow up-to-date:\r\n  bazel-bin/tensorflow/tools/lib_package/libtensorflow.tar.gz\r\n```\r\nI'd like to do the same for Tensorflow Lite.\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n\r\n1. Compiled Tensorflow C package using `bazel build --jobs=1 --local_ram_resources=1024 --config=opt --config=v2 --config=noaws //tensorflow/tools/lib_package:libtensorflow`\r\n2. Modified `tensorflow/tensorflow/tools/lib_package/BUILD`.\r\n3. Compiled Tensorflow Lite using `bazel build --jobs=1 --local_ram_resources=1024 --config=opt --config=v2 --config=noaws //tensorflow/lite:libtensorflowlite.so`.\r\n4. The archive `libtensorflowlite.tar.gz` is not produced.\r\n5. Tried `bazel build --jobs=1 --local_ram_resources=1024 --config=opt --config=v2 --config=noaws //tensorflow/lite:libtensorflowlite.so` but got the error\r\n\r\n```\r\nERROR: Skipping '//tensorflow/lite:libtensorflowlite': no such target '//tensorflow/lite:libtensorflowlite': target 'libtensorflowlite' not declared in package 'tensorflow/lite' (did you mean 'libtensorflowlite.so'?) defined by /mnt/drive/stuff/src/tensorflow/tensorflow/lite/BUILD\r\nWARNING: Target pattern parsing failed.\r\nERROR: no such target '//tensorflow/lite:libtensorflowlite': target 'libtensorflowlite' not declared in package 'tensorflow/lite' (did you mean 'libtensorflowlite.so'?) defined by /mnt/drive/stuff/src/tensorflow/tensorflow/lite/BUILD\r\nINFO: Elapsed time: 0.279s\r\nINFO: 0 processes.\r\nFAILED: Build did NOT complete successfully (0 pac\\\r\nkages loaded)\r\n```\r\n\r\nI am happy to turn this into a PR.\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\nN/A\r\n\r\n[BUILD.zip](https://github.com/tensorflow/tensorflow/files/3870140/BUILD.zip)\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34455", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34455/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34455/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34455/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34455", "id": 525846582, "node_id": "MDU6SXNzdWU1MjU4NDY1ODI=", "number": 34455, "title": "tf.ragged.stack breaks with rank-1 regular tensors", "user": {"login": "RunOrVeith", "id": 12949211, "node_id": "MDQ6VXNlcjEyOTQ5MjEx", "avatar_url": "https://avatars3.githubusercontent.com/u/12949211?v=4", "gravatar_id": "", "url": "https://api.github.com/users/RunOrVeith", "html_url": "https://github.com/RunOrVeith", "followers_url": "https://api.github.com/users/RunOrVeith/followers", "following_url": "https://api.github.com/users/RunOrVeith/following{/other_user}", "gists_url": "https://api.github.com/users/RunOrVeith/gists{/gist_id}", "starred_url": "https://api.github.com/users/RunOrVeith/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/RunOrVeith/subscriptions", "organizations_url": "https://api.github.com/users/RunOrVeith/orgs", "repos_url": "https://api.github.com/users/RunOrVeith/repos", "events_url": "https://api.github.com/users/RunOrVeith/events{/privacy}", "received_events_url": "https://api.github.com/users/RunOrVeith/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-11-20T14:41:35Z", "updated_at": "2019-11-24T11:51:09Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):Linux Ubuntu 18.04\r\n- TensorFlow installed from (source or binary): binary pip \r\n- TensorFlow version (use command below): v2.0.0-rc2-26-g64c3d38 2.0.0\r\n- Python version: 3.6.5\r\n- CUDA/cuDNN version: CUDA 10.1 cuDNN 7.6.2.24\r\n- GPU model and memory: Quadro P2000\r\n\r\n**Describe the current behavior**\r\n\r\nWhen creating a ragged tensor by using `tf.ragged.stack` on several regular tensors on the 0-th axis, the function crashes when the rank of the input tensors is 1.\r\n\r\n**Describe the expected behavior**\r\n\r\nAccording to the [documentation](https://www.tensorflow.org/api_docs/python/tf/ragged/stack): `Given a list of tensors or ragged tensors with the same rank R (R >= axis) [...]`. Here, R=1 and  axis=0, so the preconditions should be fulfilled.\r\n\r\n**Code to reproduce the issue**\r\n```python\r\nimport tensorflow as tf\r\ntf.ragged.stack([[1, 2, 3], [1, 2]], axis=0)\r\n```\r\n\r\n**Other info / logs**\r\nCalling the 2 lines above results in:\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/veith/Projects/venvs/anontf2/lib/python3.6/site-packages/IPython/core/interactiveshell.py\", line 3326, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-14-488f6e6430bd>\", line 1, in <module>\r\n    tf.ragged.stack([[1, 2, 3], [1, 2]], axis=0)\r\n  File \"/home/veith/Projects/venvs/anontf2/lib/python3.6/site-packages/tensorflow_core/python/ops/ragged/ragged_concat_ops.py\", line 113, in stack\r\n    return _ragged_stack_concat_helper(values, axis, stack_values=True)\r\n  File \"/home/veith/Projects/venvs/anontf2/lib/python3.6/site-packages/tensorflow_core/python/ops/ragged/ragged_concat_ops.py\", line 167, in _ragged_stack_concat_helper\r\n    return array_ops.stack(rt_inputs, axis)\r\n  File \"/home/veith/Projects/venvs/anontf2/lib/python3.6/site-packages/tensorflow_core/python/util/dispatch.py\", line 180, in wrapper\r\n    return target(*args, **kwargs)\r\n  File \"/home/veith/Projects/venvs/anontf2/lib/python3.6/site-packages/tensorflow_core/python/ops/array_ops.py\", line 1154, in stack\r\n    return ops.convert_to_tensor(values, name=name)\r\n  File \"/home/veith/Projects/venvs/anontf2/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py\", line 1184, in convert_to_tensor\r\n    return convert_to_tensor_v2(value, dtype, preferred_dtype, name)\r\n  File \"/home/veith/Projects/venvs/anontf2/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py\", line 1242, in convert_to_tensor_v2\r\n    as_ref=False)\r\n  File \"/home/veith/Projects/venvs/anontf2/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py\", line 1296, in internal_convert_to_tensor\r\n    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)\r\n  File \"/home/veith/Projects/venvs/anontf2/lib/python3.6/site-packages/tensorflow_core/python/ops/array_ops.py\", line 1278, in _autopacking_conversion_function\r\n    return _autopacking_helper(v, dtype, name or \"packed\")\r\n  File \"/home/veith/Projects/venvs/anontf2/lib/python3.6/site-packages/tensorflow_core/python/ops/array_ops.py\", line 1184, in _autopacking_helper\r\n    return gen_array_ops.pack(list_or_tuple, name=name)\r\n  File \"/home/veith/Projects/venvs/anontf2/lib/python3.6/site-packages/tensorflow_core/python/ops/gen_array_ops.py\", line 6293, in pack\r\n    _six.raise_from(_core._status_to_exception(e.code, message), None)\r\n  File \"<string>\", line 3, in raise_from\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Shapes of all inputs must match: values[0].shape = [3] != values[1].shape = [2] [Op:Pack] name: stack\r\n```\r\n\r\n**Workaround**\r\n\r\nExpanding the rank-1 tensors to rank-2 tensors followed by squeezing the redundant dimension seems to work:\r\n```python\r\nimport tensorflow as tf\r\nx = tf.ragged.stack([[[1, 2, 3]], [[1, 2]]], axis=0)\r\nprint(x.bounding_shape())  # <tf.Tensor: id=929, shape=(3,), dtype=int64, numpy=array([2, 1, 3])>\r\nx = tf.squeeze(x, axis=1) \r\nprint(x.bounding_shape())  # <tf.Tensor: id=1109, shape=(2,), dtype=int64, numpy=array([2, 3])>\r\n```\r\n\r\n**Estimated cause**\r\n\r\nI did not check the tensorflow source code for this, but the [general ragged documentation](https://www.tensorflow.org/guide/ragged_tensor#ragged_tensors_definitions) states:\r\n![image](https://user-images.githubusercontent.com/12949211/69247798-544f0780-0bab-11ea-8ff0-3f6626a8e2f8.png)\r\nI assume the issue is that there is no uniform dimension in the regular tensors before stacking them. Intuitively I would have assumed that I can use `tf.ragged.stack` to create this uniform dimension to form a ragged tensor from several non-ragged different-dimension tensors as above, similar to the regulat `tf.stack`, which creates a new dimension.\r\nI am not sure whether this is considered a bug or an error in the documentation of `tf.ragged.stack`, but it feels like a bug from a user perspective."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34450", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34450/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34450/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34450/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/34450", "id": 525760343, "node_id": "MDExOlB1bGxSZXF1ZXN0MzQzMzIwMTUx", "number": 34450, "title": "TFLite UnityPlugin: Add more interpreter functions on Unity Plugin", "user": {"login": "asus4", "id": 357497, "node_id": "MDQ6VXNlcjM1NzQ5Nw==", "avatar_url": "https://avatars1.githubusercontent.com/u/357497?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asus4", "html_url": "https://github.com/asus4", "followers_url": "https://api.github.com/users/asus4/followers", "following_url": "https://api.github.com/users/asus4/following{/other_user}", "gists_url": "https://api.github.com/users/asus4/gists{/gist_id}", "starred_url": "https://api.github.com/users/asus4/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asus4/subscriptions", "organizations_url": "https://api.github.com/users/asus4/orgs", "repos_url": "https://api.github.com/users/asus4/repos", "events_url": "https://api.github.com/users/asus4/events{/privacy}", "received_events_url": "https://api.github.com/users/asus4/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1169365494, "node_id": "MDU6TGFiZWwxMTY5MzY1NDk0", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:M", "name": "size:M", "color": "adafea", "default": false, "description": "CL Change Size: Medium"}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-11-20T12:01:52Z", "updated_at": "2020-03-17T19:53:01Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/34450", "html_url": "https://github.com/tensorflow/tensorflow/pull/34450", "diff_url": "https://github.com/tensorflow/tensorflow/pull/34450.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/34450.patch"}, "body": "Added functions calling `c_api.h` from Unity plugin"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34449", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34449/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34449/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34449/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34449", "id": 525751286, "node_id": "MDU6SXNzdWU1MjU3NTEyODY=", "number": 34449, "title": "TensorBoard callback should not close and reopen writers to enable reuse", "user": {"login": "bersbersbers", "id": 12128514, "node_id": "MDQ6VXNlcjEyMTI4NTE0", "avatar_url": "https://avatars1.githubusercontent.com/u/12128514?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bersbersbers", "html_url": "https://github.com/bersbersbers", "followers_url": "https://api.github.com/users/bersbersbers/followers", "following_url": "https://api.github.com/users/bersbersbers/following{/other_user}", "gists_url": "https://api.github.com/users/bersbersbers/gists{/gist_id}", "starred_url": "https://api.github.com/users/bersbersbers/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bersbersbers/subscriptions", "organizations_url": "https://api.github.com/users/bersbersbers/orgs", "repos_url": "https://api.github.com/users/bersbersbers/repos", "events_url": "https://api.github.com/users/bersbersbers/events{/privacy}", "received_events_url": "https://api.github.com/users/bersbersbers/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rchao", "id": 6505863, "node_id": "MDQ6VXNlcjY1MDU4NjM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6505863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rchao", "html_url": "https://github.com/rchao", "followers_url": "https://api.github.com/users/rchao/followers", "following_url": "https://api.github.com/users/rchao/following{/other_user}", "gists_url": "https://api.github.com/users/rchao/gists{/gist_id}", "starred_url": "https://api.github.com/users/rchao/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rchao/subscriptions", "organizations_url": "https://api.github.com/users/rchao/orgs", "repos_url": "https://api.github.com/users/rchao/repos", "events_url": "https://api.github.com/users/rchao/events{/privacy}", "received_events_url": "https://api.github.com/users/rchao/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-11-20T11:43:00Z", "updated_at": "2019-12-17T22:25:37Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes, see below\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): OpenSUSE\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): v2.0.0-rc2-26-g64c3d38 2.0.0\r\n- Python version: 3.7.5\r\n\r\n**Describe the current behavior**\r\nCurrently, the `tf.keras.callbacks.TensorBoard.set_model` function closes the `train` writer, only to reopen it two lines later:\r\n\r\nhttps://github.com/tensorflow/tensorflow/blob/7eef97bba7a9018d6b0630418d0810f94c1d2222/tensorflow/python/keras/callbacks.py#L1535-L1537\r\n\r\nThis complicates sharing the writer with other callbacks, e.g., in my code below: this code throws a `RuntimeError: SummaryWriter is already closed`.\r\n\r\n**Describe the expected behavior**\r\n`tf.keras.callbacks.TensorBoard.set_model` should only close those writers that will not be needed any longer.\r\n\r\n**Code to reproduce the issue**\r\n```\r\n# import keras\r\nimport numpy as np\r\nimport tensorboard.plugins.hparams.api as hp\r\nimport tensorflow.keras as keras\r\n\r\ntb_callback = keras.callbacks.TensorBoard(log_dir='/tmp')\r\ntb_train_writer = tb_callback._get_writer(tb_callback._train_run_name)  # pylint:disable=protected-access\r\nhp_callback = hp.KerasCallback(tb_train_writer, {'param': 42})\r\nmodel = keras.applications.VGG16()\r\nmodel.compile(optimizer=keras.optimizers.Adam(), loss='categorical_crossentropy')\r\nmodel.fit(np.empty((1, 224, 224, 3)), np.empty((1, 1000)), callbacks=[tb_callback, hp_callback])\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34444", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34444/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34444/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34444/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34444", "id": 525690094, "node_id": "MDU6SXNzdWU1MjU2OTAwOTQ=", "number": 34444, "title": "tf.reduce_mean crashes TensorFlow Lite", "user": {"login": "vmarkovtsev", "id": 2793551, "node_id": "MDQ6VXNlcjI3OTM1NTE=", "avatar_url": "https://avatars3.githubusercontent.com/u/2793551?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vmarkovtsev", "html_url": "https://github.com/vmarkovtsev", "followers_url": "https://api.github.com/users/vmarkovtsev/followers", "following_url": "https://api.github.com/users/vmarkovtsev/following{/other_user}", "gists_url": "https://api.github.com/users/vmarkovtsev/gists{/gist_id}", "starred_url": "https://api.github.com/users/vmarkovtsev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vmarkovtsev/subscriptions", "organizations_url": "https://api.github.com/users/vmarkovtsev/orgs", "repos_url": "https://api.github.com/users/vmarkovtsev/repos", "events_url": "https://api.github.com/users/vmarkovtsev/events{/privacy}", "received_events_url": "https://api.github.com/users/vmarkovtsev/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-11-20T09:48:18Z", "updated_at": "2019-12-10T23:44:36Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- Ubuntu 18.04 4.15.0-66-generic x86_64 \r\n- TensorFlow installed from (source or binary): official wheel\r\n- TensorFlow version (use command below): v2.0.0-rc2-26-g64c3d38 2.0.0\r\n- Python version: 3.7\r\n- CUDA/cuDNN version: N/A\r\n\r\n**Describe the current behavior**\r\n\r\nThe program SIGABRTs (see the code below).\r\n\r\n**Describe the expected behavior**\r\n\r\nThe program does not crash.\r\n\r\n**Code to reproduce the issue**\r\n\r\n<details>\r\n<summary>Code</summary>\r\n\r\n```python\r\nfrom time import time\r\n\r\nimport numpy as np\r\nimport tensorflow as tf\r\nfrom tensorflow.lite.python.interpreter import load_delegate\r\n\r\n\r\ndef measure(size, rep, tpu):\r\n    @tf.function(input_signature=[tf.TensorSpec([size] * 2, tf.float32)] * 2)\r\n    def bench_func(a, b):\r\n        x = tf.linalg.matmul(a, b)\r\n        return tf.reduce_mean(x)\r\n    \r\n    def gen_input_samples():\r\n        i = np.identity(size, np.float32)\r\n        yield [-i, i]\r\n        yield [i, i]\r\n\r\n    converter = tf.lite.TFLiteConverter.from_concrete_functions([bench_func.get_concrete_function()])\r\n    converter.optimizations = [tf.lite.Optimize.DEFAULT]\r\n    converter.representative_dataset = gen_input_samples\r\n    converter.target_spec.supported_ops = [tf.lite.OpsSet.TFLITE_BUILTINS_INT8]\r\n    converter.inference_input_type = tf.uint8\r\n    converter.inference_output_type = tf.uint8\r\n    tflite_model = converter.convert()\r\n    delegates = [load_delegate(\"libedgetpu.so.1.0\")] if tpu else []\r\n    interpreter = tf.lite.Interpreter(model_content=tflite_model, experimental_delegates=delegates)\r\n    interpreter.allocate_tensors()\r\n    input_details = interpreter.get_input_details()\r\n    output_details = interpreter.get_output_details()\r\n    tensor_in1 = interpreter.tensor(input_details[0][\"index\"])\r\n    tensor_in2 = interpreter.tensor(input_details[1][\"index\"])\r\n    tensor_out = interpreter.tensor(output_details[0][\"index\"])\r\n    inp1 = np.random.rand(size, size) - 0.5\r\n    inp2 = np.random.rand(size, size) - 0.5\r\n    tensor_in1()[:] = inp1\r\n    tensor_in2()[:] = inp2\r\n    now = time()\r\n    for _ in range(rep):\r\n        interpreter.invoke()\r\n    return time() - now\r\n \r\nprint(measure(2048, 1, tpu=False))\r\n```\r\n</details>\r\n\r\n**Other info / logs**\r\n<details>\r\n<summary>Log</summary>\r\n\r\n```\r\n2019-11-20 10:43:18.538007: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1\r\n2019-11-20 10:43:18.546197: E tensorflow/stream_executor/cuda/cuda_driver.cc:318] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected\r\n2019-11-20 10:43:18.546227: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (vadim-XPS-13-9380): /proc/driver/nvidia/version does not exist\r\n2019-11-20 10:43:18.546569: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2019-11-20 10:43:18.572569: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 1992000000 Hz\r\n2019-11-20 10:43:18.573251: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x48fd5a0 executing computations on platform Host. Devices:\r\n2019-11-20 10:43:18.573290: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version\r\n2019-11-20 10:43:18.671265: I tensorflow/core/grappler/devices.cc:55] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0\r\n2019-11-20 10:43:18.671336: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2019-11-20 10:43:18.690246: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:716] Optimization results for grappler item: graph_to_optimize\r\n2019-11-20 10:43:18.690274: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:718]   function_optimizer: function_optimizer did nothing. time = 0.005ms.\r\n2019-11-20 10:43:18.690277: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:718]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2019-11-20 10:43:18.700228: I tensorflow/core/grappler/devices.cc:55] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0\r\n2019-11-20 10:43:18.700397: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2019-11-20 10:43:18.720772: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:716] Optimization results for grappler item: graph_to_optimize\r\n2019-11-20 10:43:18.720800: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:718]   constant folding: Graph size after: 6 nodes (0), 5 edges (0), time = 0.895ms.\r\n2019-11-20 10:43:18.720822: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:718]   constant folding: Graph size after: 6 nodes (0), 5 edges (0), time = 0.072ms.\r\nINFO: Initialized TensorFlow Lite runtime.\r\nINFO: Initialized TensorFlow Lite runtime.\r\nAborted (core dumped)\r\n```\r\n</details>\r\n\r\n<details>\r\n<summary>gdb bt</summary>\r\n\r\n```\r\n#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\r\n#1  0x00007ffff7a24801 in __GI_abort () at abort.c:79\r\n#2  0x00007fff3c18b616 in TfLiteStatus tflite::ops::builtin::reduce::EvalMean<(tflite::ops::builtin::reduce::KernelType)0>(TfLiteContext*, TfLiteNode*) ()\r\n   from /usr/local/lib/python3.7/dist-packages/tensorflow_core/lite/python/interpreter_wrapper/_tensorflow_wrap_interpreter_wrapper.so\r\n#3  0x00007fff3c1f0577 in tflite::Subgraph::Invoke() ()\r\n   from /usr/local/lib/python3.7/dist-packages/tensorflow_core/lite/python/interpreter_wrapper/_tensorflow_wrap_interpreter_wrapper.so\r\n#4  0x00007fff3c1f222a in tflite::Interpreter::Invoke() ()\r\n   from /usr/local/lib/python3.7/dist-packages/tensorflow_core/lite/python/interpreter_wrapper/_tensorflow_wrap_interpreter_wrapper.so\r\n#5  0x00007fff3c0bff58 in tflite::interpreter_wrapper::InterpreterWrapper::Invoke() ()\r\n   from /usr/local/lib/python3.7/dist-packages/tensorflow_core/lite/python/interpreter_wrapper/_tensorflow_wrap_interpreter_wrapper.so\r\n#6  0x00007fff3c0be054 in _wrap_InterpreterWrapper_Invoke ()\r\n   from /usr/local/lib/python3.7/dist-packages/tensorflow_core/lite/python/interpreter_wrapper/_tensorflow_wrap_interpreter_wrapper.so\r\n#7  0x00000000005b0462 in _PyMethodDef_RawFastCallKeywords () at ../Objects/call.c:694\r\n#8  0x00000000005cc860 in _PyCFunction_FastCallKeywords (kwnames=<optimized out>, nargs=<optimized out>, args=0x7fff6c1216c0, func=\r\n    <built-in method InterpreterWrapper_Invoke of module object at remote 0x7fff6c11ed18>) at ../Objects/call.c:730\r\n#9  call_function.lto_priv () at ../Python/ceval.c:4568\r\n#10 0x000000000051add9 in _PyEval_EvalFrameDefault () at ../Python/ceval.c:3093\r\n#11 0x00000000005b0eac in PyEval_EvalFrameEx (throwflag=0, f=\r\n    Frame 0x7fff6c121540, for file /usr/local/lib/python3.7/dist-packages/tensorflow_core/lite/python/interpreter_wrapper/tensorflow_wrap_interpreter_wrapper.py, line 109, in Invoke (self=<InterpreterWrapper(this=<SwigPyObject at remote 0x7fff74aca030>) at remote 0x7fff741f1c88>)) at ../Python/ceval.c:547\r\n#12 function_code_fastcall (globals=<optimized out>, nargs=<optimized out>, args=<optimized out>, co=<optimized out>) at ../Objects/call.c:283\r\n#13 _PyFunction_FastCallKeywords () at ../Objects/call.c:408\r\n#14 0x00000000005cc6ea in call_function.lto_priv () at ../Python/ceval.c:4616\r\n#15 0x000000000051add9 in _PyEval_EvalFrameDefault () at ../Python/ceval.c:3093\r\n#16 0x00000000005b0eac in PyEval_EvalFrameEx (throwflag=0, \r\n    f=Frame 0x7fff6c125048, for file /usr/local/lib/python3.7/dist-packages/tensorflow_core/lite/python/interpreter.py, line 453, in invoke (self=<Interpreter(_model_content=b' \\x00\\x00\\x00TFL3\\x00\\x00\\x00\\x00\\x00\\x00\\x12\\x00\\x1c\\x00\\x04\\x00\\x08\\x00\\x0c\\x00\\x10\\x00\\x14\\x00\\x00\\x00\\x18\\x00\\x12\\x00\\x00\\x00\\x03\\x00\\x00\\x00\\x00&\\x00\\x00\\xf0 \\x00\\x00\\xd8 \\x00\\x00<\\x00\\x00\\x00\\x04\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x0c\\x00\\x00\\x00\\x08\\x00\\x0c\\x00\\x04\\x00\\x08\\x00\\x08\\x00\\x00\\x00\\x08\\x00\\x00\\x00\\t\\x00\\x00\\x00\\x13\\x00\\x00\\x00min_runtime_version\\x00\\n\\x00\\x00\\x00\\x90 \\x00\\x00\\x80\\x00\\x00\\x00p\\x00\\x00\\x00d\\x00\\x00\\x00L\\x00\\x00\\x004\\x00\\x00\\x00,\\x00\\x00\\x00$\\x00\\x00\\x00\\x1c\\x00\\x00\\x00\\x04\\x00\\x00\\x00\\xaa\\xff\\xff\\xff\\x04\\x00\\x00\\x00\\x05\\x00\\x00\\x001.6.0\\x00\\x00\\x00\\xa4\\xda\\xff\\xff\\xa8\\xda\\xff\\xff\\xac\\xda\\xff\\xff\\xca\\xff\\xff\\xff\\x04\\x00\\x00\\x00\\x08\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xde\\xff\\xff\\xff\\x04\\x00\\x00\\x00\\x08\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\xd8\\xda\\xff\\xff\\x04\\x00\\x06\\x00\\x04\\x00\\x00\\x00\\x00\\x00\\x06\\x00\\x...(truncated)) at ../Python/ceval.c:547\r\n#17 function_code_fastcall (globals=<optimized out>, nargs=<optimized out>, args=<optimized out>, co=<optimized out>) at ../Objects/call.c:283\r\n#18 _PyFunction_FastCallKeywords () at ../Objects/call.c:408\r\n#19 0x0000000000516d6a in call_function (kwnames=0x0, oparg=<optimized out>, pp_stack=0x7fffffffd010) at ../Python/ceval.c:4616\r\n#20 _PyEval_EvalFrameDefault () at ../Python/ceval.c:3110\r\n#21 0x00000000005cd202 in PyEval_EvalFrameEx (throwflag=0, \r\n    f=Frame 0xf20238, for file bench.py, line 40, in measure (rep=1, tpu=False, bench_func=<Function(_lock=<_thread.lock at remote 0x7fffe26e7b98>, _python_function=<function at remote 0x7fffe05bf9d8>, _function_spec=<FunctionSpec(_fullargspec=<FullArgSpec at remote 0x7fff74b27c88>, _is_method=False, _default_values=None, _args_to_indices={'a': 0, 'b': 1}, arg_names=['a', 'b'], vararg_name=None, _arg_indices_to_default_values={}, _input_signature=(<TensorSpec at remote 0x7fff74ab6dc8>, <...>), _flat_input_signature=(<...>, <...>)) at remote 0x7ffff6614710>, _autograph=True, _experimental_autograph_options=None, experimental_relax_shapes=False, _created_variables=[], _stateful_fn=<Function(_python_function=<function at remote 0x7fff74ac2158>, _function_spec=<FunctionSpec(_fullargspec=<FullArgSpec at remote 0x7fff74b27cf8>, _is_method=False, _default_values=None, _args_to_indices={'a': 0, 'b': 1}, arg_names=['a', 'b'], vararg_name=None, _arg_indices_to_default_values={}, _input_signature=(...), _flat_input_signature=...(truncated)) at ../Python/ceval.c:547\r\n```\r\n</details>\r\n\r\n`tf.reduce_sum()` does not crash."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34439", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34439/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34439/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34439/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34439", "id": 525645144, "node_id": "MDU6SXNzdWU1MjU2NDUxNDQ=", "number": 34439, "title": "Build failure: undefined reference to protobuf symbols #34117 closed issue still occurring on r2.1", "user": {"login": "dbonner", "id": 241474, "node_id": "MDQ6VXNlcjI0MTQ3NA==", "avatar_url": "https://avatars3.githubusercontent.com/u/241474?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbonner", "html_url": "https://github.com/dbonner", "followers_url": "https://api.github.com/users/dbonner/followers", "following_url": "https://api.github.com/users/dbonner/following{/other_user}", "gists_url": "https://api.github.com/users/dbonner/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbonner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbonner/subscriptions", "organizations_url": "https://api.github.com/users/dbonner/orgs", "repos_url": "https://api.github.com/users/dbonner/repos", "events_url": "https://api.github.com/users/dbonner/events{/privacy}", "received_events_url": "https://api.github.com/users/dbonner/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, {"login": "goldiegadde", "id": 43185254, "node_id": "MDQ6VXNlcjQzMTg1MjU0", "avatar_url": "https://avatars2.githubusercontent.com/u/43185254?v=4", "gravatar_id": "", "url": "https://api.github.com/users/goldiegadde", "html_url": "https://github.com/goldiegadde", "followers_url": "https://api.github.com/users/goldiegadde/followers", "following_url": "https://api.github.com/users/goldiegadde/following{/other_user}", "gists_url": "https://api.github.com/users/goldiegadde/gists{/gist_id}", "starred_url": "https://api.github.com/users/goldiegadde/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/goldiegadde/subscriptions", "organizations_url": "https://api.github.com/users/goldiegadde/orgs", "repos_url": "https://api.github.com/users/goldiegadde/repos", "events_url": "https://api.github.com/users/goldiegadde/events{/privacy}", "received_events_url": "https://api.github.com/users/goldiegadde/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-11-20T08:18:25Z", "updated_at": "2019-12-12T16:57:52Z", "closed_at": null, "author_association": "NONE", "body": "Re: [https://github.com/tensorflow/tensorflow/issues/34117](url)\r\nThis issue is still occurring when I build r2.1 branch with bazel 1.1.0.\r\nIt has been fixed on head.  Would it be possible to implement the fix on build r2.1\r\nAlso the maximum bazel version needs to be increased to 1.1.0 in configure.py once the fix is implemented (in both head and r2.1)."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34436", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34436/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34436/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34436/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34436", "id": 525629337, "node_id": "MDU6SXNzdWU1MjU2MjkzMzc=", "number": 34436, "title": "Add GPU delegate support to the TFLite experimental c api", "user": {"login": "stephen-systemfriend", "id": 49134747, "node_id": "MDQ6VXNlcjQ5MTM0NzQ3", "avatar_url": "https://avatars3.githubusercontent.com/u/49134747?v=4", "gravatar_id": "", "url": "https://api.github.com/users/stephen-systemfriend", "html_url": "https://github.com/stephen-systemfriend", "followers_url": "https://api.github.com/users/stephen-systemfriend/followers", "following_url": "https://api.github.com/users/stephen-systemfriend/following{/other_user}", "gists_url": "https://api.github.com/users/stephen-systemfriend/gists{/gist_id}", "starred_url": "https://api.github.com/users/stephen-systemfriend/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/stephen-systemfriend/subscriptions", "organizations_url": "https://api.github.com/users/stephen-systemfriend/orgs", "repos_url": "https://api.github.com/users/stephen-systemfriend/repos", "events_url": "https://api.github.com/users/stephen-systemfriend/events{/privacy}", "received_events_url": "https://api.github.com/users/stephen-systemfriend/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "impjdi", "id": 9742927, "node_id": "MDQ6VXNlcjk3NDI5Mjc=", "avatar_url": "https://avatars2.githubusercontent.com/u/9742927?v=4", "gravatar_id": "", "url": "https://api.github.com/users/impjdi", "html_url": "https://github.com/impjdi", "followers_url": "https://api.github.com/users/impjdi/followers", "following_url": "https://api.github.com/users/impjdi/following{/other_user}", "gists_url": "https://api.github.com/users/impjdi/gists{/gist_id}", "starred_url": "https://api.github.com/users/impjdi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/impjdi/subscriptions", "organizations_url": "https://api.github.com/users/impjdi/orgs", "repos_url": "https://api.github.com/users/impjdi/repos", "events_url": "https://api.github.com/users/impjdi/events{/privacy}", "received_events_url": "https://api.github.com/users/impjdi/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-11-20T07:40:36Z", "updated_at": "2019-11-22T18:08:39Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): 2.0\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nthe lite experimental c api (used by the unity plugin) currently only supports running the network on the CPU.\r\nIt would be very useful to be able to use the GPU delegate for apps made directly in unity.\r\n\r\n\r\n**Will this change the current api? How?**\r\nIt extends the lite c api to be more in line with the c++ api. \r\n\r\n**Who will benefit with this feature?**\r\nAnyone who wants to use Tensorflow in unity on modern phones.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34432", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34432/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34432/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34432/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34432", "id": 525385944, "node_id": "MDU6SXNzdWU1MjUzODU5NDQ=", "number": 34432, "title": "Model mismatch between create_low_latency_conv_model and cnn-one-fstride4", "user": {"login": "csukuangfj", "id": 5284924, "node_id": "MDQ6VXNlcjUyODQ5MjQ=", "avatar_url": "https://avatars2.githubusercontent.com/u/5284924?v=4", "gravatar_id": "", "url": "https://api.github.com/users/csukuangfj", "html_url": "https://github.com/csukuangfj", "followers_url": "https://api.github.com/users/csukuangfj/followers", "following_url": "https://api.github.com/users/csukuangfj/following{/other_user}", "gists_url": "https://api.github.com/users/csukuangfj/gists{/gist_id}", "starred_url": "https://api.github.com/users/csukuangfj/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/csukuangfj/subscriptions", "organizations_url": "https://api.github.com/users/csukuangfj/orgs", "repos_url": "https://api.github.com/users/csukuangfj/repos", "events_url": "https://api.github.com/users/csukuangfj/events{/privacy}", "received_events_url": "https://api.github.com/users/csukuangfj/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-11-20T02:42:49Z", "updated_at": "2019-11-22T21:40:34Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "https://github.com/tensorflow/tensorflow/blob/ba63d9082a2265da91ec4daefecfa4cd47fcf07f/tensorflow/examples/speech_commands/models.py#L337-L339\r\n\r\nBut the stride is actually **one** instead of **four**:\r\n\r\nhttps://github.com/tensorflow/tensorflow/blob/ba63d9082a2265da91ec4daefecfa4cd47fcf07f/tensorflow/examples/speech_commands/models.py#L388-L389\r\n\r\nwhich results in a **huge** increase of the number of parameters of the subsequent FC layer."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34423", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34423/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34423/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34423/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34423", "id": 525193416, "node_id": "MDU6SXNzdWU1MjUxOTM0MTY=", "number": 34423, "title": "Issue in building TFLITE static library for linux environment ", "user": {"login": "SidGATOR", "id": 17770719, "node_id": "MDQ6VXNlcjE3NzcwNzE5", "avatar_url": "https://avatars2.githubusercontent.com/u/17770719?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SidGATOR", "html_url": "https://github.com/SidGATOR", "followers_url": "https://api.github.com/users/SidGATOR/followers", "following_url": "https://api.github.com/users/SidGATOR/following{/other_user}", "gists_url": "https://api.github.com/users/SidGATOR/gists{/gist_id}", "starred_url": "https://api.github.com/users/SidGATOR/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SidGATOR/subscriptions", "organizations_url": "https://api.github.com/users/SidGATOR/orgs", "repos_url": "https://api.github.com/users/SidGATOR/repos", "events_url": "https://api.github.com/users/SidGATOR/events{/privacy}", "received_events_url": "https://api.github.com/users/SidGATOR/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "aselle", "id": 326106, "node_id": "MDQ6VXNlcjMyNjEwNg==", "avatar_url": "https://avatars1.githubusercontent.com/u/326106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aselle", "html_url": "https://github.com/aselle", "followers_url": "https://api.github.com/users/aselle/followers", "following_url": "https://api.github.com/users/aselle/following{/other_user}", "gists_url": "https://api.github.com/users/aselle/gists{/gist_id}", "starred_url": "https://api.github.com/users/aselle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aselle/subscriptions", "organizations_url": "https://api.github.com/users/aselle/orgs", "repos_url": "https://api.github.com/users/aselle/repos", "events_url": "https://api.github.com/users/aselle/events{/privacy}", "received_events_url": "https://api.github.com/users/aselle/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-11-19T18:44:30Z", "updated_at": "2019-12-10T01:13:42Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution \r\nLinux Ubuntu 16.04\r\n- TensorFlow installed from (source or binary): v1.15.0-rc-2\r\n- Python version: 3.6\r\n- Installed using virtualenv? pip? conda?: From source\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source): gcc5.5\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: N/A\r\n\r\n\r\n\r\n**Describe the problem**\r\nCannot compile static library for TFLITE inference engine using the provided Makefile. When run, generated_scheme.h will not be link with flatbuffers/flatbuffers.h and will flag variable not declared in this scope for everything \r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\ngit clone https://github.com/tensorflow/tensorflow.git\r\ngit checkout tags/v1.15.0-rc-2\r\ncd tensorflow\r\n./tensorflow/lite/tools/make/download_dependencies.sh \r\n ./tensorflow/lite/tools/make/build_lib.sh\r\n\r\n**Any other info / logs**\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34421", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34421/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34421/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34421/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/34421", "id": 525160745, "node_id": "MDExOlB1bGxSZXF1ZXN0MzQyODA0NTQ5", "number": 34421, "title": "Expanded the description of tf.gfile.", "user": {"login": "dynamicwebpaige", "id": 3712347, "node_id": "MDQ6VXNlcjM3MTIzNDc=", "avatar_url": "https://avatars2.githubusercontent.com/u/3712347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dynamicwebpaige", "html_url": "https://github.com/dynamicwebpaige", "followers_url": "https://api.github.com/users/dynamicwebpaige/followers", "following_url": "https://api.github.com/users/dynamicwebpaige/following{/other_user}", "gists_url": "https://api.github.com/users/dynamicwebpaige/gists{/gist_id}", "starred_url": "https://api.github.com/users/dynamicwebpaige/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dynamicwebpaige/subscriptions", "organizations_url": "https://api.github.com/users/dynamicwebpaige/orgs", "repos_url": "https://api.github.com/users/dynamicwebpaige/repos", "events_url": "https://api.github.com/users/dynamicwebpaige/events{/privacy}", "received_events_url": "https://api.github.com/users/dynamicwebpaige/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 987666414, "node_id": "MDU6TGFiZWw5ODc2NjY0MTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/ready%20to%20pull", "name": "ready to pull", "color": "2cd643", "default": false, "description": ""}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}], "state": "open", "locked": false, "assignee": {"login": "dynamicwebpaige", "id": 3712347, "node_id": "MDQ6VXNlcjM3MTIzNDc=", "avatar_url": "https://avatars2.githubusercontent.com/u/3712347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dynamicwebpaige", "html_url": "https://github.com/dynamicwebpaige", "followers_url": "https://api.github.com/users/dynamicwebpaige/followers", "following_url": "https://api.github.com/users/dynamicwebpaige/following{/other_user}", "gists_url": "https://api.github.com/users/dynamicwebpaige/gists{/gist_id}", "starred_url": "https://api.github.com/users/dynamicwebpaige/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dynamicwebpaige/subscriptions", "organizations_url": "https://api.github.com/users/dynamicwebpaige/orgs", "repos_url": "https://api.github.com/users/dynamicwebpaige/repos", "events_url": "https://api.github.com/users/dynamicwebpaige/events{/privacy}", "received_events_url": "https://api.github.com/users/dynamicwebpaige/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "dynamicwebpaige", "id": 3712347, "node_id": "MDQ6VXNlcjM3MTIzNDc=", "avatar_url": "https://avatars2.githubusercontent.com/u/3712347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dynamicwebpaige", "html_url": "https://github.com/dynamicwebpaige", "followers_url": "https://api.github.com/users/dynamicwebpaige/followers", "following_url": "https://api.github.com/users/dynamicwebpaige/following{/other_user}", "gists_url": "https://api.github.com/users/dynamicwebpaige/gists{/gist_id}", "starred_url": "https://api.github.com/users/dynamicwebpaige/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dynamicwebpaige/subscriptions", "organizations_url": "https://api.github.com/users/dynamicwebpaige/orgs", "repos_url": "https://api.github.com/users/dynamicwebpaige/repos", "events_url": "https://api.github.com/users/dynamicwebpaige/events{/privacy}", "received_events_url": "https://api.github.com/users/dynamicwebpaige/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-11-19T17:39:30Z", "updated_at": "2019-11-19T19:45:24Z", "closed_at": null, "author_association": "MEMBER", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/34421", "html_url": "https://github.com/tensorflow/tensorflow/pull/34421", "diff_url": "https://github.com/tensorflow/tensorflow/pull/34421.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/34421.patch"}, "body": ""}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34417", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34417/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34417/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34417/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34417", "id": 525081712, "node_id": "MDU6SXNzdWU1MjUwODE3MTI=", "number": 34417, "title": "Have the count mode passed to the callbacks", "user": {"login": "zaccharieramzi", "id": 6387497, "node_id": "MDQ6VXNlcjYzODc0OTc=", "avatar_url": "https://avatars1.githubusercontent.com/u/6387497?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zaccharieramzi", "html_url": "https://github.com/zaccharieramzi", "followers_url": "https://api.github.com/users/zaccharieramzi/followers", "following_url": "https://api.github.com/users/zaccharieramzi/following{/other_user}", "gists_url": "https://api.github.com/users/zaccharieramzi/gists{/gist_id}", "starred_url": "https://api.github.com/users/zaccharieramzi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zaccharieramzi/subscriptions", "organizations_url": "https://api.github.com/users/zaccharieramzi/orgs", "repos_url": "https://api.github.com/users/zaccharieramzi/repos", "events_url": "https://api.github.com/users/zaccharieramzi/events{/privacy}", "received_events_url": "https://api.github.com/users/zaccharieramzi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "shun-lin", "id": 16867893, "node_id": "MDQ6VXNlcjE2ODY3ODkz", "avatar_url": "https://avatars0.githubusercontent.com/u/16867893?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shun-lin", "html_url": "https://github.com/shun-lin", "followers_url": "https://api.github.com/users/shun-lin/followers", "following_url": "https://api.github.com/users/shun-lin/following{/other_user}", "gists_url": "https://api.github.com/users/shun-lin/gists{/gist_id}", "starred_url": "https://api.github.com/users/shun-lin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shun-lin/subscriptions", "organizations_url": "https://api.github.com/users/shun-lin/orgs", "repos_url": "https://api.github.com/users/shun-lin/repos", "events_url": "https://api.github.com/users/shun-lin/events{/privacy}", "received_events_url": "https://api.github.com/users/shun-lin/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "shun-lin", "id": 16867893, "node_id": "MDQ6VXNlcjE2ODY3ODkz", "avatar_url": "https://avatars0.githubusercontent.com/u/16867893?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shun-lin", "html_url": "https://github.com/shun-lin", "followers_url": "https://api.github.com/users/shun-lin/followers", "following_url": "https://api.github.com/users/shun-lin/following{/other_user}", "gists_url": "https://api.github.com/users/shun-lin/gists{/gist_id}", "starred_url": "https://api.github.com/users/shun-lin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shun-lin/subscriptions", "organizations_url": "https://api.github.com/users/shun-lin/orgs", "repos_url": "https://api.github.com/users/shun-lin/repos", "events_url": "https://api.github.com/users/shun-lin/events{/privacy}", "received_events_url": "https://api.github.com/users/shun-lin/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-11-19T15:27:51Z", "updated_at": "2019-11-20T18:34:34Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- TensorFlow version: 2.0.0\r\n- Are you willing to contribute it: Yes\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nRight now when training on a generator (I don't know about the other cases), when the callbacks are configured, the number of samples passed in might actually be the number of steps (i.e. divided by batch size). To cope with that for the progress bar, a `count_mode` variable is used to know how to update it.\r\n\r\nI would like the `count_mode` variable to also be passed to the callbacks in order for them to also adapt their behaviour based on it.\r\n\r\n**Will this change the current api? How?**\r\nNo\r\n\r\n**Who will benefit with this feature?**\r\nThe [`keras-tqdm`](https://github.com/bstriner/keras-tqdm) library is currently [not working properly because of that lack](https://github.com/bstriner/keras-tqdm/issues/37). It could implement a new way to deal with the count, once this variable is provided in the callbacks parameters.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34416", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34416/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34416/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34416/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34416", "id": 524986825, "node_id": "MDU6SXNzdWU1MjQ5ODY4MjU=", "number": 34416, "title": "Error trying to convert a model using full integer quantization", "user": {"login": "mapeima", "id": 45185024, "node_id": "MDQ6VXNlcjQ1MTg1MDI0", "avatar_url": "https://avatars0.githubusercontent.com/u/45185024?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mapeima", "html_url": "https://github.com/mapeima", "followers_url": "https://api.github.com/users/mapeima/followers", "following_url": "https://api.github.com/users/mapeima/following{/other_user}", "gists_url": "https://api.github.com/users/mapeima/gists{/gist_id}", "starred_url": "https://api.github.com/users/mapeima/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mapeima/subscriptions", "organizations_url": "https://api.github.com/users/mapeima/orgs", "repos_url": "https://api.github.com/users/mapeima/repos", "events_url": "https://api.github.com/users/mapeima/events{/privacy}", "received_events_url": "https://api.github.com/users/mapeima/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "xhae", "id": 4215736, "node_id": "MDQ6VXNlcjQyMTU3MzY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4215736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xhae", "html_url": "https://github.com/xhae", "followers_url": "https://api.github.com/users/xhae/followers", "following_url": "https://api.github.com/users/xhae/following{/other_user}", "gists_url": "https://api.github.com/users/xhae/gists{/gist_id}", "starred_url": "https://api.github.com/users/xhae/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xhae/subscriptions", "organizations_url": "https://api.github.com/users/xhae/orgs", "repos_url": "https://api.github.com/users/xhae/repos", "events_url": "https://api.github.com/users/xhae/events{/privacy}", "received_events_url": "https://api.github.com/users/xhae/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "xhae", "id": 4215736, "node_id": "MDQ6VXNlcjQyMTU3MzY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4215736?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xhae", "html_url": "https://github.com/xhae", "followers_url": "https://api.github.com/users/xhae/followers", "following_url": "https://api.github.com/users/xhae/following{/other_user}", "gists_url": "https://api.github.com/users/xhae/gists{/gist_id}", "starred_url": "https://api.github.com/users/xhae/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xhae/subscriptions", "organizations_url": "https://api.github.com/users/xhae/orgs", "repos_url": "https://api.github.com/users/xhae/repos", "events_url": "https://api.github.com/users/xhae/events{/privacy}", "received_events_url": "https://api.github.com/users/xhae/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-11-19T12:44:50Z", "updated_at": "2020-02-14T14:36:47Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution: Linux Ubuntu 18.04.3:\r\n- TensorFlow installed from source: pip3 install --upgrade tensorflow==1.15\r\n- TensorFlow version: 1.15\r\n\r\n\r\n**Provide the text output from tflite_convert**\r\n\r\n```\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime. If those are native TensorFlow operators, you might be able to use the extended runtime by passing --enable_select_tf_ops, or by setting target_ops=TFLITE_BUILTINS,SELECT_TF_OPS when calling tf.lite.TFLiteConverter(). Otherwise, if you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: FULLY_CONNECTED, SOFTMAX. Here is a list of operators for which you will need custom implementations: IdentityN.\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/toco_from_protos\", line 8, in <module>\r\n    sys.exit(main())\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 89, in main\r\n    app.run(main=execute, argv=[sys.argv[0]] + unparsed)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/usr/local/lib/python3.6/dist-packages/absl/app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"/usr/local/lib/python3.6/dist-packages/absl/app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 52, in execute\r\n    enable_mlir_converter)\r\nException: We are continually in the process of adding support to TensorFlow Lite for more ops. It would be helpful if you could inform us of how this conversion went by opening a github issue at https://github.com/tensorflow/tensorflow/issues/new?template=40-tflite-op-request.md\r\n and pasting the following:\r\n\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime. If those are native TensorFlow operators, you might be able to use the extended runtime by passing --enable_select_tf_ops, or by setting target_ops=TFLITE_BUILTINS,SELECT_TF_OPS when calling tf.lite.TFLiteConverter(). Otherwise, if you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: FULLY_CONNECTED, SOFTMAX. Here is a list of operators for which you will need custom implementations: IdentityN.\r\n```\r\n\r\n**Model:**\r\n```\r\nimport pathlib\r\n\r\nimport tensorflow as tf\r\n\r\n\r\nmnist = tf.keras.datasets.mnist\r\n\r\n(x_train, y_train), (x_test, y_test) = mnist.load_data()\r\nx_train, x_test = x_train / 255.0, x_test / 255.0\r\n\r\nmodel = tf.keras.models.Sequential([\r\n  tf.keras.layers.Flatten(input_shape=(28, 28)),\r\n  tf.keras.layers.Dense(128, activation='relu'),\r\n  # tf.keras.layers.Dropout(0.2),\r\n  tf.keras.layers.Dense(10, activation='softmax')\r\n])\r\n\r\nmodel.compile(optimizer='adam',\r\n              loss='sparse_categorical_crossentropy',\r\n              metrics=['accuracy'])\r\n\r\nmodel.fit(x_train, y_train, epochs=5)\r\n\r\nmodel.evaluate(x_test,  y_test, verbose=2)\r\n\r\n\r\n# Save the model into SaveModel format\r\n\r\nsaved_model_dir = pathlib.Path(\"./saved_model/\")\r\ntf.saved_model.save(model, str(saved_model_dir))\r\n```\r\n\r\n**Convert the model:**\r\n```\r\nimport pathlib\r\n\r\nimport tensorflow as tf\r\n\r\n\r\nmnist = tf.keras.datasets.mnist\r\nx_train = mnist.load_data()[0][0] / 255.0\r\n\r\nsaved_model_dir = pathlib.Path(\"./saved_model/\")\r\n\r\n\r\n# Convert the model from saved model\r\n\r\nimages = tf.cast(x_train, tf.float32)\r\nmnist_ds = tf.data.Dataset.from_tensor_slices(images).batch(1)\r\n\r\n\r\ndef representative_dataset_gen():\r\n    for input_value in mnist_ds.take(100):\r\n        yield [input_value]\r\n\r\n\r\nconverter = tf.lite.TFLiteConverter.from_saved_model(str(saved_model_dir))\r\nconverter.optimizations = [tf.lite.Optimize.DEFAULT]\r\nconverter.target_spec.supported_ops = [tf.lite.OpsSet.TFLITE_BUILTINS_INT8]\r\nconverter.inference_input_type = tf.uint8\r\nconverter.inference_output_type = tf.uint8\r\nconverter.representative_dataset = representative_dataset_gen\r\n\r\ntflite_quant_model = converter.convert()\r\n\r\ntflite_quant_model_file = saved_model_dir/\"mnist_post_quant_model_io.tflite\"\r\ntflite_quant_model_file.write_bytes(tflite_quant_model)\r\n```\r\n\r\n**Any other info / logs**\r\n\r\n```\r\n/usr/bin/python3.6 /home/mapeima/Code/python/edgeTPU/model_converter.py\r\n2019-11-19 13:34:02.791346: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\r\n2019-11-19 13:34:02.791364: E tensorflow/stream_executor/cuda/cuda_driver.cc:318] failed call to cuInit: UNKNOWN ERROR (303)\r\n2019-11-19 13:34:02.791397: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (jihr): /proc/driver/nvidia/version does not exist\r\n2019-11-19 13:34:02.791614: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2019-11-19 13:34:02.814669: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2712000000 Hz\r\n2019-11-19 13:34:02.815094: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x3b64140 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n2019-11-19 13:34:02.815124: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\nWARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow_core/lite/python/convert_saved_model.py:60: load (from tensorflow.python.saved_model.loader_impl) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nThis function will only be available through the v1 compatibility library as tf.compat.v1.saved_model.loader.load or tf.compat.v1.saved_model.load. There will be a new function for importing SavedModels in Tensorflow 2.0.\r\n2019-11-19 13:34:02.937627: I tensorflow/core/grappler/devices.cc:55] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0\r\n2019-11-19 13:34:02.937702: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2019-11-19 13:34:02.948371: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:786] Optimization results for grappler item: graph_to_optimize\r\n2019-11-19 13:34:02.948393: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:788]   function_optimizer: Graph size after: 189 nodes (144), 355 edges (290), time = 4.452ms.\r\n2019-11-19 13:34:02.948398: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:788]   function_optimizer: function_optimizer did nothing. time = 0.08ms.\r\nWARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow_core/lite/python/util.py:249: convert_variables_to_constants (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse `tf.compat.v1.graph_util.convert_variables_to_constants`\r\nWARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/graph_util_impl.py:277: extract_sub_graph (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.\r\nInstructions for updating:\r\nUse `tf.compat.v1.graph_util.extract_sub_graph`\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/lite/python/lite.py:854: UserWarning: Property target_ops is deprecated, please use target_spec.supported_ops instead.\r\n  \"target_spec.supported_ops instead.\" % name)\r\n2019-11-19 13:34:02.971121: I tensorflow/core/grappler/devices.cc:55] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0\r\n2019-11-19 13:34:02.971187: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2019-11-19 13:34:02.977074: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:786] Optimization results for grappler item: graph_to_optimize\r\n2019-11-19 13:34:02.977098: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:788]   constant_folding: Graph size after: 34 nodes (-8), 57 edges (-12), time = 3.248ms.\r\n2019-11-19 13:34:02.977102: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:788]   constant_folding: Graph size after: 34 nodes (0), 57 edges (0), time = 0.73ms.\r\nUse '@tf.function' or '@defun' to decorate the function.Use '@tf.function' or '@defun' to decorate the function.Use '@tf.function' or '@defun' to decorate the function.Use '@tf.function' or '@defun' to decorate the function.Use '@tf.function' or '@defun' to decorate the function.Use '@tf.function' or '@defun' to decorate the function.Use '@tf.function' or '@defun' to decorate the function.Use '@tf.function' or '@defun' to decorate the function.Use '@tf.function' or '@defun' to decorate the function.Use '@tf.function' or '@defun' to decorate the function.Use '@tf.function' or '@defun' to decorate the function.Use '@tf.function' or '@defun' to decorate the function.Use '@tf.function' or '@defun' to decorate the function.Use '@tf.function' or '@defun' to decorate the function.Use '@tf.function' or '@defun' to decorate the function.Use '@tf.function' or '@defun' to decorate the function.Traceback (most recent call last):\r\n  File \"/home/mapeima/Code/python/edgeTPU/model_converter.py\", line 30, in <module>\r\n    tflite_quant_model = converter.convert()\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/lite/python/lite.py\", line 983, in convert\r\n    **converter_kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/lite/python/convert.py\", line 449, in toco_convert_impl\r\n    enable_mlir_converter=enable_mlir_converter)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/lite/python/convert.py\", line 200, in toco_convert_protos\r\n    raise ConverterError(\"See console for info.\\n%s\\n%s\\n\" % (stdout, stderr))\r\ntensorflow.lite.python.convert.ConverterError: See console for info.\r\n2019-11-19 13:34:04.120420: I tensorflow/lite/toco/import_tensorflow.cc:659] Converting unsupported operation: IdentityN\r\n2019-11-19 13:34:04.120589: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 17 operators, 26 arrays (0 quantized)\r\n2019-11-19 13:34:04.120707: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 17 operators, 26 arrays (0 quantized)\r\n2019-11-19 13:34:04.120849: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 1: 6 operators, 12 arrays (0 quantized)\r\n2019-11-19 13:34:04.121155: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 2: 5 operators, 11 arrays (0 quantized)\r\n2019-11-19 13:34:04.121196: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 3: 4 operators, 9 arrays (0 quantized)\r\n2019-11-19 13:34:04.121224: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before Group bidirectional sequence lstm/rnn: 4 operators, 9 arrays (0 quantized)\r\n2019-11-19 13:34:04.121241: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before dequantization graph transformations: 4 operators, 9 arrays (0 quantized)\r\n2019-11-19 13:34:04.121273: I tensorflow/lite/toco/allocate_transient_arrays.cc:345] Total transient array allocated size: 576 bytes, theoretical optimal value: 576 bytes.\r\n2019-11-19 13:34:04.121289: I tensorflow/lite/toco/toco_tooling.cc:439] Estimated count of arithmetic ops: 204042 ops, equivalently 102021 MACs\r\n2019-11-19 13:34:04.121293: I tensorflow/lite/toco/toco_tooling.cc:454] Number of parameters: 101770\r\n2019-11-19 13:34:04.121470: E tensorflow/lite/toco/toco_tooling.cc:481] We are continually in the process of adding support to TensorFlow Lite for more ops. It would be helpful if you could inform us of how this conversion went by opening a github issue at https://github.com/tensorflow/tensorflow/issues/new?template=40-tflite-op-request.md\r\n and pasting the following:\r\n\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime. If those are native TensorFlow operators, you might be able to use the extended runtime by passing --enable_select_tf_ops, or by setting target_ops=TFLITE_BUILTINS,SELECT_TF_OPS when calling tf.lite.TFLiteConverter(). Otherwise, if you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: FULLY_CONNECTED, SOFTMAX. Here is a list of operators for which you will need custom implementations: IdentityN.\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/toco_from_protos\", line 8, in <module>\r\n    sys.exit(main())\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 89, in main\r\n    app.run(main=execute, argv=[sys.argv[0]] + unparsed)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/usr/local/lib/python3.6/dist-packages/absl/app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"/usr/local/lib/python3.6/dist-packages/absl/app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 52, in execute\r\n    enable_mlir_converter)\r\nException: We are continually in the process of adding support to TensorFlow Lite for more ops. It would be helpful if you could inform us of how this conversion went by opening a github issue at https://github.com/tensorflow/tensorflow/issues/new?template=40-tflite-op-request.md\r\n and pasting the following:\r\n\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime. If those are native TensorFlow operators, you might be able to use the extended runtime by passing --enable_select_tf_ops, or by setting target_ops=TFLITE_BUILTINS,SELECT_TF_OPS when calling tf.lite.TFLiteConverter(). Otherwise, if you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: FULLY_CONNECTED, SOFTMAX. Here is a list of operators for which you will need custom implementations: IdentityN.\r\n\r\n\r\n\r\n\r\nProcess finished with exit code 1\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34415", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34415/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34415/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34415/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34415", "id": 524975455, "node_id": "MDU6SXNzdWU1MjQ5NzU0NTU=", "number": 34415, "title": "How to limit the cpu core number in Tensorflow 2.0", "user": {"login": "fancyerii", "id": 5372812, "node_id": "MDQ6VXNlcjUzNzI4MTI=", "avatar_url": "https://avatars0.githubusercontent.com/u/5372812?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fancyerii", "html_url": "https://github.com/fancyerii", "followers_url": "https://api.github.com/users/fancyerii/followers", "following_url": "https://api.github.com/users/fancyerii/following{/other_user}", "gists_url": "https://api.github.com/users/fancyerii/gists{/gist_id}", "starred_url": "https://api.github.com/users/fancyerii/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fancyerii/subscriptions", "organizations_url": "https://api.github.com/users/fancyerii/orgs", "repos_url": "https://api.github.com/users/fancyerii/repos", "events_url": "https://api.github.com/users/fancyerii/events{/privacy}", "received_events_url": "https://api.github.com/users/fancyerii/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-11-19T12:21:25Z", "updated_at": "2020-01-18T00:28:35Z", "closed_at": null, "author_association": "NONE", "body": "I am using tf.keras to train a model with cpu and I want to limit the cpu usage of this program. I found this article(https://www.kaggle.com/c/porto-seguro-safe-driver-prediction/discussion/43383):\r\n\r\n```\r\nfrom keras import backend as K\r\nimport tensorflow as tf\r\n\r\nconfig = tf.ConfigProto(intra_op_parallelism_threads=args.jobs, \\ \r\n                        inter_op_parallelism_threads=args.jobs, \\\r\n                        allow_soft_placement=True, \\\r\n                        device_count = {'CPU': args.jobs})\r\nsession = tf.Session(config=config)\r\nK.set_session(session)\r\n```\r\n\r\nBut in Tensorflow 2.0, ConfigProto is deprecated and Session is gone. What's the correct method to limit cpu usage?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34409", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34409/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34409/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34409/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34409", "id": 524848255, "node_id": "MDU6SXNzdWU1MjQ4NDgyNTU=", "number": 34409, "title": "C++ compilation of rule '//tensorflow/cc:cc_op_gen_main' failed (Ex it 1)", "user": {"login": "hectorqin", "id": 14220132, "node_id": "MDQ6VXNlcjE0MjIwMTMy", "avatar_url": "https://avatars0.githubusercontent.com/u/14220132?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hectorqin", "html_url": "https://github.com/hectorqin", "followers_url": "https://api.github.com/users/hectorqin/followers", "following_url": "https://api.github.com/users/hectorqin/following{/other_user}", "gists_url": "https://api.github.com/users/hectorqin/gists{/gist_id}", "starred_url": "https://api.github.com/users/hectorqin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hectorqin/subscriptions", "organizations_url": "https://api.github.com/users/hectorqin/orgs", "repos_url": "https://api.github.com/users/hectorqin/repos", "events_url": "https://api.github.com/users/hectorqin/events{/privacy}", "received_events_url": "https://api.github.com/users/hectorqin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1205657510, "node_id": "MDU6TGFiZWwxMjA1NjU3NTEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:centos", "name": "subtype:centos", "color": "b619ea", "default": false, "description": "Centos Build/Installation issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-11-19T08:23:37Z", "updated_at": "2019-11-20T07:56:50Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\n  CentOS 6.10\r\n- TensorFlow installed from (source or binary):\r\n  source\r\n- TensorFlow version:\r\n  Branch r2.0\r\n- Python version:\r\n 3.7.5\r\n- Bazel version (if compiling from source):\r\n  0.26.1\r\n- GCC/Compiler version (if compiling from source):\r\n gcc version 4.9.1 20140922 (Red Hat 4.9.1-10) (GCC)\r\n- CUDA/cuDNN version:\r\n  CUDA 10.1  cuDNN 7.6.5\r\n- GPU model and memory:\r\n  Tesla P4 8G\r\n\r\n**Describe the problem**\r\n  While building TensorFlow from r2.0 branch the build fails.\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n  ``` bash\r\n  bazel build --config=opt --config=cuda --config=nonccl --verbose_failures //tensorflow/tools/pip_package:build_pip_package\r\n ```\r\n\r\n**Any other info / logs**\r\n\r\n**configure output**\r\n```\r\nWARNING: Running Bazel server needs to be killed, because the startup options are different.\r\nWARNING: --batch mode is deprecated. Please instead explicitly shut down your Bazel server using the command \"bazel shutdown\".\r\nYou have bazel 0.26.1 installed.\r\nPlease specify the location of python. [Default is /usr/local/bin/python3]: \r\n\r\n\r\nFound possible Python library paths:\r\n  /usr/local/python3/lib/python3.7/site-packages\r\nPlease input the desired Python library path to use.  Default is [/usr/local/python3/lib/python3.7/site-packages]\r\n\r\nDo you wish to build TensorFlow with XLA JIT support? [Y/n]: Y\r\nXLA JIT support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with OpenCL SYCL support? [y/N]: N\r\nNo OpenCL SYCL support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with ROCm support? [y/N]: N\r\nNo ROCm support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with CUDA support? [y/N]: Y\r\nCUDA support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with TensorRT support? [y/N]: N\r\nNo TensorRT support will be enabled for TensorFlow.\r\n\r\nFound CUDA 10.1 in:\r\n    /usr/local/cuda/lib64\r\n    /usr/local/cuda/include\r\nFound cuDNN 7 in:\r\n    /usr/local/cuda/lib64\r\n    /usr/local/cuda/include\r\n\r\n\r\nPlease specify a list of comma-separated CUDA compute capabilities you want to build with.\r\nYou can find the compute capability of your device at: https://developer.nvidia.com/cuda-gpus.\r\nPlease note that each additional compute capability significantly increases your build time and binary size, and that TensorFlow only supports compute capabilities >= 3.5 [Default is: 6.1]: \r\n\r\n\r\nDo you want to use clang as CUDA compiler? [y/N]: N\r\nnvcc will be used as CUDA compiler.\r\n\r\nPlease specify which gcc should be used by nvcc as the host compiler. [Default is /opt/rh/devtoolset-3/root/usr/bin/gcc]: \r\n\r\n\r\nDo you wish to build TensorFlow with MPI support? [y/N]: N\r\nNo MPI support will be enabled for TensorFlow.\r\n\r\nPlease specify optimization flags to use during compilation when bazel option \"--config=opt\" is specified [Default is -march=native -Wno-sign-compare]: \r\n\r\n\r\nWould you like to interactively configure ./WORKSPACE for Android builds? [y/N]: N\r\nNot configuring the WORKSPACE for Android builds.\r\n\r\nPreconfigured Bazel build configs. You can use any of the below by adding \"--config=<>\" to your build command. See .bazelrc for more details.\r\n        --config=mkl            # Build with MKL support.\r\n        --config=monolithic     # Config for mostly static monolithic build.\r\n        --config=gdr            # Build with GDR support.\r\n        --config=verbs          # Build with libverbs support.\r\n        --config=ngraph         # Build with Intel nGraph support.\r\n        --config=numa           # Build with NUMA support.\r\n        --config=dynamic_kernels        # (Experimental) Build kernels into separate shared objects.\r\n        --config=v2             # Build TensorFlow 2.x instead of 1.x.\r\nPreconfigured Bazel build configs to DISABLE default on features:\r\n        --config=noaws          # Disable AWS S3 filesystem support.\r\n        --config=nogcp          # Disable GCP support.\r\n        --config=nohdfs         # Disable HDFS support.\r\n        --config=noignite       # Disable Apache Ignite support.\r\n        --config=nokafka        # Disable Apache Kafka support.\r\n        --config=nonccl         # Disable NVIDIA NCCL support.\r\n```\r\n\r\n**build output**\r\n```\r\nERROR: /root/tensorflow/tensorflow/cc/BUILD:636:1: C++ compilation of rule '//tensorflow/cc:cc_op_gen_main' failed (Ex\r\nit 1): crosstool_wrapper_driver_is_not_gcc failed: error executing command \r\n  (cd /root/.cache/bazel/_bazel_root/efb88f6336d9c4a18216fb94287b8d97/execroot/org_tensorflow && \\\r\n  exec env - \\\r\n    LD_LIBRARY_PATH=/opt/rh/devtoolset-3/root/usr/lib64:/opt/rh/devtoolset-3/root/usr/lib:/usr/local/cuda-10.1/lib64 \\\r\n    PATH=/usr/local/python3/bin/:/usr/local/git/bin:/opt/rh/devtoolset-3/root/usr/bin:/usr/lib/jvm/jdk1.8.0_212/bin:/u\r\nsr/local/bin:/usr/local/cuda-10.1/bin:/usr/local/cuda-10.1/NsightCompute-2019.1:/usr/local/openresty/nginx/sbin:/usr/l\r\nocal/php/bin:/usr/local/openssl/bin:/usr/lib64/qt-3.3/bin:/usr/local/sbin:/usr/bin:/bin:/usr/sbin:/sbin:/root/bin \\\r\n    PWD=/proc/self/cwd \\\r\n  external/local_config_cuda/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -MD -MF bazel-out/host/bin/tensorflow/cc/_objs/cc_op_gen_main/cc_op_gen_main.d '-frandom-seed=bazel-out/host/bin/tensorflow/cc/_objs/cc_op_gen_main/cc_op_gen_main.o' -D__CLANG_SUPPORT_DYN_ANNOTATION__ -DEIGEN_MPL2_ONLY '-DEIGEN_MAX_ALIGN_BYTES=64' '-DEIGEN_HAS_TYPE_TRAITS=0' -DTF_USE_SNAPPY -iquote . -iquote bazel-out/host/bin -iquote external/com_google_absl -iquote bazel-out/host/bin/external/com_google_absl -iquote external/nsync -iquote bazel-out/host/bin/external/nsync -iquote external/eigen_archive -iquote bazel-out/host/bin/external/eigen_archive -iquote external/local_config_sycl -iquote bazel-out/host/bin/external/local_config_sycl -iquote external/gif_archive -iquote bazel-out/host/bin/external/gif_archive -iquote external/jpeg -iquote bazel-out/host/bin/external/jpeg -iquote external/com_google_protobuf -iquote bazel-out/host/bin/external/com_google_protobuf -iquote external/com_googlesource_code_re2 -iquote bazel-out/host/bin/external/com_googlesource_code_re2 -iquote external/farmhash_archive -iquote bazel-out/host/bin/external/farmhash_archive -iquote external/fft2d -iquote bazel-out/host/bin/external/fft2d -iquote external/highwayhash -iquote bazel-out/host/bin/external/highwayhash -iquote external/zlib_archive -iquote bazel-out/host/bin/external/zlib_archive -iquote external/local_config_cuda -iquote bazel-out/host/bin/external/local_config_cuda -iquote external/local_config_tensorrt -iquote bazel-out/host/bin/external/local_config_tensorrt -Ibazel-out/host/bin/external/local_config_cuda/cuda/_virtual_includes/cuda_headers_virtual -Ibazel-out/host/bin/external/local_config_tensorrt/_virtual_includes/tensorrt_headers -isystem external/nsync/public -isystem bazel-out/host/bin/external/nsync/public -isystem external/eigen_archive -isystem bazel-out/host/bin/external/eigen_archive -isystem external/gif_archive -isystem bazel-out/host/bin/external/gif_archive -isystem external/com_google_protobuf/src -isystem bazel-out/host/bin/external/com_google_protobuf/src -isystem external/farmhash_archive/src -isystem bazel-out/host/bin/external/farmhash_archive/src -isystem external/zlib_archive -isystem bazel-out/host/bin/external/zlib_archive -isystem external/local_config_cuda/cuda -isystem bazel-out/host/bin/external/local_config_cuda/cuda -isystem external/local_config_cuda/cuda/cuda/include -isystem bazel-out/host/bin/external/local_config_cuda/cuda/cuda/include '-std=c++11' -Wno-builtin-macro-redefined '-D__DATE__=\"redacted\"' '-D__TIMESTAMP__=\"redacted\"' '-D__TIME__=\"redacted\"' -fPIE -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -Wall -fno-omit-frame-pointer -no-canonical-prefixes -fno-canonical-system-headers -DNDEBUG -g0 -O2 -ffunction-sections -fdata-sections -g0 '-march=native' -g0 -DEIGEN_AVOID_STL_ARRAY -Iexternal/gemmlowp -Wno-sign-compare -fno-exceptions '-ftemplate-depth=900' '-DGOOGLE_CUDA=1' -msse3 -pthread -c tensorflow/cc/framework/cc_op_gen_main.cc -o bazel-out/host/bin/tensorflow/cc/_objs/cc_op_gen_main/cc_op_gen_main.o)\r\nExecution platform: @bazel_tools//platforms:host_platform\r\nIn file included from tensorflow/cc/framework/cc_op_gen_main.cc:21:0:\r\n./tensorflow/core/lib/io/path.h: In instantiation of 'std::string tensorflow::io::JoinPath(const T& ...) [with T = {st\r\nd::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::basic_string<char, std::char_traits<char>, \r\nstd::allocator<char> >}; std::string = std::basic_string<char>]':\r\ntensorflow/cc/framework/cc_op_gen_main.cc:42:72:   required from here\r\n./tensorflow/core/lib/io/path.h:47:42: error: could not convert '{args#0, args#1}' from '<brace-enclosed initializer l\r\nist>' to 'std::initializer_list<absl::string_view>'\r\n   return internal::JoinPathImpl({args...});\r\n                                          ^\r\n./tensorflow/core/lib/io/path.h: In function 'std::string tensorflow::io::JoinPath(const T& ...) [with T = {std::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::basic_string<char, std::char_traits<char>, std::allocator<char> >}; std::string = std::basic_string<char>]':\r\n./tensorflow/core/lib/io/path.h:48:1: warning: control reaches end of non-void function [-Wreturn-type]\r\n }\r\n ^\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nINFO: Elapsed time: 27.597s, Critical Path: 19.68s\r\nINFO: 145 processes: 145 local.\r\nFAILED: Build did NOT complete successfully\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34408", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34408/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34408/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34408/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34408", "id": 524822100, "node_id": "MDU6SXNzdWU1MjQ4MjIxMDA=", "number": 34408, "title": "tensorflow.python.keras.testing_utils.layer_test breaks when a (custom) layer is returning a list/tuple of tensor ", "user": {"login": "shun-lin", "id": 16867893, "node_id": "MDQ6VXNlcjE2ODY3ODkz", "avatar_url": "https://avatars0.githubusercontent.com/u/16867893?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shun-lin", "html_url": "https://github.com/shun-lin", "followers_url": "https://api.github.com/users/shun-lin/followers", "following_url": "https://api.github.com/users/shun-lin/following{/other_user}", "gists_url": "https://api.github.com/users/shun-lin/gists{/gist_id}", "starred_url": "https://api.github.com/users/shun-lin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shun-lin/subscriptions", "organizations_url": "https://api.github.com/users/shun-lin/orgs", "repos_url": "https://api.github.com/users/shun-lin/repos", "events_url": "https://api.github.com/users/shun-lin/events{/privacy}", "received_events_url": "https://api.github.com/users/shun-lin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 386191887, "node_id": "MDU6TGFiZWwzODYxOTE4ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20response", "name": "stat:awaiting response", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "shun-lin", "id": 16867893, "node_id": "MDQ6VXNlcjE2ODY3ODkz", "avatar_url": "https://avatars0.githubusercontent.com/u/16867893?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shun-lin", "html_url": "https://github.com/shun-lin", "followers_url": "https://api.github.com/users/shun-lin/followers", "following_url": "https://api.github.com/users/shun-lin/following{/other_user}", "gists_url": "https://api.github.com/users/shun-lin/gists{/gist_id}", "starred_url": "https://api.github.com/users/shun-lin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shun-lin/subscriptions", "organizations_url": "https://api.github.com/users/shun-lin/orgs", "repos_url": "https://api.github.com/users/shun-lin/repos", "events_url": "https://api.github.com/users/shun-lin/events{/privacy}", "received_events_url": "https://api.github.com/users/shun-lin/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "shun-lin", "id": 16867893, "node_id": "MDQ6VXNlcjE2ODY3ODkz", "avatar_url": "https://avatars0.githubusercontent.com/u/16867893?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shun-lin", "html_url": "https://github.com/shun-lin", "followers_url": "https://api.github.com/users/shun-lin/followers", "following_url": "https://api.github.com/users/shun-lin/following{/other_user}", "gists_url": "https://api.github.com/users/shun-lin/gists{/gist_id}", "starred_url": "https://api.github.com/users/shun-lin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shun-lin/subscriptions", "organizations_url": "https://api.github.com/users/shun-lin/orgs", "repos_url": "https://api.github.com/users/shun-lin/repos", "events_url": "https://api.github.com/users/shun-lin/events{/privacy}", "received_events_url": "https://api.github.com/users/shun-lin/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2019-11-19T07:18:14Z", "updated_at": "2020-03-17T18:10:28Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): gLinux\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): pip3 installed\r\n- TensorFlow version (use command below): 2.0.0\r\n- Python version: 3.6\r\n\r\n**Describe the current behavior**\r\nWhen we create a custom `tensorflow.keras.layer.Layer`, said `MyCustomLayer`, that returns a list/tuple of tensors in it's `call` method, calling `layer_test(MyCustomLayer, input_shape=expected_input_shape)` will break as `layer_test` does not expect list / tuple as outputs of the custom layer's `call` method, and by tensorflow's keras layer documentation [here](https://www.tensorflow.org/api_docs/python/tf/keras/layers/Layer#call), list / tuple of tensors are valid output. \r\n\r\n**Code to reproduce the issue**\r\n\r\n```python\r\nimport tensorflow as tf\r\nfrom tensorflow.python.keras.testing_utils import layer_test\r\n\r\n# a dummy layer that just returns a list of input\r\nclass MyCustomLayer(tf.keras.layers.Layer):\r\n  def call(self, input):\r\n    return [input, input]\r\n\r\nlayer_test(MyCustomLayer, input_shape=(1,2))\r\n```\r\n\r\n**Describe the expected behavior**\r\nThe expected behavior is that the above snippet will not return errors (log attached below)\r\n\r\nPotential Solution: Check the input `x` in `dtype()` method in `tensorflow_core/python/keras/backend.py`.\r\n\r\nHappy to contribute if this is helpful :)\r\n\r\n**Other info / logs**\r\n\r\nError Log:\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nAttributeError                            Traceback (most recent call last)\r\n<ipython-input-9-0eea06e136e5> in <module>()\r\n----> 1 layer_test(MyCustomLayer, input_shape=(1,2))\r\n\r\n2 frames\r\n/tensorflow-2.0.0/python3.6/tensorflow_core/python/framework/test_util.py in decorated(self, *args, **kwargs)\r\n   1583       original_var = os.environ.get(\"TF_CUDNN_DETERMINISTIC\", \"\")\r\n   1584       os.environ[\"TF_CUDNN_DETERMINISTIC\"] = \"true\"\r\n-> 1585       result = f(self, *args, **kwargs)\r\n   1586       os.environ[\"TF_CUDNN_DETERMINISTIC\"] = original_var\r\n   1587       return result\r\n\r\n/tensorflow-2.0.0/python3.6/tensorflow_core/python/keras/testing_utils.py in layer_test(layer_cls, kwargs, input_shape, input_dtype, input_data, expected_output, expected_output_dtype, expected_output_shape, validate_training, adapt_data)\r\n    140   x = keras.layers.Input(shape=input_shape[1:], dtype=input_dtype)\r\n    141   y = layer(x)\r\n--> 142   if keras.backend.dtype(y) != expected_output_dtype:\r\n    143     raise AssertionError('When testing layer %s, for input %s, found output '\r\n    144                          'dtype=%s but expected to find %s.\\nFull kwargs: %s' %\r\n\r\n/tensorflow-2.0.0/python3.6/tensorflow_core/python/keras/backend.py in dtype(x)\r\n   1247   ```\r\n   1248   \"\"\"\r\n-> 1249   return x.dtype.base_dtype.name\r\n   1250 \r\n   1251 \r\n\r\nAttributeError: 'list' object has no attribute 'dtype'\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34401", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34401/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34401/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34401/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34401", "id": 524747505, "node_id": "MDU6SXNzdWU1MjQ3NDc1MDU=", "number": 34401, "title": "Building from source \"undefined reference to `cublasGemmStridedBatchedEx' \"", "user": {"login": "NKCSRzChen", "id": 44854448, "node_id": "MDQ6VXNlcjQ0ODU0NDQ4", "avatar_url": "https://avatars0.githubusercontent.com/u/44854448?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NKCSRzChen", "html_url": "https://github.com/NKCSRzChen", "followers_url": "https://api.github.com/users/NKCSRzChen/followers", "following_url": "https://api.github.com/users/NKCSRzChen/following{/other_user}", "gists_url": "https://api.github.com/users/NKCSRzChen/gists{/gist_id}", "starred_url": "https://api.github.com/users/NKCSRzChen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NKCSRzChen/subscriptions", "organizations_url": "https://api.github.com/users/NKCSRzChen/orgs", "repos_url": "https://api.github.com/users/NKCSRzChen/repos", "events_url": "https://api.github.com/users/NKCSRzChen/events{/privacy}", "received_events_url": "https://api.github.com/users/NKCSRzChen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-11-19T03:17:55Z", "updated_at": "2019-11-21T01:28:39Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a build/installation issue. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:build_template</em>\r\n\r\n**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):Linux Ubuntu 16.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary):source \r\n- TensorFlow version:1.15\r\n- Python version:3.5.12\r\n- Installed using virtualenv? pip? conda?: pip install\r\n- Bazel version (if compiling from source): 0.29.1\r\n- GCC/Compiler version (if compiling from source): GCC-5.4.0\r\n- CUDA/cuDNN version: CUDA 9.1.85 cuDNN 7.0.5\r\n- GPU model and memory: Tesla M4 4Gb\r\n\r\n\r\n\r\n**Describe the problem**\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\nYou have bazel 0.29.1- (@non-git) installed.\r\nPlease specify the location of python. [Default is /usr/bin/python]: /usr/bin/python\r\n\r\n\r\nFound possible Python library paths:\r\n  /usr/lib/python3/dist-packages\r\n  /usr/local/lib/python3.5/dist-packages\r\nPlease input the desired Python library path to use.  Default is [/usr/lib/python3/dist-packages]\r\n/usr/local/lib/python3.5/dist-packages\r\nDo you wish to build TensorFlow with XLA JIT support? [Y/n]: y\r\nXLA JIT support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with OpenCL SYCL support? [y/N]: n\r\nNo OpenCL SYCL support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with ROCm support? [y/N]: n\r\nNo ROCm support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with CUDA support? [y/N]: y\r\nCUDA support will be enabled for TensorFlow.\r\n\r\nDo you wish to build TensorFlow with TensorRT support? [y/N]: n\r\nNo TensorRT support will be enabled for TensorFlow.\r\n\r\nFound CUDA 9.1 in:\r\n    /usr/local/cuda/lib64\r\n    /usr/local/cuda/include\r\nFound cuDNN 7 in:\r\n    /usr/local/cuda/lib64\r\n    /usr/local/cuda/include\r\n\r\n\r\nPlease specify a list of comma-separated CUDA compute capabilities you want to build with.\r\nYou can find the compute capability of your device at: https://developer.nvidia.com/cuda-gpus.\r\nPlease note that each additional compute capability significantly increases your build time and binary size, and that TensorFlow only supports compute capabilities >= 3.5 [Default is: 5.2]: 5.2\r\n\r\n\r\nDo you want to use clang as CUDA compiler? [y/N]: n\r\nnvcc will be used as CUDA compiler.\r\n\r\nPlease specify which gcc should be used by nvcc as the host compiler. [Default is /usr/bin/gcc]: \r\n\r\n\r\nPlease specify optimization flags to use during compilation when bazel option \"--config=opt\" is specified [Default is -march=native -Wno-sign-compare]: \r\n\r\n\r\nWould you like to interactively configure ./WORKSPACE for Android builds? [y/N]: n\r\nNot configuring the WORKSPACE for Android builds.\r\n\r\nPreconfigured Bazel build configs. You can use any of the below by adding \"--config=<>\" to your build command. See .bazelrc for more details.\r\n        --config=mkl            # Build with MKL support.\r\n        --config=monolithic     # Config for mostly static monolithic build.\r\n        --config=ngraph         # Build with Intel nGraph support.\r\n        --config=numa           # Build with NUMA support.\r\n        --config=dynamic_kernels        # (Experimental) Build kernels into separate shared objects.\r\n        --config=v2             # Build TensorFlow 2.x instead of 1.x.\r\nPreconfigured Bazel build configs to DISABLE default on features:\r\n        --config=noaws          # Disable AWS S3 filesystem support.\r\n        --config=nogcp          # Disable GCP support.\r\n        --config=nohdfs         # Disable HDFS support.\r\n        --config=nonccl         # Disable NVIDIA NCCL support.\r\nConfiguration finished\r\n\r\n$bazel build --verbose_failures --action_env=LD_LIBRARY_PATH=/usr/local/cuda/lib64 --config=cuda --config=opt //tensorflow/tools/pip_package:build_pip_package --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" --config=nonccl --config=nohdfs --config=mkl --config=monolithic --config=noaws --config=nogcp --config=monolithic\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\nERROR: /home/tensorflow/tensorflow/tensorflow/lite/toco/BUILD:439:1: Linking of rule '//tensorflow/lite/toco:toco' failed (Exit 1)\r\n[19,054 / 21,282] 46 actions running\r\n    Compiling tensorflow/core/kernels/slice_op_gpu.cu.cc [for host]; 181s local\r\n    Compiling tensorflow/core/kernels/pad_op_gpu.cu.cc [for host]; 154s local\r\n    Compiling tensorflow/core/kernels/tile_functor_cpu.cc [for host]; 123s local\r\n    Compiling tensorflow/core/kernels/resource_variable_ops.cc [for host]; 106s local\r\n    Compiling tensorflow/core/kernels/conv_ops_fused_float.cc [for host]; 94s local\r\n    Compiling tensorflow/core/kernels/conv_ops_fused_double.cc [for host]; 91s local\r\n    Compiling tensorflow/core/kernels/conv_ops.cc [for host]; 91s local\r\n    Compiling tensorflow/core/kernels/conv_grad_ops_3d.cc [for host]; 90s local ...\r\nbazel-out/host/bin/tensorflow/stream_executor/cuda/libcublas_plugin.lo(cuda_blas.o): In function `tensorflow::Status stream_executor::gpu::CUDABlas::DoBlasGemmBatchedInternal<Eigen::half, float, cublasStatus_t (*)(cublasContext*, cublasOperation_t, cublasOperation_t, int, int, int, float const*, float const**, int, float const**, int, float const*, float**, int, int)>(cublasStatus_t (*)(cublasContext*, cublasOperation_t, cublasOperation_t, int, int, int, float const*, float const**, int, float const**, int, float const*, float**, int, int), stream_executor::Stream*, stream_executor::blas::Transpose, stream_executor::blas::Transpose, unsigned long long, unsigned long long, unsigned long long, float, absl::Span<stream_executor::DeviceMemory<Eigen::half>* const> const&, int, absl::Span<stream_executor::DeviceMemory<Eigen::half>* const> const&, int, float, absl::Span<stream_executor::DeviceMemory<Eigen::half>* const> const&, int, int, stream_executor::ScratchAllocator*)':\r\ncuda_blas.cc:(.text._ZN15stream_executor3gpu8CUDABlas25DoBlasGemmBatchedInternalIN5Eigen4halfEfPF14cublasStatus_tP13cublasContext17cublasOperation_tS8_iiiPKfPSA_iSB_iSA_PPfiiEEEN10tensorflow6StatusET1_PNS_6StreamENS_4blas9TransposeESM_yyyT0_RKN4absl4SpanIKPNS_12DeviceMemoryIT_EEEEiSX_iSN_SX_iiPNS_16ScratchAllocatorE[_ZN15stream_executor3gpu8CUDABlas25DoBlasGemmBatchedInternalIN5Eigen4halfEfPF14cublasStatus_tP13cublasContext17cublasOperation_tS8_iiiPKfPSA_iSB_iSA_PPfiiEEEN10tensorflow6StatusET1_PNS_6StreamENS_4blas9TransposeESM_yyyT0_RKN4absl4SpanIKPNS_12DeviceMemoryIT_EEEEiSX_iSN_SX_iiPNS_16ScratchAllocatorE]+0x8c2): undefined reference to `cublasGemmBatchedEx'\r\nbazel-out/host/bin/tensorflow/stream_executor/cuda/libcublas_plugin.lo(cuda_blas.o): In function `tensorflow::Status stream_executor::gpu::CUDABlas::DoBlasGemmBatchedInternal<float, float, cublasStatus_t (*)(cublasContext*, cublasOperation_t, cublasOperation_t, int, int, int, float const*, float const**, int, float const**, int, float const*, float**, int, int)>(cublasStatus_t (*)(cublasContext*, cublasOperation_t, cublasOperation_t, int, int, int, float const*, float const**, int, float const**, int, float const*, float**, int, int), stream_executor::Stream*, stream_executor::blas::Transpose, stream_executor::blas::Transpose, unsigned long long, unsigned long long, unsigned long long, float, absl::Span<stream_executor::DeviceMemory<float>* const> const&, int, absl::Span<stream_executor::DeviceMemory<float>* const> const&, int, float, absl::Span<stream_executor::DeviceMemory<float>* const> const&, int, int, stream_executor::ScratchAllocator*)':\r\ncuda_blas.cc:(.text._ZN15stream_executor3gpu8CUDABlas25DoBlasGemmBatchedInternalIffPF14cublasStatus_tP13cublasContext17cublasOperation_tS6_iiiPKfPS8_iS9_iS8_PPfiiEEEN10tensorflow6StatusET1_PNS_6StreamENS_4blas9TransposeESK_yyyT0_RKN4absl4SpanIKPNS_12DeviceMemoryIT_EEEEiSV_iSL_SV_iiPNS_16ScratchAllocatorE[_ZN15stream_executor3gpu8CUDABlas25DoBlasGemmBatchedInternalIffPF14cublasStatus_tP13cublasContext17cublasOperation_tS6_iiiPKfPS8_iS9_iS8_PPfiiEEEN10tensorflow6StatusET1_PNS_6StreamENS_4blas9TransposeESK_yyyT0_RKN4absl4SpanIKPNS_12DeviceMemoryIT_EEEEiSV_iSL_SV_iiPNS_16ScratchAllocatorE]+0x9c7): undefined reference to `cublasGemmBatchedEx'\r\nbazel-out/host/bin/tensorflow/stream_executor/cuda/libcublas_plugin.lo(cuda_blas.o): In function `tensorflow::Status stream_executor::gpu::CUDABlas::DoBlasGemmBatchedInternal<double, double, cublasStatus_t (*)(cublasContext*, cublasOperation_t, cublasOperation_t, int, int, int, double const*, double const**, int, double const**, int, double const*, double**, int, int)>(cublasStatus_t (*)(cublasContext*, cublasOperation_t, cublasOperation_t, int, int, int, double const*, double const**, int, double const**, int, double const*, double**, int, int), stream_executor::Stream*, stream_executor::blas::Transpose, stream_executor::blas::Transpose, unsigned long long, unsigned long long, unsigned long long, double, absl::Span<stream_executor::DeviceMemory<double>* const> const&, int, absl::Span<stream_executor::DeviceMemory<double>* const> const&, int, double, absl::Span<stream_executor::DeviceMemory<double>* const> const&, int, int, stream_executor::ScratchAllocator*)':\r\ncuda_blas.cc:(.text._ZN15stream_executor3gpu8CUDABlas25DoBlasGemmBatchedInternalIddPF14cublasStatus_tP13cublasContext17cublasOperation_tS6_iiiPKdPS8_iS9_iS8_PPdiiEEEN10tensorflow6StatusET1_PNS_6StreamENS_4blas9TransposeESK_yyyT0_RKN4absl4SpanIKPNS_12DeviceMemoryIT_EEEEiSV_iSL_SV_iiPNS_16ScratchAllocatorE[_ZN15stream_executor3gpu8CUDABlas25DoBlasGemmBatchedInternalIddPF14cublasStatus_tP13cublasContext17cublasOperation_tS6_iiiPKdPS8_iS9_iS8_PPdiiEEEN10tensorflow6StatusET1_PNS_6StreamENS_4blas9TransposeESK_yyyT0_RKN4absl4SpanIKPNS_12DeviceMemoryIT_EEEEiSV_iSL_SV_iiPNS_16ScratchAllocatorE]+0xceb): undefined reference to `cublasGemmBatchedEx'\r\nbazel-out/host/bin/tensorflow/stream_executor/cuda/libcublas_plugin.lo(cuda_blas.o): In function `tensorflow::Status stream_executor::gpu::CUDABlas::DoBlasGemmBatchedInternal<std::complex<float>, std::complex<float>, cublasStatus_t (*)(cublasContext*, cublasOperation_t, cublasOperation_t, int, int, int, float2 const*, float2 const**, int, float2 const**, int, float2 const*, float2**, int, int)>(cublasStatus_t (*)(cublasContext*, cublasOperation_t, cublasOperation_t, int, int, int, float2 const*, float2 const**, int, float2 const**, int, float2 const*, float2**, int, int), stream_executor::Stream*, stream_executor::blas::Transpose, stream_executor::blas::Transpose, unsigned long long, unsigned long long, unsigned long long, std::complex<float>, absl::Span<stream_executor::DeviceMemory<std::complex<float> >* const> const&, int, absl::Span<stream_executor::DeviceMemory<std::complex<float> >* const> const&, int, std::complex<float>, absl::Span<stream_executor::DeviceMemory<std::complex<float> >* const> const&, int, int, stream_executor::ScratchAllocator*)':\r\ncuda_blas.cc:(.text._ZN15stream_executor3gpu8CUDABlas25DoBlasGemmBatchedInternalISt7complexIfES4_PF14cublasStatus_tP13cublasContext17cublasOperation_tS8_iiiPK6float2PSB_iSC_iSB_PPS9_iiEEEN10tensorflow6StatusET1_PNS_6StreamENS_4blas9TransposeESN_yyyT0_RKN4absl4SpanIKPNS_12DeviceMemoryIT_EEEEiSY_iSO_SY_iiPNS_16ScratchAllocatorE[_ZN15stream_executor3gpu8CUDABlas25DoBlasGemmBatchedInternalISt7complexIfES4_PF14cublasStatus_tP13cublasContext17cublasOperation_tS8_iiiPK6float2PSB_iSC_iSB_PPS9_iiEEEN10tensorflow6StatusET1_PNS_6StreamENS_4blas9TransposeESN_yyyT0_RKN4absl4SpanIKPNS_12DeviceMemoryIT_EEEEiSY_iSO_SY_iiPNS_16ScratchAllocatorE]+0xd2b): undefined reference to `cublasGemmBatchedEx'\r\nbazel-out/host/bin/tensorflow/stream_executor/cuda/libcublas_plugin.lo(cuda_blas.o): In function `tensorflow::Status stream_executor::gpu::CUDABlas::DoBlasGemmBatchedInternal<std::complex<double>, std::complex<double>, cublasStatus_t (*)(cublasContext*, cublasOperation_t, cublasOperation_t, int, int, int, double2 const*, double2 const**, int, double2 const**, int, double2 const*, double2**, int, int)>(cublasStatus_t (*)(cublasContext*, cublasOperation_t, cublasOperation_t, int, int, int, double2 const*, double2 const**, int, double2 const**, int, double2 const*, double2**, int, int), stream_executor::Stream*, stream_executor::blas::Transpose, stream_executor::blas::Transpose, unsigned long long, unsigned long long, unsigned long long, std::complex<double>, absl::Span<stream_executor::DeviceMemory<std::complex<double> >* const> const&, int, absl::Span<stream_executor::DeviceMemory<std::complex<double> >* const> const&, int, std::complex<double>, absl::Span<stream_executor::DeviceMemory<std::complex<double> >* const> const&, int, int, stream_executor::ScratchAllocator*)':\r\ncuda_blas.cc:(.text._ZN15stream_executor3gpu8CUDABlas25DoBlasGemmBatchedInternalISt7complexIdES4_PF14cublasStatus_tP13cublasContext17cublasOperation_tS8_iiiPK7double2PSB_iSC_iSB_PPS9_iiEEEN10tensorflow6StatusET1_PNS_6StreamENS_4blas9TransposeESN_yyyT0_RKN4absl4SpanIKPNS_12DeviceMemoryIT_EEEEiSY_iSO_SY_iiPNS_16ScratchAllocatorE[_ZN15stream_executor3gpu8CUDABlas25DoBlasGemmBatchedInternalISt7complexIdES4_PF14cublasStatus_tP13cublasContext17cublasOperation_tS8_iiiPK7double2PSB_iSC_iSB_PPS9_iiEEEN10tensorflow6StatusET1_PNS_6StreamENS_4blas9TransposeESN_yyyT0_RKN4absl4SpanIKPNS_12DeviceMemoryIT_EEEEiSY_iSO_SY_iiPNS_16ScratchAllocatorE]+0xcfb): undefined reference to `cublasGemmBatchedEx'\r\nbazel-out/host/bin/tensorflow/stream_executor/cuda/libcublas_plugin.lo(cuda_blas.o): In function `stream_executor::gpu::CUDABlas::DoBlasGemmStridedBatched(stream_executor::Stream*, stream_executor::blas::Transpose, stream_executor::blas::Transpose, unsigned long long, unsigned long long, unsigned long long, float, stream_executor::DeviceMemory<Eigen::half> const&, int, long long, stream_executor::DeviceMemory<Eigen::half> const&, int, long long, float, stream_executor::DeviceMemory<Eigen::half>*, int, long long, int)':\r\ncuda_blas.cc:(.text._ZN15stream_executor3gpu8CUDABlas24DoBlasGemmStridedBatchedEPNS_6StreamENS_4blas9TransposeES5_yyyfRKNS_12DeviceMemoryIN5Eigen4halfEEEixSB_ixfPS9_ixi+0x2e3): undefined reference to `cublasGemmStridedBatchedEx'\r\ncollect2: error: ld returned 1 exit status\r\n[19,054 / 21,282] 46 actions running\r\n    Compiling tensorflow/core/kernels/slice_op_gpu.cu.cc [for host]; 181s local\r\n    Compiling tensorflow/core/kernels/pad_op_gpu.cu.cc [for host]; 154s local\r\n    Compiling tensorflow/core/kernels/tile_functor_cpu.cc [for host]; 123s local\r\n    Compiling tensorflow/core/kernels/resource_variable_ops.cc [for host]; 106s local\r\n    Compiling tensorflow/core/kernels/conv_ops_fused_float.cc [for host]; 94s local\r\n    Compiling tensorflow/core/kernels/conv_ops_fused_double.cc [for host]; 91s local\r\n    Compiling tensorflow/core/kernels/conv_ops.cc [for host]; 91s local\r\n    Compiling tensorflow/core/kernels/conv_grad_ops_3d.cc [for host]; 90s local ...\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\n[19,101 / 21,282] checking cached actions\r\nINFO: Elapsed time: 1270.016s, Critical Path: 336.18s\r\n[19,101 / 21,282] checking cached actions\r\nINFO: 10667 processes: 10667 local.\r\n[19,101 / 21,282] checking cached actions\r\nFAILED: Build did NOT complete successfully\r\nFAILED: Build did NOT complete successfully\r\n \r\nI just search all the issues about \"undefined reference to `cublasGemmStridedBatchedEx'\", but I believe mine is different."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34396", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34396/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34396/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34396/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34396", "id": 524635251, "node_id": "MDU6SXNzdWU1MjQ2MzUyNTE=", "number": 34396, "title": "Error converting universal sentence encoder to TFLite with new converter. Failed to find function '__inference_pruned_1633'", "user": {"login": "jipson7", "id": 7778946, "node_id": "MDQ6VXNlcjc3Nzg5NDY=", "avatar_url": "https://avatars0.githubusercontent.com/u/7778946?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jipson7", "html_url": "https://github.com/jipson7", "followers_url": "https://api.github.com/users/jipson7/followers", "following_url": "https://api.github.com/users/jipson7/following{/other_user}", "gists_url": "https://api.github.com/users/jipson7/gists{/gist_id}", "starred_url": "https://api.github.com/users/jipson7/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jipson7/subscriptions", "organizations_url": "https://api.github.com/users/jipson7/orgs", "repos_url": "https://api.github.com/users/jipson7/repos", "events_url": "https://api.github.com/users/jipson7/events{/privacy}", "received_events_url": "https://api.github.com/users/jipson7/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-11-18T21:39:26Z", "updated_at": "2020-03-12T01:17:44Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): macos 10.14.6\r\n- TensorFlow installed from (source or binary): pip tf-nightly\r\n- TensorFlow version (or github SHA if from source): tf-nightly==2.1.0.dev20191113\r\n\r\n\r\n**Command used to run the converter or code if you\u2019re using the Python API**\r\n\r\n```\r\ntflite_convert --experimental_new_converter --saved_model_dir . --output_file use.tflite\r\n```\r\n\r\n**The output from the converter invocation**\r\n\r\n```\r\n2019-11-18 16:34:10.641404: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2019-11-18 16:34:10.653375: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fbe5ebb5250 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n2019-11-18 16:34:10.653433: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\n2019-11-18 16:34:13.643728: I tensorflow/core/grappler/devices.cc:60] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0 (Note: TensorFlow was not compiled with CUDA support)\r\n2019-11-18 16:34:13.643858: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2019-11-18 16:34:13.717700: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: graph_to_optimize\r\n2019-11-18 16:34:13.717743: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: Graph size after: 183 nodes (0), 183 edges (0), time = 19.817ms.\r\n2019-11-18 16:34:13.717754: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: Graph size after: 183 nodes (0), 183 edges (0), time = 19.384ms.\r\n2019-11-18 16:34:13.717762: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: __inference_pruned_1633\r\n2019-11-18 16:34:13.717770: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0.003ms.\r\n2019-11-18 16:34:13.717778: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   function_optimizer: function_optimizer did nothing. time = 0ms.\r\n2019-11-18 16:34:14.576811: I tensorflow/core/grappler/devices.cc:60] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0 (Note: TensorFlow was not compiled with CUDA support)\r\n2019-11-18 16:34:14.576933: I tensorflow/core/grappler/clusters/single_machine.cc:356] Starting new session\r\n2019-11-18 16:34:14.587930: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:814] Optimization results for grappler item: graph_to_optimize\r\n2019-11-18 16:34:14.587975: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 183 nodes (0), 183 edges (0), time = 3.225ms.\r\n2019-11-18 16:34:14.587986: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:816]   constant_folding: Graph size after: 183 nodes (0), 183 edges (0), time = 3.633ms.\r\nTraceback (most recent call last):\r\n  File \"/Users/caleb.p/Development/tflite-hub/.venv/bin/tflite_convert\", line 8, in <module>\r\n    sys.exit(main())\r\n  File \"/Users/caleb.p/Development/tflite-hub/.venv/lib/python3.6/site-packages/tensorflow_core/lite/python/tflite_convert.py\", line 594, in main\r\n    app.run(main=run_main, argv=sys.argv[:1])\r\n  File \"/Users/caleb.p/Development/tflite-hub/.venv/lib/python3.6/site-packages/tensorflow_core/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/Users/caleb.p/Development/tflite-hub/.venv/lib/python3.6/site-packages/absl/app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"/Users/caleb.p/Development/tflite-hub/.venv/lib/python3.6/site-packages/absl/app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/Users/caleb.p/Development/tflite-hub/.venv/lib/python3.6/site-packages/tensorflow_core/lite/python/tflite_convert.py\", line 577, in run_main\r\n    _convert_tf2_model(tflite_flags)\r\n  File \"/Users/caleb.p/Development/tflite-hub/.venv/lib/python3.6/site-packages/tensorflow_core/lite/python/tflite_convert.py\", line 235, in _convert_tf2_model\r\n    tflite_model = converter.convert()\r\n  File \"/Users/caleb.p/Development/tflite-hub/.venv/lib/python3.6/site-packages/tensorflow_core/lite/python/lite.py\", line 474, in convert\r\n    **converter_kwargs)\r\n  File \"/Users/caleb.p/Development/tflite-hub/.venv/lib/python3.6/site-packages/tensorflow_core/lite/python/convert.py\", line 457, in toco_convert_impl\r\n    enable_mlir_converter=enable_mlir_converter)\r\n  File \"/Users/caleb.p/Development/tflite-hub/.venv/lib/python3.6/site-packages/tensorflow_core/lite/python/convert.py\", line 203, in toco_convert_protos\r\n    raise ConverterError(\"See console for info.\\n%s\\n%s\\n\" % (stdout, stderr))\r\ntensorflow.lite.python.convert.ConverterError: See console for info.\r\n2019-11-18 16:34:16.190068: W tensorflow/compiler/mlir/lite/python/graphdef_to_tfl_flatbuffer.cc:106] Ignored output_format.\r\n2019-11-18 16:34:16.190086: W tensorflow/compiler/mlir/lite/python/graphdef_to_tfl_flatbuffer.cc:112] Ignored drop_control_dependency.\r\nTraceback (most recent call last):\r\n  File \"/Users/caleb.p/Development/tflite-hub/.venv/bin/toco_from_protos\", line 8, in <module>\r\n    sys.exit(main())\r\n  File \"/Users/caleb.p/Development/tflite-hub/.venv/lib/python3.6/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 93, in main\r\n    app.run(main=execute, argv=[sys.argv[0]] + unparsed)\r\n  File \"/Users/caleb.p/Development/tflite-hub/.venv/lib/python3.6/site-packages/tensorflow_core/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/Users/caleb.p/Development/tflite-hub/.venv/lib/python3.6/site-packages/absl/app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"/Users/caleb.p/Development/tflite-hub/.venv/lib/python3.6/site-packages/absl/app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/Users/caleb.p/Development/tflite-hub/.venv/lib/python3.6/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 56, in execute\r\n    enable_mlir_converter)\r\nException: Failed to find function '__inference_pruned_1633'. The imported TensorFlow GraphDef is ill-formed.\r\n\r\n```\r\n\r\n**Also, please include a link to the saved model or GraphDef**\r\n\r\n```\r\nhttps://tfhub.dev/google/universal-sentence-encoder/3\r\n```\r\nSince [this](https://groups.google.com/a/tensorflow.org/forum/#!topic/tflite/C7Ag0sUrLYg) announcement I thought that converting the universal sentence encoder to TFLite might be supported. Could anyone explain the reason for failure here? Thanks a lot!\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34393", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34393/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34393/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34393/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34393", "id": 524615620, "node_id": "MDU6SXNzdWU1MjQ2MTU2MjA=", "number": 34393, "title": "TFLite SIGILL on Invoke()", "user": {"login": "infil00p", "id": 2313, "node_id": "MDQ6VXNlcjIzMTM=", "avatar_url": "https://avatars0.githubusercontent.com/u/2313?v=4", "gravatar_id": "", "url": "https://api.github.com/users/infil00p", "html_url": "https://github.com/infil00p", "followers_url": "https://api.github.com/users/infil00p/followers", "following_url": "https://api.github.com/users/infil00p/following{/other_user}", "gists_url": "https://api.github.com/users/infil00p/gists{/gist_id}", "starred_url": "https://api.github.com/users/infil00p/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/infil00p/subscriptions", "organizations_url": "https://api.github.com/users/infil00p/orgs", "repos_url": "https://api.github.com/users/infil00p/repos", "events_url": "https://api.github.com/users/infil00p/events{/privacy}", "received_events_url": "https://api.github.com/users/infil00p/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "srjoglekar246", "id": 2099293, "node_id": "MDQ6VXNlcjIwOTkyOTM=", "avatar_url": "https://avatars3.githubusercontent.com/u/2099293?v=4", "gravatar_id": "", "url": "https://api.github.com/users/srjoglekar246", "html_url": "https://github.com/srjoglekar246", "followers_url": "https://api.github.com/users/srjoglekar246/followers", "following_url": "https://api.github.com/users/srjoglekar246/following{/other_user}", "gists_url": "https://api.github.com/users/srjoglekar246/gists{/gist_id}", "starred_url": "https://api.github.com/users/srjoglekar246/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/srjoglekar246/subscriptions", "organizations_url": "https://api.github.com/users/srjoglekar246/orgs", "repos_url": "https://api.github.com/users/srjoglekar246/repos", "events_url": "https://api.github.com/users/srjoglekar246/events{/privacy}", "received_events_url": "https://api.github.com/users/srjoglekar246/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "srjoglekar246", "id": 2099293, "node_id": "MDQ6VXNlcjIwOTkyOTM=", "avatar_url": "https://avatars3.githubusercontent.com/u/2099293?v=4", "gravatar_id": "", "url": "https://api.github.com/users/srjoglekar246", "html_url": "https://github.com/srjoglekar246", "followers_url": "https://api.github.com/users/srjoglekar246/followers", "following_url": "https://api.github.com/users/srjoglekar246/following{/other_user}", "gists_url": "https://api.github.com/users/srjoglekar246/gists{/gist_id}", "starred_url": "https://api.github.com/users/srjoglekar246/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/srjoglekar246/subscriptions", "organizations_url": "https://api.github.com/users/srjoglekar246/orgs", "repos_url": "https://api.github.com/users/srjoglekar246/repos", "events_url": "https://api.github.com/users/srjoglekar246/events{/privacy}", "received_events_url": "https://api.github.com/users/srjoglekar246/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-11-18T20:58:16Z", "updated_at": "2019-11-20T06:33:08Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): I am using the C++ API on Android\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Android 10, Android 9\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: Pixel 3, Samsung Galaxy S8\r\n- TensorFlow installed from (source or binary): Built from tag (build included in repro repo)\r\n- TensorFlow version (use command below): v2.0.0\r\n- Python version:\r\n- Bazel version (if compiling from source): 0.28.0\r\n- GCC/Compiler version (if compiling from source): NDK 18\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\n**Describe the current behaviour**\r\nWhile debugging C++ on Android, SIGILL is triggered on the interpreter->Invoke() call.  If you step past inference, TFLite still successfully infers and produces the correct result, but SIGILL shouldn't happen.\r\n\r\n**Describe the expected behavior**\r\nSIGILL shouldn't happen\r\n\r\n**Code to reproduce the issue**\r\nThis repro reproduces this issue:\r\ngit@github.com:infil00p/TFLiteSigILL.git\r\n\r\n**Other info / logs**\r\nDebug frame for SIGILL\r\n<img width=\"1286\" alt=\"Screen Shot 2019-11-18 at 12 56 57 PM\" src=\"https://user-images.githubusercontent.com/2313/69093285-026b7d80-0a03-11ea-809b-1e73d1537bf4.png\">\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34392", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34392/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34392/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34392/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34392", "id": 524604234, "node_id": "MDU6SXNzdWU1MjQ2MDQyMzQ=", "number": 34392, "title": "Training stucking and strange GPU usage", "user": {"login": "Clouxie", "id": 43240945, "node_id": "MDQ6VXNlcjQzMjQwOTQ1", "avatar_url": "https://avatars2.githubusercontent.com/u/43240945?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Clouxie", "html_url": "https://github.com/Clouxie", "followers_url": "https://api.github.com/users/Clouxie/followers", "following_url": "https://api.github.com/users/Clouxie/following{/other_user}", "gists_url": "https://api.github.com/users/Clouxie/gists{/gist_id}", "starred_url": "https://api.github.com/users/Clouxie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Clouxie/subscriptions", "organizations_url": "https://api.github.com/users/Clouxie/orgs", "repos_url": "https://api.github.com/users/Clouxie/repos", "events_url": "https://api.github.com/users/Clouxie/events{/privacy}", "received_events_url": "https://api.github.com/users/Clouxie/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1161789751, "node_id": "MDU6TGFiZWwxMTYxNzg5NzUx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.13", "name": "TF 1.13", "color": "7dedc4", "default": false, "description": "Issues related to TF 1.13"}, {"id": 1105108936, "node_id": "MDU6TGFiZWwxMTA1MTA4OTM2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:model", "name": "comp:model", "color": "0052cc", "default": false, "description": ""}, {"id": 1463677878, "node_id": "MDU6TGFiZWwxNDYzNjc3ODc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:performance", "name": "type:performance", "color": "159b2e", "default": false, "description": "Performance Issue"}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-11-18T20:34:24Z", "updated_at": "2020-02-13T09:10:01Z", "closed_at": null, "author_association": "NONE", "body": "Hi there,\r\nIm recently trying to train my model using configs from zoo.\r\nBut sometimes my training is stucking.\r\nfull Issue is described here \r\nhttps://github.com/EdjeElectronics/TensorFlow-Object-Detection-API-Tutorial-Train-Multiple-Objects-Windows-10/issues/385\r\n\r\nAnd the GPU usage looks like here - im uploading you a graph from MSI Afterburner :\r\n\r\nhttps://drive.google.com/file/d/1Z6q6uQnOfMn2VGDlpcWAHAwYW10qI1jA/view?usp=sharing\r\n\r\nThanks for help.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34391", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34391/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34391/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34391/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34391", "id": 524599577, "node_id": "MDU6SXNzdWU1MjQ1OTk1Nzc=", "number": 34391, "title": "TPUStrategy broken in TF2 Keras", "user": {"login": "kpe", "id": 2535923, "node_id": "MDQ6VXNlcjI1MzU5MjM=", "avatar_url": "https://avatars3.githubusercontent.com/u/2535923?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kpe", "html_url": "https://github.com/kpe", "followers_url": "https://api.github.com/users/kpe/followers", "following_url": "https://api.github.com/users/kpe/following{/other_user}", "gists_url": "https://api.github.com/users/kpe/gists{/gist_id}", "starred_url": "https://api.github.com/users/kpe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kpe/subscriptions", "organizations_url": "https://api.github.com/users/kpe/orgs", "repos_url": "https://api.github.com/users/kpe/repos", "events_url": "https://api.github.com/users/kpe/events{/privacy}", "received_events_url": "https://api.github.com/users/kpe/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 1097541661, "node_id": "MDU6TGFiZWwxMDk3NTQxNjYx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tpus", "name": "comp:tpus", "color": "0052cc", "default": false, "description": "tpu, tpuestimator"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rxsang", "id": 6399870, "node_id": "MDQ6VXNlcjYzOTk4NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6399870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rxsang", "html_url": "https://github.com/rxsang", "followers_url": "https://api.github.com/users/rxsang/followers", "following_url": "https://api.github.com/users/rxsang/following{/other_user}", "gists_url": "https://api.github.com/users/rxsang/gists{/gist_id}", "starred_url": "https://api.github.com/users/rxsang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rxsang/subscriptions", "organizations_url": "https://api.github.com/users/rxsang/orgs", "repos_url": "https://api.github.com/users/rxsang/repos", "events_url": "https://api.github.com/users/rxsang/events{/privacy}", "received_events_url": "https://api.github.com/users/rxsang/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rxsang", "id": 6399870, "node_id": "MDQ6VXNlcjYzOTk4NzA=", "avatar_url": "https://avatars0.githubusercontent.com/u/6399870?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rxsang", "html_url": "https://github.com/rxsang", "followers_url": "https://api.github.com/users/rxsang/followers", "following_url": "https://api.github.com/users/rxsang/following{/other_user}", "gists_url": "https://api.github.com/users/rxsang/gists{/gist_id}", "starred_url": "https://api.github.com/users/rxsang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rxsang/subscriptions", "organizations_url": "https://api.github.com/users/rxsang/orgs", "repos_url": "https://api.github.com/users/rxsang/repos", "events_url": "https://api.github.com/users/rxsang/events{/privacy}", "received_events_url": "https://api.github.com/users/rxsang/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 10, "created_at": "2019-11-18T20:24:01Z", "updated_at": "2020-02-27T18:33:46Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code: YES\r\n- OS Platform and Distribution: Google Colab\r\n- TensorFlow installed from (source or binary): Colab\r\n- TensorFlow version (use command below):  ('v2.0.0-rc2-26-g64c3d38', '2.0.0')\r\n- GPU model and memory:  Colab TPU\r\n\r\n**Describe the current behavior**\r\nTPU in collab cannot be used with TF 2, trying to use `TFRecordDataset` as an input to a Keras `Model.fit()` generates different exceptions depending on the whether `TPUStrategy.experimental_distribute_dataset()` is used or not.\r\n\r\n\r\n1. when `TPUStrategy.experimental_distribute_dataset()` is **not** used or used but not within an `/job:worker` context:\r\n```\r\nInternalError: Failed copying input tensor from /job:localhost/replica:0/task:0/device:CPU:0 to /job:worker/replica:0/task:0/device:CPU:0 in order to run AutoShardDataset: Unable to parse tensor proto\r\nAdditional GRPC error information:\r\n{\"created\":\"@1574107145.043685979\",\"description\":\"Error received from peer\",\"file\":\"external/grpc/src/core/lib/surface/call.cc\",\"file_line\":1039,\"grpc_message\":\"Unable to parse tensor proto\",\"grpc_status\":3} [Op:AutoShardDataset]\r\n```\r\n\r\n2. using a `/job:worker` context without `experimental_distribute_dataset` crashes the Colab session with:\r\n```\r\nNov 18, 2019, 9:17:39 PM\tWARNING\t2019-11-18 20:17:39.591672: E tensorflow/core/framework/variant.cc:102] Could not decode variant with type_name: \"tensorflow::DatasetVariantWrapper\". Perhaps you forgot to register a decoder via REGISTER_UNARY_VARIANT_DECODE_FUNCTION?\r\nNov 18, 2019, 9:09:53 PM\tWARNING\t2019-11-18 20:09:53.396513: E tensorflow/core/framework/dataset.cc:76] The Encode() method is not implemented for DatasetVariantWrapper objects.\r\nNov 18, 2019, 9:08:19 PM\tWARNING\t2019-11-18 20:08:19.842178: E tensorflow/core/framework/dataset.cc:76] The Encode() method is not implemented for DatasetVariantWrapper objects.\r\n```\r\n\r\n3. and 4. when `experimental_distribute_dataset` is used in a `tf.device(\"/job:worker\")` context:\r\n```\r\n/tensorflow-2.0.0/python3.6/tensorflow_core/python/keras/engine/training.py in _distribution_standardize_user_data(self, x, y, sample_weight, class_weight, batch_size, validation_split, shuffle, epochs, allow_partial_batch)\r\n   2313         x = ds.batch(batch_size, drop_remainder=drop_remainder)\r\n   2314       else:\r\n-> 2315         assert isinstance(x, dataset_ops.DatasetV2)\r\n   2316         training_utils.validate_dataset_input(x, y, sample_weight,\r\n   2317                                               validation_split)\r\n```\r\n\r\n**Describe the expected behavior**\r\nThere should be at least one way of making the example bellow work with TF2 (it works with TF1).\r\n\r\n**Code to reproduce the issue**\r\ncould also be checked here https://colab.research.google.com/gist/kpe/22340866c1dd3208d9177d2c8a9322e3/tpu-emb.ipynb\r\n\r\n```python\r\n%tensorflow_version 2.x\r\nimport tensorflow as tf\r\nprint(\"TF version:\", tf.__version__)\r\n\r\nimport os\r\n\r\ntfrec_path = \"gs://kpe-pub/pub/tpu-strategy-ds-issue/test.tfrecords\"\r\n\r\ndef parse_example(proto):\r\n    return tf.io.parse_single_example(proto, {\r\n        \"feature\": tf.io.VarLenFeature(tf.float32), \r\n        \"label\":   tf.io.VarLenFeature(tf.int64)\r\n    })\r\n\r\ndef from_tfrecords_file(tfrec_path):\r\n    ds = tf.data.TFRecordDataset([tfrec_path], compression_type=\"GZIP\")\r\n    ds = ds.map(parse_example)\r\n    def to_dense(example):\r\n        feature = tf.cast(tf.sparse.to_dense(example[\"feature\"]), tf.float32)\r\n        label   = tf.cast(tf.sparse.to_dense(example[\"label\"]), tf.int32)\r\n        return feature, tf.squeeze(label, -1)\r\n    ds = ds.map(to_dense)\r\n    return ds\r\n\r\ntry:\r\n    TPU_WORKER = 'grpc://' + os.environ['COLAB_TPU_ADDR']\r\n    tf.config.experimental_connect_to_host(TPU_WORKER)\r\n    tpu = tf.distribute.cluster_resolver.TPUClusterResolver()\r\n    tf.tpu.experimental.initialize_tpu_system(tpu)\r\n    strategy = tf.distribute.experimental.TPUStrategy(tpu)\r\nexcept:\r\n    strategy = tf.distribute.get_strategy()\r\nprint(strategy)\r\n\r\n\r\ndef test_strategy(use_case):\r\n    assert use_case in [0,1,2,3,4]\r\n\r\n    if tf.__version__.startswith(\"1.\"): # in TF1 no need to distribute the dataset\r\n        ds = from_tfrecords_file(tfrec_path).repeat().batch(32)\r\n    else:\r\n        if use_case == 0:\r\n            ds = from_tfrecords_file(tfrec_path).repeat().batch(32)\r\n        if use_case == 1:\r\n            ds = from_tfrecords_file(tfrec_path).repeat().batch(32)\r\n            ds = strategy.experimental_distribute_dataset(ds)\r\n        if use_case == 2:            \r\n            with tf.device(\"/job:worker\"):\r\n                ds = from_tfrecords_file(tfrec_path).repeat().batch(32)\r\n        if use_case == 3:\r\n            with tf.device(\"/job:worker\"):\r\n                ds = from_tfrecords_file(tfrec_path).repeat().batch(32)\r\n                ds = strategy.experimental_distribute_dataset(ds)\r\n        if use_case == 4:\r\n            with strategy.scope(), tf.device(\"/job:worker\"):\r\n                ds = from_tfrecords_file(tfrec_path).repeat().batch(32)\r\n                ds = strategy.experimental_distribute_dataset(ds)\r\n\r\n    with strategy.scope():\r\n        model = tf.keras.models.Sequential([\r\n            tf.keras.layers.InputLayer(input_shape=(128,)),\r\n            tf.keras.layers.Dense(2)\r\n        ])\r\n        model.build()\r\n        model.compile(\"adam\", loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True))\r\n        model.fit(ds, steps_per_epoch=4)\r\n\r\ntest_strategy(0) # try 0 ot 4\r\n```\r\n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34384", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34384/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34384/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34384/events", "html_url": "https://github.com/tensorflow/tensorflow/pull/34384", "id": 524538008, "node_id": "MDExOlB1bGxSZXF1ZXN0MzQyMjk0Mjcw", "number": 34384, "title": "Re-enable GPUNMSv3 and v4 for small box count users", "user": {"login": "samikama", "id": 10539540, "node_id": "MDQ6VXNlcjEwNTM5NTQw", "avatar_url": "https://avatars0.githubusercontent.com/u/10539540?v=4", "gravatar_id": "", "url": "https://api.github.com/users/samikama", "html_url": "https://github.com/samikama", "followers_url": "https://api.github.com/users/samikama/followers", "following_url": "https://api.github.com/users/samikama/following{/other_user}", "gists_url": "https://api.github.com/users/samikama/gists{/gist_id}", "starred_url": "https://api.github.com/users/samikama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/samikama/subscriptions", "organizations_url": "https://api.github.com/users/samikama/orgs", "repos_url": "https://api.github.com/users/samikama/repos", "events_url": "https://api.github.com/users/samikama/events{/privacy}", "received_events_url": "https://api.github.com/users/samikama/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 390482148, "node_id": "MDU6TGFiZWwzOTA0ODIxNDg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/awaiting%20review", "name": "awaiting review", "color": "bc3869", "default": false, "description": ""}, {"id": 300136587, "node_id": "MDU6TGFiZWwzMDAxMzY1ODc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/cla:%20yes", "name": "cla: yes", "color": "009800", "default": false, "description": null}, {"id": 1169364458, "node_id": "MDU6TGFiZWwxMTY5MzY0NDU4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/size:S", "name": "size:S", "color": "adafea", "default": false, "description": "CL Change Size: Small"}], "state": "open", "locked": false, "assignee": {"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rthadur", "id": 43972606, "node_id": "MDQ6VXNlcjQzOTcyNjA2", "avatar_url": "https://avatars2.githubusercontent.com/u/43972606?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rthadur", "html_url": "https://github.com/rthadur", "followers_url": "https://api.github.com/users/rthadur/followers", "following_url": "https://api.github.com/users/rthadur/following{/other_user}", "gists_url": "https://api.github.com/users/rthadur/gists{/gist_id}", "starred_url": "https://api.github.com/users/rthadur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rthadur/subscriptions", "organizations_url": "https://api.github.com/users/rthadur/orgs", "repos_url": "https://api.github.com/users/rthadur/repos", "events_url": "https://api.github.com/users/rthadur/events{/privacy}", "received_events_url": "https://api.github.com/users/rthadur/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-11-18T18:24:00Z", "updated_at": "2020-02-20T08:43:39Z", "closed_at": null, "author_association": "CONTRIBUTOR", "pull_request": {"url": "https://api.github.com/repos/tensorflow/tensorflow/pulls/34384", "html_url": "https://github.com/tensorflow/tensorflow/pull/34384", "diff_url": "https://github.com/tensorflow/tensorflow/pull/34384.diff", "patch_url": "https://github.com/tensorflow/tensorflow/pull/34384.patch"}, "body": "Reopening #34331 for master, to be CP'ed to 2.1. @mihaimaruseac @aaroey \r\n\r\nThis PR enables GPU implementation for NonMaxSuppresion ops v3 and v4 which was disabled due to high memory utilization at extremely large input counts (~8GB for 256000 boxes). Op has modest memory requirements for most models having about O(10k) inputs."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34380", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34380/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34380/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34380/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34380", "id": 524491089, "node_id": "MDU6SXNzdWU1MjQ0OTEwODk=", "number": 34380, "title": "Why is autoencoder with tensorflow 2.0 is performing very bad compared to the same code in keras?", "user": {"login": "ahmedelmahy", "id": 21027513, "node_id": "MDQ6VXNlcjIxMDI3NTEz", "avatar_url": "https://avatars2.githubusercontent.com/u/21027513?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ahmedelmahy", "html_url": "https://github.com/ahmedelmahy", "followers_url": "https://api.github.com/users/ahmedelmahy/followers", "following_url": "https://api.github.com/users/ahmedelmahy/following{/other_user}", "gists_url": "https://api.github.com/users/ahmedelmahy/gists{/gist_id}", "starred_url": "https://api.github.com/users/ahmedelmahy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ahmedelmahy/subscriptions", "organizations_url": "https://api.github.com/users/ahmedelmahy/orgs", "repos_url": "https://api.github.com/users/ahmedelmahy/repos", "events_url": "https://api.github.com/users/ahmedelmahy/events{/privacy}", "received_events_url": "https://api.github.com/users/ahmedelmahy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-11-18T16:53:07Z", "updated_at": "2019-12-10T01:09:33Z", "closed_at": null, "author_association": "NONE", "body": "I am training an autoencoder on the mnist data With keras the validation loss is great (starting from 0.2687 to .1) While with tensorflow(version 2.0).keras validation loss is stuck at (.6) Even though I am using the same code.\r\n\r\nBelow is the code with keras ([you can test it in colab](https://colab.research.google.com/drive/1AD5Z_pXsaM6Ubn6Yfg0uD230J9o8AfRS)) and followed by the code with tf.keras ([you can test it in colab](https://colab.research.google.com/drive/1Hj3-_Bjfkp3-dmd38-1CmIR4VLOV98hB))\r\n\r\n```\r\nfrom keras.layers import Input, Dense\r\nfrom keras.models import Model, Sequential\r\nfrom keras.datasets import mnist\r\nimport numpy as np\r\n\r\n#Import the MNIST data, only take the images since we don't need the targets\r\n(x_train, y_train), (x_test, y_test) = mnist.load_data()\r\n#Normalize and reshape images to vectors\r\nx_train = x_train.astype('float32') / 255.\r\nx_test = x_test.astype('float32') / 255.\r\nx_train = x_train.reshape((len(x_train), np.prod(x_train.shape[1:])))\r\nx_test = x_test.reshape((len(x_test), np.prod(x_test.shape[1:])))\r\nprint (x_train.shape)\r\nprint (x_test.shape)\r\n\r\n\r\ninput = Input(shape=(784,))\r\ny = Dense(64, activation='relu')(input)\r\nz = Dense(784, activation='sigmoid')(y)\r\nae = Model(input, z)\r\nencoder = Model(input, y)\r\ninput_decoder = Input(shape = (64,))\r\ndecoder_layer = ae.layers[-1]\r\ndecoder = Model(input_decoder, decoder_layer(input_decoder))\r\nae.compile(optimizer='adadelta', loss = 'binary_crossentropy')\r\nae.fit(x_train, x_train, epochs = 50, batch_size=256, shuffle=False, validation_data=(x_test, x_test))\r\n```\r\n\r\n60000/60000 [==============================] - 5s 88us/step - loss: 0.3494 - val_loss: 0.2688 Epoch 2/50 60000/60000 [==============================] - 4s 74us/step - loss: 0.2578 - val_loss: 0.2445 Epoch 3/50\r\n\r\n```\r\nfrom tensorflow.keras.layers import Input, Dense\r\nfrom tensorflow.keras.models import Model, Sequential\r\nfrom tensorflow.keras.datasets import mnist\r\nimport numpy as np\r\n\r\n#Import the MNIST data, only take the images since we don't need the targets\r\n(x_train, y_train), (x_test, y_test) = mnist.load_data()\r\n#Normalize and reshape images to vectors\r\nx_train = x_train.astype('float32') / 255.\r\nx_test = x_test.astype('float32') / 255.\r\nx_train = x_train.reshape((len(x_train), np.prod(x_train.shape[1:])))\r\nx_test = x_test.reshape((len(x_test), np.prod(x_test.shape[1:])))\r\nprint (x_train.shape)\r\nprint (x_test.shape)\r\n\r\n\r\ninput = Input(shape=(784,))\r\ny = Dense(64, activation='relu')(input)\r\nz = Dense(784, activation='sigmoid')(y)\r\nae = Model(input, z)\r\nencoder = Model(input, y)\r\ninput_decoder = Input(shape = (64,))\r\ndecoder_layer = ae.layers[-1]\r\ndecoder = Model(input_decoder, decoder_layer(input_decoder))\r\nae.compile(optimizer='adadelta', loss = 'binary_crossentropy')\r\nae.fit(x_train, x_train, epochs = 50, batch_size=256, shuffle=False, validation_data=(x_test, x_test))\r\n\r\n```\r\nTrain on 60000 samples, validate on 10000 samples Epoch 1/50 60000/60000 [==============================] - 4s 59us/sample - loss: 0.6941 - val_loss: 0.6939 Epoch 2/50 60000/60000 [==============================] - 3s 47us/sample - loss: 0.6937 - val_loss: 0.6936\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34371", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34371/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34371/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34371/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34371", "id": 524243890, "node_id": "MDU6SXNzdWU1MjQyNDM4OTA=", "number": 34371, "title": "tf.io.gfile.glob does not list all files in a Google Cloud Storage bucket", "user": {"login": "SaschaHeyer", "id": 1991664, "node_id": "MDQ6VXNlcjE5OTE2NjQ=", "avatar_url": "https://avatars3.githubusercontent.com/u/1991664?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SaschaHeyer", "html_url": "https://github.com/SaschaHeyer", "followers_url": "https://api.github.com/users/SaschaHeyer/followers", "following_url": "https://api.github.com/users/SaschaHeyer/following{/other_user}", "gists_url": "https://api.github.com/users/SaschaHeyer/gists{/gist_id}", "starred_url": "https://api.github.com/users/SaschaHeyer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SaschaHeyer/subscriptions", "organizations_url": "https://api.github.com/users/SaschaHeyer/orgs", "repos_url": "https://api.github.com/users/SaschaHeyer/repos", "events_url": "https://api.github.com/users/SaschaHeyer/events{/privacy}", "received_events_url": "https://api.github.com/users/SaschaHeyer/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "mihaimaruseac", "id": 323199, "node_id": "MDQ6VXNlcjMyMzE5OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/323199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mihaimaruseac", "html_url": "https://github.com/mihaimaruseac", "followers_url": "https://api.github.com/users/mihaimaruseac/followers", "following_url": "https://api.github.com/users/mihaimaruseac/following{/other_user}", "gists_url": "https://api.github.com/users/mihaimaruseac/gists{/gist_id}", "starred_url": "https://api.github.com/users/mihaimaruseac/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mihaimaruseac/subscriptions", "organizations_url": "https://api.github.com/users/mihaimaruseac/orgs", "repos_url": "https://api.github.com/users/mihaimaruseac/repos", "events_url": "https://api.github.com/users/mihaimaruseac/events{/privacy}", "received_events_url": "https://api.github.com/users/mihaimaruseac/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-11-18T09:34:42Z", "updated_at": "2019-11-26T22:25:00Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): ?\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: /\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 2.0.0\r\n- Python version: 3\r\n- Bazel version (if compiling from source): /\r\n- GCC/Compiler version (if compiling from source): /\r\n- CUDA/cuDNN version: /\r\n- GPU model and memory: /\r\n\r\n**Describe the current behavior**\r\nWhen listing file with `tf.io.gfile.glob` not all images are returned. It seems it is not resolving the folders recursively. \r\nWhen using the same path with gsutils  we get the correct image count.\r\n\r\n\r\n**Describe the expected behavior**\r\nWhen using the same gs:// path with **gsutils** we get the correct amount of images. \r\n\r\n**Code to reproduce the issue**\r\nIn order to reproduce the behavior I prepared a Google Bucket with the following structure. The bucket is public accessible, please feel free to use it to reproduce the behavior on your end: `gs://tensorflow-issue-reproduction`\r\n\r\n![level0](https://user-images.githubusercontent.com/1991664/69040135-93375e80-09ed-11ea-927f-da445d2bae10.png)\r\n![level1](https://user-images.githubusercontent.com/1991664/69040139-94688b80-09ed-11ea-9e19-28af47c3bcee.png)\r\n![level2](https://user-images.githubusercontent.com/1991664/69040146-96cae580-09ed-11ea-8894-c69a82acbbaa.png)\r\n![level3](https://user-images.githubusercontent.com/1991664/69040150-9894a900-09ed-11ea-94dc-49fb2d9b3b9b.png)\r\n\r\nIn summary we have 4 jpg images nested in different folder levels.\r\n\r\nTensorFlow 2 code to reproduce\r\n```\r\nfiles = tf.io.gfile.glob('gs://tensorflow-issue-reproduction/**/*.jpg')\r\nprint('file count: ', len(files))\r\n# found files 1\r\n```\r\n\r\ngsutil command which works properly\r\n```\r\ngsutil du gs://tensorflow-issue-reproduction/**/*.jpg | wc -l\r\n# found files 4\r\n```\r\n\r\n**Other info / logs**\r\n/\r\n\r\nBest regards\r\nSascha\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34369", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34369/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34369/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34369/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34369", "id": 524188002, "node_id": "MDU6SXNzdWU1MjQxODgwMDI=", "number": 34369, "title": "TF2 Warning :  Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.", "user": {"login": "songs18", "id": 47944452, "node_id": "MDQ6VXNlcjQ3OTQ0NDUy", "avatar_url": "https://avatars0.githubusercontent.com/u/47944452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/songs18", "html_url": "https://github.com/songs18", "followers_url": "https://api.github.com/users/songs18/followers", "following_url": "https://api.github.com/users/songs18/following{/other_user}", "gists_url": "https://api.github.com/users/songs18/gists{/gist_id}", "starred_url": "https://api.github.com/users/songs18/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/songs18/subscriptions", "organizations_url": "https://api.github.com/users/songs18/orgs", "repos_url": "https://api.github.com/users/songs18/repos", "events_url": "https://api.github.com/users/songs18/events{/privacy}", "received_events_url": "https://api.github.com/users/songs18/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 736653459, "node_id": "MDU6TGFiZWw3MzY2NTM0NTk=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:eager", "name": "comp:eager", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 13, "created_at": "2019-11-18T07:35:21Z", "updated_at": "2019-12-20T22:08:54Z", "closed_at": null, "author_association": "NONE", "body": "When i compute grads by tf.GradientTape, console presents  a warning : Sets are not currently considered sequences, but this may change in future, so consider avoiding using them. My code is like this \r\nwith tf.GradientTape() as tape:\r\n    ^\r\n    grads=tapge.gradient( loss, trainable_variable_list)\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34365", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34365/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34365/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34365/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34365", "id": 524103059, "node_id": "MDU6SXNzdWU1MjQxMDMwNTk=", "number": 34365, "title": "Why tf.concat not support multiply types", "user": {"login": "Leslie-Fang", "id": 16850179, "node_id": "MDQ6VXNlcjE2ODUwMTc5", "avatar_url": "https://avatars2.githubusercontent.com/u/16850179?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Leslie-Fang", "html_url": "https://github.com/Leslie-Fang", "followers_url": "https://api.github.com/users/Leslie-Fang/followers", "following_url": "https://api.github.com/users/Leslie-Fang/following{/other_user}", "gists_url": "https://api.github.com/users/Leslie-Fang/gists{/gist_id}", "starred_url": "https://api.github.com/users/Leslie-Fang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Leslie-Fang/subscriptions", "organizations_url": "https://api.github.com/users/Leslie-Fang/orgs", "repos_url": "https://api.github.com/users/Leslie-Fang/repos", "events_url": "https://api.github.com/users/Leslie-Fang/events{/privacy}", "received_events_url": "https://api.github.com/users/Leslie-Fang/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "gowthamkpr", "id": 47574994, "node_id": "MDQ6VXNlcjQ3NTc0OTk0", "avatar_url": "https://avatars0.githubusercontent.com/u/47574994?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gowthamkpr", "html_url": "https://github.com/gowthamkpr", "followers_url": "https://api.github.com/users/gowthamkpr/followers", "following_url": "https://api.github.com/users/gowthamkpr/following{/other_user}", "gists_url": "https://api.github.com/users/gowthamkpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/gowthamkpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gowthamkpr/subscriptions", "organizations_url": "https://api.github.com/users/gowthamkpr/orgs", "repos_url": "https://api.github.com/users/gowthamkpr/repos", "events_url": "https://api.github.com/users/gowthamkpr/events{/privacy}", "received_events_url": "https://api.github.com/users/gowthamkpr/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-11-18T02:48:02Z", "updated_at": "2019-11-19T18:47:04Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version (you are using): TF2.0\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nI have 2 tensor with shape(1,4)\r\nbut one tensor(a) is string type.\r\nAnother tensor(b) is int32 type.\r\nWhen I try to concat them\r\ntf.concat([a,b], 0)\r\nI get the error message:\r\n_tensorflow.python.framework.errors_impl.InvalidArgumentError: cannot compute ConcatV2 as input #1(zero-based) was expected to be a string tensor but is a int32 tensor [Op:ConcatV2] name: concat_\r\n\r\n**Will this change the current api? How?**\r\n\r\n**Who will benefit with this feature?**\r\ntf.concat users\r\n\r\n**Any Other info.**\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34363", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34363/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34363/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34363/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34363", "id": 524063270, "node_id": "MDU6SXNzdWU1MjQwNjMyNzA=", "number": 34363, "title": "random.uniform((),minval,maxval) returns array instead of scalar tensor when min or maxval is not a scalar tensor", "user": {"login": "Pixel-Therapy", "id": 41266240, "node_id": "MDQ6VXNlcjQxMjY2MjQw", "avatar_url": "https://avatars0.githubusercontent.com/u/41266240?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Pixel-Therapy", "html_url": "https://github.com/Pixel-Therapy", "followers_url": "https://api.github.com/users/Pixel-Therapy/followers", "following_url": "https://api.github.com/users/Pixel-Therapy/following{/other_user}", "gists_url": "https://api.github.com/users/Pixel-Therapy/gists{/gist_id}", "starred_url": "https://api.github.com/users/Pixel-Therapy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Pixel-Therapy/subscriptions", "organizations_url": "https://api.github.com/users/Pixel-Therapy/orgs", "repos_url": "https://api.github.com/users/Pixel-Therapy/repos", "events_url": "https://api.github.com/users/Pixel-Therapy/events{/privacy}", "received_events_url": "https://api.github.com/users/Pixel-Therapy/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rmothukuru", "id": 48206667, "node_id": "MDQ6VXNlcjQ4MjA2NjY3", "avatar_url": "https://avatars3.githubusercontent.com/u/48206667?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmothukuru", "html_url": "https://github.com/rmothukuru", "followers_url": "https://api.github.com/users/rmothukuru/followers", "following_url": "https://api.github.com/users/rmothukuru/following{/other_user}", "gists_url": "https://api.github.com/users/rmothukuru/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmothukuru/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmothukuru/subscriptions", "organizations_url": "https://api.github.com/users/rmothukuru/orgs", "repos_url": "https://api.github.com/users/rmothukuru/repos", "events_url": "https://api.github.com/users/rmothukuru/events{/privacy}", "received_events_url": "https://api.github.com/users/rmothukuru/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rmothukuru", "id": 48206667, "node_id": "MDQ6VXNlcjQ4MjA2NjY3", "avatar_url": "https://avatars3.githubusercontent.com/u/48206667?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmothukuru", "html_url": "https://github.com/rmothukuru", "followers_url": "https://api.github.com/users/rmothukuru/followers", "following_url": "https://api.github.com/users/rmothukuru/following{/other_user}", "gists_url": "https://api.github.com/users/rmothukuru/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmothukuru/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmothukuru/subscriptions", "organizations_url": "https://api.github.com/users/rmothukuru/orgs", "repos_url": "https://api.github.com/users/rmothukuru/repos", "events_url": "https://api.github.com/users/rmothukuru/events{/privacy}", "received_events_url": "https://api.github.com/users/rmothukuru/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-11-17T23:04:12Z", "updated_at": "2019-11-22T04:22:15Z", "closed_at": null, "author_association": "NONE", "body": "```\r\n>>> import tensorflow as tf\r\n>>> scalar = tf.zeros(shape=())\r\n>>> array = tf.zeros(shape=(1,))\r\n\r\n>>> tf.random.uniform(shape=(),minval = scalar)\r\n<tf.Tensor: id=25, shape=(), dtype=float32, numpy=0.021499991>\r\n\r\n>>> tf.random.uniform(shape=(),minval = array)\r\n<tf.Tensor: id=31, shape=(1,), dtype=float32, numpy=array([0.9388697], dtype=float32)>\r\n```\r\nExpected behavior is to either trow an error or treat single element tensor as scalar and return a scalar.\r\n\r\n-win10, tf2, cuda"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34358", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34358/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34358/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34358/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34358", "id": 523995836, "node_id": "MDU6SXNzdWU1MjM5OTU4MzY=", "number": 34358, "title": "Dynamic Batch size ( Bucketing ) for GPU in MirrorStrategy in TF 2.0 and avoid NaN .", "user": {"login": "s4sarath", "id": 10637096, "node_id": "MDQ6VXNlcjEwNjM3MDk2", "avatar_url": "https://avatars0.githubusercontent.com/u/10637096?v=4", "gravatar_id": "", "url": "https://api.github.com/users/s4sarath", "html_url": "https://github.com/s4sarath", "followers_url": "https://api.github.com/users/s4sarath/followers", "following_url": "https://api.github.com/users/s4sarath/following{/other_user}", "gists_url": "https://api.github.com/users/s4sarath/gists{/gist_id}", "starred_url": "https://api.github.com/users/s4sarath/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/s4sarath/subscriptions", "organizations_url": "https://api.github.com/users/s4sarath/orgs", "repos_url": "https://api.github.com/users/s4sarath/repos", "events_url": "https://api.github.com/users/s4sarath/events{/privacy}", "received_events_url": "https://api.github.com/users/s4sarath/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "rmothukuru", "id": 48206667, "node_id": "MDQ6VXNlcjQ4MjA2NjY3", "avatar_url": "https://avatars3.githubusercontent.com/u/48206667?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmothukuru", "html_url": "https://github.com/rmothukuru", "followers_url": "https://api.github.com/users/rmothukuru/followers", "following_url": "https://api.github.com/users/rmothukuru/following{/other_user}", "gists_url": "https://api.github.com/users/rmothukuru/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmothukuru/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmothukuru/subscriptions", "organizations_url": "https://api.github.com/users/rmothukuru/orgs", "repos_url": "https://api.github.com/users/rmothukuru/repos", "events_url": "https://api.github.com/users/rmothukuru/events{/privacy}", "received_events_url": "https://api.github.com/users/rmothukuru/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "rmothukuru", "id": 48206667, "node_id": "MDQ6VXNlcjQ4MjA2NjY3", "avatar_url": "https://avatars3.githubusercontent.com/u/48206667?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rmothukuru", "html_url": "https://github.com/rmothukuru", "followers_url": "https://api.github.com/users/rmothukuru/followers", "following_url": "https://api.github.com/users/rmothukuru/following{/other_user}", "gists_url": "https://api.github.com/users/rmothukuru/gists{/gist_id}", "starred_url": "https://api.github.com/users/rmothukuru/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rmothukuru/subscriptions", "organizations_url": "https://api.github.com/users/rmothukuru/orgs", "repos_url": "https://api.github.com/users/rmothukuru/repos", "events_url": "https://api.github.com/users/rmothukuru/events{/privacy}", "received_events_url": "https://api.github.com/users/rmothukuru/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-11-17T14:46:21Z", "updated_at": "2019-11-18T08:33:09Z", "closed_at": null, "author_association": "NONE", "body": "\r\n\r\nTensorflow - version 2 \r\n\r\nHi All, I am trying to do bucketing my tensorflow datasets, so that I can change my batch size (dynamic batch size) based on different sequence length, so that I can exploit GPU performance better. I am using ```strategy = tf.distribute.MirroredStrategy()``` . \r\n\r\nAssume I am having 8 GPUs ```n_gpus=8```, according to mirror strategy if we are having a batch size of 16 ```batch_size=16```, it will distribute ```2 ( batch_size / n_gpus ) ``` batch datasets to each of the GPUs. Now, assume ```batch_size``` is dynamic and changing in each iteration over the ```dataset iterator```. In order to make it distributed, whenever  ```batch_size``` is not a multiple of ```n_gpus```, I will pad it and make it to the nearest possible multiple of ```n_gpus```. (If ```batch_size = 6```, I will pad with ```2 rows of zeros``` to make it ```8``` ).  Everything works well in CPUs. But when I am using ```iterator = strategy.experimental_distribute_dataset(input_data)```, things becomes difficult. I am providing the code .\r\n\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\ndef create_dummy_squad_data(max_seq_length,n,vocab_size=30000):\r\n    np.random.seed(1)\r\n    input_ids   = np.random.randint(1, vocab_size-1, (n,max_seq_length))\r\n    input_mask  = np.random.randint(0, 2, (n,max_seq_length))\r\n    token_type_ids   = np.random.randint(1, 2, (n,max_seq_length))\r\n    start_labels = np.random.randint(1, max_seq_length-1, (n))\r\n    end_labels = np.random.randint(1, max_seq_length-1, (n))\r\n\r\n    return (input_ids, input_mask, token_type_ids, start_labels, end_labels)\r\n\r\n\r\ndef map_to_dict(input_ids, input_mask, token_type_ids, start_labels, end_labels):\r\n    inputs = {}\r\n    inputs['input_ids']   = input_ids\r\n    inputs['input_mask']  = input_mask\r\n    inputs['segment_ids'] = token_type_ids\r\n\r\n    labels = {}\r\n    labels['start_positions'] = start_labels\r\n    labels['end_positions'] = end_labels\r\n\r\n    return inputs, labels\r\n\r\ndef pad_batch(inputs, labels, batch_multiple=8):\r\n    batch_size = tf.shape(inputs['input_ids'])[0]\r\n    mod = batch_size % batch_multiple\r\n    has_mod = tf.cast(tf.cast(mod, tf.bool), tf.int32)\r\n    batch_padding = batch_multiple * has_mod - mod\r\n\r\n    inputs_padded = {}\r\n    for k, feature in inputs.items():\r\n        rank = len(feature.shape)\r\n        paddings = [[0, 0] for _ in range(rank)]\r\n        paddings[0][1] = batch_padding\r\n        padded_feature = tf.pad(feature, paddings)\r\n        inputs_padded[k] = padded_feature\r\n\r\n    labels_padded = {}\r\n    for k, feature in labels.items():\r\n        rank = len(feature.shape)\r\n        paddings = [[0, 0] for _ in range(rank)]\r\n        paddings[0][1] = batch_padding\r\n        padded_feature = tf.pad(feature, paddings)\r\n        labels_padded[k] = padded_feature\r\n    return inputs_padded, labels_padded\r\n\r\n#### Main code starts from here (CPU code)\r\ninput_ids, input_mask, token_type_ids, start_labels, end_labels = create_dummy_squad_data(5, 100)\r\nd = tf.data.Dataset.from_tensor_slices((input_ids, input_mask, token_type_ids, start_labels, end_labels))\r\nd = d.map(map_to_dict)\r\n\r\nbatch_size_per_gpu = 1\r\nnum_gpus       = 8\r\n\r\nbatch_size = batch_size_per_gpu * num_gpus\r\n\r\nd = d.batch(batch_size)\r\nd = d.map(pad_batch)\r\nfor item in d:\r\n    pass\r\n```\r\nLast batch of ```item``` is having ```batch_size = 4 ( if we dont pad )```. As I am using padding, things are good\r\n\r\nSample output ( item[0]['input_ids'] )\r\n------------------------------------\r\n```\r\n<tf.Tensor: id=1801, shape=(8, 5), dtype=int64, numpy=\r\narray([[29865,  5139,  4322,  7079, 24896],\r\n       [ 2548,  1583,  7529, 14554, 21480],\r\n       [20593,  2560, 27139, 26397, 28367],\r\n       [25292, 23995, 26283,  4891, 28905],\r\n       [    0,     0,     0,     0,     0],\r\n       [    0,     0,     0,     0,     0],\r\n       [    0,     0,     0,     0,     0],\r\n       [    0,     0,     0,     0,     0]])>\r\n```\r\n\r\n#### Code in GPU ( This is what I want )\r\n\r\n````\r\n    with strategy.scope():\r\n        iterator = strategy.experimental_distribute_dataset(d)\r\n    all_batch_data = [] #### was curious to know how things work\r\n    with strategy.scope():\r\n        for batch_data in iterator:\r\n            all_batch_data.append(batch_data)\r\n            print(\"Batch  Data shape per gpus\", batch_data[0]['input_ids'].values[0].shape)\r\n````\r\nAs you see below, ```GPU [0,1,2,3]``` takes each 4 elements and padded it individually ( which was not I expected ). and ```GPU[4,5,6,7]```, not receiving anything. At the time of modeling, the last 4 GPUs, returns ```nan``` as loss, and when I am using ```strategy.reduce(tf.distribute.ReduceOp.SUM, per_replica_losses,\r\n                               axis=None)```, it becomes ```nan``` . Here, ```per_replica_losses``` is losses from ```8 GPUs```. First 4 is having values, but last 4 is ```nan```. \r\n\r\nSample output ( batch_data[0]['input_ids'])\r\n------------------------------------------\r\n\r\n```\r\n'input_ids': PerReplica:{\r\n    0 /job:localhost/replica:0/task:0/device:GPU:0: <tf.Tensor: id=123188, shape=(8, 5), dtype=int64, numpy=\r\n  array([[29865,  5139,  4322,  7079, 24896],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0]])>,\r\n    1 /job:localhost/replica:0/task:0/device:GPU:1: <tf.Tensor: id=123194, shape=(8, 5), dtype=int64, numpy=\r\n  array([[ 2548,  1583,  7529, 14554, 21480],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0]])>,\r\n    2 /job:localhost/replica:0/task:0/device:GPU:2: <tf.Tensor: id=123200, shape=(8, 5), dtype=int64, numpy=\r\n  array([[20593,  2560, 27139, 26397, 28367],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0]])>,\r\n    3 /job:localhost/replica:0/task:0/device:GPU:3: <tf.Tensor: id=123206, shape=(8, 5), dtype=int64, numpy=\r\n  array([[25292, 23995, 26283,  4891, 28905],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0],\r\n         [    0,     0,     0,     0,     0]])>,\r\n    4 /job:localhost/replica:0/task:0/device:GPU:4: <tf.Tensor: id=123214, shape=(0, 5), dtype=int64, numpy=array([], shape=(0, 5), dtype=int64)>,\r\n    5 /job:localhost/replica:0/task:0/device:GPU:5: <tf.Tensor: id=123230, shape=(0, 5), dtype=int64, numpy=array([], shape=(0, 5), dtype=int64)>,\r\n    6 /job:localhost/replica:0/task:0/device:GPU:6: <tf.Tensor: id=123246, shape=(0, 5), dtype=int64, numpy=array([], shape=(0, 5), dtype=int64)>,\r\n    7 /job:localhost/replica:0/task:0/device:GPU:7: <tf.Tensor: id=123262, shape=(0, 5), dtype=int64, numpy=array([], shape=(0, 5), dtype=int64)>\r\n  }}\r\n```\r\n\r\nExpected behaviour\r\n--------------------\r\n\r\nIf I am not using ```pad_batch```, when ```batch_size = 8```, each GPU gets ```1 dataset``` each and things are good. But, as I am having ```dynamic batch size```, all batch sizes are not multiple of ```n_gpus=8```. Now, when i am trying to make sure that, ```batch_size``` is multiple of ```n_gpus```, things get messed up. \r\n\r\nIf the last batch is 4, we pad 4 zeros to make it 8. and I expect it will be distribute to each GPU ( 1 dataset each ) and last 4 GPUs get zero padded rows each, so that they wont return ```nan``` and things are good. But, how could I achieve it. @guptapriya \r\n\r\nMight be an extension of https://github.com/tensorflow/tensorflow/issues/29975 . \r\n\r\nSorry if I confuse you with long explanation .\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34355", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34355/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34355/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34355/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34355", "id": 523973136, "node_id": "MDU6SXNzdWU1MjM5NzMxMzY=", "number": 34355, "title": "Error Massage: tensorflow.python.framework.errors_impl.UnknownError:  Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.", "user": {"login": "acseckin", "id": 3118166, "node_id": "MDQ6VXNlcjMxMTgxNjY=", "avatar_url": "https://avatars3.githubusercontent.com/u/3118166?v=4", "gravatar_id": "", "url": "https://api.github.com/users/acseckin", "html_url": "https://github.com/acseckin", "followers_url": "https://api.github.com/users/acseckin/followers", "following_url": "https://api.github.com/users/acseckin/following{/other_user}", "gists_url": "https://api.github.com/users/acseckin/gists{/gist_id}", "starred_url": "https://api.github.com/users/acseckin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/acseckin/subscriptions", "organizations_url": "https://api.github.com/users/acseckin/orgs", "repos_url": "https://api.github.com/users/acseckin/repos", "events_url": "https://api.github.com/users/acseckin/events{/privacy}", "received_events_url": "https://api.github.com/users/acseckin/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "MarkDaoust", "id": 1414837, "node_id": "MDQ6VXNlcjE0MTQ4Mzc=", "avatar_url": "https://avatars1.githubusercontent.com/u/1414837?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MarkDaoust", "html_url": "https://github.com/MarkDaoust", "followers_url": "https://api.github.com/users/MarkDaoust/followers", "following_url": "https://api.github.com/users/MarkDaoust/following{/other_user}", "gists_url": "https://api.github.com/users/MarkDaoust/gists{/gist_id}", "starred_url": "https://api.github.com/users/MarkDaoust/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MarkDaoust/subscriptions", "organizations_url": "https://api.github.com/users/MarkDaoust/orgs", "repos_url": "https://api.github.com/users/MarkDaoust/repos", "events_url": "https://api.github.com/users/MarkDaoust/events{/privacy}", "received_events_url": "https://api.github.com/users/MarkDaoust/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2019-11-17T11:40:24Z", "updated_at": "2019-12-10T19:34:18Z", "closed_at": null, "author_association": "NONE", "body": " - python version: 3.6.7\r\n - tensorflow-gpu version: 2.0.0 \r\n - keras version: 2.3.1 \r\n - cuDNN version:10.0 \r\n - CUDA version:10.0\r\n\r\n\r\nmnist_mlp.py (https://github.com/keras-team/keras/blob/master/examples/mnist_mlp.py) works perfectly but code which is given below gives me this error:\r\n\r\n```\r\n    tensorflow.python.framework.errors_impl.UnknownError:  Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above.\r\n             [[node conv2d_7/convolution (defined at C:\\Users\\ACSECKIN\\Anaconda3\\envs\\tensorflow\\lib\\site-packages\\tensorflow_core\\python\\framework\\ops.py:1751) ]] [Op:__inference_keras_scratch_graph_4815]\r\n    \r\n    Function call stack:\r\n    keras_scratch_graph\r\n```\r\n\r\nProject code derived from https://machinelearningmastery.com/how-to-develop-a-pix2pix-gan-for-image-to-image-translation/\r\n\r\ncode:\r\n\r\n    ```\r\n    from numpy import load\r\n    from numpy import zeros\r\n    from numpy import ones\r\n    from numpy.random import randint\r\n    from keras.optimizers import Adam\r\n    from keras.initializers import RandomNormal\r\n    from keras.models import Model\r\n    from keras.models import Input\r\n    from keras.layers import Conv2D\r\n    from keras.layers import Conv2DTranspose\r\n    from keras.layers import LeakyReLU\r\n    from keras.layers import Activation\r\n    from keras.layers import Concatenate\r\n    from keras.layers import Dropout\r\n    from keras.layers import BatchNormalization\r\n    from keras.layers import LeakyReLU\r\n    from matplotlib import pyplot\r\n    \r\n    # define the discriminator model\r\n    def define_discriminator(image_shape):\r\n    \t# weight initialization\r\n    \tinit = RandomNormal(stddev=0.02)\r\n    \t# source image input\r\n    \tin_src_image = Input(shape=image_shape)\r\n    \t# target image input\r\n    \tin_target_image = Input(shape=image_shape)\r\n    \t# concatenate images channel-wise\r\n    \tmerged = Concatenate()([in_src_image, in_target_image])\r\n    \t# C64\r\n    \td = Conv2D(64, (4,4), strides=(2,2), padding='same', kernel_initializer=init)(merged)\r\n    \td = LeakyReLU(alpha=0.2)(d)\r\n    \t# C128\r\n    \td = Conv2D(128, (4,4), strides=(2,2), padding='same', kernel_initializer=init)(d)\r\n    \td = BatchNormalization()(d)\r\n    \td = LeakyReLU(alpha=0.2)(d)\r\n    \t# C256\r\n    \td = Conv2D(256, (4,4), strides=(2,2), padding='same', kernel_initializer=init)(d)\r\n    \td = BatchNormalization()(d)\r\n    \td = LeakyReLU(alpha=0.2)(d)\r\n    \t# C512\r\n    \td = Conv2D(512, (4,4), strides=(2,2), padding='same', kernel_initializer=init)(d)\r\n    \td = BatchNormalization()(d)\r\n    \td = LeakyReLU(alpha=0.2)(d)\r\n    \t# second last output layer\r\n    \td = Conv2D(512, (4,4), padding='same', kernel_initializer=init)(d)\r\n    \td = BatchNormalization()(d)\r\n    \td = LeakyReLU(alpha=0.2)(d)\r\n    \t# patch output\r\n    \td = Conv2D(1, (4,4), padding='same', kernel_initializer=init)(d)\r\n    \tpatch_out = Activation('sigmoid')(d)\r\n    \t# define model\r\n    \tmodel = Model([in_src_image, in_target_image], patch_out)\r\n    \t# compile model\r\n    \topt = Adam(lr=0.0002, beta_1=0.5)\r\n    \tmodel.compile(loss='binary_crossentropy', optimizer=opt, loss_weights=[0.5])\r\n    \treturn model\r\n    \r\n    # define an encoder block\r\n    def define_encoder_block(layer_in, n_filters, batchnorm=True):\r\n    \t# weight initialization\r\n    \tinit = RandomNormal(stddev=0.02)\r\n    \t# add downsampling layer\r\n    \tg = Conv2D(n_filters, (4,4), strides=(2,2), padding='same', kernel_initializer=init)(layer_in)\r\n    \t# conditionally add batch normalization\r\n    \tif batchnorm:\r\n    \t\tg = BatchNormalization()(g, training=True)\r\n    \t# leaky relu activation\r\n    \tg = LeakyReLU(alpha=0.2)(g)\r\n    \treturn g\r\n    \r\n    # define a decoder block\r\n    def decoder_block(layer_in, skip_in, n_filters, dropout=True):\r\n    \t# weight initialization\r\n    \tinit = RandomNormal(stddev=0.02)\r\n    \t# add upsampling layer\r\n    \tg = Conv2DTranspose(n_filters, (4,4), strides=(2,2), padding='same', kernel_initializer=init)(layer_in)\r\n    \t# add batch normalization\r\n    \tg = BatchNormalization()(g, training=True)\r\n    \t# conditionally add dropout\r\n    \tif dropout:\r\n    \t\tg = Dropout(0.5)(g, training=True)\r\n    \t# merge with skip connection\r\n    \tg = Concatenate()([g, skip_in])\r\n    \t# relu activation\r\n    \tg = Activation('relu')(g)\r\n    \treturn g\r\n    \r\n    # define the standalone generator model\r\n    def define_generator(image_shape=(256,256,3)):\r\n    \t# weight initialization\r\n    \tinit = RandomNormal(stddev=0.02)\r\n    \t# image input\r\n    \tin_image = Input(shape=image_shape)\r\n    \t# encoder model\r\n    \te1 = define_encoder_block(in_image, 64, batchnorm=False)\r\n    \te2 = define_encoder_block(e1, 128)\r\n    \te3 = define_encoder_block(e2, 256)\r\n    \te4 = define_encoder_block(e3, 512)\r\n    \te5 = define_encoder_block(e4, 512)\r\n    \te6 = define_encoder_block(e5, 512)\r\n    \te7 = define_encoder_block(e6, 512)\r\n    \t# bottleneck, no batch norm and relu\r\n    \tb = Conv2D(512, (4,4), strides=(2,2), padding='same', kernel_initializer=init)(e7)\r\n    \tb = Activation('relu')(b)\r\n    \t# decoder model\r\n    \td1 = decoder_block(b, e7, 512)\r\n    \td2 = decoder_block(d1, e6, 512)\r\n    \td3 = decoder_block(d2, e5, 512)\r\n    \td4 = decoder_block(d3, e4, 512, dropout=False)\r\n    \td5 = decoder_block(d4, e3, 256, dropout=False)\r\n    \td6 = decoder_block(d5, e2, 128, dropout=False)\r\n    \td7 = decoder_block(d6, e1, 64, dropout=False)\r\n    \t# output\r\n    \tg = Conv2DTranspose(3, (4,4), strides=(2,2), padding='same', kernel_initializer=init)(d7)\r\n    \tout_image = Activation('tanh')(g)\r\n    \t# define model\r\n    \tmodel = Model(in_image, out_image)\r\n    \treturn model\r\n    \r\n    # define the combined generator and discriminator model, for updating the generator\r\n    def define_gan(g_model, d_model, image_shape):\r\n    \t# make weights in the discriminator not trainable\r\n    \td_model.trainable = False\r\n    \t# define the source image\r\n    \tin_src = Input(shape=image_shape)\r\n    \t# connect the source image to the generator input\r\n    \tgen_out = g_model(in_src)\r\n    \t# connect the source input and generator output to the discriminator input\r\n    \tdis_out = d_model([in_src, gen_out])\r\n    \t# src image as input, generated image and classification output\r\n    \tmodel = Model(in_src, [dis_out, gen_out])\r\n    \t# compile model\r\n    \topt = Adam(lr=0.0002, beta_1=0.5)\r\n    \tmodel.compile(loss=['binary_crossentropy', 'mae'], optimizer=opt, loss_weights=[1,100])\r\n    \treturn model\r\n    \r\n    # load and prepare training images\r\n    def load_real_samples(filename):\r\n    \t# load compressed arrays\r\n    \tdata = load(filename)\r\n    \t# unpack arrays\r\n    \tX1, X2 = data['arr_0'], data['arr_1']\r\n    \t# scale from [0,255] to [-1,1]\r\n    \tX1 = (X1 - 127.5) / 127.5\r\n    \tX2 = (X2 - 127.5) / 127.5\r\n    \treturn [X1, X2]\r\n    \r\n    # select a batch of random samples, returns images and target\r\n    def generate_real_samples(dataset, n_samples, patch_shape):\r\n    \t# unpack dataset\r\n    \ttrainA, trainB = dataset\r\n    \t# choose random instances\r\n    \tix = randint(0, trainA.shape[0], n_samples)\r\n    \t# retrieve selected images\r\n    \tX1, X2 = trainA[ix], trainB[ix]\r\n    \t# generate 'real' class labels (1)\r\n    \ty = ones((n_samples, patch_shape, patch_shape, 1))\r\n    \treturn [X1, X2], y\r\n    \r\n    # generate a batch of images, returns images and targets\r\n    def generate_fake_samples(g_model, samples, patch_shape):\r\n    \t# generate fake instance\r\n    \tX = g_model.predict(samples)\r\n    \t# create 'fake' class labels (0)\r\n    \ty = zeros((len(X), patch_shape, patch_shape, 1))\r\n    \treturn X, y\r\n    \r\n    # generate samples and save as a plot and save the model\r\n    def summarize_performance(step, g_model, dataset, n_samples=3):\r\n    \t# select a sample of input images\r\n    \t[X_realA, X_realB], _ = generate_real_samples(dataset, n_samples, 1)\r\n    \t# generate a batch of fake samples\r\n    \tX_fakeB, _ = generate_fake_samples(g_model, X_realA, 1)\r\n    \t# scale all pixels from [-1,1] to [0,1]\r\n    \tX_realA = (X_realA + 1) / 2.0\r\n    \tX_realB = (X_realB + 1) / 2.0\r\n    \tX_fakeB = (X_fakeB + 1) / 2.0\r\n    \t# plot real source images\r\n    \tfor i in range(n_samples):\r\n    \t\tpyplot.subplot(3, n_samples, 1 + i)\r\n    \t\tpyplot.axis('off')\r\n    \t\tpyplot.imshow(X_realA[i])\r\n    \t# plot generated target image\r\n    \tfor i in range(n_samples):\r\n    \t\tpyplot.subplot(3, n_samples, 1 + n_samples + i)\r\n    \t\tpyplot.axis('off')\r\n    \t\tpyplot.imshow(X_fakeB[i])\r\n    \t# plot real target image\r\n    \tfor i in range(n_samples):\r\n    \t\tpyplot.subplot(3, n_samples, 1 + n_samples*2 + i)\r\n    \t\tpyplot.axis('off')\r\n    \t\tpyplot.imshow(X_realB[i])\r\n    \t# save plot to file\r\n    \tfilename1 = 'plot_%06d.png' % (step+1)\r\n    \tpyplot.savefig(filename1)\r\n    \tpyplot.close()\r\n    \t# save the generator model\r\n    \tfilename2 = 'model_%06d.h5' % (step+1)\r\n    \tg_model.save(filename2)\r\n    \tprint('>Saved: %s and %s' % (filename1, filename2))\r\n    \r\n    # train pix2pix models\r\n    def train(d_model, g_model, gan_model, dataset, n_epochs=50, n_batch=1):\r\n    \t# determine the output square shape of the discriminator\r\n    \tn_patch = d_model.output_shape[1]\r\n    \t# unpack dataset\r\n    \ttrainA, trainB = dataset\r\n    \t# calculate the number of batches per training epoch\r\n    \tbat_per_epo = int(len(trainA) / n_batch)\r\n    \t# calculate the number of training iterations\r\n    \tn_steps = bat_per_epo * n_epochs\r\n    \t# manually enumerate epochs\r\n    \tfor i in range(n_steps):\r\n    \t\t# select a batch of real samples\r\n    \t\t[X_realA, X_realB], y_real = generate_real_samples(dataset, n_batch, n_patch)\r\n    \t\t# generate a batch of fake samples\r\n    \t\tX_fakeB, y_fake = generate_fake_samples(g_model, X_realA, n_patch)\r\n    \t\t# update discriminator for real samples\r\n    \t\td_loss1 = d_model.train_on_batch([X_realA, X_realB], y_real)\r\n    \t\t# update discriminator for generated samples\r\n    \t\td_loss2 = d_model.train_on_batch([X_realA, X_fakeB], y_fake)\r\n    \t\t# update the generator\r\n    \t\tg_loss, _, _ = gan_model.train_on_batch(X_realA, [y_real, X_realB])\r\n    \t\t# summarize performance\r\n    \t\tprint('>%d, d1[%.3f] d2[%.3f] g[%.3f]' % (i+1, d_loss1, d_loss2, g_loss))\r\n    \t\t# summarize model performance\r\n    \t\tif (i+1) % (bat_per_epo * 10) == 0:\r\n    \t\t\tsummarize_performance(i, g_model, dataset)\r\n    \r\n    \r\n    # load image data\r\n    dataset = load_real_samples('fabric_256.npz')\r\n    print('Loaded', dataset[0].shape, dataset[1].shape)\r\n    # define input shape based on the loaded dataset\r\n    image_shape = dataset[0].shape[1:]\r\n    # define the models\r\n    d_model = define_discriminator(image_shape)\r\n    g_model = define_generator(image_shape)\r\n    # define the composite model\r\n    gan_model = define_gan(g_model, d_model, image_shape)\r\n    # train model\r\n    train(d_model, g_model, gan_model, dataset)\r\n\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34353", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34353/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34353/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34353/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34353", "id": 523966146, "node_id": "MDU6SXNzdWU1MjM5NjYxNDY=", "number": 34353, "title": "Merging two RT graphs throughs an error", "user": {"login": "anshkumar", "id": 8944361, "node_id": "MDQ6VXNlcjg5NDQzNjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/8944361?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anshkumar", "html_url": "https://github.com/anshkumar", "followers_url": "https://api.github.com/users/anshkumar/followers", "following_url": "https://api.github.com/users/anshkumar/following{/other_user}", "gists_url": "https://api.github.com/users/anshkumar/gists{/gist_id}", "starred_url": "https://api.github.com/users/anshkumar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anshkumar/subscriptions", "organizations_url": "https://api.github.com/users/anshkumar/orgs", "repos_url": "https://api.github.com/users/anshkumar/repos", "events_url": "https://api.github.com/users/anshkumar/events{/privacy}", "received_events_url": "https://api.github.com/users/anshkumar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 1754777628, "node_id": "MDU6TGFiZWwxNzU0Nzc3NjI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu:tensorrt", "name": "comp:gpu:tensorrt", "color": "ea98ba", "default": false, "description": "Issues specific to TensorRT"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "sanjoy", "id": 136291, "node_id": "MDQ6VXNlcjEzNjI5MQ==", "avatar_url": "https://avatars2.githubusercontent.com/u/136291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanjoy", "html_url": "https://github.com/sanjoy", "followers_url": "https://api.github.com/users/sanjoy/followers", "following_url": "https://api.github.com/users/sanjoy/following{/other_user}", "gists_url": "https://api.github.com/users/sanjoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanjoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanjoy/subscriptions", "organizations_url": "https://api.github.com/users/sanjoy/orgs", "repos_url": "https://api.github.com/users/sanjoy/repos", "events_url": "https://api.github.com/users/sanjoy/events{/privacy}", "received_events_url": "https://api.github.com/users/sanjoy/received_events", "type": "User", "site_admin": false}, {"login": "aaroey", "id": 31743510, "node_id": "MDQ6VXNlcjMxNzQzNTEw", "avatar_url": "https://avatars0.githubusercontent.com/u/31743510?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aaroey", "html_url": "https://github.com/aaroey", "followers_url": "https://api.github.com/users/aaroey/followers", "following_url": "https://api.github.com/users/aaroey/following{/other_user}", "gists_url": "https://api.github.com/users/aaroey/gists{/gist_id}", "starred_url": "https://api.github.com/users/aaroey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aaroey/subscriptions", "organizations_url": "https://api.github.com/users/aaroey/orgs", "repos_url": "https://api.github.com/users/aaroey/repos", "events_url": "https://api.github.com/users/aaroey/events{/privacy}", "received_events_url": "https://api.github.com/users/aaroey/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-11-17T10:32:42Z", "updated_at": "2019-12-26T18:34:21Z", "closed_at": null, "author_association": "NONE", "body": "I want to merge two RT graphs into a single graph. But while merging I'm getting error.\r\nMy code is as follows:\r\n\r\n```\r\nimport tensorflow as tf\r\nfrom tensorflow.python.compiler.tensorrt import trt_convert as trt\r\n\r\nsaved_model1 = \"/home/xavier2/saved_model/ssd_tomato_l1\"\r\nsaved_model2 = \"/home/xavier2/saved_model/faster_rcnn_tomato_l2_grid_750x750\"\r\n\r\ndef create_trt_inference_graph(graph_path):\r\n    converter = trt.TrtGraphConverter(input_saved_model_dir=graph_path , \r\n        precision_mode=trt.TrtPrecisionMode.FP16)\r\n    converted_graph_def = converter.convert()\r\n    return converted_graph_def\r\n\r\ndef get_serialized_graph(graph_path):\r\n    converted_graph_def = create_trt_inference_graph(graph_path)\r\n    serial_def = converted_graph_def.SerializeToString()\r\n    return serial_def\r\n\r\ndef get_frozen_graph(graph_path):\r\n    graph_def = tf.GraphDef()\r\n    graph_def.ParseFromString(get_serialized_graph(graph_path))\r\n    return graph_def\r\n\r\ndef rename_frame_name(graphdef, suffix):\r\n    # Bug reported at https://github.com/tensorflow/tensorflow/issues/22162#issuecomment-428091121\r\n    for n in graphdef.node:\r\n        if \"while\" in n.name:\r\n            if \"frame_name\" in n.attr:\r\n                n.attr[\"frame_name\"].s = str(n.attr[\"frame_name\"]).replace(\"while_context\",\"while_context\" + suffix).encode('utf-8')\r\n\r\nl1_graph = tf.Graph()\r\nwith l1_graph.as_default():\r\n    trt_graph1 = get_frozen_graph(saved_model1)\r\n    [tf_input1, tf_scores1, tf_boxes1, tf_classes1, tf_num_detections1] = tf.import_graph_def(trt_graph1, \r\n            return_elements=['import/image_tensor:0', 'import/detection_scores:0', 'import/detection_boxes:0', 'import/detection_classes:0','import/num_detections:0'])\r\n\r\nconnected_graph = tf.Graph()\r\nwith connected_graph.as_default():\r\n    l1_graph_def = l1_graph.as_graph_def()\r\n    g1name = 'ved'\r\n    rename_frame_name(l1_graph_def, g1name)\r\n    tf.import_graph_def(l1_graph_def, name=g1name)\r\n    trt_graph2 = get_frozen_graph(saved_model2)\r\n    g2name = 'level2'\r\n    rename_frame_name(trt_graph2, g2name)\r\n    [tf_scores, tf_boxes, tf_classes, tf_num_detections] = tf.import_graph_def(trt_graph2,\r\n            return_elements=['import/detection_scores:0', 'import/detection_boxes:0', 'import/detection_classes:0','import/num_detections:0'])\r\n```\r\n\r\nIt throws following error:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/importer.py\", line 427, in import_graph_def\r\n    graph._c_graph, serialized, options)  # pylint: disable=protected-access\r\ntensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot add function 'TRTEngineOp_1_native_segment' because a different function with the same name already exists.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 10, in <module>\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/util/deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/importer.py\", line 431, in import_graph_def\r\n    raise ValueError(str(e))\r\nValueError: Cannot add function 'TRTEngineOp_1_native_segment' because a different function with the same name already exists.\r\n```\r\n\r\nMy specs are:\r\n\r\nTensorflow: 1.14.0\r\nPython: 3.6.8\r\nPlatform: Ubuntu 18.04.2 LTS (GNU/Linux 4.9.140-tegra aarch64)"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34349", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34349/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34349/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34349/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34349", "id": 523937581, "node_id": "MDU6SXNzdWU1MjM5Mzc1ODE=", "number": 34349, "title": "Serialization support for RaggedTensor", "user": {"login": "MikeOfZen", "id": 28424677, "node_id": "MDQ6VXNlcjI4NDI0Njc3", "avatar_url": "https://avatars2.githubusercontent.com/u/28424677?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MikeOfZen", "html_url": "https://github.com/MikeOfZen", "followers_url": "https://api.github.com/users/MikeOfZen/followers", "following_url": "https://api.github.com/users/MikeOfZen/following{/other_user}", "gists_url": "https://api.github.com/users/MikeOfZen/gists{/gist_id}", "starred_url": "https://api.github.com/users/MikeOfZen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MikeOfZen/subscriptions", "organizations_url": "https://api.github.com/users/MikeOfZen/orgs", "repos_url": "https://api.github.com/users/MikeOfZen/repos", "events_url": "https://api.github.com/users/MikeOfZen/events{/privacy}", "received_events_url": "https://api.github.com/users/MikeOfZen/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "edloper", "id": 5790348, "node_id": "MDQ6VXNlcjU3OTAzNDg=", "avatar_url": "https://avatars1.githubusercontent.com/u/5790348?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edloper", "html_url": "https://github.com/edloper", "followers_url": "https://api.github.com/users/edloper/followers", "following_url": "https://api.github.com/users/edloper/following{/other_user}", "gists_url": "https://api.github.com/users/edloper/gists{/gist_id}", "starred_url": "https://api.github.com/users/edloper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edloper/subscriptions", "organizations_url": "https://api.github.com/users/edloper/orgs", "repos_url": "https://api.github.com/users/edloper/repos", "events_url": "https://api.github.com/users/edloper/events{/privacy}", "received_events_url": "https://api.github.com/users/edloper/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "edloper", "id": 5790348, "node_id": "MDQ6VXNlcjU3OTAzNDg=", "avatar_url": "https://avatars1.githubusercontent.com/u/5790348?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edloper", "html_url": "https://github.com/edloper", "followers_url": "https://api.github.com/users/edloper/followers", "following_url": "https://api.github.com/users/edloper/following{/other_user}", "gists_url": "https://api.github.com/users/edloper/gists{/gist_id}", "starred_url": "https://api.github.com/users/edloper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edloper/subscriptions", "organizations_url": "https://api.github.com/users/edloper/orgs", "repos_url": "https://api.github.com/users/edloper/repos", "events_url": "https://api.github.com/users/edloper/events{/privacy}", "received_events_url": "https://api.github.com/users/edloper/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-11-17T05:18:30Z", "updated_at": "2019-11-18T20:00:08Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- TensorFlow version (you are using):2.0.0\r\n- Are you willing to contribute it (Yes/No):No\r\n\r\n**Describe the feature and the current behavior/state.**\r\nCurrently, there is no support for serializing RaggedTensors similiraly to tf.io.serialize_tensor\r\n\r\n**Will this change the current api? How?**\r\nThis shouldn't affect any other functionality\r\n\r\n**Who will benefit with this feature?**\r\nUsers of ragged tensors wishing to use TFrecords\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34346", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34346/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34346/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34346/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34346", "id": 523912724, "node_id": "MDU6SXNzdWU1MjM5MTI3MjQ=", "number": 34346, "title": "ImageDataGenerator does not work with tpu", "user": {"login": "Shiro-LK", "id": 26505641, "node_id": "MDQ6VXNlcjI2NTA1NjQx", "avatar_url": "https://avatars0.githubusercontent.com/u/26505641?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Shiro-LK", "html_url": "https://github.com/Shiro-LK", "followers_url": "https://api.github.com/users/Shiro-LK/followers", "following_url": "https://api.github.com/users/Shiro-LK/following{/other_user}", "gists_url": "https://api.github.com/users/Shiro-LK/gists{/gist_id}", "starred_url": "https://api.github.com/users/Shiro-LK/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Shiro-LK/subscriptions", "organizations_url": "https://api.github.com/users/Shiro-LK/orgs", "repos_url": "https://api.github.com/users/Shiro-LK/repos", "events_url": "https://api.github.com/users/Shiro-LK/events{/privacy}", "received_events_url": "https://api.github.com/users/Shiro-LK/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 1097541661, "node_id": "MDU6TGFiZWwxMDk3NTQxNjYx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tpus", "name": "comp:tpus", "color": "0052cc", "default": false, "description": "tpu, tpuestimator"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jsimsa", "id": 1072079, "node_id": "MDQ6VXNlcjEwNzIwNzk=", "avatar_url": "https://avatars2.githubusercontent.com/u/1072079?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsimsa", "html_url": "https://github.com/jsimsa", "followers_url": "https://api.github.com/users/jsimsa/followers", "following_url": "https://api.github.com/users/jsimsa/following{/other_user}", "gists_url": "https://api.github.com/users/jsimsa/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsimsa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsimsa/subscriptions", "organizations_url": "https://api.github.com/users/jsimsa/orgs", "repos_url": "https://api.github.com/users/jsimsa/repos", "events_url": "https://api.github.com/users/jsimsa/events{/privacy}", "received_events_url": "https://api.github.com/users/jsimsa/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 40, "created_at": "2019-11-17T00:03:21Z", "updated_at": "2020-03-17T00:15:26Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):\r\nYes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Colab\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): tensorflow from colab\r\n- TensorFlow version (use command below): 1.15\r\n- Python version: 3.6.7\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version: None\r\n- GPU model and memory: None\r\n\r\nYou can collect some of this information using our environment capture\r\n[script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)\r\nYou can also obtain the TensorFlow version with: 1. TF 1.0: `python -c \"import\r\ntensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)\"` 2. TF 2.0: `python -c\r\n\"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"`\r\n\r\n**Describe the current behavior**\r\nCurrently it is not possible to use fit_generator. Instead we need to use .fit function.\r\n\r\nUsing ImageDataGenetor, I tried to fit the model but I got an issue :\r\n```\r\nAssertionError                            Traceback (most recent call last)\r\n\r\n<ipython-input-18-46d4a00b20c5> in <module>()\r\n      5      train_gen.flow(X_train, y_train, batch_size=batch_size), # tf.data.Dataset.from_tensor_slices((X_train[:2000], y_train[:2000])).batch(batch_size).repeat(), #\r\n      6     steps_per_epoch=  len(X_train)//batch_size,\r\n----> 7     epochs=3,\r\n      8      )\r\n\r\n2 frames\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training.py in fit(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_freq, max_queue_size, workers, use_multiprocessing, **kwargs)\r\n    725         max_queue_size=max_queue_size,\r\n    726         workers=workers,\r\n--> 727         use_multiprocessing=use_multiprocessing)\r\n    728 \r\n    729   def evaluate(self,\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_distributed.py in fit(self, model, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_freq, **kwargs)\r\n    617         validation_split=validation_split,\r\n    618         shuffle=shuffle,\r\n--> 619         epochs=epochs)\r\n    620     if not dist_utils.is_distributing_by_cloning(model):\r\n    621       with model._distribution_strategy.scope():\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training.py in _distribution_standardize_user_data(self, x, y, sample_weight, class_weight, batch_size, validation_split, shuffle, epochs, allow_partial_batch)\r\n   2312         x = ds.batch(batch_size, drop_remainder=drop_remainder)\r\n   2313       else:\r\n-> 2314         assert isinstance(x, dataset_ops.DatasetV2)\r\n   2315         training_utils.validate_dataset_input(x, y, sample_weight,\r\n   2316                                               validation_split)\r\n\r\nAssertionError: \r\n```\r\n\r\n\r\n**Describe the expected behavior**\r\nfrom the keras documentation, it should work. \r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\nHere the link to the colab code : https://colab.research.google.com/drive/1bdNfb127n-VI6ab9_sUTOgRzkil88a9n\r\n**Other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n\r\nDoes that mean we cannot use generator with tensorflow 1.15 ? "}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34345", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34345/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34345/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34345/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34345", "id": 523909772, "node_id": "MDU6SXNzdWU1MjM5MDk3NzI=", "number": 34345, "title": "TFLite allocate tensors fails: (CONCATENATION) failed to prepare after input shape resize", "user": {"login": "Angtrim", "id": 4083396, "node_id": "MDQ6VXNlcjQwODMzOTY=", "avatar_url": "https://avatars3.githubusercontent.com/u/4083396?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Angtrim", "html_url": "https://github.com/Angtrim", "followers_url": "https://api.github.com/users/Angtrim/followers", "following_url": "https://api.github.com/users/Angtrim/following{/other_user}", "gists_url": "https://api.github.com/users/Angtrim/gists{/gist_id}", "starred_url": "https://api.github.com/users/Angtrim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Angtrim/subscriptions", "organizations_url": "https://api.github.com/users/Angtrim/orgs", "repos_url": "https://api.github.com/users/Angtrim/repos", "events_url": "https://api.github.com/users/Angtrim/events{/privacy}", "received_events_url": "https://api.github.com/users/Angtrim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-11-16T23:28:45Z", "updated_at": "2020-02-05T16:16:01Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):  **Yes**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): **OSX**\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: **No**\r\n- TensorFlow installed from (source or binary): **binary** \r\n- TensorFlow version (use command below):  **2.1.0-dev20191113**\r\n- Python version: **3.7.4**\r\n\r\n**Describe the current behavior**\r\n\r\nI create a fully convolutional simple model using tf.keras API.\r\nI convert the model to TFlite.\r\nI resize the shape of the input tensor, but when I ask the interpreter to allocate the tensors, I get this error:\r\n\r\n`RuntimeError: tensorflow/lite/kernels/concatenation.cc:74 t->dims->data[d] != t0->dims->data[d] (24 != 52)Node number 12 (CONCATENATION) failed to prepare.\r\n`\r\n\r\n**Describe the expected behavior**\r\n\r\nI expect the interpreter to be able to resize all the tensors.\r\nBelow you can find the simple model I've built to reproduce this issue.\r\nWhat I've notice is that without the `Concatenate` op the allocation works correctly.\r\n\r\n**Code to reproduce the issue**\r\n\r\n```\r\nfrom tensorflow.keras.layers import Conv2D, UpSampling2D, LeakyReLU, Concatenate\r\nfrom tensorflow.keras import Model, layers\r\nfrom tensorflow import keras\r\nimport tensorflow as tf\r\n\r\n# Encoder\r\nencoder_input = keras.Input(shape=(28, 28, 1), name='img')\r\nconv1 = layers.Conv2D(16, 3, activation='relu')(encoder_input)\r\nconv2 = layers.Conv2D(32, 3, activation='relu')(conv1)\r\nmax1 = layers.MaxPooling2D(3)(conv2)\r\nconv3 = layers.Conv2D(32, 3, activation='relu')(max1)\r\nconv4 = layers.Conv2D(16, 3, activation='relu')(conv3)\r\nencoder_output = layers.GlobalMaxPooling2D()(conv4)\r\nencoder = keras.Model(encoder_input, encoder_output, name='encoder')\r\n\r\n# Decoder\r\nresh = layers.Reshape((4, 4, 1))(encoder_output)\r\nupconv1 = layers.Conv2DTranspose(16, 3, activation='relu')(resh)\r\nupconv2 = layers.Conv2DTranspose(32, 3, activation='relu')(upconv1)\r\nupsample = layers.UpSampling2D(3)(upconv2)\r\nconc = layers.Concatenate()([conv2,upsample])\r\nconv5 = layers.Conv2DTranspose(16, 3, activation='relu')(conc)\r\ndecoder_output = layers.Conv2DTranspose(1, 3, activation='relu')(conv5)\r\n\r\n# autoencoder\r\nautoencoder = keras.Model(encoder_input, decoder_output, name='autoencoder')\r\n\r\n# conversion\r\nconverter = tf.lite.TFLiteConverter.from_keras_model(autoencoder)\r\ntflite_model = converter.convert()\r\nopen(\"model.tflite\", \"wb\").write(tflite_model)\r\n\r\n# inference\r\ninterpreter = tf.lite.Interpreter(model_path=\"model.tflite\")\r\ninput_details = interpreter.get_input_details()\r\ninterpreter.resize_tensor_input(input_details[0][\"index\"],[1,56,56,1])\r\ninterpreter.allocate_tensors()\r\n```\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34335", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34335/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34335/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34335/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34335", "id": 523814854, "node_id": "MDU6SXNzdWU1MjM4MTQ4NTQ=", "number": 34335, "title": "[TF 2.0] Nested Gradient Tape - unconnected graphs", "user": {"login": "janbolle", "id": 1223186, "node_id": "MDQ6VXNlcjEyMjMxODY=", "avatar_url": "https://avatars2.githubusercontent.com/u/1223186?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janbolle", "html_url": "https://github.com/janbolle", "followers_url": "https://api.github.com/users/janbolle/followers", "following_url": "https://api.github.com/users/janbolle/following{/other_user}", "gists_url": "https://api.github.com/users/janbolle/gists{/gist_id}", "starred_url": "https://api.github.com/users/janbolle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janbolle/subscriptions", "organizations_url": "https://api.github.com/users/janbolle/orgs", "repos_url": "https://api.github.com/users/janbolle/repos", "events_url": "https://api.github.com/users/janbolle/events{/privacy}", "received_events_url": "https://api.github.com/users/janbolle/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "pavithrasv", "id": 13326758, "node_id": "MDQ6VXNlcjEzMzI2NzU4", "avatar_url": "https://avatars0.githubusercontent.com/u/13326758?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pavithrasv", "html_url": "https://github.com/pavithrasv", "followers_url": "https://api.github.com/users/pavithrasv/followers", "following_url": "https://api.github.com/users/pavithrasv/following{/other_user}", "gists_url": "https://api.github.com/users/pavithrasv/gists{/gist_id}", "starred_url": "https://api.github.com/users/pavithrasv/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pavithrasv/subscriptions", "organizations_url": "https://api.github.com/users/pavithrasv/orgs", "repos_url": "https://api.github.com/users/pavithrasv/repos", "events_url": "https://api.github.com/users/pavithrasv/events{/privacy}", "received_events_url": "https://api.github.com/users/pavithrasv/received_events", "type": "User", "site_admin": false}, {"login": "gadagashwini", "id": 48476109, "node_id": "MDQ6VXNlcjQ4NDc2MTA5", "avatar_url": "https://avatars3.githubusercontent.com/u/48476109?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gadagashwini", "html_url": "https://github.com/gadagashwini", "followers_url": "https://api.github.com/users/gadagashwini/followers", "following_url": "https://api.github.com/users/gadagashwini/following{/other_user}", "gists_url": "https://api.github.com/users/gadagashwini/gists{/gist_id}", "starred_url": "https://api.github.com/users/gadagashwini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gadagashwini/subscriptions", "organizations_url": "https://api.github.com/users/gadagashwini/orgs", "repos_url": "https://api.github.com/users/gadagashwini/repos", "events_url": "https://api.github.com/users/gadagashwini/events{/privacy}", "received_events_url": "https://api.github.com/users/gadagashwini/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2019-11-16T08:25:20Z", "updated_at": "2020-03-19T07:31:37Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution: MacOS 10.15.1\r\n- TensorFlow installed from binary (pip 19.3.1)\r\n- TensorFlow version: v2.0.0-rc2-26-g64c3d382ca 2.0.0\r\n- Python version: Python 3.6.5\r\n\r\n**Describe the current behavior**\r\nA copy of my model (model_copy) should be trained one step, then I need my meta_model to be trained with the loss of my model_copy. It seems, that the graphs are unconnected.\r\nIt only works, if I use the meta_model for the training step.\r\n\r\n**Describe the expected behavior**\r\nI would expect, that model_copy is known to both gradient tapes and can be used w/o using meta_model.\r\n\r\n**Code to reproduce the issue**\r\n```python\r\nimport tensorflow as tf\r\nimport tensorflow.keras.backend as keras_backend\r\nimport tensorflow.keras as keras\r\n\r\nclass MetaModel(keras.Model):\r\n    def __init__(self):\r\n        super().__init__()\r\n        self.hidden1 = keras.layers.Dense(5, input_shape=(1,))\r\n        self.out = keras.layers.Dense(1)\r\n    def forward(self, x):\r\n        x = keras.activations.relu(self.hidden1(x))\r\n        x = self.out(x)\r\n        return x\r\n\r\ndef copy_model(model, x):\r\n    copied_model = MetaModel()\r\n    copied_model.forward(x)\r\n    copied_model.set_weights(model.get_weights())\r\n    return copied_model\r\n\r\ndef compute_loss(model, x, y):\r\n    logits = model.forward(x)  # prediction of my model\r\n    mse = keras_backend.mean(keras.losses.mean_squared_error(y, logits))  # compute loss between prediciton and label/truth\r\n    return mse, logits\r\n\r\noptimizer_outer = keras.optimizers.Adam()\r\nalpha = 0.01\r\nwith tf.GradientTape() as g:\r\n    # meta_model to learn in outer gradient tape\r\n    meta_model = MetaModel()\r\n    # inputs for training\r\n    x = tf.constant(3.0, shape=(1, 1, 1))\r\n    y = tf.constant(3.0, shape=(1, 1, 1))\r\n\r\n    meta_model.forward(x)\r\n    model_copy = copy_model(meta_model, x)\r\n    with tf.GradientTape() as gg:\r\n        loss, _ = compute_loss(model_copy, x, y)\r\n        gradients = gg.gradient(loss, model_copy.trainable_variables)\r\n        k = 0\r\n        for layer in range(len(model_copy.layers)):\r\n            \"\"\" If I use meta-model for updating, this works \"\"\"\r\n            # model_copy.layers[layer].kernel = tf.subtract(meta_model.layers[layer].kernel,\r\n            #                                               tf.multiply(alpha, gradients[k]))\r\n            # model_copy.layers[layer].bias = tf.subtract(meta_model.layers[layer].bias,\r\n            #                                             tf.multiply(alpha, gradients[k + 1]))\r\n\r\n            \"\"\" If I use model-copy for updating instead, gradients_meta always will be [None,None,...]\"\"\"\r\n            model_copy.layers[layer].kernel = tf.subtract(model_copy.layers[layer].kernel,\r\n                                                          tf.multiply(alpha, gradients[k]))\r\n            model_copy.layers[layer].bias = tf.subtract(model_copy.layers[layer].bias,\r\n                                                        tf.multiply(alpha, gradients[k + 1]))\r\n\r\n            k += 2\r\n\r\n    # calculate loss of model_copy\r\n    test_loss, _ = compute_loss(model_copy, x, y)\r\n    # build gradients for meta_model update\r\n    gradients_meta = g.gradient(test_loss, meta_model.trainable_variables)\r\n    \"\"\" gradients always None !?!!11 elf \"\"\"\r\n    optimizer_outer.apply_gradients(zip(gradients_meta, meta_model.trainable_variables))\r\n```\r\n\r\n**Other info / logs**\r\nIs it intended to work as above? This would force me not to be able to use a different optimizer in the inner loop, as the networks need somehow to be connected.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34334", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34334/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34334/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34334/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34334", "id": 523805320, "node_id": "MDU6SXNzdWU1MjM4MDUzMjA=", "number": 34334, "title": "default installed version of tensorflow lite arduino library is pre-compiled, causing confusing error reports", "user": {"login": "ladyada", "id": 1214161, "node_id": "MDQ6VXNlcjEyMTQxNjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/1214161?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ladyada", "html_url": "https://github.com/ladyada", "followers_url": "https://api.github.com/users/ladyada/followers", "following_url": "https://api.github.com/users/ladyada/following{/other_user}", "gists_url": "https://api.github.com/users/ladyada/gists{/gist_id}", "starred_url": "https://api.github.com/users/ladyada/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ladyada/subscriptions", "organizations_url": "https://api.github.com/users/ladyada/orgs", "repos_url": "https://api.github.com/users/ladyada/repos", "events_url": "https://api.github.com/users/ladyada/events{/privacy}", "received_events_url": "https://api.github.com/users/ladyada/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 1589976566, "node_id": "MDU6TGFiZWwxNTg5OTc2NTY2", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:micro", "name": "comp:micro", "color": "3e2eea", "default": false, "description": "Related to TensorFlow Lite Microcontrollers"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "petewarden", "id": 161459, "node_id": "MDQ6VXNlcjE2MTQ1OQ==", "avatar_url": "https://avatars0.githubusercontent.com/u/161459?v=4", "gravatar_id": "", "url": "https://api.github.com/users/petewarden", "html_url": "https://github.com/petewarden", "followers_url": "https://api.github.com/users/petewarden/followers", "following_url": "https://api.github.com/users/petewarden/following{/other_user}", "gists_url": "https://api.github.com/users/petewarden/gists{/gist_id}", "starred_url": "https://api.github.com/users/petewarden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/petewarden/subscriptions", "organizations_url": "https://api.github.com/users/petewarden/orgs", "repos_url": "https://api.github.com/users/petewarden/repos", "events_url": "https://api.github.com/users/petewarden/events{/privacy}", "received_events_url": "https://api.github.com/users/petewarden/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-11-16T07:02:38Z", "updated_at": "2019-12-16T21:33:29Z", "closed_at": null, "author_association": "NONE", "body": "hiya @petewarden ive been re-porting my demos (hooray) for Arduino boards\r\nhttps://learn.adafruit.com/tensorflow-lite-for-edgebadge-kit-quickstart\r\n\r\nright now when folks install the TensorFlow library it defaults to the pre-compiled version, which causes very obscure errors about register arguments if they are not using the exact same processor.\r\n\r\nhttps://learn.adafruit.com/tensorflow-lite-for-edgebadge-kit-quickstart/troubleshooting#uses-vfp-register-arguments-and-libtensorflowlite-dot-a-does-not-error-10-2\r\n\r\nplease make the default non-pre-compiled...Arduino IDE has a huge collection of supported boards, and as is, will confuse a lot of people :)"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34332", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34332/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34332/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34332/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34332", "id": 523780093, "node_id": "MDU6SXNzdWU1MjM3ODAwOTM=", "number": 34332, "title": "AutoCastVariable.assign returns wrapped variable instead of casted version", "user": {"login": "lgeiger", "id": 13285808, "node_id": "MDQ6VXNlcjEzMjg1ODA4", "avatar_url": "https://avatars1.githubusercontent.com/u/13285808?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lgeiger", "html_url": "https://github.com/lgeiger", "followers_url": "https://api.github.com/users/lgeiger/followers", "following_url": "https://api.github.com/users/lgeiger/following{/other_user}", "gists_url": "https://api.github.com/users/lgeiger/gists{/gist_id}", "starred_url": "https://api.github.com/users/lgeiger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lgeiger/subscriptions", "organizations_url": "https://api.github.com/users/lgeiger/orgs", "repos_url": "https://api.github.com/users/lgeiger/repos", "events_url": "https://api.github.com/users/lgeiger/events{/privacy}", "received_events_url": "https://api.github.com/users/lgeiger/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "reedwm", "id": 6510203, "node_id": "MDQ6VXNlcjY1MTAyMDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6510203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedwm", "html_url": "https://github.com/reedwm", "followers_url": "https://api.github.com/users/reedwm/followers", "following_url": "https://api.github.com/users/reedwm/following{/other_user}", "gists_url": "https://api.github.com/users/reedwm/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedwm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedwm/subscriptions", "organizations_url": "https://api.github.com/users/reedwm/orgs", "repos_url": "https://api.github.com/users/reedwm/repos", "events_url": "https://api.github.com/users/reedwm/events{/privacy}", "received_events_url": "https://api.github.com/users/reedwm/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "reedwm", "id": 6510203, "node_id": "MDQ6VXNlcjY1MTAyMDM=", "avatar_url": "https://avatars2.githubusercontent.com/u/6510203?v=4", "gravatar_id": "", "url": "https://api.github.com/users/reedwm", "html_url": "https://github.com/reedwm", "followers_url": "https://api.github.com/users/reedwm/followers", "following_url": "https://api.github.com/users/reedwm/following{/other_user}", "gists_url": "https://api.github.com/users/reedwm/gists{/gist_id}", "starred_url": "https://api.github.com/users/reedwm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/reedwm/subscriptions", "organizations_url": "https://api.github.com/users/reedwm/orgs", "repos_url": "https://api.github.com/users/reedwm/repos", "events_url": "https://api.github.com/users/reedwm/events{/privacy}", "received_events_url": "https://api.github.com/users/reedwm/received_events", "type": "User", "site_admin": false}, {"login": "goldiegadde", "id": 43185254, "node_id": "MDQ6VXNlcjQzMTg1MjU0", "avatar_url": "https://avatars2.githubusercontent.com/u/43185254?v=4", "gravatar_id": "", "url": "https://api.github.com/users/goldiegadde", "html_url": "https://github.com/goldiegadde", "followers_url": "https://api.github.com/users/goldiegadde/followers", "following_url": "https://api.github.com/users/goldiegadde/following{/other_user}", "gists_url": "https://api.github.com/users/goldiegadde/gists{/gist_id}", "starred_url": "https://api.github.com/users/goldiegadde/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/goldiegadde/subscriptions", "organizations_url": "https://api.github.com/users/goldiegadde/orgs", "repos_url": "https://api.github.com/users/goldiegadde/repos", "events_url": "https://api.github.com/users/goldiegadde/events{/privacy}", "received_events_url": "https://api.github.com/users/goldiegadde/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 16, "created_at": "2019-11-16T03:00:36Z", "updated_at": "2020-03-16T21:18:33Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): macOS\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 2.0.0, 2.1-nightly\r\n- Python version: 3.7\r\n\r\n**Describe the current behavior**\r\n\r\n`AutoCastVariable` variable forwards `assign` and `scatter` to the underlying `float32` variable:\r\nhttps://github.com/tensorflow/tensorflow/blob/cee2a43b8184e92ba26ec0e3d6e00a3f8ca6e3c8/tensorflow/python/keras/mixed_precision/experimental/autocast_variable.py#L187-L188\r\nThus, the return value of `assign` methods with `read_value=True` is a normal `tf.Variable` and not an `AutoCastVariable`. This means that calculations directly depending on the assign operation, might run in `float32` instead of `float16`, or am I missing something?\r\n\r\n**Describe the expected behavior**\r\n`AutoCastVariable.assign*` should return an `AutoCastVariable` variable instead `tf.Variable` so that the `dtype` is preserved.\r\n\r\n@reedwm Is this intended behaviour?\r\n\r\n**Code to reproduce the issue**\r\n```python\r\nimport tensorflow as tf\r\nfrom tensorflow.python.keras.mixed_precision.experimental import autocast_variable\r\n\r\nvar = tf.Variable(0., dtype=tf.float32)\r\nvar = autocast_variable.AutoCastVariable(var)\r\n\r\nwith tf.compat.v1.get_default_graph()._enable_auto_casting_variables(tf.float16):\r\n    assert var.dtype == tf.float16\r\n    # assign should return an AutoCastVariable but returns tf.Variable\r\n    var_assign = var.assign(5.)\r\n    assert not isinstance(var_assign, autocast_variable.AutoCastVariable)\r\n    assert var_assign.dtype == tf.float32\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34326", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34326/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34326/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34326/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34326", "id": 523716297, "node_id": "MDU6SXNzdWU1MjM3MTYyOTc=", "number": 34326, "title": "tf.signal.mfccs_from_log_mel_spectrograms caused internal error in converted TensorFlow Lite model", "user": {"login": "simonchen375", "id": 26579568, "node_id": "MDQ6VXNlcjI2NTc5NTY4", "avatar_url": "https://avatars1.githubusercontent.com/u/26579568?v=4", "gravatar_id": "", "url": "https://api.github.com/users/simonchen375", "html_url": "https://github.com/simonchen375", "followers_url": "https://api.github.com/users/simonchen375/followers", "following_url": "https://api.github.com/users/simonchen375/following{/other_user}", "gists_url": "https://api.github.com/users/simonchen375/gists{/gist_id}", "starred_url": "https://api.github.com/users/simonchen375/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/simonchen375/subscriptions", "organizations_url": "https://api.github.com/users/simonchen375/orgs", "repos_url": "https://api.github.com/users/simonchen375/repos", "events_url": "https://api.github.com/users/simonchen375/events{/privacy}", "received_events_url": "https://api.github.com/users/simonchen375/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-11-15T22:16:23Z", "updated_at": "2019-12-21T06:28:10Z", "closed_at": null, "author_association": "NONE", "body": "Please go to Stack Overflow for help and support:\r\n\r\nhttps://stackoverflow.com/questions/tagged/tensorflow\r\n\r\nIf you open a GitHub issue, here is our policy:\r\n\r\n1. It must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).\r\n2. The form below must be filled out.\r\n3. It shouldn't be a TensorBoard issue. Those go [here](https://github.com/tensorflow/tensorboard/issues).\r\n\r\n**Here's why we have that policy**: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.\r\n\r\n------------------------\r\n\r\n### System information\r\n- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes\r\n- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16.04\r\n- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: OnePlus A3010\r\n- **TensorFlow installed from (source or binary)**: source\r\n- **TensorFlow version (use command below)**: 2.0\r\n- **Python version**: 2.7\r\n- **Bazel version (if compiling from source)**: 0.26.1\r\n- **GCC/Compiler version (if compiling from source)**:  Apple clang version 11.0.0 (clang-1100.0.33.12)\r\n- **CUDA/cuDNN version**: N/A\r\n- **GPU model and memory**: N/A\r\n- **Exact command to reproduce**: N/A\r\n\r\nYou can collect some of this information using our environment capture script:\r\n\r\nhttps://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh\r\n\r\nYou can obtain the TensorFlow version with:\r\n\r\n```bash\r\npython -c \"import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)\"\r\n```\r\n\r\n### Describe the problem\r\nDescribe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.\r\n\r\nHello everyone,\r\n\r\nI have tried to extract MFCC features from audio signal using tf.signal.mfccs_from_log_mel_spectrograms. My python code runs pretty well, but when I converted it to a TensorFlow Lite model, and used it on android phone. I got the following error:\r\n\r\n\"\r\n...\r\n...\r\nCaused by: java.lang.IllegalArgumentException: Internal error: Failed to run on the given Interpreter: tensorflow/lite/kernels/strided_slice.cc ellipsis_mask is not implemented yet.\r\n    Node number 20 (STRIDED_SLICE) failed to prepare.\r\n...\r\n...\r\n\"\r\n\r\nI am pretty sure the error was caused by tf.signal.mfccs_from_log_mel_spectrograms, since I did not directly use \"strided_slice\" directly in my code, and in the visualized graph of the html file obtained by [visualization tool](https://www.tensorflow.org/lite/guide/faq) , I can only find the context of strided_slice like: \r\n\r\n\"\r\n...\r\n161 | StatefulPartitionedCall/model_1/lambda/mfccs_from_log_mel_spectrograms_2/dct/strided_slice | COMPLEX64 | [] | 59 | {u'quantized_dimension': 0, u'details_type': u'NONE'}\r\n-- | -- | -- | -- | -- | --\r\n162 | StatefulPartitionedCall/model_1/lambda/mfccs_from_log_mel_spectrograms_2/dct/strided_slice/stack | INT32 | [2] | 136 | {u'quantized_dimension': 0, u'details_type': u'NONE'}\r\n163 | StatefulPartitionedCall/model_1/lambda/mfccs_from_log_mel_spectrograms_2/dct/strided_slice/stack_1 | INT32 | [2] | 177 | {u'quantized_dimension': 0, u'details_type': u'NONE'}\r\n164 | StatefulPartitionedCall/model_1/lambda/mfccs_from_log_mel_spectrograms_2/dct/strided_slice/stack_2 | INT32 | [2] | 63 | {u'quantized_dimension': 0, u'details_type': u'NONE'}\r\n...\r\n\"\r\n\r\nIn the same graph file, I also found\r\n\"\r\n22 | [157, 162, 163, 164] | [161] | {u'begin_mask': 2, u'ellipsis_mask': 1, u'end_mask': 0, u'new_axis_mask': 0, u'shrink_axis_mask': 0}\r\n-- | -- | -- | --\r\n\"\r\n\r\nSo I think tf.signal.mfccs_from_log_mel_spectrograms trigged a dct, following a strided_slice, whose \"ellipsis_mask\" was set to 1, which is not implemented in TensorFlow Lite. \r\n\r\nBut I truly don't know how to avoid that error, actually, I got the same error, when using tf.signal.stft, also tf.signal.frame. They all called \"tf.strided_slice\" implicitly and set \"ellipsis_mask\" to 1.\r\n\r\nBy the way, the dimension of input tensor(log of mel spectrograms) to tf.signal.mfccs_from_log_mel_spectrograms was (None, 64, 20). Please kindly help me!\r\n\r\nRegards,\r\nSimon\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n### Source code / logs\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34324", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34324/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34324/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34324/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34324", "id": 523692917, "node_id": "MDU6SXNzdWU1MjM2OTI5MTc=", "number": 34324, "title": "Complex dtype support tflite converter", "user": {"login": "mattc-eostar", "id": 53350908, "node_id": "MDQ6VXNlcjUzMzUwOTA4", "avatar_url": "https://avatars3.githubusercontent.com/u/53350908?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mattc-eostar", "html_url": "https://github.com/mattc-eostar", "followers_url": "https://api.github.com/users/mattc-eostar/followers", "following_url": "https://api.github.com/users/mattc-eostar/following{/other_user}", "gists_url": "https://api.github.com/users/mattc-eostar/gists{/gist_id}", "starred_url": "https://api.github.com/users/mattc-eostar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mattc-eostar/subscriptions", "organizations_url": "https://api.github.com/users/mattc-eostar/orgs", "repos_url": "https://api.github.com/users/mattc-eostar/repos", "events_url": "https://api.github.com/users/mattc-eostar/events{/privacy}", "received_events_url": "https://api.github.com/users/mattc-eostar/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-11-15T21:18:15Z", "updated_at": "2019-11-15T23:50:55Z", "closed_at": null, "author_association": "NONE", "body": "Are complex dtypes planned to be supported in the experimental converter? using nightly 1108 build and it is throwing an error. This is super useful for MFCC calculations.\r\n\r\n```python\r\ndef generate_mfcc_features(audio_array):\r\n    sample_rate = 16000.0\r\n\r\n    # A 1024-point STFT with frames of 64 ms and 75% overlap.\r\n    stfts = tf.signal.stft(audio_array, frame_length=1024, frame_step=256,fft_length=1024)\r\n    spectrograms = tf.abs(stfts)\r\n#     spectrograms = tf.cast(stfts + 1, tf.float32)\r\n\r\n    # Warp the linear scale spectrograms into the mel-scale.\r\n    num_spectrogram_bins = stfts.shape[-1]\r\n    lower_edge_hertz, upper_edge_hertz, num_mel_bins = 80.0, 7600.0, 80\r\n    linear_to_mel_weight_matrix = tf.cast(tf.signal.linear_to_mel_weight_matrix(num_mel_bins, num_spectrogram_bins, sample_rate, lower_edge_hertz, upper_edge_hertz), tf.float32)\r\n    mel_spectrograms = tf.tensordot(spectrograms, linear_to_mel_weight_matrix, 1)\r\n    mel_spectrograms.set_shape(spectrograms.shape[:-1].concatenate(linear_to_mel_weight_matrix.shape[-1:]))\r\n\r\n    # Compute a stabilized log to get log-magnitude mel-scale spectrograms.\r\n    log_mel_spectrograms = tf.math.log(mel_spectrograms + 1e-6)\r\n\r\n    # Compute MFCCs from log_mel_spectrograms and take the first 13.\r\n    return tf.signal.mfccs_from_log_mel_spectrograms(log_mel_spectrograms)[..., :13]\r\n\r\ncnn = tf.keras.Sequential([\r\n    tf.keras.layers.Lambda(generate_mfcc_features, input_shape=(40000,)),\r\n    tf.keras.layers.Conv1D(filters=32, kernel_size=10, strides=2, padding='same', activation='relu')\r\n])\r\n```\r\n\r\nError:\r\n```\r\n---------------------------------------------------------------------------\r\nConverterError                            Traceback (most recent call last)\r\n<ipython-input-295-26886e1134e8> in <module>()\r\n      8 converter.optimizations = [tf.lite.Optimize.OPTIMIZE_FOR_LATENCY]\r\n      9 converter.target_spec.supported_ops = set([tf.lite.OpsSet.TFLITE_BUILTINS, tf.lite.OpsSet.SELECT_TF_OPS])\r\n---> 10 tflite_model_enc = converter.convert()\r\n     11 \r\n     12 print('Converting decoder')\r\n\r\n~/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/lite/python/lite.py in convert(self)\r\n    462         input_tensors=input_tensors,\r\n    463         output_tensors=output_tensors,\r\n--> 464         **converter_kwargs)\r\n    465 \r\n    466     if self._is_calibration_quantize():\r\n\r\n~/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/lite/python/convert.py in toco_convert_impl(input_data, input_tensors, output_tensors, enable_mlir_converter, *args, **kwargs)\r\n    455       input_data.SerializeToString(),\r\n    456       debug_info_str=debug_info_str,\r\n--> 457       enable_mlir_converter=enable_mlir_converter)\r\n    458   return data\r\n    459 \r\n\r\n~/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/lite/python/convert.py in toco_convert_protos(model_flags_str, toco_flags_str, input_data_str, debug_info_str, enable_mlir_converter)\r\n    201       stdout = _try_convert_to_unicode(stdout)\r\n    202       stderr = _try_convert_to_unicode(stderr)\r\n--> 203       raise ConverterError(\"See console for info.\\n%s\\n%s\\n\" % (stdout, stderr))\r\n    204   finally:\r\n    205     # Must manually cleanup files.\r\n\r\nConverterError: See console for info.\r\n2019-11-15 15:12:34.503239: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory\r\n2019-11-15 15:12:34.503275: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\r\n2019-11-15 15:12:35.451940: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory\r\n2019-11-15 15:12:35.452051: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory\r\n2019-11-15 15:12:35.452072: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.\r\n2019-11-15 15:12:36.763021: W tensorflow/compiler/mlir/lite/python/graphdef_to_tfl_flatbuffer.cc:89] Ignored output_format.\r\n2019-11-15 15:12:36.763078: W tensorflow/compiler/mlir/lite/python/graphdef_to_tfl_flatbuffer.cc:95] Ignored drop_control_dependency.\r\n2019-11-15 15:12:36.923578: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\r\n2019-11-15 15:12:36.930986: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2294685000 Hz\r\n2019-11-15 15:12:36.931794: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55eb1a6ac800 initialized for platform Host (this does not guarantee that XLA will be used). Devices:\r\n2019-11-15 15:12:36.931821: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version\r\n2019-11-15 15:12:36.933506: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory\r\n2019-11-15 15:12:36.933531: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)\r\n2019-11-15 15:12:36.933572: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (VXML-Ubuntu): /proc/driver/nvidia/version does not exist\r\nloc(callsite(\"sequential_5/lambda_4/mfccs_from_log_mel_spectrograms/dct/strided_slice\"(\"/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/python/ops/signal/dct_ops.py\":130:0) at callsite(\"/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/python/ops/signal/mfcc_ops.py\":107:0 at callsite(\"<ipython-input-228-d9ade39d80ce>\":20:0 at callsite(\"/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/python/keras/layers/core.py\":827:0 at callsite(\"/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/base_layer.py\":778:0 at callsite(\"/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/network.py\":891:0 at callsite(\"/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/network.py\":717:0 at callsite(\"/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/sequential.py\":267:0 at callsite(\"/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/base_layer.py\":778:0 at \"<ipython-input-290-205be255c740>\":3:0)))))))))): error: 'tfl.strided_slice' op operand #0 must be tensor of 32-bit float or 32-bit integer or 64-bit integer or 8-bit integer or QI8 type or QUI8 type or 1-bit integer values, but got 'tensor<1x153x81xcomplex<f32>>'\r\nTraceback (most recent call last):\r\n  File \"/home/mattc/anaconda3/envs/main/bin/toco_from_protos\", line 10, in <module>\r\n    sys.exit(main())\r\n  File \"/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 93, in main\r\n    app.run(main=execute, argv=[sys.argv[0]] + unparsed)\r\n  File \"/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/absl/app.py\", line 300, in run\r\n    _run_main(main, args)\r\n  File \"/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/absl/app.py\", line 251, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 56, in execute\r\n    enable_mlir_converter)\r\nException: /home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/python/ops/signal/dct_ops.py:130:15: error: 'tfl.strided_slice' op operand #0 must be tensor of 32-bit float or 32-bit integer or 64-bit integer or 8-bit integer or QI8 type or QUI8 type or 1-bit integer values, but got 'tensor<1x153x81xcomplex<f32>>'\r\n              input, fft_length=[2 * axis_dim])[..., :axis_dim] * scale)\r\n              ^\r\n/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/python/ops/signal/mfcc_ops.py:107:5: note: called from\r\n    dct2 = dct_ops.dct(log_mel_spectrograms, type=2)\r\n    ^\r\n<ipython-input-228-d9ade39d80ce>: note: called from\r\n/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/python/keras/layers/core.py:827:7: note: called from\r\n      return self.function(inputs, **arguments)\r\n      ^\r\n/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/base_layer.py:778:19: note: called from\r\n                  outputs = call_fn(cast_inputs, *args, **kwargs)\r\n                  ^\r\n/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/network.py:891:11: note: called from\r\n          output_tensors = layer(computed_tensors, **kwargs)\r\n          ^\r\n/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/network.py:717:9: note: called from\r\n        convert_kwargs_to_constants=base_layer_utils.call_context().saving)\r\n        ^\r\n/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/sequential.py:267:7: note: called from\r\n      return super(Sequential, self).call(inputs, training=training, mask=mask)\r\n      ^\r\n/home/mattc/anaconda3/envs/main/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/base_layer.py:778:19: note: called from\r\n                  outputs = call_fn(cast_inputs, *args, **kwargs)\r\n                  ^\r\n<ipython-input-290-205be255c740>: note: called from\r\n```\r\n\r\nIs there a plan to support signal operations like this in a TFLite model?"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34322", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34322/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34322/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34322/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34322", "id": 523673349, "node_id": "MDU6SXNzdWU1MjM2NzMzNDk=", "number": 34322, "title": "Collective AllGather Fails to Collect Tensors in Multi-(TF)Task Between-Graph Distributed Execution", "user": {"login": "pw2393", "id": 21228317, "node_id": "MDQ6VXNlcjIxMjI4MzE3", "avatar_url": "https://avatars1.githubusercontent.com/u/21228317?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pw2393", "html_url": "https://github.com/pw2393", "followers_url": "https://api.github.com/users/pw2393/followers", "following_url": "https://api.github.com/users/pw2393/following{/other_user}", "gists_url": "https://api.github.com/users/pw2393/gists{/gist_id}", "starred_url": "https://api.github.com/users/pw2393/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pw2393/subscriptions", "organizations_url": "https://api.github.com/users/pw2393/orgs", "repos_url": "https://api.github.com/users/pw2393/repos", "events_url": "https://api.github.com/users/pw2393/events{/privacy}", "received_events_url": "https://api.github.com/users/pw2393/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097547538, "node_id": "MDU6TGFiZWwxMDk3NTQ3NTM4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:gpu", "name": "comp:gpu", "color": "0052cc", "default": false, "description": ""}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "dubey", "id": 2314265, "node_id": "MDQ6VXNlcjIzMTQyNjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/2314265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dubey", "html_url": "https://github.com/dubey", "followers_url": "https://api.github.com/users/dubey/followers", "following_url": "https://api.github.com/users/dubey/following{/other_user}", "gists_url": "https://api.github.com/users/dubey/gists{/gist_id}", "starred_url": "https://api.github.com/users/dubey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dubey/subscriptions", "organizations_url": "https://api.github.com/users/dubey/orgs", "repos_url": "https://api.github.com/users/dubey/repos", "events_url": "https://api.github.com/users/dubey/events{/privacy}", "received_events_url": "https://api.github.com/users/dubey/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "dubey", "id": 2314265, "node_id": "MDQ6VXNlcjIzMTQyNjU=", "avatar_url": "https://avatars0.githubusercontent.com/u/2314265?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dubey", "html_url": "https://github.com/dubey", "followers_url": "https://api.github.com/users/dubey/followers", "following_url": "https://api.github.com/users/dubey/following{/other_user}", "gists_url": "https://api.github.com/users/dubey/gists{/gist_id}", "starred_url": "https://api.github.com/users/dubey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dubey/subscriptions", "organizations_url": "https://api.github.com/users/dubey/orgs", "repos_url": "https://api.github.com/users/dubey/repos", "events_url": "https://api.github.com/users/dubey/events{/privacy}", "received_events_url": "https://api.github.com/users/dubey/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-11-15T20:29:42Z", "updated_at": "2020-03-05T17:04:37Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- OS Platform and Distribution: Ubuntu 18.04\r\n- TensorFlow installed from (source or binary): binary whl\r\n- TensorFlow version (use command below): `tensorflow-gpu==2.0.0`\r\n- Python version: 3.6.8\r\n- CUDA/cuDNN version: 10.0 / 7.6.4, recommended with the support of `nccl`\r\n- GPU model and memory: GeForce GTX 1080 Ti\r\n\r\n\r\n**Describe the current behavior**\r\nFirst, we need the two files below.\r\n`cluster.py`:\r\n```python\r\nimport time\r\nfrom multiprocessing import Process\r\n\r\nfrom tensorflow.core.protobuf import config_pb2\r\nfrom tensorflow.python.training.server_lib import Server\r\n\r\nCLUSTER_SPEC = {\r\n    \"worker\": [\r\n        \"localhost:14286\",\r\n        \"localhost:14287\"\r\n    ]\r\n}\r\n\r\nGROUP_SIZE = 4\r\n\r\n\r\ndef _configure(group_size):\r\n    gpu_options = config_pb2.GPUOptions(\r\n        visible_device_list='0,1',\r\n        per_process_gpu_memory_fraction=0.7 / group_size\r\n    )\r\n    experimental = config_pb2.ConfigProto.Experimental(collective_nccl=True)\r\n    experimental.collective_group_leader = '/job:worker/replica:0/task:0'\r\n    return config_pb2.ConfigProto(gpu_options=gpu_options, experimental=experimental)\r\n\r\n\r\nclass TFCluster:\r\n    def __init__(self, cluster_spec):\r\n        self._cluster_spec = cluster_spec\r\n        self._num_worker = len(self._cluster_spec.get(\"worker\", []))\r\n        self._tf_servers = []\r\n\r\n    def start(self):\r\n        def server(job_name: str, task_index: int):\r\n            s = Server(self._cluster_spec,\r\n                       job_name=job_name,\r\n                       task_index=task_index,\r\n                       config=_configure(GROUP_SIZE))\r\n            s.join()\r\n\r\n        assert self._num_worker >= 1\r\n        for i in range(self._num_worker):\r\n            self._tf_servers.append(Process(target=server,\r\n                                            args=(\"worker\", i), daemon=True))\r\n            # break\r\n        for proc in self._tf_servers:\r\n            proc.start()\r\n\r\n    def stop(self):\r\n        for proc in self._tf_servers:\r\n            proc.terminate()\r\n\r\n\r\nif __name__ == '__main__':\r\n    cluster = TFCluster(CLUSTER_SPEC)\r\n    cluster.start()\r\n    time.sleep(5)\r\n    input('Press Enter to Stop.')\r\n    cluster.stop()\r\n```\r\n`task.py`:\r\n```python\r\nimport argparse\r\n\r\nimport numpy as np\r\nimport tensorflow as tf\r\nfrom tensorflow.core.protobuf import config_pb2\r\nfrom tensorflow.python import ops\r\nfrom tensorflow.python.client.session import Session\r\nfrom tensorflow.python.ops import collective_ops\r\n\r\nfrom cluster import CLUSTER_SPEC, GROUP_SIZE\r\n\r\nVAR = np.array([0.1, 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1])\r\nVAR_TASK_INDEX = 0\r\n\r\n\r\ndef test_collective(job_name, task_index, num_gpus):\r\n    worker_device = \"/job:%s/task:%d\" % (job_name, task_index)\r\n    master_target = \"grpc://\" + CLUSTER_SPEC[job_name][task_index]\r\n    print('> Session Target:', master_target)\r\n\r\n    with ops.Graph().as_default(), Session(target=master_target) as sess:\r\n        def run(x):\r\n            run_options = config_pb2.RunOptions()\r\n            run_options.experimental.collective_graph_key = task_index + 1\r\n            # Different positive graph key for different task to avoid racing conditions.\r\n            return sess.run(x, options=run_options)\r\n\r\n        with ops.device('/job:worker/task:%d/device:CPU:0' % VAR_TASK_INDEX):  # make sure all use the same variable\r\n            var = tf.Variable(VAR, name='W')\r\n\r\n        targets = []\r\n        collectives = []\r\n        for i in range(num_gpus):\r\n            with ops.device(worker_device + '/device:GPU:' + str(i)):\r\n                t = var + 0.2 * task_index + 0.1 * i\r\n                targets.append(t)\r\n                collectives.append(\r\n                    collective_ops.all_gather(\r\n                        t,\r\n                        group_size=GROUP_SIZE,\r\n                        group_key=1, instance_key=1\r\n                    )\r\n                    # collective_ops.all_reduce(\r\n                    #     t,\r\n                    #     group_size=GROUP_SIZE,\r\n                    #     group_key=1, instance_key=1, merge_op='Add', final_op='Div'\r\n                    # )\r\n                )\r\n\r\n        run(tf.compat.v1.global_variables_initializer())\r\n\r\n        var_value = run(var)\r\n        print('> Variable Value:', var_value)\r\n\r\n        targets_value = run(targets)\r\n        print('> Targets Value:', targets_value)\r\n\r\n        collectives_value = run(collectives)\r\n        print('> Collectives Value:', collectives_value)\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    parser = argparse.ArgumentParser()\r\n    parser.register(\"type\", \"bool\", lambda v: v.lower() == \"true\")\r\n\r\n    parser.add_argument(\r\n        \"--job_name\",\r\n        type=str,\r\n        default=\"\",\r\n    )\r\n    parser.add_argument(\r\n        \"--task_index\",\r\n        type=int,\r\n        default=0,\r\n    )\r\n    FLAGS, unparsed = parser.parse_known_args()\r\n    num_gpus_per_node = 2\r\n    test_collective(job_name=FLAGS.job_name, task_index=FLAGS.task_index, num_gpus=num_gpus_per_node)\r\n```\r\n\r\nThen one could use the following commands to run the experiment:\r\n```bash\r\npython cluster.py\r\npython task.py --job_name=worker --task_index=0\r\npython task.py --job_name=worker --task_index=1\r\n```\r\n\r\n* EXPERIMENT 1 (FAILURE):\r\n  * Run the above code without change. Note that the `GROUP_SIZE=4`. It is programmed to all gather the 4 tensors across `task:0/GPU:0/` `task:0/GPU:1` `task:1/GPU:0` `task:1/GPU:1`, but gets stuck. If one turns on the env `TF_CPP_MIN_VLOG_LEVEL=1` , one will notice it successfully gathers the values but gets stuck right after it, specifically after `tensorflow/core/common_runtime/collective_rma_local.cc:105] PostToPeer ...`\r\n\r\n* EXPERIMENT 2 (SUCCESS):\r\n * Run the above code with `GROUP_SIZE=2`. On each task, It is programmed to gather 2 tensors on the 2 GPUs of that task. For example, on `task 0`, it gathers `task:0/GPU:0` and `task:0/GPU:1` and it succeeds.\r\n\r\n* EXPERIMENT 3 (SUCCESS):\r\n* Run the above code with the original `GROUP_SIZE=4` but with the `all_reduce` op (as provided in the commented code) instead of `all_gather`. It succeeds.\r\n\r\n\r\n**Describe the expected behavior**\r\n\r\nIt is expected that all the experiments above should succeed. However, EXPERIMENT 1 fails, but 2 and 3 succeed. 3 means the collective executor works in a multi-task way of executing the graph on `all_reduce`. 2 means `all_gather` works if only collects tensor within one graph. 1 means the bug where `all_gather` fails to collect tensors across the tasks. \r\n\r\n**Code to reproduce the issue**\r\nSee above\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34321", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34321/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34321/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34321/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34321", "id": 523615249, "node_id": "MDU6SXNzdWU1MjM2MTUyNDk=", "number": 34321, "title": "Colab, TPU training using keras  InternalError: Failed to serialize message", "user": {"login": "ShiroKL", "id": 56442912, "node_id": "MDQ6VXNlcjU2NDQyOTEy", "avatar_url": "https://avatars2.githubusercontent.com/u/56442912?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ShiroKL", "html_url": "https://github.com/ShiroKL", "followers_url": "https://api.github.com/users/ShiroKL/followers", "following_url": "https://api.github.com/users/ShiroKL/following{/other_user}", "gists_url": "https://api.github.com/users/ShiroKL/gists{/gist_id}", "starred_url": "https://api.github.com/users/ShiroKL/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ShiroKL/subscriptions", "organizations_url": "https://api.github.com/users/ShiroKL/orgs", "repos_url": "https://api.github.com/users/ShiroKL/repos", "events_url": "https://api.github.com/users/ShiroKL/events{/privacy}", "received_events_url": "https://api.github.com/users/ShiroKL/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 996845227, "node_id": "MDU6TGFiZWw5OTY4NDUyMjc=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:dist-strat", "name": "comp:dist-strat", "color": "0052cc", "default": false, "description": "Distribution Strategy related issues"}, {"id": 1097541661, "node_id": "MDU6TGFiZWwxMDk3NTQxNjYx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:tpus", "name": "comp:tpus", "color": "0052cc", "default": false, "description": "tpu, tpuestimator"}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "ymodak", "id": 42785357, "node_id": "MDQ6VXNlcjQyNzg1MzU3", "avatar_url": "https://avatars1.githubusercontent.com/u/42785357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ymodak", "html_url": "https://github.com/ymodak", "followers_url": "https://api.github.com/users/ymodak/followers", "following_url": "https://api.github.com/users/ymodak/following{/other_user}", "gists_url": "https://api.github.com/users/ymodak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ymodak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ymodak/subscriptions", "organizations_url": "https://api.github.com/users/ymodak/orgs", "repos_url": "https://api.github.com/users/ymodak/repos", "events_url": "https://api.github.com/users/ymodak/events{/privacy}", "received_events_url": "https://api.github.com/users/ymodak/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2019-11-15T18:11:41Z", "updated_at": "2020-01-16T00:58:04Z", "closed_at": null, "author_association": "NONE", "body": "Hi,\r\n\r\nI am trying to test TPU on colab in order to see how that works on keras.\r\nI try to train 3 models. And differents bugs/abnormal behaviors occured : \r\n1) when I trained a simple model ( see \"create_model\" function in colab) it works well with an image size of (100,100,3) but it does not work with (200,200,3). The batch size is about 80 so I doubt it is about an OOM error. \r\n\r\n\r\n\r\n2)  same as 1) with vgg19/inceptionresnetv2 + issue if I use the parameters imagenet=\"weights\"\r\n\r\n\r\n3) using tensorflow 2.0 as backend does not seem to work even with image size equal to (100, 100, 3)\r\n\r\nThese issue seems abnormal and the message does not help to understand how to solve them. Anyone know how to solve them or why they occured ?\r\n\r\nLink to the code : https://colab.research.google.com/drive/1z40RZOqBexmniel8m9KdgSa7tSFaUUcG\r\n\r\n\r\nMessage error : \r\n1)\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nInternalError                             Traceback (most recent call last)\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/client/session.py in _do_call(self, fn, *args)\r\n   1364     try:\r\n-> 1365       return fn(*args)\r\n   1366     except errors.OpError as e:\r\n\r\n13 frames\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/client/session.py in _run_fn(feed_dict, fetch_list, target_list, options, run_metadata)\r\n   1349       return self._call_tf_sessionrun(options, feed_dict, fetch_list,\r\n-> 1350                                       target_list, run_metadata)\r\n   1351 \r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/client/session.py in _call_tf_sessionrun(self, options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1442                                             fetch_list, target_list,\r\n-> 1443                                             run_metadata)\r\n   1444 \r\n\r\nInternalError: Failed to serialize message\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nInternalError                             Traceback (most recent call last)\r\n<ipython-input-16-f1e92e5b4b78> in <module>()\r\n      2   X_train.astype(np.float32), Y_train.astype(np.float32),\r\n      3   batch_size = 10*8,\r\n----> 4   epochs=5)#, validation_data=(x_test, y_test))\r\n      5 \r\n      6   #validation_data=(x_test.astype(np.float32), y_test.astype(np.float32)))\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training.py in fit(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_freq, max_queue_size, workers, use_multiprocessing, **kwargs)\r\n    725         max_queue_size=max_queue_size,\r\n    726         workers=workers,\r\n--> 727         use_multiprocessing=use_multiprocessing)\r\n    728 \r\n    729   def evaluate(self,\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_distributed.py in fit(self, model, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_freq, **kwargs)\r\n    617         validation_split=validation_split,\r\n    618         shuffle=shuffle,\r\n--> 619         epochs=epochs)\r\n    620     if not dist_utils.is_distributing_by_cloning(model):\r\n    621       with model._distribution_strategy.scope():\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training.py in _distribution_standardize_user_data(self, x, y, sample_weight, class_weight, batch_size, validation_split, shuffle, epochs, allow_partial_batch)\r\n   2286 \r\n   2287         ds = strategy.extended.experimental_make_numpy_dataset(in_tuple,\r\n-> 2288                                                                session=session)\r\n   2289         if shuffle:\r\n   2290           # We want a buffer size that is larger than the batch size provided by\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/distribute_lib.py in experimental_make_numpy_dataset(self, numpy_input, session)\r\n   1684     \"\"\"\r\n   1685     _require_cross_replica_or_default_context_extended(self)\r\n-> 1686     return self._experimental_make_numpy_dataset(numpy_input, session=session)\r\n   1687 \r\n   1688   def _experimental_make_numpy_dataset(self, numpy_input, session):\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/tpu_strategy.py in _experimental_make_numpy_dataset(self, numpy_input, session)\r\n    247     return numpy_dataset.one_host_numpy_dataset(\r\n    248         numpy_input, numpy_dataset.SingleDevice(self._host_device),\r\n--> 249         session)\r\n    250 \r\n    251   def _experimental_distribute_dataset(self, dataset):\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/numpy_dataset.py in one_host_numpy_dataset(numpy_input, colocate_with, session)\r\n     86                       for i in numpy_flat)\r\n     87   for v, i in zip(vars_flat, numpy_flat):\r\n---> 88     init_var_from_numpy(v, i, session)\r\n     89   vars_nested = nest.pack_sequence_as(numpy_input, vars_flat)\r\n     90   return dataset_ops.Dataset.from_tensor_slices(vars_nested)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/numpy_dataset.py in init_var_from_numpy(input_var, numpy_input, session)\r\n     70           start_placeholder: start,\r\n     71           end_placeholder: end,\r\n---> 72           slice_placeholder: numpy_input[start:end]})\r\n     73       start = end\r\n     74 \r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/client/session.py in run(self, fetches, feed_dict, options, run_metadata)\r\n    954     try:\r\n    955       result = self._run(None, fetches, feed_dict, options_ptr,\r\n--> 956                          run_metadata_ptr)\r\n    957       if run_metadata:\r\n    958         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/client/session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\r\n   1178     if final_fetches or final_targets or (handle and feed_dict_tensor):\r\n   1179       results = self._do_run(handle, final_targets, final_fetches,\r\n-> 1180                              feed_dict_tensor, options, run_metadata)\r\n   1181     else:\r\n   1182       results = []\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/client/session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\r\n   1357     if handle is None:\r\n   1358       return self._do_call(_run_fn, feeds, fetches, targets, options,\r\n-> 1359                            run_metadata)\r\n   1360     else:\r\n   1361       return self._do_call(_prun_fn, handle, feeds, fetches)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/client/session.py in _do_call(self, fn, *args)\r\n   1382                     '\\nsession_config.graph_options.rewrite_options.'\r\n   1383                     'disable_meta_optimizer = True')\r\n-> 1384       raise type(e)(node_def, op, message)\r\n   1385 \r\n   1386   def _extend_graph(self):\r\n\r\nInternalError: Failed to serialize message\r\n```\r\n\r\n\r\n2)\r\n```\r\n\r\n---------------------------------------------------------------------------\r\nNotFoundError                             Traceback (most recent call last)\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/client/session.py in _do_call(self, fn, *args)\r\n   1364     try:\r\n-> 1365       return fn(*args)\r\n   1366     except errors.OpError as e:\r\n\r\n10 frames\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/client/session.py in _run_fn(feed_dict, fetch_list, target_list, options, run_metadata)\r\n   1349       return self._call_tf_sessionrun(options, feed_dict, fetch_list,\r\n-> 1350                                       target_list, run_metadata)\r\n   1351 \r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/client/session.py in _call_tf_sessionrun(self, options, feed_dict, fetch_list, target_list, run_metadata)\r\n   1442                                             fetch_list, target_list,\r\n-> 1443                                             run_metadata)\r\n   1444 \r\n\r\nNotFoundError: From /job:worker/replica:0/task:0:\r\n2 root error(s) found.\r\n  (0) Not found: Resource worker/block1_conv1/bias/replica_7/N10tensorflow3VarE does not exist.\r\n\t [[{{node TPUReplicateMetadata}}]]\r\n  (1) Not found: Resource worker/block1_conv1/bias/replica_3/N10tensorflow3VarE does not exist.\r\n\t [[{{node TPUReplicateMetadata}}]]\r\n0 successful operations.\r\n7 derived errors ignored.\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nNotFoundError                             Traceback (most recent call last)\r\n<ipython-input-10-f1e92e5b4b78> in <module>()\r\n      2   X_train.astype(np.float32), Y_train.astype(np.float32),\r\n      3   batch_size = 10*8,\r\n----> 4   epochs=5)#, validation_data=(x_test, y_test))\r\n      5 \r\n      6   #validation_data=(x_test.astype(np.float32), y_test.astype(np.float32)))\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training.py in fit(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_freq, max_queue_size, workers, use_multiprocessing, **kwargs)\r\n    725         max_queue_size=max_queue_size,\r\n    726         workers=workers,\r\n--> 727         use_multiprocessing=use_multiprocessing)\r\n    728 \r\n    729   def evaluate(self,\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_distributed.py in fit(self, model, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_freq, **kwargs)\r\n    668             steps_per_epoch=steps_per_epoch,\r\n    669             validation_steps=validation_steps,\r\n--> 670             validation_freq=validation_freq)\r\n    671 \r\n    672     return training_arrays.fit_loop(\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_distributed.py in experimental_tpu_fit_loop(model, dataset, epochs, verbose, callbacks, initial_epoch, steps_per_epoch, val_dataset, validation_steps, validation_freq)\r\n    241         prev_step_count = step_count\r\n    242       try:\r\n--> 243         _, outputs = K.batch_get_value([train_op, output_tensors])\r\n    244       except errors.OutOfRangeError:\r\n    245         logging.warning('Your dataset iterator ran out of data; '\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/backend.py in batch_get_value(tensors)\r\n   3183     raise RuntimeError('Cannot get value inside Tensorflow graph function.')\r\n   3184   if tensors:\r\n-> 3185     return get_session(tensors).run(tensors)\r\n   3186   else:\r\n   3187     return []\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/client/session.py in run(self, fetches, feed_dict, options, run_metadata)\r\n    954     try:\r\n    955       result = self._run(None, fetches, feed_dict, options_ptr,\r\n--> 956                          run_metadata_ptr)\r\n    957       if run_metadata:\r\n    958         proto_data = tf_session.TF_GetBuffer(run_metadata_ptr)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/client/session.py in _run(self, handle, fetches, feed_dict, options, run_metadata)\r\n   1178     if final_fetches or final_targets or (handle and feed_dict_tensor):\r\n   1179       results = self._do_run(handle, final_targets, final_fetches,\r\n-> 1180                              feed_dict_tensor, options, run_metadata)\r\n   1181     else:\r\n   1182       results = []\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/client/session.py in _do_run(self, handle, target_list, fetch_list, feed_dict, options, run_metadata)\r\n   1357     if handle is None:\r\n   1358       return self._do_call(_run_fn, feeds, fetches, targets, options,\r\n-> 1359                            run_metadata)\r\n   1360     else:\r\n   1361       return self._do_call(_prun_fn, handle, feeds, fetches)\r\n\r\n/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/client/session.py in _do_call(self, fn, *args)\r\n   1382                     '\\nsession_config.graph_options.rewrite_options.'\r\n   1383                     'disable_meta_optimizer = True')\r\n-> 1384       raise type(e)(node_def, op, message)\r\n   1385 \r\n   1386   def _extend_graph(self):\r\n\r\nNotFoundError: From /job:worker/replica:0/task:0:\r\n2 root error(s) found.\r\n  (0) Not found: Resource worker/block1_conv1/bias/replica_7/N10tensorflow3VarE does not exist.\r\n\t [[node TPUReplicateMetadata (defined at /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]\r\n  (1) Not found: Resource worker/block1_conv1/bias/replica_3/N10tensorflow3VarE does not exist.\r\n\t [[node TPUReplicateMetadata (defined at /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/ops.py:1748) ]]\r\n0 successful operations.\r\n7 derived errors ignored.\r\n\r\nOriginal stack trace for 'TPUReplicateMetadata':\r\n  File \"/usr/lib/python3.6/runpy.py\", line 193, in _run_module_as_main\r\n    \"__main__\", mod_spec)\r\n  File \"/usr/lib/python3.6/runpy.py\", line 85, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py\", line 16, in <module>\r\n    app.launch_new_instance()\r\n  File \"/usr/local/lib/python3.6/dist-packages/traitlets/config/application.py\", line 664, in launch_instance\r\n    app.start()\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel/kernelapp.py\", line 477, in start\r\n    ioloop.IOLoop.instance().start()\r\n  File \"/usr/local/lib/python3.6/dist-packages/tornado/ioloop.py\", line 832, in start\r\n    self._run_callback(self._callbacks.popleft())\r\n  File \"/usr/local/lib/python3.6/dist-packages/tornado/ioloop.py\", line 605, in _run_callback\r\n    ret = callback()\r\n  File \"/usr/local/lib/python3.6/dist-packages/tornado/stack_context.py\", line 277, in null_wrapper\r\n    return fn(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/zmq/eventloop/zmqstream.py\", line 536, in <lambda>\r\n    self.io_loop.add_callback(lambda : self._handle_events(self.socket, 0))\r\n  File \"/usr/local/lib/python3.6/dist-packages/zmq/eventloop/zmqstream.py\", line 450, in _handle_events\r\n    self._handle_recv()\r\n  File \"/usr/local/lib/python3.6/dist-packages/zmq/eventloop/zmqstream.py\", line 480, in _handle_recv\r\n    self._run_callback(callback, msg)\r\n  File \"/usr/local/lib/python3.6/dist-packages/zmq/eventloop/zmqstream.py\", line 432, in _run_callback\r\n    callback(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tornado/stack_context.py\", line 277, in null_wrapper\r\n    return fn(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel/kernelbase.py\", line 283, in dispatcher\r\n    return self.dispatch_shell(stream, msg)\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel/kernelbase.py\", line 235, in dispatch_shell\r\n    handler(stream, idents, msg)\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel/kernelbase.py\", line 399, in execute_request\r\n    user_expressions, allow_stdin)\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel/ipkernel.py\", line 196, in do_execute\r\n    res = shell.run_cell(code, store_history=store_history, silent=silent)\r\n  File \"/usr/local/lib/python3.6/dist-packages/ipykernel/zmqshell.py\", line 533, in run_cell\r\n    return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 2718, in run_cell\r\n    interactivity=interactivity, compiler=compiler, result=result)\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 2822, in run_ast_nodes\r\n    if self.run_code(code, result):\r\n  File \"/usr/local/lib/python3.6/dist-packages/IPython/core/interactiveshell.py\", line 2882, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-10-f1e92e5b4b78>\", line 4, in <module>\r\n    epochs=5)#, validation_data=(x_test, y_test))\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training.py\", line 727, in fit\r\n    use_multiprocessing=use_multiprocessing)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_distributed.py\", line 670, in fit\r\n    validation_freq=validation_freq)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/keras/engine/training_distributed.py\", line 196, in experimental_tpu_fit_loop\r\n    initial_loop_values=initial_loop_values)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/distribute_lib.py\", line 1756, in experimental_run_steps_on_iterator\r\n    initial_loop_values)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/tpu_strategy.py\", line 334, in _experimental_run_steps_on_iterator\r\n    replicate_outputs = rewrite_fn()\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/distribute/tpu_strategy.py\", line 315, in rewrite_fn\r\n    run_fn, replicate_inputs, device_assignment=self._device_assignment)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/tpu/tpu.py\", line 639, in replicate\r\n    maximum_shapes=maximum_shapes)[1]\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/tpu/tpu.py\", line 927, in split_compile_and_replicate\r\n    num_replicas=num_replicas, use_tpu=use_tpu, **metadata_kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/ops/gen_tpu_ops.py\", line 6105, in tpu_replicate_metadata\r\n    name=name)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/op_def_library.py\", line 794, in _apply_op_helper\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/util/deprecation.py\", line 507, in new_func\r\n    return func(*args, **kwargs)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/ops.py\", line 3357, in create_op\r\n    attrs, op_def, compute_device)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/ops.py\", line 3426, in _create_op_internal\r\n    op_def=op_def)\r\n  File \"/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/framework/ops.py\", line 1748, in __init__\r\n    self._traceback = tf_stack.extract_stack()\r\n```\r\n\r\n\r\n3)\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nInternalError                             Traceback (most recent call last)\r\n<ipython-input-10-f1e92e5b4b78> in <module>()\r\n      2   X_train.astype(np.float32), Y_train.astype(np.float32),\r\n      3   batch_size = 10*8,\r\n----> 4   epochs=5)#, validation_data=(x_test, y_test))\r\n      5 \r\n      6   #validation_data=(x_test.astype(np.float32), y_test.astype(np.float32)))\r\n\r\n13 frames\r\n/tensorflow-2.0.0/python3.6/tensorflow_core/python/keras/engine/training.py in fit(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_freq, max_queue_size, workers, use_multiprocessing, **kwargs)\r\n    726         max_queue_size=max_queue_size,\r\n    727         workers=workers,\r\n--> 728         use_multiprocessing=use_multiprocessing)\r\n    729 \r\n    730   def evaluate(self,\r\n\r\n/tensorflow-2.0.0/python3.6/tensorflow_core/python/keras/engine/training_distributed.py in fit(self, model, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_freq, **kwargs)\r\n    683         validation_steps=validation_steps,\r\n    684         validation_freq=validation_freq,\r\n--> 685         steps_name='steps_per_epoch')\r\n    686 \r\n    687   def evaluate(self,\r\n\r\n/tensorflow-2.0.0/python3.6/tensorflow_core/python/keras/engine/training_arrays.py in model_iteration(model, inputs, targets, sample_weights, batch_size, epochs, verbose, callbacks, val_inputs, val_targets, val_sample_weights, shuffle, initial_epoch, steps_per_epoch, validation_steps, validation_freq, mode, validation_in_fit, prepared_feed_values_from_dataset, steps_name, **kwargs)\r\n    142       steps_per_epoch = training_utils.infer_steps_for_dataset(\r\n    143           inputs, steps_per_epoch, epochs=epochs, steps_name=steps_name)\r\n--> 144     input_iterator = _get_iterator(inputs, model._distribution_strategy)\r\n    145 \r\n    146   # Enter tf.distribute.Strategy scope.\r\n\r\n/tensorflow-2.0.0/python3.6/tensorflow_core/python/keras/engine/training_arrays.py in _get_iterator(inputs, distribution_strategy)\r\n    547   if distribution_strategy:\r\n    548     return distributed_training_utils.get_iterator(\r\n--> 549         inputs, distribution_strategy)\r\n    550   return training_utils.get_iterator(inputs)\r\n    551 \r\n\r\n/tensorflow-2.0.0/python3.6/tensorflow_core/python/keras/distribute/distributed_training_utils.py in get_iterator(dataset, distribution_strategy)\r\n    585 def get_iterator(dataset, distribution_strategy):\r\n    586   with distribution_strategy.scope():\r\n--> 587     iterator = distribution_strategy.make_dataset_iterator(dataset)\r\n    588   initialize_iterator(iterator, distribution_strategy)\r\n    589   return iterator\r\n\r\n/tensorflow-2.0.0/python3.6/tensorflow_core/python/distribute/distribute_lib.py in make_dataset_iterator(self, dataset)\r\n    559   def make_dataset_iterator(self, dataset):\r\n    560     \"\"\"DEPRECATED TF 1.x ONLY.\"\"\"\r\n--> 561     return self._extended._make_dataset_iterator(dataset)  # pylint: disable=protected-access\r\n    562 \r\n    563   @doc_controls.do_not_generate_docs  # DEPRECATED: TF 1.x only\r\n\r\n/tensorflow-2.0.0/python3.6/tensorflow_core/python/distribute/tpu_strategy.py in _make_dataset_iterator(self, dataset)\r\n    225         self._input_workers,\r\n    226         self._container_strategy(),\r\n--> 227         split_batch_by=self._num_replicas_in_sync)\r\n    228 \r\n    229   def _make_input_fn_iterator(\r\n\r\n/tensorflow-2.0.0/python3.6/tensorflow_core/python/distribute/input_lib.py in __init__(self, dataset, input_workers, strategy, split_batch_by, input_context)\r\n    760         strategy,\r\n    761         split_batch_by=split_batch_by,\r\n--> 762         input_context=input_context)\r\n    763     worker_iterators = _create_iterators_per_worker(\r\n    764         dist_dataset._cloned_datasets, input_workers)  # pylint: disable=protected-access\r\n\r\n/tensorflow-2.0.0/python3.6/tensorflow_core/python/distribute/input_lib.py in __init__(self, dataset, input_workers, strategy, split_batch_by, input_context)\r\n    556         strategy,\r\n    557         split_batch_by=split_batch_by,\r\n--> 558         input_context=input_context)\r\n    559 \r\n    560   def make_one_shot_iterator(self):\r\n\r\n/tensorflow-2.0.0/python3.6/tensorflow_core/python/distribute/input_lib.py in __init__(self, dataset, input_workers, strategy, split_batch_by, input_context)\r\n    518           # TODO(b/129506833): Figure out between graph cases\r\n    519           cloned_dataset = input_ops.auto_shard_dataset(  # pylint: disable=protected-access\r\n--> 520               cloned_dataset, len(input_workers.worker_devices), i)\r\n    521           self._cloned_datasets.append(cloned_dataset)\r\n    522 \r\n\r\n/tensorflow-2.0.0/python3.6/tensorflow_core/python/distribute/input_ops.py in auto_shard_dataset(dataset, num_shards, index)\r\n     47       return distribute._AutoShardDatasetV1(dataset, num_shards, index)\r\n     48     else:\r\n---> 49       return distribute._AutoShardDataset(dataset, num_shards, index)\r\n     50   else:\r\n     51     return dataset\r\n\r\n/tensorflow-2.0.0/python3.6/tensorflow_core/python/data/experimental/ops/distribute.py in __init__(self, input_dataset, num_workers, index)\r\n     54         num_workers=num_workers,\r\n     55         index=index,\r\n---> 56         **self._flat_structure)\r\n     57     super(_AutoShardDataset, self).__init__(input_dataset, variant_tensor)\r\n     58 \r\n\r\n/tensorflow-2.0.0/python3.6/tensorflow_core/python/ops/gen_experimental_dataset_ops.py in auto_shard_dataset(input_dataset, num_workers, index, output_types, output_shapes, name)\r\n    169       else:\r\n    170         message = e.message\r\n--> 171       _six.raise_from(_core._status_to_exception(e.code, message), None)\r\n    172   # Add nodes to the TensorFlow graph.\r\n    173   if not isinstance(output_types, (list, tuple)):\r\n\r\n/usr/local/lib/python3.6/dist-packages/six.py in raise_from(value, from_value)\r\n\r\nInternalError: Failed copying input tensor from /job:localhost/replica:0/task:0/device:CPU:0 to /job:worker/replica:0/task:0/device:CPU:0 in order to run AutoShardDataset: Unable to parse tensor proto\r\nAdditional GRPC error information:\r\n{\"created\":\"@1573841168.053370969\",\"description\":\"Error received from peer\",\"file\":\"external/grpc/src/core/lib/surface/call.cc\",\"file_line\":1039,\"grpc_message\":\"Unable to parse tensor proto\",\"grpc_status\":3} [Op:AutoShardDataset]\r\n```"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34313", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34313/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34313/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34313/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34313", "id": 523552107, "node_id": "MDU6SXNzdWU1MjM1NTIxMDc=", "number": 34313, "title": "A/libc: Fatal signal 11 (SIGSEGV), code 1, fault addr 0x70 in tid 28007", "user": {"login": "kazuimotn", "id": 38953698, "node_id": "MDQ6VXNlcjM4OTUzNjk4", "avatar_url": "https://avatars0.githubusercontent.com/u/38953698?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kazuimotn", "html_url": "https://github.com/kazuimotn", "followers_url": "https://api.github.com/users/kazuimotn/followers", "following_url": "https://api.github.com/users/kazuimotn/following{/other_user}", "gists_url": "https://api.github.com/users/kazuimotn/gists{/gist_id}", "starred_url": "https://api.github.com/users/kazuimotn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kazuimotn/subscriptions", "organizations_url": "https://api.github.com/users/kazuimotn/orgs", "repos_url": "https://api.github.com/users/kazuimotn/repos", "events_url": "https://api.github.com/users/kazuimotn/events{/privacy}", "received_events_url": "https://api.github.com/users/kazuimotn/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}, {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2019-11-15T15:59:12Z", "updated_at": "2019-11-16T12:25:36Z", "closed_at": null, "author_association": "NONE", "body": "There was a problem when calling converted custom model (LSTM.tflite) in Android Studio.\r\nwith\r\n```Python\r\nconverter.experimental_new_converter = True\r\n```\r\n\r\n**System information**\r\nmodel training machine\r\n- Ubuntu 16.04 (LTS)\r\n- GTX1080\r\n- tensorflow 1.13.1\r\n- Keras 2.2.4\r\n- Python 3.6.8\r\n\r\nmodel converting & loading machine\r\n\r\n- MacOS Mojave 10.14.5\r\n- Python 3.7.1\r\n- tensorflow 2.0.0, tf-nightly 2.1.0.dev20191113\r\n- Android Studio 3.4.1\r\n- targetSdkVersion 28\r\n\r\nSmartphone\r\n\r\n- Android 8.0.0\r\n- SONY SO-04J (docomo xperia)\r\n\r\nI can convert custom LSTM model from .h5 to .tflite with following code:\r\n\r\n```Python\r\nimport tensorflow as tf\r\nmodel = tf.keras.models.load_model(\"LSTM.h5\")\r\nconverter = tf.lite.TFLiteConverter.from_keras_model(model)\r\nconverter.experimental_new_converter = True\r\ntflite_model = converter.convert()\r\nopen(\"LSTM.tflite\", \"wb\").write(tflite_model)\r\n```\r\n\r\nNext I want to load this model (LSTM.tflite) into my Android APK.\r\nI already have class that can perform inference using 1D-CNN custom model (1DCNN.tflite).\r\n\r\n```Java\r\npackage iis.kmjlab.kazuimotn.sartips.others;\r\nimport android.content.res.AssetFileDescriptor;\r\nimport android.content.res.AssetManager;\r\nimport org.tensorflow.lite.Interpreter;\r\nimport java.io.FileInputStream;\r\nimport java.io.IOException;\r\nimport java.nio.ByteBuffer;\r\nimport java.nio.MappedByteBuffer;\r\nimport java.nio.channels.FileChannel;\r\n\r\npublic class TensorFlowLiteClassifier {\r\n\r\n    private Interpreter interpreter;\r\n    public static final String MODEL_FILE = \"1DCNN.tflite\";\r\n    public static final int LABEL_NUM = 2;\r\n\r\n    /**\r\n     * Registers interpreter\r\n     */\r\n    private TensorFlowLiteClassifier(Interpreter interpreter) {\r\n        this.interpreter = interpreter;\r\n    }\r\n\r\n    /**\r\n     * Loads model into interpreter\r\n     */\r\n    public static TensorFlowLiteClassifier classifier(AssetManager assetManager, String modelPath) throws IOException {\r\n        ByteBuffer byteBuffer = loadModelFile(assetManager, modelPath);\r\n        Interpreter interpreter = new Interpreter(byteBuffer);\r\n        return new TensorFlowLiteClassifier(interpreter);\r\n    }\r\n\r\n    /**\r\n     * Loads model\r\n     */\r\n    private static MappedByteBuffer loadModelFile(AssetManager assets, String path) throws IOException {\r\n        AssetFileDescriptor file = assets.openFd(path);\r\n        FileInputStream stream = new FileInputStream(file.getFileDescriptor());\r\n        FileChannel channel = stream.getChannel();\r\n        long startOffset = file.getStartOffset();\r\n        long declaredLength = file.getDeclaredLength();\r\n        return channel.map(FileChannel.MapMode.READ_ONLY, startOffset, declaredLength);\r\n    }\r\n\r\n    /**\r\n     * Function that actually performs inference\r\n     */\r\n    public float[][] predictProbabilities(float[][] input) {\r\n        float[][] output = new float[1][LABEL_NUM];\r\n        interpreter.run(input, output);\r\n        return output;\r\n    }\r\n}\r\n```\r\n\r\nWhen I use 1DCNN.tflite, this class works completely. However, when I change the model into LSTM.tflite, getting ERROR at this line\r\n\r\n```Java\r\nInterpreter interpreter = new Interpreter(byteBuffer);\r\n```\r\n\r\nAnd ERROR logcat is following\r\n**A/libc: Fatal signal 11 (SIGSEGV), code 1, fault addr 0x70 in tid 28007**\r\n\r\nHow can I deal with this unknown error?\r\nAfter my some investigation, this error seems to occur when the prepared array is exceeded for some reason.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34308", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34308/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34308/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34308/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34308", "id": 523489882, "node_id": "MDU6SXNzdWU1MjM0ODk4ODI=", "number": 34308, "title": "Feature Request: Pass 'elapsed_secs' into LoggingHook string formatter.", "user": {"login": "kiunthmo", "id": 37740704, "node_id": "MDQ6VXNlcjM3NzQwNzA0", "avatar_url": "https://avatars0.githubusercontent.com/u/37740704?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kiunthmo", "html_url": "https://github.com/kiunthmo", "followers_url": "https://api.github.com/users/kiunthmo/followers", "following_url": "https://api.github.com/users/kiunthmo/following{/other_user}", "gists_url": "https://api.github.com/users/kiunthmo/gists{/gist_id}", "starred_url": "https://api.github.com/users/kiunthmo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kiunthmo/subscriptions", "organizations_url": "https://api.github.com/users/kiunthmo/orgs", "repos_url": "https://api.github.com/users/kiunthmo/repos", "events_url": "https://api.github.com/users/kiunthmo/events{/privacy}", "received_events_url": "https://api.github.com/users/kiunthmo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1097545817, "node_id": "MDU6TGFiZWwxMDk3NTQ1ODE3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:apis", "name": "comp:apis", "color": "0052cc", "default": false, "description": ""}, {"id": 299643928, "node_id": "MDU6TGFiZWwyOTk2NDM5Mjg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:contributions%20welcome", "name": "stat:contributions welcome", "color": "f4b400", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "karmel", "id": 667809, "node_id": "MDQ6VXNlcjY2NzgwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karmel", "html_url": "https://github.com/karmel", "followers_url": "https://api.github.com/users/karmel/followers", "following_url": "https://api.github.com/users/karmel/following{/other_user}", "gists_url": "https://api.github.com/users/karmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/karmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karmel/subscriptions", "organizations_url": "https://api.github.com/users/karmel/orgs", "repos_url": "https://api.github.com/users/karmel/repos", "events_url": "https://api.github.com/users/karmel/events{/privacy}", "received_events_url": "https://api.github.com/users/karmel/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "karmel", "id": 667809, "node_id": "MDQ6VXNlcjY2NzgwOQ==", "avatar_url": "https://avatars1.githubusercontent.com/u/667809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/karmel", "html_url": "https://github.com/karmel", "followers_url": "https://api.github.com/users/karmel/followers", "following_url": "https://api.github.com/users/karmel/following{/other_user}", "gists_url": "https://api.github.com/users/karmel/gists{/gist_id}", "starred_url": "https://api.github.com/users/karmel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/karmel/subscriptions", "organizations_url": "https://api.github.com/users/karmel/orgs", "repos_url": "https://api.github.com/users/karmel/repos", "events_url": "https://api.github.com/users/karmel/events{/privacy}", "received_events_url": "https://api.github.com/users/karmel/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-11-15T14:08:14Z", "updated_at": "2020-01-30T00:26:55Z", "closed_at": null, "author_association": "NONE", "body": "Can the tf.train.LoggingTensorHook be changed to pass the time elapsed into the string formatter?\r\n\r\nIt would be quite easy to add it to the dictionary of values already being passed to the formatter function. Currently you have to choose between your own custom string formatter, and seeing the time elapsed - I think it would be quite easy to have both with a small change to the code.\r\n\r\nThanks.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34305", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34305/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34305/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34305/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34305", "id": 523362001, "node_id": "MDU6SXNzdWU1MjMzNjIwMDE=", "number": 34305, "title": "Behaviour of the loss function with sample_weights (keras)", "user": {"login": "Emilien-P", "id": 25949358, "node_id": "MDQ6VXNlcjI1OTQ5MzU4", "avatar_url": "https://avatars3.githubusercontent.com/u/25949358?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Emilien-P", "html_url": "https://github.com/Emilien-P", "followers_url": "https://api.github.com/users/Emilien-P/followers", "following_url": "https://api.github.com/users/Emilien-P/following{/other_user}", "gists_url": "https://api.github.com/users/Emilien-P/gists{/gist_id}", "starred_url": "https://api.github.com/users/Emilien-P/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Emilien-P/subscriptions", "organizations_url": "https://api.github.com/users/Emilien-P/orgs", "repos_url": "https://api.github.com/users/Emilien-P/repos", "events_url": "https://api.github.com/users/Emilien-P/events{/privacy}", "received_events_url": "https://api.github.com/users/Emilien-P/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "lamberta", "id": 43051, "node_id": "MDQ6VXNlcjQzMDUx", "avatar_url": "https://avatars2.githubusercontent.com/u/43051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lamberta", "html_url": "https://github.com/lamberta", "followers_url": "https://api.github.com/users/lamberta/followers", "following_url": "https://api.github.com/users/lamberta/following{/other_user}", "gists_url": "https://api.github.com/users/lamberta/gists{/gist_id}", "starred_url": "https://api.github.com/users/lamberta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lamberta/subscriptions", "organizations_url": "https://api.github.com/users/lamberta/orgs", "repos_url": "https://api.github.com/users/lamberta/repos", "events_url": "https://api.github.com/users/lamberta/events{/privacy}", "received_events_url": "https://api.github.com/users/lamberta/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "lamberta", "id": 43051, "node_id": "MDQ6VXNlcjQzMDUx", "avatar_url": "https://avatars2.githubusercontent.com/u/43051?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lamberta", "html_url": "https://github.com/lamberta", "followers_url": "https://api.github.com/users/lamberta/followers", "following_url": "https://api.github.com/users/lamberta/following{/other_user}", "gists_url": "https://api.github.com/users/lamberta/gists{/gist_id}", "starred_url": "https://api.github.com/users/lamberta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lamberta/subscriptions", "organizations_url": "https://api.github.com/users/lamberta/orgs", "repos_url": "https://api.github.com/users/lamberta/repos", "events_url": "https://api.github.com/users/lamberta/events{/privacy}", "received_events_url": "https://api.github.com/users/lamberta/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-11-15T09:40:38Z", "updated_at": "2019-11-19T06:30:49Z", "closed_at": null, "author_association": "NONE", "body": "## URL(s) with the issue:\r\nhttps://www.tensorflow.org/api_docs/python/tf/keras/Model#fit\r\n\r\n## Description of issue (what needs changing):\r\nI think we need a description of how the loss is computed when (temporal) sample_weights are applied, i.e. how is the loss aggregated across samples/time-steps. As addressed in #25178, the behaviour has even changed over time in the external version of Keras from ignoring zero-values to counting them making the situation confusing. \r\n\r\nEven if I agree the current implementation is the right one, I think it is far from intuitive, especially when using zero-weighted zero-padding which decreases the loss value and the effective learning rate.\r\n\r\nI am not very familiar with the structure to be followed in the build-in TF.Keras documentation, but this could be also specified elsewhere than in the `fit` method doc which is already pretty dense.\r\n\r\nSorry if this is specified elsewhere in the doc but I can't find it so if it exists, it should maybe be referenced in the `fit` doc.\r\nThanks a lot,\r\nEmilien"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34291", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34291/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34291/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34291/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34291", "id": 523165442, "node_id": "MDU6SXNzdWU1MjMxNjU0NDI=", "number": 34291, "title": "Error on compiling from source", "user": {"login": "Mithrandir2k18", "id": 41417290, "node_id": "MDQ6VXNlcjQxNDE3Mjkw", "avatar_url": "https://avatars2.githubusercontent.com/u/41417290?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mithrandir2k18", "html_url": "https://github.com/Mithrandir2k18", "followers_url": "https://api.github.com/users/Mithrandir2k18/followers", "following_url": "https://api.github.com/users/Mithrandir2k18/following{/other_user}", "gists_url": "https://api.github.com/users/Mithrandir2k18/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mithrandir2k18/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mithrandir2k18/subscriptions", "organizations_url": "https://api.github.com/users/Mithrandir2k18/orgs", "repos_url": "https://api.github.com/users/Mithrandir2k18/repos", "events_url": "https://api.github.com/users/Mithrandir2k18/events{/privacy}", "received_events_url": "https://api.github.com/users/Mithrandir2k18/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 1205615612, "node_id": "MDU6TGFiZWwxMjA1NjE1NjEy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/subtype:%20ubuntu/linux", "name": "subtype: ubuntu/linux", "color": "b619ea", "default": false, "description": "Ubuntu/Linux Build/Installation Issues"}, {"id": 473173351, "node_id": "MDU6TGFiZWw0NzMxNzMzNTE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:build/install", "name": "type:build/install", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "angerson", "id": 32465472, "node_id": "MDQ6VXNlcjMyNDY1NDcy", "avatar_url": "https://avatars2.githubusercontent.com/u/32465472?v=4", "gravatar_id": "", "url": "https://api.github.com/users/angerson", "html_url": "https://github.com/angerson", "followers_url": "https://api.github.com/users/angerson/followers", "following_url": "https://api.github.com/users/angerson/following{/other_user}", "gists_url": "https://api.github.com/users/angerson/gists{/gist_id}", "starred_url": "https://api.github.com/users/angerson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/angerson/subscriptions", "organizations_url": "https://api.github.com/users/angerson/orgs", "repos_url": "https://api.github.com/users/angerson/repos", "events_url": "https://api.github.com/users/angerson/events{/privacy}", "received_events_url": "https://api.github.com/users/angerson/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-11-14T23:33:03Z", "updated_at": "2020-02-24T14:49:07Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux archlinux 5.3.11-arch1-1 x86_64 GNU/Linux\r\n\r\n- TensorFlow installed from (source or binary): source \r\n- TensorFlow version: commit hash: 872b1ab23f0aac182d5b2051f45d5d003963bfe3\r\n- Python version: 3.7.5\r\n- Installed using virtualenv? pip? conda?: conda\r\n- Bazel version (if compiling from source): bazel 0.29.1- (@non-git)\r\n- GCC/Compiler version (if compiling from source): gcc (GCC) 9.2.0\r\n- CUDA/cuDNN/TensorRT version: 10.1.243-2/7.6.4.38-1/6.0.1.5-1\r\n- GPU model and memory: nVidia RTX 2080 8GB\r\n\r\n\r\n**Describe the problem**\r\nCompiling with bazel fails: \r\nERROR: /home/jaaq/.cache/bazel/_bazel_jaaq/c463894dd2648fc5b64eeed02cc022b5/external/grpc/BUILD:507:1: C++ compilation of rule '@grpc//:gpr_base' failed (Exit 1)\r\n\r\n**Provide the exact sequence of commands / steps that you executed before running into the problem**\r\n```\r\ngit clone repo\r\ncd tensorflow\r\nsource /opt/anaconda/bin/activate\r\nconda activate python375env\r\n./configure (Yes on XLA JIT, CUDA, TensorRT, clang)\r\nbazel build //tensorflow/tools/pip_package:build_pip_package\r\n```\r\n\r\n**Any other info / logs**\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\nERROR: /home/jaaq/.cache/bazel/_bazel_jaaq/c463894dd2648fc5b64eeed02cc022b5/external/grpc/BUILD:507:1: C++ compilation of rule '@grpc//:gpr_base' failed (Exit 1)\r\nexternal/grpc/src/core/lib/gpr/log_linux.cc:43:13: error: ambiguating new declaration of 'long int gettid()'\r\n static long gettid(void) { return syscall(__NR_gettid); }\r\n             ^~~~~~\r\nIn file included from /usr/include/unistd.h:1170,\r\n                 from external/grpc/src/core/lib/gpr/log_linux.cc:41:\r\n/usr/include/bits/unistd_ext.h:34:16: note: old declaration '__pid_t gettid()'\r\n extern __pid_t gettid (void) __THROW;\r\n                ^~~~~~\r\nexternal/grpc/src/core/lib/gpr/log_linux.cc:43:13: warning: 'long int gettid()' defined but not used [-Wunused-function]\r\n static long gettid(void) { return syscall(__NR_gettid); }\r\n             ^~~~~~\r\nTarget //tensorflow/tools/pip_package:build_pip_package failed to build\r\nUse --verbose_failures to see the command lines of failed build steps.\r\nINFO: Elapsed time: 89.815s, Critical Path: 22.19s\r\nINFO: 1215 processes: 1215 local.\r\nFAILED: Build did NOT complete successfully\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34290", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34290/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34290/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34290/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34290", "id": 523157910, "node_id": "MDU6SXNzdWU1MjMxNTc5MTA=", "number": 34290, "title": "Brackets in directory for tf.train.CheckpointManager in TF2.0", "user": {"login": "klanderson", "id": 2374371, "node_id": "MDQ6VXNlcjIzNzQzNzE=", "avatar_url": "https://avatars3.githubusercontent.com/u/2374371?v=4", "gravatar_id": "", "url": "https://api.github.com/users/klanderson", "html_url": "https://github.com/klanderson", "followers_url": "https://api.github.com/users/klanderson/followers", "following_url": "https://api.github.com/users/klanderson/following{/other_user}", "gists_url": "https://api.github.com/users/klanderson/gists{/gist_id}", "starred_url": "https://api.github.com/users/klanderson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/klanderson/subscriptions", "organizations_url": "https://api.github.com/users/klanderson/orgs", "repos_url": "https://api.github.com/users/klanderson/repos", "events_url": "https://api.github.com/users/klanderson/events{/privacy}", "received_events_url": "https://api.github.com/users/klanderson/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 736653459, "node_id": "MDU6TGFiZWw3MzY2NTM0NTk=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:eager", "name": "comp:eager", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "allenlavoie", "id": 3731025, "node_id": "MDQ6VXNlcjM3MzEwMjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3731025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allenlavoie", "html_url": "https://github.com/allenlavoie", "followers_url": "https://api.github.com/users/allenlavoie/followers", "following_url": "https://api.github.com/users/allenlavoie/following{/other_user}", "gists_url": "https://api.github.com/users/allenlavoie/gists{/gist_id}", "starred_url": "https://api.github.com/users/allenlavoie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allenlavoie/subscriptions", "organizations_url": "https://api.github.com/users/allenlavoie/orgs", "repos_url": "https://api.github.com/users/allenlavoie/repos", "events_url": "https://api.github.com/users/allenlavoie/events{/privacy}", "received_events_url": "https://api.github.com/users/allenlavoie/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "allenlavoie", "id": 3731025, "node_id": "MDQ6VXNlcjM3MzEwMjU=", "avatar_url": "https://avatars3.githubusercontent.com/u/3731025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/allenlavoie", "html_url": "https://github.com/allenlavoie", "followers_url": "https://api.github.com/users/allenlavoie/followers", "following_url": "https://api.github.com/users/allenlavoie/following{/other_user}", "gists_url": "https://api.github.com/users/allenlavoie/gists{/gist_id}", "starred_url": "https://api.github.com/users/allenlavoie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/allenlavoie/subscriptions", "organizations_url": "https://api.github.com/users/allenlavoie/orgs", "repos_url": "https://api.github.com/users/allenlavoie/repos", "events_url": "https://api.github.com/users/allenlavoie/events{/privacy}", "received_events_url": "https://api.github.com/users/allenlavoie/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-11-14T23:11:42Z", "updated_at": "2019-11-20T21:35:14Z", "closed_at": null, "author_association": "NONE", "body": "\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): **yes**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): **Linux Debian (GCP notebook)**\r\n- TensorFlow installed from (source or binary): **preinstalled on GCP notebook**\r\n- TensorFlow version (use command below): **2.0.0**\r\n- Python version: **3.5.3**\r\n- GPU model and memory: **None**\r\n\r\n**Describe the current behavior**\r\nThis problem concerns tf.train.CheckpointManager and tf.train.Checkpoint in TF 2.0. If the checkpoint directory contains square brackets (`[` or `]`), then loading checkpoints with tf.train.Checkpoint.restore fails. CheckpointManager will save and track checkpoints as expected but does not remove them according to `max_to_keep`.\r\n\r\nI see that square brackets are [not recommended](https://cloud.google.com/storage/docs/naming) for Google Cloud Storage blobs, however this happens for both checkpoints stored in Google Cloud Storage and checkpoints stored locally.\r\n\r\nAs an example:\r\nValid checkpoints exist in `/tmp/checkpoints_[with]_bracket/` Calling\r\n```\r\ncheckpoint_dir = '/tmp/checkpoints_[with]_bracket/'\r\ntf.train.Checkpoint.restore(tf.train.latest_checkpoint(checkpoint_dir))\r\n```\r\nGives the error:\r\n```\r\nNotFoundError: Unsuccessful TensorSliceReader constructor: Failed to find any matching files for /tmp/checkpoints_[with]_bracket/ckpt-4\r\n```\r\n\r\n**Describe the expected behavior**\r\n\r\n- Allow square brackets in the checkpoint path\r\nor\r\n- fail at CheckpointManager creation if `directory` parameter contains disallowed characters \r\n\r\n**Code to reproduce the issue**\r\nProvide a reproducible test case that is the bare minimum necessary to generate the problem.\r\n\r\n**[https://gist.github.com/klanderson/be46cc3e3f7e6575bd2a45450c0ac102](https://gist.github.com/klanderson/be46cc3e3f7e6575bd2a45450c0ac102)\r\nCode works as-is. Add a bracket somewhere in the path in `Line 28` to see error**\r\n\r\n\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34289", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34289/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34289/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34289/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34289", "id": 523155719, "node_id": "MDU6SXNzdWU1MjMxNTU3MTk=", "number": 34289, "title": "Couldn't quantize a model with QUANTIZED_UINT8 if output layer don't have activation", "user": {"login": "dojipkim", "id": 57776540, "node_id": "MDQ6VXNlcjU3Nzc2NTQw", "avatar_url": "https://avatars1.githubusercontent.com/u/57776540?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dojipkim", "html_url": "https://github.com/dojipkim", "followers_url": "https://api.github.com/users/dojipkim/followers", "following_url": "https://api.github.com/users/dojipkim/following{/other_user}", "gists_url": "https://api.github.com/users/dojipkim/gists{/gist_id}", "starred_url": "https://api.github.com/users/dojipkim/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dojipkim/subscriptions", "organizations_url": "https://api.github.com/users/dojipkim/orgs", "repos_url": "https://api.github.com/users/dojipkim/repos", "events_url": "https://api.github.com/users/dojipkim/events{/privacy}", "received_events_url": "https://api.github.com/users/dojipkim/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "liyunlu0618", "id": 9705880, "node_id": "MDQ6VXNlcjk3MDU4ODA=", "avatar_url": "https://avatars1.githubusercontent.com/u/9705880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liyunlu0618", "html_url": "https://github.com/liyunlu0618", "followers_url": "https://api.github.com/users/liyunlu0618/followers", "following_url": "https://api.github.com/users/liyunlu0618/following{/other_user}", "gists_url": "https://api.github.com/users/liyunlu0618/gists{/gist_id}", "starred_url": "https://api.github.com/users/liyunlu0618/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liyunlu0618/subscriptions", "organizations_url": "https://api.github.com/users/liyunlu0618/orgs", "repos_url": "https://api.github.com/users/liyunlu0618/repos", "events_url": "https://api.github.com/users/liyunlu0618/events{/privacy}", "received_events_url": "https://api.github.com/users/liyunlu0618/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-11-14T23:05:42Z", "updated_at": "2019-11-24T05:02:17Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04\r\n- TensorFlow installed from (source or binary): installed a binary with Conda\r\n- TensorFlow version (or github SHA if from source): 1.14.0\r\n\r\n\r\n**Command used to run the converter or code if you\u2019re using the Python API**\r\n\r\n```\r\nimport tensorflow as tf\r\nfrom tensorflow import keras\r\n\r\nimport numpy as np\r\nimport matplotlib.pyplot as plt\r\n\r\nfashion_mnist = keras.datasets.fashion_mnist\r\n(train_images, train_labels), (test_images, test_labels) = fashion_mnist.load_data()\r\n\r\ntrain_images = train_images / 255.0\r\ntest_images = test_images / 255.0\r\n\r\ndef build_keras_model():\r\n  return keras.Sequential([\r\n    keras.layers.Flatten(input_shape=(28,28)),\r\n    keras.layers.Dense(128, activation='relu'),\r\n    keras.layers.BatchNormalization(),\r\n    keras.layers.Dense(10)\r\n  ])\r\n\r\ntrain_graph = tf.Graph()\r\ntrain_sess = tf.Session(graph=train_graph)\r\n\r\nkeras.backend.set_session(train_sess)\r\nwith train_graph.as_default():\r\n  train_model = build_keras_model()\r\n\r\n  tf.contrib.quantize.create_training_graph(input_graph=train_graph, quant_delay=100)\r\n  train_sess.run(tf.global_variables_initializer())\r\n\r\n  train_model.compile(\r\n    optimizer='adam',\r\n    loss='sparse_categorical_crossentropy',\r\n    metrics=['accuracy']\r\n  )\r\n  train_model.fit(train_images, train_labels, epochs=5)\r\n\r\n  saver = tf.train.Saver()\r\n  saver.save(train_sess, 'checkpoints')\r\n\r\neval_graph = tf.Graph()\r\neval_sess = tf.Session(graph=eval_graph)\r\n\r\nkeras.backend.set_session(eval_sess)\r\n\r\nwith eval_graph.as_default():\r\n  keras.backend.set_learning_phase(0)\r\n  eval_model = build_keras_model()\r\n  tf.contrib.quantize.create_eval_graph(input_graph=eval_graph)\r\n  eval_graph_def = eval_graph.as_graph_def()\r\n  saver = tf.train.Saver()\r\n  saver.restore(eval_sess, 'checkpoints')\r\n\r\n  frozen_graph_def = tf.graph_util.convert_variables_to_constants(\r\n    eval_sess,\r\n    eval_graph_def,\r\n    [eval_model.output.op.name]\r\n  )\r\n  with open('frozen_model.pb', 'wb') as f:\r\n    f.write(frozen_graph_def.SerializeToString())\r\n\r\nconverter = tf.lite.TFLiteConverter.from_frozen_graph(\r\n  'frozen_model.pb',\r\n  ['flatten_input'],\r\n  ['dense_1/BiasAdd'])\r\nconverter.inference_type = tf.lite.constants.QUANTIZED_UINT8\r\ninput_arrays = converter.get_input_arrays()\r\nconverter.quantized_input_stats = {input_arrays[0] : (0, 255)}  # mean, std_dev\r\ntflite_model = converter.convert()\r\nopen('model.tflite', 'wb').write(tflite_model)\r\n```\r\n\r\n**The output from the converter invocation**\r\n\r\n```\r\n---------------------------------------------------------------------------\r\nConverterError                            Traceback (most recent call last)\r\n<ipython-input-18-c82690488195> in <module>\r\n      6 input_arrays = converter.get_input_arrays()\r\n      7 converter.quantized_input_stats = {input_arrays[0] : (0, 255)}  # mean, std_dev\r\n----> 8 tflite_model = converter.convert()\r\n      9 open('model.tflite', 'wb').write(tflite_model)\r\n\r\n~/anaconda3/envs/tensorflow/lib/python3.6/site-packages/tensorflow/lite/python/lite.py in convert(self)\r\n    896           input_tensors=self._input_tensors,\r\n    897           output_tensors=self._output_tensors,\r\n--> 898           **converter_kwargs)\r\n    899     else:\r\n    900       result = _toco_convert_graph_def(\r\n\r\n~/anaconda3/envs/tensorflow/lib/python3.6/site-packages/tensorflow/lite/python/convert.py in toco_convert_impl(input_data, input_tensors, output_tensors, *args, **kwargs)\r\n    402   data = toco_convert_protos(model_flags.SerializeToString(),\r\n    403                              toco_flags.SerializeToString(),\r\n--> 404                              input_data.SerializeToString())\r\n    405   return data\r\n    406 \r\n\r\n~/anaconda3/envs/tensorflow/lib/python3.6/site-packages/tensorflow/lite/python/convert.py in toco_convert_protos(model_flags_str, toco_flags_str, input_data_str)\r\n    170       stderr = _try_convert_to_unicode(stderr)\r\n    171       raise ConverterError(\r\n--> 172           \"TOCO failed. See console for info.\\n%s\\n%s\\n\" % (stdout, stderr))\r\n    173   finally:\r\n    174     # Must manually cleanup files.\r\n\r\nConverterError: TOCO failed. See console for info.\r\n2019-11-14 14:46:19.525955: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 39 operators, 63 arrays (0 quantized)\r\n2019-11-14 14:46:19.526224: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 39 operators, 63 arrays (0 quantized)\r\n2019-11-14 14:46:19.527392: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 1: 10 operators, 18 arrays (1 quantized)\r\n2019-11-14 14:46:19.527775: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 2: 9 operators, 17 arrays (1 quantized)\r\n2019-11-14 14:46:19.527893: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After general graph transformations pass 3: 8 operators, 15 arrays (1 quantized)\r\n2019-11-14 14:46:19.527982: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before pre-quantization graph transformations: 8 operators, 15 arrays (1 quantized)\r\n2019-11-14 14:46:19.528015: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] After pre-quantization graph transformations pass 1: 5 operators, 12 arrays (1 quantized)\r\n2019-11-14 14:46:19.528050: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before Group bidirectional sequence lstm/rnn: 5 operators, 12 arrays (1 quantized)\r\n2019-11-14 14:46:19.528084: I tensorflow/lite/toco/graph_transformations/graph_transformations.cc:39] Before quantization graph transformations: 5 operators, 12 arrays (1 quantized)\r\n2019-11-14 14:46:19.529767: W tensorflow/lite/toco/graph_transformations/quantize.cc:132] Constant array batch_normalization/batchnorm/mul lacks MinMax information. To make up for that, we will now compute the MinMax from actual array elements. That will result in quantization parameters that probably do not match whichever arithmetic was used during training, and thus will probably be a cause of poor inference accuracy.\r\n2019-11-14 14:46:19.529796: W tensorflow/lite/toco/graph_transformations/quantize.cc:132] Constant array batch_normalization/batchnorm/sub lacks MinMax information. To make up for that, we will now compute the MinMax from actual array elements. That will result in quantization parameters that probably do not match whichever arithmetic was used during training, and thus will probably be a cause of poor inference accuracy.\r\n2019-11-14 14:46:19.529847: F tensorflow/lite/toco/graph_transformations/quantize.cc:149] Array dense_1/BiasAdd does not have MinMax information, and is not a constant array. Cannot proceed with quantization.\r\nFatal Python error: Aborted\r\n\r\nCurrent thread 0x00007f40e79dd700 (most recent call first):\r\n  File \"/home/dojip.kim/anaconda3/envs/tensorflow/lib/python3.6/site-packages/tensorflow/lite/toco/python/toco_from_protos.py\", line 33 in execute\r\n  File \"/home/dojip.kim/anaconda3/envs/tensorflow/lib/python3.6/site-packages/absl/app.py\", line 251 in _run_main\r\n  File \"/home/dojip.kim/anaconda3/envs/tensorflow/lib/python3.6/site-packages/absl/app.py\", line 300 in run\r\n  File \"/home/dojip.kim/anaconda3/envs/tensorflow/lib/python3.6/site-packages/tensorflow/python/platform/app.py\", line 40 in run\r\n  File \"/home/dojip.kim/anaconda3/envs/tensorflow/lib/python3.6/site-packages/tensorflow/lite/toco/python/toco_from_protos.py\", line 59 in main\r\n  File \"/home/dojip.kim/anaconda3/envs/tensorflow/bin/toco_from_protos\", line 11 in <module>\r\n```\r\n\r\n**Also, please include a link to the saved model or GraphDef**\r\n\r\n```\r\n# Put link here or attach to the issue.\r\n```\r\n\r\n**Failure details**\r\nI could quantize a model with QUNATIZED_UINT8 if output layer have activation like 'softmax'.  I want to quantize a model without the activation function for the final output. In that case, I couldn't quantize it.\r\n\r\n2019-11-14 14:46:19.529847: F tensorflow/lite/toco/graph_transformations/quantize.cc:149] Array dense_1/BiasAdd does not have MinMax information, and is not a constant array. Cannot proceed with quantization.\r\nFatal Python error: Aborted\r\n\r\nPlease let me know how to quantize a model.\r\n\r\n**Any other info / logs**\r\n\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34286", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34286/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34286/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34286/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34286", "id": 523137553, "node_id": "MDU6SXNzdWU1MjMxMzc1NTM=", "number": 34286, "title": "TFLite crash (SIGABRT) while running Conv3D on Android", "user": {"login": "Mr-Grieves", "id": 19175336, "node_id": "MDQ6VXNlcjE5MTc1MzM2", "avatar_url": "https://avatars2.githubusercontent.com/u/19175336?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Mr-Grieves", "html_url": "https://github.com/Mr-Grieves", "followers_url": "https://api.github.com/users/Mr-Grieves/followers", "following_url": "https://api.github.com/users/Mr-Grieves/following{/other_user}", "gists_url": "https://api.github.com/users/Mr-Grieves/gists{/gist_id}", "starred_url": "https://api.github.com/users/Mr-Grieves/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Mr-Grieves/subscriptions", "organizations_url": "https://api.github.com/users/Mr-Grieves/orgs", "repos_url": "https://api.github.com/users/Mr-Grieves/repos", "events_url": "https://api.github.com/users/Mr-Grieves/events{/privacy}", "received_events_url": "https://api.github.com/users/Mr-Grieves/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 6, "created_at": "2019-11-14T22:20:36Z", "updated_at": "2019-12-04T17:22:11Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code: yes\r\n- OS Platform and Distribution: Build environment is Linux Ubuntu 16.04 \r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: Runtime environment is Samsung s8+\r\n- TensorFlow installed from (source or binary): built from source with select-tf-ops using: \r\n```\r\nbazel build --cxxopt='--std=c++11' -c opt \\\r\n --config=android_arm --config=monolithic \\\r\n //tensorflow/lite/java:tensorflow-lite-with-select-tf-ops\r\n```\r\n- TensorFlow version: 1.15.0rc2\r\n- Keras version: 2.2.4-tf\r\n- Python version: 3.6.8\r\n- Bazel version (if compiling from source): 0.25.2\r\n- GCC/Compiler version (if compiling from source): 5.4.0\r\n- CUDA/cuDNN version: 10.0\r\n- GPU model and memory: not relevant\r\n\r\n**Describe the current behavior**\r\nI am trying to get a network (with conv3d ops) to run on my Android system using TFLite. I have followed all the steps mentioned [here](https://www.tensorflow.org/lite/guide/ops_select), and I can convert the network without issue. During runtime, I also appear to be able to load the converted tflite model without issue, however, during my call to `runForMultipleInputsOutputs()`, tflite crashes giving me a SIBABRT coming from libtensorflowlite_flex_jni.so (full stack trace below).\r\n\r\n**Describe the expected behavior**\r\nI expect it to not crash when running\r\n\r\n**Code to reproduce the issue**\r\nI made a dummy network to try and isolate the issue. I built the network using the following:\r\n```\r\nimport tensorflow as tf\r\nimport numpy as np\r\n\r\nmodel = tf.keras.models.Sequential()\r\nmodel.add(tf.keras.layers.Conv3D(1, (4, 4, 4), input_shape=(4, 8, 8, 1), name='conv'))\r\nmodel.compile(loss=tf.keras.losses.sparse_categorical_crossentropy,\r\n                      optimizer=tf.keras.optimizers.RMSprop(lr=0.0001),\r\n                      metrics=[tf.keras.metrics.categorical_accuracy])\r\n\r\nx = np.random.random((1, 4, 8, 8, 1))\r\ny = np.random.random((1, 1, 5, 5, 1))\r\nmodel.train_on_batch(x, y)\r\nmodel.predict(x)\r\n\r\n# Save tf.keras model in HDF5 format\r\nkeras_file = \"conv3d.h5\"\r\ntf.keras.models.save_model(model, keras_file)\r\n\r\n# Convert the model to tflite format\r\nconverter = tf.lite.TFLiteConverter.from_keras_model_file(keras_file)\r\nconverter.target_ops = [tf.lite.OpsSet.TFLITE_BUILTINS,\r\n                                       tf.lite.OpsSet.SELECT_TF_OPS]\r\ntflite_model = converter.convert()\r\nopen(\"conv3d.tflite\", \"wb\").write(tflite_model)\r\n```\r\n\r\nI then load and run the model on the android using ByteBuffers to hold the input/outputs. I can provide this code if requested, but I don't suspect it to be the problem as I use it for other working projects. I'm confident that this is a conv3d issue, because I have also built a **conv2d** dummy network, using the exact same build procedure + runtime environment, and it runs without crashing.\r\n\r\n**Other info / logs**\r\nThe full android backtrace during the call to runForMultipleInputsOutputs():\r\n```\r\nA/DEBUG: *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***\r\nA/DEBUG: Build fingerprint: 'samsung/dream2ltexx/dream2lte:9/PPR1.180610.011/G955FXXS5DSI1:user/release-keys'\r\nA/DEBUG: Revision: '10'\r\nA/DEBUG: ABI: 'arm'\r\nA/DEBUG: pid: 6774, tid: 6817, name: Thread-2  >>> com.segmentation.qussegserviceNVW <<<\r\nA/DEBUG: signal 6 (SIGABRT), code -6 (SI_TKILL), fault addr --------\r\nA/DEBUG:     r0  00000000  r1  00001aa1  r2  00000006  r3  00000008\r\nA/DEBUG:     r4  00001a76  r5  00001aa1  r6  b7628eac  r7  0000010c\r\nA/DEBUG:     r8  b7629014  r9  b7628fa0  r10 b762903c  r11 e4095c70\r\nA/DEBUG:     ip  b7628e48  sp  b7628e98  lr  e6c73e71  pc  e6c6ae62\r\nA/DEBUG: backtrace:\r\nA/DEBUG:     #00 pc 0001ce62  /system/lib/libc.so (abort+58)\r\nA/DEBUG:     #01 pc 002181cd  /data/app/com.segmentation.qussegserviceNVW-52gMpws9Z9fl4lOXs6XvOw==/lib/arm/libtensorflowlite_flex_jni.so\r\nA/DEBUG:     #02 pc 002213fd  /data/app/com.segmentation.qussegserviceNVW-52gMpws9Z9fl4lOXs6XvOw==/lib/arm/libtensorflowlite_flex_jni.so\r\nA/DEBUG:     #03 pc 00225795  /data/app/com.segmentation.qussegserviceNVW-52gMpws9Z9fl4lOXs6XvOw==/lib/arm/libtensorflowlite_flex_jni.so\r\nA/DEBUG:     #04 pc 0021fb63  /data/app/com.segmentation.qussegserviceNVW-52gMpws9Z9fl4lOXs6XvOw==/lib/arm/libtensorflowlite_flex_jni.so\r\nA/DEBUG:     #05 pc 00335dcd  /data/app/com.segmentation.qussegserviceNVW-52gMpws9Z9fl4lOXs6XvOw==/lib/arm/libtensorflowlite_flex_jni.so\r\nA/DEBUG:     #06 pc 00338313  /data/app/com.segmentation.qussegserviceNVW-52gMpws9Z9fl4lOXs6XvOw==/lib/arm/libtensorflowlite_flex_jni.so\r\nA/DEBUG:     #07 pc 0020925b  /data/app/com.segmentation.qussegserviceNVW-52gMpws9Z9fl4lOXs6XvOw==/lib/arm/libtensorflowlite_flex_jni.so (Java_org_tensorflow_lite_NativeInterpreterWrapper_run+26)\r\nA/DEBUG:     #08 pc 00415879  /system/lib/libart.so (art_quick_generic_jni_trampoline+40)\r\nA/DEBUG:     #09 pc 00411375  /system/lib/libart.so (art_quick_invoke_stub_internal+68)\r\nA/DEBUG:     #10 pc 003ea57b  /system/lib/libart.so (art_quick_invoke_static_stub+222)\r\nA/DEBUG:     #11 pc 000a1627  /system/lib/libart.so (art::ArtMethod::Invoke(art::Thread*, unsigned int*, unsigned int, art::JValue*, char const*)+154)\r\nA/DEBUG:     #12 pc 001e88c9  /system/lib/libart.so (art::interpreter::ArtInterpreterToCompiledCodeBridge(art::Thread*, art::ArtMethod*, art::ShadowFrame*, unsigned short, art::JValue*)+236)\r\nA/DEBUG:     #13 pc 001e33b7  /system/lib/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+814)\r\nA/DEBUG:     #14 pc 003e60af  /system/lib/libart.so (MterpInvokeStatic+130)\r\nA/DEBUG:     #15 pc 00404294  /system/lib/libart.so (ExecuteMterpImpl+14612)\r\nA/DEBUG:     #16 pc 001aa16c  /dev/ashmem/dalvik-classes.dex extracted in memory from /data/app/com.segmentation.qussegserviceNVW-52gMpws9Z9fl4lOXs6XvOw==/base.apk_6774_6774 (deleted) (org.tensorflow.lite.NativeInterpreterWrapper.run+164)\r\nA/DEBUG:     #17 pc 001c7b33  /system/lib/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.2760711098+378)\r\nA/DEBUG:     #18 pc 001cc219  /system/lib/libart.so (art::interpreter::ArtInterpreterToInterpreterBridge(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*, art::JValue*)+152)\r\nA/DEBUG:     #19 pc 001e339f  /system/lib/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+790)\r\nA/DEBUG:     #20 pc 003e50d3  /system/lib/libart.so (MterpInvokeVirtual+442)\r\nA/DEBUG:     #21 pc 00404114  /system/lib/libart.so (ExecuteMterpImpl+14228)\r\nA/DEBUG:     #22 pc 001a9962  /dev/ashmem/dalvik-classes.dex extracted in memory from /data/app/com.segmentation.qussegserviceNVW-52gMpws9Z9fl4lOXs6XvOw==/base.apk_6774_6774 (deleted) (org.tensorflow.lite.Interpreter.runForMultipleInputsOutputs+10)\r\nA/DEBUG:     #23 pc 001c7b33  /system/lib/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.2760711098+378)\r\nA/DEBUG:     #24 pc 001cc15f  /system/lib/libart.so (art::interpreter::EnterInterpreterFromEntryPoint(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*)+82)\r\nA/DEBUG:     #25 pc 003d8bb9  /system/lib/libart.so (artQuickToInterpreterBridge+880)\r\nA/DEBUG:     #26 pc 004158ff  /system/lib/libart.so (art_quick_to_interpreter_bridge+30)\r\nA/DEBUG:     #27 pc 0001c0fd  /dev/ashmem/dalvik-jit-code-cache_6774_6774 (deleted) (com.segmentation.qussegserviceNVW.TensorFlowSegmentRunner$SegNetRunner.segmentChunk+492)\r\nA/DEBUG:     #28 pc 004113bb  /system/lib/libart.so (art_quick_osr_stub+42)\r\nA/DEBUG:     #29 pc 0024d8a9  /system/lib/libart.so (art::jit::Jit::MaybeDoOnStackReplacement(art::Thread*, art::ArtMethod*, unsigned int, int, art::JValue*)+1388)\r\nA/DEBUG:     #30 pc 003e9aab  /system/lib/libart.so (MterpMaybeDoOnStackReplacement+86)\r\nA/DEBUG:     #31 pc 00410bf4  /system/lib/libart.so (ExecuteMterpImpl+66164)\r\nA/DEBUG:     #32 pc 0002e7b8  /dev/ashmem/dalvik-classes2.dex extracted in memory from /data/app/com.segmentation.qussegserviceNVW-52gMpws9Z9fl4lOXs6XvOw==/base.apk!classes2.dex_6774_6774 (deleted) (com.segmentation.qussegserviceNVW.TensorFlowSegmentRunner$SegNetRunner.segmentChunk+76)\r\nA/DEBUG:     #33 pc 001c7b33  /system/lib/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.2760711098+378)\r\nA/DEBUG:     #34 pc 001cc219  /system/lib/libart.so (art::interpreter::ArtInterpreterToInterpreterBridge(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*, art::JValue*)+152)\r\nA/DEBUG:     #35 pc 001e339f  /system/lib/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+790)\r\nA/DEBUG:     #36 pc 003e5f61  /system/lib/libart.so (MterpInvokeDirect+196)\r\nA/DEBUG:     #37 pc 00404214  /system/lib/libart.so (ExecuteMterpImpl+14484)\r\nA/DEBUG:     #38 pc 0002e750  /dev/ashmem/dalvik-classes2.dex extracted in memory from /data/app/com.segmentation.qussegserviceNVW-52gMpws9Z9fl4lOXs6XvOw==/base.apk!classes2.dex_6774_6774 (deleted) (com.segmentation.qussegserviceNVW.TensorFlowSegmentRunner$SegNetRunner.access$100)\r\nA/DEBUG:     #39 pc 001c7b33  /system/lib/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.2760711098+378)\r\nA/DEBUG:     #40 pc 001cc15f  /system/lib/libart.so (art::interpreter::EnterInterpreterFromEntryPoint(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*)+82)\r\nA/DEBUG:     #41 pc 003d8bb9  /system/lib/libart.so (artQuickToInterpreterBridge+880)\r\nA/DEBUG:     #42 pc 004158ff  /system/lib/libart.so (art_quick_to_interpreter_bridge+30)\r\nA/DEBUG:     #43 pc 0001b5fd  /dev/ashmem/dalvik-jit-code-cache_6774_6774 (deleted) (com.segmentation.qussegserviceNVW.TensorFlowSegmentRunner.segmentFrame+604)\r\nA/DEBUG:     #44 pc 00411375  /system/lib/libart.so (art_quick_invoke_stub_internal+68)\r\nA/DEBUG:     #45 pc 003ea479  /system/lib/libart.so (art_quick_invoke_stub+224)\r\nA/DEBUG:     #46 pc 000a1615  /system/lib/libart.so (art::ArtMethod::Invoke(art::Thread*, unsigned int*, unsigned int, art::JValue*, char const*)+136)\r\nA/DEBUG:     #47 pc 001e88c9  /system/lib/libart.so (art::interpreter::ArtInterpreterToCompiledCodeBridge(art::Thread*, art::ArtMethod*, art::ShadowFrame*, unsigned short, art::JValue*)+236)\r\nA/DEBUG:     #48 pc 001e33b7  /system/lib/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+814)\r\nA/DEBUG:     #49 pc 003e50d3  /system/lib/libart.so (MterpInvokeVirtual+442)\r\nA/DEBUG:     #50 pc 00404114  /system/lib/libart.so (ExecuteMterpImpl+14228)\r\nA/DEBUG:     #51 pc 0002edb4  /dev/ashmem/dalvik-classes2.dex extracted in memory from /data/app/com.segmentation.qussegserviceNVW-52gMpws9Z9fl4lOXs6XvOw==/base.apk!classes2.dex_6774_6774 (deleted) (com.segmentation.qussegserviceNVW.TensorFlowSegmentRunner.segmentCine+40)\r\nA/DEBUG:     #52 pc 001c7b33  /system/lib/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.2760711098+378)\r\nA/DEBUG:     #53 pc 001cc219  /system/lib/libart.so (art::interpreter::ArtInterpreterToInterpreterBridge(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*, art::JValue*)+152)\r\nA/DEBUG:     #54 pc 001e339f  /system/lib/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+790)\r\nA/DEBUG:     #55 pc 003e5ca3  /system/lib/libart.so (MterpInvokeInterface+1010)\r\nA/DEBUG:     #56 pc 00404314  /system/lib/libart.so (ExecuteMterpImpl+14740)\r\nA/DEBUG:     #57 pc 00028310  /dev/ashmem/dalvik-classes2.dex extracted in memory from /data/app/com.segmentation.qussegserviceNVW-52gMpws9Z9fl4lOXs6XvOw==/base.apk!classes2.dex_6774_6774 (deleted) (com.segmentation.qussegserviceNVW.CinePlayerActivity$3$1.run+20)\r\nA/DEBUG:     #58 pc 001c7b33  /system/lib/libart.so (_ZN3art11interpreterL7ExecuteEPNS_6ThreadERKNS_20CodeItemDataAccessorERNS_11ShadowFrameENS_6JValueEb.llvm.2760711098+378)\r\nA/DEBUG:     #59 pc 001cc15f  /system/lib/libart.so (art::interpreter::EnterInterpreterFromEntryPoint(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame*)+82)\r\nA/DEBUG:     #60 pc 003d8bb9  /system/lib/libart.so (artQuickToInterpreterBridge+880)\r\nA/DEBUG:     #61 pc 004158ff  /system/lib/libart.so (art_quick_to_interpreter_bridge+30)\r\nA/DEBUG:     #62 pc 00411375  /system/lib/libart.so (art_quick_invoke_stub_internal+68)\r\nA/DEBUG:     #63 pc 003ea479  /system/lib/libart.so (art_quick_invoke_stub+224)\r\nA/DEBUG:     #64 pc 000a1615  /system/lib/libart.so (art::ArtMethod::Invoke(art::Thread*, unsigned int*, unsigned int, art::JValue*, char const*)+136)\r\nA/DEBUG:     #65 pc 0034b0c5  /system/lib/libart.so (art::(anonymous namespace)::InvokeWithArgArray(art::ScopedObjectAccessAlreadyRunnable const&, art::ArtMethod*, art::(anonymous namespace)::ArgArray*, art::JValue*, char const*)+52)\r\nA/DEBUG:     #66 pc 0034be1d  /system/lib/libart.so (art::InvokeVirtualOrInterfaceWithJValues(art::ScopedObjectAccessAlreadyRunnable const&, _jobject*, _jmethodID*, jvalue*)+320)\r\nA/DEBUG:     #67 pc 0036d203  /system/lib/libart.so (art::Thread::CreateCallback(void*)+866)\r\nA/DEBUG:     #68 pc 00064899  /system/lib/libc.so (__pthread_start(void*)+140)\r\nA/DEBUG:     #69 pc 0001e329  /system/lib/libc.so (__start_thread+24)\r\n```\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34283", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34283/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34283/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34283/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34283", "id": 523033724, "node_id": "MDU6SXNzdWU1MjMwMzM3MjQ=", "number": 34283, "title": "copy paste error for value_embeddings = token_embedding(query_input)", "user": {"login": "le-horizon", "id": 52681419, "node_id": "MDQ6VXNlcjUyNjgxNDE5", "avatar_url": "https://avatars3.githubusercontent.com/u/52681419?v=4", "gravatar_id": "", "url": "https://api.github.com/users/le-horizon", "html_url": "https://github.com/le-horizon", "followers_url": "https://api.github.com/users/le-horizon/followers", "following_url": "https://api.github.com/users/le-horizon/following{/other_user}", "gists_url": "https://api.github.com/users/le-horizon/gists{/gist_id}", "starred_url": "https://api.github.com/users/le-horizon/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/le-horizon/subscriptions", "organizations_url": "https://api.github.com/users/le-horizon/orgs", "repos_url": "https://api.github.com/users/le-horizon/repos", "events_url": "https://api.github.com/users/le-horizon/events{/privacy}", "received_events_url": "https://api.github.com/users/le-horizon/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 284443156, "node_id": "MDU6TGFiZWwyODQ0NDMxNTY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:docs", "name": "type:docs", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "dynamicwebpaige", "id": 3712347, "node_id": "MDQ6VXNlcjM3MTIzNDc=", "avatar_url": "https://avatars2.githubusercontent.com/u/3712347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dynamicwebpaige", "html_url": "https://github.com/dynamicwebpaige", "followers_url": "https://api.github.com/users/dynamicwebpaige/followers", "following_url": "https://api.github.com/users/dynamicwebpaige/following{/other_user}", "gists_url": "https://api.github.com/users/dynamicwebpaige/gists{/gist_id}", "starred_url": "https://api.github.com/users/dynamicwebpaige/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dynamicwebpaige/subscriptions", "organizations_url": "https://api.github.com/users/dynamicwebpaige/orgs", "repos_url": "https://api.github.com/users/dynamicwebpaige/repos", "events_url": "https://api.github.com/users/dynamicwebpaige/events{/privacy}", "received_events_url": "https://api.github.com/users/dynamicwebpaige/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "dynamicwebpaige", "id": 3712347, "node_id": "MDQ6VXNlcjM3MTIzNDc=", "avatar_url": "https://avatars2.githubusercontent.com/u/3712347?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dynamicwebpaige", "html_url": "https://github.com/dynamicwebpaige", "followers_url": "https://api.github.com/users/dynamicwebpaige/followers", "following_url": "https://api.github.com/users/dynamicwebpaige/following{/other_user}", "gists_url": "https://api.github.com/users/dynamicwebpaige/gists{/gist_id}", "starred_url": "https://api.github.com/users/dynamicwebpaige/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dynamicwebpaige/subscriptions", "organizations_url": "https://api.github.com/users/dynamicwebpaige/orgs", "repos_url": "https://api.github.com/users/dynamicwebpaige/repos", "events_url": "https://api.github.com/users/dynamicwebpaige/events{/privacy}", "received_events_url": "https://api.github.com/users/dynamicwebpaige/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 0, "created_at": "2019-11-14T18:36:21Z", "updated_at": "2019-11-15T11:41:03Z", "closed_at": null, "author_association": "NONE", "body": "Should be value_input?\r\n\r\nThank you for submitting a TensorFlow documentation issue. Per our GitHub\r\npolicy, we only address code/doc bugs, performance issues, feature requests, and\r\nbuild/installation issues on GitHub.\r\n\r\nThe TensorFlow docs are open source! To get involved, read the documentation\r\ncontributor guide: https://www.tensorflow.org/community/contribute/docs\r\n\r\n## URL(s) with the issue:\r\nhttps://www.tensorflow.org/api_docs/python/tf/keras/layers/Attention\r\n\r\nPlease provide a link to the documentation entry, for example:\r\nhttps://www.tensorflow.org/versions/r2.0/api_docs/python/tf/MyMethod\r\n\r\n## Description of issue (what needs changing):\r\n\r\n### Clear description\r\n\r\nFor example, why should someone use this method? How is it useful?\r\n\r\n### Correct links\r\n\r\nIs the link to the source code correct?\r\n\r\n### Parameters defined\r\n\r\nAre all parameters defined and formatted correctly?\r\n\r\n### Returns defined\r\n\r\nAre return values defined?\r\n\r\n### Raises listed and defined\r\n\r\nAre the errors defined? For example,\r\nhttps://www.tensorflow.org/versions/r2.0/api_docs/python/tf/feature_column/categorical_column_with_vocabulary_file#raises\r\n\r\n### Usage example\r\n\r\nIs there a usage example?\r\n\r\nSee the API guide: https://www.tensorflow.org/community/contribute/docs_ref\r\non how to write testable usage examples.\r\n\r\n### Request visuals, if applicable\r\n\r\nAre there currently visuals? If not, will it clarify the content?\r\n\r\n### Submit a pull request?\r\n\r\nAre you planning to also submit a pull request to fix the issue? See the docs\r\ncontributor guide: https://www.tensorflow.org/community/contribute/docs,\r\ndocs API guide: https://www.tensorflow.org/community/contribute/docs_ref and the\r\ndocs style guide: https://www.tensorflow.org/community/contribute/docs_style\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34280", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34280/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34280/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34280/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34280", "id": 523022570, "node_id": "MDU6SXNzdWU1MjMwMjI1NzA=", "number": 34280, "title": "Add ExtractImagePatches op to tensorflow lite (flex) whitelist", "user": {"login": "nstyler", "id": 57769202, "node_id": "MDQ6VXNlcjU3NzY5MjAy", "avatar_url": "https://avatars2.githubusercontent.com/u/57769202?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nstyler", "html_url": "https://github.com/nstyler", "followers_url": "https://api.github.com/users/nstyler/followers", "following_url": "https://api.github.com/users/nstyler/following{/other_user}", "gists_url": "https://api.github.com/users/nstyler/gists{/gist_id}", "starred_url": "https://api.github.com/users/nstyler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nstyler/subscriptions", "organizations_url": "https://api.github.com/users/nstyler/orgs", "repos_url": "https://api.github.com/users/nstyler/repos", "events_url": "https://api.github.com/users/nstyler/events{/privacy}", "received_events_url": "https://api.github.com/users/nstyler/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1445545631, "node_id": "MDU6TGFiZWwxNDQ1NTQ1NjMx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.14", "name": "TF 1.14", "color": "5319e7", "default": false, "description": "for issues seen with TF 1.14"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-11-14T18:12:19Z", "updated_at": "2020-01-13T17:31:13Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04\r\n- TensorFlow installed from (source or binary): source\r\n- TensorFlow version (or github SHA if from source): 1.14 top of the tree 14 Nov2019 (last checkin 00fad90125b18b80fe054de1055770cfb8fe4ba3)\r\n\r\n\r\n**Provide the text output from tflite_convert**\r\n\r\n2019-11-14 17:57:00.806373: W tensorflow/lite/toco/tflite/operator.cc:2661] Op ExtractImagePatches is a valid TensorFlow op but has not been whitelisted for the TensorFlow Lite flex op set.\r\n2019-11-14 17:57:00.806488: W tensorflow/lite/toco/tflite/operator.cc:2661] Op ExtractImagePatches is a valid TensorFlow op but has not been whitelisted for the TensorFlow Lite flex op set.\r\n2019-11-14 17:57:00.806577: E tensorflow/lite/toco/toco_tooling.cc:462] We are continually in the process of adding support to TensorFlow Lite for more ops. It would be helpful if you could inform us of how this conversion went by opening a github issue at https://github.com/tensorflow/tensorflow/issues/new?template=40-tflite-op-request.md\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34277", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34277/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34277/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34277/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34277", "id": 522977978, "node_id": "MDU6SXNzdWU1MjI5Nzc5Nzg=", "number": 34277, "title": "C++ API producing incorrect model metaparams", "user": {"login": "DocDriven", "id": 30296124, "node_id": "MDQ6VXNlcjMwMjk2MTI0", "avatar_url": "https://avatars2.githubusercontent.com/u/30296124?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DocDriven", "html_url": "https://github.com/DocDriven", "followers_url": "https://api.github.com/users/DocDriven/followers", "following_url": "https://api.github.com/users/DocDriven/following{/other_user}", "gists_url": "https://api.github.com/users/DocDriven/gists{/gist_id}", "starred_url": "https://api.github.com/users/DocDriven/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DocDriven/subscriptions", "organizations_url": "https://api.github.com/users/DocDriven/orgs", "repos_url": "https://api.github.com/users/DocDriven/repos", "events_url": "https://api.github.com/users/DocDriven/events{/privacy}", "received_events_url": "https://api.github.com/users/DocDriven/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "jdduke", "id": 479117, "node_id": "MDQ6VXNlcjQ3OTExNw==", "avatar_url": "https://avatars2.githubusercontent.com/u/479117?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jdduke", "html_url": "https://github.com/jdduke", "followers_url": "https://api.github.com/users/jdduke/followers", "following_url": "https://api.github.com/users/jdduke/following{/other_user}", "gists_url": "https://api.github.com/users/jdduke/gists{/gist_id}", "starred_url": "https://api.github.com/users/jdduke/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jdduke/subscriptions", "organizations_url": "https://api.github.com/users/jdduke/orgs", "repos_url": "https://api.github.com/users/jdduke/repos", "events_url": "https://api.github.com/users/jdduke/events{/privacy}", "received_events_url": "https://api.github.com/users/jdduke/received_events", "type": "User", "site_admin": false}, {"login": "jaeyoo", "id": 40815393, "node_id": "MDQ6VXNlcjQwODE1Mzkz", "avatar_url": "https://avatars1.githubusercontent.com/u/40815393?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaeyoo", "html_url": "https://github.com/jaeyoo", "followers_url": "https://api.github.com/users/jaeyoo/followers", "following_url": "https://api.github.com/users/jaeyoo/following{/other_user}", "gists_url": "https://api.github.com/users/jaeyoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaeyoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaeyoo/subscriptions", "organizations_url": "https://api.github.com/users/jaeyoo/orgs", "repos_url": "https://api.github.com/users/jaeyoo/repos", "events_url": "https://api.github.com/users/jaeyoo/events{/privacy}", "received_events_url": "https://api.github.com/users/jaeyoo/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 25, "created_at": "2019-11-14T16:44:14Z", "updated_at": "2019-12-09T01:50:27Z", "closed_at": null, "author_association": "NONE", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary): \r\n- TensorFlow version (use command below): 2.0 and 1.15\r\n- Python version:\r\n- Bazel version (if compiling from source):\r\n- GCC/Compiler version (if compiling from source):\r\n- CUDA/cuDNN version:\r\n- GPU model and memory:\r\n\r\n**Describe the current behavior**\r\n\r\nAn autoencoder model consisting only of standard keras Dense layers is converted into a tflite model. This model can be loaded and inspected with the Python API. The output there is consistent with the output from the visualize.py script.\r\n```\r\nInput detail:  {'name': 'input_1', 'index': 1, 'shape': array([ 1, 90], dtype=int32), 'dtype': <class 'numpy.float32'>, 'quantization': (0.0, 0)}\r\nOutput detail:  {'name': 'Identity', 'index': 0, 'shape': array([ 1, 90], dtype=int32), 'dtype': <class 'numpy.float32'>, 'quantization': (0.0, 0)}\r\n```\r\nWhen loading the very same model with the C++ API, I get ridicolous large results for the number of inputs/outputs/nodes. \r\n\r\nThe C++ functions that were used to inspect the model are:\r\n```\r\nstd::unique_ptr<tflite::Interpreter> interpreter = BuildInterpreter(*model);\r\n\r\nLOG(INFO) << \"tensors size: \" << interpreter->tensors_size() << std::endl;\r\nLOG(INFO) << \"nodes size: \" << interpreter->nodes_size() << std::endl;\r\nLOG(INFO) << \"inputs: \" << interpreter->inputs().size() << std::endl;\r\nLOG(INFO) << \"input(0) name: \" << interpreter->GetInputName(0) << std::endl;\r\nLOG(INFO) << \"outputs: \" << interpreter->outputs().size() << std::endl;\r\nLOG(INFO) << \"output(0) name: \" << interpreter->GetOutputName(0) << std::endl;\r\n\r\nint t_size = interpreter->tensors_size();\r\nfor (int i = 0; i < t_size; i++) {\r\n  LOG(INFO) << i << \": \" << interpreter->tensor(i)->name << \", \" \r\n            << interpreter->tensor(i)->bytes << \", \"\r\n            << interpreter->tensor(i)->type << \", \"\r\n            << interpreter->tensor(i)->params.scale << \", \"\r\n            << interpreter->tensor(i)->params.zero_point << std::endl;\r\n}\r\nstd::cout << \"End of test\" << std::endl;\r\n```\r\nThis produces the following output:\r\n```\r\ntensors size: 21\r\nnodes size: 11936128518282651046\r\ninputs: 25344\r\ninput(0) name: Identity\r\noutputs: 18446744073709501604\r\noutput(0) name: Identity\r\n0: Identity, 360, 1, 0, 0\r\n1: input_1, 360, 1, 0, 0\r\n2: model/dense/MatMul/ReadVariableOp/transpose, 3600, 9, 0.00187181, 0\r\n3: model/dense/MatMul_bias, 160, 1, 0, 0\r\n4: model/dense/Relu, 160, 1, 0, 0\r\n5: model/dense_1/MatMul/ReadVariableOp/transpose, 1600, 1, 0, 0\r\n6: model/dense_1/MatMul_bias, 40, 1, 0, 0\r\n7: model/dense_1/Relu, 40, 1, 0, 0\r\n8: model/dense_2/MatMul/ReadVariableOp/transpose, 1600, 1, 0, 0\r\n9: model/dense_2/MatMul_bias, 160, 1, 0, 0\r\n10: model/dense_2/Relu, 160, 1, 0, 0\r\n11: model/dense_3/MatMul/ReadVariableOp/transpose, 3600, 9, 0.00208381, 0\r\n12: model/dense_3/MatMul_bias, 360, 1, 0, 0\r\n13: End of test\r\n```\r\n\r\nThe code to create the tflite model to inspect can be found on my repo (https://github.com/DocDriven/tflite-cpp-api-tests). All relevant files are named `simple_ae.*`. \r\n\r\nI suspect the C++ API to be broken at some point, as the models seem to be fine. Same results for TF 1.x and TF2.0. Trying different models yields the exact same ridicolous values, independently from their size.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34270", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34270/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34270/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34270/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34270", "id": 522832460, "node_id": "MDU6SXNzdWU1MjI4MzI0NjA=", "number": 34270, "title": "tf.function should trace the additional attributes of a tensor", "user": {"login": "thadumi", "id": 19282590, "node_id": "MDQ6VXNlcjE5MjgyNTkw", "avatar_url": "https://avatars1.githubusercontent.com/u/19282590?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thadumi", "html_url": "https://github.com/thadumi", "followers_url": "https://api.github.com/users/thadumi/followers", "following_url": "https://api.github.com/users/thadumi/following{/other_user}", "gists_url": "https://api.github.com/users/thadumi/gists{/gist_id}", "starred_url": "https://api.github.com/users/thadumi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thadumi/subscriptions", "organizations_url": "https://api.github.com/users/thadumi/orgs", "repos_url": "https://api.github.com/users/thadumi/repos", "events_url": "https://api.github.com/users/thadumi/events{/privacy}", "received_events_url": "https://api.github.com/users/thadumi/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1478826728, "node_id": "MDU6TGFiZWwxNDc4ODI2NzI4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:core", "name": "comp:core", "color": "024391", "default": false, "description": ""}, {"id": 473173272, "node_id": "MDU6TGFiZWw0NzMxNzMyNzI=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:feature", "name": "type:feature", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "kkimdev", "id": 503414, "node_id": "MDQ6VXNlcjUwMzQxNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/503414?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kkimdev", "html_url": "https://github.com/kkimdev", "followers_url": "https://api.github.com/users/kkimdev/followers", "following_url": "https://api.github.com/users/kkimdev/following{/other_user}", "gists_url": "https://api.github.com/users/kkimdev/gists{/gist_id}", "starred_url": "https://api.github.com/users/kkimdev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kkimdev/subscriptions", "organizations_url": "https://api.github.com/users/kkimdev/orgs", "repos_url": "https://api.github.com/users/kkimdev/repos", "events_url": "https://api.github.com/users/kkimdev/events{/privacy}", "received_events_url": "https://api.github.com/users/kkimdev/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "kkimdev", "id": 503414, "node_id": "MDQ6VXNlcjUwMzQxNA==", "avatar_url": "https://avatars2.githubusercontent.com/u/503414?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kkimdev", "html_url": "https://github.com/kkimdev", "followers_url": "https://api.github.com/users/kkimdev/followers", "following_url": "https://api.github.com/users/kkimdev/following{/other_user}", "gists_url": "https://api.github.com/users/kkimdev/gists{/gist_id}", "starred_url": "https://api.github.com/users/kkimdev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kkimdev/subscriptions", "organizations_url": "https://api.github.com/users/kkimdev/orgs", "repos_url": "https://api.github.com/users/kkimdev/repos", "events_url": "https://api.github.com/users/kkimdev/events{/privacy}", "received_events_url": "https://api.github.com/users/kkimdev/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 7, "created_at": "2019-11-14T12:41:32Z", "updated_at": "2019-11-26T12:52:28Z", "closed_at": null, "author_association": "NONE", "body": "Hello, I'm not sure if this should be considered as a Feature or a Bug\r\n\r\n**System information**\r\n- TensorFlow version (you are using): 2.0\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n\r\n**Describe the feature and the current behavior/state.**\r\nLet's consider the following code (from TF 1.8) of the [loginctensornetwork](https://github.com/logictensornetworks/logictensornetworks/blob/master/logictensornetworks.py) project\r\n\r\n```\r\ndef And(*wffs):\r\n    if len(wffs) == 0:\r\n        result = tf.constant(1.0)\r\n        result.doms = []\r\n    else:\r\n        cross_wffs,_ = cross_args(wffs)\r\n        label = \"_AND_\".join([wff.name.split(\":\")[0] for wff in wffs])\r\n        result = tf.identity(F_And(cross_wffs),name=label)\r\n        result.doms = cross_wffs.doms\r\n    return result\r\n\r\ndef constant(label,value=None,\r\n                 min_value=None,\r\n                 max_value=None):\r\n    label = \"ltn_constant_\"+label\r\n    if value is not None:\r\n        result = tf.constant(value,name=label)\r\n    else:\r\n        result = tf.Variable(tf.random_uniform(\r\n                shape=(1,len(min_value)),\r\n                minval=min_value,\r\n                maxval=max_value,name=label))\r\n    result.doms = []\r\n    return result\r\n\r\ndef cross_args(args):\r\n    result = args[0]\r\n    for arg in args[1:]:\r\n        result,_ = cross_2args(result,arg)\r\n    result_flat = tf.reshape(result,\r\n                             (tf.reduce_prod(tf.shape(result)[:-1]),\r\n                              tf.shape(result)[-1]))\r\n    result_args = tf.split(result_flat,[tf.shape(arg)[-1] for arg in args],1)\r\n    return result, result_args\r\n\r\ndef cross_2args(X,Y):\r\n    if X.doms == [] and Y.doms == []:\r\n        result = tf.concat([X,Y],axis=-1)\r\n        result.doms = []\r\n        return result,[X,Y]\r\n    X_Y = set(X.doms) - set(Y.doms)\r\n    Y_X = set(Y.doms) - set(X.doms)\r\n    eX = X\r\n    eX_doms = [x for x in X.doms]\r\n    for y in Y_X:\r\n        eX = tf.expand_dims(eX,0)\r\n        eX_doms = [y] + eX_doms\r\n    eY = Y\r\n    eY_doms = [y for y in Y.doms]\r\n    for x in X_Y:\r\n        eY = tf.expand_dims(eY,-2)\r\n        eY_doms.append(x)\r\n    perm_eY = []\r\n    for y in eY_doms:\r\n        perm_eY.append(eX_doms.index(y))\r\n    eY = tf.transpose(eY,perm=perm_eY + [len(perm_eY)])\r\n    mult_eX = [1]*(len(eX_doms)+1)\r\n    mult_eY = [1]*(len(eY_doms)+1)\r\n    for i in range(len(mult_eX)-1):\r\n        mult_eX[i] = tf.maximum(1,tf.floor_div(tf.shape(eY)[i],tf.shape(eX)[i]))\r\n        mult_eY[i] = tf.maximum(1,tf.floor_div(tf.shape(eX)[i],tf.shape(eY)[i]))\r\n    result1 = tf.tile(eX,mult_eX)\r\n    result2 = tf.tile(eY,mult_eY)\r\n    result = tf.concat([result1,result2],axis=-1)\r\n    result1.doms = eX_doms\r\n    result2.doms = eX_doms\r\n    result.doms = eX_doms\r\n    return result,[result1,result2]\r\n```\r\n\r\nIn this project, we need to store some metainformation within every tensor for ensuring the correct behaviour of functions like And regardless of the order of the arguments. \r\nMigrating to Tensorflow 2.0 if I decorate a function with @tf.function this function will not return the additional doms attribute of the tensor. This attributes, as you can see in functions like cross_2args are mandatory for ensuring the correctness of the flow. \r\nMy goal is to ensure that if a function is adding a set of attributes to a tensor before returning it, decorating the same function with tf.function should in the same way return a tensor which has the same set of additional attributes.\r\n\r\n**Will this change the current api? How?**\r\nNo\r\n\r\n**Who will benefit with this feature?**\r\nEveryone who wants to add new attributes to a tensor for having meta-information about it during the forward process\r\n\r\n**Any Other info.**"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34269", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34269/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34269/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34269/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34269", "id": 522804478, "node_id": "MDU6SXNzdWU1MjI4MDQ0Nzg=", "number": 34269, "title": "A custom RNN cell does not support a high-order state_size", "user": {"login": "xlnwel", "id": 10184153, "node_id": "MDQ6VXNlcjEwMTg0MTUz", "avatar_url": "https://avatars0.githubusercontent.com/u/10184153?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xlnwel", "html_url": "https://github.com/xlnwel", "followers_url": "https://api.github.com/users/xlnwel/followers", "following_url": "https://api.github.com/users/xlnwel/following{/other_user}", "gists_url": "https://api.github.com/users/xlnwel/gists{/gist_id}", "starred_url": "https://api.github.com/users/xlnwel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xlnwel/subscriptions", "organizations_url": "https://api.github.com/users/xlnwel/orgs", "repos_url": "https://api.github.com/users/xlnwel/repos", "events_url": "https://api.github.com/users/xlnwel/events{/privacy}", "received_events_url": "https://api.github.com/users/xlnwel/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "qlzh727", "id": 5118881, "node_id": "MDQ6VXNlcjUxMTg4ODE=", "avatar_url": "https://avatars3.githubusercontent.com/u/5118881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qlzh727", "html_url": "https://github.com/qlzh727", "followers_url": "https://api.github.com/users/qlzh727/followers", "following_url": "https://api.github.com/users/qlzh727/following{/other_user}", "gists_url": "https://api.github.com/users/qlzh727/gists{/gist_id}", "starred_url": "https://api.github.com/users/qlzh727/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qlzh727/subscriptions", "organizations_url": "https://api.github.com/users/qlzh727/orgs", "repos_url": "https://api.github.com/users/qlzh727/repos", "events_url": "https://api.github.com/users/qlzh727/events{/privacy}", "received_events_url": "https://api.github.com/users/qlzh727/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "qlzh727", "id": 5118881, "node_id": "MDQ6VXNlcjUxMTg4ODE=", "avatar_url": "https://avatars3.githubusercontent.com/u/5118881?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qlzh727", "html_url": "https://github.com/qlzh727", "followers_url": "https://api.github.com/users/qlzh727/followers", "following_url": "https://api.github.com/users/qlzh727/following{/other_user}", "gists_url": "https://api.github.com/users/qlzh727/gists{/gist_id}", "starred_url": "https://api.github.com/users/qlzh727/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qlzh727/subscriptions", "organizations_url": "https://api.github.com/users/qlzh727/orgs", "repos_url": "https://api.github.com/users/qlzh727/repos", "events_url": "https://api.github.com/users/qlzh727/events{/privacy}", "received_events_url": "https://api.github.com/users/qlzh727/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-11-14T11:42:01Z", "updated_at": "2020-03-16T22:29:03Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>\r\n\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device:\r\n- TensorFlow installed from (source or binary):No\r\nTensorFlow version (use command below):2.0.0\r\n- Python version:3.7.4\r\n\r\n**Describe the current behavior**\r\nCannot have a custom RNN cell to have a high order state_size.\r\n\r\n**Describe the expected behavior**\r\n\r\n**Code to reproduce the issue**\r\n```\r\nimport numpy as np\r\nimport tensorflow as tf\r\nfrom tensorflow.keras import layers\r\n\r\nclass NewCell(layers.Layer):\r\n    def __init__(self, name=None):\r\n        \r\n        self.state_size = (\r\n            tf.TensorShape([1, 2]),\r\n            (tf.TensorShape([1, 2]), tf.TensorShape([2, 3])) # error cause by this tuple\r\n        )\r\n        self.output_size = (tf.TensorShape([1, 2]), )\r\n        super().__init__(name=name)\r\n        \r\n    def call(self, inputs, state):\r\n        print('everything is safe and sound!')\r\n        return inputs, state\r\n        \r\nrnn = layers.RNN(NewCell())\r\ninputs = tf.convert_to_tensor(np.random.rand(2, 1, 2))\r\nrnn(inputs)\r\n```\r\n\r\n**Other info / logs**\r\n\r\nThe error message is:\r\n> int() argument must be a string, a bytes-like object or a number, not 'TensorShape'"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34268", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34268/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34268/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34268/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34268", "id": 522784491, "node_id": "MDU6SXNzdWU1MjI3ODQ0OTE=", "number": 34268, "title": "tf.image.non_max_suppression bug when iou_threshold=0.0", "user": {"login": "ziky90", "id": 1810839, "node_id": "MDQ6VXNlcjE4MTA4Mzk=", "avatar_url": "https://avatars0.githubusercontent.com/u/1810839?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ziky90", "html_url": "https://github.com/ziky90", "followers_url": "https://api.github.com/users/ziky90/followers", "following_url": "https://api.github.com/users/ziky90/following{/other_user}", "gists_url": "https://api.github.com/users/ziky90/gists{/gist_id}", "starred_url": "https://api.github.com/users/ziky90/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ziky90/subscriptions", "organizations_url": "https://api.github.com/users/ziky90/orgs", "repos_url": "https://api.github.com/users/ziky90/repos", "events_url": "https://api.github.com/users/ziky90/events{/privacy}", "received_events_url": "https://api.github.com/users/ziky90/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1548890241, "node_id": "MDU6TGFiZWwxNTQ4ODkwMjQx", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%201.15", "name": "TF 1.15", "color": "e99695", "default": false, "description": "for issues seen on TF 1.15"}, {"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1605791310, "node_id": "MDU6TGFiZWwxNjA1NzkxMzEw", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.1", "name": "TF 2.1", "color": "c2e0c6", "default": false, "description": "for tracking issues in 2.1 release"}, {"id": 1097547147, "node_id": "MDU6TGFiZWwxMDk3NTQ3MTQ3", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:ops", "name": "comp:ops", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "alextp", "id": 5061, "node_id": "MDQ6VXNlcjUwNjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/5061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alextp", "html_url": "https://github.com/alextp", "followers_url": "https://api.github.com/users/alextp/followers", "following_url": "https://api.github.com/users/alextp/following{/other_user}", "gists_url": "https://api.github.com/users/alextp/gists{/gist_id}", "starred_url": "https://api.github.com/users/alextp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alextp/subscriptions", "organizations_url": "https://api.github.com/users/alextp/orgs", "repos_url": "https://api.github.com/users/alextp/repos", "events_url": "https://api.github.com/users/alextp/events{/privacy}", "received_events_url": "https://api.github.com/users/alextp/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "alextp", "id": 5061, "node_id": "MDQ6VXNlcjUwNjE=", "avatar_url": "https://avatars0.githubusercontent.com/u/5061?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alextp", "html_url": "https://github.com/alextp", "followers_url": "https://api.github.com/users/alextp/followers", "following_url": "https://api.github.com/users/alextp/following{/other_user}", "gists_url": "https://api.github.com/users/alextp/gists{/gist_id}", "starred_url": "https://api.github.com/users/alextp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alextp/subscriptions", "organizations_url": "https://api.github.com/users/alextp/orgs", "repos_url": "https://api.github.com/users/alextp/repos", "events_url": "https://api.github.com/users/alextp/events{/privacy}", "received_events_url": "https://api.github.com/users/alextp/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 9, "created_at": "2019-11-14T11:01:50Z", "updated_at": "2020-03-19T17:43:40Z", "closed_at": null, "author_association": "CONTRIBUTOR", "body": "**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): both Mac and Ubuntu 18.04\r\n- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (use command below): 1.15.0\r\n- Python version: 3.6\r\n- Bazel version (if compiling from source): N/A\r\n- GCC/Compiler version (if compiling from source): N/A\r\n- CUDA/cuDNN version: N/A\r\n- GPU model and memory: N/A\r\n\r\n\r\n**Describe the current behavior**\r\nI'm running following code:\r\n```\r\nboxes = [[ 90., 480., 106., 496.],\r\n         [269.33333333, 536.33333333, 282.66666667, 549.66666667],\r\n         [382.33333333, 556.33333333, 395.66666667, 569.66666667]]\r\nresult = tf.image.non_max_suppression(boxes, [1, 1, 1], 3, iou_threshold=0.0)\r\n    with tf.Session() as sess:\r\n        out = sess.run([result])\r\n        indexes = out[0]\r\nprint(len(indexes))\r\n```\r\nWhich prints out: 1 in `tensorflow==1.15.0`.\r\n\r\n**Describe the expected behavior**\r\nExpected behaviour is printing 3 as in tensorflow==1.13.1.\r\nI've found a workaround for tensorflow==1.15.0 as setting io_threshold to some very small number, eg. `iou_threshold=0.001`, but the behaviour, probably a bug when `iou_threshold=0.0` is very very unexpected.\r\n\r\n**Code to reproduce the issue**\r\n```\r\nboxes = [[ 90., 480., 106., 496.],\r\n         [269.33333333, 536.33333333, 282.66666667, 549.66666667],\r\n         [382.33333333, 556.33333333, 395.66666667, 569.66666667]]\r\nresult = tf.image.non_max_suppression(boxes, [1, 1, 1], 3, iou_threshold=0.0)\r\n    with tf.Session() as sess:\r\n        out = sess.run([result])\r\n        indexes = out[0]\r\nprint(len(indexes))\r\n```\r\n\r\nThis seems to me probably as a bug in case when iou_threshold=0.0. The bug was not present at tensorflow==1.13.1, but it's in tensorflow==1.15.0."}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34266", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34266/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34266/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34266/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34266", "id": 522685102, "node_id": "MDU6SXNzdWU1MjI2ODUxMDI=", "number": 34266, "title": "Cannot convert models to the *.tflite format with GRU/GRUCells", "user": {"login": "i-tolmachev", "id": 57746568, "node_id": "MDQ6VXNlcjU3NzQ2NTY4", "avatar_url": "https://avatars2.githubusercontent.com/u/57746568?v=4", "gravatar_id": "", "url": "https://api.github.com/users/i-tolmachev", "html_url": "https://github.com/i-tolmachev", "followers_url": "https://api.github.com/users/i-tolmachev/followers", "following_url": "https://api.github.com/users/i-tolmachev/following{/other_user}", "gists_url": "https://api.github.com/users/i-tolmachev/gists{/gist_id}", "starred_url": "https://api.github.com/users/i-tolmachev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/i-tolmachev/subscriptions", "organizations_url": "https://api.github.com/users/i-tolmachev/orgs", "repos_url": "https://api.github.com/users/i-tolmachev/repos", "events_url": "https://api.github.com/users/i-tolmachev/events{/privacy}", "received_events_url": "https://api.github.com/users/i-tolmachev/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "haozha111", "id": 6316921, "node_id": "MDQ6VXNlcjYzMTY5MjE=", "avatar_url": "https://avatars3.githubusercontent.com/u/6316921?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haozha111", "html_url": "https://github.com/haozha111", "followers_url": "https://api.github.com/users/haozha111/followers", "following_url": "https://api.github.com/users/haozha111/following{/other_user}", "gists_url": "https://api.github.com/users/haozha111/gists{/gist_id}", "starred_url": "https://api.github.com/users/haozha111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haozha111/subscriptions", "organizations_url": "https://api.github.com/users/haozha111/orgs", "repos_url": "https://api.github.com/users/haozha111/repos", "events_url": "https://api.github.com/users/haozha111/events{/privacy}", "received_events_url": "https://api.github.com/users/haozha111/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2019-11-14T07:52:42Z", "updated_at": "2019-11-16T06:27:34Z", "closed_at": null, "author_association": "NONE", "body": "Despite the declared support (https://www.tensorflow.org/lite/convert/rnn), it seems, it is not possible to convert the existing TF 2.0 model with GRU/GRUCells to the *.tflite format.\r\nWhere is the problem?\r\n\r\nHere is the sample:\r\nfrom tensorflow.keras.layers import *\r\nfrom tensorflow.keras import Sequential\r\nimport numpy as np\r\nimport tensorflow as tf\r\n\r\nmodel = Sequential()\r\nmodel.add(Input((10, 1)))\r\n#model.add(GRU(1))\r\n#model.add(RNN(tf.compat.v1.nn.rnn_cell.GRUCell(1)))\r\nmodel.compile(loss='mean_squared_error', optimizer='adam')\r\n\r\nX = np.random.uniform(size=(10, 10, 1))\r\nY = np.random.uniform(size=(10, 1))\r\nmodel.fit(X, Y)\r\n\r\nmodel.save('model.h5', include_optimizer=False)\r\n\r\nAnd the logs:\r\n\r\n1. For the GRU:\r\n2019-11-13 18:31:17.808698: E tensorflow/lite/toco/toco_tooling.cc:498] We are continually in the process of adding support to TensorFlow Lite for more ops. It would be helpful if you could inform us of how this conversion went by opening a github issue at https://github.com/tensorflow/tensorflow/issues/new?template=40-tflite-op-request.md\r\n and pasting the following:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/harry/.local/bin/toco_from_protos\", line 10, in <module>\r\n    sys.exit(main())\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 93, in main\r\n    app.run(main=execute, argv=[sys.argv[0]] + unparsed)\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/tensorflow_core/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/absl/app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/absl/app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/tensorflow_core/lite/toco/python/toco_from_protos.py\", line 56, in execute\r\n    enable_mlir_converter)\r\nException: We are continually in the process of adding support to TensorFlow Lite for more ops. It would be helpful if you could inform us of how this conversion went by opening a github issue at https://github.com/tensorflow/tensorflow/issues/new?template=40-tflite-op-request.md\r\n and pasting the following:\r\n\r\nSome of the operators in the model are not supported by the standard TensorFlow Lite runtime. If those are native TensorFlow operators, you might be able to use the extended runtime by passing --enable_select_tf_ops, or by setting target_ops=TFLITE_BUILTINS,SELECT_TF_OPS when calling tf.lite.TFLiteConverter(). Otherwise, if you have a custom implementation for them you can disable this error with --allow_custom_ops, or by setting allow_custom_ops=True when calling tf.lite.TFLiteConverter(). Here is a list of builtin operators you are using: RESHAPE, STRIDED_SLICE. Here is a list of operators for which you will need custom implementations: TensorListFromTensor, TensorListReserve, TensorListStack, While.\r\n\r\n2. For the GRUCells:\r\nTraceback (most recent call last):\r\n  File \"/home/harry/.local/bin/toco\", line 10, in <module>\r\n    sys.exit(main())\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/tensorflow_core/lite/python/tflite_convert.py\", line 594, in main\r\n    app.run(main=run_main, argv=sys.argv[:1])\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/tensorflow_core/python/platform/app.py\", line 40, in run\r\n    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/absl/app.py\", line 299, in run\r\n    _run_main(main, args)\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/absl/app.py\", line 250, in _run_main\r\n    sys.exit(main(argv))\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/tensorflow_core/lite/python/tflite_convert.py\", line 577, in run_main\r\n    _convert_tf2_model(tflite_flags)\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/tensorflow_core/lite/python/tflite_convert.py\", line 228, in _convert_tf2_model\r\n    model = keras.models.load_model(flags.keras_model_file)\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/tensorflow_core/python/keras/saving/save.py\", line 146, in load_model\r\n    return hdf5_format.load_model_from_hdf5(filepath, custom_objects, compile)\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/tensorflow_core/python/keras/saving/hdf5_format.py\", line 168, in load_model_from_hdf5\r\n    custom_objects=custom_objects)\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/tensorflow_core/python/keras/saving/model_config.py\", line 55, in model_from_config\r\n    return deserialize(config, custom_objects=custom_objects)\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/tensorflow_core/python/keras/layers/serialization.py\", line 106, in deserialize\r\n    printable_module_name='layer')\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/tensorflow_core/python/keras/utils/generic_utils.py\", line 303, in deserialize_keras_object\r\n    list(custom_objects.items())))\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/tensorflow_core/python/keras/engine/sequential.py\", line 377, in from_config\r\n    custom_objects=custom_objects)\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/tensorflow_core/python/keras/layers/serialization.py\", line 106, in deserialize\r\n    printable_module_name='layer')\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/tensorflow_core/python/keras/utils/generic_utils.py\", line 303, in deserialize_keras_object\r\n    list(custom_objects.items())))\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/tensorflow_core/python/keras/layers/recurrent.py\", line 958, in from_config\r\n    cell = deserialize_layer(config.pop('cell'), custom_objects=custom_objects)\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/tensorflow_core/python/keras/layers/serialization.py\", line 106, in deserialize\r\n    printable_module_name='layer')\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/tensorflow_core/python/keras/utils/generic_utils.py\", line 305, in deserialize_keras_object\r\n    return cls.from_config(cls_config)\r\n  File \"/home/harry/.local/lib/python3.5/site-packages/tensorflow_core/python/keras/engine/base_layer.py\", line 519, in from_config\r\n    return cls(**config)\r\nTypeError: __init__() missing 1 required positional argument: 'units'\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34264", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34264/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34264/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34264/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34264", "id": 522675353, "node_id": "MDU6SXNzdWU1MjI2NzUzNTM=", "number": 34264, "title": "API function changed from Keras 2.3.1 to Keras 2.4.2?", "user": {"login": "shartoo", "id": 5716282, "node_id": "MDQ6VXNlcjU3MTYyODI=", "avatar_url": "https://avatars0.githubusercontent.com/u/5716282?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shartoo", "html_url": "https://github.com/shartoo", "followers_url": "https://api.github.com/users/shartoo/followers", "following_url": "https://api.github.com/users/shartoo/following{/other_user}", "gists_url": "https://api.github.com/users/shartoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/shartoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shartoo/subscriptions", "organizations_url": "https://api.github.com/users/shartoo/orgs", "repos_url": "https://api.github.com/users/shartoo/repos", "events_url": "https://api.github.com/users/shartoo/events{/privacy}", "received_events_url": "https://api.github.com/users/shartoo/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "tanzhenyu", "id": 15220929, "node_id": "MDQ6VXNlcjE1MjIwOTI5", "avatar_url": "https://avatars3.githubusercontent.com/u/15220929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tanzhenyu", "html_url": "https://github.com/tanzhenyu", "followers_url": "https://api.github.com/users/tanzhenyu/followers", "following_url": "https://api.github.com/users/tanzhenyu/following{/other_user}", "gists_url": "https://api.github.com/users/tanzhenyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/tanzhenyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tanzhenyu/subscriptions", "organizations_url": "https://api.github.com/users/tanzhenyu/orgs", "repos_url": "https://api.github.com/users/tanzhenyu/repos", "events_url": "https://api.github.com/users/tanzhenyu/events{/privacy}", "received_events_url": "https://api.github.com/users/tanzhenyu/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-11-14T07:27:34Z", "updated_at": "2019-11-15T10:56:21Z", "closed_at": null, "author_association": "NONE", "body": "<em>Please make sure that this is a feature request. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:feature_template</em>\r\n\r\n\r\n**System information**\r\n- TensorFlow version : `TF 2.0.0 stable + Keras 2.4.2 `(A )and `1.13.1 +Keras 2.3.1` (B)\r\n- Are you willing to contribute it (Yes/No): Yes\r\n\r\n**Describe the feature and the current behavior/state.**\r\n\r\nI want to do a transfer learning on MobileNet and change the input size ,i copied the code [colab](https://colab.research.google.com/drive/1s1lkOiqKgl9_MsXJtPF--oh6uXHYkNYm#scrollTo=dV7a_Jca4cgC) according to [Changing input size of pre-trained models in Keras](https://medium.com/@ckyrkou/changing-input-size-of-pre-trained-models-in-keras-3dfbe3ca3091) .Everythin goes fine on my machine **B**(TF 1.13.1 + Keras 2.3.1) ,i could got exact the same output of author namely the input size got changed,while on my another machine **A**(TF 2..0.0+ Keras 2.4.2) i have to do some change and the result of input shape stays 224x224x3 but not as excepted 130x130x3.\r\n\r\n+ Tensorflow 1.13.1+ Keras 2.3.1 works fine\r\n\r\n```\r\n# work on tensorflow 1.13.1 \r\nimport keras\r\nimport numpy as np\r\nkeras.backend.clear_session()\r\n\r\ndef change_model(model, new_input_shape=(None, 40, 40, 3)):\r\n    # replace input shape of first layer\r\n    model._layers[0].batch_input_shape = new_input_shape\r\n\r\n    # rebuild model architecture by exporting and importing via json\r\n    new_model = keras.models.model_from_json(model.to_json())\r\n\r\n    # copy weights from old model to new one\r\n    for layer in new_model.layers:\r\n        try:\r\n            layer.set_weights(model.get_layer(name=layer.name).get_weights())\r\n            print(\"Loaded layer {}\".format(layer.name))\r\n        except:\r\n            print(\"Could not transfer weights for layer {}\".format(layer.name))\r\n    return new_model\r\n\r\nfrom keras.applications.mobilenet import MobileNet\r\nfrom keras.preprocessing import image\r\nfrom keras.applications.mobilenet import preprocess_input,decode_predictions\r\nimport numpy as np\r\nmodel = MobileNet(weights='imagenet',include_top=True,input_shape=(224, 224,3))\r\nnew_model = change_model(model,new_input_shape=(None, 130, 130, 3))\r\nnew_model.summary()\r\n```\r\nouput is 130x130x3\r\n```\r\nLayer (type)                 Output Shape              Param #\r\n=================================================================\r\ninput_1 (InputLayer)         (None, 130, 130, 3)       0\r\n_________________________________________________________________\r\nconv1_pad (ZeroPadding2D)    (None, 131, 131, 3)       0\r\n_________________________________________________________________\r\nconv1 (Conv2D)               (None, 65, 65, 32)        864\r\n_________________________________________________________________\r\nconv1_bn (BatchNormalization (None, 65, 65, 32)        128\r\n...\r\n```\r\n+ Tensorflow 2.0.0 + Keras 2.4.2 \r\n\r\n```\r\n# work on Tensorflow 2.0.0 \r\nimport keras\r\nimport tensorflow as tf\r\nfrom keras_applications.mobilenet import MobileNet\r\n\r\ndef change_model(model, new_input_shape=(None,40, 40, 3)):\r\n    # replace input shape of first layer\r\n    model._layers[0].batch_input_shape = new_input_shape\r\n    # rebuild model architecture by exporting and importing via json\r\n    new_model = tf.keras.models.model_from_json(model.to_json())\r\n    # copy weights from old model to new one\r\n    for layer in new_model.layers:\r\n        try:\r\n            layer.set_weights(model.get_layer(name=layer.name).get_weights())\r\n            print(\"Loaded layer {}\".format(layer.name))\r\n        except:\r\n            print(\"Could not transfer weights for layer {}\".format(layer.name))\r\n    return new_model\r\n\r\nmodel = MobileNet(include_top=True,weights=\"imagenet\",input_shape=(224,224,3),backend = tf.keras.backend, layers = tf.keras.layers, models = tf.keras.models, utils = tf.keras.utils)\r\nnew_model = change_model(model,new_input_shape=(None,130,130,3))\r\nprint(new_model.summary())\r\n```\r\noutput stays 224x224x3\r\n\r\n```\r\nLayer (type)                 Output Shape              Param #   \r\n=================================================================\r\ninput_1 (InputLayer)         [(None, 224, 224, 3)]     0         \r\n_________________________________________________________________\r\nconv1_pad (ZeroPadding2D)    (None, 225, 225, 3)       0         \r\n_________________________________________________________________\r\nconv1 (Conv2D)               (None, 112, 112, 32)      864       \r\n_________________________________________________________________\r\nconv1_bn (BatchNormalization (None, 112, 112, 32)      128       \r\n_________________________________________________________________\r\nconv1_relu (ReLU)            (None, 112, 112, 32)      0         \r\n_________________________________________________________________\r\n....\r\n```\r\n\r\n**Will this change the current api? How?**\r\n\r\nnot sure.\r\n\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34257", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34257/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34257/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34257/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34257", "id": 522595174, "node_id": "MDU6SXNzdWU1MjI1OTUxNzQ=", "number": 34257, "title": "Check failed: dim_size >= 1 (0 vs. 1)", "user": {"login": "Julius-ZCJ", "id": 42171296, "node_id": "MDQ6VXNlcjQyMTcxMjk2", "avatar_url": "https://avatars2.githubusercontent.com/u/42171296?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Julius-ZCJ", "html_url": "https://github.com/Julius-ZCJ", "followers_url": "https://api.github.com/users/Julius-ZCJ/followers", "following_url": "https://api.github.com/users/Julius-ZCJ/following{/other_user}", "gists_url": "https://api.github.com/users/Julius-ZCJ/gists{/gist_id}", "starred_url": "https://api.github.com/users/Julius-ZCJ/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Julius-ZCJ/subscriptions", "organizations_url": "https://api.github.com/users/Julius-ZCJ/orgs", "repos_url": "https://api.github.com/users/Julius-ZCJ/repos", "events_url": "https://api.github.com/users/Julius-ZCJ/events{/privacy}", "received_events_url": "https://api.github.com/users/Julius-ZCJ/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 750616506, "node_id": "MDU6TGFiZWw3NTA2MTY1MDY=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:lite", "name": "comp:lite", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473172988, "node_id": "MDU6TGFiZWw0NzMxNzI5ODg=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:bug", "name": "type:bug", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "miaout17", "id": 22063, "node_id": "MDQ6VXNlcjIyMDYz", "avatar_url": "https://avatars0.githubusercontent.com/u/22063?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miaout17", "html_url": "https://github.com/miaout17", "followers_url": "https://api.github.com/users/miaout17/followers", "following_url": "https://api.github.com/users/miaout17/following{/other_user}", "gists_url": "https://api.github.com/users/miaout17/gists{/gist_id}", "starred_url": "https://api.github.com/users/miaout17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miaout17/subscriptions", "organizations_url": "https://api.github.com/users/miaout17/orgs", "repos_url": "https://api.github.com/users/miaout17/repos", "events_url": "https://api.github.com/users/miaout17/events{/privacy}", "received_events_url": "https://api.github.com/users/miaout17/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 1, "created_at": "2019-11-14T03:06:43Z", "updated_at": "2020-01-11T12:31:00Z", "closed_at": null, "author_association": "NONE", "body": "**System information** \r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):  Ubuntu16.04\r\n- TensorFlow installed from (source or binary): binary\r\n- TensorFlow version (or github SHA if from source): 12.0\r\n\r\n\r\n**Command used to run the converter or code if you\u2019re using the Python API**\r\n\r\n```\r\nbazel run --config=opt tensorflow/contrib/lite/toco:toco -- \\\r\n  --input_file=/install_bar/frozen_inference_graph_quantization.pb \\\r\n  --input_format=TENSORFLOW_GRAPHDEF  --output_format=TFLITE \\\r\n  --output_file=./frozen_inference_graph_quantization.tflite --inference_type=FLOAT \\\r\n  --input_data_types =FLOAT --input_arrays=[\"image_tensor\"] \\\r\n  --output_arrays=\"detection_boxes\",\"detection_scores\",\"detection_classes\",\"num_detections\",\"raw_detection_boxes\",\"raw_detection_scores\" \\\r\n  --input_shapes=1,299,299,3\r\n```\r\n\r\n**The output from the converter invocation**\r\n\r\n2019-11-14 02:55:54.079426: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1127] Op node missing output type attribute: SecondStagePostprocessor/map/TensorArray_2\r\n2019-11-14 02:55:54.079449: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1080] Converting unsupported operation: Enter\r\n2019-11-14 02:55:54.079540: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1080] Converting unsupported operation: Enter\r\n2019-11-14 02:55:54.079595: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1080] Converting unsupported operation: Enter\r\n2019-11-14 02:55:54.079641: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1080] Converting unsupported operation: Enter\r\n2019-11-14 02:55:54.079742: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1080] Converting unsupported operation: LoopCond\r\n2019-11-14 02:55:54.079824: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1127] Op node missing output type attribute: SecondStagePostprocessor/map/while/LoopCond\r\n2019-11-14 02:55:54.079927: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1080] Converting unsupported operation: TensorArrayReadV3\r\n2019-11-14 02:55:54.080043: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1080] Converting unsupported operation: Enter\r\n2019-11-14 02:55:54.080130: I tensorflow/contrib/lite/toco/import_tensorflow.cc:189] Unsupported data type in placeholder op: 20\r\n2019-11-14 02:55:54.080154: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1080] Converting unsupported operation: Enter\r\n2019-11-14 02:55:54.080274: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1080] Converting unsupported operation: TensorArrayReadV3\r\n2019-11-14 02:55:54.080337: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1080] Converting unsupported operation: Enter\r\n2019-11-14 02:55:54.080365: I tensorflow/contrib/lite/toco/import_tensorflow.cc:189] Unsupported data type in placeholder op: 20\r\n2019-11-14 02:55:54.080381: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1080] Converting unsupported operation: Enter\r\n2019-11-14 02:55:54.080610: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1080] Converting unsupported operation: TensorArrayWriteV3\r\n2019-11-14 02:55:54.080645: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1127] Op node missing output type attribute: SecondStagePostprocessor/map/while/TensorArrayWrite/TensorArrayWriteV3\r\n2019-11-14 02:55:54.080667: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1080] Converting unsupported operation: Enter\r\n2019-11-14 02:55:54.080696: I tensorflow/contrib/lite/toco/import_tensorflow.cc:189] Unsupported data type in placeholder op: 20\r\n2019-11-14 02:55:54.080727: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1080] Converting unsupported operation: Exit\r\n2019-11-14 02:55:54.080834: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1080] Converting unsupported operation: TensorArraySizeV3\r\n2019-11-14 02:55:54.080855: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1127] Op node missing output type attribute: SecondStagePostprocessor/map/TensorArrayStack/TensorArraySizeV3\r\n2019-11-14 02:55:54.080950: I tensorflow/contrib/lite/toco/import_tensorflow.cc:1080] Converting unsupported operation: TensorArrayGatherV3\r\n2019-11-14 02:55:54.138743: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before Removing unused ops: 2132 operators, 3712 arrays (0 quantized)\r\n2019-11-14 02:55:54.229959: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] After Removing unused ops pass 1: 1999 operators, 3467 arrays (0 quantized)\r\n2019-11-14 02:55:54.334917: I tensorflow/contrib/lite/toco/graph_transformations/graph_transformations.cc:39] Before general graph transformations: 1999 operators, 3467 arrays (0 quantized)\r\n2019-11-14 02:55:54.385257: F tensorflow/contrib/lite/toco/graph_transformations/resolve_constant_slice.cc:59] Check failed: dim_size >= 1 (0 vs. 1)\r\nAborted (core dumped)\r\n\r\n```\r\n\r\n**Also, please include a link to the saved model or GraphDef**\r\n\r\n```\r\n# Put link here or attach to the issue.\r\n```\r\n\r\n**Failure details**\r\nIf the conversion is successful, but the generated model is wrong,\r\nstate what is wrong:\r\n- Producing wrong results and/or decrease in accuracy\r\n- Producing correct results, but the model is slower than expected (model generated from old converter)\r\n\r\n\r\n**Any other info / logs**\r\n\r\nInclude any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.\r\n"}, {"url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34253", "repository_url": "https://api.github.com/repos/tensorflow/tensorflow", "labels_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34253/labels{/name}", "comments_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34253/comments", "events_url": "https://api.github.com/repos/tensorflow/tensorflow/issues/34253/events", "html_url": "https://github.com/tensorflow/tensorflow/issues/34253", "id": 522539946, "node_id": "MDU6SXNzdWU1MjI1Mzk5NDY=", "number": 34253, "title": "When the result of tf.saved_model.load goes out of scope, it invalidates models that are still in-scope", "user": {"login": "chkothe", "id": 5318120, "node_id": "MDQ6VXNlcjUzMTgxMjA=", "avatar_url": "https://avatars3.githubusercontent.com/u/5318120?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chkothe", "html_url": "https://github.com/chkothe", "followers_url": "https://api.github.com/users/chkothe/followers", "following_url": "https://api.github.com/users/chkothe/following{/other_user}", "gists_url": "https://api.github.com/users/chkothe/gists{/gist_id}", "starred_url": "https://api.github.com/users/chkothe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chkothe/subscriptions", "organizations_url": "https://api.github.com/users/chkothe/orgs", "repos_url": "https://api.github.com/users/chkothe/repos", "events_url": "https://api.github.com/users/chkothe/events{/privacy}", "received_events_url": "https://api.github.com/users/chkothe/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 1160540362, "node_id": "MDU6TGFiZWwxMTYwNTQwMzYy", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/TF%202.0", "name": "TF 2.0", "color": "e79b38", "default": false, "description": "Issues relating to TensorFlow 2.0"}, {"id": 1097546578, "node_id": "MDU6TGFiZWwxMDk3NTQ2NTc4", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/comp:keras", "name": "comp:keras", "color": "0052cc", "default": false, "description": ""}, {"id": 404586594, "node_id": "MDU6TGFiZWw0MDQ1ODY1OTQ=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/stat:awaiting%20tensorflower", "name": "stat:awaiting tensorflower", "color": "f4b400", "default": false, "description": ""}, {"id": 473184161, "node_id": "MDU6TGFiZWw0NzMxODQxNjE=", "url": "https://api.github.com/repos/tensorflow/tensorflow/labels/type:support", "name": "type:support", "color": "159b2e", "default": false, "description": ""}], "state": "open", "locked": false, "assignee": {"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}, "assignees": [{"login": "k-w-w", "id": 31663267, "node_id": "MDQ6VXNlcjMxNjYzMjY3", "avatar_url": "https://avatars2.githubusercontent.com/u/31663267?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k-w-w", "html_url": "https://github.com/k-w-w", "followers_url": "https://api.github.com/users/k-w-w/followers", "following_url": "https://api.github.com/users/k-w-w/following{/other_user}", "gists_url": "https://api.github.com/users/k-w-w/gists{/gist_id}", "starred_url": "https://api.github.com/users/k-w-w/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k-w-w/subscriptions", "organizations_url": "https://api.github.com/users/k-w-w/orgs", "repos_url": "https://api.github.com/users/k-w-w/repos", "events_url": "https://api.github.com/users/k-w-w/events{/privacy}", "received_events_url": "https://api.github.com/users/k-w-w/received_events", "type": "User", "site_admin": false}], "milestone": null, "comments": 2, "created_at": "2019-11-13T23:51:58Z", "updated_at": "2020-01-01T20:22:00Z", "closed_at": null, "author_association": "NONE", "body": "\r\n**System information**\r\n- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes, a trivial change to a stock example\r\n- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10 x64\r\n- TensorFlow installed from (source or binary): binary via pip\r\n- TensorFlow version (use command below): tensorflow-gpu 2.0.0\r\n- Python version: 3.6.6\r\n- CUDA/cuDNN version: 10.0 / 10.0-windows10-x64-v7.6.0.64\r\n- GPU model and memory: GeForce GTX 1050 Ti (laptop)\r\n\r\n**Describe the current behavior**\r\n\r\nLoading a TF2 model built with the Keras API, and then predicting with random data follows this minimal recipe:\r\n```\r\nimport tensorflow as tf\r\nloaded = tf.saved_model.load('some/model')\r\ninfer = loaded.signatures['serving_default']\r\ndata = tf.constant(np.asarray(np.random.randn(my_shape), dtype=np.float32))\r\npreds = infer(data)\r\n```\r\n\r\nHowever, if we don't keep a reference to `loaded` around or lose it some time later...\r\n```\r\nimport tensorflow as tf\r\ninfer = tf.saved_model.load('some/model').signatures['serving_default']\r\ndata = tf.constant(np.asarray(np.random.randn(my_shape), dtype=np.float32))\r\npreds = infer(data)\r\n```\r\n\r\n... it fails with this utterly confusing error about variables being potentially uninitialized (for which google searches lead down various unrelated tf 1.x related rabbit holes):\r\n```\r\n2019-11-13 15:37:09.423218: W tensorflow/core/common_runtime/base_collective_executor.cc:216] BaseCollectiveExecutor::StartAbort Failed precondition: Error while reading resource variable batch_normalization_150/moving_mean_12513 from Container: localhost. This could mean that the variable was uninitialized. Not found: Resource localhost/batch_normalization_150/moving_mean_12513/class tensorflow::Var does not exist.\r\n\t [[{{node StatefulPartitionedCall/model_65/model_60/batch_normalization_150/FusedBatchNormV3/ReadVariableOp}}]]\r\nTraceback (most recent call last):\r\n  File \"D:/DEVEL/experiments/test_load.py\", line 17, in <module>\r\n    preds = infer(data)\r\n  File \"C:\\Users\\chris\\Miniconda3\\envs\\np2019-11-06e2\\lib\\site-packages\\tensorflow_core\\python\\eager\\function.py\", line 1081, in __call__\r\n    return self._call_impl(args, kwargs)\r\n  File \"C:\\Users\\chris\\Miniconda3\\envs\\np2019-11-06e2\\lib\\site-packages\\tensorflow_core\\python\\eager\\function.py\", line 1121, in _call_impl\r\n    return self._call_flat(args, self.captured_inputs, cancellation_manager)\r\n  File \"C:\\Users\\chris\\Miniconda3\\envs\\np2019-11-06e2\\lib\\site-packages\\tensorflow_core\\python\\saved_model\\load.py\", line 99, in _call_flat\r\n    cancellation_manager)\r\n  File \"C:\\Users\\chris\\Miniconda3\\envs\\np2019-11-06e2\\lib\\site-packages\\tensorflow_core\\python\\eager\\function.py\", line 1224, in _call_flat\r\n    ctx, args, cancellation_manager=cancellation_manager)\r\n  File \"C:\\Users\\chris\\Miniconda3\\envs\\np2019-11-06e2\\lib\\site-packages\\tensorflow_core\\python\\eager\\function.py\", line 511, in call\r\n    ctx=ctx)\r\n  File \"C:\\Users\\chris\\Miniconda3\\envs\\np2019-11-06e2\\lib\\site-packages\\tensorflow_core\\python\\eager\\execute.py\", line 67, in quick_execute\r\n    six.raise_from(core._status_to_exception(e.code, message), None)\r\n  File \"<string>\", line 3, in raise_from\r\ntensorflow.python.framework.errors_impl.FailedPreconditionError:  Error while reading resource variable batch_normalization_150/moving_mean_12513 from Container: localhost. This could mean that the variable was uninitialized. Not found: Resource localhost/batch_normalization_150/moving_mean_12513/class tensorflow::Var does not exist.\r\n\t [[{{node StatefulPartitionedCall/model_65/model_60/batch_normalization_150/FusedBatchNormV3/ReadVariableOp}}]] [Op:__inference_signature_wrapper_5266]\r\n\r\nFunction call stack:\r\nsignature_wrapper\r\n```\r\n\r\n**Describe the expected behavior**\r\n\r\nThe `infer` object holds a reference to the data that it depends on so that it doesn't get garbage-collected.\r\n\r\n**Code to reproduce the issue**\r\nIf you run the TF2.0 Saved Model tutorial colab notebook (https://colab.research.google.com/github/tensorflow/docs/blob/master/site/en/guide/saved_model.ipynb) up to and including the cell\r\n\r\n```\r\n!saved_model_cli show --dir /tmp/mobilenet/1 --tag_set serve --signature_def serving_default\r\n```\r\n\r\nbut then you execute the following cell instead of the one that would create the variable `loaded`:\r\n\r\n```\r\ninfer = tf.saved_model.load(\"/tmp/mobilenet/1/\").signatures[\"serving_default\"]\r\nprint(infer.structured_outputs)\r\nlabeling = infer(tf.constant(x))[pretrained_model.output_names[0]]\r\ndecoded = imagenet_labels[np.argsort(labeling)[0,::-1][:5]+1]\r\nprint(\"Result after saving and loading:\\n\", decoded)\r\n```\r\n\r\n... then it fails with:\r\n```\r\n---------------------------------------------------------------------------\r\nFailedPreconditionError                   Traceback (most recent call last)\r\n<ipython-input-8-f42985f0118d> in <module>()\r\n----> 1 labeling = infer(tf.constant(x))[pretrained_model.output_names[0]]\r\n      2 \r\n      3 decoded = imagenet_labels[np.argsort(labeling)[0,::-1][:5]+1]\r\n      4 \r\n      5 print(\"Result after saving and loading:\\n\", decoded)\r\n\r\n6 frames\r\n/usr/local/lib/python3.6/dist-packages/six.py in raise_from(value, from_value)\r\n\r\nFailedPreconditionError:  Error while reading resource variable conv_pw_7_bn/moving_variance_33153 from Container: localhost. This could mean that the variable was uninitialized. Not found: Resource localhost/conv_pw_7_bn/moving_variance_33153/N10tensorflow3VarE does not exist.\r\n\t [[{{node StatefulPartitionedCall/mobilenet_1.00_224/conv_pw_7_bn/FusedBatchNormV3/ReadVariableOp_1}}]] [Op:__inference_signature_wrapper_30328]\r\n\r\nFunction call stack:\r\nsignature_wrapper\r\n```\r\n"}]